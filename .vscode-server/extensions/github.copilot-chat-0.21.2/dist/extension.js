"use strict";var nje=Object.create;var RA=Object.defineProperty;var Kpe=Object.getOwnPropertyDescriptor;var ije=Object.getOwnPropertyNames;var oje=Object.getPrototypeOf,sje=Object.prototype.hasOwnProperty;var D=(t,e)=>()=>(t&&(e=t(t=0)),e);var R=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Pn=(t,e)=>{for(var r in e)RA(t,r,{get:e[r],enumerable:!0})},Ype=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ije(e))!sje.call(t,o)&&o!==r&&RA(t,o,{get:()=>e[o],enumerable:!(n=Kpe(e,o))||n.enumerable});return t};var q=(t,e,r)=>(r=t!=null?nje(oje(t)):{},Ype(e||!t||!t.__esModule?RA(r,"default",{value:t,enumerable:!0}):r,t)),fo=t=>Ype(RA({},"__esModule",{value:!0}),t),E=(t,e,r,n)=>{for(var o=n>1?void 0:n?Kpe(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(o=(n?a(e,r,o):a(o))||o);return n&&o&&RA(e,r,o),o},y=(t,e)=>(r,n)=>e(r,n,t);var Ct=R((qkt,Zpe)=>{"use strict";var T$=Object.defineProperty,aje=Object.getOwnPropertyDescriptor,cje=Object.getOwnPropertyNames,lje=Object.prototype.hasOwnProperty,uje=(t,e)=>{for(var r in e)T$(t,r,{get:e[r],enumerable:!0})},dje=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of cje(e))!lje.call(t,o)&&o!==r&&T$(t,o,{get:()=>e[o],enumerable:!(n=aje(e,o))||n.enumerable});return t},pje=t=>dje(T$({},"__esModule",{value:!0}),t),Xpe={};uje(Xpe,{config:()=>vje,t:()=>Jpe});Zpe.exports=pje(Xpe);var fje=require("fs"),mje=require("fs/promises");async function hje(t){if(t.protocol==="file:")return await(0,mje.readFile)(t,"utf8");if(t.protocol==="http:"||t.protocol==="https:"){let e=await fetch(t.toString(),{headers:{"Accept-Encoding":"gzip, deflate",Accept:"application/json"},redirect:"follow"});if(!e.ok){let n=`Unexpected ${e.status} response while trying to read ${t}`;try{n+=`: ${await e.text()}`}catch{}throw new Error(n)}return await e.text()}throw new Error("Unsupported protocol")}function gje(t){return(0,fje.readFileSync)(t,"utf8")}var PA;function vje(t){if("contents"in t){typeof t.contents=="string"?PA=JSON.parse(t.contents):PA=t.contents;return}if("fsPath"in t){let e=gje(t.fsPath),r=JSON.parse(e);PA=Qpe(r)?r.contents.bundle:r;return}if(t.uri){let e=t.uri;return typeof t.uri=="string"&&(e=new URL(t.uri)),new Promise((r,n)=>{let o=hje(e).then(s=>{try{let a=JSON.parse(s);PA=Qpe(a)?a.contents.bundle:a}catch(a){n(a)}}).catch(s=>{n(s)});r(o)})}}function Jpe(...t){let e=t[0],r,n,o;if(typeof e=="string")r=e,n=e,t.splice(0,1),o=!t||typeof t[0]!="object"?t:t[0];else if(e instanceof Array){let a=t.slice(1);if(e.length!==a.length+1)throw new Error("expected a string as the first argument to l10n.t");let c=e[0];for(let l=1;l<e.length;l++)c+=`{${l-1}}`+e[l];return Jpe(c,...a)}else n=e.message,r=n,e.comment&&e.comment.length>0&&(r+=`/${Array.isArray(e.comment)?e.comment.join(""):e.comment}`),o=e.args??{};let s=PA?.[r];return s?typeof s=="string"?fM(s,o):s.comment?fM(s.message,o):fM(n,o):fM(n,o)}var yje=/{([^}]+)}/g;function fM(t,e){return Object.keys(e).length===0?t:t.replace(yje,(r,n)=>e[n]??r)}function Qpe(t){return typeof t?.contents?.bundle=="object"&&typeof t?.version=="string"}});var lI=R(gp=>{"use strict";Object.defineProperty(gp,"__esModule",{value:!0});gp.BaseTokensPerName=gp.BaseTokensPerMessage=gp.BaseTokensPerCompletion=gp.ChatRole=void 0;var xme;(function(t){t.System="system",t.User="user",t.Assistant="assistant",t.Function="function",t.Tool="tool"})(xme||(gp.ChatRole=xme={}));gp.BaseTokensPerCompletion=3;gp.BaseTokensPerMessage=3;gp.BaseTokensPerName=1});var hW=R(mW=>{"use strict";Object.defineProperty(mW,"__esModule",{value:!0});mW.forEachNode=Sme;function Sme(t,e){if(e(t),t.type===1)for(let r of t.children)Sme(r,e)}});var Cme=R(()=>{"use strict";function KVe(t,e,...r){return{ctor:t,props:e,children:r.flat()}}function Ime(){throw new Error("This should not be invoked!")}Ime.isFragment=!0;globalThis.vscpp=KVe;globalThis.vscppf=Ime});var vW=R(lF=>{"use strict";Object.defineProperty(lF,"__esModule",{value:!0});lF.PromptElement=void 0;Cme();var gW=class{get priority(){return this.props.priority??Number.MAX_SAFE_INTEGER}get insertLineBreakBefore(){return!0}constructor(e){this.props=e}};lF.PromptElement=gW});var fF=R(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.ToolResult=eo.PrioritizedList=eo.TextChunk=eo.ToolMessage=eo.FunctionMessage=eo.AssistantMessage=eo.UserMessage=eo.SystemMessage=eo.BaseChatMessage=void 0;eo.isChatMessagePromptElement=YVe;var Tme=Ue(),Eme=hW(),e2=lI(),pF=vW();function YVe(t){return t instanceof uF||t instanceof ZA||t instanceof dF}var nv=class extends pF.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};eo.BaseChatMessage=nv;var uF=class extends nv{constructor(e){e.role=e2.ChatRole.System,super(e)}};eo.SystemMessage=uF;var ZA=class extends nv{constructor(e){e.role=e2.ChatRole.User,super(e)}};eo.UserMessage=ZA;var dF=class extends nv{constructor(e){e.role=e2.ChatRole.Assistant,super(e)}};eo.AssistantMessage=dF;var QVe=/\s+/g,yW=class extends nv{constructor(e){e.role=e2.ChatRole.Function,super(e)}};eo.FunctionMessage=yW;var bW=class extends nv{constructor(e){e.role=e2.ChatRole.Tool,super(e)}};eo.ToolMessage=bW;var _W=class extends pF.PromptElement{async prepare(e,r,n){let o=this.props.breakOnWhitespace?QVe:this.props.breakOn;if(!o)return vscpp(vscppf,null,this.props.children);let s="",a=[];for(let l of this.props.children||[])if(l&&typeof l=="object"){if(typeof l.ctor!="string")throw new Error("TextChunk children must be text literals or intrinsic attributes.");l.ctor==="br"?s+=`
`:a.push(l)}else l!=null&&(s+=l);let c=await XVe(e,o,s,n);return vscpp(vscppf,null,a,c)}render(e){return e}};eo.TextChunk=_W;async function XVe(t,e,r,n){if(e instanceof RegExp){if(!e.global)throw new Error(`\`breakOn\` expression must have the global flag set (got ${e})`);e.lastIndex=0}let o="",s=-1;for(;s<r.length;){let a;typeof e=="string"?a=r.indexOf(e,s===-1?0:s+e.length):a=e.exec(r)?.index??-1,a===-1&&(a=r.length);let c=o+r.slice(Math.max(0,s),a);if(await t.countTokens(c,n)>t.tokenBudget)return o;o=c,s=a}return o}var xW=class extends pF.PromptElement{render(){let e=this.props.children;if(e)return vscpp(vscppf,null,e.map((r,n)=>(r.props??(r.props={}),r.props.priority=this.props.descending?this.props.priority-n:this.props.priority-e.length+n,r)))}};eo.PrioritizedList=xW;var SW=class extends pF.PromptElement{render(){return this.props.data.hasOwnProperty(Tme.contentType)?vscpp("elementJSON",{data:this.rebasePriority(this.props.data[Tme.contentType])}):vscpp(ZA,{priority:this.priority},this.props.data.toString())}rebasePriority(e){if(this.priority===void 0)return e;let r=structuredClone(e),n=1;return Eme.forEachNode(r.node,o=>{o.priority===Number.MAX_SAFE_INTEGER&&(o.priority=void 0),o.priority!==void 0&&(n=Math.max(n,o.priority))}),Eme.forEachNode(r.node,o=>{let s=(o.priority??n+1)/(n+2);o.priority=this.priority+s}),r}};eo.ToolResult=SW});var kme=R(t2=>{"use strict";Object.defineProperty(t2,"__esModule",{value:!0});t2.localize=JVe;t2.localize2=ZVe;t2.getConfiguredDefaultLocale=eHe;function wme(t,e){let r;return e.length===0?r=t:r=t.replace(/\{(\d+)\}/g,function(n,o){let s=o[0];return typeof e[s]<"u"?e[s]:n}),r}function JVe(t,e,...r){return wme(e,r)}function ZVe(t,e,...r){let n=wme(e,r);return{original:n,value:n}}function eHe(t){}});var EW=R(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.isAndroid=Ge.isEdge=Ge.isSafari=Ge.isFirefox=Ge.isChrome=Ge.OS=Ge.setTimeout0=Ge.setTimeout0IsFaster=Ge.translationsConfigFile=Ge.platformLocale=Ge.locale=Ge.Language=Ge.language=Ge.userAgent=Ge.platform=Ge.isCI=Ge.isMobile=Ge.isIOS=Ge.webWorkerOrigin=Ge.isWebWorker=Ge.isWeb=Ge.isElectron=Ge.isNative=Ge.isLinuxSnap=Ge.isLinux=Ge.isMacintosh=Ge.isWindows=Ge.LANGUAGE_DEFAULT=void 0;Ge.PlatformToString=rHe;Ge.isLittleEndian=nHe;Ge.isBigSurOrNewer=iHe;var Rme=kme();Ge.LANGUAGE_DEFAULT="en";var i2=!1,o2=!1,n2=!1,Nme=!1,Lme=!1,CW=!1,Ome=!1,TW=!1,Mme=!1,Fme=!1,r2,mF=Ge.LANGUAGE_DEFAULT,IW=Ge.LANGUAGE_DEFAULT,Ume,Fm,Um=globalThis,rl;typeof Um.vscode<"u"&&typeof Um.vscode.process<"u"?rl=Um.vscode.process:typeof process<"u"&&(rl=process);var Bme=typeof rl?.versions?.electron=="string",tHe=Bme&&rl?.type==="renderer";if(typeof rl=="object"){i2=rl.platform==="win32",o2=rl.platform==="darwin",n2=rl.platform==="linux",Nme=n2&&!!rl.env.SNAP&&!!rl.env.SNAP_REVISION,Ome=Bme,Mme=!!rl.env.CI||!!rl.env.BUILD_ARTIFACTSTAGINGDIRECTORY,r2=Ge.LANGUAGE_DEFAULT,mF=Ge.LANGUAGE_DEFAULT;let t=rl.env.VSCODE_NLS_CONFIG;if(t)try{let e=JSON.parse(t),r=e.availableLanguages["*"];r2=e.locale,IW=e.osLocale,mF=r||Ge.LANGUAGE_DEFAULT,Ume=e._translationsConfigFile}catch{}Lme=!0}else typeof navigator=="object"&&!tHe?(Fm=navigator.userAgent,i2=Fm.indexOf("Windows")>=0,o2=Fm.indexOf("Macintosh")>=0,TW=(Fm.indexOf("Macintosh")>=0||Fm.indexOf("iPad")>=0||Fm.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,n2=Fm.indexOf("Linux")>=0,Fme=Fm?.indexOf("Mobi")>=0,CW=!0,r2=Rme.getConfiguredDefaultLocale(Rme.localize({key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_"))||Ge.LANGUAGE_DEFAULT,mF=r2,IW=navigator.language):console.error("Unable to resolve platform.");function rHe(t){switch(t){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}var hF=0;o2?hF=1:i2?hF=3:n2&&(hF=2);Ge.isWindows=i2;Ge.isMacintosh=o2;Ge.isLinux=n2;Ge.isLinuxSnap=Nme;Ge.isNative=Lme;Ge.isElectron=Ome;Ge.isWeb=CW;Ge.isWebWorker=CW&&typeof Um.importScripts=="function";Ge.webWorkerOrigin=Ge.isWebWorker?Um.origin:void 0;Ge.isIOS=TW;Ge.isMobile=Fme;Ge.isCI=Mme;Ge.platform=hF;Ge.userAgent=Fm;Ge.language=mF;var Pme;(function(t){function e(){return Ge.language}t.value=e;function r(){return Ge.language.length===2?Ge.language==="en":Ge.language.length>=3?Ge.language[0]==="e"&&Ge.language[1]==="n"&&Ge.language[2]==="-":!1}t.isDefaultVariant=r;function n(){return Ge.language==="en"}t.isDefault=n})(Pme||(Ge.Language=Pme={}));Ge.locale=r2;Ge.platformLocale=IW;Ge.translationsConfigFile=Ume;Ge.setTimeout0IsFaster=typeof Um.postMessage=="function"&&!Um.importScripts;Ge.setTimeout0=(()=>{if(Ge.setTimeout0IsFaster){let t=[];Um.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,o=t.length;n<o;n++){let s=t[n];if(s.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),s.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),Um.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();Ge.OS=o2||TW?2:i2?1:3;var Ame=!0,Dme=!1;function nHe(){if(!Dme){Dme=!0;let t=new Uint8Array(2);t[0]=1,t[1]=2,Ame=new Uint16Array(t.buffer)[0]===513}return Ame}Ge.isChrome=!!(Ge.userAgent&&Ge.userAgent.indexOf("Chrome")>=0);Ge.isFirefox=!!(Ge.userAgent&&Ge.userAgent.indexOf("Firefox")>=0);Ge.isSafari=!!(!Ge.isChrome&&Ge.userAgent&&Ge.userAgent.indexOf("Safari")>=0);Ge.isEdge=!!(Ge.userAgent&&Ge.userAgent.indexOf("Edg/")>=0);Ge.isAndroid=!!(Ge.userAgent&&Ge.userAgent.indexOf("Android")>=0);function iHe(t){return parseFloat(t)>=20}});var jme=R(vp=>{"use strict";Object.defineProperty(vp,"__esModule",{value:!0});vp.arch=vp.platform=vp.env=vp.cwd=void 0;var qme=EW(),x_,wW=globalThis.vscode;if(typeof wW<"u"&&typeof wW.process<"u"){let t=wW.process;x_={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else typeof process<"u"?x_={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:x_={get platform(){return qme.isWindows?"win32":qme.isMacintosh?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};vp.cwd=x_.cwd;vp.env=x_.env;vp.platform=x_.platform;vp.arch=x_.arch});var Hme=R(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.delimiter=ot.sep=ot.toNamespacedPath=ot.parse=ot.format=ot.extname=ot.basename=ot.dirname=ot.relative=ot.resolve=ot.join=ot.isAbsolute=ot.normalize=ot.posix=ot.win32=void 0;var uI=jme(),oHe=65,sHe=97,aHe=90,cHe=122,sv=46,ls=47,lc=92,iv=58,lHe=63,gF=class extends Error{constructor(e,r,n){let o;typeof r=="string"&&r.indexOf("not ")===0?(o="must not be",r=r.replace(/^not /,"")):o="must be";let s=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${s} ${o} of type ${r}`;a+=`. Received type ${typeof n}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function uHe(t,e){if(t===null||typeof t!="object")throw new gF(e,"Object",t)}function Bi(t,e){if(typeof t!="string")throw new gF(e,"string",t)}var uc=uI.platform==="win32";function ar(t){return t===ls||t===lc}function kW(t){return t===ls}function ov(t){return t>=oHe&&t<=aHe||t>=sHe&&t<=cHe}function vF(t,e,r,n){let o="",s=0,a=-1,c=0,l=0;for(let u=0;u<=t.length;++u){if(u<t.length)l=t.charCodeAt(u);else{if(n(l))break;l=ls}if(n(l)){if(!(a===u-1||c===1))if(c===2){if(o.length<2||s!==2||o.charCodeAt(o.length-1)!==sv||o.charCodeAt(o.length-2)!==sv){if(o.length>2){let d=o.lastIndexOf(r);d===-1?(o="",s=0):(o=o.slice(0,d),s=o.length-1-o.lastIndexOf(r)),a=u,c=0;continue}else if(o.length!==0){o="",s=0,a=u,c=0;continue}}e&&(o+=o.length>0?`${r}..`:"..",s=2)}else o.length>0?o+=`${r}${t.slice(a+1,u)}`:o=t.slice(a+1,u),s=u-a-1;a=u,c=0}else l===sv&&c!==-1?++c:c=-1}return o}function Vme(t,e){uHe(e,"pathObject");let r=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return r?r===e.root?`${r}${n}`:`${r}${t}${n}`:n}ot.win32={resolve(...t){let e="",r="",n=!1;for(let o=t.length-1;o>=-1;o--){let s;if(o>=0){if(s=t[o],Bi(s,"path"),s.length===0)continue}else e.length===0?s=uI.cwd():(s=uI.env[`=${e}`]||uI.cwd(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===lc)&&(s=`${e}\\`));let a=s.length,c=0,l="",u=!1,d=s.charCodeAt(0);if(a===1)ar(d)&&(c=1,u=!0);else if(ar(d))if(u=!0,ar(s.charCodeAt(1))){let p=2,f=p;for(;p<a&&!ar(s.charCodeAt(p));)p++;if(p<a&&p!==f){let m=s.slice(f,p);for(f=p;p<a&&ar(s.charCodeAt(p));)p++;if(p<a&&p!==f){for(f=p;p<a&&!ar(s.charCodeAt(p));)p++;(p===a||p!==f)&&(l=`\\\\${m}\\${s.slice(f,p)}`,c=p)}}}else c=1;else ov(d)&&s.charCodeAt(1)===iv&&(l=s.slice(0,2),c=2,a>2&&ar(s.charCodeAt(2))&&(u=!0,c=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(r=`${s.slice(c)}\\${r}`,n=u,u&&e.length>0)break}return r=vF(r,!n,"\\",ar),n?`${e}\\${r}`:`${e}${r}`||"."},normalize(t){Bi(t,"path");let e=t.length;if(e===0)return".";let r=0,n,o=!1,s=t.charCodeAt(0);if(e===1)return kW(s)?"\\":t;if(ar(s))if(o=!0,ar(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!ar(t.charCodeAt(c));)c++;if(c<e&&c!==l){let u=t.slice(l,c);for(l=c;c<e&&ar(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!ar(t.charCodeAt(c));)c++;if(c===e)return`\\\\${u}\\${t.slice(l)}\\`;c!==l&&(n=`\\\\${u}\\${t.slice(l,c)}`,r=c)}}}else r=1;else ov(s)&&t.charCodeAt(1)===iv&&(n=t.slice(0,2),r=2,e>2&&ar(t.charCodeAt(2))&&(o=!0,r=3));let a=r<e?vF(t.slice(r),!o,"\\",ar):"";return a.length===0&&!o&&(a="."),a.length>0&&ar(t.charCodeAt(e-1))&&(a+="\\"),n===void 0?o?`\\${a}`:a:o?`${n}\\${a}`:`${n}${a}`},isAbsolute(t){Bi(t,"path");let e=t.length;if(e===0)return!1;let r=t.charCodeAt(0);return ar(r)||e>2&&ov(r)&&t.charCodeAt(1)===iv&&ar(t.charCodeAt(2))},join(...t){if(t.length===0)return".";let e,r;for(let s=0;s<t.length;++s){let a=t[s];Bi(a,"path"),a.length>0&&(e===void 0?e=r=a:e+=`\\${a}`)}if(e===void 0)return".";let n=!0,o=0;if(typeof r=="string"&&ar(r.charCodeAt(0))){++o;let s=r.length;s>1&&ar(r.charCodeAt(1))&&(++o,s>2&&(ar(r.charCodeAt(2))?++o:n=!1))}if(n){for(;o<e.length&&ar(e.charCodeAt(o));)o++;o>=2&&(e=`\\${e.slice(o)}`)}return ot.win32.normalize(e)},relative(t,e){if(Bi(t,"from"),Bi(e,"to"),t===e)return"";let r=ot.win32.resolve(t),n=ot.win32.resolve(e);if(r===n||(t=r.toLowerCase(),e=n.toLowerCase(),t===e))return"";let o=0;for(;o<t.length&&t.charCodeAt(o)===lc;)o++;let s=t.length;for(;s-1>o&&t.charCodeAt(s-1)===lc;)s--;let a=s-o,c=0;for(;c<e.length&&e.charCodeAt(c)===lc;)c++;let l=e.length;for(;l-1>c&&e.charCodeAt(l-1)===lc;)l--;let u=l-c,d=a<u?a:u,p=-1,f=0;for(;f<d;f++){let h=t.charCodeAt(o+f);if(h!==e.charCodeAt(c+f))break;h===lc&&(p=f)}if(f!==d){if(p===-1)return n}else{if(u>d){if(e.charCodeAt(c+f)===lc)return n.slice(c+f+1);if(f===2)return n.slice(c+f)}a>d&&(t.charCodeAt(o+f)===lc?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=o+p+1;f<=s;++f)(f===s||t.charCodeAt(f)===lc)&&(m+=m.length===0?"..":"\\..");return c+=p,m.length>0?`${m}${n.slice(c,l)}`:(n.charCodeAt(c)===lc&&++c,n.slice(c,l))},toNamespacedPath(t){if(typeof t!="string"||t.length===0)return t;let e=ot.win32.resolve(t);if(e.length<=2)return t;if(e.charCodeAt(0)===lc){if(e.charCodeAt(1)===lc){let r=e.charCodeAt(2);if(r!==lHe&&r!==sv)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(ov(e.charCodeAt(0))&&e.charCodeAt(1)===iv&&e.charCodeAt(2)===lc)return`\\\\?\\${e}`;return t},dirname(t){Bi(t,"path");let e=t.length;if(e===0)return".";let r=-1,n=0,o=t.charCodeAt(0);if(e===1)return ar(o)?t:".";if(ar(o)){if(r=n=1,ar(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!ar(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&ar(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!ar(t.charCodeAt(c));)c++;if(c===e)return t;c!==l&&(r=n=c+1)}}}}else ov(o)&&t.charCodeAt(1)===iv&&(r=e>2&&ar(t.charCodeAt(2))?3:2,n=r);let s=-1,a=!0;for(let c=e-1;c>=n;--c)if(ar(t.charCodeAt(c))){if(!a){s=c;break}}else a=!1;if(s===-1){if(r===-1)return".";s=r}return t.slice(0,s)},basename(t,e){e!==void 0&&Bi(e,"ext"),Bi(t,"path");let r=0,n=-1,o=!0,s;if(t.length>=2&&ov(t.charCodeAt(0))&&t.charCodeAt(1)===iv&&(r=2),e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=r;--s){let l=t.charCodeAt(s);if(ar(l)){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=r;--s)if(ar(t.charCodeAt(s))){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){Bi(t,"path");let e=0,r=-1,n=0,o=-1,s=!0,a=0;t.length>=2&&t.charCodeAt(1)===iv&&ov(t.charCodeAt(0))&&(e=n=2);for(let c=t.length-1;c>=e;--c){let l=t.charCodeAt(c);if(ar(l)){if(!s){n=c+1;break}continue}o===-1&&(s=!1,o=c+1),l===sv?r===-1?r=c:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||o===-1||a===0||a===1&&r===o-1&&r===n+1?"":t.slice(r,o)},format:Vme.bind(null,"\\"),parse(t){Bi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.length,n=0,o=t.charCodeAt(0);if(r===1)return ar(o)?(e.root=e.dir=t,e):(e.base=e.name=t,e);if(ar(o)){if(n=1,ar(t.charCodeAt(1))){let p=2,f=p;for(;p<r&&!ar(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&ar(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&!ar(t.charCodeAt(p));)p++;p===r?n=p:p!==f&&(n=p+1)}}}}else if(ov(o)&&t.charCodeAt(1)===iv){if(r<=2)return e.root=e.dir=t,e;if(n=2,ar(t.charCodeAt(2))){if(r===3)return e.root=e.dir=t,e;n=3}}n>0&&(e.root=t.slice(0,n));let s=-1,a=n,c=-1,l=!0,u=t.length-1,d=0;for(;u>=n;--u){if(o=t.charCodeAt(u),ar(o)){if(!l){a=u+1;break}continue}c===-1&&(l=!1,c=u+1),o===sv?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return c!==-1&&(s===-1||d===0||d===1&&s===c-1&&s===a+1?e.base=e.name=t.slice(a,c):(e.name=t.slice(a,s),e.base=t.slice(a,c),e.ext=t.slice(s,c))),a>0&&a!==n?e.dir=t.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null};var dHe=(()=>{if(uc){let t=/\\/g;return()=>{let e=uI.cwd().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>uI.cwd()})();ot.posix={resolve(...t){let e="",r=!1;for(let n=t.length-1;n>=-1&&!r;n--){let o=n>=0?t[n]:dHe();Bi(o,"path"),o.length!==0&&(e=`${o}/${e}`,r=o.charCodeAt(0)===ls)}return e=vF(e,!r,"/",kW),r?`/${e}`:e.length>0?e:"."},normalize(t){if(Bi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===ls,r=t.charCodeAt(t.length-1)===ls;return t=vF(t,!e,"/",kW),t.length===0?e?"/":r?"./":".":(r&&(t+="/"),e?`/${t}`:t)},isAbsolute(t){return Bi(t,"path"),t.length>0&&t.charCodeAt(0)===ls},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){let n=t[r];Bi(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":ot.posix.normalize(e)},relative(t,e){if(Bi(t,"from"),Bi(e,"to"),t===e||(t=ot.posix.resolve(t),e=ot.posix.resolve(e),t===e))return"";let r=1,n=t.length,o=n-r,s=1,a=e.length-s,c=o<a?o:a,l=-1,u=0;for(;u<c;u++){let p=t.charCodeAt(r+u);if(p!==e.charCodeAt(s+u))break;p===ls&&(l=u)}if(u===c)if(a>c){if(e.charCodeAt(s+u)===ls)return e.slice(s+u+1);if(u===0)return e.slice(s+u)}else o>c&&(t.charCodeAt(r+u)===ls?l=u:u===0&&(l=0));let d="";for(u=r+l+1;u<=n;++u)(u===n||t.charCodeAt(u)===ls)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+l)}`},toNamespacedPath(t){return t},dirname(t){if(Bi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===ls,r=-1,n=!0;for(let o=t.length-1;o>=1;--o)if(t.charCodeAt(o)===ls){if(!n){r=o;break}}else n=!1;return r===-1?e?"/":".":e&&r===1?"//":t.slice(0,r)},basename(t,e){e!==void 0&&Bi(e,"ext"),Bi(t,"path");let r=0,n=-1,o=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=0;--s){let l=t.charCodeAt(s);if(l===ls){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===ls){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){Bi(t,"path");let e=-1,r=0,n=-1,o=!0,s=0;for(let a=t.length-1;a>=0;--a){let c=t.charCodeAt(a);if(c===ls){if(!o){r=a+1;break}continue}n===-1&&(o=!1,n=a+1),c===sv?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},format:Vme.bind(null,"/"),parse(t){Bi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.charCodeAt(0)===ls,n;r?(e.root="/",n=1):n=0;let o=-1,s=0,a=-1,c=!0,l=t.length-1,u=0;for(;l>=n;--l){let d=t.charCodeAt(l);if(d===ls){if(!c){s=l+1;break}continue}a===-1&&(c=!1,a=l+1),d===sv?o===-1?o=l:u!==1&&(u=1):o!==-1&&(u=-1)}if(a!==-1){let d=s===0&&r?1:s;o===-1||u===0||u===1&&o===a-1&&o===s+1?e.base=e.name=t.slice(d,a):(e.name=t.slice(d,o),e.base=t.slice(d,a),e.ext=t.slice(o,a))}return s>0?e.dir=t.slice(0,s-1):r&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ot.posix.win32=ot.win32.win32=ot.win32;ot.posix.posix=ot.win32.posix=ot.posix;ot.normalize=uc?ot.win32.normalize:ot.posix.normalize;ot.isAbsolute=uc?ot.win32.isAbsolute:ot.posix.isAbsolute;ot.join=uc?ot.win32.join:ot.posix.join;ot.resolve=uc?ot.win32.resolve:ot.posix.resolve;ot.relative=uc?ot.win32.relative:ot.posix.relative;ot.dirname=uc?ot.win32.dirname:ot.posix.dirname;ot.basename=uc?ot.win32.basename:ot.posix.basename;ot.extname=uc?ot.win32.extname:ot.posix.extname;ot.format=uc?ot.win32.format:ot.posix.format;ot.parse=uc?ot.win32.parse:ot.posix.parse;ot.toNamespacedPath=uc?ot.win32.toNamespacedPath:ot.posix.toNamespacedPath;ot.sep=uc?ot.win32.sep:ot.posix.sep;ot.delimiter=uc?ot.win32.delimiter:ot.posix.delimiter});var Qme=R(dI=>{"use strict";Object.defineProperty(dI,"__esModule",{value:!0});dI.URI=void 0;dI.isUriComponents=bHe;dI.uriToFsPath=xF;var Gme=Hme(),bF=EW(),pHe=/^\w[\w\d+.-]*$/,fHe=/^\//,mHe=/^\/\//;function hHe(t,e){if(!t.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!pHe.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!fHe.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(mHe.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function gHe(t,e){return!t&&!e?"file":t}function vHe(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==ld&&(e=ld+e):e=ld;break}return e}var Dn="",ld="/",yHe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,_F=class t{static isUri(e){return e instanceof t?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,r,n,o,s,a=!1){typeof e=="object"?(this.scheme=e.scheme||Dn,this.authority=e.authority||Dn,this.path=e.path||Dn,this.query=e.query||Dn,this.fragment=e.fragment||Dn):(this.scheme=gHe(e,a),this.authority=r||Dn,this.path=vHe(this.scheme,n||Dn),this.query=o||Dn,this.fragment=s||Dn,hHe(this,a))}get fsPath(){return xF(this,!1)}with(e){if(!e)return this;let{scheme:r,authority:n,path:o,query:s,fragment:a}=e;return r===void 0?r=this.scheme:r===null&&(r=Dn),n===void 0?n=this.authority:n===null&&(n=Dn),o===void 0?o=this.path:o===null&&(o=Dn),s===void 0?s=this.query:s===null&&(s=Dn),a===void 0?a=this.fragment:a===null&&(a=Dn),r===this.scheme&&n===this.authority&&o===this.path&&s===this.query&&a===this.fragment?this:new av(r,n,o,s,a)}static parse(e,r=!1){let n=yHe.exec(e);return n?new av(n[2]||Dn,yF(n[4]||Dn),yF(n[5]||Dn),yF(n[7]||Dn),yF(n[9]||Dn),r):new av(Dn,Dn,Dn,Dn,Dn)}static file(e){let r=Dn;if(bF.isWindows&&(e=e.replace(/\\/g,ld)),e[0]===ld&&e[1]===ld){let n=e.indexOf(ld,2);n===-1?(r=e.substring(2),e=ld):(r=e.substring(2,n),e=e.substring(n)||ld)}return new av("file",r,e,Dn,Dn)}static from(e,r){return new av(e.scheme,e.authority,e.path,e.query,e.fragment,r)}static joinPath(e,...r){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return bF.isWindows&&e.scheme==="file"?n=t.file(Gme.win32.join(xF(e,!0),...r)).path:n=Gme.posix.join(e.path,...r),e.with({path:n})}toString(e=!1){return RW(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof t)return e;{let r=new av(e);return r._formatted=e.external??null,r._fsPath=e._sep===Wme?e.fsPath??null:null,r}}else return e}};dI.URI=_F;function bHe(t){return!t||typeof t!="object"?!1:typeof t.scheme=="string"&&(typeof t.authority=="string"||typeof t.authority>"u")&&(typeof t.path=="string"||typeof t.path>"u")&&(typeof t.query=="string"||typeof t.query>"u")&&(typeof t.fragment=="string"||typeof t.fragment>"u")}var Wme=bF.isWindows?1:void 0,av=class extends _F{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=xF(this,!1)),this._fsPath}toString(e=!1){return e?RW(this,!0):(this._formatted||(this._formatted=RW(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=Wme),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},Kme={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function zme(t,e,r){let n,o=-1;for(let s=0;s<t.length;s++){let a=t.charCodeAt(s);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||r&&a===91||r&&a===93||r&&a===58)o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n!==void 0&&(n+=t.charAt(s));else{n===void 0&&(n=t.substr(0,s));let c=Kme[a];c!==void 0?(o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n+=c):o===-1&&(o=s)}}return o!==-1&&(n+=encodeURIComponent(t.substring(o))),n!==void 0?n:t}function _He(t){let e;for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n===35||n===63?(e===void 0&&(e=t.substr(0,r)),e+=Kme[n]):e!==void 0&&(e+=t[r])}return e!==void 0?e:t}function xF(t,e){let r;return t.authority&&t.path.length>1&&t.scheme==="file"?r=`//${t.authority}${t.path}`:t.path.charCodeAt(0)===47&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&t.path.charCodeAt(2)===58?e?r=t.path.substr(1):r=t.path[1].toLowerCase()+t.path.substr(2):r=t.path,bF.isWindows&&(r=r.replace(/\//g,"\\")),r}function RW(t,e){let r=e?_He:zme,n="",{scheme:o,authority:s,path:a,query:c,fragment:l}=t;if(o&&(n+=o,n+=":"),(s||o==="file")&&(n+=ld,n+=ld),s){let u=s.indexOf("@");if(u!==-1){let d=s.substr(0,u);s=s.substr(u+1),u=d.lastIndexOf(":"),u===-1?n+=r(d,!1,!1):(n+=r(d.substr(0,u),!1,!1),n+=":",n+=r(d.substr(u+1),!1,!0)),n+="@"}s=s.toLowerCase(),u=s.lastIndexOf(":"),u===-1?n+=r(s,!1,!0):(n+=r(s.substr(0,u),!1,!0),n+=s.substr(u))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let u=a.charCodeAt(1);u>=65&&u<=90&&(a=`/${String.fromCharCode(u+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let u=a.charCodeAt(0);u>=65&&u<=90&&(a=`${String.fromCharCode(u+32)}:${a.substr(2)}`)}n+=r(a,!0,!1)}return c&&(n+="?",n+=r(c,!1,!1)),l&&(n+="#",n+=e?l:zme(l,!1,!1)),n}function Yme(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+Yme(t.substr(3)):t}}var $me=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function yF(t){return t.match($me)?t.replace($me,e=>Yme(e)):t}});var DW=R(cv=>{"use strict";Object.defineProperty(cv,"__esModule",{value:!0});cv.PromptReference=cv.ChatResponseReferencePartStatusKind=cv.PromptMetadata=void 0;var s2=Qme(),PW=class{toString(){return Object.getPrototypeOf(this).constructor.name}};cv.PromptMetadata=PW;var Xme;(function(t){t[t.Complete=1]="Complete",t[t.Partial=2]="Partial",t[t.Omitted=3]="Omitted"})(Xme||(cv.ChatResponseReferencePartStatusKind=Xme={}));var AW=class t{static fromJSON(e){let r=n=>"scheme"in n?s2.URI.from(n):{uri:s2.URI.from(n.uri),range:n.range};return new t("variableName"in e.anchor?{variableName:e.anchor.variableName,value:e.anchor.value&&r(e.anchor.value)}:r(e.anchor),e.iconPath&&("scheme"in e.iconPath?s2.URI.from(e.iconPath):"light"in e.iconPath?{light:s2.URI.from(e.iconPath.light),dark:s2.URI.from(e.iconPath.dark)}:e.iconPath),e.options)}constructor(e,r,n){this.anchor=e,this.iconPath=r,this.options=n}toJSON(){return{anchor:this.anchor,iconPath:this.iconPath,options:this.options}}};cv.PromptReference=AW});var Jme=R(NW=>{"use strict";Object.defineProperty(NW,"__esModule",{value:!0});NW.coalesce=xHe;function xHe(t){return t.filter(e=>!!e)}});var qW=R(fI=>{"use strict";Object.defineProperty(fI,"__esModule",{value:!0});fI.PromptRenderer=fI.MetadataMap=void 0;var SF=lI(),lv=fF(),ehe=DW(),a2=Jme(),Zme;(function(t){t.empty={get:()=>{}}})(Zme||(fI.MetadataMap=Zme={}));var LW=class{constructor(e,r,n,o){this._endpoint=e,this._ctor=r,this._props=n,this._tokenizer=o,this._meta=new Map,this._usedContext=[],this._ignoredFiles=[],this._root=new BW(null,0),this._references=[],this.tracer=void 0}getAllMeta(){let e=this._meta;return{get(r){return e.get(r)}}}getIgnoredFiles(){return Array.from(new Set(this._ignoredFiles))}getMeta(e){return this._meta.get(e)}getUsedContext(){return this._usedContext}createElement(e){return new e.ctor(e.props)}async _processPromptPieces(e,r,n,o){let s=new Map;for(let[l,u]of r.entries()){if(Array.isArray(u.children)&&(u.props=u.props??{},u.props.children=u.children),!u.ctor)throw new Error("Invalid ChatMessage child! Child must be a TSX component that extends PromptElement.");let d=this.createElement(u);u.node.setObj(d);let p=u.props.flexGrow??1/0,f=s.get(p);f||(f=[],s.set(p,f)),f.push({element:u,promptElementInstance:d})}if(s.size===0)return;this.tracer?.startRenderPass();let a=[...s.entries()].sort(([l],[u])=>u-l).map(([l,u])=>u),c=l=>{let u=0;for(let d=l+1;d<a.length;d++)for(let{element:p}of a[d]){if(!p.props.flexReserve)continue;let f=typeof p.props.flexReserve=="string"?Math.floor(e.remainingTokenBudget/Number(p.props.flexReserve.slice(1))):p.props.flexReserve;u+=f}return e.consume(u),u};for(let[l,u]of a.entries()){let d=c(l);this.tracer?.startRenderFlex(l,d,e.remainingTokenBudget);let p=0;for(let{element:h}of u)p+=(h.props.flex||h.props.flexBasis)??1;let f=u.map(h=>{let g=(h.element.props.flexBasis??1)/p;return{tokenBudget:Math.floor(e.remainingTokenBudget*g),endpoint:e.endpoint,countTokens:(v,b)=>this._tokenizer.tokenLength(v,b)}});e.consume(-d),await Promise.all(u.map(async({element:h,promptElementInstance:g},v)=>{let b=await g.prepare?.(f[v],n,o);h.node.setState(b)}));let m=await Promise.all(u.map(async({element:h,promptElementInstance:g},v)=>{let b=f[v];return await g.render(h.node.getState(),b,n,o)}));for(let[h,{element:g,promptElementInstance:v}]of u.entries()){let b=f[h],_=m[h];if(!_)continue;let x=the(_),S=new c2(b.tokenBudget,this._endpoint),{tokensConsumed:I}=await SHe(this._tokenizer,g,v,x);this.tracer?.didRenderElement(g.ctor.name,x.filter(w=>w.kind==="literal").map(w=>w.value)),S.consume(I),await this._handlePromptChildren(g,x,S,n,o),this.tracer?.didRenderChildren(S.consumed),e.consume(S.consumed)}this.tracer?.endRenderFlex()}this.tracer?.endRenderPass()}async _prioritize(e,r,n){let o=[],s=[],a=0;for(;a<e.length;){if(!e[a].isImplicitLinebreak){let u=e[a-1]?.isImplicitLinebreak?{index:a,precedingLinebreak:a-1}:{index:a};o.push(u),s[a]=null}a+=1}o.sort((u,d)=>r(e[u.index],e[d.index]));let c=this._endpoint.modelMaxPromptTokens,l=[];for(;o.length>0;){let u=o.shift(),d=u.index,p=e[d],f=await n(p),m;if(u.precedingLinebreak&&(m=e[u.precedingLinebreak],f+=await n(m)),f>c){l.push(p);break}s[d]=p,u.precedingLinebreak&&m&&(s[u.precedingLinebreak]=m),c-=f}for(let u of o){let d=u.index,p=e[d];l.push(p)}return{result:(0,a2.coalesce)(s),tokenCount:this._endpoint.modelMaxPromptTokens-c,omittedChunks:l}}async renderElementJSON(e){return await this._processPromptPieces(new c2(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[]}],void 0,e),{node:this._root.toJSON()}}async render(e,r){await this._processPromptPieces(new c2(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[]}],e,r);let{result:n,resultChunks:o}=this._root.materialize(),s=new Set,{result:a,omittedChunks:c}=await this._prioritize(o,(v,b)=>pI.cmp(v,b),async v=>{let b=await this._tokenizer.tokenLength(v.text);return s.has(v.message)||(s.add(v.message),b=await this._tokenizer.countMessageTokens(v.toChatMessage())),b}),l=new Map;for(let v of(0,a2.coalesce)(a)){let b=l.get(v.message)??[];b[v.childIndex]=v,l.set(v.message,b)}let u=[];for(let v of n){let b=l.get(v);if(b){v.chunks=(0,a2.coalesce)(b);for(let _ of b)_&&_.references.length>0&&v.references.push(..._.references);u.push(v)}}let{result:d,tokenCount:p}=await this._prioritize(u,(v,b)=>IF.cmp(v,b),async v=>this._tokenizer.countMessageTokens(v.toChatMessage())),f=d.map(v=>v?.toChatMessage()),{references:m,names:h}=d.reduce((v,b)=>([...this._references,...b.references].forEach(_=>{let x="variableName"in _.anchor;x&&!v.names.has(_.anchor.variableName)?(v.references.push(_),v.names.add(_.anchor.variableName)):x||v.references.push(_)}),v),{references:[],names:new Set}),{references:g}=c.reduce((v,b)=>(b.references.forEach(_=>{let x="variableName"in _.anchor;x&&!h.has(_.anchor.variableName)?(v.references.push(_),h.add(_.anchor.variableName)):x||v.references.push(_)}),v),{references:[]});return{messages:f,hasIgnoredFiles:this._ignoredFiles.length>0,tokenCount:p,references:(0,a2.coalesce)(m),omittedReferences:(0,a2.coalesce)(g)}}_handlePromptChildren(e,r,n,o,s){if(e.ctor===lv.TextChunk){this._handleExtrinsicTextChunkChildren(e.node.parent,e.node,e.props,r);return}let a=[];for(let c of r){if(c.kind==="literal"){e.node.appendStringChild(c.value,e.props.priority??Number.MAX_SAFE_INTEGER);continue}if(c.kind==="intrinsic"){this._handleIntrinsic(e.node,c.name,{priority:e.props.priority??Number.MAX_SAFE_INTEGER,...c.props},OW(c.children));continue}let l=e.node.createChild();a.push({node:l,ctor:c.ctor,props:{priority:e.props.priority,...c.props},children:c.children})}return this._processPromptPieces(n,a,o,s)}_handleIntrinsic(e,r,n,o,s){switch(r){case"meta":return this._handleIntrinsicMeta(e,n,o);case"br":return this._handleIntrinsicLineBreak(e,n,o,n.priority,s);case"usedContext":return this._handleIntrinsicUsedContext(e,n,o);case"references":return this._handleIntrinsicReferences(e,n,o);case"ignoredFiles":return this._handleIntrinsicIgnoredFiles(e,n,o);case"elementJSON":return this._handleIntrinsicElementJSON(e,n.data)}throw new Error(`Unknown intrinsic element ${r}!`)}_handleIntrinsicMeta(e,r,n){if(n.length>0)throw new Error("<meta /> must not have children!");let o=Object.getPrototypeOf(r.value).constructor;if(this._meta.has(o))throw new Error(`Duplicate metadata ${o.name}!`);this._meta.set(o,r.value)}_handleIntrinsicLineBreak(e,r,n,o,s){if(n.length>0)throw new Error("<br /> must not have children!");e.appendLineBreak(!0,o??Number.MAX_SAFE_INTEGER,s)}_handleIntrinsicElementJSON(e,r){e.appendPieceJSON(r.node)}_handleIntrinsicUsedContext(e,r,n){if(n.length>0)throw new Error("<usedContext /> must not have children!");this._usedContext.push(...r.value)}_handleIntrinsicReferences(e,r,n){if(n.length>0)throw new Error("<reference /> must not have children!");e.addReferences(r.value),this._references.push(...r.value)}_handleIntrinsicIgnoredFiles(e,r,n){if(n.length>0)throw new Error("<ignoredFiles /> must not have children!");this._ignoredFiles.push(...r.value)}_handleExtrinsicTextChunkChildren(e,r,n,o){let s=[],a=[];for(let c of o){if(c.kind==="extrinsic")throw new Error("TextChunk cannot have extrinsic children!");c.kind==="literal"&&s.push(c.value),c.kind==="intrinsic"&&(c.name==="br"?s.push(`
`):c.name==="references"?a.push(...c.props.value):this._handleIntrinsic(e,c.name,c.props,OW(c.children),r.childIndex))}e.appendLineBreak(!1,void 0,r.childIndex),e.appendStringChild(s.join(""),n?.priority??Number.MAX_SAFE_INTEGER,a,r.childIndex)}};fI.PromptRenderer=LW;async function SHe(t,e,r,n){let o=0;(0,lv.isChatMessagePromptElement)(r)&&(o+=await t.countMessageTokens({role:e.props.role,content:"",...e.props.name?{name:e.props.name}:void 0}));for(let s of n)s.kind==="literal"&&(o+=await t.tokenLength(s.value));return{tokensConsumed:o}}function the(t){return typeof t>"u"||typeof t=="boolean"?[]:typeof t=="string"||typeof t=="number"?[new UW(String(t))]:IHe(t)?[...OW(t.children)]:typeof t.ctor=="string"?[new MW(t.ctor,t.props,t.children)]:[new FW(t.ctor,t.props,t.children)]}function OW(t){return(t??[]).reduce((e,r)=>(e.push(...the(r)),e),[])}var MW=class{constructor(e,r,n){this.name=e,this.props=r,this.children=n,this.kind="intrinsic"}},FW=class{constructor(e,r,n){this.ctor=e,this.props=r,this.children=n,this.kind="extrinsic"}},UW=class{constructor(e,r){this.value=e,this.priority=r,this.kind="literal"}},c2=class{constructor(e,r){this.tokenBudget=e,this.endpoint=r,this._consumed=0}get consumed(){return this._consumed>this.tokenBudget?this.tokenBudget:this._consumed}get remainingTokenBudget(){return Math.max(0,this.tokenBudget-this._consumed)}consume(e){this._consumed+=e}},BW=class t{static fromJSON(e,r){let n=new t(null,e);switch(n._references=r.references?.map(o=>ehe.PromptReference.fromJSON(o))??[],n._children=r.children.map((o,s)=>{switch(o.type){case 1:return t.fromJSON(s,o);case 2:return CF.fromJSON(n,s,o);case 3:return l2.fromJSON(n,s,o);default:}}).filter(CHe),r.ctor){case 1:n._obj=new lv.BaseChatMessage(r.props);break;case 2:break;default:r.ctor}return n}constructor(e=null,r){this.parent=e,this.childIndex=r,this.kind=1,this._obj=null,this._state=void 0,this._children=[],this._references=[]}setObj(e){this._obj=e}setState(e){this._state=e}getState(){return this._state}createChild(){let e=new t(this,this._children.length);return this._children.push(e),e}appendPieceJSON(e){let r=t.fromJSON(this._children.length,e);return this._children.push(r),r}appendStringChild(e,r,n,o=this._children.length){this._children.push(new CF(this,o,e,r,n))}appendLineBreak(e=!0,r,n=this._children.length){this._children.push(new l2(this,n,e,r))}materialize(){let e=[],r=[];return this._materialize(e,r),{result:e,resultChunks:r}}toJSON(){let e={type:1,ctor:2,children:this._children.slice().sort((r,n)=>r.childIndex-n.childIndex).map(r=>r.toJSON()),priority:this._obj?.props.priority,references:this._references?.map(r=>r.toJSON())};return this._obj instanceof lv.BaseChatMessage&&(e.ctor=1,e.props={role:this._obj.props.role,name:this._obj.props.name,priority:this._obj.props.priority,toolCalls:this._obj.props.toolCalls,toolCallId:this._obj.props.toolCallId}),e}_materialize(e,r){if(this._children.sort((n,o)=>n.childIndex-o.childIndex),this._obj instanceof lv.BaseChatMessage){if(!this._obj.props.role)throw new Error("Invalid ChatMessage!");let n=[];for(let c of this._children)c.collectLeafs(n);let o=[],s=new IF(this._obj.props.role,this._obj.props.name,this._obj instanceof lv.AssistantMessage?this._obj.props.toolCalls:void 0,this._obj instanceof lv.ToolMessage?this._obj.props.toolCallId:void 0,this._obj.props.priority,this.childIndex,o),a=r.length;n.forEach((c,l)=>{c.kind===2?o.push(new pI(s,c.text,c.priority,a++,!1,c.references??this._references)):c.isExplicit?o.push(new pI(s,`
`,c.priority,a++)):(o.length>0&&o[o.length-1].text!==`
`||o[l-1]&&o[l-1].text!==`
`)&&o.push(new pI(s,`
`,c.priority,a++,!0))}),r.push(...o),e.push(s)}else for(let n of this._children){if(n.kind===2)throw new Error(`Cannot have a text node outside a ChatMessage. Text: "${n.text}"`);if(n.kind===3)throw new Error("Cannot have a line break node outside a ChatMessage!");n._materialize(e,r)}}collectLeafs(e){if(this._obj instanceof lv.BaseChatMessage)throw new Error("Cannot have a ChatMessage nested inside a ChatMessage!");this._obj?.insertLineBreakBefore&&e.push(new l2(this,0,!1));for(let r of this._children.sort((n,o)=>n.childIndex-o.childIndex))r.collectLeafs(e)}addReferences(e){this._references.push(...e)}},pI=class{constructor(e,r,n,o,s=!1,a=[]){this.message=e,this.text=r,this.priority=n,this.childIndex=o,this.isImplicitLinebreak=s,this.references=a}static cmp(e,r){return e.priority!==void 0&&r.priority!==void 0&&e.priority===r.priority?e.message===r.message?e.childIndex-r.childIndex:r.childIndex-e.childIndex:e.priority!==void 0&&r.priority!==void 0&&e.priority!==r.priority?r.priority-e.priority:e.childIndex-r.childIndex}toChatMessage(){let e=this.message.toChatMessage();return e.content=this.text,e}},IF=class{constructor(e,r,n,o,s,a,c,l=[]){this.role=e,this.name=r,this.toolCalls=n,this.toolCallId=o,this.priority=s,this.childIndex=a,this._chunks=c,this.references=l}set chunks(e){this._chunks=e}get text(){return this._chunks.reduce((e,r,n)=>((n!==this._chunks.length-1||!r.isImplicitLinebreak)&&(e+=r.text),e),"")}toChatMessage(){return this.role===SF.ChatRole.System?{role:this.role,content:this.text,...this.name?{name:this.name}:{}}:this.role===SF.ChatRole.Assistant?{role:this.role,content:this.text,...this.toolCalls?{tool_calls:this.toolCalls}:{},...this.name?{name:this.name}:{}}:this.role===SF.ChatRole.User?{role:this.role,content:this.text,...this.name?{name:this.name}:{}}:this.role===SF.ChatRole.Tool?{role:this.role,content:this.text,tool_call_id:this.toolCallId}:{role:this.role,content:this.text,name:this.name}}static cmp(e,r){return e.priority!==r.priority?(r.priority||0)-(e.priority||0):r.childIndex-e.childIndex}},CF=class t{static fromJSON(e,r,n){return new t(e,r,n.text,n.priority,n.references?.map(o=>ehe.PromptReference.fromJSON(o)))}constructor(e,r,n,o,s){this.parent=e,this.childIndex=r,this.text=n,this.priority=o,this.references=s,this.kind=2}collectLeafs(e){e.push(this)}toJSON(){return{type:2,priority:this.priority,text:this.text,references:this.references?.map(e=>e.toJSON())}}},l2=class t{static fromJSON(e,r,n){return new t(e,r,n.isExplicit,n.priority)}constructor(e,r,n,o){this.parent=e,this.childIndex=r,this.isExplicit=n,this.priority=o,this.kind=3}collectLeafs(e){e.push(this)}toJSON(){return{type:3,isExplicit:this.isExplicit,priority:this.priority}}};function IHe(t){return(typeof t.ctor=="function"&&t.ctor.isFragment)??!1}function CHe(t){return t!==void 0}});var rhe=R(TF=>{"use strict";Object.defineProperty(TF,"__esModule",{value:!0});TF.AnyTokenizer=void 0;var u2=lI(),jW=class{constructor(e){this.countTokens=e}async tokenLength(e,r){return this.countTokens(e,r)}async countMessageTokens(e){return this.countTokens({role:this.toChatRole(e.role),content:e.content,content2:[e.content],name:"name"in e?e.name:void 0})}toChatRole(e){switch(e){case u2.ChatRole.User:return 1;case u2.ChatRole.Assistant:return 2;case u2.ChatRole.System:return 1;case u2.ChatRole.Function:return 1;case u2.ChatRole.Tool:return 1}}};TF.AnyTokenizer=jW});var nhe=R(EF=>{"use strict";Object.defineProperty(EF,"__esModule",{value:!0});EF.HTMLTracer=void 0;var VW=class{constructor(){this.entities=[],this.value="",this.elementStack=[]}startRenderPass(){let e=this.elementStack[this.elementStack.length-1];e&&!e.hadChildren&&(e.hadChildren=!0,this.value+="<details><summary>Children</summary>"),this.value+='<div class="render-pass">'}startRenderFlex(e,r,n){this.value+=`<h2>flexGrow=${e}</h2><div class="render-flex"><p>${r} tokens reserved, ${n} tokens to split between children</p>`}didRenderElement(e,r){this.value+=`<h3>${this.entity(`<${e} />`)}</h3><div class="render-element">`,r.length&&(this.value+=`<ul class="literals">${r.map(n=>this.entity(n.replace(/\n/g,"\\n"),"li")).join("")}</ul>`),this.elementStack.push({hadChildren:!1})}didRenderChildren(e){this.elementStack.pop().hadChildren&&(this.value+="</details>"),e&&(this.value+=`<p>${e} tokens consumed by children</p></div>`)}endRenderFlex(){this.value+="</div>"}endRenderPass(){this.value+="</div>"}toHTML(){return this.value+`<script>const ents = ${JSON.stringify(this.entities)}; for (let i = 0; i < ents.length; i++) document.querySelector('.entity-' + i).innerText = ents[i]; </script><style>${THe}</style>`}entity(e,r="span"){return this.entities.push(e),`<${r} class="entity-${this.entities.length-1}"></${r}>`}};EF.HTMLTracer=VW;var THe=`body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
}

.render-pass {
  padding: 4px;
  border-left: 2px solid #ccc;

  &:hover {
    border-left-color: #000;
  }
}

.literals li {
  white-space: pre;
  font-family: monospace;
}

.render-flex, .render-element {
  padding-left: 10px;
}`});var ohe=R(ihe=>{"use strict";Object.defineProperty(ihe,"__esModule",{value:!0})});var ahe=R(she=>{"use strict";Object.defineProperty(she,"__esModule",{value:!0})});var lhe=R(che=>{"use strict";Object.defineProperty(che,"__esModule",{value:!0})});var Ue=R(br=>{"use strict";var EHe=br&&br.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),d2=br&&br.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&EHe(e,t,r)};Object.defineProperty(br,"__esModule",{value:!0});br.contentType=br.PromptRenderer=br.MetadataMap=br.PromptElement=br.UserMessage=br.TextChunk=br.SystemMessage=br.PrioritizedList=br.FunctionMessage=br.AssistantMessage=br.ChatRole=br.JSONTree=void 0;br.renderPrompt=PHe;br.renderElementJSON=AHe;br.toVsCodeChatMessages=phe;var wF=lI(),uhe=qW(),wHe=rhe();d2(nhe(),br);br.JSONTree=hW();var kHe=lI();Object.defineProperty(br,"ChatRole",{enumerable:!0,get:function(){return kHe.ChatRole}});d2(DW(),br);d2(ohe(),br);d2(ahe(),br);d2(lhe(),br);var mI=fF();Object.defineProperty(br,"AssistantMessage",{enumerable:!0,get:function(){return mI.AssistantMessage}});Object.defineProperty(br,"FunctionMessage",{enumerable:!0,get:function(){return mI.FunctionMessage}});Object.defineProperty(br,"PrioritizedList",{enumerable:!0,get:function(){return mI.PrioritizedList}});Object.defineProperty(br,"SystemMessage",{enumerable:!0,get:function(){return mI.SystemMessage}});Object.defineProperty(br,"TextChunk",{enumerable:!0,get:function(){return mI.TextChunk}});Object.defineProperty(br,"UserMessage",{enumerable:!0,get:function(){return mI.UserMessage}});var RHe=vW();Object.defineProperty(br,"PromptElement",{enumerable:!0,get:function(){return RHe.PromptElement}});var dhe=qW();Object.defineProperty(br,"MetadataMap",{enumerable:!0,get:function(){return dhe.MetadataMap}});Object.defineProperty(br,"PromptRenderer",{enumerable:!0,get:function(){return dhe.PromptRenderer}});async function PHe(t,e,r,n,o,s,a="vscode"){let c="countTokens"in n?new wHe.AnyTokenizer((h,g)=>n.countTokens(h,g)):n,l=new uhe.PromptRenderer(r,t,e,c),{messages:u,tokenCount:d,references:p}=await l.render(o,s),f=l.getAllMeta(),m=l.getUsedContext();return a==="vscode"&&(u=phe(u)),{messages:u,tokenCount:d,metadatas:f,usedContext:m,references:p}}br.contentType="application/vnd.codechat.prompt+json.1";function AHe(t,e,r,n){return new uhe.PromptRenderer({modelMaxPromptTokens:r?.tokenBudget??Number.MAX_SAFE_INTEGER},t,e,{countMessageTokens(s){throw new Error("Tools may only return text, not messages.")},tokenLength(s,a){return Promise.resolve(r?.countTokens(s,a)??Promise.resolve(1))}}).renderElementJSON(n)}function phe(t){let e=require("vscode");return t.map(r=>{switch(r.role){case wF.ChatRole.Assistant:let n=e.LanguageModelChatMessage.Assistant(r.content,r.name);return r.tool_calls&&(n.content2=[r.content],n.content2.push(...r.tool_calls.map(o=>new e.LanguageModelChatResponseToolCallPart(o.function.name,o.function.arguments,o.id)))),n;case wF.ChatRole.User:return e.LanguageModelChatMessage.User(r.content,r.name);case wF.ChatRole.Function:{let o=e.LanguageModelChatMessage.User("");return o.content2=[new e.LanguageModelChatMessageFunctionResultPart(r.name,r.content)],o}case wF.ChatRole.Tool:{let o=e.LanguageModelChatMessage.User(r.content);return o.content2=[new e.LanguageModelChatMessageFunctionResultPart(r.tool_call_id,r.content)],o}default:throw new Error(`Converting chat message with role ${r.role} to VS Code chat message is not supported.`)}})}});var fhe=R(bp=>{"use strict";Object.defineProperty(bp,"__esModule",{value:!0});bp.bytePairEncode=bp.BinaryMap=bp.binaryMapKey=void 0;var DHe=(t,e,r)=>{let n=r-e,o=16777215>>>Math.max(0,(3-n)*8),s=(t[e+0]|t[e+1]<<8|t[e+2]<<16)&o,a=16777215>>>Math.min(31,Math.max(0,(6-n)*8)),c=(t[e+3]|t[e+4]<<8|t[e+5]<<16)&a;return s+16777216*c};bp.binaryMapKey=DHe;var HW=class t{constructor(){this.nested=new Map,this.final=new Map}get(e,r=0,n=e.length){let o=n<6+r,s=(0,bp.binaryMapKey)(e,r,n);return o?this.final.get(s):this.nested.get(s)?.get(e,6+r,n)}set(e,r){let n=(0,bp.binaryMapKey)(e,0,e.length);if(e.length<6){this.final.set(n,r);return}let s=this.nested.get(n);if(s instanceof t)s.set(e.subarray(6),r);else{let a=new t;a.set(e.subarray(6),r),this.nested.set(n,a)}}};bp.BinaryMap=HW;var yp=new Int32Array(128),Aa=new Int32Array(128);function NHe(t,e,r){if(r===1)return[e.get(t)];let n=2147483647,o=-1;for(;yp.length<r*2;)Aa=new Int32Array(Aa.length*2),yp=new Int32Array(yp.length*2);for(let l=0;l<r-1;l++){let u=e.get(t,l,l+2)??2147483647;u<n&&(n=u,o=l),Aa[l]=l,yp[l]=u}Aa[r-1]=r-1,yp[r-1]=2147483647,Aa[r]=r,yp[r]=2147483647;let s=r+1;function a(l,u=0){if(l+u+2<s){let d=e.get(t,Aa[l],Aa[l+u+2]);if(d!==void 0)return d}return 2147483647}for(;n!==2147483647;){yp[Aa[o]]=a(o,1),o>0&&(yp[Aa[o-1]]=a(o-1,1));for(let l=o+1;l<s-1;l++)Aa[l]=Aa[l+1];s--,o=-1,n=2147483647;for(let l=0;l<s-1;l++){let u=yp[Aa[l]];yp[Aa[l]]<n&&(n=u,o=l)}}let c=[];for(let l=0;l<s-1;l++)c.push(e.get(t,Aa[l],Aa[l+1]));return c}bp.bytePairEncode=NHe});var mhe=R(kF=>{"use strict";Object.defineProperty(kF,"__esModule",{value:!0});kF.makeTextEncoder=void 0;var GW=class{constructor(){this.length=0,this.encoder=new TextEncoder}encode(e){let r=this.encoder.encode(e);return this.length=r.length,r}},zW=class{constructor(){this.buffer=Buffer.alloc(256),this.length=0}encode(e){for(;;){if(this.length=this.buffer.write(e,"utf8"),this.length<this.buffer.length-4)return this.buffer;this.buffer=Buffer.alloc(this.length*2),this.length=this.buffer.write(e)}}},LHe=()=>typeof Buffer<"u"?new zW:new GW;kF.makeTextEncoder=LHe});var hhe=R(RF=>{"use strict";Object.defineProperty(RF,"__esModule",{value:!0});RF.LRUCache=void 0;var $W=class{constructor(e){this.size=e,this.nodes=new Map}get(e){let r=this.nodes.get(e);if(r)return this.moveToHead(r),r.value}set(e,r){let n=this.nodes.get(e);if(n)n.value=r,this.moveToHead(n);else{let o=new WW(e,r);this.nodes.set(e,o),this.addNode(o),this.nodes.size>this.size&&(this.nodes.delete(this.tail.key),this.removeNode(this.tail))}}moveToHead(e){this.removeNode(e),this.addNode(e)}addNode(e){this.head&&(this.head.prev=e,e.next=this.head),this.tail||(this.tail=e),this.head=e}removeNode(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev}};RF.LRUCache=$W;var WW=class{constructor(e,r){this.key=e,this.value=r}}});var YW=R(AF=>{"use strict";Object.defineProperty(AF,"__esModule",{value:!0});AF.TikTokenizer=void 0;var OHe=require("fs"),MHe=require("util"),PF=fhe(),FHe=mhe(),UHe=hhe();function BHe(t){let e=new Map;try{let n=OHe.readFileSync(t,"utf-8");return r(n),e}catch(n){throw new Error(`Failed to load from BPE encoder file stream: ${n}`)}function r(n){for(let o of n.split(/[\r\n]+/)){if(o.trim()==="")continue;let s=o.split(" ");if(s.length!==2)throw new Error("Invalid format in the BPE encoder file stream");let a=new Uint8Array(Buffer.from(s[0],"base64")),c=parseInt(s[1]);if(!isNaN(c))e.set(a,c);else throw new Error(`Can't parse ${s[1]} to integer`)}}}function qHe(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var KW=class{constructor(e,r,n,o=8192){this.textEncoder=(0,FHe.makeTextEncoder)(),this.textDecoder=new MHe.TextDecoder("utf-8"),this.cache=new UHe.LRUCache(o);let s=typeof e=="string"?BHe(e):e;this.init(s,r,n)}init(e,r,n){this.encoder=new PF.BinaryMap;for(let[o,s]of e)this.encoder.set(o,s);this.regex=new RegExp(n,"gu"),this.specialTokensRegex=new RegExp(Array.from(r.keys()).map(o=>qHe(o)).join("|")),this.specialTokensEncoder=r,this.decoder=new Map;for(let[o,s]of e)this.decoder.set(s,o);if(e.size!==this.decoder.size)throw new Error("Encoder and decoder sizes do not match");this.specialTokensDecoder=new Map;for(let[o,s]of r)this.specialTokensDecoder.set(s,o)}findNextSpecialToken(e,r,n){let o=r,s=null;if(n&&this.specialTokensRegex)for(;s=e.slice(o).match(this.specialTokensRegex),!(!s||n&&n.includes(s[0]));)o+=s.index+1;let a=s?o+s.index:e.length;return[s,a]}encode(e,r){let n=[],o=0;for(;;){let s,a;if([s,a]=this.findNextSpecialToken(e,o,r),a>o&&this.encodeByIndex(e,n,o,a),s){if(o=o+this.encodeSpecialToken(n,s),o>=e.length)break}else break}return n}encodeSpecialToken(e,r){let n=this.specialTokensEncoder?.get(r[0]);return e.push(n),r.index+r[0].length}encodeByIndex(e,r,n,o){let s,a=e.substring(n,o);for(this.regex.lastIndex=0;s=this.regex.exec(a);){let c=this.cache.get(s[0]);if(c)for(let l of c)r.push(l);else{let l=this.textEncoder.encode(s[0]),u=this.encoder.get(l,0,this.textEncoder.length);if(u!==void 0)r.push(u),this.cache.set(s[0],[u]);else{let d=(0,PF.bytePairEncode)(l,this.encoder,this.textEncoder.length);for(let p of d)r.push(p);this.cache.set(s[0],d)}}}}encodeTrimSuffixByIndex(e,r,n,o,s,a,c){let l,u=e.substring(n,o);for(this.regex.lastIndex=0;l=this.regex.exec(u);){let d=l[0],p=this.cache.get(d);if(p)if(a+p.length<=s)a+=p.length,c+=d.length,r.push(...p);else{let f=s-a;a+=f,c+=d.length,r.push(...p.slice(0,f));break}else{let f=this.textEncoder.encode(d),m=this.encoder.get(f,0,f.length);if(m!==void 0)if(this.cache.set(d,[m]),a+1<=s)a++,c+=d.length,r.push(m);else break;else{let h=(0,PF.bytePairEncode)(f,this.encoder,this.textEncoder.length);if(this.cache.set(d,h),a+h.length<=s){a+=h.length,c+=d.length;for(let g of h)r.push(g)}else{let g=s-a;a+=g,c+=d.length;for(let v=0;v<g;v++)r.push(h[v]);break}}}if(a>=s)break}return{tokenCount:a,encodeLength:c}}encodeTrimSuffix(e,r,n){let o=[],s=0,a=0,c=0;for(;;){let u,d;if([u,d]=this.findNextSpecialToken(e,s,n),d>s){let{tokenCount:p,encodeLength:f}=this.encodeTrimSuffixByIndex(e,o,s,d,r,a,c);if(a=p,c=f,a>=r)break}if(u!==null){if(a++,a<=r&&(s=s+this.encodeSpecialToken(o,u),c+=u[0].length,s>=e.length)||a>=r)break}else break}let l=c===e.length?e:e.slice(0,c);return{tokenIds:o,text:l}}encodeTrimPrefix(e,r,n){let o=[],s=0,a=0,c=0,l=new Map;for(l.set(a,c);;){let f,m;if([f,m]=this.findNextSpecialToken(e,s,n),m>s){let h,g=e.substring(s,m);for(this.regex.lastIndex=0;h=this.regex.exec(g);){let v=h[0],b=this.cache.get(v);if(b)a+=b.length,c+=v.length,o.push(...b),l.set(a,c);else{let _=this.textEncoder.encode(v),x=this.encoder.get(_);if(x!==void 0)this.cache.set(v,[x]),a++,c+=v.length,o.push(x),l.set(a,c);else{let S=(0,PF.bytePairEncode)(_,this.encoder,this.textEncoder.length);this.cache.set(v,S),a+=S.length,c+=v.length;for(let I of S)o.push(I);l.set(a,c)}}}}if(f!==null){if(s=s+this.encodeSpecialToken(o,f),a++,c+=f[0].length,l.set(a,c),s>=e.length)break}else break}if(a<=r)return{tokenIds:o,text:e};let u=a-r,d=0,p=0;for(let[f,m]of l)if(f>=u){d=f,p=m;break}if(d>r){let f=this.encode(e,n),m=f.slice(f.length-r);return{tokenIds:m,text:this.decode(m)}}return{tokenIds:o.slice(d),text:e.slice(p)}}decode(e){let r=[];for(let n of e){let o=[],s=this.decoder?.get(n);if(s!==void 0)o=Array.from(s);else{let a=this.specialTokensDecoder?.get(n);if(a!==void 0){let c=this.textEncoder.encode(a);o=Array.from(c.subarray(0,this.textEncoder.length))}}r.push(...o)}return this.textDecoder.decode(new Uint8Array(r))}};AF.TikTokenizer=KW});var The=R(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.createTokenizer=ho.createByEncoderName=ho.createByModelName=ho.getRegexByModel=ho.getRegexByEncoder=ho.getSpecialTokensByModel=ho.getSpecialTokensByEncoder=ho.MODEL_TO_ENCODING=void 0;var NF=require("fs"),QW=require("path"),jHe=YW(),VHe=new Map([["gpt-4o-","o200k_base"],["gpt-4-","cl100k_base"],["gpt-3.5-turbo-","cl100k_base"],["gpt-35-turbo-","cl100k_base"]]);ho.MODEL_TO_ENCODING=new Map([["gpt-4o","o200k_base"],["gpt-4","cl100k_base"],["gpt-3.5-turbo","cl100k_base"],["text-davinci-003","p50k_base"],["text-davinci-002","p50k_base"],["text-davinci-001","r50k_base"],["text-curie-001","r50k_base"],["text-babbage-001","r50k_base"],["text-ada-001","r50k_base"],["davinci","r50k_base"],["curie","r50k_base"],["babbage","r50k_base"],["ada","r50k_base"],["code-davinci-002","p50k_base"],["code-davinci-001","p50k_base"],["code-cushman-002","p50k_base"],["code-cushman-001","p50k_base"],["davinci-codex","p50k_base"],["cushman-codex","p50k_base"],["text-davinci-edit-001","p50k_edit"],["code-davinci-edit-001","p50k_edit"],["text-embedding-ada-002","cl100k_base"],["text-similarity-davinci-001","r50k_base"],["text-similarity-curie-001","r50k_base"],["text-similarity-babbage-001","r50k_base"],["text-similarity-ada-001","r50k_base"],["text-search-davinci-doc-001","r50k_base"],["text-search-curie-doc-001","r50k_base"],["text-search-babbage-doc-001","r50k_base"],["text-search-ada-doc-001","r50k_base"],["code-search-babbage-code-001","r50k_base"],["code-search-ada-code-001","r50k_base"],["gpt2","gpt2"]]);var DF="<|endoftext|>",ghe="<|fim_prefix|>",vhe="<|fim_middle|>",yhe="<|fim_suffix|>",bhe="<|endofprompt|>",p2="'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+",_he="(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)|[^\\r\\n\\p{L}\\p{N}]?\\p{L}+|\\p{N}{1,3}| ?[^\\s\\p{L}\\p{N}]+[\\r\\n]*|\\s*[\\r\\n]+|\\s+(?!\\S)|\\s+",HHe=[`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]*[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]+(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]+[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]*(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,"\\p{N}{1,3}"," ?[^\\s\\p{L}\\p{N}]+[\\r\\n/]*","\\s*[\\r\\n]+","\\s+(?!\\S)","\\s+"],xhe=HHe.join("|");function XW(t){let e="";if(ho.MODEL_TO_ENCODING.has(t))e=ho.MODEL_TO_ENCODING.get(t);else for(let[r,n]of VHe)if(t.startsWith(r)){e=n;break}return e}async function GHe(t,e){let r=await fetch(t);if(!r.ok)throw new Error(`Failed to fetch file from ${t}. Status code: ${r.status}`);let n=await r.text();NF.writeFileSync(e,n)}function JW(t){let e=new Map([[DF,50256]]);switch(t){case"o200k_base":e=new Map([[DF,199999],[bhe,200018]]);break;case"cl100k_base":e=new Map([[DF,100257],[ghe,100258],[vhe,100259],[yhe,100260],[bhe,100276]]);break;case"p50k_edit":e=new Map([[DF,50256],[ghe,50281],[vhe,50282],[yhe,50283]]);break;default:break}return e}ho.getSpecialTokensByEncoder=JW;function zHe(t){let e=XW(t);return JW(e)}ho.getSpecialTokensByModel=zHe;function She(t){switch(t){case"o200k_base":return xhe;case"cl100k_base":return _he;default:break}return p2}ho.getRegexByEncoder=She;function $He(t){let e=XW(t);return She(e)}ho.getRegexByModel=$He;async function WHe(t,e=null){return Ihe(XW(t),e)}ho.createByModelName=WHe;async function Ihe(t,e=null){let r,n,o=JW(t);switch(t){case"o200k_base":r=xhe,n="https://openaipublic.blob.core.windows.net/encodings/o200k_base.tiktoken";break;case"cl100k_base":r=_he,n="https://openaipublic.blob.core.windows.net/encodings/cl100k_base.tiktoken";break;case"p50k_base":r=p2,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"p50k_edit":r=p2,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"r50k_base":r=p2,n="https://openaipublic.blob.core.windows.net/encodings/r50k_base.tiktoken";break;case"gpt2":r=p2,n="https://raw.githubusercontent.com/microsoft/Tokenizer/main/model/gpt2.tiktoken";break;default:throw new Error(`Doesn't support this encoder [${t}]`)}e!==null&&(o=new Map([...o,...e]));let s=QW.basename(n),a=QW.resolve(__dirname,"..","model");NF.existsSync(a)||NF.mkdirSync(a,{recursive:!0});let c=QW.resolve(a,s);return NF.existsSync(c)||(console.log(`Downloading file from ${n}`),await GHe(n,c),console.log(`Saved file to ${c}`)),Che(c,o,r)}ho.createByEncoderName=Ihe;function Che(t,e,r,n=8192){return new jHe.TikTokenizer(t,e,r,n)}ho.createTokenizer=Che});var Ehe=R(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.createTokenizer=go.createByEncoderName=go.createByModelName=go.getSpecialTokensByModel=go.getSpecialTokensByEncoder=go.getRegexByModel=go.getRegexByEncoder=go.MODEL_TO_ENCODING=go.TikTokenizer=void 0;var KHe=YW();Object.defineProperty(go,"TikTokenizer",{enumerable:!0,get:function(){return KHe.TikTokenizer}});var uv=The();Object.defineProperty(go,"MODEL_TO_ENCODING",{enumerable:!0,get:function(){return uv.MODEL_TO_ENCODING}});Object.defineProperty(go,"getRegexByEncoder",{enumerable:!0,get:function(){return uv.getRegexByEncoder}});Object.defineProperty(go,"getRegexByModel",{enumerable:!0,get:function(){return uv.getRegexByModel}});Object.defineProperty(go,"getSpecialTokensByEncoder",{enumerable:!0,get:function(){return uv.getSpecialTokensByEncoder}});Object.defineProperty(go,"getSpecialTokensByModel",{enumerable:!0,get:function(){return uv.getSpecialTokensByModel}});Object.defineProperty(go,"createByModelName",{enumerable:!0,get:function(){return uv.createByModelName}});Object.defineProperty(go,"createByEncoderName",{enumerable:!0,get:function(){return uv.createByEncoderName}});Object.defineProperty(go,"createTokenizer",{enumerable:!0,get:function(){return uv.createTokenizer}})});var tD=R((Mjt,v0e)=>{"use strict";var jp="\\\\/",f0e=`[^${jp}]`,Qm="\\.",G$e="\\+",z$e="\\?",g6="\\/",$$e="(?=.)",m0e="[^/]",VY=`(?:${g6}|$)`,h0e=`(?:^|${g6})`,HY=`${Qm}{1,2}${VY}`,W$e=`(?!${Qm})`,K$e=`(?!${h0e}${HY})`,Y$e=`(?!${Qm}{0,1}${VY})`,Q$e=`(?!${HY})`,X$e=`[^.${g6}]`,J$e=`${m0e}*?`,Z$e="/",g0e={DOT_LITERAL:Qm,PLUS_LITERAL:G$e,QMARK_LITERAL:z$e,SLASH_LITERAL:g6,ONE_CHAR:$$e,QMARK:m0e,END_ANCHOR:VY,DOTS_SLASH:HY,NO_DOT:W$e,NO_DOTS:K$e,NO_DOT_SLASH:Y$e,NO_DOTS_SLASH:Q$e,QMARK_NO_DOT:X$e,STAR:J$e,START_ANCHOR:h0e,SEP:Z$e},eWe={...g0e,SLASH_LITERAL:`[${jp}]`,QMARK:f0e,STAR:`${f0e}*?`,DOTS_SLASH:`${Qm}{1,2}(?:[${jp}]|$)`,NO_DOT:`(?!${Qm})`,NO_DOTS:`(?!(?:^|[${jp}])${Qm}{1,2}(?:[${jp}]|$))`,NO_DOT_SLASH:`(?!${Qm}{0,1}(?:[${jp}]|$))`,NO_DOTS_SLASH:`(?!${Qm}{1,2}(?:[${jp}]|$))`,QMARK_NO_DOT:`[^.${jp}]`,START_ANCHOR:`(?:^|[${jp}])`,END_ANCHOR:`(?:[${jp}]|$)`,SEP:"\\"},tWe={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};v0e.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:tWe,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?eWe:g0e}}});var v6=R(gc=>{"use strict";var{REGEX_BACKSLASH:rWe,REGEX_REMOVE_BACKSLASH:nWe,REGEX_SPECIAL_CHARS:iWe,REGEX_SPECIAL_CHARS_GLOBAL:oWe}=tD();gc.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);gc.hasRegexChars=t=>iWe.test(t);gc.isRegexChar=t=>t.length===1&&gc.hasRegexChars(t);gc.escapeRegex=t=>t.replace(oWe,"\\$1");gc.toPosixSlashes=t=>t.replace(rWe,"/");gc.removeBackslashes=t=>t.replace(nWe,e=>e==="\\"?"":e);gc.supportsLookbehinds=()=>{if(typeof process<"u"){let t=process.version.slice(1).split(".").map(Number);if(t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10)return!0}return!1};gc.escapeLast=(t,e,r)=>{let n=t.lastIndexOf(e,r);return n===-1?t:t[n-1]==="\\"?gc.escapeLast(t,e,n-1):`${t.slice(0,n)}\\${t.slice(n)}`};gc.removePrefix=(t,e={})=>{let r=t;return r.startsWith("./")&&(r=r.slice(2),e.prefix="./"),r};gc.wrapOutput=(t,e={},r={})=>{let n=r.contains?"":"^",o=r.contains?"":"$",s=`${n}(?:${t})${o}`;return e.negated===!0&&(s=`(?:^(?!${s}).*$)`),s};gc.basename=(t,{windows:e}={})=>{let r=t.split(e?/[\\/]/:"/"),n=r[r.length-1];return n===""?r[r.length-2]:n}});var T0e=R((Ujt,C0e)=>{"use strict";var y0e=v6(),{CHAR_ASTERISK:GY,CHAR_AT:sWe,CHAR_BACKWARD_SLASH:rD,CHAR_COMMA:aWe,CHAR_DOT:zY,CHAR_EXCLAMATION_MARK:$Y,CHAR_FORWARD_SLASH:I0e,CHAR_LEFT_CURLY_BRACE:WY,CHAR_LEFT_PARENTHESES:KY,CHAR_LEFT_SQUARE_BRACKET:cWe,CHAR_PLUS:lWe,CHAR_QUESTION_MARK:b0e,CHAR_RIGHT_CURLY_BRACE:uWe,CHAR_RIGHT_PARENTHESES:_0e,CHAR_RIGHT_SQUARE_BRACKET:dWe}=tD(),x0e=t=>t===I0e||t===rD,S0e=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?1/0:1)},pWe=(t,e)=>{let r=e||{},n=t.length-1,o=r.parts===!0||r.scanToEnd===!0,s=[],a=[],c=[],l=t,u=-1,d=0,p=0,f=!1,m=!1,h=!1,g=!1,v=!1,b=!1,_=!1,x=!1,S=!1,I=!1,w=0,k,M,H={value:"",depth:0,isGlob:!1},F=()=>u>=n,ue=()=>l.charCodeAt(u+1),Z=()=>(k=M,l.charCodeAt(++u));for(;u<n;){M=Z();let U;if(M===rD){_=H.backslashes=!0,M=Z(),M===WY&&(b=!0);continue}if(b===!0||M===WY){for(w++;F()!==!0&&(M=Z());){if(M===rD){_=H.backslashes=!0,Z();continue}if(M===WY){w++;continue}if(b!==!0&&M===zY&&(M=Z())===zY){if(f=H.isBrace=!0,h=H.isGlob=!0,I=!0,o===!0)continue;break}if(b!==!0&&M===aWe){if(f=H.isBrace=!0,h=H.isGlob=!0,I=!0,o===!0)continue;break}if(M===uWe&&(w--,w===0)){b=!1,f=H.isBrace=!0,I=!0;break}}if(o===!0)continue;break}if(M===I0e){if(s.push(u),a.push(H),H={value:"",depth:0,isGlob:!1},I===!0)continue;if(k===zY&&u===d+1){d+=2;continue}p=u+1;continue}if(r.noext!==!0&&(M===lWe||M===sWe||M===GY||M===b0e||M===$Y)===!0&&ue()===KY){if(h=H.isGlob=!0,g=H.isExtglob=!0,I=!0,M===$Y&&u===d&&(S=!0),o===!0){for(;F()!==!0&&(M=Z());){if(M===rD){_=H.backslashes=!0,M=Z();continue}if(M===_0e){h=H.isGlob=!0,I=!0;break}}continue}break}if(M===GY){if(k===GY&&(v=H.isGlobstar=!0),h=H.isGlob=!0,I=!0,o===!0)continue;break}if(M===b0e){if(h=H.isGlob=!0,I=!0,o===!0)continue;break}if(M===cWe){for(;F()!==!0&&(U=Z());){if(U===rD){_=H.backslashes=!0,Z();continue}if(U===dWe){m=H.isBracket=!0,h=H.isGlob=!0,I=!0;break}}if(o===!0)continue;break}if(r.nonegate!==!0&&M===$Y&&u===d){x=H.negated=!0,d++;continue}if(r.noparen!==!0&&M===KY){if(h=H.isGlob=!0,o===!0){for(;F()!==!0&&(M=Z());){if(M===KY){_=H.backslashes=!0,M=Z();continue}if(M===_0e){I=!0;break}}continue}break}if(h===!0){if(I=!0,o===!0)continue;break}}r.noext===!0&&(g=!1,h=!1);let V=l,A="",P="";d>0&&(A=l.slice(0,d),l=l.slice(d),p-=d),V&&h===!0&&p>0?(V=l.slice(0,p),P=l.slice(p)):h===!0?(V="",P=l):V=l,V&&V!==""&&V!=="/"&&V!==l&&x0e(V.charCodeAt(V.length-1))&&(V=V.slice(0,-1)),r.unescape===!0&&(P&&(P=y0e.removeBackslashes(P)),V&&_===!0&&(V=y0e.removeBackslashes(V)));let B={prefix:A,input:t,start:d,base:V,glob:P,isBrace:f,isBracket:m,isGlob:h,isExtglob:g,isGlobstar:v,negated:x,negatedExtglob:S};if(r.tokens===!0&&(B.maxDepth=0,x0e(M)||a.push(H),B.tokens=a),r.parts===!0||r.tokens===!0){let U;for(let $=0;$<s.length;$++){let ce=U?U+1:d,W=s[$],Y=t.slice(ce,W);r.tokens&&($===0&&d!==0?(a[$].isPrefix=!0,a[$].value=A):a[$].value=Y,S0e(a[$]),B.maxDepth+=a[$].depth),($!==0||Y!=="")&&c.push(Y),U=W}if(U&&U+1<t.length){let $=t.slice(U+1);c.push($),r.tokens&&(a[a.length-1].value=$,S0e(a[a.length-1]),B.maxDepth+=a[a.length-1].depth)}B.slashes=s,B.parts=c}return B};C0e.exports=pWe});var k0e=R((Bjt,w0e)=>{"use strict";var y6=tD(),yd=v6(),{MAX_LENGTH:b6,POSIX_REGEX_SOURCE:fWe,REGEX_NON_SPECIAL_CHARS:mWe,REGEX_SPECIAL_CHARS_BACKREF:hWe,REPLACEMENTS:E0e}=y6,gWe=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let r=`[${t.join("-")}]`;try{new RegExp(r)}catch{return t.map(o=>yd.escapeRegex(o)).join("..")}return r},lC=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,YY=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=E0e[t]||t;let r={...e},n=typeof r.maxLength=="number"?Math.min(b6,r.maxLength):b6,o=t.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},a=[s],c=r.capture?"":"?:",l=y6.globChars(r.windows),u=y6.extglobChars(l),{DOT_LITERAL:d,PLUS_LITERAL:p,SLASH_LITERAL:f,ONE_CHAR:m,DOTS_SLASH:h,NO_DOT:g,NO_DOT_SLASH:v,NO_DOTS_SLASH:b,QMARK:_,QMARK_NO_DOT:x,STAR:S,START_ANCHOR:I}=l,w=_e=>`(${c}(?:(?!${I}${_e.dot?h:d}).)*?)`,k=r.dot?"":g,M=r.dot?_:x,H=r.bash===!0?w(r):S;r.capture&&(H=`(${H})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let F={input:t,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=yd.removePrefix(t,F),o=t.length;let ue=[],Z=[],V=[],A=s,P,B=()=>F.index===o-1,U=F.peek=(_e=1)=>t[F.index+_e],$=F.advance=()=>t[++F.index]||"",ce=()=>t.slice(F.index+1),W=(_e="",ut=0)=>{F.consumed+=_e,F.index+=ut},Y=_e=>{F.output+=_e.output!=null?_e.output:_e.value,W(_e.value)},Se=()=>{let _e=1;for(;U()==="!"&&(U(2)!=="("||U(3)==="?");)$(),F.start++,_e++;return _e%2===0?!1:(F.negated=!0,F.start++,!0)},ee=_e=>{F[_e]++,V.push(_e)},Ie=_e=>{F[_e]--,V.pop()},Xe=_e=>{if(A.type==="globstar"){let ut=F.braces>0&&(_e.type==="comma"||_e.type==="brace"),G=_e.extglob===!0||ue.length&&(_e.type==="pipe"||_e.type==="paren");_e.type!=="slash"&&_e.type!=="paren"&&!ut&&!G&&(F.output=F.output.slice(0,-A.output.length),A.type="star",A.value="*",A.output=H,F.output+=A.output)}if(ue.length&&_e.type!=="paren"&&(ue[ue.length-1].inner+=_e.value),(_e.value||_e.output)&&Y(_e),A&&A.type==="text"&&_e.type==="text"){A.value+=_e.value,A.output=(A.output||"")+_e.value;return}_e.prev=A,a.push(_e),A=_e},Ot=(_e,ut)=>{let G={...u[ut],conditions:1,inner:""};G.prev=A,G.parens=F.parens,G.output=F.output;let pe=(r.capture?"(":"")+G.open;ee("parens"),Xe({type:_e,value:ut,output:F.output?"":m}),Xe({type:"paren",extglob:!0,value:$(),output:pe}),ue.push(G)},Tr=_e=>{let ut=_e.close+(r.capture?")":""),G;if(_e.type==="negate"){let pe=H;if(_e.inner&&_e.inner.length>1&&_e.inner.includes("/")&&(pe=w(r)),(pe!==H||B()||/^\)+$/.test(ce()))&&(ut=_e.close=`)$))${pe}`),_e.inner.includes("*")&&(G=ce())&&/^\.[^\\/.]+$/.test(G)){let me=YY(G,{...e,fastpaths:!1}).output;ut=_e.close=`)${me})${pe})`}_e.prev.type==="bos"&&(F.negatedExtglob=!0)}Xe({type:"paren",extglob:!0,value:P,output:ut}),Ie("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let _e=!1,ut=t.replace(hWe,(G,pe,me,De,Ee,vt)=>De==="\\"?(_e=!0,G):De==="?"?pe?pe+De+(Ee?_.repeat(Ee.length):""):vt===0?M+(Ee?_.repeat(Ee.length):""):_.repeat(me.length):De==="."?d.repeat(me.length):De==="*"?pe?pe+De+(Ee?H:""):H:pe?G:`\\${G}`);return _e===!0&&(r.unescape===!0?ut=ut.replace(/\\/g,""):ut=ut.replace(/\\+/g,G=>G.length%2===0?"\\\\":G?"\\":"")),ut===t&&r.contains===!0?(F.output=t,F):(F.output=yd.wrapOutput(ut,F,e),F)}for(;!B();){if(P=$(),P==="\0")continue;if(P==="\\"){let G=U();if(G==="/"&&r.bash!==!0||G==="."||G===";")continue;if(!G){P+="\\",Xe({type:"text",value:P});continue}let pe=/^\\+/.exec(ce()),me=0;if(pe&&pe[0].length>2&&(me=pe[0].length,F.index+=me,me%2!==0&&(P+="\\")),r.unescape===!0?P=$():P+=$(),F.brackets===0){Xe({type:"text",value:P});continue}}if(F.brackets>0&&(P!=="]"||A.value==="["||A.value==="[^")){if(r.posix!==!1&&P===":"){let G=A.value.slice(1);if(G.includes("[")&&(A.posix=!0,G.includes(":"))){let pe=A.value.lastIndexOf("["),me=A.value.slice(0,pe),De=A.value.slice(pe+2),Ee=fWe[De];if(Ee){A.value=me+Ee,F.backtrack=!0,$(),!s.output&&a.indexOf(A)===1&&(s.output=m);continue}}}(P==="["&&U()!==":"||P==="-"&&U()==="]")&&(P=`\\${P}`),P==="]"&&(A.value==="["||A.value==="[^")&&(P=`\\${P}`),r.posix===!0&&P==="!"&&A.value==="["&&(P="^"),A.value+=P,Y({value:P});continue}if(F.quotes===1&&P!=='"'){P=yd.escapeRegex(P),A.value+=P,Y({value:P});continue}if(P==='"'){F.quotes=F.quotes===1?0:1,r.keepQuotes===!0&&Xe({type:"text",value:P});continue}if(P==="("){ee("parens"),Xe({type:"paren",value:P});continue}if(P===")"){if(F.parens===0&&r.strictBrackets===!0)throw new SyntaxError(lC("opening","("));let G=ue[ue.length-1];if(G&&F.parens===G.parens+1){Tr(ue.pop());continue}Xe({type:"paren",value:P,output:F.parens?")":"\\)"}),Ie("parens");continue}if(P==="["){if(r.nobracket===!0||!ce().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(lC("closing","]"));P=`\\${P}`}else ee("brackets");Xe({type:"bracket",value:P});continue}if(P==="]"){if(r.nobracket===!0||A&&A.type==="bracket"&&A.value.length===1){Xe({type:"text",value:P,output:`\\${P}`});continue}if(F.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(lC("opening","["));Xe({type:"text",value:P,output:`\\${P}`});continue}Ie("brackets");let G=A.value.slice(1);if(A.posix!==!0&&G[0]==="^"&&!G.includes("/")&&(P=`/${P}`),A.value+=P,Y({value:P}),r.literalBrackets===!1||yd.hasRegexChars(G))continue;let pe=yd.escapeRegex(A.value);if(F.output=F.output.slice(0,-A.value.length),r.literalBrackets===!0){F.output+=pe,A.value=pe;continue}A.value=`(${c}${pe}|${A.value})`,F.output+=A.value;continue}if(P==="{"&&r.nobrace!==!0){ee("braces");let G={type:"brace",value:P,output:"(",outputIndex:F.output.length,tokensIndex:F.tokens.length};Z.push(G),Xe(G);continue}if(P==="}"){let G=Z[Z.length-1];if(r.nobrace===!0||!G){Xe({type:"text",value:P,output:P});continue}let pe=")";if(G.dots===!0){let me=a.slice(),De=[];for(let Ee=me.length-1;Ee>=0&&(a.pop(),me[Ee].type!=="brace");Ee--)me[Ee].type!=="dots"&&De.unshift(me[Ee].value);pe=gWe(De,r),F.backtrack=!0}if(G.comma!==!0&&G.dots!==!0){let me=F.output.slice(0,G.outputIndex),De=F.tokens.slice(G.tokensIndex);G.value=G.output="\\{",P=pe="\\}",F.output=me;for(let Ee of De)F.output+=Ee.output||Ee.value}Xe({type:"brace",value:P,output:pe}),Ie("braces"),Z.pop();continue}if(P==="|"){ue.length>0&&ue[ue.length-1].conditions++,Xe({type:"text",value:P});continue}if(P===","){let G=P,pe=Z[Z.length-1];pe&&V[V.length-1]==="braces"&&(pe.comma=!0,G="|"),Xe({type:"comma",value:P,output:G});continue}if(P==="/"){if(A.type==="dot"&&F.index===F.start+1){F.start=F.index+1,F.consumed="",F.output="",a.pop(),A=s;continue}Xe({type:"slash",value:P,output:f});continue}if(P==="."){if(F.braces>0&&A.type==="dot"){A.value==="."&&(A.output=d);let G=Z[Z.length-1];A.type="dots",A.output+=P,A.value+=P,G.dots=!0;continue}if(F.braces+F.parens===0&&A.type!=="bos"&&A.type!=="slash"){Xe({type:"text",value:P,output:d});continue}Xe({type:"dot",value:P,output:d});continue}if(P==="?"){if(!(A&&A.value==="(")&&r.noextglob!==!0&&U()==="("&&U(2)!=="?"){Ot("qmark",P);continue}if(A&&A.type==="paren"){let pe=U(),me=P;if(pe==="<"&&!yd.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(A.value==="("&&!/[!=<:]/.test(pe)||pe==="<"&&!/<([!=]|\w+>)/.test(ce()))&&(me=`\\${P}`),Xe({type:"text",value:P,output:me});continue}if(r.dot!==!0&&(A.type==="slash"||A.type==="bos")){Xe({type:"qmark",value:P,output:x});continue}Xe({type:"qmark",value:P,output:_});continue}if(P==="!"){if(r.noextglob!==!0&&U()==="("&&(U(2)!=="?"||!/[!=<:]/.test(U(3)))){Ot("negate",P);continue}if(r.nonegate!==!0&&F.index===0){Se();continue}}if(P==="+"){if(r.noextglob!==!0&&U()==="("&&U(2)!=="?"){Ot("plus",P);continue}if(A&&A.value==="("||r.regex===!1){Xe({type:"plus",value:P,output:p});continue}if(A&&(A.type==="bracket"||A.type==="paren"||A.type==="brace")||F.parens>0){Xe({type:"plus",value:P});continue}Xe({type:"plus",value:p});continue}if(P==="@"){if(r.noextglob!==!0&&U()==="("&&U(2)!=="?"){Xe({type:"at",extglob:!0,value:P,output:""});continue}Xe({type:"text",value:P});continue}if(P!=="*"){(P==="$"||P==="^")&&(P=`\\${P}`);let G=mWe.exec(ce());G&&(P+=G[0],F.index+=G[0].length),Xe({type:"text",value:P});continue}if(A&&(A.type==="globstar"||A.star===!0)){A.type="star",A.star=!0,A.value+=P,A.output=H,F.backtrack=!0,F.globstar=!0,W(P);continue}let _e=ce();if(r.noextglob!==!0&&/^\([^?]/.test(_e)){Ot("star",P);continue}if(A.type==="star"){if(r.noglobstar===!0){W(P);continue}let G=A.prev,pe=G.prev,me=G.type==="slash"||G.type==="bos",De=pe&&(pe.type==="star"||pe.type==="globstar");if(r.bash===!0&&(!me||_e[0]&&_e[0]!=="/")){Xe({type:"star",value:P,output:""});continue}let Ee=F.braces>0&&(G.type==="comma"||G.type==="brace"),vt=ue.length&&(G.type==="pipe"||G.type==="paren");if(!me&&G.type!=="paren"&&!Ee&&!vt){Xe({type:"star",value:P,output:""});continue}for(;_e.slice(0,3)==="/**";){let Nt=t[F.index+4];if(Nt&&Nt!=="/")break;_e=_e.slice(3),W("/**",3)}if(G.type==="bos"&&B()){A.type="globstar",A.value+=P,A.output=w(r),F.output=A.output,F.globstar=!0,W(P);continue}if(G.type==="slash"&&G.prev.type!=="bos"&&!De&&B()){F.output=F.output.slice(0,-(G.output+A.output).length),G.output=`(?:${G.output}`,A.type="globstar",A.output=w(r)+(r.strictSlashes?")":"|$)"),A.value+=P,F.globstar=!0,F.output+=G.output+A.output,W(P);continue}if(G.type==="slash"&&G.prev.type!=="bos"&&_e[0]==="/"){let Nt=_e[1]!==void 0?"|$":"";F.output=F.output.slice(0,-(G.output+A.output).length),G.output=`(?:${G.output}`,A.type="globstar",A.output=`${w(r)}${f}|${f}${Nt})`,A.value+=P,F.output+=G.output+A.output,F.globstar=!0,W(P+$()),Xe({type:"slash",value:"/",output:""});continue}if(G.type==="bos"&&_e[0]==="/"){A.type="globstar",A.value+=P,A.output=`(?:^|${f}|${w(r)}${f})`,F.output=A.output,F.globstar=!0,W(P+$()),Xe({type:"slash",value:"/",output:""});continue}F.output=F.output.slice(0,-A.output.length),A.type="globstar",A.output=w(r),A.value+=P,F.output+=A.output,F.globstar=!0,W(P);continue}let ut={type:"star",value:P,output:H};if(r.bash===!0){ut.output=".*?",(A.type==="bos"||A.type==="slash")&&(ut.output=k+ut.output),Xe(ut);continue}if(A&&(A.type==="bracket"||A.type==="paren")&&r.regex===!0){ut.output=P,Xe(ut);continue}(F.index===F.start||A.type==="slash"||A.type==="dot")&&(A.type==="dot"?(F.output+=v,A.output+=v):r.dot===!0?(F.output+=b,A.output+=b):(F.output+=k,A.output+=k),U()!=="*"&&(F.output+=m,A.output+=m)),Xe(ut)}for(;F.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(lC("closing","]"));F.output=yd.escapeLast(F.output,"["),Ie("brackets")}for(;F.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(lC("closing",")"));F.output=yd.escapeLast(F.output,"("),Ie("parens")}for(;F.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(lC("closing","}"));F.output=yd.escapeLast(F.output,"{"),Ie("braces")}if(r.strictSlashes!==!0&&(A.type==="star"||A.type==="bracket")&&Xe({type:"maybe_slash",value:"",output:`${f}?`}),F.backtrack===!0){F.output="";for(let _e of F.tokens)F.output+=_e.output!=null?_e.output:_e.value,_e.suffix&&(F.output+=_e.suffix)}return F};YY.fastpaths=(t,e)=>{let r={...e},n=typeof r.maxLength=="number"?Math.min(b6,r.maxLength):b6,o=t.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);t=E0e[t]||t;let{DOT_LITERAL:s,SLASH_LITERAL:a,ONE_CHAR:c,DOTS_SLASH:l,NO_DOT:u,NO_DOTS:d,NO_DOTS_SLASH:p,STAR:f,START_ANCHOR:m}=y6.globChars(r.windows),h=r.dot?d:u,g=r.dot?p:u,v=r.capture?"":"?:",b={negated:!1,prefix:""},_=r.bash===!0?".*?":f;r.capture&&(_=`(${_})`);let x=k=>k.noglobstar===!0?_:`(${v}(?:(?!${m}${k.dot?l:s}).)*?)`,S=k=>{switch(k){case"*":return`${h}${c}${_}`;case".*":return`${s}${c}${_}`;case"*.*":return`${h}${_}${s}${c}${_}`;case"*/*":return`${h}${_}${a}${c}${g}${_}`;case"**":return h+x(r);case"**/*":return`(?:${h}${x(r)}${a})?${g}${c}${_}`;case"**/*.*":return`(?:${h}${x(r)}${a})?${g}${_}${s}${c}${_}`;case"**/.*":return`(?:${h}${x(r)}${a})?${s}${c}${_}`;default:{let M=/^(.*?)\.(\w+)$/.exec(k);if(!M)return;let H=S(M[1]);return H?H+s+M[2]:void 0}}},I=yd.removePrefix(t,b),w=S(I);return w&&r.strictSlashes!==!0&&(w+=`${a}?`),w};w0e.exports=YY});var A0e=R((qjt,P0e)=>{"use strict";var vWe=T0e(),QY=k0e(),R0e=v6(),yWe=tD(),bWe=t=>t&&typeof t=="object"&&!Array.isArray(t),to=(t,e,r=!1)=>{if(Array.isArray(t)){let d=t.map(f=>to(f,e,r));return f=>{for(let m of d){let h=m(f);if(h)return h}return!1}}let n=bWe(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let o=e||{},s=o.windows,a=n?to.compileRe(t,e):to.makeRe(t,e,!1,!0),c=a.state;delete a.state;let l=()=>!1;if(o.ignore){let d={...e,ignore:null,onMatch:null,onResult:null};l=to(o.ignore,d,r)}let u=(d,p=!1)=>{let{isMatch:f,match:m,output:h}=to.test(d,a,e,{glob:t,posix:s}),g={glob:t,state:c,regex:a,posix:s,input:d,output:h,match:m,isMatch:f};return typeof o.onResult=="function"&&o.onResult(g),f===!1?(g.isMatch=!1,p?g:!1):l(d)?(typeof o.onIgnore=="function"&&o.onIgnore(g),g.isMatch=!1,p?g:!1):(typeof o.onMatch=="function"&&o.onMatch(g),p?g:!0)};return r&&(u.state=c),u};to.test=(t,e,r,{glob:n,posix:o}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let s=r||{},a=s.format||(o?R0e.toPosixSlashes:null),c=t===n,l=c&&a?a(t):t;return c===!1&&(l=a?a(t):t,c=l===n),(c===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?c=to.matchBase(t,e,r,o):c=e.exec(l)),{isMatch:!!c,match:c,output:l}};to.matchBase=(t,e,r)=>(e instanceof RegExp?e:to.makeRe(e,r)).test(R0e.basename(t));to.isMatch=(t,e,r)=>to(e,r)(t);to.parse=(t,e)=>Array.isArray(t)?t.map(r=>to.parse(r,e)):QY(t,{...e,fastpaths:!1});to.scan=(t,e)=>vWe(t,e);to.compileRe=(t,e,r=!1,n=!1)=>{if(r===!0)return t.output;let o=e||{},s=o.contains?"":"^",a=o.contains?"":"$",c=`${s}(?:${t.output})${a}`;t&&t.negated===!0&&(c=`^(?!${c}).*$`);let l=to.toRegex(c,e);return n===!0&&(l.state=t),l};to.makeRe=(t,e={},r=!1,n=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(o.output=QY.fastpaths(t,e)),o.output||(o=QY(t,e)),to.compileRe(o,e,r,n)};to.toRegex=(t,e)=>{try{let r=e||{};return new RegExp(t,r.flags||(r.nocase?"i":""))}catch(r){if(e&&e.debug===!0)throw r;return/$^/}};to.constants=yWe;P0e.exports=to});var D0e=R((jjt,Vp)=>{"use strict";var _We=require("os"),Xm=A0e(),xWe=_We.platform()==="win32";function SWe(t,e,r=!1){return e&&(e.windows===null||e.windows===void 0)&&(e={...e,windows:xWe}),Xm(t,e,r)}Vp.exports=SWe;Vp.exports.test=Xm.test;Vp.exports.matchBase=Xm.matchBase;Vp.exports.isMatch=Xm.isMatch;Vp.exports.parse=Xm.parse;Vp.exports.scan=Xm.scan;Vp.exports.compileRe=Xm.compileRe;Vp.exports.toRegex=Xm.toRegex;Vp.exports.makeRe=Xm.makeRe});var B0e=R(qv=>{"use strict";var IWe=qv&&qv.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(qv,"__esModule",{value:!0});qv.isBinaryFileSync=qv.isBinaryFile=void 0;var Bv=require("fs"),oQ=require("util"),CWe=oQ.promisify(Bv.stat),TWe=oQ.promisify(Bv.open),EWe=oQ.promisify(Bv.close),oD=512,iQ=class{constructor(e,r){this.fileBuffer=e,this.size=r,this.offset=0,this.error=!1}hasError(){return this.error}nextByte(){return this.offset===this.size||this.hasError()?(this.error=!0,255):this.fileBuffer[this.offset++]}next(e){let r=new Array;for(let n=0;n<e;n++)r[n]=this.nextByte();return r}};function nQ(t){let e=0,r=0;for(;!t.hasError();){let n=t.nextByte();if(r=r|(n&127)<<7*e,!(n&128))break;e++}return r}function wWe(t){switch(nQ(t)&7){case 0:return nQ(t),!0;case 1:return t.next(8),!0;case 2:let n=nQ(t);return t.next(n),!0;case 5:return t.next(4),!0}return!1}function kWe(t,e){let r=new iQ(t,e),n=0;for(;;){if(!wWe(r)&&!r.hasError())return!1;if(r.hasError())break;n++}return n>0}function RWe(t,e){return IWe(this,void 0,void 0,function*(){if(F0e(t)){let r=yield CWe(t);U0e(r);let n=yield TWe(t,"r"),o=Buffer.alloc(oD);return new Promise((s,a)=>{Bv.read(n,o,0,oD,0,(c,l,u)=>{EWe(n),c?a(c):s(S6(o,l))})})}else return e===void 0&&(e=t.length),S6(t,e)})}qv.isBinaryFile=RWe;function PWe(t,e){if(F0e(t)){let r=Bv.statSync(t);U0e(r);let n=Bv.openSync(t,"r"),o=Buffer.alloc(oD),s=Bv.readSync(n,o,0,oD,0);return Bv.closeSync(n),S6(o,s)}else return e===void 0&&(e=t.length),S6(t,e)}qv.isBinaryFileSync=PWe;function S6(t,e){if(e===0)return!1;let r=0,n=Math.min(e,oD);if(e>=3&&t[0]===239&&t[1]===187&&t[2]===191||e>=4&&t[0]===0&&t[1]===0&&t[2]===254&&t[3]===255||e>=4&&t[0]===255&&t[1]===254&&t[2]===0&&t[3]===0||e>=4&&t[0]===132&&t[1]===49&&t[2]===149&&t[3]===51)return!1;if(n>=5&&t.slice(0,5).toString()==="%PDF-")return!0;if(e>=2&&t[0]===254&&t[1]===255||e>=2&&t[0]===255&&t[1]===254)return!1;for(let o=0;o<n;o++){if(t[o]===0)return!0;if((t[o]<7||t[o]>14)&&(t[o]<32||t[o]>127)){if(t[o]>193&&t[o]<224&&o+1<n){if(o++,t[o]>127&&t[o]<192)continue}else if(t[o]>223&&t[o]<240&&o+2<n&&(o++,t[o]>127&&t[o]<192&&t[o+1]>127&&t[o+1]<192)){o++;continue}if(r++,o>=32&&r*100/n>10)return!0}}return!!(r*100/n>10||r>1&&kWe(t,n))}function F0e(t){return typeof t=="string"}function U0e(t){if(!t.isFile())throw new Error("Path provided was not a file!")}});var sn=R(Bs=>{"use strict";var RX=Symbol.for("yaml.alias"),Gbe=Symbol.for("yaml.document"),B8=Symbol.for("yaml.map"),zbe=Symbol.for("yaml.pair"),PX=Symbol.for("yaml.scalar"),q8=Symbol.for("yaml.seq"),uh=Symbol.for("yaml.node.type"),UYe=t=>!!t&&typeof t=="object"&&t[uh]===RX,BYe=t=>!!t&&typeof t=="object"&&t[uh]===Gbe,qYe=t=>!!t&&typeof t=="object"&&t[uh]===B8,jYe=t=>!!t&&typeof t=="object"&&t[uh]===zbe,$be=t=>!!t&&typeof t=="object"&&t[uh]===PX,VYe=t=>!!t&&typeof t=="object"&&t[uh]===q8;function Wbe(t){if(t&&typeof t=="object")switch(t[uh]){case B8:case q8:return!0}return!1}function HYe(t){if(t&&typeof t=="object")switch(t[uh]){case RX:case B8:case PX:case q8:return!0}return!1}var GYe=t=>($be(t)||Wbe(t))&&!!t.anchor;Bs.ALIAS=RX;Bs.DOC=Gbe;Bs.MAP=B8;Bs.NODE_TYPE=uh;Bs.PAIR=zbe;Bs.SCALAR=PX;Bs.SEQ=q8;Bs.hasAnchor=GYe;Bs.isAlias=UYe;Bs.isCollection=Wbe;Bs.isDocument=BYe;Bs.isMap=qYe;Bs.isNode=HYe;Bs.isPair=jYe;Bs.isScalar=$be;Bs.isSeq=VYe});var aN=R(AX=>{"use strict";var $o=sn(),Sc=Symbol("break visit"),Kbe=Symbol("skip children"),rf=Symbol("remove node");function j8(t,e){let r=Ybe(e);$o.isDocument(t)?qT(null,t.contents,r,Object.freeze([t]))===rf&&(t.contents=null):qT(null,t,r,Object.freeze([]))}j8.BREAK=Sc;j8.SKIP=Kbe;j8.REMOVE=rf;function qT(t,e,r,n){let o=Qbe(t,e,r,n);if($o.isNode(o)||$o.isPair(o))return Xbe(t,n,o),qT(t,o,r,n);if(typeof o!="symbol"){if($o.isCollection(e)){n=Object.freeze(n.concat(e));for(let s=0;s<e.items.length;++s){let a=qT(s,e.items[s],r,n);if(typeof a=="number")s=a-1;else{if(a===Sc)return Sc;a===rf&&(e.items.splice(s,1),s-=1)}}}else if($o.isPair(e)){n=Object.freeze(n.concat(e));let s=qT("key",e.key,r,n);if(s===Sc)return Sc;s===rf&&(e.key=null);let a=qT("value",e.value,r,n);if(a===Sc)return Sc;a===rf&&(e.value=null)}}return o}async function V8(t,e){let r=Ybe(e);$o.isDocument(t)?await jT(null,t.contents,r,Object.freeze([t]))===rf&&(t.contents=null):await jT(null,t,r,Object.freeze([]))}V8.BREAK=Sc;V8.SKIP=Kbe;V8.REMOVE=rf;async function jT(t,e,r,n){let o=await Qbe(t,e,r,n);if($o.isNode(o)||$o.isPair(o))return Xbe(t,n,o),jT(t,o,r,n);if(typeof o!="symbol"){if($o.isCollection(e)){n=Object.freeze(n.concat(e));for(let s=0;s<e.items.length;++s){let a=await jT(s,e.items[s],r,n);if(typeof a=="number")s=a-1;else{if(a===Sc)return Sc;a===rf&&(e.items.splice(s,1),s-=1)}}}else if($o.isPair(e)){n=Object.freeze(n.concat(e));let s=await jT("key",e.key,r,n);if(s===Sc)return Sc;s===rf&&(e.key=null);let a=await jT("value",e.value,r,n);if(a===Sc)return Sc;a===rf&&(e.value=null)}}return o}function Ybe(t){return typeof t=="object"&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function Qbe(t,e,r,n){if(typeof r=="function")return r(t,e,n);if($o.isMap(e))return r.Map?.(t,e,n);if($o.isSeq(e))return r.Seq?.(t,e,n);if($o.isPair(e))return r.Pair?.(t,e,n);if($o.isScalar(e))return r.Scalar?.(t,e,n);if($o.isAlias(e))return r.Alias?.(t,e,n)}function Xbe(t,e,r){let n=e[e.length-1];if($o.isCollection(n))n.items[t]=r;else if($o.isPair(n))t==="key"?n.key=r:n.value=r;else if($o.isDocument(n))n.contents=r;else{let o=$o.isAlias(n)?"alias":"scalar";throw new Error(`Cannot replace node with ${o} parent`)}}AX.visit=j8;AX.visitAsync=V8});var DX=R(Zbe=>{"use strict";var Jbe=sn(),zYe=aN(),$Ye={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},WYe=t=>t.replace(/[!,[\]{}]/g,e=>$Ye[e]),cN=class t{constructor(e,r){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},t.defaultYaml,e),this.tags=Object.assign({},t.defaultTags,r)}clone(){let e=new t(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){let e=new t(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:t.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},t.defaultTags);break}return e}add(e,r){this.atNextDocument&&(this.yaml={explicit:t.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},t.defaultTags),this.atNextDocument=!1);let n=e.trim().split(/[ \t]+/),o=n.shift();switch(o){case"%TAG":{if(n.length!==2&&(r(0,"%TAG directive should contain exactly two parts"),n.length<2))return!1;let[s,a]=n;return this.tags[s]=a,!0}case"%YAML":{if(this.yaml.explicit=!0,n.length!==1)return r(0,"%YAML directive should contain exactly one part"),!1;let[s]=n;if(s==="1.1"||s==="1.2")return this.yaml.version=s,!0;{let a=/^\d+\.\d+$/.test(s);return r(6,`Unsupported YAML version ${s}`,a),!1}}default:return r(0,`Unknown directive ${o}`,!0),!1}}tagName(e,r){if(e==="!")return"!";if(e[0]!=="!")return r(`Not a valid tag: ${e}`),null;if(e[1]==="<"){let a=e.slice(2,-1);return a==="!"||a==="!!"?(r(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&r("Verbatim tags must end with a >"),a)}let[,n,o]=e.match(/^(.*!)([^!]*)$/s);o||r(`The ${e} tag has no suffix`);let s=this.tags[n];if(s)try{return s+decodeURIComponent(o)}catch(a){return r(String(a)),null}return n==="!"?e:(r(`Could not resolve tag: ${e}`),null)}tagString(e){for(let[r,n]of Object.entries(this.tags))if(e.startsWith(n))return r+WYe(e.substring(n.length));return e[0]==="!"?e:`!<${e}>`}toString(e){let r=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],n=Object.entries(this.tags),o;if(e&&n.length>0&&Jbe.isNode(e.contents)){let s={};zYe.visit(e.contents,(a,c)=>{Jbe.isNode(c)&&c.tag&&(s[c.tag]=!0)}),o=Object.keys(s)}else o=[];for(let[s,a]of n)s==="!!"&&a==="tag:yaml.org,2002:"||(!e||o.some(c=>c.startsWith(a)))&&r.push(`%TAG ${s} ${a}`);return r.join(`
`)}};cN.defaultYaml={explicit:!1,version:"1.2"};cN.defaultTags={"!!":"tag:yaml.org,2002:"};Zbe.Directives=cN});var H8=R(lN=>{"use strict";var e_e=sn(),KYe=aN();function YYe(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){let r=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw new Error(r)}return!0}function t_e(t){let e=new Set;return KYe.visit(t,{Value(r,n){n.anchor&&e.add(n.anchor)}}),e}function r_e(t,e){for(let r=1;;++r){let n=`${t}${r}`;if(!e.has(n))return n}}function QYe(t,e){let r=[],n=new Map,o=null;return{onAnchor:s=>{r.push(s),o||(o=t_e(t));let a=r_e(e,o);return o.add(a),a},setAnchors:()=>{for(let s of r){let a=n.get(s);if(typeof a=="object"&&a.anchor&&(e_e.isScalar(a.node)||e_e.isCollection(a.node)))a.node.anchor=a.anchor;else{let c=new Error("Failed to resolve repeated object (this should not happen)");throw c.source=s,c}}},sourceObjects:n}}lN.anchorIsValid=YYe;lN.anchorNames=t_e;lN.createNodeAnchors=QYe;lN.findNewAnchor=r_e});var NX=R(n_e=>{"use strict";function uN(t,e,r,n){if(n&&typeof n=="object")if(Array.isArray(n))for(let o=0,s=n.length;o<s;++o){let a=n[o],c=uN(t,n,String(o),a);c===void 0?delete n[o]:c!==a&&(n[o]=c)}else if(n instanceof Map)for(let o of Array.from(n.keys())){let s=n.get(o),a=uN(t,n,o,s);a===void 0?n.delete(o):a!==s&&n.set(o,a)}else if(n instanceof Set)for(let o of Array.from(n)){let s=uN(t,n,o,o);s===void 0?n.delete(o):s!==o&&(n.delete(o),n.add(s))}else for(let[o,s]of Object.entries(n)){let a=uN(t,n,o,s);a===void 0?delete n[o]:a!==s&&(n[o]=a)}return t.call(e,r,n)}n_e.applyReviver=uN});var P0=R(o_e=>{"use strict";var XYe=sn();function i_e(t,e,r){if(Array.isArray(t))return t.map((n,o)=>i_e(n,String(o),r));if(t&&typeof t.toJSON=="function"){if(!r||!XYe.hasAnchor(t))return t.toJSON(e,r);let n={aliasCount:0,count:1,res:void 0};r.anchors.set(t,n),r.onCreate=s=>{n.res=s,delete r.onCreate};let o=t.toJSON(e,r);return r.onCreate&&r.onCreate(o),o}return typeof t=="bigint"&&!r?.keep?Number(t):t}o_e.toJS=i_e});var G8=R(a_e=>{"use strict";var JYe=NX(),s_e=sn(),ZYe=P0(),LX=class{constructor(e){Object.defineProperty(this,s_e.NODE_TYPE,{value:e})}clone(){let e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:r,maxAliasCount:n,onAnchor:o,reviver:s}={}){if(!s_e.isDocument(e))throw new TypeError("A document argument is required");let a={anchors:new Map,doc:e,keep:!0,mapAsMap:r===!0,mapKeyWarned:!1,maxAliasCount:typeof n=="number"?n:100},c=ZYe.toJS(this,"",a);if(typeof o=="function")for(let{count:l,res:u}of a.anchors.values())o(u,l);return typeof s=="function"?JYe.applyReviver(s,{"":c},"",c):c}};a_e.NodeBase=LX});var dN=R(l_e=>{"use strict";var eQe=H8(),c_e=aN(),z8=sn(),tQe=G8(),rQe=P0(),OX=class extends tQe.NodeBase{constructor(e){super(z8.ALIAS),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let r;return c_e.visit(e,{Node:(n,o)=>{if(o===this)return c_e.visit.BREAK;o.anchor===this.source&&(r=o)}}),r}toJSON(e,r){if(!r)return{source:this.source};let{anchors:n,doc:o,maxAliasCount:s}=r,a=this.resolve(o);if(!a){let l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let c=n.get(a);if(c||(rQe.toJS(a,null,r),c=n.get(a)),!c||c.res===void 0){let l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(s>=0&&(c.count+=1,c.aliasCount===0&&(c.aliasCount=$8(o,a,n)),c.count*c.aliasCount>s)){let l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return c.res}toString(e,r,n){let o=`*${this.source}`;if(e){if(eQe.anchorIsValid(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){let s=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(s)}if(e.implicitKey)return`${o} `}return o}};function $8(t,e,r){if(z8.isAlias(e)){let n=e.resolve(t),o=r&&n&&r.get(n);return o?o.count*o.aliasCount:0}else if(z8.isCollection(e)){let n=0;for(let o of e.items){let s=$8(t,o,r);s>n&&(n=s)}return n}else if(z8.isPair(e)){let n=$8(t,e.key,r),o=$8(t,e.value,r);return Math.max(n,o)}return 1}l_e.Alias=OX});var To=R(MX=>{"use strict";var nQe=sn(),iQe=G8(),oQe=P0(),sQe=t=>!t||typeof t!="function"&&typeof t!="object",A0=class extends iQe.NodeBase{constructor(e){super(nQe.SCALAR),this.value=e}toJSON(e,r){return r?.keep?this.value:oQe.toJS(this.value,e,r)}toString(){return String(this.value)}};A0.BLOCK_FOLDED="BLOCK_FOLDED";A0.BLOCK_LITERAL="BLOCK_LITERAL";A0.PLAIN="PLAIN";A0.QUOTE_DOUBLE="QUOTE_DOUBLE";A0.QUOTE_SINGLE="QUOTE_SINGLE";MX.Scalar=A0;MX.isScalarValue=sQe});var pN=R(d_e=>{"use strict";var aQe=dN(),lx=sn(),u_e=To(),cQe="tag:yaml.org,2002:";function lQe(t,e,r){if(e){let n=r.filter(s=>s.tag===e),o=n.find(s=>!s.format)??n[0];if(!o)throw new Error(`Tag ${e} not found`);return o}return r.find(n=>n.identify?.(t)&&!n.format)}function uQe(t,e,r){if(lx.isDocument(t)&&(t=t.contents),lx.isNode(t))return t;if(lx.isPair(t)){let p=r.schema[lx.MAP].createNode?.(r.schema,null,r);return p.items.push(t),p}(t instanceof String||t instanceof Number||t instanceof Boolean||typeof BigInt<"u"&&t instanceof BigInt)&&(t=t.valueOf());let{aliasDuplicateObjects:n,onAnchor:o,onTagObj:s,schema:a,sourceObjects:c}=r,l;if(n&&t&&typeof t=="object"){if(l=c.get(t),l)return l.anchor||(l.anchor=o(t)),new aQe.Alias(l.anchor);l={anchor:null,node:null},c.set(t,l)}e?.startsWith("!!")&&(e=cQe+e.slice(2));let u=lQe(t,e,a.tags);if(!u){if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object"){let p=new u_e.Scalar(t);return l&&(l.node=p),p}u=t instanceof Map?a[lx.MAP]:Symbol.iterator in Object(t)?a[lx.SEQ]:a[lx.MAP]}s&&(s(u),delete r.onTagObj);let d=u?.createNode?u.createNode(r.schema,t,r):typeof u?.nodeClass?.from=="function"?u.nodeClass.from(r.schema,t,r):new u_e.Scalar(t);return e?d.tag=e:u.default||(d.tag=u.tag),l&&(l.node=d),d}d_e.createNode=uQe});var K8=R(W8=>{"use strict";var dQe=pN(),nf=sn(),pQe=G8();function FX(t,e,r){let n=r;for(let o=e.length-1;o>=0;--o){let s=e[o];if(typeof s=="number"&&Number.isInteger(s)&&s>=0){let a=[];a[s]=n,n=a}else n=new Map([[s,n]])}return dQe.createNode(n,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}var p_e=t=>t==null||typeof t=="object"&&!!t[Symbol.iterator]().next().done,UX=class extends pQe.NodeBase{constructor(e,r){super(e),Object.defineProperty(this,"schema",{value:r,configurable:!0,enumerable:!1,writable:!0})}clone(e){let r=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(r.schema=e),r.items=r.items.map(n=>nf.isNode(n)||nf.isPair(n)?n.clone(e):n),this.range&&(r.range=this.range.slice()),r}addIn(e,r){if(p_e(e))this.add(r);else{let[n,...o]=e,s=this.get(n,!0);if(nf.isCollection(s))s.addIn(o,r);else if(s===void 0&&this.schema)this.set(n,FX(this.schema,o,r));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`)}}deleteIn(e){let[r,...n]=e;if(n.length===0)return this.delete(r);let o=this.get(r,!0);if(nf.isCollection(o))return o.deleteIn(n);throw new Error(`Expected YAML collection at ${r}. Remaining path: ${n}`)}getIn(e,r){let[n,...o]=e,s=this.get(n,!0);return o.length===0?!r&&nf.isScalar(s)?s.value:s:nf.isCollection(s)?s.getIn(o,r):void 0}hasAllNullValues(e){return this.items.every(r=>{if(!nf.isPair(r))return!1;let n=r.value;return n==null||e&&nf.isScalar(n)&&n.value==null&&!n.commentBefore&&!n.comment&&!n.tag})}hasIn(e){let[r,...n]=e;if(n.length===0)return this.has(r);let o=this.get(r,!0);return nf.isCollection(o)?o.hasIn(n):!1}setIn(e,r){let[n,...o]=e;if(o.length===0)this.set(n,r);else{let s=this.get(n,!0);if(nf.isCollection(s))s.setIn(o,r);else if(s===void 0&&this.schema)this.set(n,FX(this.schema,o,r));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`)}}};W8.Collection=UX;W8.collectionFromPath=FX;W8.isEmptyPath=p_e});var fN=R(Y8=>{"use strict";var fQe=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function BX(t,e){return/^\n+$/.test(t)?t.substring(1):e?t.replace(/^(?! *$)/gm,e):t}var mQe=(t,e,r)=>t.endsWith(`
`)?BX(r,e):r.includes(`
`)?`
`+BX(r,e):(t.endsWith(" ")?"":" ")+r;Y8.indentComment=BX;Y8.lineComment=mQe;Y8.stringifyComment=fQe});var m_e=R(mN=>{"use strict";var hQe="flow",qX="block",Q8="quoted";function gQe(t,e,r="flow",{indentAtStart:n,lineWidth:o=80,minContentWidth:s=20,onFold:a,onOverflow:c}={}){if(!o||o<0)return t;o<s&&(s=0);let l=Math.max(1+s,1+o-e.length);if(t.length<=l)return t;let u=[],d={},p=o-e.length;typeof n=="number"&&(n>o-Math.max(2,s)?u.push(0):p=o-n);let f,m,h=!1,g=-1,v=-1,b=-1;r===qX&&(g=f_e(t,g,e.length),g!==-1&&(p=g+l));for(let x;x=t[g+=1];){if(r===Q8&&x==="\\"){switch(v=g,t[g+1]){case"x":g+=3;break;case"u":g+=5;break;case"U":g+=9;break;default:g+=1}b=g}if(x===`
`)r===qX&&(g=f_e(t,g,e.length)),p=g+e.length+l,f=void 0;else{if(x===" "&&m&&m!==" "&&m!==`
`&&m!=="	"){let S=t[g+1];S&&S!==" "&&S!==`
`&&S!=="	"&&(f=g)}if(g>=p)if(f)u.push(f),p=f+l,f=void 0;else if(r===Q8){for(;m===" "||m==="	";)m=x,x=t[g+=1],h=!0;let S=g>b+1?g-2:v-1;if(d[S])return t;u.push(S),d[S]=!0,p=S+l,f=void 0}else h=!0}m=x}if(h&&c&&c(),u.length===0)return t;a&&a();let _=t.slice(0,u[0]);for(let x=0;x<u.length;++x){let S=u[x],I=u[x+1]||t.length;S===0?_=`
${e}${t.slice(0,I)}`:(r===Q8&&d[S]&&(_+=`${t[S]}\\`),_+=`
${e}${t.slice(S+1,I)}`)}return _}function f_e(t,e,r){let n=e,o=e+1,s=t[o];for(;s===" "||s==="	";)if(e<o+r)s=t[++e];else{do s=t[++e];while(s&&s!==`
`);n=e,o=e+1,s=t[o]}return n}mN.FOLD_BLOCK=qX;mN.FOLD_FLOW=hQe;mN.FOLD_QUOTED=Q8;mN.foldFlowLines=gQe});var gN=R(h_e=>{"use strict";var of=To(),D0=m_e(),J8=(t,e)=>({indentAtStart:e?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),Z8=t=>/^(%|---|\.\.\.)/m.test(t);function vQe(t,e,r){if(!e||e<0)return!1;let n=e-r,o=t.length;if(o<=n)return!1;for(let s=0,a=0;s<o;++s)if(t[s]===`
`){if(s-a>n)return!0;if(a=s+1,o-a<=n)return!1}return!0}function hN(t,e){let r=JSON.stringify(t);if(e.options.doubleQuotedAsJSON)return r;let{implicitKey:n}=e,o=e.options.doubleQuotedMinMultiLineLength,s=e.indent||(Z8(t)?"  ":""),a="",c=0;for(let l=0,u=r[l];u;u=r[++l])if(u===" "&&r[l+1]==="\\"&&r[l+2]==="n"&&(a+=r.slice(c,l)+"\\ ",l+=1,c=l,u="\\"),u==="\\")switch(r[l+1]){case"u":{a+=r.slice(c,l);let d=r.substr(l+2,4);switch(d){case"0000":a+="\\0";break;case"0007":a+="\\a";break;case"000b":a+="\\v";break;case"001b":a+="\\e";break;case"0085":a+="\\N";break;case"00a0":a+="\\_";break;case"2028":a+="\\L";break;case"2029":a+="\\P";break;default:d.substr(0,2)==="00"?a+="\\x"+d.substr(2):a+=r.substr(l,6)}l+=5,c=l+1}break;case"n":if(n||r[l+2]==='"'||r.length<o)l+=1;else{for(a+=r.slice(c,l)+`

`;r[l+2]==="\\"&&r[l+3]==="n"&&r[l+4]!=='"';)a+=`
`,l+=2;a+=s,r[l+2]===" "&&(a+="\\"),l+=1,c=l+1}break;default:l+=1}return a=c?a+r.slice(c):r,n?a:D0.foldFlowLines(a,s,D0.FOLD_QUOTED,J8(e,!1))}function jX(t,e){if(e.options.singleQuote===!1||e.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return hN(t,e);let r=e.indent||(Z8(t)?"  ":""),n="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${r}`)+"'";return e.implicitKey?n:D0.foldFlowLines(n,r,D0.FOLD_FLOW,J8(e,!1))}function VT(t,e){let{singleQuote:r}=e.options,n;if(r===!1)n=hN;else{let o=t.includes('"'),s=t.includes("'");o&&!s?n=jX:s&&!o?n=hN:n=r?jX:hN}return n(t,e)}var VX;try{VX=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{VX=/\n+(?!\n|$)/g}function X8({comment:t,type:e,value:r},n,o,s){let{blockQuote:a,commentString:c,lineWidth:l}=n.options;if(!a||/\n[\t ]+$/.test(r)||/^\s*$/.test(r))return VT(r,n);let u=n.indent||(n.forceBlockIndent||Z8(r)?"  ":""),d=a==="literal"?!0:a==="folded"||e===of.Scalar.BLOCK_FOLDED?!1:e===of.Scalar.BLOCK_LITERAL?!0:!vQe(r,l,u.length);if(!r)return d?`|
`:`>
`;let p,f;for(f=r.length;f>0;--f){let w=r[f-1];if(w!==`
`&&w!=="	"&&w!==" ")break}let m=r.substring(f),h=m.indexOf(`
`);h===-1?p="-":r===m||h!==m.length-1?(p="+",s&&s()):p="",m&&(r=r.slice(0,-m.length),m[m.length-1]===`
`&&(m=m.slice(0,-1)),m=m.replace(VX,`$&${u}`));let g=!1,v,b=-1;for(v=0;v<r.length;++v){let w=r[v];if(w===" ")g=!0;else if(w===`
`)b=v;else break}let _=r.substring(0,b<v?b+1:v);_&&(r=r.substring(_.length),_=_.replace(/\n+/g,`$&${u}`));let S=(d?"|":">")+(g?u?"2":"1":"")+p;if(t&&(S+=" "+c(t.replace(/ ?[\r\n]+/g," ")),o&&o()),d)return r=r.replace(/\n+/g,`$&${u}`),`${S}
${u}${_}${r}${m}`;r=r.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${u}`);let I=D0.foldFlowLines(`${_}${r}${m}`,u,D0.FOLD_BLOCK,J8(n,!0));return`${S}
${u}${I}`}function yQe(t,e,r,n){let{type:o,value:s}=t,{actualString:a,implicitKey:c,indent:l,indentStep:u,inFlow:d}=e;if(c&&s.includes(`
`)||d&&/[[\]{},]/.test(s))return VT(s,e);if(!s||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(s))return c||d||!s.includes(`
`)?VT(s,e):X8(t,e,r,n);if(!c&&!d&&o!==of.Scalar.PLAIN&&s.includes(`
`))return X8(t,e,r,n);if(Z8(s)){if(l==="")return e.forceBlockIndent=!0,X8(t,e,r,n);if(c&&l===u)return VT(s,e)}let p=s.replace(/\n+/g,`$&
${l}`);if(a){let f=g=>g.default&&g.tag!=="tag:yaml.org,2002:str"&&g.test?.test(p),{compat:m,tags:h}=e.doc.schema;if(h.some(f)||m?.some(f))return VT(s,e)}return c?p:D0.foldFlowLines(p,l,D0.FOLD_FLOW,J8(e,!1))}function bQe(t,e,r,n){let{implicitKey:o,inFlow:s}=e,a=typeof t.value=="string"?t:Object.assign({},t,{value:String(t.value)}),{type:c}=t;c!==of.Scalar.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(a.value)&&(c=of.Scalar.QUOTE_DOUBLE);let l=d=>{switch(d){case of.Scalar.BLOCK_FOLDED:case of.Scalar.BLOCK_LITERAL:return o||s?VT(a.value,e):X8(a,e,r,n);case of.Scalar.QUOTE_DOUBLE:return hN(a.value,e);case of.Scalar.QUOTE_SINGLE:return jX(a.value,e);case of.Scalar.PLAIN:return yQe(a,e,r,n);default:return null}},u=l(c);if(u===null){let{defaultKeyType:d,defaultStringType:p}=e.options,f=o&&d||p;if(u=l(f),u===null)throw new Error(`Unsupported default string type ${f}`)}return u}h_e.stringifyString=bQe});var vN=R(HX=>{"use strict";var _Qe=H8(),N0=sn(),xQe=fN(),SQe=gN();function IQe(t,e){let r=Object.assign({blockQuote:!0,commentString:xQe.stringifyComment,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,e),n;switch(r.collectionStyle){case"block":n=!1;break;case"flow":n=!0;break;default:n=null}return{anchors:new Set,doc:t,flowCollectionPadding:r.flowCollectionPadding?" ":"",indent:"",indentStep:typeof r.indent=="number"?" ".repeat(r.indent):"  ",inFlow:n,options:r}}function CQe(t,e){if(e.tag){let o=t.filter(s=>s.tag===e.tag);if(o.length>0)return o.find(s=>s.format===e.format)??o[0]}let r,n;if(N0.isScalar(e)){n=e.value;let o=t.filter(s=>s.identify?.(n));r=o.find(s=>s.format===e.format)??o.find(s=>!s.format)}else n=e,r=t.find(o=>o.nodeClass&&n instanceof o.nodeClass);if(!r){let o=n?.constructor?.name??typeof n;throw new Error(`Tag not resolved for ${o} value`)}return r}function TQe(t,e,{anchors:r,doc:n}){if(!n.directives)return"";let o=[],s=(N0.isScalar(t)||N0.isCollection(t))&&t.anchor;s&&_Qe.anchorIsValid(s)&&(r.add(s),o.push(`&${s}`));let a=t.tag?t.tag:e.default?null:e.tag;return a&&o.push(n.directives.tagString(a)),o.join(" ")}function EQe(t,e,r,n){if(N0.isPair(t))return t.toString(e,r,n);if(N0.isAlias(t)){if(e.doc.directives)return t.toString(e);if(e.resolvedAliases?.has(t))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(t):e.resolvedAliases=new Set([t]),t=t.resolve(e.doc)}let o,s=N0.isNode(t)?t:e.doc.createNode(t,{onTagObj:l=>o=l});o||(o=CQe(e.doc.schema.tags,s));let a=TQe(s,o,e);a.length>0&&(e.indentAtStart=(e.indentAtStart??0)+a.length+1);let c=typeof o.stringify=="function"?o.stringify(s,e,r,n):N0.isScalar(s)?SQe.stringifyString(s,e,r,n):s.toString(e,r,n);return a?N0.isScalar(s)||c[0]==="{"||c[0]==="["?`${a} ${c}`:`${a}
${e.indent}${c}`:c}HX.createStringifyContext=IQe;HX.stringify=EQe});var b_e=R(y_e=>{"use strict";var dh=sn(),g_e=To(),v_e=vN(),yN=fN();function wQe({key:t,value:e},r,n,o){let{allNullValues:s,doc:a,indent:c,indentStep:l,options:{commentString:u,indentSeq:d,simpleKeys:p}}=r,f=dh.isNode(t)&&t.comment||null;if(p){if(f)throw new Error("With simple keys, key nodes cannot have comments");if(dh.isCollection(t)||!dh.isNode(t)&&typeof t=="object"){let k="With simple keys, collection cannot be used as a key value";throw new Error(k)}}let m=!p&&(!t||f&&e==null&&!r.inFlow||dh.isCollection(t)||(dh.isScalar(t)?t.type===g_e.Scalar.BLOCK_FOLDED||t.type===g_e.Scalar.BLOCK_LITERAL:typeof t=="object"));r=Object.assign({},r,{allNullValues:!1,implicitKey:!m&&(p||!s),indent:c+l});let h=!1,g=!1,v=v_e.stringify(t,r,()=>h=!0,()=>g=!0);if(!m&&!r.inFlow&&v.length>1024){if(p)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(r.inFlow){if(s||e==null)return h&&n&&n(),v===""?"?":m?`? ${v}`:v}else if(s&&!p||e==null&&m)return v=`? ${v}`,f&&!h?v+=yN.lineComment(v,r.indent,u(f)):g&&o&&o(),v;h&&(f=null),m?(f&&(v+=yN.lineComment(v,r.indent,u(f))),v=`? ${v}
${c}:`):(v=`${v}:`,f&&(v+=yN.lineComment(v,r.indent,u(f))));let b,_,x;dh.isNode(e)?(b=!!e.spaceBefore,_=e.commentBefore,x=e.comment):(b=!1,_=null,x=null,e&&typeof e=="object"&&(e=a.createNode(e))),r.implicitKey=!1,!m&&!f&&dh.isScalar(e)&&(r.indentAtStart=v.length+1),g=!1,!d&&l.length>=2&&!r.inFlow&&!m&&dh.isSeq(e)&&!e.flow&&!e.tag&&!e.anchor&&(r.indent=r.indent.substring(2));let S=!1,I=v_e.stringify(e,r,()=>S=!0,()=>g=!0),w=" ";if(f||b||_){if(w=b?`
`:"",_){let k=u(_);w+=`
${yN.indentComment(k,r.indent)}`}I===""&&!r.inFlow?w===`
`&&(w=`

`):w+=`
${r.indent}`}else if(!m&&dh.isCollection(e)){let k=I[0],M=I.indexOf(`
`),H=M!==-1,F=r.inFlow??e.flow??e.items.length===0;if(H||!F){let ue=!1;if(H&&(k==="&"||k==="!")){let Z=I.indexOf(" ");k==="&"&&Z!==-1&&Z<M&&I[Z+1]==="!"&&(Z=I.indexOf(" ",Z+1)),(Z===-1||M<Z)&&(ue=!0)}ue||(w=`
${r.indent}`)}}else(I===""||I[0]===`
`)&&(w="");return v+=w+I,r.inFlow?S&&n&&n():x&&!S?v+=yN.lineComment(v,r.indent,u(x)):g&&o&&o(),v}y_e.stringifyPair=wQe});var zX=R(GX=>{"use strict";function kQe(t,...e){t==="debug"&&console.log(...e)}function RQe(t,e){(t==="debug"||t==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(e):console.warn(e))}GX.debug=kQe;GX.warn=RQe});var KX=R(x_e=>{"use strict";var PQe=zX(),AQe=vN(),HT=sn(),DQe=To(),$X=P0(),__e="<<";function NQe(t,e,{key:r,value:n}){if(t?.doc.schema.merge&&LQe(r))if(n=HT.isAlias(n)?n.resolve(t.doc):n,HT.isSeq(n))for(let o of n.items)WX(t,e,o);else if(Array.isArray(n))for(let o of n)WX(t,e,o);else WX(t,e,n);else{let o=$X.toJS(r,"",t);if(e instanceof Map)e.set(o,$X.toJS(n,o,t));else if(e instanceof Set)e.add(o);else{let s=OQe(r,o,t),a=$X.toJS(n,s,t);s in e?Object.defineProperty(e,s,{value:a,writable:!0,enumerable:!0,configurable:!0}):e[s]=a}}return e}var LQe=t=>t===__e||HT.isScalar(t)&&t.value===__e&&(!t.type||t.type===DQe.Scalar.PLAIN);function WX(t,e,r){let n=t&&HT.isAlias(r)?r.resolve(t.doc):r;if(!HT.isMap(n))throw new Error("Merge sources must be maps or map aliases");let o=n.toJSON(null,t,Map);for(let[s,a]of o)e instanceof Map?e.has(s)||e.set(s,a):e instanceof Set?e.add(s):Object.prototype.hasOwnProperty.call(e,s)||Object.defineProperty(e,s,{value:a,writable:!0,enumerable:!0,configurable:!0});return e}function OQe(t,e,r){if(e===null)return"";if(typeof e!="object")return String(e);if(HT.isNode(t)&&r?.doc){let n=AQe.createStringifyContext(r.doc,{});n.anchors=new Set;for(let s of r.anchors.keys())n.anchors.add(s.anchor);n.inFlow=!0,n.inStringifyKey=!0;let o=t.toString(n);if(!r.mapKeyWarned){let s=JSON.stringify(o);s.length>40&&(s=s.substring(0,36)+'..."'),PQe.warn(r.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${s}. Set mapAsMap: true to use object keys.`),r.mapKeyWarned=!0}return o}return JSON.stringify(e)}x_e.addPairToJSMap=NQe});var L0=R(YX=>{"use strict";var S_e=pN(),MQe=b_e(),FQe=KX(),e9=sn();function UQe(t,e,r){let n=S_e.createNode(t,void 0,r),o=S_e.createNode(e,void 0,r);return new t9(n,o)}var t9=class t{constructor(e,r=null){Object.defineProperty(this,e9.NODE_TYPE,{value:e9.PAIR}),this.key=e,this.value=r}clone(e){let{key:r,value:n}=this;return e9.isNode(r)&&(r=r.clone(e)),e9.isNode(n)&&(n=n.clone(e)),new t(r,n)}toJSON(e,r){let n=r?.mapAsMap?new Map:{};return FQe.addPairToJSMap(r,n,this)}toString(e,r,n){return e?.doc?MQe.stringifyPair(this,e,r,n):JSON.stringify(this)}};YX.Pair=t9;YX.createPair=UQe});var QX=R(C_e=>{"use strict";var ux=sn(),I_e=vN(),r9=fN();function BQe(t,e,r){return(e.inFlow??t.flow?jQe:qQe)(t,e,r)}function qQe({comment:t,items:e},r,{blockItemPrefix:n,flowChars:o,itemIndent:s,onChompKeep:a,onComment:c}){let{indent:l,options:{commentString:u}}=r,d=Object.assign({},r,{indent:s,type:null}),p=!1,f=[];for(let h=0;h<e.length;++h){let g=e[h],v=null;if(ux.isNode(g))!p&&g.spaceBefore&&f.push(""),n9(r,f,g.commentBefore,p),g.comment&&(v=g.comment);else if(ux.isPair(g)){let _=ux.isNode(g.key)?g.key:null;_&&(!p&&_.spaceBefore&&f.push(""),n9(r,f,_.commentBefore,p))}p=!1;let b=I_e.stringify(g,d,()=>v=null,()=>p=!0);v&&(b+=r9.lineComment(b,s,u(v))),p&&v&&(p=!1),f.push(n+b)}let m;if(f.length===0)m=o.start+o.end;else{m=f[0];for(let h=1;h<f.length;++h){let g=f[h];m+=g?`
${l}${g}`:`
`}}return t?(m+=`
`+r9.indentComment(u(t),l),c&&c()):p&&a&&a(),m}function jQe({items:t},e,{flowChars:r,itemIndent:n}){let{indent:o,indentStep:s,flowCollectionPadding:a,options:{commentString:c}}=e;n+=s;let l=Object.assign({},e,{indent:n,inFlow:!0,type:null}),u=!1,d=0,p=[];for(let h=0;h<t.length;++h){let g=t[h],v=null;if(ux.isNode(g))g.spaceBefore&&p.push(""),n9(e,p,g.commentBefore,!1),g.comment&&(v=g.comment);else if(ux.isPair(g)){let _=ux.isNode(g.key)?g.key:null;_&&(_.spaceBefore&&p.push(""),n9(e,p,_.commentBefore,!1),_.comment&&(u=!0));let x=ux.isNode(g.value)?g.value:null;x?(x.comment&&(v=x.comment),x.commentBefore&&(u=!0)):g.value==null&&_?.comment&&(v=_.comment)}v&&(u=!0);let b=I_e.stringify(g,l,()=>v=null);h<t.length-1&&(b+=","),v&&(b+=r9.lineComment(b,n,c(v))),!u&&(p.length>d||b.includes(`
`))&&(u=!0),p.push(b),d=p.length}let{start:f,end:m}=r;if(p.length===0)return f+m;if(!u){let h=p.reduce((g,v)=>g+v.length+2,2);u=e.options.lineWidth>0&&h>e.options.lineWidth}if(u){let h=f;for(let g of p)h+=g?`
${s}${o}${g}`:`
`;return`${h}
${o}${m}`}else return`${f}${a}${p.join(" ")}${a}${m}`}function n9({indent:t,options:{commentString:e}},r,n,o){if(n&&o&&(n=n.replace(/^\n+/,"")),n){let s=r9.indentComment(e(n),t);r.push(s.trimStart())}}C_e.stringifyCollection=BQe});var M0=R(JX=>{"use strict";var VQe=QX(),HQe=KX(),GQe=K8(),O0=sn(),i9=L0(),zQe=To();function bN(t,e){let r=O0.isScalar(e)?e.value:e;for(let n of t)if(O0.isPair(n)&&(n.key===e||n.key===r||O0.isScalar(n.key)&&n.key.value===r))return n}var XX=class extends GQe.Collection{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(O0.MAP,e),this.items=[]}static from(e,r,n){let{keepUndefined:o,replacer:s}=n,a=new this(e),c=(l,u)=>{if(typeof s=="function")u=s.call(r,l,u);else if(Array.isArray(s)&&!s.includes(l))return;(u!==void 0||o)&&a.items.push(i9.createPair(l,u,n))};if(r instanceof Map)for(let[l,u]of r)c(l,u);else if(r&&typeof r=="object")for(let l of Object.keys(r))c(l,r[l]);return typeof e.sortMapEntries=="function"&&a.items.sort(e.sortMapEntries),a}add(e,r){let n;O0.isPair(e)?n=e:!e||typeof e!="object"||!("key"in e)?n=new i9.Pair(e,e?.value):n=new i9.Pair(e.key,e.value);let o=bN(this.items,n.key),s=this.schema?.sortMapEntries;if(o){if(!r)throw new Error(`Key ${n.key} already set`);O0.isScalar(o.value)&&zQe.isScalarValue(n.value)?o.value.value=n.value:o.value=n.value}else if(s){let a=this.items.findIndex(c=>s(n,c)<0);a===-1?this.items.push(n):this.items.splice(a,0,n)}else this.items.push(n)}delete(e){let r=bN(this.items,e);return r?this.items.splice(this.items.indexOf(r),1).length>0:!1}get(e,r){let o=bN(this.items,e)?.value;return(!r&&O0.isScalar(o)?o.value:o)??void 0}has(e){return!!bN(this.items,e)}set(e,r){this.add(new i9.Pair(e,r),!0)}toJSON(e,r,n){let o=n?new n:r?.mapAsMap?new Map:{};r?.onCreate&&r.onCreate(o);for(let s of this.items)HQe.addPairToJSMap(r,o,s);return o}toString(e,r,n){if(!e)return JSON.stringify(this);for(let o of this.items)if(!O0.isPair(o))throw new Error(`Map items must all be pairs; found ${JSON.stringify(o)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),VQe.stringifyCollection(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:n,onComment:r})}};JX.YAMLMap=XX;JX.findPair=bN});var GT=R(E_e=>{"use strict";var $Qe=sn(),T_e=M0(),WQe={collection:"map",default:!0,nodeClass:T_e.YAMLMap,tag:"tag:yaml.org,2002:map",resolve(t,e){return $Qe.isMap(t)||e("Expected a mapping for this tag"),t},createNode:(t,e,r)=>T_e.YAMLMap.from(t,e,r)};E_e.map=WQe});var F0=R(w_e=>{"use strict";var KQe=pN(),YQe=QX(),QQe=K8(),s9=sn(),XQe=To(),JQe=P0(),ZX=class extends QQe.Collection{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(s9.SEQ,e),this.items=[]}add(e){this.items.push(e)}delete(e){let r=o9(e);return typeof r!="number"?!1:this.items.splice(r,1).length>0}get(e,r){let n=o9(e);if(typeof n!="number")return;let o=this.items[n];return!r&&s9.isScalar(o)?o.value:o}has(e){let r=o9(e);return typeof r=="number"&&r<this.items.length}set(e,r){let n=o9(e);if(typeof n!="number")throw new Error(`Expected a valid index, not ${e}.`);let o=this.items[n];s9.isScalar(o)&&XQe.isScalarValue(r)?o.value=r:this.items[n]=r}toJSON(e,r){let n=[];r?.onCreate&&r.onCreate(n);let o=0;for(let s of this.items)n.push(JQe.toJS(s,String(o++),r));return n}toString(e,r,n){return e?YQe.stringifyCollection(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:n,onComment:r}):JSON.stringify(this)}static from(e,r,n){let{replacer:o}=n,s=new this(e);if(r&&Symbol.iterator in Object(r)){let a=0;for(let c of r){if(typeof o=="function"){let l=r instanceof Set?c:String(a++);c=o.call(r,l,c)}s.items.push(KQe.createNode(c,void 0,n))}}return s}};function o9(t){let e=s9.isScalar(t)?t.value:t;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}w_e.YAMLSeq=ZX});var zT=R(R_e=>{"use strict";var ZQe=sn(),k_e=F0(),eXe={collection:"seq",default:!0,nodeClass:k_e.YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve(t,e){return ZQe.isSeq(t)||e("Expected a sequence for this tag"),t},createNode:(t,e,r)=>k_e.YAMLSeq.from(t,e,r)};R_e.seq=eXe});var _N=R(P_e=>{"use strict";var tXe=gN(),rXe={identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify(t,e,r,n){return e=Object.assign({actualString:!0},e),tXe.stringifyString(t,e,r,n)}};P_e.string=rXe});var a9=R(N_e=>{"use strict";var A_e=To(),D_e={identify:t=>t==null,createNode:()=>new A_e.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new A_e.Scalar(null),stringify:({source:t},e)=>typeof t=="string"&&D_e.test.test(t)?t:e.options.nullStr};N_e.nullTag=D_e});var eJ=R(O_e=>{"use strict";var nXe=To(),L_e={identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new nXe.Scalar(t[0]==="t"||t[0]==="T"),stringify({source:t,value:e},r){if(t&&L_e.test.test(t)){let n=t[0]==="t"||t[0]==="T";if(e===n)return t}return e?r.options.trueStr:r.options.falseStr}};O_e.boolTag=L_e});var $T=R(M_e=>{"use strict";function iXe({format:t,minFractionDigits:e,tag:r,value:n}){if(typeof n=="bigint")return String(n);let o=typeof n=="number"?n:Number(n);if(!isFinite(o))return isNaN(o)?".nan":o<0?"-.inf":".inf";let s=JSON.stringify(n);if(!t&&e&&(!r||r==="tag:yaml.org,2002:float")&&/^\d/.test(s)){let a=s.indexOf(".");a<0&&(a=s.length,s+=".");let c=e-(s.length-a-1);for(;c-- >0;)s+="0"}return s}M_e.stringifyNumber=iXe});var rJ=R(c9=>{"use strict";var oXe=To(),tJ=$T(),sXe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:tJ.stringifyNumber},aXe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){let e=Number(t.value);return isFinite(e)?e.toExponential():tJ.stringifyNumber(t)}},cXe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){let e=new oXe.Scalar(parseFloat(t)),r=t.indexOf(".");return r!==-1&&t[t.length-1]==="0"&&(e.minFractionDigits=t.length-r-1),e},stringify:tJ.stringifyNumber};c9.float=cXe;c9.floatExp=aXe;c9.floatNaN=sXe});var iJ=R(u9=>{"use strict";var F_e=$T(),l9=t=>typeof t=="bigint"||Number.isInteger(t),nJ=(t,e,r,{intAsBigInt:n})=>n?BigInt(t):parseInt(t.substring(e),r);function U_e(t,e,r){let{value:n}=t;return l9(n)&&n>=0?r+n.toString(e):F_e.stringifyNumber(t)}var lXe={identify:t=>l9(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,e,r)=>nJ(t,2,8,r),stringify:t=>U_e(t,8,"0o")},uXe={identify:l9,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,e,r)=>nJ(t,0,10,r),stringify:F_e.stringifyNumber},dXe={identify:t=>l9(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,e,r)=>nJ(t,2,16,r),stringify:t=>U_e(t,16,"0x")};u9.int=uXe;u9.intHex=dXe;u9.intOct=lXe});var q_e=R(B_e=>{"use strict";var pXe=GT(),fXe=a9(),mXe=zT(),hXe=_N(),gXe=eJ(),oJ=rJ(),sJ=iJ(),vXe=[pXe.map,mXe.seq,hXe.string,fXe.nullTag,gXe.boolTag,sJ.intOct,sJ.int,sJ.intHex,oJ.floatNaN,oJ.floatExp,oJ.float];B_e.schema=vXe});var H_e=R(V_e=>{"use strict";var yXe=To(),bXe=GT(),_Xe=zT();function j_e(t){return typeof t=="bigint"||Number.isInteger(t)}var d9=({value:t})=>JSON.stringify(t),xXe=[{identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:d9},{identify:t=>t==null,createNode:()=>new yXe.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:d9},{identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:t=>t==="true",stringify:d9},{identify:j_e,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,e,{intAsBigInt:r})=>r?BigInt(t):parseInt(t,10),stringify:({value:t})=>j_e(t)?t.toString():JSON.stringify(t)},{identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:d9}],SXe={default:!0,tag:"",test:/^/,resolve(t,e){return e(`Unresolved plain scalar ${JSON.stringify(t)}`),t}},IXe=[bXe.map,_Xe.seq].concat(xXe,SXe);V_e.schema=IXe});var cJ=R(G_e=>{"use strict";var aJ=To(),CXe=gN(),TXe={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,e){if(typeof Buffer=="function")return Buffer.from(t,"base64");if(typeof atob=="function"){let r=atob(t.replace(/[\n\r]/g,"")),n=new Uint8Array(r.length);for(let o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),t},stringify({comment:t,type:e,value:r},n,o,s){let a=r,c;if(typeof Buffer=="function")c=a instanceof Buffer?a.toString("base64"):Buffer.from(a.buffer).toString("base64");else if(typeof btoa=="function"){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);c=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=aJ.Scalar.BLOCK_LITERAL),e!==aJ.Scalar.QUOTE_DOUBLE){let l=Math.max(n.options.lineWidth-n.indent.length,n.options.minContentWidth),u=Math.ceil(c.length/l),d=new Array(u);for(let p=0,f=0;p<u;++p,f+=l)d[p]=c.substr(f,l);c=d.join(e===aJ.Scalar.BLOCK_LITERAL?`
`:" ")}return CXe.stringifyString({comment:t,type:e,value:c},n,o,s)}};G_e.binary=TXe});var m9=R(f9=>{"use strict";var p9=sn(),lJ=L0(),EXe=To(),wXe=F0();function z_e(t,e){if(p9.isSeq(t))for(let r=0;r<t.items.length;++r){let n=t.items[r];if(!p9.isPair(n)){if(p9.isMap(n)){n.items.length>1&&e("Each pair must have its own sequence indicator");let o=n.items[0]||new lJ.Pair(new EXe.Scalar(null));if(n.commentBefore&&(o.key.commentBefore=o.key.commentBefore?`${n.commentBefore}
${o.key.commentBefore}`:n.commentBefore),n.comment){let s=o.value??o.key;s.comment=s.comment?`${n.comment}
${s.comment}`:n.comment}n=o}t.items[r]=p9.isPair(n)?n:new lJ.Pair(n)}}else e("Expected a sequence for this tag");return t}function $_e(t,e,r){let{replacer:n}=r,o=new wXe.YAMLSeq(t);o.tag="tag:yaml.org,2002:pairs";let s=0;if(e&&Symbol.iterator in Object(e))for(let a of e){typeof n=="function"&&(a=n.call(e,String(s++),a));let c,l;if(Array.isArray(a))if(a.length===2)c=a[0],l=a[1];else throw new TypeError(`Expected [key, value] tuple: ${a}`);else if(a&&a instanceof Object){let u=Object.keys(a);if(u.length===1)c=u[0],l=a[c];else throw new TypeError(`Expected tuple with one key, not ${u.length} keys`)}else c=a;o.items.push(lJ.createPair(c,l,r))}return o}var kXe={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:z_e,createNode:$_e};f9.createPairs=$_e;f9.pairs=kXe;f9.resolvePairs=z_e});var pJ=R(dJ=>{"use strict";var W_e=sn(),uJ=P0(),xN=M0(),RXe=F0(),K_e=m9(),dx=class t extends RXe.YAMLSeq{constructor(){super(),this.add=xN.YAMLMap.prototype.add.bind(this),this.delete=xN.YAMLMap.prototype.delete.bind(this),this.get=xN.YAMLMap.prototype.get.bind(this),this.has=xN.YAMLMap.prototype.has.bind(this),this.set=xN.YAMLMap.prototype.set.bind(this),this.tag=t.tag}toJSON(e,r){if(!r)return super.toJSON(e);let n=new Map;r?.onCreate&&r.onCreate(n);for(let o of this.items){let s,a;if(W_e.isPair(o)?(s=uJ.toJS(o.key,"",r),a=uJ.toJS(o.value,s,r)):s=uJ.toJS(o,"",r),n.has(s))throw new Error("Ordered maps must not include duplicate keys");n.set(s,a)}return n}static from(e,r,n){let o=K_e.createPairs(e,r,n),s=new this;return s.items=o.items,s}};dx.tag="tag:yaml.org,2002:omap";var PXe={collection:"seq",identify:t=>t instanceof Map,nodeClass:dx,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,e){let r=K_e.resolvePairs(t,e),n=[];for(let{key:o}of r.items)W_e.isScalar(o)&&(n.includes(o.value)?e(`Ordered maps must not include duplicate keys: ${o.value}`):n.push(o.value));return Object.assign(new dx,r)},createNode:(t,e,r)=>dx.from(t,e,r)};dJ.YAMLOMap=dx;dJ.omap=PXe});var Z_e=R(fJ=>{"use strict";var Y_e=To();function Q_e({value:t,source:e},r){return e&&(t?X_e:J_e).test.test(e)?e:t?r.options.trueStr:r.options.falseStr}var X_e={identify:t=>t===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new Y_e.Scalar(!0),stringify:Q_e},J_e={identify:t=>t===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new Y_e.Scalar(!1),stringify:Q_e};fJ.falseTag=J_e;fJ.trueTag=X_e});var exe=R(h9=>{"use strict";var AXe=To(),mJ=$T(),DXe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:mJ.stringifyNumber},NXe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){let e=Number(t.value);return isFinite(e)?e.toExponential():mJ.stringifyNumber(t)}},LXe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){let e=new AXe.Scalar(parseFloat(t.replace(/_/g,""))),r=t.indexOf(".");if(r!==-1){let n=t.substring(r+1).replace(/_/g,"");n[n.length-1]==="0"&&(e.minFractionDigits=n.length)}return e},stringify:mJ.stringifyNumber};h9.float=LXe;h9.floatExp=NXe;h9.floatNaN=DXe});var rxe=R(IN=>{"use strict";var txe=$T(),SN=t=>typeof t=="bigint"||Number.isInteger(t);function g9(t,e,r,{intAsBigInt:n}){let o=t[0];if((o==="-"||o==="+")&&(e+=1),t=t.substring(e).replace(/_/g,""),n){switch(r){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`;break}let a=BigInt(t);return o==="-"?BigInt(-1)*a:a}let s=parseInt(t,r);return o==="-"?-1*s:s}function hJ(t,e,r){let{value:n}=t;if(SN(n)){let o=n.toString(e);return n<0?"-"+r+o.substr(1):r+o}return txe.stringifyNumber(t)}var OXe={identify:SN,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,e,r)=>g9(t,2,2,r),stringify:t=>hJ(t,2,"0b")},MXe={identify:SN,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,e,r)=>g9(t,1,8,r),stringify:t=>hJ(t,8,"0")},FXe={identify:SN,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,e,r)=>g9(t,0,10,r),stringify:txe.stringifyNumber},UXe={identify:SN,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,e,r)=>g9(t,2,16,r),stringify:t=>hJ(t,16,"0x")};IN.int=FXe;IN.intBin=OXe;IN.intHex=UXe;IN.intOct=MXe});var vJ=R(gJ=>{"use strict";var b9=sn(),v9=L0(),y9=M0(),px=class t extends y9.YAMLMap{constructor(e){super(e),this.tag=t.tag}add(e){let r;b9.isPair(e)?r=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?r=new v9.Pair(e.key,null):r=new v9.Pair(e,null),y9.findPair(this.items,r.key)||this.items.push(r)}get(e,r){let n=y9.findPair(this.items,e);return!r&&b9.isPair(n)?b9.isScalar(n.key)?n.key.value:n.key:n}set(e,r){if(typeof r!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof r}`);let n=y9.findPair(this.items,e);n&&!r?this.items.splice(this.items.indexOf(n),1):!n&&r&&this.items.push(new v9.Pair(e))}toJSON(e,r){return super.toJSON(e,r,Set)}toString(e,r,n){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),r,n);throw new Error("Set items must all have null values")}static from(e,r,n){let{replacer:o}=n,s=new this(e);if(r&&Symbol.iterator in Object(r))for(let a of r)typeof o=="function"&&(a=o.call(r,a,a)),s.items.push(v9.createPair(a,null,n));return s}};px.tag="tag:yaml.org,2002:set";var BXe={collection:"map",identify:t=>t instanceof Set,nodeClass:px,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,e,r)=>px.from(t,e,r),resolve(t,e){if(b9.isMap(t)){if(t.hasAllNullValues(!0))return Object.assign(new px,t);e("Set items must all have null values")}else e("Expected a mapping for this tag");return t}};gJ.YAMLSet=px;gJ.set=BXe});var bJ=R(_9=>{"use strict";var qXe=$T();function yJ(t,e){let r=t[0],n=r==="-"||r==="+"?t.substring(1):t,o=a=>e?BigInt(a):Number(a),s=n.replace(/_/g,"").split(":").reduce((a,c)=>a*o(60)+o(c),o(0));return r==="-"?o(-1)*s:s}function nxe(t){let{value:e}=t,r=a=>a;if(typeof e=="bigint")r=a=>BigInt(a);else if(isNaN(e)||!isFinite(e))return qXe.stringifyNumber(t);let n="";e<0&&(n="-",e*=r(-1));let o=r(60),s=[e%o];return e<60?s.unshift(0):(e=(e-s[0])/o,s.unshift(e%o),e>=60&&(e=(e-s[0])/o,s.unshift(e))),n+s.map(a=>String(a).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}var jXe={identify:t=>typeof t=="bigint"||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,e,{intAsBigInt:r})=>yJ(t,r),stringify:nxe},VXe={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>yJ(t,!1),stringify:nxe},ixe={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){let e=t.match(ixe.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,r,n,o,s,a,c]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0,u=Date.UTC(r,n-1,o,s||0,a||0,c||0,l),d=e[8];if(d&&d!=="Z"){let p=yJ(d,!1);Math.abs(p)<30&&(p*=60),u-=6e4*p}return new Date(u)},stringify:({value:t})=>t.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")};_9.floatTime=VXe;_9.intTime=jXe;_9.timestamp=ixe});var axe=R(sxe=>{"use strict";var HXe=GT(),GXe=a9(),zXe=zT(),$Xe=_N(),WXe=cJ(),oxe=Z_e(),_J=exe(),x9=rxe(),KXe=pJ(),YXe=m9(),QXe=vJ(),xJ=bJ(),XXe=[HXe.map,zXe.seq,$Xe.string,GXe.nullTag,oxe.trueTag,oxe.falseTag,x9.intBin,x9.intOct,x9.int,x9.intHex,_J.floatNaN,_J.floatExp,_J.float,WXe.binary,KXe.omap,YXe.pairs,QXe.set,xJ.intTime,xJ.floatTime,xJ.timestamp];sxe.schema=XXe});var vxe=R(CJ=>{"use strict";var dxe=GT(),JXe=a9(),pxe=zT(),ZXe=_N(),eJe=eJ(),SJ=rJ(),IJ=iJ(),tJe=q_e(),rJe=H_e(),fxe=cJ(),mxe=pJ(),hxe=m9(),cxe=axe(),gxe=vJ(),S9=bJ(),lxe=new Map([["core",tJe.schema],["failsafe",[dxe.map,pxe.seq,ZXe.string]],["json",rJe.schema],["yaml11",cxe.schema],["yaml-1.1",cxe.schema]]),uxe={binary:fxe.binary,bool:eJe.boolTag,float:SJ.float,floatExp:SJ.floatExp,floatNaN:SJ.floatNaN,floatTime:S9.floatTime,int:IJ.int,intHex:IJ.intHex,intOct:IJ.intOct,intTime:S9.intTime,map:dxe.map,null:JXe.nullTag,omap:mxe.omap,pairs:hxe.pairs,seq:pxe.seq,set:gxe.set,timestamp:S9.timestamp},nJe={"tag:yaml.org,2002:binary":fxe.binary,"tag:yaml.org,2002:omap":mxe.omap,"tag:yaml.org,2002:pairs":hxe.pairs,"tag:yaml.org,2002:set":gxe.set,"tag:yaml.org,2002:timestamp":S9.timestamp};function iJe(t,e){let r=lxe.get(e);if(!r)if(Array.isArray(t))r=[];else{let n=Array.from(lxe.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${n} or define customTags array`)}if(Array.isArray(t))for(let n of t)r=r.concat(n);else typeof t=="function"&&(r=t(r.slice()));return r.map(n=>{if(typeof n!="string")return n;let o=uxe[n];if(o)return o;let s=Object.keys(uxe).map(a=>JSON.stringify(a)).join(", ");throw new Error(`Unknown custom tag "${n}"; use one of ${s}`)})}CJ.coreKnownTags=nJe;CJ.getTags=iJe});var wJ=R(yxe=>{"use strict";var TJ=sn(),oJe=GT(),sJe=zT(),aJe=_N(),I9=vxe(),cJe=(t,e)=>t.key<e.key?-1:t.key>e.key?1:0,EJ=class t{constructor({compat:e,customTags:r,merge:n,resolveKnownTags:o,schema:s,sortMapEntries:a,toStringDefaults:c}){this.compat=Array.isArray(e)?I9.getTags(e,"compat"):e?I9.getTags(null,e):null,this.merge=!!n,this.name=typeof s=="string"&&s||"core",this.knownTags=o?I9.coreKnownTags:{},this.tags=I9.getTags(r,this.name),this.toStringOptions=c??null,Object.defineProperty(this,TJ.MAP,{value:oJe.map}),Object.defineProperty(this,TJ.SCALAR,{value:aJe.string}),Object.defineProperty(this,TJ.SEQ,{value:sJe.seq}),this.sortMapEntries=typeof a=="function"?a:a===!0?cJe:null}clone(){let e=Object.create(t.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}};yxe.Schema=EJ});var _xe=R(bxe=>{"use strict";var lJe=sn(),kJ=vN(),CN=fN();function uJe(t,e){let r=[],n=e.directives===!0;if(e.directives!==!1&&t.directives){let l=t.directives.toString(t);l?(r.push(l),n=!0):t.directives.docStart&&(n=!0)}n&&r.push("---");let o=kJ.createStringifyContext(t,e),{commentString:s}=o.options;if(t.commentBefore){r.length!==1&&r.unshift("");let l=s(t.commentBefore);r.unshift(CN.indentComment(l,""))}let a=!1,c=null;if(t.contents){if(lJe.isNode(t.contents)){if(t.contents.spaceBefore&&n&&r.push(""),t.contents.commentBefore){let d=s(t.contents.commentBefore);r.push(CN.indentComment(d,""))}o.forceBlockIndent=!!t.comment,c=t.contents.comment}let l=c?void 0:()=>a=!0,u=kJ.stringify(t.contents,o,()=>c=null,l);c&&(u+=CN.lineComment(u,"",s(c))),(u[0]==="|"||u[0]===">")&&r[r.length-1]==="---"?r[r.length-1]=`--- ${u}`:r.push(u)}else r.push(kJ.stringify(t.contents,o));if(t.directives?.docEnd)if(t.comment){let l=s(t.comment);l.includes(`
`)?(r.push("..."),r.push(CN.indentComment(l,""))):r.push(`... ${l}`)}else r.push("...");else{let l=t.comment;l&&a&&(l=l.replace(/^\n+/,"")),l&&((!a||c)&&r[r.length-1]!==""&&r.push(""),r.push(CN.indentComment(s(l),"")))}return r.join(`
`)+`
`}bxe.stringifyDocument=uJe});var TN=R(xxe=>{"use strict";var dJe=dN(),WT=K8(),nu=sn(),pJe=L0(),fJe=P0(),mJe=wJ(),hJe=_xe(),RJ=H8(),gJe=NX(),vJe=pN(),PJ=DX(),AJ=class t{constructor(e,r,n){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,nu.NODE_TYPE,{value:nu.DOC});let o=null;typeof r=="function"||Array.isArray(r)?o=r:n===void 0&&r&&(n=r,r=void 0);let s=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},n);this.options=s;let{version:a}=s;n?._directives?(this.directives=n._directives.atDocument(),this.directives.yaml.explicit&&(a=this.directives.yaml.version)):this.directives=new PJ.Directives({version:a}),this.setSchema(a,n),this.contents=e===void 0?null:this.createNode(e,o,n)}clone(){let e=Object.create(t.prototype,{[nu.NODE_TYPE]:{value:nu.DOC}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=nu.isNode(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){KT(this.contents)&&this.contents.add(e)}addIn(e,r){KT(this.contents)&&this.contents.addIn(e,r)}createAlias(e,r){if(!e.anchor){let n=RJ.anchorNames(this);e.anchor=!r||n.has(r)?RJ.findNewAnchor(r||"a",n):r}return new dJe.Alias(e.anchor)}createNode(e,r,n){let o;if(typeof r=="function")e=r.call({"":e},"",e),o=r;else if(Array.isArray(r)){let v=_=>typeof _=="number"||_ instanceof String||_ instanceof Number,b=r.filter(v).map(String);b.length>0&&(r=r.concat(b)),o=r}else n===void 0&&r&&(n=r,r=void 0);let{aliasDuplicateObjects:s,anchorPrefix:a,flow:c,keepUndefined:l,onTagObj:u,tag:d}=n??{},{onAnchor:p,setAnchors:f,sourceObjects:m}=RJ.createNodeAnchors(this,a||"a"),h={aliasDuplicateObjects:s??!0,keepUndefined:l??!1,onAnchor:p,onTagObj:u,replacer:o,schema:this.schema,sourceObjects:m},g=vJe.createNode(e,d,h);return c&&nu.isCollection(g)&&(g.flow=!0),f(),g}createPair(e,r,n={}){let o=this.createNode(e,null,n),s=this.createNode(r,null,n);return new pJe.Pair(o,s)}delete(e){return KT(this.contents)?this.contents.delete(e):!1}deleteIn(e){return WT.isEmptyPath(e)?this.contents==null?!1:(this.contents=null,!0):KT(this.contents)?this.contents.deleteIn(e):!1}get(e,r){return nu.isCollection(this.contents)?this.contents.get(e,r):void 0}getIn(e,r){return WT.isEmptyPath(e)?!r&&nu.isScalar(this.contents)?this.contents.value:this.contents:nu.isCollection(this.contents)?this.contents.getIn(e,r):void 0}has(e){return nu.isCollection(this.contents)?this.contents.has(e):!1}hasIn(e){return WT.isEmptyPath(e)?this.contents!==void 0:nu.isCollection(this.contents)?this.contents.hasIn(e):!1}set(e,r){this.contents==null?this.contents=WT.collectionFromPath(this.schema,[e],r):KT(this.contents)&&this.contents.set(e,r)}setIn(e,r){WT.isEmptyPath(e)?this.contents=r:this.contents==null?this.contents=WT.collectionFromPath(this.schema,Array.from(e),r):KT(this.contents)&&this.contents.setIn(e,r)}setSchema(e,r={}){typeof e=="number"&&(e=String(e));let n;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new PJ.Directives({version:"1.1"}),n={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new PJ.Directives({version:e}),n={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,n=null;break;default:{let o=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${o}`)}}if(r.schema instanceof Object)this.schema=r.schema;else if(n)this.schema=new mJe.Schema(Object.assign(n,r));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:r,mapAsMap:n,maxAliasCount:o,onAnchor:s,reviver:a}={}){let c={anchors:new Map,doc:this,keep:!e,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof o=="number"?o:100},l=fJe.toJS(this.contents,r??"",c);if(typeof s=="function")for(let{count:u,res:d}of c.anchors.values())s(d,u);return typeof a=="function"?gJe.applyReviver(a,{"":l},"",l):l}toJSON(e,r){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:r})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){let r=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${r}`)}return hJe.stringifyDocument(this,e)}};function KT(t){if(nu.isCollection(t))return!0;throw new Error("Expected a YAML collection as document contents")}xxe.Document=AJ});var kN=R(wN=>{"use strict";var EN=class extends Error{constructor(e,r,n,o){super(),this.name=e,this.code=n,this.message=o,this.pos=r}},DJ=class extends EN{constructor(e,r,n){super("YAMLParseError",e,r,n)}},NJ=class extends EN{constructor(e,r,n){super("YAMLWarning",e,r,n)}},yJe=(t,e)=>r=>{if(r.pos[0]===-1)return;r.linePos=r.pos.map(c=>e.linePos(c));let{line:n,col:o}=r.linePos[0];r.message+=` at line ${n}, column ${o}`;let s=o-1,a=t.substring(e.lineStarts[n-1],e.lineStarts[n]).replace(/[\n\r]+$/,"");if(s>=60&&a.length>80){let c=Math.min(s-39,a.length-79);a="\u2026"+a.substring(c),s-=c-1}if(a.length>80&&(a=a.substring(0,79)+"\u2026"),n>1&&/^ *$/.test(a.substring(0,s))){let c=t.substring(e.lineStarts[n-2],e.lineStarts[n-1]);c.length>80&&(c=c.substring(0,79)+`\u2026
`),a=c+a}if(/[^ ]/.test(a)){let c=1,l=r.linePos[1];l&&l.line===n&&l.col>o&&(c=Math.max(1,Math.min(l.col-o,80-s)));let u=" ".repeat(s)+"^".repeat(c);r.message+=`:

${a}
${u}
`}};wN.YAMLError=EN;wN.YAMLParseError=DJ;wN.YAMLWarning=NJ;wN.prettifyError=yJe});var RN=R(Sxe=>{"use strict";function bJe(t,{flow:e,indicator:r,next:n,offset:o,onError:s,parentIndent:a,startOnNewline:c}){let l=!1,u=c,d=c,p="",f="",m=!1,h=!1,g=null,v=null,b=null,_=null,x=null,S=null,I=null;for(let M of t)switch(h&&(M.type!=="space"&&M.type!=="newline"&&M.type!=="comma"&&s(M.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),h=!1),g&&(u&&M.type!=="comment"&&M.type!=="newline"&&s(g,"TAB_AS_INDENT","Tabs are not allowed as indentation"),g=null),M.type){case"space":!e&&(r!=="doc-start"||n?.type!=="flow-collection")&&M.source.includes("	")&&(g=M),d=!0;break;case"comment":{d||s(M,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let H=M.source.substring(1)||" ";p?p+=f+H:p=H,f="",u=!1;break}case"newline":u?p?p+=M.source:l=!0:f+=M.source,u=!0,m=!0,(v||b)&&(_=M),d=!0;break;case"anchor":v&&s(M,"MULTIPLE_ANCHORS","A node can have at most one anchor"),M.source.endsWith(":")&&s(M.offset+M.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),v=M,I===null&&(I=M.offset),u=!1,d=!1,h=!0;break;case"tag":{b&&s(M,"MULTIPLE_TAGS","A node can have at most one tag"),b=M,I===null&&(I=M.offset),u=!1,d=!1,h=!0;break}case r:(v||b)&&s(M,"BAD_PROP_ORDER",`Anchors and tags must be after the ${M.source} indicator`),S&&s(M,"UNEXPECTED_TOKEN",`Unexpected ${M.source} in ${e??"collection"}`),S=M,u=r==="seq-item-ind"||r==="explicit-key-ind",d=!1;break;case"comma":if(e){x&&s(M,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),x=M,u=!1,d=!1;break}default:s(M,"UNEXPECTED_TOKEN",`Unexpected ${M.type} token`),u=!1,d=!1}let w=t[t.length-1],k=w?w.offset+w.source.length:o;return h&&n&&n.type!=="space"&&n.type!=="newline"&&n.type!=="comma"&&(n.type!=="scalar"||n.source!=="")&&s(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),g&&(u&&g.indent<=a||n?.type==="block-map"||n?.type==="block-seq")&&s(g,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:x,found:S,spaceBefore:l,comment:p,hasNewline:m,anchor:v,tag:b,newlineAfterProp:_,end:k,start:I??k}}Sxe.resolveProps=bJe});var C9=R(Ixe=>{"use strict";function LJ(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(let e of t.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(let e of t.items){for(let r of e.start)if(r.type==="newline")return!0;if(e.sep){for(let r of e.sep)if(r.type==="newline")return!0}if(LJ(e.key)||LJ(e.value))return!0}return!1;default:return!0}}Ixe.containsNewline=LJ});var OJ=R(Cxe=>{"use strict";var _Je=C9();function xJe(t,e,r){if(e?.type==="flow-collection"){let n=e.end[0];n.indent===t&&(n.source==="]"||n.source==="}")&&_Je.containsNewline(e)&&r(n,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}Cxe.flowIndentCheck=xJe});var MJ=R(Exe=>{"use strict";var Txe=sn();function SJe(t,e,r){let{uniqueKeys:n}=t.options;if(n===!1)return!1;let o=typeof n=="function"?n:(s,a)=>s===a||Txe.isScalar(s)&&Txe.isScalar(a)&&s.value===a.value&&!(s.value==="<<"&&t.schema.merge);return e.some(s=>o(s.key,r))}Exe.mapIncludes=SJe});var Dxe=R(Axe=>{"use strict";var wxe=L0(),IJe=M0(),kxe=RN(),CJe=C9(),Rxe=OJ(),TJe=MJ(),Pxe="All mapping items must start at the same column";function EJe({composeNode:t,composeEmptyNode:e},r,n,o,s){let a=s?.nodeClass??IJe.YAMLMap,c=new a(r.schema);r.atRoot&&(r.atRoot=!1);let l=n.offset,u=null;for(let d of n.items){let{start:p,key:f,sep:m,value:h}=d,g=kxe.resolveProps(p,{indicator:"explicit-key-ind",next:f??m?.[0],offset:l,onError:o,parentIndent:n.indent,startOnNewline:!0}),v=!g.found;if(v){if(f&&(f.type==="block-seq"?o(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in f&&f.indent!==n.indent&&o(l,"BAD_INDENT",Pxe)),!g.anchor&&!g.tag&&!m){u=g.end,g.comment&&(c.comment?c.comment+=`
`+g.comment:c.comment=g.comment);continue}(g.newlineAfterProp||CJe.containsNewline(f))&&o(f??p[p.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else g.found?.indent!==n.indent&&o(l,"BAD_INDENT",Pxe);let b=g.end,_=f?t(r,f,g,o):e(r,b,p,null,g,o);r.schema.compat&&Rxe.flowIndentCheck(n.indent,f,o),TJe.mapIncludes(r,c.items,_)&&o(b,"DUPLICATE_KEY","Map keys must be unique");let x=kxe.resolveProps(m??[],{indicator:"map-value-ind",next:h,offset:_.range[2],onError:o,parentIndent:n.indent,startOnNewline:!f||f.type==="block-scalar"});if(l=x.end,x.found){v&&(h?.type==="block-map"&&!x.hasNewline&&o(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),r.options.strict&&g.start<x.found.offset-1024&&o(_.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let S=h?t(r,h,x,o):e(r,l,m,null,x,o);r.schema.compat&&Rxe.flowIndentCheck(n.indent,h,o),l=S.range[2];let I=new wxe.Pair(_,S);r.options.keepSourceTokens&&(I.srcToken=d),c.items.push(I)}else{v&&o(_.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),x.comment&&(_.comment?_.comment+=`
`+x.comment:_.comment=x.comment);let S=new wxe.Pair(_);r.options.keepSourceTokens&&(S.srcToken=d),c.items.push(S)}}return u&&u<l&&o(u,"IMPOSSIBLE","Map comment with trailing content"),c.range=[n.offset,l,u??l],c}Axe.resolveBlockMap=EJe});var Lxe=R(Nxe=>{"use strict";var wJe=F0(),kJe=RN(),RJe=OJ();function PJe({composeNode:t,composeEmptyNode:e},r,n,o,s){let a=s?.nodeClass??wJe.YAMLSeq,c=new a(r.schema);r.atRoot&&(r.atRoot=!1);let l=n.offset,u=null;for(let{start:d,value:p}of n.items){let f=kJe.resolveProps(d,{indicator:"seq-item-ind",next:p,offset:l,onError:o,parentIndent:n.indent,startOnNewline:!0});if(!f.found)if(f.anchor||f.tag||p)p&&p.type==="block-seq"?o(f.end,"BAD_INDENT","All sequence items must start at the same column"):o(l,"MISSING_CHAR","Sequence item without - indicator");else{u=f.end,f.comment&&(c.comment=f.comment);continue}let m=p?t(r,p,f,o):e(r,f.end,d,null,f,o);r.schema.compat&&RJe.flowIndentCheck(n.indent,p,o),l=m.range[2],c.items.push(m)}return c.range=[n.offset,l,u??l],c}Nxe.resolveBlockSeq=PJe});var YT=R(Oxe=>{"use strict";function AJe(t,e,r,n){let o="";if(t){let s=!1,a="";for(let c of t){let{source:l,type:u}=c;switch(u){case"space":s=!0;break;case"comment":{r&&!s&&n(c,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let d=l.substring(1)||" ";o?o+=a+d:o=d,a="";break}case"newline":o&&(a+=l),s=!0;break;default:n(c,"UNEXPECTED_TOKEN",`Unexpected ${u} at node end`)}e+=l.length}}return{comment:o,offset:e}}Oxe.resolveEnd=AJe});var Bxe=R(Uxe=>{"use strict";var DJe=sn(),NJe=L0(),Mxe=M0(),LJe=F0(),OJe=YT(),Fxe=RN(),MJe=C9(),FJe=MJ(),FJ="Block collections are not allowed within flow collections",UJ=t=>t&&(t.type==="block-map"||t.type==="block-seq");function UJe({composeNode:t,composeEmptyNode:e},r,n,o,s){let a=n.start.source==="{",c=a?"flow map":"flow sequence",l=s?.nodeClass??(a?Mxe.YAMLMap:LJe.YAMLSeq),u=new l(r.schema);u.flow=!0;let d=r.atRoot;d&&(r.atRoot=!1);let p=n.offset+n.start.source.length;for(let v=0;v<n.items.length;++v){let b=n.items[v],{start:_,key:x,sep:S,value:I}=b,w=Fxe.resolveProps(_,{flow:c,indicator:"explicit-key-ind",next:x??S?.[0],offset:p,onError:o,parentIndent:n.indent,startOnNewline:!1});if(!w.found){if(!w.anchor&&!w.tag&&!S&&!I){v===0&&w.comma?o(w.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${c}`):v<n.items.length-1&&o(w.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${c}`),w.comment&&(u.comment?u.comment+=`
`+w.comment:u.comment=w.comment),p=w.end;continue}!a&&r.options.strict&&MJe.containsNewline(x)&&o(x,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(v===0)w.comma&&o(w.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${c}`);else if(w.comma||o(w.start,"MISSING_CHAR",`Missing , between ${c} items`),w.comment){let k="";e:for(let M of _)switch(M.type){case"comma":case"space":break;case"comment":k=M.source.substring(1);break e;default:break e}if(k){let M=u.items[u.items.length-1];DJe.isPair(M)&&(M=M.value??M.key),M.comment?M.comment+=`
`+k:M.comment=k,w.comment=w.comment.substring(k.length+1)}}if(!a&&!S&&!w.found){let k=I?t(r,I,w,o):e(r,w.end,S,null,w,o);u.items.push(k),p=k.range[2],UJ(I)&&o(k.range,"BLOCK_IN_FLOW",FJ)}else{let k=w.end,M=x?t(r,x,w,o):e(r,k,_,null,w,o);UJ(x)&&o(M.range,"BLOCK_IN_FLOW",FJ);let H=Fxe.resolveProps(S??[],{flow:c,indicator:"map-value-ind",next:I,offset:M.range[2],onError:o,parentIndent:n.indent,startOnNewline:!1});if(H.found){if(!a&&!w.found&&r.options.strict){if(S)for(let Z of S){if(Z===H.found)break;if(Z.type==="newline"){o(Z,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}w.start<H.found.offset-1024&&o(H.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else I&&("source"in I&&I.source&&I.source[0]===":"?o(I,"MISSING_CHAR",`Missing space after : in ${c}`):o(H.start,"MISSING_CHAR",`Missing , or : between ${c} items`));let F=I?t(r,I,H,o):H.found?e(r,H.end,S,null,H,o):null;F?UJ(I)&&o(F.range,"BLOCK_IN_FLOW",FJ):H.comment&&(M.comment?M.comment+=`
`+H.comment:M.comment=H.comment);let ue=new NJe.Pair(M,F);if(r.options.keepSourceTokens&&(ue.srcToken=b),a){let Z=u;FJe.mapIncludes(r,Z.items,M)&&o(k,"DUPLICATE_KEY","Map keys must be unique"),Z.items.push(ue)}else{let Z=new Mxe.YAMLMap(r.schema);Z.flow=!0,Z.items.push(ue),u.items.push(Z)}p=F?F.range[2]:H.end}}let f=a?"}":"]",[m,...h]=n.end,g=p;if(m&&m.source===f)g=m.offset+m.source.length;else{let v=c[0].toUpperCase()+c.substring(1),b=d?`${v} must end with a ${f}`:`${v} in block collection must be sufficiently indented and end with a ${f}`;o(p,d?"MISSING_CHAR":"BAD_INDENT",b),m&&m.source.length!==1&&h.unshift(m)}if(h.length>0){let v=OJe.resolveEnd(h,g,r.options.strict,o);v.comment&&(u.comment?u.comment+=`
`+v.comment:u.comment=v.comment),u.range=[n.offset,g,v.offset]}else u.range=[n.offset,g,g];return u}Uxe.resolveFlowCollection=UJe});var jxe=R(qxe=>{"use strict";var BJe=sn(),qJe=To(),jJe=M0(),VJe=F0(),HJe=Dxe(),GJe=Lxe(),zJe=Bxe();function BJ(t,e,r,n,o,s){let a=r.type==="block-map"?HJe.resolveBlockMap(t,e,r,n,s):r.type==="block-seq"?GJe.resolveBlockSeq(t,e,r,n,s):zJe.resolveFlowCollection(t,e,r,n,s),c=a.constructor;return o==="!"||o===c.tagName?(a.tag=c.tagName,a):(o&&(a.tag=o),a)}function $Je(t,e,r,n,o){let s=n.tag,a=s?e.directives.tagName(s.source,f=>o(s,"TAG_RESOLVE_FAILED",f)):null;if(r.type==="block-seq"){let{anchor:f,newlineAfterProp:m}=n,h=f&&s?f.offset>s.offset?f:s:f??s;h&&(!m||m.offset<h.offset)&&o(h,"MISSING_CHAR","Missing newline after block sequence props")}let c=r.type==="block-map"?"map":r.type==="block-seq"?"seq":r.start.source==="{"?"map":"seq";if(!s||!a||a==="!"||a===jJe.YAMLMap.tagName&&c==="map"||a===VJe.YAMLSeq.tagName&&c==="seq")return BJ(t,e,r,o,a);let l=e.schema.tags.find(f=>f.tag===a&&f.collection===c);if(!l){let f=e.schema.knownTags[a];if(f&&f.collection===c)e.schema.tags.push(Object.assign({},f,{default:!1})),l=f;else return f?.collection?o(s,"BAD_COLLECTION_TYPE",`${f.tag} used for ${c} collection, but expects ${f.collection}`,!0):o(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${a}`,!0),BJ(t,e,r,o,a)}let u=BJ(t,e,r,o,a,l),d=l.resolve?.(u,f=>o(s,"TAG_RESOLVE_FAILED",f),e.options)??u,p=BJe.isNode(d)?d:new qJe.Scalar(d);return p.range=u.range,p.tag=a,l?.format&&(p.format=l.format),p}qxe.composeCollection=$Je});var jJ=R(Vxe=>{"use strict";var qJ=To();function WJe(t,e,r){let n=e.offset,o=KJe(e,t.options.strict,r);if(!o)return{value:"",type:null,comment:"",range:[n,n,n]};let s=o.mode===">"?qJ.Scalar.BLOCK_FOLDED:qJ.Scalar.BLOCK_LITERAL,a=e.source?YJe(e.source):[],c=a.length;for(let g=a.length-1;g>=0;--g){let v=a[g][1];if(v===""||v==="\r")c=g;else break}if(c===0){let g=o.chomp==="+"&&a.length>0?`
`.repeat(Math.max(1,a.length-1)):"",v=n+o.length;return e.source&&(v+=e.source.length),{value:g,type:s,comment:o.comment,range:[n,v,v]}}let l=e.indent+o.indent,u=e.offset+o.length,d=0;for(let g=0;g<c;++g){let[v,b]=a[g];if(b===""||b==="\r")o.indent===0&&v.length>l&&(l=v.length);else{v.length<l&&r(u+v.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),o.indent===0&&(l=v.length),d=g,l===0&&!t.atRoot&&r(u,"BAD_INDENT","Block scalar values in collections must be indented");break}u+=v.length+b.length+1}for(let g=a.length-1;g>=c;--g)a[g][0].length>l&&(c=g+1);let p="",f="",m=!1;for(let g=0;g<d;++g)p+=a[g][0].slice(l)+`
`;for(let g=d;g<c;++g){let[v,b]=a[g];u+=v.length+b.length+1;let _=b[b.length-1]==="\r";if(_&&(b=b.slice(0,-1)),b&&v.length<l){let S=`Block scalar lines must not be less indented than their ${o.indent?"explicit indentation indicator":"first line"}`;r(u-b.length-(_?2:1),"BAD_INDENT",S),v=""}s===qJ.Scalar.BLOCK_LITERAL?(p+=f+v.slice(l)+b,f=`
`):v.length>l||b[0]==="	"?(f===" "?f=`
`:!m&&f===`
`&&(f=`

`),p+=f+v.slice(l)+b,f=`
`,m=!0):b===""?f===`
`?p+=`
`:f=`
`:(p+=f+b,f=" ",m=!1)}switch(o.chomp){case"-":break;case"+":for(let g=c;g<a.length;++g)p+=`
`+a[g][0].slice(l);p[p.length-1]!==`
`&&(p+=`
`);break;default:p+=`
`}let h=n+o.length+e.source.length;return{value:p,type:s,comment:o.comment,range:[n,h,h]}}function KJe({offset:t,props:e},r,n){if(e[0].type!=="block-scalar-header")return n(e[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:o}=e[0],s=o[0],a=0,c="",l=-1;for(let f=1;f<o.length;++f){let m=o[f];if(!c&&(m==="-"||m==="+"))c=m;else{let h=Number(m);!a&&h?a=h:l===-1&&(l=t+f)}}l!==-1&&n(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${o}`);let u=!1,d="",p=o.length;for(let f=1;f<e.length;++f){let m=e[f];switch(m.type){case"space":u=!0;case"newline":p+=m.source.length;break;case"comment":r&&!u&&n(m,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),p+=m.source.length,d=m.source.substring(1);break;case"error":n(m,"UNEXPECTED_TOKEN",m.message),p+=m.source.length;break;default:{let h=`Unexpected token in block scalar header: ${m.type}`;n(m,"UNEXPECTED_TOKEN",h);let g=m.source;g&&typeof g=="string"&&(p+=g.length)}}}return{mode:s,indent:a,chomp:c,comment:d,length:p}}function YJe(t){let e=t.split(/\n( *)/),r=e[0],n=r.match(/^( *)/),s=[n?.[1]?[n[1],r.slice(n[1].length)]:["",r]];for(let a=1;a<e.length;a+=2)s.push([e[a],e[a+1]]);return s}Vxe.resolveBlockScalar=WJe});var HJ=R(Gxe=>{"use strict";var VJ=To(),QJe=YT();function XJe(t,e,r){let{offset:n,type:o,source:s,end:a}=t,c,l,u=(f,m,h)=>r(n+f,m,h);switch(o){case"scalar":c=VJ.Scalar.PLAIN,l=JJe(s,u);break;case"single-quoted-scalar":c=VJ.Scalar.QUOTE_SINGLE,l=ZJe(s,u);break;case"double-quoted-scalar":c=VJ.Scalar.QUOTE_DOUBLE,l=eZe(s,u);break;default:return r(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${o}`),{value:"",type:null,comment:"",range:[n,n+s.length,n+s.length]}}let d=n+s.length,p=QJe.resolveEnd(a,d,e,r);return{value:l,type:c,comment:p.comment,range:[n,d,p.offset]}}function JJe(t,e){let r="";switch(t[0]){case"	":r="a tab character";break;case",":r="flow indicator character ,";break;case"%":r="directive indicator character %";break;case"|":case">":{r=`block scalar indicator ${t[0]}`;break}case"@":case"`":{r=`reserved character ${t[0]}`;break}}return r&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${r}`),Hxe(t)}function ZJe(t,e){return(t[t.length-1]!=="'"||t.length===1)&&e(t.length,"MISSING_CHAR","Missing closing 'quote"),Hxe(t.slice(1,-1)).replace(/''/g,"'")}function Hxe(t){let e,r;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),r=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,r=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=e.exec(t);if(!n)return t;let o=n[1],s=" ",a=e.lastIndex;for(r.lastIndex=a;n=r.exec(t);)n[1]===""?s===`
`?o+=s:s=`
`:(o+=s+n[1],s=" "),a=r.lastIndex;let c=/[ \t]*(.*)/sy;return c.lastIndex=a,n=c.exec(t),o+s+(n?.[1]??"")}function eZe(t,e){let r="";for(let n=1;n<t.length-1;++n){let o=t[n];if(!(o==="\r"&&t[n+1]===`
`))if(o===`
`){let{fold:s,offset:a}=tZe(t,n);r+=s,n=a}else if(o==="\\"){let s=t[++n],a=rZe[s];if(a)r+=a;else if(s===`
`)for(s=t[n+1];s===" "||s==="	";)s=t[++n+1];else if(s==="\r"&&t[n+1]===`
`)for(s=t[++n+1];s===" "||s==="	";)s=t[++n+1];else if(s==="x"||s==="u"||s==="U"){let c={x:2,u:4,U:8}[s];r+=nZe(t,n+1,c,e),n+=c}else{let c=t.substr(n-1,2);e(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${c}`),r+=c}}else if(o===" "||o==="	"){let s=n,a=t[n+1];for(;a===" "||a==="	";)a=t[++n+1];a!==`
`&&!(a==="\r"&&t[n+2]===`
`)&&(r+=n>s?t.slice(s,n+1):o)}else r+=o}return(t[t.length-1]!=='"'||t.length===1)&&e(t.length,"MISSING_CHAR",'Missing closing "quote'),r}function tZe(t,e){let r="",n=t[e+1];for(;(n===" "||n==="	"||n===`
`||n==="\r")&&!(n==="\r"&&t[e+2]!==`
`);)n===`
`&&(r+=`
`),e+=1,n=t[e+1];return r||(r=" "),{fold:r,offset:e}}var rZe={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xA0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function nZe(t,e,r,n){let o=t.substr(e,r),a=o.length===r&&/^[0-9a-fA-F]+$/.test(o)?parseInt(o,16):NaN;if(isNaN(a)){let c=t.substr(e-2,r+2);return n(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${c}`),c}return String.fromCodePoint(a)}Gxe.resolveFlowScalar=XJe});var Wxe=R($xe=>{"use strict";var QT=sn(),zxe=To(),iZe=jJ(),oZe=HJ();function sZe(t,e,r,n){let{value:o,type:s,comment:a,range:c}=e.type==="block-scalar"?iZe.resolveBlockScalar(t,e,n):oZe.resolveFlowScalar(e,t.options.strict,n),l=r?t.directives.tagName(r.source,p=>n(r,"TAG_RESOLVE_FAILED",p)):null,u=r&&l?aZe(t.schema,o,l,r,n):e.type==="scalar"?cZe(t,o,e,n):t.schema[QT.SCALAR],d;try{let p=u.resolve(o,f=>n(r??e,"TAG_RESOLVE_FAILED",f),t.options);d=QT.isScalar(p)?p:new zxe.Scalar(p)}catch(p){let f=p instanceof Error?p.message:String(p);n(r??e,"TAG_RESOLVE_FAILED",f),d=new zxe.Scalar(o)}return d.range=c,d.source=o,s&&(d.type=s),l&&(d.tag=l),u.format&&(d.format=u.format),a&&(d.comment=a),d}function aZe(t,e,r,n,o){if(r==="!")return t[QT.SCALAR];let s=[];for(let c of t.tags)if(!c.collection&&c.tag===r)if(c.default&&c.test)s.push(c);else return c;for(let c of s)if(c.test?.test(e))return c;let a=t.knownTags[r];return a&&!a.collection?(t.tags.push(Object.assign({},a,{default:!1,test:void 0})),a):(o(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${r}`,r!=="tag:yaml.org,2002:str"),t[QT.SCALAR])}function cZe({directives:t,schema:e},r,n,o){let s=e.tags.find(a=>a.default&&a.test?.test(r))||e[QT.SCALAR];if(e.compat){let a=e.compat.find(c=>c.default&&c.test?.test(r))??e[QT.SCALAR];if(s.tag!==a.tag){let c=t.tagString(s.tag),l=t.tagString(a.tag),u=`Value may be parsed as either ${c} or ${l}`;o(n,"TAG_RESOLVE_FAILED",u,!0)}}return s}$xe.composeScalar=sZe});var Yxe=R(Kxe=>{"use strict";function lZe(t,e,r){if(e){r===null&&(r=e.length);for(let n=r-1;n>=0;--n){let o=e[n];switch(o.type){case"space":case"comment":case"newline":t-=o.source.length;continue}for(o=e[++n];o?.type==="space";)t+=o.source.length,o=e[++n];break}}return t}Kxe.emptyScalarPosition=lZe});var Jxe=R(zJ=>{"use strict";var uZe=dN(),dZe=jxe(),Qxe=Wxe(),pZe=YT(),fZe=Yxe(),mZe={composeNode:Xxe,composeEmptyNode:GJ};function Xxe(t,e,r,n){let{spaceBefore:o,comment:s,anchor:a,tag:c}=r,l,u=!0;switch(e.type){case"alias":l=hZe(t,e,n),(a||c)&&n(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=Qxe.composeScalar(t,e,c,n),a&&(l.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=dZe.composeCollection(mZe,t,e,r,n),a&&(l.anchor=a.source.substring(1));break;default:{let d=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;n(e,"UNEXPECTED_TOKEN",d),l=GJ(t,e.offset,void 0,null,r,n),u=!1}}return a&&l.anchor===""&&n(a,"BAD_ALIAS","Anchor cannot be an empty string"),o&&(l.spaceBefore=!0),s&&(e.type==="scalar"&&e.source===""?l.comment=s:l.commentBefore=s),t.options.keepSourceTokens&&u&&(l.srcToken=e),l}function GJ(t,e,r,n,{spaceBefore:o,comment:s,anchor:a,tag:c,end:l},u){let d={type:"scalar",offset:fZe.emptyScalarPosition(e,r,n),indent:-1,source:""},p=Qxe.composeScalar(t,d,c,u);return a&&(p.anchor=a.source.substring(1),p.anchor===""&&u(a,"BAD_ALIAS","Anchor cannot be an empty string")),o&&(p.spaceBefore=!0),s&&(p.comment=s,p.range[2]=l),p}function hZe({options:t},{offset:e,source:r,end:n},o){let s=new uZe.Alias(r.substring(1));s.source===""&&o(e,"BAD_ALIAS","Alias cannot be an empty string"),s.source.endsWith(":")&&o(e+r.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let a=e+r.length,c=pZe.resolveEnd(n,a,t.strict,o);return s.range=[e,a,c.offset],c.comment&&(s.comment=c.comment),s}zJ.composeEmptyNode=GJ;zJ.composeNode=Xxe});var tSe=R(eSe=>{"use strict";var gZe=TN(),Zxe=Jxe(),vZe=YT(),yZe=RN();function bZe(t,e,{offset:r,start:n,value:o,end:s},a){let c=Object.assign({_directives:e},t),l=new gZe.Document(void 0,c),u={atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},d=yZe.resolveProps(n,{indicator:"doc-start",next:o??s?.[0],offset:r,onError:a,parentIndent:0,startOnNewline:!0});d.found&&(l.directives.docStart=!0,o&&(o.type==="block-map"||o.type==="block-seq")&&!d.hasNewline&&a(d.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=o?Zxe.composeNode(u,o,d,a):Zxe.composeEmptyNode(u,d.end,n,null,d,a);let p=l.contents.range[2],f=vZe.resolveEnd(s,p,!1,a);return f.comment&&(l.comment=f.comment),l.range=[r,p,f.offset],l}eSe.composeDoc=bZe});var WJ=R(iSe=>{"use strict";var _Ze=DX(),xZe=TN(),PN=kN(),rSe=sn(),SZe=tSe(),IZe=YT();function AN(t){if(typeof t=="number")return[t,t+1];if(Array.isArray(t))return t.length===2?t:[t[0],t[1]];let{offset:e,source:r}=t;return[e,e+(typeof r=="string"?r.length:1)]}function nSe(t){let e="",r=!1,n=!1;for(let o=0;o<t.length;++o){let s=t[o];switch(s[0]){case"#":e+=(e===""?"":n?`

`:`
`)+(s.substring(1)||" "),r=!0,n=!1;break;case"%":t[o+1]?.[0]!=="#"&&(o+=1),r=!1;break;default:r||(n=!0),r=!1}}return{comment:e,afterEmptyLine:n}}var $J=class{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(r,n,o,s)=>{let a=AN(r);s?this.warnings.push(new PN.YAMLWarning(a,n,o)):this.errors.push(new PN.YAMLParseError(a,n,o))},this.directives=new _Ze.Directives({version:e.version||"1.2"}),this.options=e}decorate(e,r){let{comment:n,afterEmptyLine:o}=nSe(this.prelude);if(n){let s=e.contents;if(r)e.comment=e.comment?`${e.comment}
${n}`:n;else if(o||e.directives.docStart||!s)e.commentBefore=n;else if(rSe.isCollection(s)&&!s.flow&&s.items.length>0){let a=s.items[0];rSe.isPair(a)&&(a=a.key);let c=a.commentBefore;a.commentBefore=c?`${n}
${c}`:n}else{let a=s.commentBefore;s.commentBefore=a?`${n}
${a}`:n}}r?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:nSe(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,r=!1,n=-1){for(let o of e)yield*this.next(o);yield*this.end(r,n)}*next(e){switch(process.env.LOG_STREAM&&console.dir(e,{depth:null}),e.type){case"directive":this.directives.add(e.source,(r,n,o)=>{let s=AN(e);s[0]+=r,this.onError(s,"BAD_DIRECTIVE",n,o)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{let r=SZe.composeDoc(this.options,this.directives,e,this.onError);this.atDirectives&&!r.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(r,!1),this.doc&&(yield this.doc),this.doc=r,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{let r=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,n=new PN.YAMLParseError(AN(e),"UNEXPECTED_TOKEN",r);this.atDirectives||!this.doc?this.errors.push(n):this.doc.errors.push(n);break}case"doc-end":{if(!this.doc){let n="Unexpected doc-end without preceding document";this.errors.push(new PN.YAMLParseError(AN(e),"UNEXPECTED_TOKEN",n));break}this.doc.directives.docEnd=!0;let r=IZe.resolveEnd(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),r.comment){let n=this.doc.comment;this.doc.comment=n?`${n}
${r.comment}`:r.comment}this.doc.range[2]=r.offset;break}default:this.errors.push(new PN.YAMLParseError(AN(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,r=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){let n=Object.assign({_directives:this.directives},this.options),o=new xZe.Document(void 0,n);this.atDirectives&&this.onError(r,"MISSING_CHAR","Missing directives-end indicator line"),o.range=[0,r,r],this.decorate(o,!1),yield o}}};iSe.Composer=$J});var aSe=R(T9=>{"use strict";var CZe=jJ(),TZe=HJ(),EZe=kN(),oSe=gN();function wZe(t,e=!0,r){if(t){let n=(o,s,a)=>{let c=typeof o=="number"?o:Array.isArray(o)?o[0]:o.offset;if(r)r(c,s,a);else throw new EZe.YAMLParseError([c,c+1],s,a)};switch(t.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return TZe.resolveFlowScalar(t,e,n);case"block-scalar":return CZe.resolveBlockScalar({options:{strict:e}},t,n)}}return null}function kZe(t,e){let{implicitKey:r=!1,indent:n,inFlow:o=!1,offset:s=-1,type:a="PLAIN"}=e,c=oSe.stringifyString({type:a,value:t},{implicitKey:r,indent:n>0?" ".repeat(n):"",inFlow:o,options:{blockQuote:!0,lineWidth:-1}}),l=e.end??[{type:"newline",offset:-1,indent:n,source:`
`}];switch(c[0]){case"|":case">":{let u=c.indexOf(`
`),d=c.substring(0,u),p=c.substring(u+1)+`
`,f=[{type:"block-scalar-header",offset:s,indent:n,source:d}];return sSe(f,l)||f.push({type:"newline",offset:-1,indent:n,source:`
`}),{type:"block-scalar",offset:s,indent:n,props:f,source:p}}case'"':return{type:"double-quoted-scalar",offset:s,indent:n,source:c,end:l};case"'":return{type:"single-quoted-scalar",offset:s,indent:n,source:c,end:l};default:return{type:"scalar",offset:s,indent:n,source:c,end:l}}}function RZe(t,e,r={}){let{afterKey:n=!1,implicitKey:o=!1,inFlow:s=!1,type:a}=r,c="indent"in t?t.indent:null;if(n&&typeof c=="number"&&(c+=2),!a)switch(t.type){case"single-quoted-scalar":a="QUOTE_SINGLE";break;case"double-quoted-scalar":a="QUOTE_DOUBLE";break;case"block-scalar":{let u=t.props[0];if(u.type!=="block-scalar-header")throw new Error("Invalid block scalar header");a=u.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:a="PLAIN"}let l=oSe.stringifyString({type:a,value:e},{implicitKey:o||c===null,indent:c!==null&&c>0?" ".repeat(c):"",inFlow:s,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":PZe(t,l);break;case'"':KJ(t,l,"double-quoted-scalar");break;case"'":KJ(t,l,"single-quoted-scalar");break;default:KJ(t,l,"scalar")}}function PZe(t,e){let r=e.indexOf(`
`),n=e.substring(0,r),o=e.substring(r+1)+`
`;if(t.type==="block-scalar"){let s=t.props[0];if(s.type!=="block-scalar-header")throw new Error("Invalid block scalar header");s.source=n,t.source=o}else{let{offset:s}=t,a="indent"in t?t.indent:-1,c=[{type:"block-scalar-header",offset:s,indent:a,source:n}];sSe(c,"end"in t?t.end:void 0)||c.push({type:"newline",offset:-1,indent:a,source:`
`});for(let l of Object.keys(t))l!=="type"&&l!=="offset"&&delete t[l];Object.assign(t,{type:"block-scalar",indent:a,props:c,source:o})}}function sSe(t,e){if(e)for(let r of e)switch(r.type){case"space":case"comment":t.push(r);break;case"newline":return t.push(r),!0}return!1}function KJ(t,e,r){switch(t.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":t.type=r,t.source=e;break;case"block-scalar":{let n=t.props.slice(1),o=e.length;t.props[0].type==="block-scalar-header"&&(o-=t.props[0].source.length);for(let s of n)s.offset+=o;delete t.props,Object.assign(t,{type:r,source:e,end:n});break}case"block-map":case"block-seq":{let o={type:"newline",offset:t.offset+e.length,indent:t.indent,source:`
`};delete t.items,Object.assign(t,{type:r,source:e,end:[o]});break}default:{let n="indent"in t?t.indent:-1,o="end"in t&&Array.isArray(t.end)?t.end.filter(s=>s.type==="space"||s.type==="comment"||s.type==="newline"):[];for(let s of Object.keys(t))s!=="type"&&s!=="offset"&&delete t[s];Object.assign(t,{type:r,indent:n,source:e,end:o})}}}T9.createScalarToken=kZe;T9.resolveAsScalar=wZe;T9.setScalarValue=RZe});var lSe=R(cSe=>{"use strict";var AZe=t=>"type"in t?w9(t):E9(t);function w9(t){switch(t.type){case"block-scalar":{let e="";for(let r of t.props)e+=w9(r);return e+t.source}case"block-map":case"block-seq":{let e="";for(let r of t.items)e+=E9(r);return e}case"flow-collection":{let e=t.start.source;for(let r of t.items)e+=E9(r);for(let r of t.end)e+=r.source;return e}case"document":{let e=E9(t);if(t.end)for(let r of t.end)e+=r.source;return e}default:{let e=t.source;if("end"in t&&t.end)for(let r of t.end)e+=r.source;return e}}}function E9({start:t,key:e,sep:r,value:n}){let o="";for(let s of t)o+=s.source;if(e&&(o+=w9(e)),r)for(let s of r)o+=s.source;return n&&(o+=w9(n)),o}cSe.stringify=AZe});var fSe=R(pSe=>{"use strict";var YJ=Symbol("break visit"),DZe=Symbol("skip children"),uSe=Symbol("remove item");function fx(t,e){"type"in t&&t.type==="document"&&(t={start:t.start,value:t.value}),dSe(Object.freeze([]),t,e)}fx.BREAK=YJ;fx.SKIP=DZe;fx.REMOVE=uSe;fx.itemAtPath=(t,e)=>{let r=t;for(let[n,o]of e){let s=r?.[n];if(s&&"items"in s)r=s.items[o];else return}return r};fx.parentCollection=(t,e)=>{let r=fx.itemAtPath(t,e.slice(0,-1)),n=e[e.length-1][0],o=r?.[n];if(o&&"items"in o)return o;throw new Error("Parent collection not found")};function dSe(t,e,r){let n=r(e,t);if(typeof n=="symbol")return n;for(let o of["key","value"]){let s=e[o];if(s&&"items"in s){for(let a=0;a<s.items.length;++a){let c=dSe(Object.freeze(t.concat([[o,a]])),s.items[a],r);if(typeof c=="number")a=c-1;else{if(c===YJ)return YJ;c===uSe&&(s.items.splice(a,1),a-=1)}}typeof n=="function"&&o==="key"&&(n=n(e,t))}}return typeof n=="function"?n(e,t):n}pSe.visit=fx});var k9=R(Ic=>{"use strict";var QJ=aSe(),NZe=lSe(),LZe=fSe(),XJ="\uFEFF",JJ="",ZJ="",eZ="",OZe=t=>!!t&&"items"in t,MZe=t=>!!t&&(t.type==="scalar"||t.type==="single-quoted-scalar"||t.type==="double-quoted-scalar"||t.type==="block-scalar");function FZe(t){switch(t){case XJ:return"<BOM>";case JJ:return"<DOC>";case ZJ:return"<FLOW_END>";case eZ:return"<SCALAR>";default:return JSON.stringify(t)}}function UZe(t){switch(t){case XJ:return"byte-order-mark";case JJ:return"doc-mode";case ZJ:return"flow-error-end";case eZ:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}Ic.createScalarToken=QJ.createScalarToken;Ic.resolveAsScalar=QJ.resolveAsScalar;Ic.setScalarValue=QJ.setScalarValue;Ic.stringify=NZe.stringify;Ic.visit=LZe.visit;Ic.BOM=XJ;Ic.DOCUMENT=JJ;Ic.FLOW_END=ZJ;Ic.SCALAR=eZ;Ic.isCollection=OZe;Ic.isScalar=MZe;Ic.prettyToken=FZe;Ic.tokenType=UZe});var nZ=R(hSe=>{"use strict";var DN=k9();function kd(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}var mSe=new Set("0123456789ABCDEFabcdef"),BZe=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),R9=new Set(",[]{}"),qZe=new Set(` ,[]{}
\r	`),tZ=t=>!t||qZe.has(t),rZ=class{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,r=!1){if(e){if(typeof e!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!r;let n=this.next??"stream";for(;n&&(r||this.hasChars(1));)n=yield*this.parseNext(n)}atLineEnd(){let e=this.pos,r=this.buffer[e];for(;r===" "||r==="	";)r=this.buffer[++e];return!r||r==="#"||r===`
`?!0:r==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let r=this.buffer[e];if(this.indentNext>0){let n=0;for(;r===" ";)r=this.buffer[++n+e];if(r==="\r"){let o=this.buffer[n+e+1];if(o===`
`||!o&&!this.atEnd)return e+n+1}return r===`
`||n>=this.indentNext||!r&&!this.atEnd?e+n:-1}if(r==="-"||r==="."){let n=this.buffer.substr(e,3);if((n==="---"||n==="...")&&kd(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===DN.BOM&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let r=e.length,n=e.indexOf("#");for(;n!==-1;){let s=e[n-1];if(s===" "||s==="	"){r=n-1;break}else n=e.indexOf("#",n+1)}for(;;){let s=e[r-1];if(s===" "||s==="	")r-=1;else break}let o=(yield*this.pushCount(r))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-o),this.pushNewline(),"stream"}if(this.atLineEnd()){let r=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-r),yield*this.pushNewline(),"stream"}return yield DN.DOCUMENT,yield*this.parseLineStart()}*parseLineStart(){let e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let r=this.peek(3);if((r==="---"||r==="...")&&kd(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,r==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!kd(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[e,r]=this.peek(2);if(!r&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&kd(r)){let n=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=n,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let e=this.getLine();if(e===null)return this.setNext("doc");let r=yield*this.pushIndicators();switch(e[r]){case"#":yield*this.pushCount(e.length-r);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(tZ),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return r+=yield*this.parseBlockScalarHeader(),r+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-r),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,r,n=-1;do e=yield*this.pushNewline(),e>0?(r=yield*this.pushSpaces(!1),this.indentValue=n=r):r=0,r+=yield*this.pushSpaces(!0);while(e+r>0);let o=this.getLine();if(o===null)return this.setNext("flow");if((n!==-1&&n<this.indentNext&&o[0]!=="#"||n===0&&(o.startsWith("---")||o.startsWith("..."))&&kd(o[3]))&&!(n===this.indentNext-1&&this.flowLevel===1&&(o[0]==="]"||o[0]==="}")))return this.flowLevel=0,yield DN.FLOW_END,yield*this.parseLineStart();let s=0;for(;o[s]===",";)s+=yield*this.pushCount(1),s+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(s+=yield*this.pushIndicators(),o[s]){case void 0:return"flow";case"#":return yield*this.pushCount(o.length-s),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(tZ),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let a=this.charAt(1);if(this.flowKey||kd(a)||a===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let e=this.charAt(0),r=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;r!==-1&&this.buffer[r+1]==="'";)r=this.buffer.indexOf("'",r+2);else for(;r!==-1;){let s=0;for(;this.buffer[r-1-s]==="\\";)s+=1;if(s%2===0)break;r=this.buffer.indexOf('"',r+1)}let n=this.buffer.substring(0,r),o=n.indexOf(`
`,this.pos);if(o!==-1){for(;o!==-1;){let s=this.continueScalar(o+1);if(s===-1)break;o=n.indexOf(`
`,s)}o!==-1&&(r=o-(n[o-1]==="\r"?2:1))}if(r===-1){if(!this.atEnd)return this.setNext("quoted-scalar");r=this.buffer.length}return yield*this.pushToIndex(r+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){let r=this.buffer[++e];if(r==="+")this.blockScalarKeep=!0;else if(r>"0"&&r<="9")this.blockScalarIndent=Number(r)-1;else if(r!=="-")break}return yield*this.pushUntil(r=>kd(r)||r==="#")}*parseBlockScalar(){let e=this.pos-1,r=0,n;e:for(let s=this.pos;n=this.buffer[s];++s)switch(n){case" ":r+=1;break;case`
`:e=s,r=0;break;case"\r":{let a=this.buffer[s+1];if(!a&&!this.atEnd)return this.setNext("block-scalar");if(a===`
`)break}default:break e}if(!n&&!this.atEnd)return this.setNext("block-scalar");if(r>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=r:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{let s=this.continueScalar(e+1);if(s===-1)break;e=this.buffer.indexOf(`
`,s)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}let o=e+1;for(n=this.buffer[o];n===" ";)n=this.buffer[++o];if(n==="	"){for(;n==="	"||n===" "||n==="\r"||n===`
`;)n=this.buffer[++o];e=o-1}else if(!this.blockScalarKeep)do{let s=e-1,a=this.buffer[s];a==="\r"&&(a=this.buffer[--s]);let c=s;for(;a===" ";)a=this.buffer[--s];if(a===`
`&&s>=this.pos&&s+1+r>c)e=s;else break}while(!0);return yield DN.SCALAR,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let e=this.flowLevel>0,r=this.pos-1,n=this.pos-1,o;for(;o=this.buffer[++n];)if(o===":"){let s=this.buffer[n+1];if(kd(s)||e&&R9.has(s))break;r=n}else if(kd(o)){let s=this.buffer[n+1];if(o==="\r"&&(s===`
`?(n+=1,o=`
`,s=this.buffer[n+1]):r=n),s==="#"||e&&R9.has(s))break;if(o===`
`){let a=this.continueScalar(n+1);if(a===-1)break;n=Math.max(n,a-2)}}else{if(e&&R9.has(o))break;r=n}return!o&&!this.atEnd?this.setNext("plain-scalar"):(yield DN.SCALAR,yield*this.pushToIndex(r+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,r){let n=this.buffer.slice(this.pos,e);return n?(yield n,this.pos+=n.length,n.length):(r&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(tZ))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let e=this.flowLevel>0,r=this.charAt(1);if(kd(r)||e&&R9.has(r))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,r=this.buffer[e];for(;!kd(r)&&r!==">";)r=this.buffer[++e];return yield*this.pushToIndex(r===">"?e+1:e,!1)}else{let e=this.pos+1,r=this.buffer[e];for(;r;)if(BZe.has(r))r=this.buffer[++e];else if(r==="%"&&mSe.has(this.buffer[e+1])&&mSe.has(this.buffer[e+2]))r=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){let e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let r=this.pos-1,n;do n=this.buffer[++r];while(n===" "||e&&n==="	");let o=r-this.pos;return o>0&&(yield this.buffer.substr(this.pos,o),this.pos=r),o}*pushUntil(e){let r=this.pos,n=this.buffer[r];for(;!e(n);)n=this.buffer[++r];return yield*this.pushToIndex(r,!1)}};hSe.Lexer=rZ});var oZ=R(gSe=>{"use strict";var iZ=class{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let r=0,n=this.lineStarts.length;for(;r<n;){let s=r+n>>1;this.lineStarts[s]<e?r=s+1:n=s}if(this.lineStarts[r]===e)return{line:r+1,col:1};if(r===0)return{line:0,col:e};let o=this.lineStarts[r-1];return{line:r,col:e-o+1}}}};gSe.LineCounter=iZ});var aZ=R(xSe=>{"use strict";var vSe=k9(),jZe=nZ();function mx(t,e){for(let r=0;r<t.length;++r)if(t[r].type===e)return!0;return!1}function ySe(t){for(let e=0;e<t.length;++e)switch(t[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function _Se(t){switch(t?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function P9(t){switch(t.type){case"document":return t.start;case"block-map":{let e=t.items[t.items.length-1];return e.sep??e.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function XT(t){if(t.length===0)return[];let e=t.length;e:for(;--e>=0;)switch(t[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;t[++e]?.type==="space";);return t.splice(e,t.length)}function bSe(t){if(t.start.type==="flow-seq-start")for(let e of t.items)e.sep&&!e.value&&!mx(e.start,"explicit-key-ind")&&!mx(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,_Se(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}var sZ=class{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new jZe.Lexer,this.onNewLine=e}*parse(e,r=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(let n of this.lexer.lex(e,r))yield*this.next(n);r||(yield*this.end())}*next(e){if(this.source=e,process.env.LOG_TOKENS&&console.log("|",vSe.prettyToken(e)),this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}let r=vSe.tokenType(e);if(r)if(r==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=r,yield*this.step(),r){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{let n=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){let r=e??this.stack.pop();if(!r)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield r;else{let n=this.peek(1);switch(r.type==="block-scalar"?r.indent="indent"in n?n.indent:0:r.type==="flow-collection"&&n.type==="document"&&(r.indent=0),r.type==="flow-collection"&&bSe(r),n.type){case"document":n.value=r;break;case"block-scalar":n.props.push(r);break;case"block-map":{let o=n.items[n.items.length-1];if(o.value){n.items.push({start:[],key:r,sep:[]}),this.onKeyLine=!0;return}else if(o.sep)o.value=r;else{Object.assign(o,{key:r,sep:[]}),this.onKeyLine=!o.explicitKey;return}break}case"block-seq":{let o=n.items[n.items.length-1];o.value?n.items.push({start:[],value:r}):o.value=r;break}case"flow-collection":{let o=n.items[n.items.length-1];!o||o.value?n.items.push({start:[],key:r,sep:[]}):o.sep?o.value=r:Object.assign(o,{key:r,sep:[]});return}default:yield*this.pop(),yield*this.pop(r)}if((n.type==="document"||n.type==="block-map"||n.type==="block-seq")&&(r.type==="block-map"||r.type==="block-seq")){let o=r.items[r.items.length-1];o&&!o.sep&&!o.value&&o.start.length>0&&ySe(o.start)===-1&&(r.indent===0||o.start.every(s=>s.type!=="comment"||s.indent<r.indent))&&(n.type==="document"?n.end=o.start:n.items.push({start:o.start}),r.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{ySe(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}let r=this.startBlockValue(e);r?this.stack.push(r):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){let r=P9(this.peek(2)),n=XT(r),o;e.end?(o=e.end,o.push(this.sourceToken),delete e.end):o=[this.sourceToken];let s={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:n,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=s}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let r=this.source.indexOf(`
`)+1;for(;r!==0;)this.onNewLine(this.offset+r),r=this.source.indexOf(`
`,r)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){let r=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,r.value){let n="end"in r.value?r.value.end:void 0;(Array.isArray(n)?n[n.length-1]:void 0)?.type==="comment"?n?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken);return;case"space":case"comment":if(r.value)e.items.push({start:[this.sourceToken]});else if(r.sep)r.sep.push(this.sourceToken);else{if(this.atIndentedComment(r.start,e.indent)){let o=e.items[e.items.length-2]?.value?.end;if(Array.isArray(o)){Array.prototype.push.apply(o,r.start),o.push(this.sourceToken),e.items.pop();return}}r.start.push(this.sourceToken)}return}if(this.indent>=e.indent){let n=!this.onKeyLine&&this.indent===e.indent,o=n&&(r.sep||r.explicitKey)&&this.type!=="seq-item-ind",s=[];if(o&&r.sep&&!r.value){let a=[];for(let c=0;c<r.sep.length;++c){let l=r.sep[c];switch(l.type){case"newline":a.push(c);break;case"space":break;case"comment":l.indent>e.indent&&(a.length=0);break;default:a.length=0}}a.length>=2&&(s=r.sep.splice(a[1]))}switch(this.type){case"anchor":case"tag":o||r.value?(s.push(this.sourceToken),e.items.push({start:s}),this.onKeyLine=!0):r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken);return;case"explicit-key-ind":!r.sep&&!r.explicitKey?(r.start.push(this.sourceToken),r.explicitKey=!0):o||r.value?(s.push(this.sourceToken),e.items.push({start:s,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(r.explicitKey)if(r.sep)if(r.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(mx(r.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(_Se(r.key)&&!mx(r.sep,"newline")){let a=XT(r.start),c=r.key,l=r.sep;l.push(this.sourceToken),delete r.key,delete r.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:c,sep:l}]})}else s.length>0?r.sep=r.sep.concat(s,this.sourceToken):r.sep.push(this.sourceToken);else if(mx(r.start,"newline"))Object.assign(r,{key:null,sep:[this.sourceToken]});else{let a=XT(r.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]})}else r.sep?r.value||o?e.items.push({start:s,key:null,sep:[this.sourceToken]}):mx(r.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):r.sep.push(this.sourceToken):Object.assign(r,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let a=this.flowScalar(this.type);o||r.value?(e.items.push({start:s,key:a,sep:[]}),this.onKeyLine=!0):r.sep?this.stack.push(a):(Object.assign(r,{key:a,sep:[]}),this.onKeyLine=!0);return}default:{let a=this.startBlockValue(e);if(a){n&&a.type!=="block-seq"&&e.items.push({start:s}),this.stack.push(a);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){let r=e.items[e.items.length-1];switch(this.type){case"newline":if(r.value){let n="end"in r.value?r.value.end:void 0;(Array.isArray(n)?n[n.length-1]:void 0)?.type==="comment"?n?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else r.start.push(this.sourceToken);return;case"space":case"comment":if(r.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(r.start,e.indent)){let o=e.items[e.items.length-2]?.value?.end;if(Array.isArray(o)){Array.prototype.push.apply(o,r.start),o.push(this.sourceToken),e.items.pop();return}}r.start.push(this.sourceToken)}return;case"anchor":case"tag":if(r.value||this.indent<=e.indent)break;r.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;r.value||mx(r.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):r.start.push(this.sourceToken);return}if(this.indent>e.indent){let n=this.startBlockValue(e);if(n){this.stack.push(n);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){let r=e.items[e.items.length-1];if(this.type==="flow-error-end"){let n;do yield*this.pop(),n=this.peek(1);while(n&&n.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!r||r.sep?e.items.push({start:[this.sourceToken]}):r.start.push(this.sourceToken);return;case"map-value-ind":!r||r.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):r.sep?r.sep.push(this.sourceToken):Object.assign(r,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!r||r.value?e.items.push({start:[this.sourceToken]}):r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let o=this.flowScalar(this.type);!r||r.value?e.items.push({start:[],key:o,sep:[]}):r.sep?this.stack.push(o):Object.assign(r,{key:o,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}let n=this.startBlockValue(e);n?this.stack.push(n):(yield*this.pop(),yield*this.step())}else{let n=this.peek(2);if(n.type==="block-map"&&(this.type==="map-value-ind"&&n.indent===e.indent||this.type==="newline"&&!n.items[n.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&n.type!=="flow-collection"){let o=P9(n),s=XT(o);bSe(e);let a=e.end.splice(1,e.end.length);a.push(this.sourceToken);let c={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:a}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=c}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let r=this.source.indexOf(`
`)+1;for(;r!==0;)this.onNewLine(this.offset+r),r=this.source.indexOf(`
`,r)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let r=P9(e),n=XT(r);return n.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;let r=P9(e),n=XT(r);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,r){return this.type!=="comment"||this.indent<=r?!1:e.every(n=>n.type==="newline"||n.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}};xSe.Parser=sZ});var ESe=R(LN=>{"use strict";var SSe=WJ(),VZe=TN(),NN=kN(),HZe=zX(),GZe=oZ(),ISe=aZ();function CSe(t){let e=t.prettyErrors!==!1;return{lineCounter:t.lineCounter||e&&new GZe.LineCounter||null,prettyErrors:e}}function zZe(t,e={}){let{lineCounter:r,prettyErrors:n}=CSe(e),o=new ISe.Parser(r?.addNewLine),s=new SSe.Composer(e),a=Array.from(s.compose(o.parse(t)));if(n&&r)for(let c of a)c.errors.forEach(NN.prettifyError(t,r)),c.warnings.forEach(NN.prettifyError(t,r));return a.length>0?a:Object.assign([],{empty:!0},s.streamInfo())}function TSe(t,e={}){let{lineCounter:r,prettyErrors:n}=CSe(e),o=new ISe.Parser(r?.addNewLine),s=new SSe.Composer(e),a=null;for(let c of s.compose(o.parse(t),!0,t.length))if(!a)a=c;else if(a.options.logLevel!=="silent"){a.errors.push(new NN.YAMLParseError(c.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return n&&r&&(a.errors.forEach(NN.prettifyError(t,r)),a.warnings.forEach(NN.prettifyError(t,r))),a}function $Ze(t,e,r){let n;typeof e=="function"?n=e:r===void 0&&e&&typeof e=="object"&&(r=e);let o=TSe(t,r);if(!o)return null;if(o.warnings.forEach(s=>HZe.warn(o.options.logLevel,s)),o.errors.length>0){if(o.options.logLevel!=="silent")throw o.errors[0];o.errors=[]}return o.toJS(Object.assign({reviver:n},r))}function WZe(t,e,r){let n=null;if(typeof e=="function"||Array.isArray(e)?n=e:r===void 0&&e&&(r=e),typeof r=="string"&&(r=r.length),typeof r=="number"){let o=Math.round(r);r=o<1?void 0:o>8?{indent:8}:{indent:o}}if(t===void 0){let{keepUndefined:o}=r??e??{};if(!o)return}return new VZe.Document(t,n,r).toString(r)}LN.parse=$Ze;LN.parseAllDocuments=zZe;LN.parseDocument=TSe;LN.stringify=WZe});var kSe=R(gn=>{"use strict";var KZe=WJ(),YZe=TN(),QZe=wJ(),cZ=kN(),XZe=dN(),U0=sn(),JZe=L0(),ZZe=To(),eet=M0(),tet=F0(),ret=k9(),net=nZ(),iet=oZ(),oet=aZ(),A9=ESe(),wSe=aN();gn.Composer=KZe.Composer;gn.Document=YZe.Document;gn.Schema=QZe.Schema;gn.YAMLError=cZ.YAMLError;gn.YAMLParseError=cZ.YAMLParseError;gn.YAMLWarning=cZ.YAMLWarning;gn.Alias=XZe.Alias;gn.isAlias=U0.isAlias;gn.isCollection=U0.isCollection;gn.isDocument=U0.isDocument;gn.isMap=U0.isMap;gn.isNode=U0.isNode;gn.isPair=U0.isPair;gn.isScalar=U0.isScalar;gn.isSeq=U0.isSeq;gn.Pair=JZe.Pair;gn.Scalar=ZZe.Scalar;gn.YAMLMap=eet.YAMLMap;gn.YAMLSeq=tet.YAMLSeq;gn.CST=ret;gn.Lexer=net.Lexer;gn.LineCounter=iet.LineCounter;gn.Parser=oet.Parser;gn.parse=A9.parse;gn.parseAllDocuments=A9.parseAllDocuments;gn.parseDocument=A9.parseDocument;gn.stringify=A9.stringify;gn.visit=wSe.visit;gn.visitAsync=wSe.visitAsync});var BSe=R((kSr,USe)=>{var cE=1e3,lE=cE*60,uE=lE*60,yx=uE*24,_et=yx*7,xet=yx*365.25;USe.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Iet(t);if(r==="number"&&isFinite(t))return e.long?Tet(t):Cet(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Iet(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*xet;case"weeks":case"week":case"w":return r*_et;case"days":case"day":case"d":return r*yx;case"hours":case"hour":case"hrs":case"hr":case"h":return r*uE;case"minutes":case"minute":case"mins":case"min":case"m":return r*lE;case"seconds":case"second":case"secs":case"sec":case"s":return r*cE;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Cet(t){var e=Math.abs(t);return e>=yx?Math.round(t/yx)+"d":e>=uE?Math.round(t/uE)+"h":e>=lE?Math.round(t/lE)+"m":e>=cE?Math.round(t/cE)+"s":t+"ms"}function Tet(t){var e=Math.abs(t);return e>=yx?z9(t,e,yx,"day"):e>=uE?z9(t,e,uE,"hour"):e>=lE?z9(t,e,lE,"minute"):e>=cE?z9(t,e,cE,"second"):t+" ms"}function z9(t,e,r,n){var o=e>=r*1.5;return Math.round(t/r)+" "+n+(o?"s":"")}});var _Z=R((RSr,qSe)=>{function Eet(t){r.debug=r,r.default=r,r.coerce=l,r.disable=s,r.enable=o,r.enabled=a,r.humanize=BSe(),r.destroy=u,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function e(d){let p=0;for(let f=0;f<d.length;f++)p=(p<<5)-p+d.charCodeAt(f),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=e;function r(d){let p,f=null,m,h;function g(...v){if(!g.enabled)return;let b=g,_=Number(new Date),x=_-(p||_);b.diff=x,b.prev=p,b.curr=_,p=_,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let S=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(w,k)=>{if(w==="%%")return"%";S++;let M=r.formatters[k];if(typeof M=="function"){let H=v[S];w=M.call(b,H),v.splice(S,1),S--}return w}),r.formatArgs.call(b,v),(b.log||r.log).apply(b,v)}return g.namespace=d,g.useColors=r.useColors(),g.color=r.selectColor(d),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(m!==r.namespaces&&(m=r.namespaces,h=r.enabled(d)),h),set:v=>{f=v}}),typeof r.init=="function"&&r.init(g),g}function n(d,p){let f=r(this.namespace+(typeof p>"u"?":":p)+d);return f.log=this.log,f}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p,f=(typeof d=="string"?d:"").split(/[\s,]+/),m=f.length;for(p=0;p<m;p++)f[p]&&(d=f[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function s(){let d=[...r.names.map(c),...r.skips.map(c).map(p=>"-"+p)].join(",");return r.enable(""),d}function a(d){if(d[d.length-1]==="*")return!0;let p,f;for(p=0,f=r.skips.length;p<f;p++)if(r.skips[p].test(d))return!1;for(p=0,f=r.names.length;p<f;p++)if(r.names[p].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}qSe.exports=Eet});var jSe=R((gl,$9)=>{gl.formatArgs=ket;gl.save=Ret;gl.load=Pet;gl.useColors=wet;gl.storage=Aet();gl.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();gl.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function wet(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function ket(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+$9.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),t.splice(n,0,e)}gl.log=console.debug||console.log||(()=>{});function Ret(t){try{t?gl.storage.setItem("debug",t):gl.storage.removeItem("debug")}catch{}}function Pet(){let t;try{t=gl.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Aet(){try{return localStorage}catch{}}$9.exports=_Z()(gl);var{formatters:Det}=$9.exports;Det.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var HSe=R((PSr,VSe)=>{"use strict";VSe.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",n=e.indexOf(r+t),o=e.indexOf("--");return n!==-1&&(o===-1||n<o)}});var $Se=R((ASr,zSe)=>{"use strict";var Net=require("os"),GSe=require("tty"),iu=HSe(),{env:bs}=process,V0;iu("no-color")||iu("no-colors")||iu("color=false")||iu("color=never")?V0=0:(iu("color")||iu("colors")||iu("color=true")||iu("color=always"))&&(V0=1);"FORCE_COLOR"in bs&&(bs.FORCE_COLOR==="true"?V0=1:bs.FORCE_COLOR==="false"?V0=0:V0=bs.FORCE_COLOR.length===0?1:Math.min(parseInt(bs.FORCE_COLOR,10),3));function xZ(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function SZ(t,e){if(V0===0)return 0;if(iu("color=16m")||iu("color=full")||iu("color=truecolor"))return 3;if(iu("color=256"))return 2;if(t&&!e&&V0===void 0)return 0;let r=V0||0;if(bs.TERM==="dumb")return r;if(process.platform==="win32"){let n=Net.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in bs)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in bs)||bs.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in bs)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(bs.TEAMCITY_VERSION)?1:0;if(bs.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in bs){let n=parseInt((bs.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(bs.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(bs.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(bs.TERM)||"COLORTERM"in bs?1:r}function Let(t){let e=SZ(t,t&&t.isTTY);return xZ(e)}zSe.exports={supportsColor:Let,stdout:xZ(SZ(!0,GSe.isatty(1))),stderr:xZ(SZ(!0,GSe.isatty(2)))}});var KSe=R((qs,K9)=>{var Oet=require("tty"),W9=require("util");qs.init=Vet;qs.log=Bet;qs.formatArgs=Fet;qs.save=qet;qs.load=jet;qs.useColors=Met;qs.destroy=W9.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");qs.colors=[6,2,3,4,5,1];try{let t=$Se();t&&(t.stderr||t).level>=2&&(qs.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}qs.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(o,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),t[r]=n,t},{});function Met(){return"colors"in qs.inspectOpts?!!qs.inspectOpts.colors:Oet.isatty(process.stderr.fd)}function Fet(t){let{namespace:e,useColors:r}=this;if(r){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${o};1m${e} \x1B[0m`;t[0]=s+t[0].split(`
`).join(`
`+s),t.push(o+"m+"+K9.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=Uet()+e+" "+t[0]}function Uet(){return qs.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Bet(...t){return process.stderr.write(W9.format(...t)+`
`)}function qet(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function jet(){return process.env.DEBUG}function Vet(t){t.inspectOpts={};let e=Object.keys(qs.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=qs.inspectOpts[e[r]]}K9.exports=_Z()(qs);var{formatters:WSe}=K9.exports;WSe.o=function(t){return this.inspectOpts.colors=this.useColors,W9.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};WSe.O=function(t){return this.inspectOpts.colors=this.useColors,W9.inspect(t,this.inspectOpts)}});var Pd=R((DSr,IZ)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?IZ.exports=jSe():IZ.exports=KSe()});var RZ=R((OSr,JSe)=>{var HN=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Het=typeof AbortController=="function",Y9=Het?AbortController:class{constructor(){this.signal=new YSe}abort(){this.signal.dispatchEvent("abort")}},Get=typeof AbortSignal=="function",zet=typeof Y9.AbortSignal=="function",YSe=Get?AbortSignal:zet?Y9.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if(e==="abort"){this.aborted=!0;let r={type:e,target:this};this.onabort(r),this._listeners.forEach(n=>n(r),this)}}onabort(){}addEventListener(e,r){e==="abort"&&this._listeners.push(r)}removeEventListener(e,r){e==="abort"&&(this._listeners=this._listeners.filter(n=>n!==r))}},wZ=new Set,CZ=(t,e)=>{let r=`LRU_CACHE_OPTION_${t}`;Q9(r)&&kZ(r,`${t} option`,`options.${e}`,pE)},TZ=(t,e)=>{let r=`LRU_CACHE_METHOD_${t}`;if(Q9(r)){let{prototype:n}=pE,{get:o}=Object.getOwnPropertyDescriptor(n,t);kZ(r,`${t} method`,`cache.${e}()`,o)}},$et=(t,e)=>{let r=`LRU_CACHE_PROPERTY_${t}`;if(Q9(r)){let{prototype:n}=pE,{get:o}=Object.getOwnPropertyDescriptor(n,t);kZ(r,`${t} property`,`cache.${e}`,o)}},QSe=(...t)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...t):console.error(...t)},Q9=t=>!wZ.has(t),kZ=(t,e,r,n)=>{wZ.add(t);let o=`The ${e} is deprecated. Please use ${r} instead.`;QSe(o,"DeprecationWarning",t,n)},bx=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),XSe=t=>bx(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?dE:null:null,dE=class extends Array{constructor(e){super(e),this.fill(0)}},EZ=class{constructor(e){if(e===0)return[];let r=XSe(e);this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},pE=class t{constructor(e={}){let{max:r=0,ttl:n,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:l,dispose:u,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,sizeCalculation:h,fetchMethod:g,fetchContext:v,noDeleteOnFetchRejection:b,noDeleteOnStaleGet:_}=e,{length:x,maxAge:S,stale:I}=e instanceof t?{}:e;if(r!==0&&!bx(r))throw new TypeError("max option must be a nonnegative integer");let w=r?XSe(r):Array;if(!w)throw new Error("invalid max value: "+r);if(this.max=r,this.maxSize=m,this.sizeCalculation=h||x,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=g||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=v,!this.fetchMethod&&v!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(r).fill(null),this.valList=new Array(r).fill(null),this.next=new w(r),this.prev=new w(r),this.head=0,this.tail=0,this.free=new EZ(r),this.initialFill=1,this.size=0,typeof u=="function"&&(this.dispose=u),typeof d=="function"?(this.disposeAfter=d,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!b,this.maxSize!==0){if(!bx(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!l||!!I,this.noDeleteOnStaleGet=!!_,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=bx(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=n||S||0,this.ttl){if(!bx(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let k="LRU_CACHE_UNBOUNDED";Q9(k)&&(wZ.add(k),QSe("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",k,t))}I&&CZ("stale","allowStale"),S&&CZ("maxAge","ttl"),x&&CZ("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new dE(this.max),this.starts=new dE(this.max),this.setItemTTL=(n,o,s=HN.now())=>{if(this.starts[n]=o!==0?s:0,this.ttls[n]=o,o!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.isStale(n)&&this.delete(this.keyList[n])},o+1);a.unref&&a.unref()}},this.updateItemAge=n=>{this.starts[n]=this.ttls[n]!==0?HN.now():0};let e=0,r=()=>{let n=HN.now();if(this.ttlResolution>0){e=n;let o=setTimeout(()=>e=0,this.ttlResolution);o.unref&&o.unref()}return n};this.getRemainingTTL=n=>{let o=this.keyMap.get(n);return o===void 0?0:this.ttls[o]===0||this.starts[o]===0?1/0:this.starts[o]+this.ttls[o]-(e||r())},this.isStale=n=>this.ttls[n]!==0&&this.starts[n]!==0&&(e||r())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,r,n){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new dE(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,r,n,o)=>{if(!bx(n))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(n=o(r,e),!bx(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer)");return n},this.addItemSize=(e,r)=>{this.sizes[e]=r;let n=this.maxSize-this.sizes[e];for(;this.calculatedSize>n;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,r){}requireSize(e,r,n,o){if(n||o)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.tail;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.head));)r=this.prev[r]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.head;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.tail));)r=this.next[r]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(let e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(let e of this.indexes())yield this.keyList[e]}*rkeys(){for(let e of this.rindexes())yield this.keyList[e]}*values(){for(let e of this.indexes())yield this.valList[e]}*rvalues(){for(let e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,r={}){for(let n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],r)}forEach(e,r=this){for(let n of this.indexes())e.call(r,this.valList[n],this.keyList[n],this)}rforEach(e,r=this){for(let n of this.rindexes())e.call(r,this.valList[n],this.keyList[n],this)}get prune(){return TZ("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let r of this.rindexes({allowStale:!0}))this.isStale(r)&&(this.delete(this.keyList[r]),e=!0);return e}dump(){let e=[];for(let r of this.indexes({allowStale:!0})){let n=this.keyList[r],o=this.valList[r],a={value:this.isBackgroundFetch(o)?o.__staleWhileFetching:o};if(this.ttls){a.ttl=this.ttls[r];let c=HN.now()-this.starts[r];a.start=Math.floor(Date.now()-c)}this.sizes&&(a.size=this.sizes[r]),e.unshift([n,a])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let o=Date.now()-n.start;n.start=HN.now()-o}this.set(r,n.value,n)}}dispose(e,r,n){}set(e,r,{ttl:n=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,size:a=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL}={}){if(a=this.requireSize(e,r,a,c),this.maxSize&&a>this.maxSize)return this;let u=this.size===0?void 0:this.keyMap.get(e);if(u===void 0)u=this.newIndex(),this.keyList[u]=e,this.valList[u]=r,this.keyMap.set(e,u),this.next[this.tail]=u,this.prev[u]=this.tail,this.tail=u,this.size++,this.addItemSize(u,a),l=!1;else{let d=this.valList[u];r!==d&&(this.isBackgroundFetch(d)?d.__abortController.abort():s||(this.dispose(d,e,"set"),this.disposeAfter&&this.disposed.push([d,e,"set"])),this.removeItemSize(u),this.valList[u]=r,this.addItemSize(u,a)),this.moveToTail(u)}if(n!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),l||this.setItemTTL(u,n,o),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let r=this.head,n=this.keyList[r],o=this.valList[r];return this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,n,"evict"),this.disposeAfter&&this.disposed.push([o,n,"evict"])),this.removeItemSize(r),e&&(this.keyList[r]=null,this.valList[r]=null,this.free.push(r)),this.head=this.next[r],this.keyMap.delete(n),this.size--,r}has(e,{updateAgeOnHas:r=this.updateAgeOnHas}={}){let n=this.keyMap.get(e);return n!==void 0&&!this.isStale(n)?(r&&this.updateItemAge(n),!0):!1}peek(e,{allowStale:r=this.allowStale}={}){let n=this.keyMap.get(e);if(n!==void 0&&(r||!this.isStale(n))){let o=this.valList[n];return this.isBackgroundFetch(o)?o.__staleWhileFetching:o}}backgroundFetch(e,r,n,o){let s=r===void 0?void 0:this.valList[r];if(this.isBackgroundFetch(s))return s;let a=new Y9,c={signal:a.signal,options:n,context:o},l=f=>(a.signal.aborted||this.set(e,f,c.options),f),u=f=>{if(this.valList[r]===p&&(!n.noDeleteOnFetchRejection||p.__staleWhileFetching===void 0?this.delete(e):this.valList[r]=p.__staleWhileFetching),p.__returned===p)throw f},d=f=>f(this.fetchMethod(e,s,c)),p=new Promise(d).then(l,u);return p.__abortController=a,p.__staleWhileFetching=s,p.__returned=null,r===void 0?(this.set(e,p,c.options),r=this.keyMap.get(e)):this.valList[r]=p,p}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,fetchContext:p=this.fetchContext,forceRefresh:f=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:o});let m={allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d},h=this.keyMap.get(e);if(h===void 0){let g=this.backgroundFetch(e,h,m,p);return g.__returned=g}else{let g=this.valList[h];if(this.isBackgroundFetch(g))return r&&g.__staleWhileFetching!==void 0?g.__staleWhileFetching:g.__returned=g;if(!f&&!this.isStale(h))return this.moveToTail(h),n&&this.updateItemAge(h),g;let v=this.backgroundFetch(e,h,m,p);return r&&v.__staleWhileFetching!==void 0?v.__staleWhileFetching:v.__returned=v}}get(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet}={}){let s=this.keyMap.get(e);if(s!==void 0){let a=this.valList[s],c=this.isBackgroundFetch(a);return this.isStale(s)?c?r?a.__staleWhileFetching:void 0:(o||this.delete(e),r?a:void 0):c?void 0:(this.moveToTail(s),n&&this.updateItemAge(s),a)}}connect(e,r){this.prev[r]=e,this.next[e]=r}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return TZ("del","delete"),this.delete}delete(e){let r=!1;if(this.size!==0){let n=this.keyMap.get(e);if(n!==void 0)if(r=!0,this.size===1)this.clear();else{this.removeItemSize(n);let o=this.valList[n];this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,e,"delete"),this.disposeAfter&&this.disposed.push([o,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return r}clear(){for(let e of this.rindexes({allowStale:!0})){let r=this.valList[e];if(this.isBackgroundFetch(r))r.__abortController.abort();else{let n=this.keyList[e];this.dispose(r,n,"delete"),this.disposeAfter&&this.disposed.push([r,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return TZ("reset","clear"),this.clear}get length(){return $et("length","size"),this.size}static get AbortController(){return Y9}static get AbortSignal(){return YSe}};JSe.exports=pE});var DZ=R((MSr,ZSe)=>{"use strict";var GN=class extends Error{constructor(e,r,n){super(e),this.type=r,this._name=n}get name(){return this._name}get[Symbol.toStringTag](){return this._name}},PZ=class extends GN{constructor(e,r,n){super(e,r,"FetchError"),n&&(this.code=n.code,this.errno=n.errno,this.erroredSysCall=n.syscall)}},AZ=class extends GN{constructor(e,r="aborted"){super(e,r,"AbortError")}};ZSe.exports={FetchBaseError:GN,FetchError:PZ,AbortError:AZ}});var gh=R((FSr,t1e)=>{"use strict";var{constants:{MAX_LENGTH:Wet}}=require("buffer"),{pipeline:X9,PassThrough:Ket}=require("stream"),{promisify:Yet}=require("util"),{createGunzip:Qet,createInflate:Xet,createBrotliDecompress:Jet,constants:{Z_SYNC_FLUSH:e1e}}=require("zlib"),Zet=Pd()("helix-fetch:utils"),ett=Yet(X9),ttt=(t,e)=>t===204||t===304||+e["content-length"]==0?!1:/^\s*(?:(x-)?deflate|(x-)?gzip|br)\s*$/.test(e["content-encoding"]),rtt=(t,e,r,n)=>{if(!ttt(t,e))return r;let o=s=>{s&&(Zet(`encountered error while decoding stream: ${s}`),n(s))};switch(e["content-encoding"].trim()){case"gzip":case"x-gzip":return X9(r,Qet({flush:e1e,finishFlush:e1e}),o);case"deflate":case"x-deflate":return X9(r,Xet(),o);case"br":return X9(r,Jet(),o);default:return r}},ntt=t=>{if(!t||typeof t!="object"||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},J9=(t,e)=>{if(Buffer.isBuffer(t))return t.length;switch(typeof t){case"string":return t.length*2;case"boolean":return 4;case"number":return 8;case"symbol":return Symbol.keyFor(t)?Symbol.keyFor(t).length*2:(t.toString().length-8)*2;case"object":return Array.isArray(t)?itt(t,e):ott(t,e);default:return 0}},itt=(t,e)=>(e.add(t),t.map(r=>e.has(r)?0:J9(r,e)).reduce((r,n)=>r+n,0)),ott=(t,e)=>{if(t==null)return 0;e.add(t);let r=0,n=[];for(let o in t)n.push(o);return n.push(...Object.getOwnPropertySymbols(t)),n.forEach(o=>{if(r+=J9(o,e),typeof t[o]=="object"&&t[o]!==null){if(e.has(t[o]))return;e.add(t[o])}r+=J9(t[o],e)}),r},stt=t=>J9(t,new WeakSet),att=async t=>{let e=new Ket,r=0,n=[];return e.on("data",o=>{if(r+o.length>Wet)throw new Error("Buffer.constants.MAX_SIZE exceeded");n.push(o),r+=o.length}),await ett(t,e),Buffer.concat(n,r)};t1e.exports={decodeStream:rtt,isPlainObject:ntt,sizeof:stt,streamToBuffer:att}});var e7=R((USr,o1e)=>{"use strict";var{PassThrough:r1e,Readable:vh}=require("stream"),{types:{isAnyArrayBuffer:i1e}}=require("util"),{FetchError:ctt,FetchBaseError:ltt}=DZ(),{streamToBuffer:utt}=gh(),dtt=Buffer.alloc(0),ou=Symbol("Body internals"),ptt=t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),n1e=async t=>{if(t[ou].disturbed)throw new TypeError("Already read");if(t[ou].error)throw new TypeError(`Stream had error: ${t[ou].error.message}`);t[ou].disturbed=!0;let{stream:e}=t[ou];return e===null?dtt:utt(e)},Z9=class{constructor(e){let r;e==null?r=null:e instanceof URLSearchParams?r=vh.from(e.toString()):e instanceof vh?r=e:Buffer.isBuffer(e)?r=vh.from(e):i1e(e)?r=vh.from(Buffer.from(e)):typeof e=="string"||e instanceof String?r=vh.from(e):r=vh.from(String(e)),this[ou]={stream:r,disturbed:!1,error:null},e instanceof vh&&r.on("error",n=>{let o=n instanceof ltt?n:new ctt(`Invalid response body while trying to fetch ${this.url}: ${n.message}`,"system",n);this[ou].error=o})}get body(){return this[ou].stream}get bodyUsed(){return this[ou].disturbed}async buffer(){return n1e(this)}async arrayBuffer(){return ptt(await this.buffer())}async text(){return(await n1e(this)).toString()}async json(){return JSON.parse(await this.text())}};Object.defineProperties(Z9.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});var ftt=t=>{if(t[ou].disturbed)throw new TypeError("Cannot clone: already read");let{stream:e}=t[ou],r=e;if(e instanceof vh){r=new r1e;let n=new r1e;e.pipe(r),e.pipe(n),t[ou].stream=n}return r},mtt=t=>t===null?null:typeof t=="string"?"text/plain; charset=utf-8":t instanceof URLSearchParams?"application/x-www-form-urlencoded; charset=utf-8":Buffer.isBuffer(t)||i1e(t)||t instanceof vh?null:"text/plain; charset=utf-8";o1e.exports={Body:Z9,cloneStream:ftt,guessContentType:mtt}});var fE=R((BSr,l1e)=>{"use strict";var{validateHeaderName:s1e,validateHeaderValue:a1e}=require("http"),{isPlainObject:htt}=gh(),yh=Symbol("Headers internals"),zN=t=>{let e=typeof t!="string"?String(t):t;if(typeof s1e=="function")s1e(e);else if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let r=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),r}return e.toLowerCase()},c1e=(t,e)=>{let r=typeof t!="string"?String(t):t;if(typeof a1e=="function")a1e(e,r);else if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){let n=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}return r},t7=class t{constructor(e={}){if(this[yh]={map:new Map},e instanceof t)e.forEach((r,n)=>{this.append(n,r)});else if(Array.isArray(e))e.forEach(([r,n])=>{this.append(r,n)});else if(htt(e))for(let[r,n]of Object.entries(e))this.append(r,n)}set(e,r){this[yh].map.set(zN(e),c1e(r,e))}has(e){return this[yh].map.has(zN(e))}get(e){let r=this[yh].map.get(zN(e));return r===void 0?null:r}append(e,r){let n=zN(e),o=c1e(r,e),s=this[yh].map.get(n);this[yh].map.set(n,s?`${s}, ${o}`:o)}delete(e){this[yh].map.delete(zN(e))}forEach(e,r){for(let n of this.keys())e.call(r,this.get(n),n)}keys(){return Array.from(this[yh].map.keys()).sort()}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return this.constructor.name}plain(){return Object.fromEntries(this[yh].map)}};Object.defineProperties(t7.prototype,["append","delete","entries","forEach","get","has","keys","set","values"].reduce((t,e)=>(t[e]={enumerable:!0},t),{}));l1e.exports={Headers:t7}});var NZ=R((qSr,u1e)=>{"use strict";var{EventEmitter:gtt}=require("events"),Ad=Symbol("AbortSignal internals"),mE=class{constructor(){this[Ad]={eventEmitter:new gtt,onabort:null,aborted:!1}}get aborted(){return this[Ad].aborted}get onabort(){return this[Ad].onabort}set onabort(e){this[Ad].onabort=e}get[Symbol.toStringTag](){return this.constructor.name}removeEventListener(e,r){this[Ad].eventEmitter.removeListener(e,r)}addEventListener(e,r){this[Ad].eventEmitter.on(e,r)}dispatchEvent(e){let r={type:e,target:this},n=`on${e}`;typeof this[Ad][n]=="function"&&this[n](r),this[Ad].eventEmitter.emit(e,r)}fire(){this[Ad].aborted=!0,this.dispatchEvent("abort")}};Object.defineProperties(mE.prototype,{addEventListener:{enumerable:!0},removeEventListener:{enumerable:!0},dispatchEvent:{enumerable:!0},aborted:{enumerable:!0},onabort:{enumerable:!0}});var n7=class extends mE{constructor(e){if(!Number.isInteger(e))throw new TypeError(`Expected an integer, got ${typeof e}`);super(),this[Ad].timerId=setTimeout(()=>{this.fire()},e)}clear(){clearTimeout(this[Ad].timerId)}};Object.defineProperties(n7.prototype,{clear:{enumerable:!0}});var r7=Symbol("AbortController internals"),i7=class{constructor(){this[r7]={signal:new mE}}get signal(){return this[r7].signal}get[Symbol.toStringTag](){return this.constructor.name}abort(){this[r7].signal.aborted||this[r7].signal.fire()}};Object.defineProperties(i7.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});u1e.exports={AbortController:i7,AbortSignal:mE,TimeoutSignal:n7}});var $N=R((jSr,f1e)=>{"use strict";var{randomBytes:vtt}=require("crypto"),{Readable:ytt}=require("stream"),OZ=t=>typeof t=="object"&&["arrayBuffer","stream","text","slice","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&typeof t.type=="string"&&typeof t.size=="number"&&/^(Blob|File)$/.test(t[Symbol.toStringTag]),btt=t=>t!=null&&typeof t=="object"&&["append","delete","get","getAll","has","set","keys","values","entries","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&t[Symbol.toStringTag]==="FormData",d1e=t=>`--${t}--\r
\r
`,p1e=(t,e,r)=>{let n="";return n+=`--${t}\r
`,n+=`Content-Disposition: form-data; name="${e}"`,OZ(r)&&(n+=`; filename="${r.name}"\r
`,n+=`Content-Type: ${r.type||"application/octet-stream"}`),`${n}\r
\r
`};async function*_tt(t,e){for(let[r,n]of t)yield p1e(e,r,n),OZ(n)?yield*n.stream():yield n,yield`\r
`;yield d1e(e)}var xtt=(t,e)=>{let r=0;for(let[n,o]of t)r+=Buffer.byteLength(p1e(e,n,o)),r+=OZ(o)?o.size:Buffer.byteLength(String(o)),r+=Buffer.byteLength(`\r
`);return r+=Buffer.byteLength(d1e(e)),r},LZ=class{constructor(e){this.fd=e,this.boundary=vtt(8).toString("hex")}length(){return typeof this._length>"u"&&(this._length=xtt(this.fd,this.boundary)),this._length}contentType(){return`multipart/form-data; boundary=${this.boundary}`}stream(){return ytt.from(_tt(this.fd,this.boundary))}};f1e.exports={isFormData:btt,FormDataSerializer:LZ}});var h1e=R((VSr,m1e)=>{"use strict";var{AbortSignal:Stt}=NZ(),{Body:Itt,cloneStream:Ctt,guessContentType:Ttt}=e7(),{Headers:Ett}=fE(),{isPlainObject:wtt}=gh(),{isFormData:ktt,FormDataSerializer:Rtt}=$N(),Ptt=20,H0=Symbol("Request internals"),o7=class t extends Itt{constructor(e,r={}){let n=e instanceof t?e:null,o=n?new URL(n.url):new URL(e),s=r.method||n&&n.method||"GET";if(s=s.toUpperCase(),(r.body!=null||n&&n.body!==null)&&["GET","HEAD"].includes(s))throw new TypeError("Request with GET/HEAD method cannot have body");let a=r.body||(n&&n.body?Ctt(n):null),c=new Ett(r.headers||n&&n.headers||{});if(ktt(a)&&!c.has("content-type")){let p=new Rtt(a);a=p.stream(),c.set("content-type",p.contentType()),!c.has("transfer-encoding")&&!c.has("content-length")&&c.set("content-length",p.length())}if(!c.has("content-type"))if(wtt(a))a=JSON.stringify(a),c.set("content-type","application/json");else{let p=Ttt(a);p&&c.set("content-type",p)}super(a);let l=n?n.signal:null;if("signal"in r&&(l=r.signal),l&&!(l instanceof Stt))throw new TypeError("signal needs to be an instance of AbortSignal");let u=r.redirect||n&&n.redirect||"follow";if(!["follow","error","manual"].includes(u))throw new TypeError(`'${u}' is not a valid redirect option`);let d=r.cache||n&&n.cache||"default";if(!["default","no-store","reload","no-cache","force-cache","only-if-cached"].includes(d))throw new TypeError(`'${d}' is not a valid cache option`);this[H0]={init:{...r},method:s,redirect:u,cache:d,headers:c,parsedURL:o,signal:l},r.follow===void 0?!n||n.follow===void 0?this.follow=Ptt:this.follow=n.follow:this.follow=r.follow,this.counter=r.counter||n&&n.counter||0,r.compress===void 0?!n||n.compress===void 0?this.compress=!0:this.compress=n.compress:this.compress=r.compress,r.decode===void 0?!n||n.decode===void 0?this.decode=!0:this.decode=n.decode:this.decode=r.decode}get method(){return this[H0].method}get url(){return this[H0].parsedURL.toString()}get headers(){return this[H0].headers}get redirect(){return this[H0].redirect}get cache(){return this[H0].cache}get signal(){return this[H0].signal}clone(){return new t(this)}get init(){return this[H0].init}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(o7.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},cache:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});m1e.exports={Request:o7}});var MZ=R((HSr,g1e)=>{"use strict";var{Body:Att,cloneStream:Dtt,guessContentType:Ntt}=e7(),{Headers:Ltt}=fE(),{isPlainObject:Ott}=gh(),{isFormData:Mtt,FormDataSerializer:Ftt}=$N(),Dd=Symbol("Response internals"),s7=class t extends Att{constructor(e=null,r={}){let n=new Ltt(r.headers),o=e;if(Mtt(o)&&!n.has("content-type")){let s=new Ftt(o);o=s.stream(),n.set("content-type",s.contentType()),!n.has("transfer-encoding")&&!n.has("content-length")&&n.set("content-length",s.length())}if(o!==null&&!n.has("content-type"))if(Ott(o))o=JSON.stringify(o),n.set("content-type","application/json");else{let s=Ntt(o);s&&n.set("content-type",s)}super(o),this[Dd]={url:r.url,status:r.status||200,statusText:r.statusText||"",headers:n,httpVersion:r.httpVersion,decoded:r.decoded,counter:r.counter}}get url(){return this[Dd].url||""}get status(){return this[Dd].status}get statusText(){return this[Dd].statusText}get ok(){return this[Dd].status>=200&&this[Dd].status<300}get redirected(){return this[Dd].counter>0}get headers(){return this[Dd].headers}get httpVersion(){return this[Dd].httpVersion}get decoded(){return this[Dd].decoded}static redirect(e,r=302){if(![301,302,303,307,308].includes(r))throw new RangeError("Invalid status code");return new t(null,{headers:{location:new URL(e).toString()},status:r})}clone(){if(this.bodyUsed)throw new TypeError("Cannot clone: already read");return new t(Dtt(this),{...this[Dd]})}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(s7.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});g1e.exports={Response:s7}});var y1e=R((zSr,v1e)=>{"use strict";var Utt=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),Btt=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),qtt=new Set([500,502,503,504]),jtt={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},Vtt={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function _x(t){let e=parseInt(t,10);return isFinite(e)?e:0}function Htt(t){return t?qtt.has(t.status):!0}function FZ(t){let e={};if(!t)return e;let r=t.trim().split(/,/);for(let n of r){let[o,s]=n.split(/=/,2);e[o.trim()]=s===void 0?!0:s.trim().replace(/^"|"$/g,"")}return e}function Gtt(t){let e=[];for(let r in t){let n=t[r];e.push(n===!0?r:r+"="+n)}if(e.length)return e.join(", ")}v1e.exports=class{constructor(e,r,{shared:n,cacheHeuristic:o,immutableMinTimeToLive:s,ignoreCargoCult:a,_fromObject:c}={}){if(c){this._fromObject(c);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=o!==void 0?o:.1,this._immutableMinTtl=s!==void 0?s:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=FZ(r.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=r.headers.vary?e.headers:null,this._reqcc=FZ(e.headers["cache-control"]),a&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":Gtt(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&Btt.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||Utt.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);let r=FZ(e.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(e.headers.pragma)||r["max-age"]&&this.age()>r["max-age"]||r["min-fresh"]&&this.timeToLive()<1e3*r["min-fresh"]||this.stale()&&!(r["max-stale"]&&!this._rescc["must-revalidate"]&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(e,!1)}_requestMatches(e,r){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||r&&e.method==="HEAD")&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(e.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(e){let r={};for(let n in e)jtt[n]||(r[n]=e[n]);if(e.connection){let n=e.connection.trim().split(/\s*,\s*/);for(let o of n)delete r[o]}if(r.warning){let n=r.warning.split(/,/).filter(o=>!/^\s*1[0-9][0-9]/.test(o));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(r)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return e+r}_ageValue(){return _x(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return _x(this._rescc["s-maxage"])}if(this._rescc["max-age"])return _x(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(e,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(e,(r-n)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),r=e+_x(this._rescc["stale-if-error"]),n=e+_x(this._rescc["stale-while-revalidate"]);return Math.max(0,e,r,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+_x(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+_x(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let r=this._copyWithoutHopByHopHeaders(e.headers);if(delete r["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let o=r["if-none-match"].split(/,/).filter(s=>!/^\s*W\//.test(s));o.length?r["if-none-match"]=o.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(e,r){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&Htt(r))return{modified:!1,matches:!1,policy:this};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;if(r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(e,r),modified:r.status!=304,matches:!1};let o={};for(let a in this._resHeaders)o[a]=a in r.headers&&!Vtt[a]?r.headers[a]:this._resHeaders[a];let s=Object.assign({},r,{status:this._status,method:this._method,headers:o});return{policy:new this.constructor(e,s,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var S1e=R(($Sr,x1e)=>{"use strict";var ztt=y1e(),{Headers:$tt}=fE(),b1e=t=>({url:t.url,method:t.method,headers:t.headers.plain()}),_1e=t=>({status:t.status,headers:t.headers.plain()}),UZ=class{constructor(e,r,n){this.policy=new ztt(b1e(e),_1e(r),n)}storable(){return this.policy.storable()}satisfiesWithoutRevalidation(e){return this.policy.satisfiesWithoutRevalidation(b1e(e))}responseHeaders(e){return new $tt(this.policy.responseHeaders(_1e(e)))}timeToLive(){return this.policy.timeToLive()}};x1e.exports=UZ});var T1e=R((WSr,C1e)=>{"use strict";var{Readable:Wtt}=require("stream"),{Headers:I1e}=fE(),{Response:Ktt}=MZ(),G0=Symbol("CacheableResponse internals"),Ytt=t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),BZ=class t extends Ktt{constructor(e,r){super(e,r);let n=new I1e(r.headers);this[G0]={headers:n,bufferedBody:e}}get headers(){return this[G0].headers}set headers(e){if(e instanceof I1e)this[G0].headers=e;else throw new TypeError("instance of Headers expected")}get body(){return Wtt.from(this[G0].bufferedBody)}get bodyUsed(){return!1}async buffer(){return this[G0].bufferedBody}async arrayBuffer(){return Ytt(this[G0].bufferedBody)}async text(){return this[G0].bufferedBody.toString()}async json(){return JSON.parse(await this.text())}clone(){let{url:e,status:r,statusText:n,headers:o,httpVersion:s,decoded:a,counter:c}=this;return new t(this[G0].bufferedBody,{url:e,status:r,statusText:n,headers:o,httpVersion:s,decoded:a,counter:c})}get[Symbol.toStringTag](){return this.constructor.name}},Qtt=async t=>{let e=await t.buffer(),{url:r,status:n,statusText:o,headers:s,httpVersion:a,decoded:c,counter:l}=t;return new BZ(e,{url:r,status:n,statusText:o,headers:s,httpVersion:a,decoded:c,counter:l})};C1e.exports={cacheableResponse:Qtt}});var a7=R((KSr,E1e)=>{"use strict";var qZ=class extends Error{get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};E1e.exports={RequestAbortedError:qZ}});var A1e=R((YSr,P1e)=>{"use strict";var k1e=require("http"),R1e=require("https"),{Readable:Xtt}=require("stream"),bh=Pd()("helix-fetch:h1"),{RequestAbortedError:w1e}=a7(),{decodeStream:Jtt}=gh(),Ztt=(t,e)=>{let{h1:r,options:{h1:n,rejectUnauthorized:o}}=t;return e==="https:"?r.httpsAgent?r.httpsAgent:n||typeof o=="boolean"?(r.httpsAgent=new R1e.Agent(typeof o=="boolean"?{...n||{},rejectUnauthorized:o}:n),r.httpsAgent):void 0:r.httpAgent?r.httpAgent:n?(r.httpAgent=new k1e.Agent(n),r.httpAgent):void 0},ert=t=>{t.h1={}},trt=async({h1:t})=>{t.httpAgent&&(bh("resetContext: destroying httpAgent"),t.httpAgent.destroy(),delete t.httpAgent),t.httpsAgent&&(bh("resetContext: destroying httpsAgent"),t.httpsAgent.destroy(),delete t.httpsAgent)},rrt=(t,e,r)=>{let{statusCode:n,statusMessage:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:l}=t,u=e?Jtt(n,l,t,r):t;return{statusCode:n,statusText:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:l,readable:u,decoded:!!(e&&u!==t)}},nrt=async(t,e,r)=>{let{request:n}=e.protocol==="https:"?R1e:k1e,o=Ztt(t,e.protocol),s={...r,agent:o},{socket:a,body:c}=s;return a&&(delete s.socket,a.assigned||(a.assigned=!0,o?s.agent=new Proxy(o,{get:(l,u)=>u==="createConnection"&&!a.inUse?(d,p)=>{bh(`agent reusing socket #${a.id} (${a.servername})`),a.inUse=!0,p(null,a)}:l[u]}):s.createConnection=(l,u)=>{bh(`reusing socket #${a.id} (${a.servername})`),a.inUse=!0,u(null,a)})),new Promise((l,u)=>{bh(`${s.method} ${e.href}`);let d,{signal:p}=s,f=()=>{p.removeEventListener("abort",f),a&&!a.inUse&&(bh(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),u(new w1e),d&&d.abort()};if(p){if(p.aborted){u(new w1e);return}p.addEventListener("abort",f)}d=n(e,s),d.once("response",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(bh(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),l(rrt(m,s.decode,u))}),d.once("error",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(bh(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),d.aborted||(bh(`${s.method} ${e.href} failed with: ${m.message}`),d.abort(),u(m))}),c instanceof Xtt?c.pipe(d):(c&&d.write(c),d.end())})};P1e.exports={request:nrt,setupContext:ert,resetContext:trt}});var O1e=R((QSr,L1e)=>{"use strict";var{connect:irt,constants:ort}=require("http2"),{Readable:srt}=require("stream"),Zn=Pd()("helix-fetch:h2"),{RequestAbortedError:D1e}=a7(),{decodeStream:art}=gh(),{NGHTTP2_CANCEL:WN}=ort,crt=5*60*1e3,lrt=5e3,urt=t=>{t.h2={sessionCache:{}}},drt=async({h2:t})=>Promise.all(Object.values(t.sessionCache).map(e=>new Promise(r=>{e.on("close",r),Zn(`resetContext: destroying session (socket #${e.socket&&e.socket.id}, ${e.socket&&e.socket.servername})`),e.destroy()}))),N1e=(t,e,r,n=()=>{})=>{let o={...t},s=o[":status"];delete o[":status"];let a=r?art(s,t,e,n):e;return{statusCode:s,statusText:"",httpVersion:"2.0",httpVersionMajor:2,httpVersionMinor:0,headers:o,readable:a,decoded:!!(r&&a!==e)}},prt=(t,e,r,n,o,s)=>{let{options:{h2:{pushPromiseHandler:a,pushHandler:c,pushedStreamIdleTimeout:l=lrt}}}=t,u=o[":path"],d=`${e}${u}`;Zn(`received PUSH_PROMISE: ${d}, stream #${n.id}, headers: ${JSON.stringify(o)}, flags: ${s}`),a&&a(d,o,()=>{n.close(WN)}),n.on("push",(p,f)=>{Zn(`received push headers for ${e}${u}, stream #${n.id}, headers: ${JSON.stringify(p)}, flags: ${f}`),n.setTimeout(l,()=>{Zn(`closing pushed stream #${n.id} after ${l} ms of inactivity`),n.close(WN)}),c&&c(d,o,N1e(p,n,r))}),n.on("aborted",()=>{Zn(`pushed stream #${n.id} aborted`)}),n.on("error",p=>{Zn(`pushed stream #${n.id} encountered error: ${p}`)}),n.on("frameError",(p,f,m)=>{Zn(`pushed stream #${n.id} encountered frameError: type: ${p}, code: ${f}, id: ${m}`)})},frt=async(t,e,r)=>{let{origin:n,pathname:o,search:s,hash:a}=e,c=`${o}${s}${a}`,{options:{h2:l={}},h2:{sessionCache:u}}=t,{idleSessionTimeout:d=crt,pushPromiseHandler:p,pushHandler:f}=l,m={...r},{method:h,headers:g,socket:v,body:b,decode:_}=m;return v&&delete m.socket,g.host&&(g[":authority"]=g.host,delete g.host),new Promise((x,S)=>{let I=u[n];if(!I||I.closed||I.destroyed){let F=!(t.options.rejectUnauthorized===!1||l.rejectUnauthorized===!1),ue={...l,rejectUnauthorized:F};v&&!v.inUse&&(ue.createConnection=()=>(Zn(`reusing socket #${v.id} (${v.servername})`),v.inUse=!0,v)),I=irt(n,{...ue,settings:{enablePush:!!(p||f)}}),I.setMaxListeners(1e3),I.setTimeout(d,()=>{Zn(`closing session ${n} after ${d} ms of inactivity`),I.close()}),I.once("connect",()=>{Zn(`session ${n} established`),Zn(`caching session ${n}`),u[n]=I}),I.on("localSettings",V=>{Zn(`session ${n} localSettings: ${JSON.stringify(V)}`)}),I.on("remoteSettings",V=>{Zn(`session ${n} remoteSettings: ${JSON.stringify(V)}`)}),I.once("close",()=>{Zn(`session ${n} closed`),u[n]===I&&(Zn(`discarding cached session ${n}`),delete u[n])}),I.once("error",V=>{Zn(`session ${n} encountered error: ${V}`),u[n]===I&&(Zn(`discarding cached session ${n}`),delete u[n])}),I.on("frameError",(V,A,P)=>{Zn(`session ${n} encountered frameError: type: ${V}, code: ${A}, id: ${P}`)}),I.once("goaway",(V,A,P)=>{Zn(`session ${n} received GOAWAY frame: errorCode: ${V}, lastStreamID: ${A}, opaqueData: ${P?P.toString():void 0}`)}),I.on("stream",(V,A,P)=>{prt(t,n,_,V,A,P)})}else v&&v.id!==I.socket.id&&!v.inUse&&(Zn(`discarding redundant socket used for ALPN: #${v.id} ${v.servername}`),v.destroy());Zn(`${h} ${e.host}${c}`);let w,{signal:k}=m,M=()=>{k.removeEventListener("abort",M),S(new D1e),w&&w.close(WN)};if(k){if(k.aborted){S(new D1e);return}k.addEventListener("abort",M)}let H=F=>{Zn(`session ${n} encountered error during ${m.method} ${e.href}: ${F}`),S(F)};I.once("error",H),w=I.request({":method":h,":path":c,...g}),w.once("response",F=>{I.off("error",H),k&&k.removeEventListener("abort",M),x(N1e(F,w,m.decode,S))}),w.once("error",F=>{I.off("error",H),k&&k.removeEventListener("abort",M),w.rstCode!==WN&&(Zn(`${m.method} ${e.href} failed with: ${F.message}`),w.close(WN),S(F))}),w.once("frameError",(F,ue,Z)=>{I.off("error",H),Zn(`encountered frameError during ${m.method} ${e.href}: type: ${F}, code: ${ue}, id: ${Z}`)}),w.on("push",(F,ue)=>{Zn(`received 'push' event: headers: ${JSON.stringify(F)}, flags: ${ue}`)}),b instanceof srt?b.pipe(w):(b&&w.write(b),w.end())})};L1e.exports={request:frt,setupContext:urt,resetContext:drt}});var F1e=R((XSr,M1e)=>{"use strict";var{EventEmitter:mrt}=require("events"),hrt=()=>{let t={},e=new mrt;return e.setMaxListeners(0),{acquire:r=>new Promise(n=>{if(!t[r]){t[r]=!0,n();return}let o=s=>{t[r]||(t[r]=!0,e.removeListener(r,o),n(s))};e.on(r,o)}),release:(r,n)=>{Reflect.deleteProperty(t,r),setImmediate(()=>e.emit(r,n))}}};M1e.exports=hrt});var U1e=R((JSr,grt)=>{grt.exports={name:"@adobe/helix-fetch",version:"3.1.1",description:"Light-weight Fetch implementation transparently supporting both HTTP/1(.1) and HTTP/2",main:"src/index.js",scripts:{test:"nyc mocha",lint:"./node_modules/.bin/eslint .","semantic-release":"semantic-release"},mocha:{timeout:"5000",recursive:"true",reporter:"mocha-multi-reporters","reporter-options":"configFile=.mocha-multi.json"},engines:{node:">=12.0"},types:"src/index.d.ts",exports:{import:"./src/index.mjs",require:"./src/index.js"},repository:{type:"git",url:"https://github.com/adobe/helix-fetch"},author:"",license:"Apache-2.0",bugs:{url:"https://github.com/adobe/helix-fetch/issues"},homepage:"https://github.com/adobe/helix-fetch#readme",keywords:["fetch","whatwg","Fetch API","http","https","http2","h2","promise","async","request","RFC 7234","7234","caching","cache"],dependencies:{debug:"4.3.4","http-cache-semantics":"^4.1.1","lru-cache":"7.13.1"},devDependencies:{"@adobe/eslint-config-helix":"1.3.2","@semantic-release/changelog":"6.0.1","@semantic-release/git":"10.0.1",chai:"4.3.6","chai-as-promised":"7.1.1","chai-bytes":"0.1.2","chai-iterator":"3.0.2",eslint:"8.21.0","eslint-plugin-header":"3.1.1","eslint-plugin-import":"2.26.0","formdata-node":"4.3.3","lint-staged":"13.0.3",mocha:"10.0.0","mocha-multi-reporters":"1.5.1",nock:"13.2.9",nyc:"15.1.0","parse-cache-control":"1.0.1",pem:"1.14.6",proxy:"^1.0.2","semantic-release":"19.0.3",sinon:"14.0.0","stream-buffers":"3.0.2",tunnel:"^0.0.6"},"lint-staged":{"*.js":"eslint"},config:{commitizen:{path:"node_modules/cz-conventional-changelog"},ghooks:{"pre-commit":"npx lint-staged"}}}});var H1e=R((ZSr,V1e)=>{"use strict";var{Readable:vrt}=require("stream"),yrt=require("tls"),{types:{isAnyArrayBuffer:brt}}=require("util"),_rt=RZ(),jZ=Pd()("helix-fetch:core"),{RequestAbortedError:c7}=a7(),VZ=A1e(),l7=O1e(),xrt=F1e(),{isPlainObject:Srt}=gh(),{isFormData:Irt,FormDataSerializer:Crt}=$N(),{version:Trt}=U1e(),HZ="h2",GZ="h2c",zZ="http/1.0",xx="http/1.1",Ert=100,wrt=60*60*1e3,krt=[HZ,xx,zZ],Rrt=`helix-fetch/${Trt}`,Prt={method:"GET",compress:!0,decode:!0},B1e=0,q1e=xrt(),j1e=(t,e)=>new Promise((r,n)=>{let{signal:o}=e,s,a=()=>{o.removeEventListener("abort",a);let u=new c7;n(u),s&&s.destroy(u)};if(o){if(o.aborted){n(new c7);return}o.addEventListener("abort",a)}let c=+t.port||443,l=u=>{o&&o.removeEventListener("abort",a),u instanceof c7||(jZ(`connecting to ${t.hostname}:${c} failed with: ${u.message}`),n(u))};s=yrt.connect(c,t.hostname,e),s.once("secureConnect",()=>{o&&o.removeEventListener("abort",a),s.off("error",l),B1e+=1,s.id=B1e,s.secureConnecting=!1,jZ(`established TLS connection: #${s.id} (${s.servername})`),r(s)}),s.once("error",l)}),Art=async(t,e)=>{let r=await q1e.acquire(t.origin);try{return r||(r=await j1e(t,e)),r}finally{q1e.release(t.origin,r)}},Drt=async(t,e,r)=>{let n=`${e.protocol}//${e.host}`,o=t.alpnCache.get(n);if(o)return{protocol:o};switch(e.protocol){case"http:":return o=xx,t.alpnCache.set(n,o),{protocol:o};case"http2:":return o=GZ,t.alpnCache.set(n,o),{protocol:o};case"https:":break;default:throw new TypeError(`unsupported protocol: ${e.protocol}`)}let{options:{rejectUnauthorized:s,h1:a={},h2:c={}}}=t,l=!(s===!1||a.rejectUnauthorized===!1||c.rejectUnauthorized===!1),u={servername:e.hostname,ALPNProtocols:t.alpnProtocols,signal:r,rejectUnauthorized:l};t.options.ca&&(u.ca=t.options.ca);let d=await Art(e,u);return o=d.alpnProtocol,o||(o=xx),t.alpnCache.set(n,o),{protocol:o,socket:d}},Nrt=t=>{let e={};return Object.keys(t).forEach(r=>{e[r.toLowerCase()]=t[r]}),e},Lrt=async(t,e,r,n)=>{let o=e.protocol==="https:",s;e.port?s=e.port:o?s=443:s=80;let a={...r,host:e.host,hostname:e.hostname,port:s},c=await t(a);if(o){let u={...a,ALPNProtocols:n};u.socket=c,u.servername=a.host;let d=await j1e(e,u);return{protocol:d.alpnProtocol||xx,socket:d}}return{protocol:c.alpnProtocol||xx,socket:c}},Ort=async(t,e,r)=>{let n=new URL(e),o={...Prt,...r||{}};typeof o.method=="string"&&(o.method=o.method.toUpperCase()),o.headers=Nrt(o.headers||{}),o.headers.host===void 0&&(o.headers.host=n.host),t.userAgent&&o.headers["user-agent"]===void 0&&(o.headers["user-agent"]=t.userAgent);let s;if(o.body instanceof URLSearchParams)s="application/x-www-form-urlencoded; charset=utf-8",o.body=o.body.toString();else if(Irt(o.body)){let u=new Crt(o.body);s=u.contentType(),o.body=u.stream(),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(u.length()))}else typeof o.body=="string"||o.body instanceof String?s="text/plain; charset=utf-8":Srt(o.body)?(o.body=JSON.stringify(o.body),s="application/json"):brt(o.body)&&(o.body=Buffer.from(o.body));o.headers["content-type"]===void 0&&s!==void 0&&(o.headers["content-type"]=s),o.body!=null&&(o.body instanceof vrt||(!(typeof o.body=="string"||o.body instanceof String)&&!Buffer.isBuffer(o.body)&&(o.body=String(o.body)),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(Buffer.isBuffer(o.body)?o.body.length:Buffer.byteLength(o.body,"utf-8"))))),o.headers.accept===void 0&&(o.headers.accept="*/*"),o.body==null&&["POST","PUT"].includes(o.method)&&(o.headers["content-length"]="0"),o.compress&&o.headers["accept-encoding"]===void 0&&(o.headers["accept-encoding"]="gzip,deflate,br");let{signal:a}=o,{protocol:c,socket:l=null}=t.socketFactory?await Lrt(t.socketFactory,n,o,t.alpnProtocols):await Drt(t,n,a);switch(jZ(`${n.host} -> ${c}`),c){case HZ:try{return await l7.request(t,n,l?{...o,socket:l}:o)}catch(u){let{code:d,message:p}=u;throw d==="ERR_HTTP2_ERROR"&&p==="Protocol error"&&t.alpnCache.delete(`${n.protocol}//${n.host}`),u}case GZ:return l7.request(t,new URL(`http://${n.host}${n.pathname}${n.hash}${n.search}`),l?{...o,socket:l}:o);case zZ:case xx:return VZ.request(t,n,l?{...o,socket:l}:o);default:throw new TypeError(`unsupported protocol: ${c}`)}},Mrt=async t=>(t.alpnCache.clear(),Promise.all([VZ.resetContext(t),l7.resetContext(t)])),Frt=t=>{let{options:{alpnProtocols:e=krt,alpnCacheTTL:r=wrt,alpnCacheSize:n=Ert,userAgent:o=Rrt,socketFactory:s}}=t;t.alpnProtocols=e,t.alpnCache=new _rt({max:n,ttl:r}),t.userAgent=o,t.socketFactory=s,VZ.setupContext(t),l7.setupContext(t)};V1e.exports={request:Ort,setupContext:Frt,resetContext:Mrt,RequestAbortedError:c7,ALPN_HTTP2:HZ,ALPN_HTTP2C:GZ,ALPN_HTTP1_1:xx,ALPN_HTTP1_0:zZ}});var z1e=R((e1r,G1e)=>{"use strict";var Urt=Pd()("helix-fetch:core"),{request:Brt,setupContext:qrt,resetContext:jrt,RequestAbortedError:Vrt,ALPN_HTTP2:Hrt,ALPN_HTTP2C:Grt,ALPN_HTTP1_1:zrt,ALPN_HTTP1_0:$rt}=H1e(),$Z=class t{constructor(e){this.options={...e||{}},qrt(this)}api(){return{request:async(e,r)=>this.request(e,r),context:(e={})=>new t(e).api(),setCA:e=>this.setCA(e),reset:async()=>this.reset(),RequestAbortedError:Vrt,ALPN_HTTP2:Hrt,ALPN_HTTP2C:Grt,ALPN_HTTP1_1:zrt,ALPN_HTTP1_0:$rt}}async request(e,r){return Brt(this,e,r)}setCA(e){this.options.ca=e}async reset(){return Urt("resetting context"),jrt(this)}};G1e.exports=new $Z().api()});var Q1e=R((t1r,Y1e)=>{"use strict";var{EventEmitter:Wrt}=require("events"),{Readable:KN}=require("stream"),WZ=Pd()("helix-fetch"),Krt=RZ(),{Body:Yrt}=e7(),{Headers:XZ}=fE(),{Request:Sx}=h1e(),{Response:YZ}=MZ(),{FetchBaseError:Qrt,FetchError:YN,AbortError:u7}=DZ(),{AbortController:Xrt,AbortSignal:Jrt,TimeoutSignal:Zrt}=NZ(),ent=S1e(),{cacheableResponse:tnt}=T1e(),{sizeof:rnt}=gh(),{isFormData:nnt}=$N(),{context:int,RequestAbortedError:ont}=z1e(),$1e=["GET","HEAD"],snt=500,ant=100*1024*1024,KZ="push",W1e=async(t,e,r)=>{let{request:n}=t.context,o=e instanceof Sx&&typeof r>"u"?e:new Sx(e,r),{method:s,body:a,signal:c,compress:l,decode:u,follow:d,redirect:p,init:{body:f}}=o,m;if(c&&c.aborted){let I=new u7("The operation was aborted.");throw o.init.body instanceof KN&&o.init.body.destroy(I),I}try{m=await n(o.url,{...r,method:s,headers:o.headers.plain(),body:f&&!(f instanceof KN)&&!nnt(f)?f:a,compress:l,decode:u,follow:d,redirect:p,signal:c})}catch(I){throw f instanceof KN&&f.destroy(I),I instanceof TypeError?I:I instanceof ont?new u7("The operation was aborted."):new YN(I.message,"system",I)}let h=()=>{c.removeEventListener("abort",h);let I=new u7("The operation was aborted.");o.init.body instanceof KN&&o.init.body.destroy(I),m.readable.emit("error",I)};c&&c.addEventListener("abort",h);let{statusCode:g,statusText:v,httpVersion:b,headers:_,readable:x,decoded:S}=m;if([301,302,303,307,308].includes(g)){let{location:I}=_,w=I==null?null:new URL(I,o.url);switch(o.redirect){case"manual":break;case"error":throw c&&c.removeEventListener("abort",h),new YN(`uri requested responds with a redirect, redirect mode is set to 'error': ${o.url}`,"no-redirect");case"follow":{if(w===null)break;if(o.counter>=o.follow)throw c&&c.removeEventListener("abort",h),new YN(`maximum redirect reached at: ${o.url}`,"max-redirect");let k={headers:new XZ(o.headers),follow:o.follow,compress:o.compress,decode:o.decode,counter:o.counter+1,method:o.method,body:o.body,signal:o.signal};if(g!==303&&o.body&&o.init.body instanceof KN)throw c&&c.removeEventListener("abort",h),new YN("Cannot follow redirect with body being a readable stream","unsupported-redirect");return(g===303||(g===301||g===302)&&o.method==="POST")&&(k.method="GET",k.body=void 0,k.headers.delete("content-length")),c&&c.removeEventListener("abort",h),W1e(t,new Sx(w,k))}default:}}return c&&(x.once("end",()=>{c.removeEventListener("abort",h)}),x.once("error",()=>{c.removeEventListener("abort",h)})),new YZ(x,{url:o.url,status:g,statusText:v,headers:_,httpVersion:b,decoded:S,counter:o.counter})},K1e=async(t,e,r)=>{if(t.options.maxCacheSize===0||!$1e.includes(e.method))return r;let n=new ent(e,r,{shared:!1});if(n.storable()){let o=await tnt(r);return t.cache.set(e.url,{policy:n,response:o},n.timeToLive()),o}else return r},cnt=async(t,e,r)=>{let n=new Sx(e,r);if(t.options.maxCacheSize!==0&&$1e.includes(n.method)&&!["no-store","reload"].includes(n.cache)){let{policy:a,response:c}=t.cache.get(n.url)||{};if(a&&a.satisfiesWithoutRevalidation(n)){c.headers=new XZ(a.responseHeaders(c));let l=c.clone();return l.fromCache=!0,l}}let s=await W1e(t,n);return n.cache!=="no-store"?K1e(t,n,s):s},lnt=(t,e={})=>{let r=new URL(t);if(typeof e!="object"||Array.isArray(e))throw new TypeError("qs: object expected");return Object.entries(e).forEach(([n,o])=>{Array.isArray(o)?o.forEach(s=>r.searchParams.append(n,s)):r.searchParams.append(n,o)}),r.href},unt=t=>new Zrt(t),QZ=class t{constructor(e){this.options={...e};let{maxCacheSize:r}=this.options,n=typeof r=="number"&&r>=0?r:ant,o=snt;n===0&&(n=1,o=1);let s=({response:c},l)=>rnt(c);this.cache=new Krt({max:o,maxSize:n,sizeCalculation:s}),this.eventEmitter=new Wrt,this.options.h2=this.options.h2||{},typeof this.options.h2.enablePush>"u"&&(this.options.h2.enablePush=!0);let{enablePush:a}=this.options.h2;a&&(this.options.h2.pushPromiseHandler=(c,l,u)=>{let d={...l};Object.keys(d).filter(p=>p.startsWith(":")).forEach(p=>delete d[p]),this.pushPromiseHandler(c,d,u)},this.options.h2.pushHandler=(c,l,u)=>{let d={...l};Object.keys(d).filter(b=>b.startsWith(":")).forEach(b=>delete d[b]);let{statusCode:p,statusText:f,httpVersion:m,headers:h,readable:g,decoded:v}=u;this.pushHandler(c,d,new YZ(g,{url:c,status:p,statusText:f,headers:h,httpVersion:m,decoded:v}))}),this.context=int(this.options)}api(){return{fetch:async(e,r)=>this.fetch(e,r),Body:Yrt,Headers:XZ,Request:Sx,Response:YZ,AbortController:Xrt,AbortSignal:Jrt,FetchBaseError:Qrt,FetchError:YN,AbortError:u7,context:(e={})=>new t(e).api(),setCA:e=>this.setCA(e),noCache:(e={})=>new t({...e,maxCacheSize:0}).api(),h1:(e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAlive:(e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),h1NoCache:(e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAliveNoCache:(e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),reset:async()=>this.context.reset(),onPush:e=>this.onPush(e),offPush:e=>this.offPush(e),createUrl:lnt,timeoutSignal:unt,clearCache:()=>this.clearCache(),cacheStats:()=>this.cacheStats(),ALPN_HTTP2:this.context.ALPN_HTTP2,ALPN_HTTP2C:this.context.ALPN_HTTP2C,ALPN_HTTP1_1:this.context.ALPN_HTTP1_1,ALPN_HTTP1_0:this.context.ALPN_HTTP1_0}}async fetch(e,r){return cnt(this,e,r)}setCA(e){this.options.ca=e,this.context.setCA(e)}onPush(e){return this.eventEmitter.on(KZ,e)}offPush(e){return this.eventEmitter.off(KZ,e)}clearCache(){this.cache.clear()}cacheStats(){return{size:this.cache.calculatedSize,count:this.cache.size}}pushPromiseHandler(e,r,n){WZ(`received server push promise: ${e}, headers: ${JSON.stringify(r)}`);let o=new Sx(e,{headers:r}),{policy:s}=this.cache.get(e)||{};s&&s.satisfiesWithoutRevalidation(o)&&(WZ(`already cached, reject push promise: ${e}, headers: ${JSON.stringify(r)}`),n())}async pushHandler(e,r,n){WZ(`caching resource pushed by server: ${e}, reqHeaders: ${JSON.stringify(r)}, status: ${n.status}, respHeaders: ${JSON.stringify(n.headers)}`);let o=await K1e(this,new Sx(e,{headers:r}),n);this.eventEmitter.emit(KZ,e,o)}};Y1e.exports=new QZ().api()});var J1e=R((r1r,X1e)=>{"use strict";X1e.exports=Q1e()});var dr=R((k1r,eIe)=>{eIe.exports={options:{usePureJavaScript:!1}}});var nIe=R((R1r,rIe)=>{var ZZ={};rIe.exports=ZZ;var tIe={};ZZ.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=pnt(t,e);else{var o=0,s=e.length,a=e.charAt(0),c=[0];for(o=0;o<t.length;++o){for(var l=0,u=t[o];l<c.length;++l)u+=c[l]<<8,c[l]=u%s,u=u/s|0;for(;u>0;)c.push(u%s),u=u/s|0}for(o=0;t[o]===0&&o<t.length-1;++o)n+=a;for(o=c.length-1;o>=0;--o)n+=e[c[o]]}if(r){var d=new RegExp(".{1,"+r+"}","g");n=n.match(d).join(`\r
`)}return n};ZZ.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=tIe[e];if(!r){r=tIe[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var o=e.length,s=e.charAt(0),a=[0],n=0;n<t.length;n++){var c=r[t.charCodeAt(n)];if(c===void 0)return;for(var l=0,u=c;l<a.length;++l)u+=a[l]*o,a[l]=u&255,u>>=8;for(;u>0;)a.push(u&255),u>>=8}for(var d=0;t[d]===s&&d<t.length-1;++d)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function pnt(t,e){var r=0,n=e.length,o=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var a=0,c=t.at(r);a<s.length;++a)c+=s[a]<<8,s[a]=c%n,c=c/n|0;for(;c>0;)s.push(c%n),c=c/n|0}var l="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)l+=o;for(r=s.length-1;r>=0;--r)l+=e[s[r]];return l}});var Qr=R((P1r,aIe)=>{var iIe=dr(),oIe=nIe(),J=aIe.exports=iIe.util=iIe.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){J.nextTick=process.nextTick,typeof setImmediate=="function"?J.setImmediate=setImmediate:J.setImmediate=J.nextTick;return}if(typeof setImmediate=="function"){J.setImmediate=function(){return setImmediate.apply(void 0,arguments)},J.nextTick=function(c){return setImmediate(c)};return}if(J.setImmediate=function(c){setTimeout(c,0)},typeof window<"u"&&typeof window.postMessage=="function"){let c=function(l){if(l.source===window&&l.data===t){l.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(d){d()})}};var a=c,t="forge.setImmediate",e=[];J.setImmediate=function(l){e.push(l),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,o=document.createElement("div"),e=[];new MutationObserver(function(){var l=e.slice();e.length=0,l.forEach(function(u){u()})}).observe(o,{attributes:!0});var s=J.setImmediate;J.setImmediate=function(l){Date.now()-r>15?(r=Date.now(),s(l)):(e.push(l),e.length===1&&o.setAttribute("a",n=!n))}}J.nextTick=J.setImmediate})();J.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;J.globalScope=function(){return J.isNodejs?global:typeof self>"u"?window:self}();J.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};J.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};J.isArrayBufferView=function(t){return t&&J.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function XN(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}J.ByteBuffer=eee;function eee(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(J.isArrayBuffer(t)||J.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof eee||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}J.ByteStringBuffer=eee;var fnt=4096;J.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>fnt&&(this.data.substr(0,1),this._constructedStringLength=0)};J.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};J.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};J.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};J.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};J.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};J.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(J.encodeUtf8(t))};J.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};J.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};J.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};J.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};J.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};J.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};J.ByteStringBuffer.prototype.putInt=function(t,e){XN(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};J.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};J.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};J.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};J.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};J.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};J.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};J.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};J.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};J.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};J.ByteStringBuffer.prototype.getInt=function(t){XN(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};J.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};J.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};J.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};J.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};J.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};J.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};J.ByteStringBuffer.prototype.copy=function(){var t=J.createBuffer(this.data);return t.read=this.read,t};J.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};J.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};J.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};J.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};J.ByteStringBuffer.prototype.toString=function(){return J.decodeUtf8(this.bytes())};function mnt(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=J.isArrayBuffer(t),n=J.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}J.DataBuffer=mnt;J.DataBuffer.prototype.length=function(){return this.write-this.read};J.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};J.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};J.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};J.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};J.DataBuffer.prototype.putBytes=function(t,e){if(J.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var o=new Uint8Array(this.data.buffer,this.write);return o.set(r),this.write+=n,this}if(J.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var o=new Uint8Array(this.data.buffer);return o.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof J.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&J.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var o=new Uint8Array(t.data.byteLength,this.write);return o.set(r),this.write+=r.byteLength,this}if(t instanceof J.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=J.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=J.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=J.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=J.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=J.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};J.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};J.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};J.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};J.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};J.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};J.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};J.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};J.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};J.DataBuffer.prototype.putInt=function(t,e){XN(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};J.DataBuffer.prototype.putSignedInt=function(t,e){return XN(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};J.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};J.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};J.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};J.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};J.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};J.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};J.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};J.DataBuffer.prototype.getInt=function(t){XN(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};J.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};J.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};J.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};J.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};J.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};J.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};J.DataBuffer.prototype.copy=function(){return new J.DataBuffer(this)};J.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};J.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};J.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};J.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};J.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return J.binary.raw.encode(e);if(t==="hex")return J.binary.hex.encode(e);if(t==="base64")return J.binary.base64.encode(e);if(t==="utf8")return J.text.utf8.decode(e);if(t==="utf16")return J.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};J.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=J.encodeUtf8(t)),new J.ByteBuffer(t)};J.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};J.xorBytes=function(t,e,r){for(var n="",o="",s="",a=0,c=0;r>0;--r,++a)o=t.charCodeAt(a)^e.charCodeAt(a),c>=10&&(n+=s,s="",c=0),s+=String.fromCharCode(o),++c;return n+=s,n};J.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};J.bytesToHex=function(t){return J.createBuffer(t).toHex()};J.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var z0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",$0=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],sIe="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";J.encode64=function(t,e){for(var r="",n="",o,s,a,c=0;c<t.length;)o=t.charCodeAt(c++),s=t.charCodeAt(c++),a=t.charCodeAt(c++),r+=z0.charAt(o>>2),r+=z0.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=z0.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":z0.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};J.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,o,s,a=0;a<t.length;)r=$0[t.charCodeAt(a++)-43],n=$0[t.charCodeAt(a++)-43],o=$0[t.charCodeAt(a++)-43],s=$0[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|n>>4),o!==64&&(e+=String.fromCharCode((n&15)<<4|o>>2),s!==64&&(e+=String.fromCharCode((o&3)<<6|s)));return e};J.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};J.decodeUtf8=function(t){return decodeURIComponent(escape(t))};J.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:oIe.encode,decode:oIe.decode}};J.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};J.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};J.binary.hex.encode=J.bytesToHex;J.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var o=0,s=r;for(t.length&1&&(o=1,n[s++]=parseInt(t[0],16));o<t.length;o+=2)n[s++]=parseInt(t.substr(o,2),16);return e?s-r:n};J.binary.base64.encode=function(t,e){for(var r="",n="",o,s,a,c=0;c<t.byteLength;)o=t[c++],s=t[c++],a=t[c++],r+=z0.charAt(o>>2),r+=z0.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=z0.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":z0.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};J.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var o,s,a,c,l=0,u=r;l<t.length;)o=$0[t.charCodeAt(l++)-43],s=$0[t.charCodeAt(l++)-43],a=$0[t.charCodeAt(l++)-43],c=$0[t.charCodeAt(l++)-43],n[u++]=o<<2|s>>4,a!==64&&(n[u++]=(s&15)<<4|a>>2,c!==64&&(n[u++]=(a&3)<<6|c));return e?u-r:n.subarray(0,u)};J.binary.base58.encode=function(t,e){return J.binary.baseN.encode(t,sIe,e)};J.binary.base58.decode=function(t,e){return J.binary.baseN.decode(t,sIe,e)};J.text={utf8:{},utf16:{}};J.text.utf8.encode=function(t,e,r){t=J.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};J.text.utf8.decode=function(t){return J.decodeUtf8(String.fromCharCode.apply(null,t))};J.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var o=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,c=0;c<t.length;++c)o[a++]=t.charCodeAt(c),s+=2;return e?s-r:n};J.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};J.deflate=function(t,e,r){if(e=J.decode64(t.deflate(J.encode64(e)).rval),r){var n=2,o=e.charCodeAt(1);o&32&&(n=6),e=e.substring(n,e.length-4)}return e};J.inflate=function(t,e,r){var n=t.inflate(J.encode64(e)).rval;return n===null?null:J.decode64(n)};var tee=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=J.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var o=new Error(n.error.message);throw o.id=n.error.id,o.name=n.error.name,o}},ree=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(J.decode64(r))),r},hnt=function(t,e,r,n){var o=ree(t,e);o===null&&(o={}),o[r]=n,tee(t,e,o)},gnt=function(t,e,r){var n=ree(t,e);return n!==null&&(n=r in n?n[r]:null),n},vnt=function(t,e,r){var n=ree(t,e);if(n!==null&&r in n){delete n[r];var o=!0;for(var s in n){o=!1;break}o&&(n=null),tee(t,e,n)}},ynt=function(t,e){tee(t,e,null)},m7=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var o,s=!1,a=null;for(var c in r){o=r[c];try{if(o==="flash"||o==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=o==="flash"}(o==="web"||o==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(l){a=l}if(s)break}if(!s)throw a;return n};J.setItem=function(t,e,r,n,o){m7(hnt,arguments,o)};J.getItem=function(t,e,r,n){return m7(gnt,arguments,n)};J.removeItem=function(t,e,r,n){m7(vnt,arguments,n)};J.clearItems=function(t,e,r){m7(ynt,arguments,r)};J.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};J.format=function(t){for(var e=/%./g,r,n,o=0,s=[],a=0;r=e.exec(t);){n=t.substring(a,e.lastIndex-2),n.length>0&&s.push(n),a=e.lastIndex;var c=r[0][1];switch(c){case"s":case"o":o<arguments.length?s.push(arguments[o+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+c+"?>")}}return s.push(t.substring(a)),s.join("")};J.formatNumber=function(t,e,r,n){var o=t,s=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,c=n===void 0?".":n,l=o<0?"-":"",u=parseInt(o=Math.abs(+o||0).toFixed(s),10)+"",d=u.length>3?u.length%3:0;return l+(d?u.substr(0,d)+c:"")+u.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+c)+(s?a+Math.abs(o-u).toFixed(s).slice(2):"")};J.formatSize=function(t){return t>=1073741824?t=J.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=J.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=J.formatNumber(t/1024,0)+" KiB":t=J.formatNumber(t,0)+" bytes",t};J.bytesFromIP=function(t){return t.indexOf(".")!==-1?J.bytesFromIPv4(t):t.indexOf(":")!==-1?J.bytesFromIPv6(t):null};J.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=J.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};J.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=J.createBuffer(),o=0;o<8;++o){if(!t[o]||t[o].length===0){n.fillWithByte(0,r),r=0;continue}var s=J.hexToBytes(t[o]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};J.bytesToIP=function(t){return t.length===4?J.bytesToIPv4(t):t.length===16?J.bytesToIPv6(t):null};J.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};J.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,o=0;o<t.length;o+=2){for(var s=J.bytesToHex(t[o]+t[o+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],c=e.length;!a||c!==a.end+1?r.push({start:c,end:c}):(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var l=r[n];l.end-l.start>0&&(e.splice(l.start,l.end-l.start+1,""),l.start===0&&e.unshift(""),l.end===7&&e.push(""))}return e.join(":")};J.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in J&&!t.update)return e(null,J.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return J.cores=navigator.hardwareConcurrency,e(null,J.cores);if(typeof Worker>"u")return J.cores=1,e(null,J.cores);if(typeof Blob>"u")return J.cores=2,e(null,J.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var c=Date.now(),l=c+4;Date.now()<l;);self.postMessage({st:c,et:l})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,c,l){if(c===0){var u=Math.floor(a.reduce(function(d,p){return d+p},0)/a.length);return J.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,J.cores)}o(l,function(d,p){a.push(s(l,p)),n(a,c-1,l)})}function o(a,c){for(var l=[],u=[],d=0;d<a;++d){var p=new Worker(r);p.addEventListener("message",function(f){if(u.push(f.data),u.length===a){for(var m=0;m<a;++m)l[m].terminate();c(null,u)}}),l.push(p)}for(var d=0;d<a;++d)l[d].postMessage(d)}function s(a,c){for(var l=[],u=0;u<a;++u)for(var d=c[u],p=l[u]=[],f=0;f<a;++f)if(u!==f){var m=c[f];(d.st>m.st&&d.st<m.et||m.st>d.st&&m.st<d.et)&&p.push(f)}return l.reduce(function(h,g){return Math.max(h,g.length)},0)}}});var h7=R((A1r,cIe)=>{var _s=dr();Qr();cIe.exports=_s.cipher=_s.cipher||{};_s.cipher.algorithms=_s.cipher.algorithms||{};_s.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=_s.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new _s.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};_s.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=_s.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new _s.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};_s.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),_s.cipher.algorithms[t]=e};_s.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in _s.cipher.algorithms?_s.cipher.algorithms[t]:null};var nee=_s.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};nee.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=_s.util.createBuffer(),this.output=t.output||_s.util.createBuffer(),this.mode.start(e)};nee.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};nee.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var oee=R((D1r,lIe)=>{var xs=dr();Qr();xs.cipher=xs.cipher||{};var wr=lIe.exports=xs.cipher.modes=xs.cipher.modes||{};wr.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};wr.ecb.prototype.start=function(t){};wr.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};wr.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};wr.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};wr.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};wr.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};wr.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=g7(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};wr.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};wr.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};wr.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};wr.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};wr.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=xs.util.createBuffer(),this._partialBytes=0};wr.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=g7(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};wr.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32()^this._outBlock[o],e.putInt32(this._inBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32()^this._outBlock[o],this._partialOutput.putInt32(this._partialBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};wr.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32(),e.putInt32(this._inBlock[o]^this._outBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};wr.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=xs.util.createBuffer(),this._partialBytes=0};wr.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=g7(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};wr.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]),this._inBlock[o]=this._outBlock[o];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._outBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};wr.ofb.prototype.decrypt=wr.ofb.prototype.encrypt;wr.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=xs.util.createBuffer(),this._partialBytes=0};wr.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=g7(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};wr.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}v7(this._inBlock)};wr.ctr.prototype.decrypt=wr.ctr.prototype.encrypt;wr.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=xs.util.createBuffer(),this._partialBytes=0,this._R=3774873600};wr.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=xs.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=xs.util.createBuffer(t.additionalData):r=xs.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=xs.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(iee(n*8)))}this._inBlock=this._j0.slice(0),v7(this._inBlock),this._partialBytes=0,r=xs.util.createBuffer(r),this._aDataLength=iee(r.length()*8);var o=r.length()%this.blockSize;for(o&&r.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};wr.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),v7(this._inBlock)};wr.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),v7(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^this._hashBlock[o]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};wr.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=xs.util.createBuffer();var n=this._aDataLength.concat(iee(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};wr.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),o=0;o<128;++o){var s=t[o/32|0]&1<<31-o%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};wr.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};wr.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,o=t[n]>>>(7-r%8)*4&15,s=this._m[r][o];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};wr.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};wr.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,o=16*r,s=new Array(o),a=0;a<o;++a){var c=[0,0,0,0],l=a/n|0,u=(n-1-a%n)*e;c[l]=1<<e-1<<u,s[a]=this.generateSubHashTable(this.multiply(c,t),e)}return s};wr.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,o=new Array(r);o[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(o[2*s],o[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var c=o[s],l=o[a];o[s+a]=[c[0]^l[0],c[1]^l[1],c[2]^l[2],c[3]^l[3]]}s*=2}for(o[0]=[0,0,0,0],s=n+1;s<r;++s){var u=o[s^n];o[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return o};function g7(t,e){if(typeof t=="string"&&(t=xs.util.createBuffer(t)),xs.util.isArray(t)&&t.length>4){var r=t;t=xs.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!xs.util.isArray(t)){for(var o=[],s=e/4,n=0;n<s;++n)o.push(t.getInt32());t=o}return t}function v7(t){t[t.length-1]=t[t.length-1]+1&4294967295}function iee(t){return[t/4294967296|0,t&4294967295]}});var W0=R((N1r,fIe)=>{var Vn=dr();h7();oee();Qr();fIe.exports=Vn.aes=Vn.aes||{};Vn.aes.startEncrypting=function(t,e,r,n){var o=y7({key:t,output:r,decrypt:!1,mode:n});return o.start(e),o};Vn.aes.createEncryptionCipher=function(t,e){return y7({key:t,output:null,decrypt:!1,mode:e})};Vn.aes.startDecrypting=function(t,e,r,n){var o=y7({key:t,output:r,decrypt:!0,mode:n});return o.start(e),o};Vn.aes.createDecryptionCipher=function(t,e){return y7({key:t,output:null,decrypt:!0,mode:e})};Vn.aes.Algorithm=function(t,e){cee||dIe();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,o){return aee(r._w,n,o,!1)},decrypt:function(n,o){return aee(r._w,n,o,!0)}}}),r._init=!1};Vn.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Vn.util.createBuffer(e);else if(Vn.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Vn.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Vn.util.isArray(e)){r=e,e=[];var o=r.length();if(o===16||o===24||o===32){o=o>>>2;for(var n=0;n<o;++n)e.push(r.getInt32())}}if(!Vn.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=pIe(e,t.decrypt&&!a),this._init=!0}};Vn.aes._expandKey=function(t,e){return cee||dIe(),pIe(t,e)};Vn.aes._updateBlock=aee;vE("AES-ECB",Vn.cipher.modes.ecb);vE("AES-CBC",Vn.cipher.modes.cbc);vE("AES-CFB",Vn.cipher.modes.cfb);vE("AES-OFB",Vn.cipher.modes.ofb);vE("AES-CTR",Vn.cipher.modes.ctr);vE("AES-GCM",Vn.cipher.modes.gcm);function vE(t,e){var r=function(){return new Vn.aes.Algorithm(t,e)};Vn.cipher.registerAlgorithm(t,r)}var cee=!1,gE=4,Ma,see,uIe,Ix,Nd;function dIe(){cee=!0,uIe=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Ma=new Array(256),see=new Array(256),Ix=new Array(4),Nd=new Array(4);for(var e=0;e<4;++e)Ix[e]=new Array(256),Nd[e]=new Array(256);for(var r=0,n=0,o,s,a,c,l,u,d,e=0;e<256;++e){c=n^n<<1^n<<2^n<<3^n<<4,c=c>>8^c&255^99,Ma[r]=c,see[c]=r,l=t[c],o=t[r],s=t[o],a=t[s],u=l<<24^c<<16^c<<8^(c^l),d=(o^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^o^a);for(var p=0;p<4;++p)Ix[p][r]=u,Nd[p][c]=d,u=u<<24|u>>>8,d=d<<24|d>>>8;r===0?r=n=1:(r=o^t[t[t[o^a]]],n^=t[t[n]])}}function pIe(t,e){for(var r=t.slice(0),n,o=1,s=r.length,a=s+6+1,c=gE*a,l=s;l<c;++l)n=r[l-1],l%s===0?(n=Ma[n>>>16&255]<<24^Ma[n>>>8&255]<<16^Ma[n&255]<<8^Ma[n>>>24]^uIe[o]<<24,o++):s>6&&l%s===4&&(n=Ma[n>>>24]<<24^Ma[n>>>16&255]<<16^Ma[n>>>8&255]<<8^Ma[n&255]),r[l]=r[l-s]^n;if(e){var u,d=Nd[0],p=Nd[1],f=Nd[2],m=Nd[3],h=r.slice(0);c=r.length;for(var l=0,g=c-gE;l<c;l+=gE,g-=gE)if(l===0||l===c-gE)h[l]=r[g],h[l+1]=r[g+3],h[l+2]=r[g+2],h[l+3]=r[g+1];else for(var v=0;v<gE;++v)u=r[g+v],h[l+(3&-v)]=d[Ma[u>>>24]]^p[Ma[u>>>16&255]]^f[Ma[u>>>8&255]]^m[Ma[u&255]];r=h}return r}function aee(t,e,r,n){var o=t.length/4-1,s,a,c,l,u;n?(s=Nd[0],a=Nd[1],c=Nd[2],l=Nd[3],u=see):(s=Ix[0],a=Ix[1],c=Ix[2],l=Ix[3],u=Ma);var d,p,f,m,h,g,v;d=e[0]^t[0],p=e[n?3:1]^t[1],f=e[2]^t[2],m=e[n?1:3]^t[3];for(var b=3,_=1;_<o;++_)h=s[d>>>24]^a[p>>>16&255]^c[f>>>8&255]^l[m&255]^t[++b],g=s[p>>>24]^a[f>>>16&255]^c[m>>>8&255]^l[d&255]^t[++b],v=s[f>>>24]^a[m>>>16&255]^c[d>>>8&255]^l[p&255]^t[++b],m=s[m>>>24]^a[d>>>16&255]^c[p>>>8&255]^l[f&255]^t[++b],d=h,p=g,f=v;r[0]=u[d>>>24]<<24^u[p>>>16&255]<<16^u[f>>>8&255]<<8^u[m&255]^t[++b],r[n?3:1]=u[p>>>24]<<24^u[f>>>16&255]<<16^u[m>>>8&255]<<8^u[d&255]^t[++b],r[2]=u[f>>>24]<<24^u[m>>>16&255]<<16^u[d>>>8&255]<<8^u[p&255]^t[++b],r[n?1:3]=u[m>>>24]<<24^u[d>>>16&255]<<16^u[p>>>8&255]<<8^u[f&255]^t[++b]}function y7(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Vn.cipher.createDecipher(r,t.key):n=Vn.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,a){var c=null;a instanceof Vn.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(n,a)},n}});var K0=R((L1r,mIe)=>{var JN=dr();JN.pki=JN.pki||{};var lee=mIe.exports=JN.pki.oids=JN.oids=JN.oids||{};function Fe(t,e){lee[t]=e,lee[e]=t}function vn(t,e){lee[t]=e}Fe("1.2.840.113549.1.1.1","rsaEncryption");Fe("1.2.840.113549.1.1.4","md5WithRSAEncryption");Fe("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Fe("1.2.840.113549.1.1.7","RSAES-OAEP");Fe("1.2.840.113549.1.1.8","mgf1");Fe("1.2.840.113549.1.1.9","pSpecified");Fe("1.2.840.113549.1.1.10","RSASSA-PSS");Fe("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Fe("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Fe("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Fe("1.3.101.112","EdDSA25519");Fe("1.2.840.10040.4.3","dsa-with-sha1");Fe("1.3.14.3.2.7","desCBC");Fe("1.3.14.3.2.26","sha1");Fe("1.3.14.3.2.29","sha1WithRSASignature");Fe("2.16.840.1.101.3.4.2.1","sha256");Fe("2.16.840.1.101.3.4.2.2","sha384");Fe("2.16.840.1.101.3.4.2.3","sha512");Fe("2.16.840.1.101.3.4.2.4","sha224");Fe("2.16.840.1.101.3.4.2.5","sha512-224");Fe("2.16.840.1.101.3.4.2.6","sha512-256");Fe("1.2.840.113549.2.2","md2");Fe("1.2.840.113549.2.5","md5");Fe("1.2.840.113549.1.7.1","data");Fe("1.2.840.113549.1.7.2","signedData");Fe("1.2.840.113549.1.7.3","envelopedData");Fe("1.2.840.113549.1.7.4","signedAndEnvelopedData");Fe("1.2.840.113549.1.7.5","digestedData");Fe("1.2.840.113549.1.7.6","encryptedData");Fe("1.2.840.113549.1.9.1","emailAddress");Fe("1.2.840.113549.1.9.2","unstructuredName");Fe("1.2.840.113549.1.9.3","contentType");Fe("1.2.840.113549.1.9.4","messageDigest");Fe("1.2.840.113549.1.9.5","signingTime");Fe("1.2.840.113549.1.9.6","counterSignature");Fe("1.2.840.113549.1.9.7","challengePassword");Fe("1.2.840.113549.1.9.8","unstructuredAddress");Fe("1.2.840.113549.1.9.14","extensionRequest");Fe("1.2.840.113549.1.9.20","friendlyName");Fe("1.2.840.113549.1.9.21","localKeyId");Fe("1.2.840.113549.1.9.22.1","x509Certificate");Fe("1.2.840.113549.1.12.10.1.1","keyBag");Fe("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Fe("1.2.840.113549.1.12.10.1.3","certBag");Fe("1.2.840.113549.1.12.10.1.4","crlBag");Fe("1.2.840.113549.1.12.10.1.5","secretBag");Fe("1.2.840.113549.1.12.10.1.6","safeContentsBag");Fe("1.2.840.113549.1.5.13","pkcs5PBES2");Fe("1.2.840.113549.1.5.12","pkcs5PBKDF2");Fe("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Fe("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Fe("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Fe("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Fe("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Fe("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Fe("1.2.840.113549.2.7","hmacWithSHA1");Fe("1.2.840.113549.2.8","hmacWithSHA224");Fe("1.2.840.113549.2.9","hmacWithSHA256");Fe("1.2.840.113549.2.10","hmacWithSHA384");Fe("1.2.840.113549.2.11","hmacWithSHA512");Fe("1.2.840.113549.3.7","des-EDE3-CBC");Fe("2.16.840.1.101.3.4.1.2","aes128-CBC");Fe("2.16.840.1.101.3.4.1.22","aes192-CBC");Fe("2.16.840.1.101.3.4.1.42","aes256-CBC");Fe("2.5.4.3","commonName");Fe("2.5.4.4","surname");Fe("2.5.4.5","serialNumber");Fe("2.5.4.6","countryName");Fe("2.5.4.7","localityName");Fe("2.5.4.8","stateOrProvinceName");Fe("2.5.4.9","streetAddress");Fe("2.5.4.10","organizationName");Fe("2.5.4.11","organizationalUnitName");Fe("2.5.4.12","title");Fe("2.5.4.13","description");Fe("2.5.4.15","businessCategory");Fe("2.5.4.17","postalCode");Fe("2.5.4.42","givenName");Fe("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Fe("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Fe("2.16.840.1.113730.1.1","nsCertType");Fe("2.16.840.1.113730.1.13","nsComment");vn("2.5.29.1","authorityKeyIdentifier");vn("2.5.29.2","keyAttributes");vn("2.5.29.3","certificatePolicies");vn("2.5.29.4","keyUsageRestriction");vn("2.5.29.5","policyMapping");vn("2.5.29.6","subtreesConstraint");vn("2.5.29.7","subjectAltName");vn("2.5.29.8","issuerAltName");vn("2.5.29.9","subjectDirectoryAttributes");vn("2.5.29.10","basicConstraints");vn("2.5.29.11","nameConstraints");vn("2.5.29.12","policyConstraints");vn("2.5.29.13","basicConstraints");Fe("2.5.29.14","subjectKeyIdentifier");Fe("2.5.29.15","keyUsage");vn("2.5.29.16","privateKeyUsagePeriod");Fe("2.5.29.17","subjectAltName");Fe("2.5.29.18","issuerAltName");Fe("2.5.29.19","basicConstraints");vn("2.5.29.20","cRLNumber");vn("2.5.29.21","cRLReason");vn("2.5.29.22","expirationDate");vn("2.5.29.23","instructionCode");vn("2.5.29.24","invalidityDate");vn("2.5.29.25","cRLDistributionPoints");vn("2.5.29.26","issuingDistributionPoint");vn("2.5.29.27","deltaCRLIndicator");vn("2.5.29.28","issuingDistributionPoint");vn("2.5.29.29","certificateIssuer");vn("2.5.29.30","nameConstraints");Fe("2.5.29.31","cRLDistributionPoints");Fe("2.5.29.32","certificatePolicies");vn("2.5.29.33","policyMappings");vn("2.5.29.34","policyConstraints");Fe("2.5.29.35","authorityKeyIdentifier");vn("2.5.29.36","policyConstraints");Fe("2.5.29.37","extKeyUsage");vn("2.5.29.46","freshestCRL");vn("2.5.29.54","inhibitAnyPolicy");Fe("1.3.6.1.4.1.11129.2.4.2","timestampList");Fe("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Fe("1.3.6.1.5.5.7.3.1","serverAuth");Fe("1.3.6.1.5.5.7.3.2","clientAuth");Fe("1.3.6.1.5.5.7.3.3","codeSigning");Fe("1.3.6.1.5.5.7.3.4","emailProtection");Fe("1.3.6.1.5.5.7.3.8","timeStamping")});var Ld=R((O1r,gIe)=>{var ei=dr();Qr();K0();var tt=gIe.exports=ei.asn1=ei.asn1||{};tt.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};tt.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};tt.create=function(t,e,r,n,o){if(ei.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var c={tagClass:t,type:e,constructed:r,composed:r||ei.util.isArray(n),value:n};return o&&"bitStringContents"in o&&(c.bitStringContents=o.bitStringContents,c.original=tt.copy(c)),c};tt.copy=function(t,e){var r;if(ei.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(tt.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:tt.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};tt.equals=function(t,e,r){if(ei.util.isArray(t)){if(!ei.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!tt.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var o=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&tt.equals(t.value,e.value);return r&&r.includeBitStringContents&&(o=o&&t.bitStringContents===e.bitStringContents),o};tt.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function ZN(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var bnt=function(t,e){var r=t.getByte();if(e--,r!==128){var n,o=r&128;if(!o)n=r;else{var s=r&127;ZN(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};tt.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ei.util.createBuffer(t));var r=t.length(),n=b7(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var o=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw o.byteCount=r,o.remaining=t.length(),o}return n};function b7(t,e,r,n){var o;ZN(t,e,2);var s=t.getByte();e--;var a=s&192,c=s&31;o=t.length();var l=bnt(t,e);if(e-=o-t.length(),l!==void 0&&l>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=l,u}l=e}var d,p,f=(s&32)===32;if(f)if(d=[],l===void 0)for(;;){if(ZN(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}o=t.length(),d.push(b7(t,e,r+1,n)),e-=o-t.length()}else for(;l>0;)o=t.length(),d.push(b7(t,l,r+1,n)),e-=o-t.length(),l-=o-t.length();if(d===void 0&&a===tt.Class.UNIVERSAL&&c===tt.Type.BITSTRING&&(p=t.bytes(l)),d===void 0&&n.decodeBitStrings&&a===tt.Class.UNIVERSAL&&c===tt.Type.BITSTRING&&l>1){var m=t.read,h=e,g=0;if(c===tt.Type.BITSTRING&&(ZN(t,e,1),g=t.getByte(),e--),g===0)try{o=t.length();var v={strict:!0,decodeBitStrings:!0},b=b7(t,e,r+1,v),_=o-t.length();e-=_,c==tt.Type.BITSTRING&&_++;var x=b.tagClass;_===l&&(x===tt.Class.UNIVERSAL||x===tt.Class.CONTEXT_SPECIFIC)&&(d=[b])}catch{}d===void 0&&(t.read=m,e=h)}if(d===void 0){if(l===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");l=e}if(c===tt.Type.BMPSTRING)for(d="";l>0;l-=2)ZN(t,e,2),d+=String.fromCharCode(t.getInt16()),e-=2;else d=t.getBytes(l),e-=l}var S=p===void 0?null:{bitStringContents:p};return tt.create(a,c,f,d,S)}tt.toDer=function(t){var e=ei.util.createBuffer(),r=t.tagClass|t.type,n=ei.util.createBuffer(),o=!1;if("bitStringContents"in t&&(o=!0,t.original&&(o=tt.equals(t,t.original))),o)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(tt.toDer(t.value[s]))}else if(t.type===tt.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===tt.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var a=n.length(),c="";do c+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(c.length|128);for(var s=c.length-1;s>=0;--s)e.putByte(c.charCodeAt(s))}return e.putBuffer(n),e};tt.oidToDer=function(t){var e=t.split("."),r=ei.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,o,s,a,c=2;c<e.length;++c){n=!0,o=[],s=parseInt(e[c],10);do a=s&127,s=s>>>7,n||(a|=128),o.push(a),n=!1;while(s>0);for(var l=o.length-1;l>=0;--l)r.putByte(o[l])}return r};tt.derToOid=function(t){var e;typeof t=="string"&&(t=ei.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};tt.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,o=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),c=0;if(t.length>11){var l=t.charAt(10),u=10;l!=="+"&&l!=="-"&&(c=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,o),e.setUTCHours(s,a,c,0),u&&(l=t.charAt(u),l==="+"||l==="-")){var d=parseInt(t.substr(u+1,2),10),p=parseInt(t.substr(u+4,2),10),f=d*60+p;f*=6e4,l==="+"?e.setTime(+e-f):e.setTime(+e+f)}return e};tt.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),c=parseInt(t.substr(12,2),10),l=0,u=0,d=!1;t.charAt(t.length-1)==="Z"&&(d=!0);var p=t.length-5,f=t.charAt(p);if(f==="+"||f==="-"){var m=parseInt(t.substr(p+1,2),10),h=parseInt(t.substr(p+4,2),10);u=m*60+h,u*=6e4,f==="+"&&(u*=-1),d=!0}return t.charAt(14)==="."&&(l=parseFloat(t.substr(14),10)*1e3),d?(e.setUTCFullYear(r,n,o),e.setUTCHours(s,a,c,l),e.setTime(+e+u)):(e.setFullYear(r,n,o),e.setHours(s,a,c,l)),e};tt.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};tt.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};tt.integerToDer=function(t){var e=ei.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};tt.derToInteger=function(t){typeof t=="string"&&(t=ei.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};tt.validate=function(t,e,r,n){var o=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(o=!0,e.value&&ei.util.isArray(e.value))for(var s=0,a=0;o&&a<e.value.length;++a)o=e.value[a].optional||!1,t.value[s]&&(o=tt.validate(t.value[s],e.value[a],r,n),o?++s:e.value[a].optional&&(o=!0)),!o&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(o&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var c;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var l=t.bitStringContents.charCodeAt(0);if(l!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return o};var hIe=/[^\\u0000-\\u00ff]/;tt.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var o="",s=0;s<e*r;++s)o+=" ";switch(n+=o+"Tag: ",t.tagClass){case tt.Class.UNIVERSAL:n+="Universal:";break;case tt.Class.APPLICATION:n+="Application:";break;case tt.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case tt.Class.PRIVATE:n+="Private:";break}if(t.tagClass===tt.Class.UNIVERSAL)switch(n+=t.type,t.type){case tt.Type.NONE:n+=" (None)";break;case tt.Type.BOOLEAN:n+=" (Boolean)";break;case tt.Type.INTEGER:n+=" (Integer)";break;case tt.Type.BITSTRING:n+=" (Bit string)";break;case tt.Type.OCTETSTRING:n+=" (Octet string)";break;case tt.Type.NULL:n+=" (Null)";break;case tt.Type.OID:n+=" (Object Identifier)";break;case tt.Type.ODESC:n+=" (Object Descriptor)";break;case tt.Type.EXTERNAL:n+=" (External or Instance of)";break;case tt.Type.REAL:n+=" (Real)";break;case tt.Type.ENUMERATED:n+=" (Enumerated)";break;case tt.Type.EMBEDDED:n+=" (Embedded PDV)";break;case tt.Type.UTF8:n+=" (UTF8)";break;case tt.Type.ROID:n+=" (Relative Object Identifier)";break;case tt.Type.SEQUENCE:n+=" (Sequence)";break;case tt.Type.SET:n+=" (Set)";break;case tt.Type.PRINTABLESTRING:n+=" (Printable String)";break;case tt.Type.IA5String:n+=" (IA5String (ASCII))";break;case tt.Type.UTCTIME:n+=" (UTC time)";break;case tt.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case tt.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=o+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,c="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(a+=1,c+=tt.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(c+=","));n+=o+"Sub values: "+a+c}else{if(n+=o+"Value: ",t.type===tt.Type.OID){var l=tt.derToOid(t.value);n+=l,ei.pki&&ei.pki.oids&&l in ei.pki.oids&&(n+=" ("+ei.pki.oids[l]+") ")}if(t.type===tt.Type.INTEGER)try{n+=tt.derToInteger(t.value)}catch{n+="0x"+ei.util.bytesToHex(t.value)}else if(t.type===tt.Type.BITSTRING){if(t.value.length>1?n+="0x"+ei.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===tt.Type.OCTETSTRING)hIe.test(t.value)||(n+="("+t.value+") "),n+="0x"+ei.util.bytesToHex(t.value);else if(t.type===tt.Type.UTF8)try{n+=ei.util.decodeUtf8(t.value)}catch(d){if(d.message==="URI malformed")n+="0x"+ei.util.bytesToHex(t.value)+" (malformed UTF8)";else throw d}else t.type===tt.Type.PRINTABLESTRING||t.type===tt.Type.IA5String?n+=t.value:hIe.test(t.value)?n+="0x"+ei.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var af=R((M1r,vIe)=>{var _7=dr();vIe.exports=_7.md=_7.md||{};_7.md.algorithms=_7.md.algorithms||{}});var yE=R((F1r,yIe)=>{var _h=dr();af();Qr();var _nt=yIe.exports=_h.hmac=_h.hmac||{};_nt.create=function(){var t=null,e=null,r=null,n=null,o={};return o.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in _h.md.algorithms)e=_h.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=t;else{if(typeof a=="string")a=_h.util.createBuffer(a);else if(_h.util.isArray(a)){var c=a;a=_h.util.createBuffer();for(var l=0;l<c.length;++l)a.putByte(c[l])}var u=a.length();u>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=_h.util.createBuffer(),n=_h.util.createBuffer(),u=a.length();for(var l=0;l<u;++l){var c=a.at(l);r.putByte(54^c),n.putByte(92^c)}if(u<e.blockLength)for(var c=e.blockLength-u,l=0;l<c;++l)r.putByte(54),n.putByte(92);t=a,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},o.update=function(s){e.update(s)},o.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},o.digest=o.getMac,o}});var S7=R((U1r,SIe)=>{var cf=dr();af();Qr();var _Ie=SIe.exports=cf.md5=cf.md5||{};cf.md.md5=cf.md.algorithms.md5=_Ie;_Ie.create=function(){xIe||xnt();var t=null,e=cf.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=cf.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=cf.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),bIe(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=cf.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(uee.substr(0,n.blockLength-a));for(var c,l=0,u=n.fullMessageLength.length-1;u>=0;--u)c=n.fullMessageLength[u]*8+l,l=c/4294967296>>>0,o.putInt32Le(c>>>0);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3};bIe(d,r,o);var p=cf.util.createBuffer();return p.putInt32Le(d.h0),p.putInt32Le(d.h1),p.putInt32Le(d.h2),p.putInt32Le(d.h3),p},n};var uee=null,x7=null,eL=null,bE=null,xIe=!1;function xnt(){uee="\x80",uee+=cf.util.fillString("\0",64),x7=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],eL=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],bE=new Array(64);for(var t=0;t<64;++t)bE[t]=Math.floor(Math.abs(Math.sin(t+1))*4294967296);xIe=!0}function bIe(t,e,r){for(var n,o,s,a,c,l,u,d,p=r.length();p>=64;){for(o=t.h0,s=t.h1,a=t.h2,c=t.h3,d=0;d<16;++d)e[d]=r.getInt32Le(),l=c^s&(a^c),n=o+l+bE[d]+e[d],u=eL[d],o=c,c=a,a=s,s+=n<<u|n>>>32-u;for(;d<32;++d)l=a^c&(s^a),n=o+l+bE[d]+e[x7[d]],u=eL[d],o=c,c=a,a=s,s+=n<<u|n>>>32-u;for(;d<48;++d)l=s^a^c,n=o+l+bE[d]+e[x7[d]],u=eL[d],o=c,c=a,a=s,s+=n<<u|n>>>32-u;for(;d<64;++d)l=a^(s|~c),n=o+l+bE[d]+e[x7[d]],u=eL[d],o=c,c=a,a=s,s+=n<<u|n>>>32-u;t.h0=t.h0+o|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,p-=64}}});var Cx=R((B1r,CIe)=>{var C7=dr();Qr();var IIe=CIe.exports=C7.pem=C7.pem||{};IIe.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=I7(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=I7(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=I7(n)),t.headers)for(var o=0;o<t.headers.length;++o)r+=I7(t.headers[o]);return t.procType&&(r+=`\r
`),r+=C7.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};IIe.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/,s;s=r.exec(t),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var c={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:C7.util.decode64(s[3])};if(e.push(c),!!s[2]){for(var l=s[2].split(o),u=0;s&&u<l.length;){for(var d=l[u].replace(/\s+$/,""),p=u+1;p<l.length;++p){var f=l[p];if(!/\s/.test(f[0]))break;d+=f,u=p}if(s=d.match(n),s){for(var m={name:s[1],values:[]},h=s[2].split(","),g=0;g<h.length;++g)m.values.push(Snt(h[g]));if(c.procType)if(!c.contentDomain&&m.name==="Content-Domain")c.contentDomain=h[0]||"";else if(!c.dekInfo&&m.name==="DEK-Info"){if(m.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:h[0],parameters:h[1]||null}}else c.headers.push(m);else{if(m.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(m.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:h[0],type:h[1]}}}++u}if(c.procType==="ENCRYPTED"&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function I7(t){for(var e=t.name+": ",r=[],n=function(l,u){return" "+u},o=0;o<t.values.length;++o)r.push(t.values[o].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,a=-1,o=0;o<e.length;++o,++s)if(s>65&&a!==-1){var c=e[a];c===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+c+e.substr(a+1),s=o-a-1,a=-1,++o}else(e[o]===" "||e[o]==="	"||e[o]===",")&&(a=o);return e}function Snt(t){return t.replace(/^\s+/,"")}});var tL=R((q1r,EIe)=>{var di=dr();h7();oee();Qr();EIe.exports=di.des=di.des||{};di.des.startEncrypting=function(t,e,r,n){var o=T7({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};di.des.createEncryptionCipher=function(t,e){return T7({key:t,output:null,decrypt:!1,mode:e})};di.des.startDecrypting=function(t,e,r,n){var o=T7({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};di.des.createDecryptionCipher=function(t,e){return T7({key:t,output:null,decrypt:!0,mode:e})};di.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,o){return TIe(r._keys,n,o,!1)},decrypt:function(n,o){return TIe(r._keys,n,o,!0)}}}),r._init=!1};di.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=di.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Ant(e),this._init=!0}};lf("DES-ECB",di.cipher.modes.ecb);lf("DES-CBC",di.cipher.modes.cbc);lf("DES-CFB",di.cipher.modes.cfb);lf("DES-OFB",di.cipher.modes.ofb);lf("DES-CTR",di.cipher.modes.ctr);lf("3DES-ECB",di.cipher.modes.ecb);lf("3DES-CBC",di.cipher.modes.cbc);lf("3DES-CFB",di.cipher.modes.cfb);lf("3DES-OFB",di.cipher.modes.ofb);lf("3DES-CTR",di.cipher.modes.ctr);function lf(t,e){var r=function(){return new di.des.Algorithm(t,e)};di.cipher.registerAlgorithm(t,r)}var Int=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Cnt=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Tnt=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Ent=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],wnt=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],knt=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Rnt=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Pnt=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Ant(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],m=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],_=0,x,S=0;S<g;S++){var I=t.getInt32(),w=t.getInt32();x=(I>>>4^w)&252645135,w^=x,I^=x<<4,x=(w>>>-16^I)&65535,I^=x,w^=x<<-16,x=(I>>>2^w)&858993459,w^=x,I^=x<<2,x=(w>>>-16^I)&65535,I^=x,w^=x<<-16,x=(I>>>1^w)&1431655765,w^=x,I^=x<<1,x=(w>>>8^I)&16711935,I^=x,w^=x<<8,x=(I>>>1^w)&1431655765,w^=x,I^=x<<1,x=I<<8|w>>>20&240,I=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=x;for(var k=0;k<b.length;++k){b[k]?(I=I<<2|I>>>26,w=w<<2|w>>>26):(I=I<<1|I>>>27,w=w<<1|w>>>27),I&=-15,w&=-15;var M=e[I>>>28]|r[I>>>24&15]|n[I>>>20&15]|o[I>>>16&15]|s[I>>>12&15]|a[I>>>8&15]|c[I>>>4&15],H=l[w>>>28]|u[w>>>24&15]|d[w>>>20&15]|p[w>>>16&15]|f[w>>>12&15]|m[w>>>8&15]|h[w>>>4&15];x=(H>>>16^M)&65535,v[_++]=M^x,v[_++]=H^x<<16}}return v}function TIe(t,e,r,n){var o=t.length===32?3:9,s;o===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,c=e[0],l=e[1];a=(c>>>4^l)&252645135,l^=a,c^=a<<4,a=(c>>>16^l)&65535,l^=a,c^=a<<16,a=(l>>>2^c)&858993459,c^=a,l^=a<<2,a=(l>>>8^c)&16711935,c^=a,l^=a<<8,a=(c>>>1^l)&1431655765,l^=a,c^=a<<1,c=c<<1|c>>>31,l=l<<1|l>>>31;for(var u=0;u<o;u+=3){for(var d=s[u+1],p=s[u+2],f=s[u];f!=d;f+=p){var m=l^t[f],h=(l>>>4|l<<28)^t[f+1];a=c,c=l,l=a^(Cnt[m>>>24&63]|Ent[m>>>16&63]|knt[m>>>8&63]|Pnt[m&63]|Int[h>>>24&63]|Tnt[h>>>16&63]|wnt[h>>>8&63]|Rnt[h&63])}a=c,c=l,l=a}c=c>>>1|c<<31,l=l>>>1|l<<31,a=(c>>>1^l)&1431655765,l^=a,c^=a<<1,a=(l>>>8^c)&16711935,c^=a,l^=a<<8,a=(l>>>2^c)&858993459,c^=a,l^=a<<2,a=(c>>>16^l)&65535,l^=a,c^=a<<16,a=(c>>>4^l)&252645135,l^=a,c^=a<<4,r[0]=c,r[1]=l}function T7(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=di.cipher.createDecipher(r,t.key):n=di.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,a){var c=null;a instanceof di.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(n,a)},n}});var E7=R((j1r,wIe)=>{var Fa=dr();yE();af();Qr();var Dnt=Fa.pkcs5=Fa.pkcs5||{},xh;Fa.util.isNodejs&&!Fa.options.usePureJavaScript&&(xh=require("crypto"));wIe.exports=Fa.pbkdf2=Dnt.pbkdf2=function(t,e,r,n,o,s){if(typeof o=="function"&&(s=o,o=null),Fa.util.isNodejs&&!Fa.options.usePureJavaScript&&xh.pbkdf2&&(o===null||typeof o!="object")&&(xh.pbkdf2Sync.length>4||!o||o==="sha1"))return typeof o!="string"&&(o="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?xh.pbkdf2Sync.length===4?xh.pbkdf2(t,e,r,n,function(x,S){if(x)return s(x);s(null,S.toString("binary"))}):xh.pbkdf2(t,e,r,n,o,function(x,S){if(x)return s(x);s(null,S.toString("binary"))}):xh.pbkdf2Sync.length===4?xh.pbkdf2Sync(t,e,r,n).toString("binary"):xh.pbkdf2Sync(t,e,r,n,o).toString("binary");if((typeof o>"u"||o===null)&&(o="sha1"),typeof o=="string"){if(!(o in Fa.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=Fa.md[o].create()}var a=o.digestLength;if(n>4294967295*a){var c=new Error("Derived key is too long.");if(s)return s(c);throw c}var l=Math.ceil(n/a),u=n-(l-1)*a,d=Fa.hmac.create();d.start(o,t);var p="",f,m,h;if(!s){for(var g=1;g<=l;++g){d.start(null,null),d.update(e),d.update(Fa.util.int32ToBytes(g)),f=h=d.digest().getBytes();for(var v=2;v<=r;++v)d.start(null,null),d.update(h),m=d.digest().getBytes(),f=Fa.util.xorBytes(f,m,a),h=m;p+=g<l?f:f.substr(0,u)}return p}var g=1,v;function b(){if(g>l)return s(null,p);d.start(null,null),d.update(e),d.update(Fa.util.int32ToBytes(g)),f=h=d.digest().getBytes(),v=2,_()}function _(){if(v<=r)return d.start(null,null),d.update(h),m=d.digest().getBytes(),f=Fa.util.xorBytes(f,m,a),h=m,++v,Fa.util.setImmediate(_);p+=g<l?f:f.substr(0,u),++g,b()}b()}});var pee=R((V1r,DIe)=>{var uf=dr();af();Qr();var RIe=DIe.exports=uf.sha256=uf.sha256||{};uf.md.sha256=uf.md.algorithms.sha256=RIe;RIe.create=function(){PIe||Nnt();var t=null,e=uf.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=uf.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=uf.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),kIe(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=uf.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(dee.substr(0,n.blockLength-a));for(var c,l,u=n.fullMessageLength[0]*8,d=0;d<n.fullMessageLength.length-1;++d)c=n.fullMessageLength[d+1]*8,l=c/4294967296>>>0,u+=l,o.putInt32(u>>>0),u=c>>>0;o.putInt32(u);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};kIe(p,r,o);var f=uf.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f.putInt32(p.h5),f.putInt32(p.h6),f.putInt32(p.h7),f},n};var dee=null,PIe=!1,AIe=null;function Nnt(){dee="\x80",dee+=uf.util.fillString("\0",64),AIe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],PIe=!0}function kIe(t,e,r){for(var n,o,s,a,c,l,u,d,p,f,m,h,g,v,b,_=r.length();_>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,o=e[u-15],o=(o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,e[u]=n+e[u-7]+o+e[u-16]|0;for(d=t.h0,p=t.h1,f=t.h2,m=t.h3,h=t.h4,g=t.h5,v=t.h6,b=t.h7,u=0;u<64;++u)a=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),c=v^h&(g^v),s=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),l=d&p|f&(d^p),n=b+a+c+AIe[u]+e[u],o=s+l,b=v,v=g,g=h,h=m+n>>>0,m=f,f=p,p=d,d=n+o>>>0;t.h0=t.h0+d|0,t.h1=t.h1+p|0,t.h2=t.h2+f|0,t.h3=t.h3+m|0,t.h4=t.h4+h|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+b|0,_-=64}}});var fee=R((H1r,NIe)=>{var df=dr();Qr();var w7=null;df.util.isNodejs&&!df.options.usePureJavaScript&&!process.versions["node-webkit"]&&(w7=require("crypto"));var Lnt=NIe.exports=df.prng=df.prng||{};Lnt.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),o=0;o<32;++o)n[o]=r.create();e.pools=n,e.pool=0,e.generate=function(u,d){if(!d)return e.generateSync(u);var p=e.plugin.cipher,f=e.plugin.increment,m=e.plugin.formatKey,h=e.plugin.formatSeed,g=df.util.createBuffer();e.key=null,v();function v(b){if(b)return d(b);if(g.length()>=u)return d(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return df.util.nextTick(function(){s(v)});var _=p(e.key,e.seed);e.generated+=_.length,g.putBytes(_),e.key=m(p(e.key,f(e.seed))),e.seed=h(p(e.key,e.seed)),df.util.setImmediate(v)}},e.generateSync=function(u){var d=e.plugin.cipher,p=e.plugin.increment,f=e.plugin.formatKey,m=e.plugin.formatSeed;e.key=null;for(var h=df.util.createBuffer();h.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&a();var g=d(e.key,e.seed);e.generated+=g.length,h.putBytes(g),e.key=f(d(e.key,p(e.seed))),e.seed=m(d(e.key,e.seed))}return h.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return c(),u();var d=32-e.pools[0].messageLength<<5;e.seedFile(d,function(p,f){if(p)return u(p);e.collect(f),c(),u()})}function a(){if(e.pools[0].messageLength>=32)return c();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),c()}function c(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var d=1,p=0;p<32;++p)e.reseeds%d===0&&(u.update(e.pools[p].digest().getBytes()),e.pools[p].start()),d=d<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var f=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(f),e.generated=0}function l(u){var d=null,p=df.util.globalScope,f=p.crypto||p.msCrypto;f&&f.getRandomValues&&(d=function(I){return f.getRandomValues(I)});var m=df.util.createBuffer();if(d)for(;m.length()<u;){var h=Math.max(1,Math.min(u-m.length(),65536)/4),g=new Uint32Array(Math.floor(h));try{d(g);for(var v=0;v<g.length;++v)m.putInt32(g[v])}catch(I){if(!(typeof QuotaExceededError<"u"&&I instanceof QuotaExceededError))throw I}}if(m.length()<u)for(var b,_,x,S=Math.floor(Math.random()*65536);m.length()<u;){_=16807*(S&65535),b=16807*(S>>16),_+=(b&32767)<<16,_+=b>>15,_=(_&2147483647)+(_>>31),S=_&4294967295;for(var v=0;v<3;++v)x=S>>>(v<<3),x^=Math.floor(Math.random()*256),m.putByte(x&255)}return m.getBytes(u)}return w7?(e.seedFile=function(u,d){w7.randomBytes(u,function(p,f){if(p)return d(p);d(null,f.toString())})},e.seedFileSync=function(u){return w7.randomBytes(u).toString()}):(e.seedFile=function(u,d){try{d(null,l(u))}catch(p){d(p)}},e.seedFileSync=l),e.collect=function(u){for(var d=u.length,p=0;p<d;++p)e.pools[e.pool].update(u.substr(p,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,d){for(var p="",f=0;f<d;f+=8)p+=String.fromCharCode(u>>f&255);e.collect(p)},e.registerWorker=function(u){if(u===self)e.seedFile=function(p,f){function m(h){var g=h.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",m),f(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",m),self.postMessage({forge:{prng:{needed:p}}})};else{var d=function(p){var f=p.data;f.forge&&f.forge.prng&&e.seedFile(f.forge.prng.needed,function(m,h){u.postMessage({forge:{prng:{err:m,bytes:h}}})})};u.addEventListener("message",d)}},e}});var su=R((G1r,mee)=>{var Ss=dr();W0();pee();fee();Qr();(function(){if(Ss.random&&Ss.random.getBytes){mee.exports=Ss.random;return}(function(t){var e={},r=new Array(4),n=Ss.util.createBuffer();e.formatKey=function(p){var f=Ss.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),Ss.aes._expandKey(p,!1)},e.formatSeed=function(p){var f=Ss.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),p},e.cipher=function(p,f){return Ss.aes._updateBlock(p,f,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(p){return++p[3],p},e.md=Ss.md.sha256;function o(){var p=Ss.prng.create(e);return p.getBytes=function(f,m){return p.generate(f,m)},p.getBytesSync=function(f){return p.generate(f)},p}var s=o(),a=null,c=Ss.util.globalScope,l=c.crypto||c.msCrypto;if(l&&l.getRandomValues&&(a=function(p){return l.getRandomValues(p)}),Ss.options.usePureJavaScript||!Ss.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var d in navigator)try{typeof navigator[d]=="string"&&(u+=navigator[d])}catch{}s.collect(u),u=null}t&&(t().mousemove(function(p){s.collectInt(p.clientX,16),s.collectInt(p.clientY,16)}),t().keypress(function(p){s.collectInt(p.charCode,8)}))}if(!Ss.random)Ss.random=s;else for(var d in s)Ss.random[d]=s[d];Ss.random.createInstance=o,mee.exports=Ss.random})(typeof jQuery<"u"?jQuery:null)})()});var gee=R((z1r,MIe)=>{var Tc=dr();Qr();var hee=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],LIe=[1,2,3,5],Ont=function(t,e){return t<<e&65535|(t&65535)>>16-e},Mnt=function(t,e){return(t&65535)>>e|t<<16-e&65535};MIe.exports=Tc.rc2=Tc.rc2||{};Tc.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Tc.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),o=e,s=Math.ceil(o/8),a=255>>(o&7),c;for(c=n;c<128;c++)r.putByte(hee[r.at(c-1)+r.at(c-n)&255]);for(r.setAt(128-s,hee[r.at(128-s)&a]),c=127-s;c>=0;c--)r.setAt(c,hee[r.at(c+1)^r.at(c+s)]);return r};var OIe=function(t,e,r){var n=!1,o=null,s=null,a=null,c,l,u,d,p=[];for(t=Tc.rc2.expandKey(t,e),u=0;u<64;u++)p.push(t.getInt16Le());r?(c=function(h){for(u=0;u<4;u++)h[u]+=p[d]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),h[u]=Ont(h[u],LIe[u]),d++},l=function(h){for(u=0;u<4;u++)h[u]+=p[h[(u+3)%4]&63]}):(c=function(h){for(u=3;u>=0;u--)h[u]=Mnt(h[u],LIe[u]),h[u]-=p[d]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),d--},l=function(h){for(u=3;u>=0;u--)h[u]-=p[h[(u+3)%4]&63]});var f=function(h){var g=[];for(u=0;u<4;u++){var v=o.getInt16Le();a!==null&&(r?v^=a.getInt16Le():a.putInt16Le(v)),g.push(v&65535)}d=r?0:63;for(var b=0;b<h.length;b++)for(var _=0;_<h[b][0];_++)h[b][1](g);for(u=0;u<4;u++)a!==null&&(r?a.putInt16Le(g[u]):g[u]^=a.getInt16Le()),s.putInt16Le(g[u])},m=null;return m={start:function(h,g){h&&typeof h=="string"&&(h=Tc.util.createBuffer(h)),n=!1,o=Tc.util.createBuffer(),s=g||new Tc.util.createBuffer,a=h,m.output=s},update:function(h){for(n||o.putBuffer(h);o.length()>=8;)f([[5,c],[1,l],[6,c],[1,l],[5,c]])},finish:function(h){var g=!0;if(r)if(h)g=h(8,o,!r);else{var v=o.length()===8?8:8-o.length();o.fillWithByte(v,v)}if(g&&(n=!0,m.update()),!r&&(g=o.length()===0,g))if(h)g=h(8,s,!r);else{var b=s.length(),_=s.at(b-1);_>b?g=!1:s.truncate(_)}return g}},m};Tc.rc2.startEncrypting=function(t,e,r){var n=Tc.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Tc.rc2.createEncryptionCipher=function(t,e){return OIe(t,e,!0)};Tc.rc2.startDecrypting=function(t,e,r){var n=Tc.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Tc.rc2.createDecryptionCipher=function(t,e){return OIe(t,e,!1)}});var nL=R(($1r,GIe)=>{var vee=dr();GIe.exports=vee.jsbn=vee.jsbn||{};var Sh,Fnt=0xdeadbeefcafe,FIe=(Fnt&16777215)==15715070;function we(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}vee.jsbn.BigInteger=we;function Xr(){return new we(null)}function Unt(t,e,r,n,o,s){for(;--s>=0;){var a=e*this.data[t++]+r.data[n]+o;o=Math.floor(a/67108864),r.data[n++]=a&67108863}return o}function Bnt(t,e,r,n,o,s){for(var a=e&32767,c=e>>15;--s>=0;){var l=this.data[t]&32767,u=this.data[t++]>>15,d=c*l+u*a;l=a*l+((d&32767)<<15)+r.data[n]+(o&1073741823),o=(l>>>30)+(d>>>15)+c*u+(o>>>30),r.data[n++]=l&1073741823}return o}function UIe(t,e,r,n,o,s){for(var a=e&16383,c=e>>14;--s>=0;){var l=this.data[t]&16383,u=this.data[t++]>>14,d=c*l+u*a;l=a*l+((d&16383)<<14)+r.data[n]+o,o=(l>>28)+(d>>14)+c*u,r.data[n++]=l&268435455}return o}typeof navigator>"u"?(we.prototype.am=UIe,Sh=28):FIe&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=Bnt,Sh=30):FIe&&navigator.appName!="Netscape"?(we.prototype.am=Unt,Sh=26):(we.prototype.am=UIe,Sh=28);we.prototype.DB=Sh;we.prototype.DM=(1<<Sh)-1;we.prototype.DV=1<<Sh;var yee=52;we.prototype.FV=Math.pow(2,yee);we.prototype.F1=yee-Sh;we.prototype.F2=2*Sh-yee;var qnt="0123456789abcdefghijklmnopqrstuvwxyz",k7=new Array,_E,au;_E=48;for(au=0;au<=9;++au)k7[_E++]=au;_E=97;for(au=10;au<36;++au)k7[_E++]=au;_E=65;for(au=10;au<36;++au)k7[_E++]=au;function BIe(t){return qnt.charAt(t)}function qIe(t,e){var r=k7[t.charCodeAt(e)];return r??-1}function jnt(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Vnt(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Y0(t){var e=Xr();return e.fromInt(t),e}function Hnt(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;--n>=0;){var a=r==8?t[n]&255:qIe(t,n);if(a<0){t.charAt(n)=="-"&&(o=!0);continue}o=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&we.ZERO.subTo(this,this)}function Gnt(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function znt(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,o=!1,s="",a=this.t,c=this.DB-a*this.DB%e;if(a-- >0)for(c<this.DB&&(n=this.data[a]>>c)>0&&(o=!0,s=BIe(n));a>=0;)c<e?(n=(this.data[a]&(1<<c)-1)<<e-c,n|=this.data[--a]>>(c+=this.DB-e)):(n=this.data[a]>>(c-=e)&r,c<=0&&(c+=this.DB,--a)),n>0&&(o=!0),o&&(s+=BIe(n));return o?s:"0"}function $nt(){var t=Xr();return we.ZERO.subTo(this,t),t}function Wnt(){return this.s<0?this.negate():this}function Knt(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function R7(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Ynt(){return this.t<=0?0:this.DB*(this.t-1)+R7(this.data[this.t-1]^this.s&this.DM)}function Qnt(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Xnt(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Jnt(t,e){var r=t%this.DB,n=this.DB-r,o=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM,c;for(c=this.t-1;c>=0;--c)e.data[c+s+1]=this.data[c]>>n|a,a=(this.data[c]&o)<<r;for(c=s-1;c>=0;--c)e.data[c]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Znt(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,o=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&s)<<o,e.data[a-r]=this.data[a]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<o),e.t=this.t-r,e.clamp()}function eit(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function tit(t,e){var r=this.abs(),n=t.abs(),o=r.t;for(e.t=o+n.t;--o>=0;)e.data[o]=0;for(o=0;o<n.t;++o)e.data[o+r.t]=r.am(0,n.data[o],e,o,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&we.ZERO.subTo(e,e)}function rit(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function nit(t,e,r){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Xr());var s=Xr(),a=this.s,c=t.s,l=this.DB-R7(n.data[n.t-1]);l>0?(n.lShiftTo(l,s),o.lShiftTo(l,r)):(n.copyTo(s),o.copyTo(r));var u=s.t,d=s.data[u-1];if(d!=0){var p=d*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),f=this.FV/p,m=(1<<this.F1)/p,h=1<<this.F2,g=r.t,v=g-u,b=e??Xr();for(s.dlShiftTo(v,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),we.ONE.dlShiftTo(u,b),b.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--v>=0;){var _=r.data[--g]==d?this.DM:Math.floor(r.data[g]*f+(r.data[g-1]+h)*m);if((r.data[g]+=s.am(0,_,r,v,0,u))<_)for(s.dlShiftTo(v,b),r.subTo(b,r);r.data[g]<--_;)r.subTo(b,r)}e!=null&&(r.drShiftTo(u,e),a!=c&&we.ZERO.subTo(e,e)),r.t=u,r.clamp(),l>0&&r.rShiftTo(l,r),a<0&&we.ZERO.subTo(r,r)}}}function iit(t){var e=Xr();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&t.subTo(e,e),e}function Tx(t){this.m=t}function oit(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function sit(t){return t}function ait(t){t.divRemTo(this.m,null,t)}function cit(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function lit(t,e){t.squareTo(e),this.reduce(e)}Tx.prototype.convert=oit;Tx.prototype.revert=sit;Tx.prototype.reduce=ait;Tx.prototype.mulTo=cit;Tx.prototype.sqrTo=lit;function uit(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Ex(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function dit(t){var e=Xr();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function pit(t){var e=Xr();return t.copyTo(e),this.reduce(e),e}function fit(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function mit(t,e){t.squareTo(e),this.reduce(e)}function hit(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ex.prototype.convert=dit;Ex.prototype.revert=pit;Ex.prototype.reduce=fit;Ex.prototype.mulTo=hit;Ex.prototype.sqrTo=mit;function git(){return(this.t>0?this.data[0]&1:this.s)==0}function vit(t,e){if(t>4294967295||t<1)return we.ONE;var r=Xr(),n=Xr(),o=e.convert(this),s=R7(t)-1;for(o.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,o,r);else{var a=r;r=n,n=a}return e.revert(r)}function yit(t,e){var r;return t<256||e.isEven()?r=new Tx(e):r=new Ex(e),this.exp(t,r)}we.prototype.copyTo=jnt;we.prototype.fromInt=Vnt;we.prototype.fromString=Hnt;we.prototype.clamp=Gnt;we.prototype.dlShiftTo=Qnt;we.prototype.drShiftTo=Xnt;we.prototype.lShiftTo=Jnt;we.prototype.rShiftTo=Znt;we.prototype.subTo=eit;we.prototype.multiplyTo=tit;we.prototype.squareTo=rit;we.prototype.divRemTo=nit;we.prototype.invDigit=uit;we.prototype.isEven=git;we.prototype.exp=vit;we.prototype.toString=znt;we.prototype.negate=$nt;we.prototype.abs=Wnt;we.prototype.compareTo=Knt;we.prototype.bitLength=Ynt;we.prototype.mod=iit;we.prototype.modPowInt=yit;we.ZERO=Y0(0);we.ONE=Y0(1);function bit(){var t=Xr();return this.copyTo(t),t}function _it(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function xit(){return this.t==0?this.s:this.data[0]<<24>>24}function Sit(){return this.t==0?this.s:this.data[0]<<16>>16}function Iit(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Cit(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Tit(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Y0(r),o=Xr(),s=Xr(),a="";for(this.divRemTo(n,o,s);o.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,o.divRemTo(n,o,s);return s.intValue().toString(t)+a}function Eit(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),o=!1,s=0,a=0,c=0;c<t.length;++c){var l=qIe(t,c);if(l<0){t.charAt(c)=="-"&&this.signum()==0&&(o=!0);continue}a=e*a+l,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),o&&we.ZERO.subTo(this,this)}function wit(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(we.ONE.shiftLeft(t-1),bee,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(we.ONE.shiftLeft(t-1),this);else{var n=new Array,o=t&7;n.length=(t>>3)+1,e.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}}function kit(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,o=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[o++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),o==0&&(this.s&128)!=(n&128)&&++o,(o>0||n!=this.s)&&(e[o++]=n);return e}function Rit(t){return this.compareTo(t)==0}function Pit(t){return this.compareTo(t)<0?this:t}function Ait(t){return this.compareTo(t)>0?this:t}function Dit(t,e,r){var n,o,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(o=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(o,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Nit(t,e){return t&e}function Lit(t){var e=Xr();return this.bitwiseTo(t,Nit,e),e}function bee(t,e){return t|e}function Oit(t){var e=Xr();return this.bitwiseTo(t,bee,e),e}function jIe(t,e){return t^e}function Mit(t){var e=Xr();return this.bitwiseTo(t,jIe,e),e}function VIe(t,e){return t&~e}function Fit(t){var e=Xr();return this.bitwiseTo(t,VIe,e),e}function Uit(){for(var t=Xr(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Bit(t){var e=Xr();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function qit(t){var e=Xr();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function jit(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function Vit(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+jit(this.data[t]);return this.s<0?this.t*this.DB:-1}function Hit(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Git(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Hit(this.data[r]^e);return t}function zit(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function $it(t,e){var r=we.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Wit(t){return this.changeBit(t,bee)}function Kit(t){return this.changeBit(t,VIe)}function Yit(t){return this.changeBit(t,jIe)}function Qit(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Xit(t){var e=Xr();return this.addTo(t,e),e}function Jit(t){var e=Xr();return this.subTo(t,e),e}function Zit(t){var e=Xr();return this.multiplyTo(t,e),e}function eot(t){var e=Xr();return this.divRemTo(t,e,null),e}function tot(t){var e=Xr();return this.divRemTo(t,null,e),e}function rot(t){var e=Xr(),r=Xr();return this.divRemTo(t,e,r),new Array(e,r)}function not(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function iot(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function rL(){}function HIe(t){return t}function oot(t,e,r){t.multiplyTo(e,r)}function sot(t,e){t.squareTo(e)}rL.prototype.convert=HIe;rL.prototype.revert=HIe;rL.prototype.mulTo=oot;rL.prototype.sqrTo=sot;function aot(t){return this.exp(t,new rL)}function cot(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var o;for(o=r.t-this.t;n<o;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(o=Math.min(t.t,e);n<o;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function lot(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function xE(t){this.r2=Xr(),this.q3=Xr(),we.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function uot(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Xr();return t.copyTo(e),this.reduce(e),e}function dot(t){return t}function pot(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function fot(t,e){t.squareTo(e),this.reduce(e)}function mot(t,e,r){t.multiplyTo(e,r),this.reduce(r)}xE.prototype.convert=uot;xE.prototype.revert=dot;xE.prototype.reduce=pot;xE.prototype.mulTo=mot;xE.prototype.sqrTo=fot;function hot(t,e){var r=t.bitLength(),n,o=Y0(1),s;if(r<=0)return o;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Tx(e):e.isEven()?s=new xE(e):s=new Ex(e);var a=new Array,c=3,l=n-1,u=(1<<n)-1;if(a[1]=s.convert(this),n>1){var d=Xr();for(s.sqrTo(a[1],d);c<=u;)a[c]=Xr(),s.mulTo(d,a[c-2],a[c]),c+=2}var p=t.t-1,f,m=!0,h=Xr(),g;for(r=R7(t.data[p])-1;p>=0;){for(r>=l?f=t.data[p]>>r-l&u:(f=(t.data[p]&(1<<r+1)-1)<<l-r,p>0&&(f|=t.data[p-1]>>this.DB+r-l)),c=n;!(f&1);)f>>=1,--c;if((r-=c)<0&&(r+=this.DB,--p),m)a[f].copyTo(o),m=!1;else{for(;c>1;)s.sqrTo(o,h),s.sqrTo(h,o),c-=2;c>0?s.sqrTo(o,h):(g=o,o=h,h=g),s.mulTo(h,a[f],o)}for(;p>=0&&!(t.data[p]&1<<r);)s.sqrTo(o,h),g=o,o=h,h=g,--r<0&&(r=this.DB-1,--p)}return s.revert(o)}function got(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var o=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(o<s&&(s=o),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function vot(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function yot(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return we.ZERO;for(var r=t.clone(),n=this.clone(),o=Y0(1),s=Y0(0),a=Y0(0),c=Y0(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!a.isEven()||!c.isEven())&&(a.addTo(this,a),c.subTo(t,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),e&&o.subTo(a,o),s.subTo(c,s)):(n.subTo(r,n),e&&a.subTo(o,a),c.subTo(s,c))}if(n.compareTo(we.ONE)!=0)return we.ZERO;if(c.compareTo(t)>=0)return c.subtract(t);if(c.signum()<0)c.addTo(t,c);else return c;return c.signum()<0?c.add(t):c}var Od=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],bot=(1<<26)/Od[Od.length-1];function _ot(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Od[Od.length-1]){for(e=0;e<Od.length;++e)if(r.data[0]==Od[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Od.length;){for(var n=Od[e],o=e+1;o<Od.length&&n<bot;)n*=Od[o++];for(n=r.modInt(n);e<o;)if(n%Od[e++]==0)return!1}return r.millerRabin(t)}function xot(t){var e=this.subtract(we.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),o=Sot(),s,a=0;a<t;++a){do s=new we(this.bitLength(),o);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var c=s.modPow(n,this);if(c.compareTo(we.ONE)!=0&&c.compareTo(e)!=0){for(var l=1;l++<r&&c.compareTo(e)!=0;)if(c=c.modPowInt(2,this),c.compareTo(we.ONE)==0)return!1;if(c.compareTo(e)!=0)return!1}}return!0}function Sot(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=Iit;we.prototype.toRadix=Tit;we.prototype.fromRadix=Eit;we.prototype.fromNumber=wit;we.prototype.bitwiseTo=Dit;we.prototype.changeBit=$it;we.prototype.addTo=Qit;we.prototype.dMultiply=not;we.prototype.dAddOffset=iot;we.prototype.multiplyLowerTo=cot;we.prototype.multiplyUpperTo=lot;we.prototype.modInt=vot;we.prototype.millerRabin=xot;we.prototype.clone=bit;we.prototype.intValue=_it;we.prototype.byteValue=xit;we.prototype.shortValue=Sit;we.prototype.signum=Cit;we.prototype.toByteArray=kit;we.prototype.equals=Rit;we.prototype.min=Pit;we.prototype.max=Ait;we.prototype.and=Lit;we.prototype.or=Oit;we.prototype.xor=Mit;we.prototype.andNot=Fit;we.prototype.not=Uit;we.prototype.shiftLeft=Bit;we.prototype.shiftRight=qit;we.prototype.getLowestSetBit=Vit;we.prototype.bitCount=Git;we.prototype.testBit=zit;we.prototype.setBit=Wit;we.prototype.clearBit=Kit;we.prototype.flipBit=Yit;we.prototype.add=Xit;we.prototype.subtract=Jit;we.prototype.multiply=Zit;we.prototype.divide=eot;we.prototype.remainder=tot;we.prototype.divideAndRemainder=rot;we.prototype.modPow=hot;we.prototype.modInverse=yot;we.prototype.pow=aot;we.prototype.gcd=got;we.prototype.isProbablePrime=_ot});var SE=R((W1r,KIe)=>{var pf=dr();af();Qr();var $Ie=KIe.exports=pf.sha1=pf.sha1||{};pf.md.sha1=pf.md.algorithms.sha1=$Ie;$Ie.create=function(){WIe||Iot();var t=null,e=pf.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=pf.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=pf.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),zIe(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=pf.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(_ee.substr(0,n.blockLength-a));for(var c,l,u=n.fullMessageLength[0]*8,d=0;d<n.fullMessageLength.length-1;++d)c=n.fullMessageLength[d+1]*8,l=c/4294967296>>>0,u+=l,o.putInt32(u>>>0),u=c>>>0;o.putInt32(u);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};zIe(p,r,o);var f=pf.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f},n};var _ee=null,WIe=!1;function Iot(){_ee="\x80",_ee+=pf.util.fillString("\0",64),WIe=!0}function zIe(t,e,r){for(var n,o,s,a,c,l,u,d,p=r.length();p>=64;){for(o=t.h0,s=t.h1,a=t.h2,c=t.h3,l=t.h4,d=0;d<16;++d)n=r.getInt32(),e[d]=n,u=c^s&(a^c),n=(o<<5|o>>>27)+u+l+1518500249+n,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<20;++d)n=e[d-3]^e[d-8]^e[d-14]^e[d-16],n=n<<1|n>>>31,e[d]=n,u=c^s&(a^c),n=(o<<5|o>>>27)+u+l+1518500249+n,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<32;++d)n=e[d-3]^e[d-8]^e[d-14]^e[d-16],n=n<<1|n>>>31,e[d]=n,u=s^a^c,n=(o<<5|o>>>27)+u+l+1859775393+n,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<40;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,u=s^a^c,n=(o<<5|o>>>27)+u+l+1859775393+n,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<60;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,u=s&a|c&(s^a),n=(o<<5|o>>>27)+u+l+2400959708+n,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<80;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,u=s^a^c,n=(o<<5|o>>>27)+u+l+3395469782+n,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;t.h0=t.h0+o|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,t.h4=t.h4+l|0,p-=64}}});var xee=R((K1r,QIe)=>{var ff=dr();Qr();su();SE();var YIe=QIe.exports=ff.pkcs1=ff.pkcs1||{};YIe.encode_rsa_oaep=function(t,e,r){var n,o,s,a;typeof r=="string"?(n=r,o=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,o=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=ff.md.sha1.create(),a||(a=s);var c=Math.ceil(t.n.bitLength()/8),l=c-2*s.digestLength-2;if(e.length>l){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=l,u}n||(n=""),s.update(n,"raw");for(var d=s.digest(),p="",f=l-e.length,m=0;m<f;m++)p+="\0";var h=d.getBytes()+p+""+e;if(!o)o=ff.random.getBytes(s.digestLength);else if(o.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=o.length,u.digestLength=s.digestLength,u}var g=P7(o,c-s.digestLength-1,a),v=ff.util.xorBytes(h,g,h.length),b=P7(v,s.digestLength,a),_=ff.util.xorBytes(o,b,o.length);return"\0"+_+v};YIe.decode_rsa_oaep=function(t,e,r){var n,o,s;typeof r=="string"?(n=r,o=arguments[3]||void 0):r&&(n=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=a,v}if(o===void 0?o=ff.md.sha1.create():o.start(),s||(s=o),a<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),o.update(n,"raw");for(var c=o.digest().getBytes(),l=e.charAt(0),u=e.substring(1,o.digestLength+1),d=e.substring(1+o.digestLength),p=P7(d,o.digestLength,s),f=ff.util.xorBytes(u,p,u.length),m=P7(f,a-o.digestLength-1,s),h=ff.util.xorBytes(d,m,d.length),g=h.substring(0,o.digestLength),v=l!=="\0",b=0;b<o.digestLength;++b)v|=c.charAt(b)!==g.charAt(b);for(var _=1,x=o.digestLength,S=o.digestLength;S<h.length;S++){var I=h.charCodeAt(S),w=I&1^1,k=_?65534:0;v|=I&k,_=_&w,x+=_}if(v||h.charCodeAt(x)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(x+1)};function P7(t,e,r){r||(r=ff.md.sha1.create());for(var n="",o=Math.ceil(e/r.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+a),n+=r.digest().getBytes()}return n.substring(0,e)}});var Iee=R((Y1r,See)=>{var Q0=dr();Qr();nL();su();(function(){if(Q0.prime){See.exports=Q0.prime;return}var t=See.exports=Q0.prime=Q0.prime||{},e=Q0.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var o=function(p,f){return p|f};t.generateProbablePrime=function(p,f,m){typeof f=="function"&&(m=f,f={}),f=f||{};var h=f.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var g=f.prng||Q0.random,v={nextBytes:function(b){for(var _=g.getBytesSync(b.length),x=0;x<b.length;++x)b[x]=_.charCodeAt(x)}};if(h.name==="PRIMEINC")return s(p,v,h.options,m);throw new Error("Invalid prime generation algorithm: "+h.name)};function s(p,f,m,h){return"workers"in m?l(p,f,m,h):a(p,f,m,h)}function a(p,f,m,h){var g=u(p,f),v=0,b=d(g.bitLength());"millerRabinTests"in m&&(b=m.millerRabinTests);var _=10;"maxBlockTime"in m&&(_=m.maxBlockTime),c(g,p,f,v,b,_,h)}function c(p,f,m,h,g,v,b){var _=+new Date;do{if(p.bitLength()>f&&(p=u(f,m)),p.isProbablePrime(g))return b(null,p);p.dAddOffset(r[h++%8],0)}while(v<0||+new Date-_<v);Q0.util.setImmediate(function(){c(p,f,m,h,g,v,b)})}function l(p,f,m,h){if(typeof Worker>"u")return a(p,f,m,h);var g=u(p,f),v=m.workers,b=m.workLoad||100,_=b*30/8,x=m.workerScript||"forge/prime.worker.js";if(v===-1)return Q0.util.estimateCores(function(I,w){I&&(w=2),v=w-1,S()});S();function S(){v=Math.max(1,v);for(var I=[],w=0;w<v;++w)I[w]=new Worker(x);for(var k=v,w=0;w<v;++w)I[w].addEventListener("message",H);var M=!1;function H(F){if(!M){--k;var ue=F.data;if(ue.found){for(var Z=0;Z<I.length;++Z)I[Z].terminate();return M=!0,h(null,new e(ue.prime,16))}g.bitLength()>p&&(g=u(p,f));var V=g.toString(16);F.target.postMessage({hex:V,workLoad:b}),g.dAddOffset(_,0)}}}}function u(p,f){var m=new e(p,f),h=p-1;return m.testBit(h)||m.bitwiseTo(e.ONE.shiftLeft(h),o,m),m.dAddOffset(31-m.mod(n).byteValue(),0),m}function d(p){return p<=100?27:p<=150?18:p<=200?15:p<=250?12:p<=300?9:p<=350?8:p<=400?7:p<=500?6:p<=600?5:p<=800?4:p<=1250?3:2}})()});var iL=R((Q1r,nCe)=>{var Pt=dr();Ld();nL();K0();xee();Iee();su();Qr();typeof Gr>"u"&&(Gr=Pt.jsbn.BigInteger);var Gr,Cee=Pt.util.isNodejs?require("crypto"):null,se=Pt.asn1,cu=Pt.util;Pt.pki=Pt.pki||{};nCe.exports=Pt.pki.rsa=Pt.rsa=Pt.rsa||{};var tr=Pt.pki,Cot=[6,4,2,4,2,4,6,2],Tot={name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Eot={name:"RSAPrivateKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},wot={name:"RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},kot=Pt.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Rot={name:"DigestInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:se.Class.UNIVERSAL,type:se.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Pot=function(t){var e;if(t.algorithm in tr.oids)e=tr.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=se.oidToDer(e).getBytes(),o=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]),s=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]);s.value.push(se.create(se.Class.UNIVERSAL,se.Type.OID,!1,n)),s.value.push(se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,""));var a=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,t.digest().getBytes());return o.value.push(s),o.value.push(a),se.toDer(o).getBytes()},tCe=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Gr.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Gr.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Gr(Pt.util.bytesToHex(Pt.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Gr.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var o=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);o.compareTo(s)<0;)o=o.add(e.p);var a=o.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(n.modInverse(e.n)).mod(e.n),a};tr.rsa.encrypt=function(t,e,r){var n=r,o,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,o=rCe(t,e,r)):(o=Pt.util.createBuffer(),o.putBytes(t));for(var a=new Gr(o.toHex(),16),c=tCe(a,e,n),l=c.toString(16),u=Pt.util.createBuffer(),d=s-Math.ceil(l.length/2);d>0;)u.putByte(0),--d;return u.putBytes(Pt.util.hexToBytes(l)),u.getBytes()};tr.rsa.decrypt=function(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=o,s}var a=new Gr(Pt.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=tCe(a,e,r),l=c.toString(16),u=Pt.util.createBuffer(),d=o-Math.ceil(l.length/2);d>0;)u.putByte(0),--d;return u.putBytes(Pt.util.hexToBytes(l)),n!==!1?A7(u.getBytes(),e,r):u.getBytes()};tr.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||Pt.random,o={nextBytes:function(c){for(var l=n.getBytesSync(c.length),u=0;u<c.length;++u)c[u]=l.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:t,rng:o,eInt:e||65537,e:new Gr(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};tr.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Gr(null);r.fromInt(30);for(var n=0,o=function(p,f){return p|f},s=+new Date,a,c=0;t.keys===null&&(e<=0||c<e);){if(t.state===0){var l=t.p===null?t.pBits:t.qBits,u=l-1;t.pqState===0?(t.num=new Gr(l,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Gr.ONE.shiftLeft(u),o,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>l?t.pqState=0:t.num.isProbablePrime(Dot(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Cot[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Gr.ONE).gcd(t.e).compareTo(Gr.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Gr.ONE),t.q1=t.q.subtract(Gr.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Gr.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var d=t.e.modInverse(t.phi);t.keys={privateKey:tr.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:tr.rsa.setPublicKey(t.n,t.e)}}a=+new Date,c+=a-s,s=a}return t.keys!==null};tr.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!Pt.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(XIe("generateKeyPair"))return Cee.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(c,l,u){if(c)return n(c);n(null,{privateKey:tr.privateKeyFromPem(u),publicKey:tr.publicKeyFromPem(l)})});if(JIe("generateKey")&&JIe("exportKey"))return cu.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:eCe(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(c){return cu.globalScope.crypto.subtle.exportKey("pkcs8",c.privateKey)}).then(void 0,function(c){n(c)}).then(function(c){if(c){var l=tr.privateKeyFromAsn1(se.fromDer(Pt.util.createBuffer(c)));n(null,{privateKey:l,publicKey:tr.setRsaPublicKey(l.n,l.e)})}});if(ZIe("generateKey")&&ZIe("exportKey")){var o=cu.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:eCe(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);o.oncomplete=function(c){var l=c.target.result,u=cu.globalScope.msCrypto.subtle.exportKey("pkcs8",l.privateKey);u.oncomplete=function(d){var p=d.target.result,f=tr.privateKeyFromAsn1(se.fromDer(Pt.util.createBuffer(p)));n(null,{privateKey:f,publicKey:tr.setRsaPublicKey(f.n,f.e)})},u.onerror=function(d){n(d)}},o.onerror=function(c){n(c)};return}}else if(XIe("generateKeyPairSync")){var s=Cee.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:tr.privateKeyFromPem(s.privateKey),publicKey:tr.publicKeyFromPem(s.publicKey)}}}var a=tr.rsa.createKeyPairGenerationState(t,e,r);if(!n)return tr.rsa.stepKeyPairGenerationState(a,0),a.keys;Aot(a,r,n)};tr.setRsaPublicKey=tr.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,o,s){if(typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSAES-PKCS1-V1_5"),o==="RSAES-PKCS1-V1_5")o={encode:function(c,l,u){return rCe(c,l,2).getBytes()}};else if(o==="RSA-OAEP"||o==="RSAES-OAEP")o={encode:function(c,l){return Pt.pkcs1.encode_rsa_oaep(l,c,s)}};else if(["RAW","NONE","NULL",null].indexOf(o)!==-1)o={encode:function(c){return c}};else if(typeof o=="string")throw new Error('Unsupported encryption scheme: "'+o+'".');var a=o.encode(n,r,!0);return tr.rsa.encrypt(a,r,!0)},r.verify=function(n,o,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(l,u){u=A7(u,r,!0);var d=se.fromDer(u,{parseAllBytes:a._parseAllDigestBytes}),p={},f=[];if(!se.validate(d,Rot,p,f)){var m=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw m.errors=f,m}var h=se.derToOid(p.algorithmIdentifier);if(!(h===Pt.oids.md2||h===Pt.oids.md5||h===Pt.oids.sha1||h===Pt.oids.sha224||h===Pt.oids.sha256||h===Pt.oids.sha384||h===Pt.oids.sha512||h===Pt.oids["sha512-224"]||h===Pt.oids["sha512-256"])){var m=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw m.oid=h,m}if((h===Pt.oids.md2||h===Pt.oids.md5)&&!("parameters"in p))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return l===p.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(l,u){return u=A7(u,r,!0),l===u}});var c=tr.rsa.decrypt(o,r,!0,!1);return s.verify(n,c,r.n.bitLength())},r};tr.setRsaPrivateKey=tr.rsa.setPrivateKey=function(t,e,r,n,o,s,a,c){var l={n:t,e,d:r,p:n,q:o,dP:s,dQ:a,qInv:c};return l.decrypt=function(u,d,p){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var f=tr.rsa.decrypt(u,l,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:A7};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(m,h){return Pt.pkcs1.decode_rsa_oaep(h,m,p)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(m){return m}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(f,l,!1)},l.sign=function(u,d){var p=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:Pot},p=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return u}},p=1);var f=d.encode(u,l.n.bitLength());return tr.rsa.encrypt(f,l,p)},l};tr.wrapRsaPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(tr.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,se.toDer(t).getBytes())])};tr.privateKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,Tot,e,r)&&(t=se.fromDer(Pt.util.createBuffer(e.privateKey))),e={},r=[],!se.validate(t,Eot,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var o,s,a,c,l,u,d,p;return o=Pt.util.createBuffer(e.privateKeyModulus).toHex(),s=Pt.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=Pt.util.createBuffer(e.privateKeyPrivateExponent).toHex(),c=Pt.util.createBuffer(e.privateKeyPrime1).toHex(),l=Pt.util.createBuffer(e.privateKeyPrime2).toHex(),u=Pt.util.createBuffer(e.privateKeyExponent1).toHex(),d=Pt.util.createBuffer(e.privateKeyExponent2).toHex(),p=Pt.util.createBuffer(e.privateKeyCoefficient).toHex(),tr.setRsaPrivateKey(new Gr(o,16),new Gr(s,16),new Gr(a,16),new Gr(c,16),new Gr(l,16),new Gr(u,16),new Gr(d,16),new Gr(p,16))};tr.privateKeyToAsn1=tr.privateKeyToRSAPrivateKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.e)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.d)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.p)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.q)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.dP)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.dQ)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.qInv))])};tr.publicKeyFromAsn1=function(t){var e={},r=[];if(se.validate(t,kot,e,r)){var n=se.derToOid(e.publicKeyOid);if(n!==tr.oids.rsaEncryption){var o=new Error("Cannot read public key. Unknown OID.");throw o.oid=n,o}t=e.rsaPublicKey}if(r=[],!se.validate(t,wot,e,r)){var o=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw o.errors=r,o}var s=Pt.util.createBuffer(e.publicKeyModulus).toHex(),a=Pt.util.createBuffer(e.publicKeyExponent).toHex();return tr.setRsaPublicKey(new Gr(s,16),new Gr(a,16))};tr.publicKeyToAsn1=tr.publicKeyToSubjectPublicKeyInfo=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(tr.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.BITSTRING,!1,[tr.publicKeyToRSAPublicKey(t)])])};tr.publicKeyToRSAPublicKey=function(t){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,mf(t.e))])};function rCe(t,e,r){var n=Pt.util.createBuffer(),o=Math.ceil(e.n.bitLength()/8);if(t.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=o-11,s}n.putByte(0),n.putByte(r);var a=o-3-t.length,c;if(r===0||r===1){c=r===0?0:255;for(var l=0;l<a;++l)n.putByte(c)}else for(;a>0;){for(var u=0,d=Pt.random.getBytes(a),l=0;l<a;++l)c=d.charCodeAt(l),c===0?++u:n.putByte(c);a=u}return n.putByte(0),n.putBytes(t),n}function A7(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8),s=Pt.util.createBuffer(t),a=s.getByte(),c=s.getByte();if(a!==0||r&&c!==0&&c!==1||!r&&c!=2||r&&c===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var l=0;if(c===0){l=o-3-n;for(var u=0;u<l;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(c===1)for(l=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++l}else if(c===2)for(l=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++l}var d=s.getByte();if(d!==0||l!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Aot(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),o();function o(){s(t.pBits,function(c,l){if(c)return r(c);if(t.p=l,t.q!==null)return a(c,t.q);s(t.qBits,a)})}function s(c,l){Pt.prime.generateProbablePrime(c,n,l)}function a(c,l){if(c)return r(c);if(t.q=l,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Gr.ONE).gcd(t.e).compareTo(Gr.ONE)!==0){t.p=null,o();return}if(t.q.subtract(Gr.ONE).gcd(t.e).compareTo(Gr.ONE)!==0){t.q=null,s(t.qBits,a);return}if(t.p1=t.p.subtract(Gr.ONE),t.q1=t.q.subtract(Gr.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Gr.ONE)!==0){t.p=t.q=null,o();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,a);return}var d=t.e.modInverse(t.phi);t.keys={privateKey:tr.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:tr.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function mf(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=Pt.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Dot(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function XIe(t){return Pt.util.isNodejs&&typeof Cee[t]=="function"}function JIe(t){return typeof cu.globalScope<"u"&&typeof cu.globalScope.crypto=="object"&&typeof cu.globalScope.crypto.subtle=="object"&&typeof cu.globalScope.crypto.subtle[t]=="function"}function ZIe(t){return typeof cu.globalScope<"u"&&typeof cu.globalScope.msCrypto=="object"&&typeof cu.globalScope.msCrypto.subtle=="object"&&typeof cu.globalScope.msCrypto.subtle[t]=="function"}function eCe(t){for(var e=Pt.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Tee=R((X1r,cCe)=>{var lt=dr();W0();Ld();tL();af();K0();E7();Cx();su();gee();iL();Qr();typeof iCe>"u"&&(iCe=lt.jsbn.BigInteger);var iCe,ve=lt.asn1,lr=lt.pki=lt.pki||{};cCe.exports=lr.pbe=lt.pbe=lt.pbe||{};var wx=lr.oids,Not={name:"EncryptedPrivateKeyInfo",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Lot={name:"PBES2Algorithms",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:ve.Class.UNIVERSAL,type:ve.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:ve.Class.UNIVERSAL,type:ve.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Oot={name:"pkcs-12PbeParams",tagClass:ve.Class.UNIVERSAL,type:ve.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:ve.Class.UNIVERSAL,type:ve.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:ve.Class.UNIVERSAL,type:ve.Type.INTEGER,constructed:!1,capture:"iterations"}]};lr.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=lt.random.getBytesSync(r.saltSize),o=r.count,s=ve.integerToDer(o),a,c,l;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,d,p;switch(r.algorithm){case"aes128":a=16,u=16,d=wx["aes128-CBC"],p=lt.aes.createEncryptionCipher;break;case"aes192":a=24,u=16,d=wx["aes192-CBC"],p=lt.aes.createEncryptionCipher;break;case"aes256":a=32,u=16,d=wx["aes256-CBC"],p=lt.aes.createEncryptionCipher;break;case"des":a=8,u=8,d=wx.desCBC,p=lt.des.createEncryptionCipher;break;default:var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=r.algorithm,f}var m="hmacWith"+r.prfAlgorithm.toUpperCase(),h=aCe(m),g=lt.pkcs5.pbkdf2(e,n,o,a,h),v=lt.random.getBytesSync(u),b=p(g);b.start(v),b.update(ve.toDer(t)),b.finish(),l=b.output.getBytes();var _=Mot(n,s,a,m);c=ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.OID,!1,ve.oidToDer(wx.pkcs5PBES2).getBytes()),ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.OID,!1,ve.oidToDer(wx.pkcs5PBKDF2).getBytes()),_]),ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.OID,!1,ve.oidToDer(d).getBytes()),ve.create(ve.Class.UNIVERSAL,ve.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){a=24;var x=new lt.util.ByteBuffer(n),g=lr.pbe.generatePkcs12Key(e,x,1,o,a),v=lr.pbe.generatePkcs12Key(e,x,2,o,a),b=lt.des.createEncryptionCipher(g);b.start(v),b.update(ve.toDer(t)),b.finish(),l=b.output.getBytes(),c=ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.OID,!1,ve.oidToDer(wx["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.OCTETSTRING,!1,n),ve.create(ve.Class.UNIVERSAL,ve.Type.INTEGER,!1,s.getBytes())])])}else{var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=r.algorithm,f}var S=ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[c,ve.create(ve.Class.UNIVERSAL,ve.Type.OCTETSTRING,!1,l)]);return S};lr.decryptPrivateKeyInfo=function(t,e){var r=null,n={},o=[];if(!ve.validate(t,Not,n,o)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=ve.derToOid(n.encryptionOid),c=lr.pbe.getCipher(a,n.encryptionParams,e),l=lt.util.createBuffer(n.encryptedData);return c.update(l),c.finish()&&(r=ve.fromDer(c.output)),r};lr.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:ve.toDer(t).getBytes()};return lt.pem.encode(r,{maxline:e})};lr.encryptedPrivateKeyFromPem=function(t){var e=lt.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return ve.fromDer(e.body)};lr.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=lr.wrapRsaPrivateKey(lr.privateKeyToAsn1(t));return n=lr.encryptPrivateKeyInfo(n,e,r),lr.encryptedPrivateKeyToPem(n)}var o,s,a,c;switch(r.algorithm){case"aes128":o="AES-128-CBC",a=16,s=lt.random.getBytesSync(16),c=lt.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",a=24,s=lt.random.getBytesSync(16),c=lt.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",a=32,s=lt.random.getBytesSync(16),c=lt.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",a=24,s=lt.random.getBytesSync(8),c=lt.des.createEncryptionCipher;break;case"des":o="DES-CBC",a=8,s=lt.random.getBytesSync(8),c=lt.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw l.algorithm=r.algorithm,l}var u=lt.pbe.opensslDeriveBytes(e,s.substr(0,8),a),d=c(u);d.start(s),d.update(ve.toDer(lr.privateKeyToAsn1(t))),d.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:lt.util.bytesToHex(s).toUpperCase()},body:d.output.getBytes()};return lt.pem.encode(p)};lr.decryptRsaPrivateKey=function(t,e){var r=null,n=lt.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw o.headerType=o,o}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=lt.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=lt.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=lt.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=lt.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=lt.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(p){return lt.rc2.createDecryptionCipher(p,40)};break;case"RC2-64-CBC":s=8,a=function(p){return lt.rc2.createDecryptionCipher(p,64)};break;case"RC2-128-CBC":s=16,a=function(p){return lt.rc2.createDecryptionCipher(p,128)};break;default:var o=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw o.algorithm=n.dekInfo.algorithm,o}var c=lt.util.hexToBytes(n.dekInfo.parameters),l=lt.pbe.opensslDeriveBytes(e,c.substr(0,8),s),u=a(l);if(u.start(c),u.update(lt.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=lr.decryptPrivateKeyInfo(ve.fromDer(r),e):r=ve.fromDer(r),r!==null&&(r=lr.privateKeyFromAsn1(r)),r};lr.pbe.generatePkcs12Key=function(t,e,r,n,o,s){var a,c;if(typeof s>"u"||s===null){if(!("sha1"in lt.md))throw new Error('"sha1" hash algorithm unavailable.');s=lt.md.sha1.create()}var l=s.digestLength,u=s.blockLength,d=new lt.util.ByteBuffer,p=new lt.util.ByteBuffer;if(t!=null){for(c=0;c<t.length;c++)p.putInt16(t.charCodeAt(c));p.putInt16(0)}var f=p.length(),m=e.length(),h=new lt.util.ByteBuffer;h.fillWithByte(r,u);var g=u*Math.ceil(m/u),v=new lt.util.ByteBuffer;for(c=0;c<g;c++)v.putByte(e.at(c%m));var b=u*Math.ceil(f/u),_=new lt.util.ByteBuffer;for(c=0;c<b;c++)_.putByte(p.at(c%f));var x=v;x.putBuffer(_);for(var S=Math.ceil(o/l),I=1;I<=S;I++){var w=new lt.util.ByteBuffer;w.putBytes(h.bytes()),w.putBytes(x.bytes());for(var k=0;k<n;k++)s.start(),s.update(w.getBytes()),w=s.digest();var M=new lt.util.ByteBuffer;for(c=0;c<u;c++)M.putByte(w.at(c%l));var H=Math.ceil(m/u)+Math.ceil(f/u),F=new lt.util.ByteBuffer;for(a=0;a<H;a++){var ue=new lt.util.ByteBuffer(x.getBytes(u)),Z=511;for(c=M.length()-1;c>=0;c--)Z=Z>>8,Z+=M.at(c)+ue.at(c),ue.setAt(c,Z&255);F.putBuffer(ue)}x=F,d.putBuffer(w)}return d.truncate(d.length()-o),d};lr.pbe.getCipher=function(t,e,r){switch(t){case lr.oids.pkcs5PBES2:return lr.pbe.getCipherForPBES2(t,e,r);case lr.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case lr.oids["pbewithSHAAnd40BitRC2-CBC"]:return lr.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};lr.pbe.getCipherForPBES2=function(t,e,r){var n={},o=[];if(!ve.validate(e,Lot,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}if(t=ve.derToOid(n.kdfOid),t!==lr.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=ve.derToOid(n.encOid),t!==lr.oids["aes128-CBC"]&&t!==lr.oids["aes192-CBC"]&&t!==lr.oids["aes256-CBC"]&&t!==lr.oids["des-EDE3-CBC"]&&t!==lr.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,c=lt.util.createBuffer(n.kdfIterationCount);c=c.getInt(c.length()<<3);var l,u;switch(lr.oids[t]){case"aes128-CBC":l=16,u=lt.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=lt.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=lt.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=lt.des.createDecryptionCipher;break;case"desCBC":l=8,u=lt.des.createDecryptionCipher;break}var d=sCe(n.prfOid),p=lt.pkcs5.pbkdf2(r,a,c,l,d),f=n.encIv,m=u(p);return m.start(f),m};lr.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},o=[];if(!ve.validate(e,Oot,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=lt.util.createBuffer(n.salt),c=lt.util.createBuffer(n.iterations);c=c.getInt(c.length()<<3);var l,u,d;switch(t){case lr.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,u=8,d=lt.des.startDecrypting;break;case lr.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,u=8,d=function(g,v){var b=lt.rc2.createDecryptionCipher(g,40);return b.start(v,null),b};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var p=sCe(n.prfOid),f=lr.pbe.generatePkcs12Key(r,a,1,c,l,p);p.start();var m=lr.pbe.generatePkcs12Key(r,a,2,c,u,p);return d(f,m)};lr.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in lt.md))throw new Error('"md5" hash algorithm unavailable.');n=lt.md.md5.create()}e===null&&(e="");for(var o=[oCe(n,t+e)],s=16,a=1;s<r;++a,s+=16)o.push(oCe(n,o[a-1]+t+e));return o.join("").substr(0,r)};function oCe(t,e){return t.start().update(e).digest().getBytes()}function sCe(t){var e;if(!t)e="hmacWithSHA1";else if(e=lr.oids[ve.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return aCe(e)}function aCe(t){var e=lt.md;switch(t){case"hmacWithSHA224":e=lt.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Mot(t,e,r,n){var o=ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.OCTETSTRING,!1,t),ve.create(ve.Class.UNIVERSAL,ve.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&o.value.push(ve.create(ve.Class.UNIVERSAL,ve.Type.INTEGER,!1,lt.util.hexToBytes(r.toString(16))),ve.create(ve.Class.UNIVERSAL,ve.Type.SEQUENCE,!0,[ve.create(ve.Class.UNIVERSAL,ve.Type.OID,!1,ve.oidToDer(lr.oids[n]).getBytes()),ve.create(ve.Class.UNIVERSAL,ve.Type.NULL,!1,"")])),o}});var Eee=R((J1r,dCe)=>{var IE=dr();Ld();Qr();var rt=IE.asn1,CE=dCe.exports=IE.pkcs7asn1=IE.pkcs7asn1||{};IE.pkcs7=IE.pkcs7||{};IE.pkcs7.asn1=CE;var lCe={name:"ContentInfo",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:rt.Class.UNIVERSAL,type:rt.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:rt.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};CE.contentInfoValidator=lCe;var uCe={name:"EncryptedContentInfo",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:rt.Class.UNIVERSAL,type:rt.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:rt.Class.UNIVERSAL,type:rt.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:rt.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:rt.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};CE.envelopedDataValidator={name:"EnvelopedData",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:rt.Class.UNIVERSAL,type:rt.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(uCe)};CE.encryptedDataValidator={name:"EncryptedData",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:rt.Class.UNIVERSAL,type:rt.Type.INTEGER,constructed:!1,capture:"version"}].concat(uCe)};var Fot={name:"SignerInfo",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:rt.Class.UNIVERSAL,type:rt.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:rt.Class.UNIVERSAL,type:rt.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:rt.Class.UNIVERSAL,type:rt.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:rt.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:rt.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:rt.Class.UNIVERSAL,type:rt.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:rt.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};CE.signedDataValidator={name:"SignedData",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:rt.Class.UNIVERSAL,type:rt.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},lCe,{name:"SignedData.Certificates",tagClass:rt.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:rt.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SET,capture:"signerInfos",optional:!0,value:[Fot]}]};CE.recipientInfoValidator={name:"RecipientInfo",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:rt.Class.UNIVERSAL,type:rt.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:rt.Class.UNIVERSAL,type:rt.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:rt.Class.UNIVERSAL,type:rt.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:rt.Class.UNIVERSAL,type:rt.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:rt.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:rt.Class.UNIVERSAL,type:rt.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var wee=R((Z1r,pCe)=>{var kx=dr();Qr();kx.mgf=kx.mgf||{};var Uot=pCe.exports=kx.mgf.mgf1=kx.mgf1=kx.mgf1||{};Uot.create=function(t){var e={generate:function(r,n){for(var o=new kx.util.ByteBuffer,s=Math.ceil(n/t.digestLength),a=0;a<s;a++){var c=new kx.util.ByteBuffer;c.putInt32(a),t.start(),t.update(r+c.getBytes()),o.putBuffer(t.digest())}return o.truncate(o.length()-n),o.getBytes()}};return e}});var mCe=R((eIr,fCe)=>{var D7=dr();wee();fCe.exports=D7.mgf=D7.mgf||{};D7.mgf.mgf1=D7.mgf1});var N7=R((tIr,hCe)=>{var Rx=dr();su();Qr();var Bot=hCe.exports=Rx.pss=Rx.pss||{};Bot.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,o=t.salt||null;typeof o=="string"&&(o=Rx.util.createBuffer(o));var s;if("saltLength"in t)s=t.saltLength;else if(o!==null)s=o.length();else throw new Error("Salt length not specified or specific salt not given.");if(o!==null&&o.length()!==s)throw new Error("Given salt length does not match length of given salt.");var a=t.prng||Rx.random,c={};return c.encode=function(l,u){var d,p=u-1,f=Math.ceil(p/8),m=l.digest().getBytes();if(f<n+s+2)throw new Error("Message is too long to encrypt.");var h;o===null?h=a.getBytesSync(s):h=o.bytes();var g=new Rx.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(m),g.putBytes(h),e.start(),e.update(g.getBytes());var v=e.digest().getBytes(),b=new Rx.util.ByteBuffer;b.fillWithByte(0,f-s-n-2),b.putByte(1),b.putBytes(h);var _=b.getBytes(),x=f-n-1,S=r.generate(v,x),I="";for(d=0;d<x;d++)I+=String.fromCharCode(_.charCodeAt(d)^S.charCodeAt(d));var w=65280>>8*f-p&255;return I=String.fromCharCode(I.charCodeAt(0)&~w)+I.substr(1),I+v+"\xBC"},c.verify=function(l,u,d){var p,f=d-1,m=Math.ceil(f/8);if(u=u.substr(-m),m<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(m-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=m-n-1,g=u.substr(0,h),v=u.substr(h,n),b=65280>>8*m-f&255;if(g.charCodeAt(0)&b)throw new Error("Bits beyond keysize not zero as expected.");var _=r.generate(v,h),x="";for(p=0;p<h;p++)x+=String.fromCharCode(g.charCodeAt(p)^_.charCodeAt(p));x=String.fromCharCode(x.charCodeAt(0)&~b)+x.substr(1);var S=m-n-s-2;for(p=0;p<S;p++)if(x.charCodeAt(p)!==0)throw new Error("Leftmost octets not zero as expected");if(x.charCodeAt(S)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var I=x.substr(-s),w=new Rx.util.ByteBuffer;w.fillWithByte(0,8),w.putBytes(l),w.putBytes(I),e.start(),e.update(w.getBytes());var k=e.digest().getBytes();return v===k},c}});var M7=R((rIr,_Ce)=>{var At=dr();W0();Ld();tL();af();mCe();K0();Cx();N7();iL();Qr();var N=At.asn1,We=_Ce.exports=At.pki=At.pki||{},zr=We.oids,Hi={};Hi.CN=zr.commonName;Hi.commonName="CN";Hi.C=zr.countryName;Hi.countryName="C";Hi.L=zr.localityName;Hi.localityName="L";Hi.ST=zr.stateOrProvinceName;Hi.stateOrProvinceName="ST";Hi.O=zr.organizationName;Hi.organizationName="O";Hi.OU=zr.organizationalUnitName;Hi.organizationalUnitName="OU";Hi.E=zr.emailAddress;Hi.emailAddress="E";var vCe=At.pki.rsa.publicKeyValidator,qot={name:"Certificate",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:N.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:N.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:N.Class.UNIVERSAL,type:N.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:N.Class.UNIVERSAL,type:N.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:N.Class.UNIVERSAL,type:N.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:N.Class.UNIVERSAL,type:N.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},vCe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:N.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:N.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:N.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:N.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},jot={name:"rsapss",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:N.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:N.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:N.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:N.Class.UNIVERSAL,type:N.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:N.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:N.Class.UNIVERSAL,type:N.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Vot={name:"CertificationRequestInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},vCe,{name:"CertificationRequestInfo.attributes",tagClass:N.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:N.Class.UNIVERSAL,type:N.Type.SET,constructed:!0}]}]}]},Hot={name:"CertificationRequest",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Vot,{name:"CertificationRequest.signatureAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:N.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};We.RDNAttributesAsArray=function(t,e){for(var r=[],n,o,s,a=0;a<t.value.length;++a){n=t.value[a];for(var c=0;c<n.value.length;++c)s={},o=n.value[c],s.type=N.derToOid(o.value[0].value),s.value=o.value[1].value,s.valueTagClass=o.value[1].type,s.type in zr&&(s.name=zr[s.type],s.name in Hi&&(s.shortName=Hi[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};We.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],o=N.derToOid(n.value[0].value),s=n.value[1].value,a=0;a<s.length;++a){var c={};if(c.type=o,c.value=s[a].value,c.valueTagClass=s[a].type,c.type in zr&&(c.name=zr[c.type],c.name in Hi&&(c.shortName=Hi[c.name])),c.type===zr.extensionRequest){c.extensions=[];for(var l=0;l<c.value.length;++l)c.extensions.push(We.certificateExtensionFromAsn1(c.value[l]))}e.push(c)}return e};function X0(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,o=0;r===null&&o<t.attributes.length;++o)n=t.attributes[o],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var L7=function(t,e,r){var n={};if(t!==zr["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:zr.sha1},mgf:{algorithmOid:zr.mgf1,hash:{algorithmOid:zr.sha1}},saltLength:20});var o={},s=[];if(!N.validate(e,jot,o,s)){var a=new Error("Cannot read RSASSA-PSS parameter block.");throw a.errors=s,a}return o.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=N.derToOid(o.hashOid)),o.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=N.derToOid(o.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=N.derToOid(o.maskGenHashOid)),o.saltLength!==void 0&&(n.saltLength=o.saltLength.charCodeAt(0)),n},O7=function(t){switch(zr[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return At.md.sha1.create();case"md5WithRSAEncryption":return At.md.md5.create();case"sha256WithRSAEncryption":return At.md.sha256.create();case"sha384WithRSAEncryption":return At.md.sha384.create();case"sha512WithRSAEncryption":return At.md.sha512.create();case"RSASSA-PSS":return At.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},yCe=function(t){var e=t.certificate,r;switch(e.signatureOid){case zr.sha1WithRSAEncryption:case zr.sha1WithRSASignature:break;case zr["RSASSA-PSS"]:var n,o;if(n=zr[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||At.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(o=zr[e.signatureParameters.mgf.algorithmOid],o===void 0||At.mgf[o]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=o,s}if(o=At.mgf[o].create(At.md[n].create()),n=zr[e.signatureParameters.hash.algorithmOid],n===void 0||At.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=n,s}r=At.pss.create(At.md[n].create(),o,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)};We.certificateFromPem=function(t,e,r){var n=At.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var o=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw o.headerType=n.type,o}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=N.fromDer(n.body,r);return We.certificateFromAsn1(s,e)};We.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:N.toDer(We.certificateToAsn1(t)).getBytes()};return At.pem.encode(r,{maxline:e})};We.publicKeyFromPem=function(t){var e=At.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=N.fromDer(e.body);return We.publicKeyFromAsn1(n)};We.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:N.toDer(We.publicKeyToAsn1(t)).getBytes()};return At.pem.encode(r,{maxline:e})};We.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:N.toDer(We.publicKeyToRSAPublicKey(t)).getBytes()};return At.pem.encode(r,{maxline:e})};We.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||At.md.sha1.create(),n=e.type||"RSAPublicKey",o;switch(n){case"RSAPublicKey":o=N.toDer(We.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":o=N.toDer(We.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(o);var s=r.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};We.certificationRequestFromPem=function(t,e,r){var n=At.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var o=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw o.headerType=n.type,o}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=N.fromDer(n.body,r);return We.certificationRequestFromAsn1(s,e)};We.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:N.toDer(We.certificationRequestToAsn1(t)).getBytes()};return At.pem.encode(r,{maxline:e})};We.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return X0(t.issuer,e)},t.issuer.addField=function(e){lu([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return X0(t.subject,e)},t.subject.addField=function(e){lu([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){lu(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){lu(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)bCe(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,o=0;r===null&&o<t.extensions.length;++o)n=t.extensions[o],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||At.md.sha1.create();var n=zr[t.md.algorithm+"WithRSAEncryption"];if(!n){var o=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw o.algorithm=t.md.algorithm,o}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=We.getTBSCertificate(t);var s=N.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,o=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=o.attributes,s.actualIssuer=n.attributes,s}var a=e.md;if(a===null){a=O7({signatureOid:e.signatureOid,type:"certificate"});var c=e.tbsCertificate||We.getTBSCertificate(e),l=N.toDer(c);a.update(l.getBytes())}return a!==null&&(r=yCe({certificate:t,md:a,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,o=e.subject;if(n.hash&&o.hash)r=n.hash===o.hash;else if(n.attributes.length===o.attributes.length){r=!0;for(var s,a,c=0;r&&c<n.attributes.length;++c)s=n.attributes[c],a=o.attributes[c],(s.type!==a.type||s.value!==a.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return We.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=zr.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var o=t.generateSubjectKeyIdentifier().getBytes();return At.util.hexToBytes(n.subjectKeyIdentifier)===o}}return!1},t};We.certificateFromAsn1=function(t,e){var r={},n=[];if(!N.validate(t,qot,r,n)){var o=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw o.errors=n,o}var s=N.derToOid(r.publicKeyOid);if(s!==We.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=We.createCertificate();a.version=r.certVersion?r.certVersion.charCodeAt(0):0;var c=At.util.createBuffer(r.certSerialNumber);a.serialNumber=c.toHex(),a.signatureOid=At.asn1.derToOid(r.certSignatureOid),a.signatureParameters=L7(a.signatureOid,r.certSignatureParams,!0),a.siginfo.algorithmOid=At.asn1.derToOid(r.certinfoSignatureOid),a.siginfo.parameters=L7(a.siginfo.algorithmOid,r.certinfoSignatureParams,!1),a.signature=r.certSignature;var l=[];if(r.certValidity1UTCTime!==void 0&&l.push(N.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&l.push(N.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&l.push(N.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&l.push(N.generalizedTimeToDate(r.certValidity4GeneralizedTime)),l.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=l[0],a.validity.notAfter=l[1],a.tbsCertificate=r.tbsCertificate,e){a.md=O7({signatureOid:a.signatureOid,type:"certificate"});var u=N.toDer(a.tbsCertificate);a.md.update(u.getBytes())}var d=At.md.sha1.create(),p=N.toDer(r.certIssuer);d.update(p.getBytes()),a.issuer.getField=function(h){return X0(a.issuer,h)},a.issuer.addField=function(h){lu([h]),a.issuer.attributes.push(h)},a.issuer.attributes=We.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(a.issuer.uniqueId=r.certIssuerUniqueId),a.issuer.hash=d.digest().toHex();var f=At.md.sha1.create(),m=N.toDer(r.certSubject);return f.update(m.getBytes()),a.subject.getField=function(h){return X0(a.subject,h)},a.subject.addField=function(h){lu([h]),a.subject.attributes.push(h)},a.subject.attributes=We.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(a.subject.uniqueId=r.certSubjectUniqueId),a.subject.hash=f.digest().toHex(),r.certExtensions?a.extensions=We.certificateExtensionsFromAsn1(r.certExtensions):a.extensions=[],a.publicKey=We.publicKeyFromAsn1(r.subjectPublicKeyInfo),a};We.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],o=0;o<n.value.length;++o)e.push(We.certificateExtensionFromAsn1(n.value[o]));return e};We.certificateExtensionFromAsn1=function(t){var e={};if(e.id=N.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===N.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in zr){if(e.name=zr[e.id],e.name==="keyUsage"){var r=N.fromDer(e.value),n=0,o=0;r.value.length>1&&(n=r.value.charCodeAt(1),o=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)===128,e.nonRepudiation=(n&64)===64,e.keyEncipherment=(n&32)===32,e.dataEncipherment=(n&16)===16,e.keyAgreement=(n&8)===8,e.keyCertSign=(n&4)===4,e.cRLSign=(n&2)===2,e.encipherOnly=(n&1)===1,e.decipherOnly=(o&128)===128}else if(e.name==="basicConstraints"){var r=N.fromDer(e.value);r.value.length>0&&r.value[0].type===N.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===N.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=N.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=N.fromDer(e.value),a=0;a<r.value.length;++a){var c=N.derToOid(r.value[a].value);c in zr?e[zr[c]]=!0:e[c]=!0}else if(e.name==="nsCertType"){var r=N.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)===128,e.server=(n&64)===64,e.email=(n&32)===32,e.objsign=(n&16)===16,e.reserved=(n&8)===8,e.sslCA=(n&4)===4,e.emailCA=(n&2)===2,e.objCA=(n&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var l,r=N.fromDer(e.value),u=0;u<r.value.length;++u){l=r.value[u];var d={type:l.type,value:l.value};switch(e.altNames.push(d),l.type){case 1:case 2:case 6:break;case 7:d.ip=At.util.bytesToIP(l.value);break;case 8:d.oid=N.derToOid(l.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=N.fromDer(e.value);e.subjectKeyIdentifier=At.util.bytesToHex(r.value)}}return e};We.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!N.validate(t,Hot,r,n)){var o=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw o.errors=n,o}var s=N.derToOid(r.publicKeyOid);if(s!==We.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=We.createCertificationRequest();if(a.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,a.signatureOid=At.asn1.derToOid(r.csrSignatureOid),a.signatureParameters=L7(a.signatureOid,r.csrSignatureParams,!0),a.siginfo.algorithmOid=At.asn1.derToOid(r.csrSignatureOid),a.siginfo.parameters=L7(a.siginfo.algorithmOid,r.csrSignatureParams,!1),a.signature=r.csrSignature,a.certificationRequestInfo=r.certificationRequestInfo,e){a.md=O7({signatureOid:a.signatureOid,type:"certification request"});var c=N.toDer(a.certificationRequestInfo);a.md.update(c.getBytes())}var l=At.md.sha1.create();return a.subject.getField=function(u){return X0(a.subject,u)},a.subject.addField=function(u){lu([u]),a.subject.attributes.push(u)},a.subject.attributes=We.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),a.subject.hash=l.digest().toHex(),a.publicKey=We.publicKeyFromAsn1(r.subjectPublicKeyInfo),a.getAttribute=function(u){return X0(a,u)},a.addAttribute=function(u){lu([u]),a.attributes.push(u)},a.attributes=We.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),a};We.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return X0(t.subject,e)},t.subject.addField=function(e){lu([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return X0(t,e)},t.addAttribute=function(e){lu([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){lu(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){lu(e),t.attributes=e},t.sign=function(e,r){t.md=r||At.md.sha1.create();var n=zr[t.md.algorithm+"WithRSAEncryption"];if(!n){var o=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw o.algorithm=t.md.algorithm,o}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=We.getCertificationRequestInfo(t);var s=N.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=O7({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||We.getCertificationRequestInfo(t),o=N.toDer(n);r.update(o.getBytes())}return r!==null&&(e=yCe({certificate:t,md:r,signature:t.signature})),e},t};function TE(t){for(var e=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]),r,n,o=t.attributes,s=0;s<o.length;++s){r=o[s];var a=r.value,c=N.Type.PRINTABLESTRING;"valueTagClass"in r&&(c=r.valueTagClass,c===N.Type.UTF8&&(a=At.util.encodeUtf8(a))),n=N.create(N.Class.UNIVERSAL,N.Type.SET,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(r.type).getBytes()),N.create(N.Class.UNIVERSAL,c,!1,a)])]),e.value.push(n)}return e}function lu(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name>"u"&&(e.type&&e.type in We.oids?e.name=We.oids[e.type]:e.shortName&&e.shortName in Hi&&(e.name=We.oids[Hi[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in We.oids)e.type=We.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName>"u"&&e.name&&e.name in Hi&&(e.shortName=Hi[e.name]),e.type===zr.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=N.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var o=0;o<e.extensions.length;++o)e.value.push(We.certificateExtensionToAsn1(bCe(e.extensions[o])))}if(typeof e.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function bCe(t,e){if(e=e||{},typeof t.name>"u"&&t.id&&t.id in We.oids&&(t.name=We.oids[t.id]),typeof t.id>"u")if(t.name&&t.name in We.oids)t.id=We.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value<"u")return t;if(t.name==="keyUsage"){var n=0,o=0,s=0;t.digitalSignature&&(o|=128,n=7),t.nonRepudiation&&(o|=64,n=6),t.keyEncipherment&&(o|=32,n=5),t.dataEncipherment&&(o|=16,n=4),t.keyAgreement&&(o|=8,n=3),t.keyCertSign&&(o|=4,n=2),t.cRLSign&&(o|=2,n=1),t.encipherOnly&&(o|=1,n=0),t.decipherOnly&&(s|=128,n=7);var a=String.fromCharCode(n);s!==0?a+=String.fromCharCode(o)+String.fromCharCode(s):o!==0&&(a+=String.fromCharCode(o)),t.value=N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,a)}else if(t.name==="basicConstraints")t.value=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(N.create(N.Class.UNIVERSAL,N.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in t&&t.value.value.push(N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);var c=t.value.value;for(var l in t)t[l]===!0&&(l in zr?c.push(N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(zr[l]).getBytes())):l.indexOf(".")!==-1&&c.push(N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(l).getBytes())))}else if(t.name==="nsCertType"){var n=0,o=0;t.client&&(o|=128,n=7),t.server&&(o|=64,n=6),t.email&&(o|=32,n=5),t.objsign&&(o|=16,n=4),t.reserved&&(o|=8,n=3),t.sslCA&&(o|=4,n=2),t.emailCA&&(o|=2,n=1),t.objCA&&(o|=1,n=0);var a=String.fromCharCode(n);o!==0&&(a+=String.fromCharCode(o)),t.value=N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,a)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);for(var u,d=0;d<t.altNames.length;++d){u=t.altNames[d];var a=u.value;if(u.type===7&&u.ip){if(a=At.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?a=N.oidToDer(N.oidToDer(u.oid)):a=N.oidToDer(a));t.value.value.push(N.create(N.Class.CONTEXT_SPECIFIC,u.type,!1,a))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=N.create(N.Class.UNIVERSAL,N.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var p=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=p.toHex(),t.value=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,p.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);var c=t.value.value;if(t.keyIdentifier){var f=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;c.push(N.create(N.Class.CONTEXT_SPECIFIC,0,!1,f))}if(t.authorityCertIssuer){var m=[N.create(N.Class.CONTEXT_SPECIFIC,4,!0,[TE(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];c.push(N.create(N.Class.CONTEXT_SPECIFIC,1,!0,m))}if(t.serialNumber){var h=At.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);c.push(N.create(N.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(t.name==="cRLDistributionPoints"){t.value=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);for(var c=t.value.value,g=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]),v=N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[]),u,d=0;d<t.altNames.length;++d){u=t.altNames[d];var a=u.value;if(u.type===7&&u.ip){if(a=At.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?a=N.oidToDer(N.oidToDer(u.oid)):a=N.oidToDer(a));v.value.push(N.create(N.Class.CONTEXT_SPECIFIC,u.type,!1,a))}g.value.push(N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[v])),c.push(g)}if(typeof t.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function kee(t,e){switch(t){case zr["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(e.hash.algorithmOid).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(N.create(N.Class.CONTEXT_SPECIFIC,1,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(e.mgf.algorithmOid).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(e.mgf.hash.algorithmOid).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(N.create(N.Class.CONTEXT_SPECIFIC,2,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(e.saltLength).getBytes())])),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,r);default:return N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")}}function Got(t){var e=N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var o=r[n],s=o.value,a=N.Type.UTF8;"valueTagClass"in o&&(a=o.valueTagClass),a===N.Type.UTF8&&(s=At.util.encodeUtf8(s));var c=!1;"valueConstructed"in o&&(c=o.valueConstructed);var l=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(o.type).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SET,!0,[N.create(N.Class.UNIVERSAL,a,c,s)])]);e.value.push(l)}return e}var zot=new Date("1950-01-01T00:00:00Z"),$ot=new Date("2050-01-01T00:00:00Z");function gCe(t){return t>=zot&&t<$ot?N.create(N.Class.UNIVERSAL,N.Type.UTCTIME,!1,N.dateToUtcTime(t)):N.create(N.Class.UNIVERSAL,N.Type.GENERALIZEDTIME,!1,N.dateToGeneralizedTime(t))}We.getTBSCertificate=function(t){var e=gCe(t.validity.notBefore),r=gCe(t.validity.notAfter),n=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes())]),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,At.util.hexToBytes(t.serialNumber)),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.siginfo.algorithmOid).getBytes()),kee(t.siginfo.algorithmOid,t.siginfo.parameters)]),TE(t.issuer),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[e,r]),TE(t.subject),We.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(N.create(N.Class.CONTEXT_SPECIFIC,1,!0,[N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,"\0"+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(N.create(N.Class.CONTEXT_SPECIFIC,2,!0,[N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,"\0"+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(We.certificateExtensionsToAsn1(t.extensions)),n};We.getCertificationRequestInfo=function(t){var e=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),TE(t.subject),We.publicKeyToAsn1(t.publicKey),Got(t)]);return e};We.distinguishedNameToAsn1=function(t){return TE(t)};We.certificateToAsn1=function(t){var e=t.tbsCertificate||We.getTBSCertificate(t);return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[e,N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.signatureOid).getBytes()),kee(t.signatureOid,t.signatureParameters)]),N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,"\0"+t.signature)])};We.certificateExtensionsToAsn1=function(t){var e=N.create(N.Class.CONTEXT_SPECIFIC,3,!0,[]),r=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(We.certificateExtensionToAsn1(t[n]));return e};We.certificateExtensionToAsn1=function(t){var e=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);e.value.push(N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.id).getBytes())),t.critical&&e.value.push(N.create(N.Class.UNIVERSAL,N.Type.BOOLEAN,!1,"\xFF"));var r=t.value;return typeof t.value!="string"&&(r=N.toDer(r).getBytes()),e.value.push(N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,r)),e};We.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||We.getCertificationRequestInfo(t);return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[e,N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.signatureOid).getBytes()),kee(t.signatureOid,t.signatureParameters)]),N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,"\0"+t.signature)])};We.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(a){var c=r(a.issuer);return c},e.addCertificate=function(a){if(typeof a=="string"&&(a=At.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))if(a.subject.hash in e.certs){var c=e.certs[a.subject.hash];At.util.isArray(c)||(c=[c]),c.push(a),e.certs[a.subject.hash]=c}else e.certs[a.subject.hash]=a},e.hasCertificate=function(a){typeof a=="string"&&(a=At.pki.certificateFromPem(a));var c=r(a.subject);if(!c)return!1;At.util.isArray(c)||(c=[c]);for(var l=N.toDer(We.certificateToAsn1(a)).getBytes(),u=0;u<c.length;++u){var d=N.toDer(We.certificateToAsn1(c[u])).getBytes();if(l===d)return!0}return!1},e.listAllCertificates=function(){var a=[];for(var c in e.certs)if(e.certs.hasOwnProperty(c)){var l=e.certs[c];if(!At.util.isArray(l))a.push(l);else for(var u=0;u<l.length;++u)a.push(l[u])}return a},e.removeCertificate=function(a){var c;if(typeof a=="string"&&(a=At.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))return null;var l=r(a.subject);if(!At.util.isArray(l))return c=e.certs[a.subject.hash],delete e.certs[a.subject.hash],c;for(var u=N.toDer(We.certificateToAsn1(a)).getBytes(),d=0;d<l.length;++d){var p=N.toDer(We.certificateToAsn1(l[d])).getBytes();u===p&&(c=l[d],l.splice(d,1))}return l.length===0&&delete e.certs[a.subject.hash],c};function r(a){return n(a),e.certs[a.hash]||null}function n(a){if(!a.hash){var c=At.md.sha1.create();a.attributes=We.RDNAttributesAsArray(TE(a),c),a.hash=c.digest().toHex()}}if(t)for(var o=0;o<t.length;++o){var s=t[o];e.addCertificate(s)}return e};We.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};We.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),o=r.validityCheckDate;typeof o>"u"&&(o=new Date);var s=!0,a=null,c=0;do{var l=e.shift(),u=null,d=!1;if(o&&(o<l.validity.notBefore||o>l.validity.notAfter)&&(a={message:"Certificate is not valid yet or has expired.",error:We.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:o}),a===null){if(u=e[0]||t.getIssuer(l),u===null&&l.isIssuer(l)&&(d=!0,u=l),u){var p=u;At.util.isArray(p)||(p=[p]);for(var f=!1;!f&&p.length>0;){u=p.shift();try{f=u.verify(l)}catch{}}f||(a={message:"Certificate signature is invalid.",error:We.certificateError.bad_certificate})}a===null&&(!u||d)&&!t.hasCertificate(l)&&(a={message:"Certificate is not trusted.",error:We.certificateError.unknown_ca})}if(a===null&&u&&!l.isIssuer(u)&&(a={message:"Certificate issuer is invalid.",error:We.certificateError.bad_certificate}),a===null)for(var m={keyUsage:!0,basicConstraints:!0},h=0;a===null&&h<l.extensions.length;++h){var g=l.extensions[h];g.critical&&!(g.name in m)&&(a={message:"Certificate has an unsupported critical extension.",error:We.certificateError.unsupported_certificate})}if(a===null&&(!s||e.length===0&&(!u||d))){var v=l.getExtension("basicConstraints"),b=l.getExtension("keyUsage");if(b!==null&&(!b.keyCertSign||v===null)&&(a={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:We.certificateError.bad_certificate}),a===null&&v!==null&&!v.cA&&(a={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:We.certificateError.bad_certificate}),a===null&&b!==null&&"pathLenConstraint"in v){var _=c-1;_>v.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:We.certificateError.bad_certificate})}}var x=a===null?!0:a.error,S=r.verify?r.verify(x,c,n):x;if(S===!0)a=null;else throw x===!0&&(a={message:"The application rejected the certificate.",error:We.certificateError.bad_certificate}),(S||S===0)&&(typeof S=="object"&&!At.util.isArray(S)?(S.message&&(a.message=S.message),S.error&&(a.error=S.error)):typeof S=="string"&&(a.error=S)),a;s=!1,++c}while(e.length>0);return!0}});var Pee=R((nIr,SCe)=>{var Hn=dr();Ld();yE();K0();Eee();Tee();su();iL();SE();Qr();M7();var z=Hn.asn1,kr=Hn.pki,sL=SCe.exports=Hn.pkcs12=Hn.pkcs12||{},xCe={name:"ContentInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:z.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},Wot={name:"PFX",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"version"},xCe,{name:"PFX.macData",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:z.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},Kot={name:"SafeBag",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:z.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:z.Class.UNIVERSAL,type:z.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},Yot={name:"Attribute",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:z.Class.UNIVERSAL,type:z.Type.SET,constructed:!0,capture:"values"}]},Qot={name:"CertBag",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:z.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:z.Class.UNIVERSAL,type:z.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function oL(t,e,r,n){for(var o=[],s=0;s<t.length;s++)for(var a=0;a<t[s].safeBags.length;a++){var c=t[s].safeBags[a];if(!(n!==void 0&&c.type!==n)){if(e===null){o.push(c);continue}c.attributes[e]!==void 0&&c.attributes[e].indexOf(r)>=0&&o.push(c)}}return o}sL.pkcs12FromAsn1=function(t,e,r){typeof e=="string"?(r=e,e=!0):e===void 0&&(e=!0);var n={},o=[];if(!z.validate(t,Wot,n,o)){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var a={version:n.version.charCodeAt(0),safeContents:[],getBags:function(v){var b={},_;return"localKeyId"in v?_=v.localKeyId:"localKeyIdHex"in v&&(_=Hn.util.hexToBytes(v.localKeyIdHex)),_===void 0&&!("friendlyName"in v)&&"bagType"in v&&(b[v.bagType]=oL(a.safeContents,null,null,v.bagType)),_!==void 0&&(b.localKeyId=oL(a.safeContents,"localKeyId",_,v.bagType)),"friendlyName"in v&&(b.friendlyName=oL(a.safeContents,"friendlyName",v.friendlyName,v.bagType)),b},getBagsByFriendlyName:function(v,b){return oL(a.safeContents,"friendlyName",v,b)},getBagsByLocalKeyId:function(v,b){return oL(a.safeContents,"localKeyId",v,b)}};if(n.version.charCodeAt(0)!==3){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=n.version.charCodeAt(0),s}if(z.derToOid(n.contentType)!==kr.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=z.derToOid(n.contentType),s}var c=n.content.value[0];if(c.tagClass!==z.Class.UNIVERSAL||c.type!==z.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=Ree(c),n.mac){var l=null,u=0,d=z.derToOid(n.macAlgorithm);switch(d){case kr.oids.sha1:l=Hn.md.sha1.create(),u=20;break;case kr.oids.sha256:l=Hn.md.sha256.create(),u=32;break;case kr.oids.sha384:l=Hn.md.sha384.create(),u=48;break;case kr.oids.sha512:l=Hn.md.sha512.create(),u=64;break;case kr.oids.md5:l=Hn.md.md5.create(),u=16;break}if(l===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+d);var p=new Hn.util.ByteBuffer(n.macSalt),f="macIterations"in n?parseInt(Hn.util.bytesToHex(n.macIterations),16):1,m=sL.generateKey(r,p,3,f,u,l),h=Hn.hmac.create();h.start(l,m),h.update(c.value);var g=h.getMac();if(g.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return Xot(a,c.value,e,r),a};function Ree(t){if(t.composed||t.constructed){for(var e=Hn.util.createBuffer(),r=0;r<t.value.length;++r)e.putBytes(t.value[r].value);t.composed=t.constructed=!1,t.value=e.getBytes()}return t}function Xot(t,e,r,n){if(e=z.fromDer(e,r),e.tagClass!==z.Class.UNIVERSAL||e.type!==z.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var o=0;o<e.value.length;o++){var s=e.value[o],a={},c=[];if(!z.validate(s,xCe,a,c)){var l=new Error("Cannot read ContentInfo.");throw l.errors=c,l}var u={encrypted:!1},d=null,p=a.content.value[0];switch(z.derToOid(a.contentType)){case kr.oids.data:if(p.tagClass!==z.Class.UNIVERSAL||p.type!==z.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=Ree(p).value;break;case kr.oids.encryptedData:d=Jot(p,n),u.encrypted=!0;break;default:var l=new Error("Unsupported PKCS#12 contentType.");throw l.contentType=z.derToOid(a.contentType),l}u.safeBags=Zot(d,r,n),t.safeContents.push(u)}}function Jot(t,e){var r={},n=[];if(!z.validate(t,Hn.pkcs7.asn1.encryptedDataValidator,r,n)){var o=new Error("Cannot read EncryptedContentInfo.");throw o.errors=n,o}var s=z.derToOid(r.contentType);if(s!==kr.oids.data){var o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw o.oid=s,o}s=z.derToOid(r.encAlgorithm);var a=kr.pbe.getCipher(s,r.encParameter,e),c=Ree(r.encryptedContentAsn1),l=Hn.util.createBuffer(c.value);if(a.update(l),!a.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return a.output.getBytes()}function Zot(t,e,r){if(!e&&t.length===0)return[];if(t=z.fromDer(t,e),t.tagClass!==z.Class.UNIVERSAL||t.type!==z.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],o=0;o<t.value.length;o++){var s=t.value[o],a={},c=[];if(!z.validate(s,Kot,a,c)){var l=new Error("Cannot read SafeBag.");throw l.errors=c,l}var u={type:z.derToOid(a.bagId),attributes:est(a.bagAttributes)};n.push(u);var d,p,f=a.bagValue.value[0];switch(u.type){case kr.oids.pkcs8ShroudedKeyBag:if(f=kr.decryptPrivateKeyInfo(f,r),f===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case kr.oids.keyBag:try{u.key=kr.privateKeyFromAsn1(f)}catch{u.key=null,u.asn1=f}continue;case kr.oids.certBag:d=Qot,p=function(){if(z.derToOid(a.certId)!==kr.oids.x509Certificate){var h=new Error("Unsupported certificate type, only X.509 supported.");throw h.oid=z.derToOid(a.certId),h}var g=z.fromDer(a.cert,e);try{u.cert=kr.certificateFromAsn1(g,!0)}catch{u.cert=null,u.asn1=g}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=u.type,l}if(d!==void 0&&!z.validate(f,d,a,c)){var l=new Error("Cannot read PKCS#12 "+d.name);throw l.errors=c,l}p()}return n}function est(t){var e={};if(t!==void 0)for(var r=0;r<t.length;++r){var n={},o=[];if(!z.validate(t[r],Yot,n,o)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=o,s}var a=z.derToOid(n.oid);if(kr.oids[a]!==void 0){e[kr.oids[a]]=[];for(var c=0;c<n.values.length;++c)e[kr.oids[a]].push(n.values[c].value)}}return e}sL.toPkcs12Asn1=function(t,e,r,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var o=n.localKeyId,s;if(o!==null)o=Hn.util.hexToBytes(o);else if(n.generateLocalKeyId)if(e){var a=Hn.util.isArray(e)?e[0]:e;typeof a=="string"&&(a=kr.certificateFromPem(a));var c=Hn.md.sha1.create();c.update(z.toDer(kr.certificateToAsn1(a)).getBytes()),o=c.digest().getBytes()}else o=Hn.random.getBytes(20);var l=[];o!==null&&l.push(z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.localKeyId).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SET,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,o)])])),"friendlyName"in n&&l.push(z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.friendlyName).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SET,!0,[z.create(z.Class.UNIVERSAL,z.Type.BMPSTRING,!1,n.friendlyName)])])),l.length>0&&(s=z.create(z.Class.UNIVERSAL,z.Type.SET,!0,l));var u=[],d=[];e!==null&&(Hn.util.isArray(e)?d=e:d=[e]);for(var p=[],f=0;f<d.length;++f){e=d[f],typeof e=="string"&&(e=kr.certificateFromPem(e));var m=f===0?s:void 0,h=kr.certificateToAsn1(e),g=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.certBag).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.x509Certificate).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(h).getBytes())])])]),m]);p.push(g)}if(p.length>0){var v=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,p),b=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.data).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(v).getBytes())])]);u.push(b)}var _=null;if(t!==null){var x=kr.wrapRsaPrivateKey(kr.privateKeyToAsn1(t));r===null?_=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.keyBag).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[x]),s]):_=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.pkcs8ShroudedKeyBag).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[kr.encryptPrivateKeyInfo(x,r,n)]),s]);var S=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[_]),I=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.data).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(S).getBytes())])]);u.push(I)}var w=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,u),k;if(n.useMac){var c=Hn.md.sha1.create(),M=new Hn.util.ByteBuffer(Hn.random.getBytes(n.saltSize)),H=n.count,t=sL.generateKey(r,M,3,H,20),F=Hn.hmac.create();F.start(c,t),F.update(z.toDer(w).getBytes());var ue=F.getMac();k=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.sha1).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,"")]),z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,ue.getBytes())]),z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,M.getBytes()),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(H).getBytes())])}return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(3).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(kr.oids.data).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(w).getBytes())])]),k])};sL.generateKey=Hn.pbe.generatePkcs12Key});var Dee=R((iIr,ICe)=>{var J0=dr();Ld();K0();Tee();Cx();E7();Pee();N7();iL();Qr();M7();var Aee=J0.asn1,EE=ICe.exports=J0.pki=J0.pki||{};EE.pemToDer=function(t){var e=J0.pem.decode(t)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return J0.util.createBuffer(e.body)};EE.privateKeyFromPem=function(t){var e=J0.pem.decode(t)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=Aee.fromDer(e.body);return EE.privateKeyFromAsn1(n)};EE.privateKeyToPem=function(t,e){var r={type:"RSA PRIVATE KEY",body:Aee.toDer(EE.privateKeyToAsn1(t)).getBytes()};return J0.pem.encode(r,{maxline:e})};EE.privateKeyInfoToPem=function(t,e){var r={type:"PRIVATE KEY",body:Aee.toDer(t).getBytes()};return J0.pem.encode(r,{maxline:e})}});var Uee=R((oIr,ACe)=>{var ke=dr();Ld();yE();S7();Cx();Dee();su();SE();Qr();var q7=function(t,e,r,n){var o=ke.util.createBuffer(),s=t.length>>1,a=s+(t.length&1),c=t.substr(0,a),l=t.substr(s,a),u=ke.util.createBuffer(),d=ke.hmac.create();r=e+r;var p=Math.ceil(n/16),f=Math.ceil(n/20);d.start("MD5",c);var m=ke.util.createBuffer();u.putBytes(r);for(var h=0;h<p;++h)d.start(null,null),d.update(u.getBytes()),u.putBuffer(d.digest()),d.start(null,null),d.update(u.bytes()+r),m.putBuffer(d.digest());d.start("SHA1",l);var g=ke.util.createBuffer();u.clear(),u.putBytes(r);for(var h=0;h<f;++h)d.start(null,null),d.update(u.getBytes()),u.putBuffer(d.digest()),d.start(null,null),d.update(u.bytes()+r),g.putBuffer(d.digest());return o.putBytes(ke.util.xorBytes(m.getBytes(),g.getBytes(),n)),o},tst=function(t,e,r){var n=ke.hmac.create();n.start("SHA1",t);var o=ke.util.createBuffer();return o.putInt32(e[0]),o.putInt32(e[1]),o.putByte(r.type),o.putByte(r.version.major),o.putByte(r.version.minor),o.putInt16(r.length),o.putBytes(r.fragment.bytes()),n.update(o.getBytes()),n.digest().getBytes()},rst=function(t,e,r){var n=!1;try{var o=t.deflate(e.fragment.getBytes());e.fragment=ke.util.createBuffer(o),e.length=o.length,n=!0}catch{}return n},nst=function(t,e,r){var n=!1;try{var o=t.inflate(e.fragment.getBytes());e.fragment=ke.util.createBuffer(o),e.length=o.length,n=!0}catch{}return n},vl=function(t,e){var r=0;switch(e){case 1:r=t.getByte();break;case 2:r=t.getInt16();break;case 3:r=t.getInt24();break;case 4:r=t.getInt32();break}return ke.util.createBuffer(t.getBytes(r))},uu=function(t,e,r){t.putInt(r.length(),e<<3),t.putBuffer(r)},O={};O.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};O.SupportedVersions=[O.Versions.TLS_1_1,O.Versions.TLS_1_0];O.Version=O.SupportedVersions[0];O.MaxFragment=15360;O.ConnectionEnd={server:0,client:1};O.PRFAlgorithm={tls_prf_sha256:0};O.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};O.CipherType={stream:0,block:1,aead:2};O.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};O.CompressionMethod={none:0,deflate:1};O.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};O.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};O.Alert={};O.Alert.Level={warning:1,fatal:2};O.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};O.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};O.CipherSuites={};O.getCipherSuite=function(t){var e=null;for(var r in O.CipherSuites){var n=O.CipherSuites[r];if(n.id[0]===t.charCodeAt(0)&&n.id[1]===t.charCodeAt(1)){e=n;break}}return e};O.handleUnexpected=function(t,e){var r=!t.open&&t.entity===O.ConnectionEnd.client;r||t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.unexpected_message}})};O.handleHelloRequest=function(t,e,r){!t.handshaking&&t.handshakes>0&&(O.queue(t,O.createAlert(t,{level:O.Alert.Level.warning,description:O.Alert.Description.no_renegotiation})),O.flush(t)),t.process()};O.parseHelloMessage=function(t,e,r){var n=null,o=t.entity===O.ConnectionEnd.client;if(r<38)t.error(t,{message:o?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.illegal_parameter}});else{var s=e.fragment,a=s.length();if(n={version:{major:s.getByte(),minor:s.getByte()},random:ke.util.createBuffer(s.getBytes(32)),session_id:vl(s,1),extensions:[]},o?(n.cipher_suite=s.getBytes(2),n.compression_method=s.getByte()):(n.cipher_suites=vl(s,2),n.compression_methods=vl(s,1)),a=r-(a-s.length()),a>0){for(var c=vl(s,2);c.length()>0;)n.extensions.push({type:[c.getByte(),c.getByte()],data:vl(c,2)});if(!o)for(var l=0;l<n.extensions.length;++l){var u=n.extensions[l];if(u.type[0]===0&&u.type[1]===0)for(var d=vl(u.data,2);d.length()>0;){var p=d.getByte();if(p!==0)break;t.session.extensions.server_name.serverNameList.push(vl(d,2).getBytes())}}}if(t.session.version&&(n.version.major!==t.session.version.major||n.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.protocol_version}});if(o)t.session.cipherSuite=O.getCipherSuite(n.cipher_suite);else for(var f=ke.util.createBuffer(n.cipher_suites.bytes());f.length()>0&&(t.session.cipherSuite=O.getCipherSuite(f.getBytes(2)),t.session.cipherSuite===null););if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.handshake_failure},cipherSuite:ke.util.bytesToHex(n.cipher_suite)});o?t.session.compressionMethod=n.compression_method:t.session.compressionMethod=O.CompressionMethod.none}return n};O.createSecurityParameters=function(t,e){var r=t.entity===O.ConnectionEnd.client,n=e.random.bytes(),o=r?t.session.sp.client_random:n,s=r?n:O.createRandom().getBytes();t.session.sp={entity:t.entity,prf_algorithm:O.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:t.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:o,server_random:s}};O.handleServerHello=function(t,e,r){var n=O.parseHelloMessage(t,e,r);if(!t.fail){if(n.version.minor<=t.version.minor)t.version.minor=n.version.minor;else return t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.protocol_version}});t.session.version=t.version;var o=n.session_id.bytes();o.length>0&&o===t.session.id?(t.expect=ECe,t.session.resuming=!0,t.session.sp.server_random=n.random.bytes()):(t.expect=ost,t.session.resuming=!1,O.createSecurityParameters(t,n)),t.session.id=o,t.process()}};O.handleClientHello=function(t,e,r){var n=O.parseHelloMessage(t,e,r);if(!t.fail){var o=n.session_id.bytes(),s=null;if(t.sessionCache&&(s=t.sessionCache.getSession(o),s===null?o="":(s.version.major!==n.version.major||s.version.minor>n.version.minor)&&(s=null,o="")),o.length===0&&(o=ke.random.getBytes(32)),t.session.id=o,t.session.clientHelloVersion=n.version,t.session.sp={},s)t.version=t.session.version=s.version,t.session.sp=s.sp;else{for(var a,c=1;c<O.SupportedVersions.length&&(a=O.SupportedVersions[c],!(a.minor<=n.version.minor));++c);t.version={major:a.major,minor:a.minor},t.session.version=t.version}s!==null?(t.expect=Mee,t.session.resuming=!0,t.session.sp.client_random=n.random.bytes()):(t.expect=t.verifyClient!==!1?pst:Oee,t.session.resuming=!1,O.createSecurityParameters(t,n)),t.open=!0,O.queue(t,O.createRecord(t,{type:O.ContentType.handshake,data:O.createServerHello(t)})),t.session.resuming?(O.queue(t,O.createRecord(t,{type:O.ContentType.change_cipher_spec,data:O.createChangeCipherSpec()})),t.state.pending=O.createConnectionState(t),t.state.current.write=t.state.pending.write,O.queue(t,O.createRecord(t,{type:O.ContentType.handshake,data:O.createFinished(t)}))):(O.queue(t,O.createRecord(t,{type:O.ContentType.handshake,data:O.createCertificate(t)})),t.fail||(O.queue(t,O.createRecord(t,{type:O.ContentType.handshake,data:O.createServerKeyExchange(t)})),t.verifyClient!==!1&&O.queue(t,O.createRecord(t,{type:O.ContentType.handshake,data:O.createCertificateRequest(t)})),O.queue(t,O.createRecord(t,{type:O.ContentType.handshake,data:O.createServerHelloDone(t)})))),O.flush(t),t.process()}};O.handleCertificate=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.illegal_parameter}});var n=e.fragment,o={certificate_list:vl(n,3)},s,a,c=[];try{for(;o.certificate_list.length()>0;)s=vl(o.certificate_list,3),a=ke.asn1.fromDer(s),s=ke.pki.certificateFromAsn1(a,!0),c.push(s)}catch(u){return t.error(t,{message:"Could not parse certificate list.",cause:u,send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.bad_certificate}})}var l=t.entity===O.ConnectionEnd.client;(l||t.verifyClient===!0)&&c.length===0?t.error(t,{message:l?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.illegal_parameter}}):c.length===0?t.expect=l?CCe:Oee:(l?t.session.serverCertificate=c[0]:t.session.clientCertificate=c[0],O.verifyCertificateChain(t,c)&&(t.expect=l?CCe:Oee)),t.process()};O.handleServerKeyExchange=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.unsupported_certificate}});t.expect=sst,t.process()};O.handleClientKeyExchange=function(t,e,r){if(r<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.unsupported_certificate}});var n=e.fragment,o={enc_pre_master_secret:vl(n,2).getBytes()},s=null;if(t.getPrivateKey)try{s=t.getPrivateKey(t,t.session.serverCertificate),s=ke.pki.privateKeyFromPem(s)}catch(l){t.error(t,{message:"Could not get private key.",cause:l,send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.internal_error}})}if(s===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.internal_error}});try{var a=t.session.sp;a.pre_master_secret=s.decrypt(o.enc_pre_master_secret);var c=t.session.clientHelloVersion;if(c.major!==a.pre_master_secret.charCodeAt(0)||c.minor!==a.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{a.pre_master_secret=ke.random.getBytes(48)}t.expect=Mee,t.session.clientCertificate!==null&&(t.expect=fst),t.process()};O.handleCertificateRequest=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.illegal_parameter}});var n=e.fragment,o={certificate_types:vl(n,1),certificate_authorities:vl(n,2)};t.session.certificateRequest=o,t.expect=ast,t.process()};O.handleCertificateVerify=function(t,e,r){if(r<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.illegal_parameter}});var n=e.fragment;n.read-=4;var o=n.bytes();n.read+=4;var s={signature:vl(n,2).getBytes()},a=ke.util.createBuffer();a.putBuffer(t.session.md5.digest()),a.putBuffer(t.session.sha1.digest()),a=a.getBytes();try{var c=t.session.clientCertificate;if(!c.publicKey.verify(a,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(o),t.session.sha1.update(o)}catch{return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.handshake_failure}})}t.expect=Mee,t.process()};O.handleServerHelloDone=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.record_overflow}});if(t.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.insufficient_security}},o=0,s=t.verify(t,n.alert.description,o,[]);if(s!==!0)return(s||s===0)&&(typeof s=="object"&&!ke.util.isArray(s)?(s.message&&(n.message=s.message),s.alert&&(n.alert.description=s.alert)):typeof s=="number"&&(n.alert.description=s)),t.error(t,n)}t.session.certificateRequest!==null&&(e=O.createRecord(t,{type:O.ContentType.handshake,data:O.createCertificate(t)}),O.queue(t,e)),e=O.createRecord(t,{type:O.ContentType.handshake,data:O.createClientKeyExchange(t)}),O.queue(t,e),t.expect=ust;var a=function(c,l){c.session.certificateRequest!==null&&c.session.clientCertificate!==null&&O.queue(c,O.createRecord(c,{type:O.ContentType.handshake,data:O.createCertificateVerify(c,l)})),O.queue(c,O.createRecord(c,{type:O.ContentType.change_cipher_spec,data:O.createChangeCipherSpec()})),c.state.pending=O.createConnectionState(c),c.state.current.write=c.state.pending.write,O.queue(c,O.createRecord(c,{type:O.ContentType.handshake,data:O.createFinished(c)})),c.expect=ECe,O.flush(c),c.process()};if(t.session.certificateRequest===null||t.session.clientCertificate===null)return a(t,null);O.getClientSignature(t,a)};O.handleChangeCipherSpec=function(t,e){if(e.fragment.getByte()!==1)return t.error(t,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.illegal_parameter}});var r=t.entity===O.ConnectionEnd.client;(t.session.resuming&&r||!t.session.resuming&&!r)&&(t.state.pending=O.createConnectionState(t)),t.state.current.read=t.state.pending.read,(!t.session.resuming&&r||t.session.resuming&&!r)&&(t.state.pending=null),t.expect=r?cst:mst,t.process()};O.handleFinished=function(t,e,r){var n=e.fragment;n.read-=4;var o=n.bytes();n.read+=4;var s=e.fragment.getBytes();n=ke.util.createBuffer(),n.putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest());var a=t.entity===O.ConnectionEnd.client,c=a?"server finished":"client finished",l=t.session.sp,u=12,d=q7;if(n=d(l.master_secret,c,n.getBytes(),u),n.getBytes()!==s)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.decrypt_error}});t.session.md5.update(o),t.session.sha1.update(o),(t.session.resuming&&a||!t.session.resuming&&!a)&&(O.queue(t,O.createRecord(t,{type:O.ContentType.change_cipher_spec,data:O.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,O.queue(t,O.createRecord(t,{type:O.ContentType.handshake,data:O.createFinished(t)}))),t.expect=a?lst:hst,t.handshaking=!1,++t.handshakes,t.peerCertificate=a?t.session.serverCertificate:t.session.clientCertificate,O.flush(t),t.isConnected=!0,t.connected(t),t.process()};O.handleAlert=function(t,e){var r=e.fragment,n={level:r.getByte(),description:r.getByte()},o;switch(n.description){case O.Alert.Description.close_notify:o="Connection closed.";break;case O.Alert.Description.unexpected_message:o="Unexpected message.";break;case O.Alert.Description.bad_record_mac:o="Bad record MAC.";break;case O.Alert.Description.decryption_failed:o="Decryption failed.";break;case O.Alert.Description.record_overflow:o="Record overflow.";break;case O.Alert.Description.decompression_failure:o="Decompression failed.";break;case O.Alert.Description.handshake_failure:o="Handshake failure.";break;case O.Alert.Description.bad_certificate:o="Bad certificate.";break;case O.Alert.Description.unsupported_certificate:o="Unsupported certificate.";break;case O.Alert.Description.certificate_revoked:o="Certificate revoked.";break;case O.Alert.Description.certificate_expired:o="Certificate expired.";break;case O.Alert.Description.certificate_unknown:o="Certificate unknown.";break;case O.Alert.Description.illegal_parameter:o="Illegal parameter.";break;case O.Alert.Description.unknown_ca:o="Unknown certificate authority.";break;case O.Alert.Description.access_denied:o="Access denied.";break;case O.Alert.Description.decode_error:o="Decode error.";break;case O.Alert.Description.decrypt_error:o="Decrypt error.";break;case O.Alert.Description.export_restriction:o="Export restriction.";break;case O.Alert.Description.protocol_version:o="Unsupported protocol version.";break;case O.Alert.Description.insufficient_security:o="Insufficient security.";break;case O.Alert.Description.internal_error:o="Internal error.";break;case O.Alert.Description.user_canceled:o="User canceled.";break;case O.Alert.Description.no_renegotiation:o="Renegotiation not supported.";break;default:o="Unknown error.";break}if(n.description===O.Alert.Description.close_notify)return t.close();t.error(t,{message:o,send:!1,origin:t.entity===O.ConnectionEnd.client?"server":"client",alert:n}),t.process()};O.handleHandshake=function(t,e){var r=e.fragment,n=r.getByte(),o=r.getInt24();if(o>r.length())return t.fragmented=e,e.fragment=ke.util.createBuffer(),r.read-=4,t.process();t.fragmented=null,r.read-=4;var s=r.bytes(o+4);r.read+=4,n in B7[t.entity][t.expect]?(t.entity===O.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:ke.md.md5.create(),sha1:ke.md.sha1.create()}),n!==O.HandshakeType.hello_request&&n!==O.HandshakeType.certificate_verify&&n!==O.HandshakeType.finished&&(t.session.md5.update(s),t.session.sha1.update(s)),B7[t.entity][t.expect][n](t,e,o)):O.handleUnexpected(t,e)};O.handleApplicationData=function(t,e){t.data.putBuffer(e.fragment),t.dataReady(t),t.process()};O.handleHeartbeat=function(t,e){var r=e.fragment,n=r.getByte(),o=r.getInt16(),s=r.getBytes(o);if(n===O.HeartbeatMessageType.heartbeat_request){if(t.handshaking||o>s.length)return t.process();O.queue(t,O.createRecord(t,{type:O.ContentType.heartbeat,data:O.createHeartbeat(O.HeartbeatMessageType.heartbeat_response,s)})),O.flush(t)}else if(n===O.HeartbeatMessageType.heartbeat_response){if(s!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,ke.util.createBuffer(s))}t.process()};var ist=0,ost=1,CCe=2,sst=3,ast=4,ECe=5,cst=6,lst=7,ust=8,dst=0,pst=1,Oee=2,fst=3,Mee=4,mst=5,hst=6,L=O.handleUnexpected,wCe=O.handleChangeCipherSpec,js=O.handleAlert,Ua=O.handleHandshake,kCe=O.handleApplicationData,Vs=O.handleHeartbeat,Fee=[];Fee[O.ConnectionEnd.client]=[[L,js,Ua,L,Vs],[L,js,Ua,L,Vs],[L,js,Ua,L,Vs],[L,js,Ua,L,Vs],[L,js,Ua,L,Vs],[wCe,js,L,L,Vs],[L,js,Ua,L,Vs],[L,js,Ua,kCe,Vs],[L,js,Ua,L,Vs]];Fee[O.ConnectionEnd.server]=[[L,js,Ua,L,Vs],[L,js,Ua,L,Vs],[L,js,Ua,L,Vs],[L,js,Ua,L,Vs],[wCe,js,L,L,Vs],[L,js,Ua,L,Vs],[L,js,Ua,kCe,Vs],[L,js,Ua,L,Vs]];var Z0=O.handleHelloRequest,gst=O.handleServerHello,RCe=O.handleCertificate,TCe=O.handleServerKeyExchange,Nee=O.handleCertificateRequest,F7=O.handleServerHelloDone,PCe=O.handleFinished,B7=[];B7[O.ConnectionEnd.client]=[[L,L,gst,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[Z0,L,L,L,L,L,L,L,L,L,L,RCe,TCe,Nee,F7,L,L,L,L,L,L],[Z0,L,L,L,L,L,L,L,L,L,L,L,TCe,Nee,F7,L,L,L,L,L,L],[Z0,L,L,L,L,L,L,L,L,L,L,L,L,Nee,F7,L,L,L,L,L,L],[Z0,L,L,L,L,L,L,L,L,L,L,L,L,L,F7,L,L,L,L,L,L],[Z0,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[Z0,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,PCe],[Z0,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[Z0,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L]];var vst=O.handleClientHello,yst=O.handleClientKeyExchange,bst=O.handleCertificateVerify;B7[O.ConnectionEnd.server]=[[L,vst,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,RCe,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,yst,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,bst,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,PCe],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L]];O.generateKeys=function(t,e){var r=q7,n=e.client_random+e.server_random;t.session.resuming||(e.master_secret=r(e.pre_master_secret,"master secret",n,48).bytes(),e.pre_master_secret=null),n=e.server_random+e.client_random;var o=2*e.mac_key_length+2*e.enc_key_length,s=t.version.major===O.Versions.TLS_1_0.major&&t.version.minor===O.Versions.TLS_1_0.minor;s&&(o+=2*e.fixed_iv_length);var a=r(e.master_secret,"key expansion",n,o),c={client_write_MAC_key:a.getBytes(e.mac_key_length),server_write_MAC_key:a.getBytes(e.mac_key_length),client_write_key:a.getBytes(e.enc_key_length),server_write_key:a.getBytes(e.enc_key_length)};return s&&(c.client_write_IV=a.getBytes(e.fixed_iv_length),c.server_write_IV=a.getBytes(e.fixed_iv_length)),c};O.createConnectionState=function(t){var e=t.entity===O.ConnectionEnd.client,r=function(){var s={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){s.sequenceNumber[1]===4294967295?(s.sequenceNumber[1]=0,++s.sequenceNumber[0]):++s.sequenceNumber[1]}};return s},n={read:r(),write:r()};if(n.read.update=function(s,a){return n.read.cipherFunction(a,n.read)?n.read.compressFunction(s,a,n.read)||s.error(s,{message:"Could not decompress record.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.decompression_failure}}):s.error(s,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.bad_record_mac}}),!s.fail},n.write.update=function(s,a){return n.write.compressFunction(s,a,n.write)?n.write.cipherFunction(a,n.write)||s.error(s,{message:"Could not encrypt record.",send:!1,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.internal_error}}):s.error(s,{message:"Could not compress record.",send:!1,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.internal_error}}),!s.fail},t.session){var o=t.session.sp;switch(t.session.cipherSuite.initSecurityParameters(o),o.keys=O.generateKeys(t,o),n.read.macKey=e?o.keys.server_write_MAC_key:o.keys.client_write_MAC_key,n.write.macKey=e?o.keys.client_write_MAC_key:o.keys.server_write_MAC_key,t.session.cipherSuite.initConnectionState(n,t,o),o.compression_algorithm){case O.CompressionMethod.none:break;case O.CompressionMethod.deflate:n.read.compressFunction=nst,n.write.compressFunction=rst;break;default:throw new Error("Unsupported compression algorithm.")}}return n};O.createRandom=function(){var t=new Date,e=+t+t.getTimezoneOffset()*6e4,r=ke.util.createBuffer();return r.putInt32(e),r.putBytes(ke.random.getBytes(28)),r};O.createRecord=function(t,e){if(!e.data)return null;var r={type:e.type,version:{major:t.version.major,minor:t.version.minor},length:e.data.length(),fragment:e.data};return r};O.createAlert=function(t,e){var r=ke.util.createBuffer();return r.putByte(e.level),r.putByte(e.description),O.createRecord(t,{type:O.ContentType.alert,data:r})};O.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var e=ke.util.createBuffer(),r=0;r<t.cipherSuites.length;++r){var n=t.cipherSuites[r];e.putByte(n.id[0]),e.putByte(n.id[1])}var o=e.length(),s=ke.util.createBuffer();s.putByte(O.CompressionMethod.none);var a=s.length(),c=ke.util.createBuffer();if(t.virtualHost){var l=ke.util.createBuffer();l.putByte(0),l.putByte(0);var u=ke.util.createBuffer();u.putByte(0),uu(u,2,ke.util.createBuffer(t.virtualHost));var d=ke.util.createBuffer();uu(d,2,u),uu(l,2,d),c.putBuffer(l)}var p=c.length();p>0&&(p+=2);var f=t.session.id,m=f.length+1+2+4+28+2+o+1+a+p,h=ke.util.createBuffer();return h.putByte(O.HandshakeType.client_hello),h.putInt24(m),h.putByte(t.version.major),h.putByte(t.version.minor),h.putBytes(t.session.sp.client_random),uu(h,1,ke.util.createBuffer(f)),uu(h,2,e),uu(h,1,s),p>0&&uu(h,2,c),h};O.createServerHello=function(t){var e=t.session.id,r=e.length+1+2+4+28+2+1,n=ke.util.createBuffer();return n.putByte(O.HandshakeType.server_hello),n.putInt24(r),n.putByte(t.version.major),n.putByte(t.version.minor),n.putBytes(t.session.sp.server_random),uu(n,1,ke.util.createBuffer(e)),n.putByte(t.session.cipherSuite.id[0]),n.putByte(t.session.cipherSuite.id[1]),n.putByte(t.session.compressionMethod),n};O.createCertificate=function(t){var e=t.entity===O.ConnectionEnd.client,r=null;if(t.getCertificate){var n;e?n=t.session.certificateRequest:n=t.session.extensions.server_name.serverNameList,r=t.getCertificate(t,n)}var o=ke.util.createBuffer();if(r!==null)try{ke.util.isArray(r)||(r=[r]);for(var s=null,a=0;a<r.length;++a){var c=ke.pem.decode(r[a])[0];if(c.type!=="CERTIFICATE"&&c.type!=="X509 CERTIFICATE"&&c.type!=="TRUSTED CERTIFICATE"){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=c.type,l}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var u=ke.util.createBuffer(c.body);s===null&&(s=ke.asn1.fromDer(u.bytes(),!1));var d=ke.util.createBuffer();uu(d,3,u),o.putBuffer(d)}r=ke.pki.certificateFromAsn1(s),e?t.session.clientCertificate=r:t.session.serverCertificate=r}catch(m){return t.error(t,{message:"Could not send certificate list.",cause:m,send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.bad_certificate}})}var p=3+o.length(),f=ke.util.createBuffer();return f.putByte(O.HandshakeType.certificate),f.putInt24(p),uu(f,3,o),f};O.createClientKeyExchange=function(t){var e=ke.util.createBuffer();e.putByte(t.session.clientHelloVersion.major),e.putByte(t.session.clientHelloVersion.minor),e.putBytes(ke.random.getBytes(46));var r=t.session.sp;r.pre_master_secret=e.getBytes();var n=t.session.serverCertificate.publicKey;e=n.encrypt(r.pre_master_secret);var o=e.length+2,s=ke.util.createBuffer();return s.putByte(O.HandshakeType.client_key_exchange),s.putInt24(o),s.putInt16(e.length),s.putBytes(e),s};O.createServerKeyExchange=function(t){var e=0,r=ke.util.createBuffer();return e>0&&(r.putByte(O.HandshakeType.server_key_exchange),r.putInt24(e)),r};O.getClientSignature=function(t,e){var r=ke.util.createBuffer();r.putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest()),r=r.getBytes(),t.getSignature=t.getSignature||function(n,o,s){var a=null;if(n.getPrivateKey)try{a=n.getPrivateKey(n,n.session.clientCertificate),a=ke.pki.privateKeyFromPem(a)}catch(c){n.error(n,{message:"Could not get private key.",cause:c,send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.internal_error}})}a===null?n.error(n,{message:"No private key set.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.internal_error}}):o=a.sign(o,null),s(n,o)},t.getSignature(t,r,e)};O.createCertificateVerify=function(t,e){var r=e.length+2,n=ke.util.createBuffer();return n.putByte(O.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(e.length),n.putBytes(e),n};O.createCertificateRequest=function(t){var e=ke.util.createBuffer();e.putByte(1);var r=ke.util.createBuffer();for(var n in t.caStore.certs){var o=t.caStore.certs[n],s=ke.pki.distinguishedNameToAsn1(o.subject),a=ke.asn1.toDer(s);r.putInt16(a.length()),r.putBuffer(a)}var c=1+e.length()+2+r.length(),l=ke.util.createBuffer();return l.putByte(O.HandshakeType.certificate_request),l.putInt24(c),uu(l,1,e),uu(l,2,r),l};O.createServerHelloDone=function(t){var e=ke.util.createBuffer();return e.putByte(O.HandshakeType.server_hello_done),e.putInt24(0),e};O.createChangeCipherSpec=function(){var t=ke.util.createBuffer();return t.putByte(1),t};O.createFinished=function(t){var e=ke.util.createBuffer();e.putBuffer(t.session.md5.digest()),e.putBuffer(t.session.sha1.digest());var r=t.entity===O.ConnectionEnd.client,n=t.session.sp,o=12,s=q7,a=r?"client finished":"server finished";e=s(n.master_secret,a,e.getBytes(),o);var c=ke.util.createBuffer();return c.putByte(O.HandshakeType.finished),c.putInt24(e.length()),c.putBuffer(e),c};O.createHeartbeat=function(t,e,r){typeof r>"u"&&(r=e.length);var n=ke.util.createBuffer();n.putByte(t),n.putInt16(r),n.putBytes(e);var o=n.length(),s=Math.max(16,o-r-3);return n.putBytes(ke.random.getBytes(s)),n};O.queue=function(t,e){if(e&&!(e.fragment.length()===0&&(e.type===O.ContentType.handshake||e.type===O.ContentType.alert||e.type===O.ContentType.change_cipher_spec))){if(e.type===O.ContentType.handshake){var r=e.fragment.bytes();t.session.md5.update(r),t.session.sha1.update(r),r=null}var n;if(e.fragment.length()<=O.MaxFragment)n=[e];else{n=[];for(var o=e.fragment.bytes();o.length>O.MaxFragment;)n.push(O.createRecord(t,{type:e.type,data:ke.util.createBuffer(o.slice(0,O.MaxFragment))})),o=o.slice(O.MaxFragment);o.length>0&&n.push(O.createRecord(t,{type:e.type,data:ke.util.createBuffer(o)}))}for(var s=0;s<n.length&&!t.fail;++s){var a=n[s],c=t.state.current.write;c.update(t,a)&&t.records.push(a)}}};O.flush=function(t){for(var e=0;e<t.records.length;++e){var r=t.records[e];t.tlsData.putByte(r.type),t.tlsData.putByte(r.version.major),t.tlsData.putByte(r.version.minor),t.tlsData.putInt16(r.fragment.length()),t.tlsData.putBuffer(t.records[e].fragment)}return t.records=[],t.tlsDataReady(t)};var Lee=function(t){switch(t){case!0:return!0;case ke.pki.certificateError.bad_certificate:return O.Alert.Description.bad_certificate;case ke.pki.certificateError.unsupported_certificate:return O.Alert.Description.unsupported_certificate;case ke.pki.certificateError.certificate_revoked:return O.Alert.Description.certificate_revoked;case ke.pki.certificateError.certificate_expired:return O.Alert.Description.certificate_expired;case ke.pki.certificateError.certificate_unknown:return O.Alert.Description.certificate_unknown;case ke.pki.certificateError.unknown_ca:return O.Alert.Description.unknown_ca;default:return O.Alert.Description.bad_certificate}},_st=function(t){switch(t){case!0:return!0;case O.Alert.Description.bad_certificate:return ke.pki.certificateError.bad_certificate;case O.Alert.Description.unsupported_certificate:return ke.pki.certificateError.unsupported_certificate;case O.Alert.Description.certificate_revoked:return ke.pki.certificateError.certificate_revoked;case O.Alert.Description.certificate_expired:return ke.pki.certificateError.certificate_expired;case O.Alert.Description.certificate_unknown:return ke.pki.certificateError.certificate_unknown;case O.Alert.Description.unknown_ca:return ke.pki.certificateError.unknown_ca;default:return ke.pki.certificateError.bad_certificate}};O.verifyCertificateChain=function(t,e){try{var r={};for(var n in t.verifyOptions)r[n]=t.verifyOptions[n];r.verify=function(s,a,c){var l=Lee(s),u=t.verify(t,s,a,c);if(u!==!0){if(typeof u=="object"&&!ke.util.isArray(u)){var d=new Error("The application rejected the certificate.");throw d.send=!0,d.alert={level:O.Alert.Level.fatal,description:O.Alert.Description.bad_certificate},u.message&&(d.message=u.message),u.alert&&(d.alert.description=u.alert),d}u!==s&&(u=_st(u))}return u},ke.pki.verifyCertificateChain(t.caStore,e,r)}catch(s){var o=s;(typeof o!="object"||ke.util.isArray(o))&&(o={send:!0,alert:{level:O.Alert.Level.fatal,description:Lee(s)}}),"send"in o||(o.send=!0),"alert"in o||(o.alert={level:O.Alert.Level.fatal,description:Lee(o.error)}),t.error(t,o)}return!t.fail};O.createSessionCache=function(t,e){var r=null;if(t&&t.getSession&&t.setSession&&t.order)r=t;else{r={},r.cache=t||{},r.capacity=Math.max(e||100,1),r.order=[];for(var n in t)r.order.length<=e?r.order.push(n):delete t[n];r.getSession=function(o){var s=null,a=null;if(o?a=ke.util.bytesToHex(o):r.order.length>0&&(a=r.order[0]),a!==null&&a in r.cache){s=r.cache[a],delete r.cache[a];for(var c in r.order)if(r.order[c]===a){r.order.splice(c,1);break}}return s},r.setSession=function(o,s){if(r.order.length===r.capacity){var a=r.order.shift();delete r.cache[a]}var a=ke.util.bytesToHex(o);r.order.push(a),r.cache[a]=s}}return r};O.createConnection=function(t){var e=null;t.caStore?ke.util.isArray(t.caStore)?e=ke.pki.createCaStore(t.caStore):e=t.caStore:e=ke.pki.createCaStore();var r=t.cipherSuites||null;if(r===null){r=[];for(var n in O.CipherSuites)r.push(O.CipherSuites[n])}var o=t.server?O.ConnectionEnd.server:O.ConnectionEnd.client,s=t.sessionCache?O.createSessionCache(t.sessionCache):null,a={version:{major:O.Version.major,minor:O.Version.minor},entity:o,sessionId:t.sessionId,caStore:e,sessionCache:s,cipherSuites:r,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(d,p,f,m){return p},verifyOptions:t.verifyOptions||{},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:ke.util.createBuffer(),tlsData:ke.util.createBuffer(),data:ke.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(d,p){p.origin=p.origin||(d.entity===O.ConnectionEnd.client?"client":"server"),p.send&&(O.queue(d,O.createAlert(d,p.alert)),O.flush(d));var f=p.fatal!==!1;f&&(d.fail=!0),t.error(d,p),f&&d.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};a.reset=function(d){a.version={major:O.Version.major,minor:O.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=a.entity===O.ConnectionEnd.client?ist:dst,a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(d||typeof d>"u"),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=O.createConnectionState(a)},a.reset();var c=function(d,p){var f=p.type-O.ContentType.change_cipher_spec,m=Fee[d.entity][d.expect];f in m?m[f](d,p):O.handleUnexpected(d,p)},l=function(d){var p=0,f=d.input,m=f.length();if(m<5)p=5-m;else{d.record={type:f.getByte(),version:{major:f.getByte(),minor:f.getByte()},length:f.getInt16(),fragment:ke.util.createBuffer(),ready:!1};var h=d.record.version.major===d.version.major;h&&d.session&&d.session.version&&(h=d.record.version.minor===d.version.minor),h||d.error(d,{message:"Incompatible TLS version.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.protocol_version}})}return p},u=function(d){var p=0,f=d.input,m=f.length();if(m<d.record.length)p=d.record.length-m;else{d.record.fragment.putBytes(f.getBytes(d.record.length)),f.compact();var h=d.state.current.read;h.update(d,d.record)&&(d.fragmented!==null&&(d.fragmented.type===d.record.type?(d.fragmented.fragment.putBuffer(d.record.fragment),d.record=d.fragmented):d.error(d,{message:"Invalid fragmented record.",send:!0,alert:{level:O.Alert.Level.fatal,description:O.Alert.Description.unexpected_message}})),d.record.ready=!0)}return p};return a.handshake=function(d){if(a.entity!==O.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&a.handshakes===0&&(a.fail=!1),a.handshaking=!0,d=d||"";var p=null;d.length>0&&(a.sessionCache&&(p=a.sessionCache.getSession(d)),p===null&&(d="")),d.length===0&&a.sessionCache&&(p=a.sessionCache.getSession(),p!==null&&(d=p.id)),a.session={id:d,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:ke.md.md5.create(),sha1:ke.md.sha1.create()},p&&(a.version=p.version,a.session.sp=p.sp),a.session.sp.client_random=O.createRandom().getBytes(),a.open=!0,O.queue(a,O.createRecord(a,{type:O.ContentType.handshake,data:O.createClientHello(a)})),O.flush(a)}},a.process=function(d){var p=0;return d&&a.input.putBytes(d),a.fail||(a.record!==null&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),a.record===null&&(p=l(a)),!a.fail&&a.record!==null&&!a.record.ready&&(p=u(a)),!a.fail&&a.record!==null&&a.record.ready&&c(a,a.record)),p},a.prepare=function(d){return O.queue(a,O.createRecord(a,{type:O.ContentType.application_data,data:ke.util.createBuffer(d)})),O.flush(a)},a.prepareHeartbeatRequest=function(d,p){return d instanceof ke.util.ByteBuffer&&(d=d.bytes()),typeof p>"u"&&(p=d.length),a.expectedHeartbeatPayload=d,O.queue(a,O.createRecord(a,{type:O.ContentType.heartbeat,data:O.createHeartbeat(O.HeartbeatMessageType.heartbeat_request,d,p)})),O.flush(a)},a.close=function(d){if(!a.fail&&a.sessionCache&&a.session){var p={id:a.session.id,version:a.session.version,sp:a.session.sp};p.sp.keys=null,a.sessionCache.setSession(p.id,p)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,O.queue(a,O.createAlert(a,{level:O.Alert.Level.warning,description:O.Alert.Description.close_notify})),O.flush(a)),a.closed(a)),a.reset(d)},a};ACe.exports=ke.tls=ke.tls||{};for(U7 in O)typeof O[U7]!="function"&&(ke.tls[U7]=O[U7]);var U7;ke.tls.prf_tls1=q7;ke.tls.hmac_sha1=tst;ke.tls.createSessionCache=O.createSessionCache;ke.tls.createConnection=O.createConnection});var LCe=R((sIr,NCe)=>{var ey=dr();W0();Uee();var du=NCe.exports=ey.tls;du.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=du.BulkCipherAlgorithm.aes,t.cipher_type=du.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=du.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:DCe};du.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=du.BulkCipherAlgorithm.aes,t.cipher_type=du.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=du.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:DCe};function DCe(t,e,r){var n=e.entity===ey.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:ey.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV},t.write.cipherState={init:!1,cipher:ey.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV},t.read.cipherFunction=Cst,t.write.cipherFunction=xst,t.read.macLength=t.write.macLength=r.mac_length,t.read.macFunction=t.write.macFunction=du.hmac_sha1}function xst(t,e){var r=!1,n=e.macFunction(e.macKey,e.sequenceNumber,t);t.fragment.putBytes(n),e.updateSequenceNumber();var o;t.version.minor===du.Versions.TLS_1_0.minor?o=e.cipherState.init?null:e.cipherState.iv:o=ey.random.getBytesSync(16),e.cipherState.init=!0;var s=e.cipherState.cipher;return s.start({iv:o}),t.version.minor>=du.Versions.TLS_1_1.minor&&s.output.putBytes(o),s.update(t.fragment),s.finish(Sst)&&(t.fragment=s.output,t.length=t.fragment.length(),r=!0),r}function Sst(t,e,r){if(!r){var n=t-e.length()%t;e.fillWithByte(n-1,n)}return!0}function Ist(t,e,r){var n=!0;if(r){for(var o=e.length(),s=e.last(),a=o-1-s;a<o-1;++a)n=n&&e.at(a)==s;n&&e.truncate(s+1)}return n}function Cst(t,e){var r=!1,n;t.version.minor===du.Versions.TLS_1_0.minor?n=e.cipherState.init?null:e.cipherState.iv:n=t.fragment.getBytes(16),e.cipherState.init=!0;var o=e.cipherState.cipher;o.start({iv:n}),o.update(t.fragment),r=o.finish(Ist);var s=e.macLength,a=ey.random.getBytesSync(s),c=o.output.length();c>=s?(t.fragment=o.output.getBytes(c-s),a=o.output.getBytes(s)):t.fragment=o.output.getBytes(),t.fragment=ey.util.createBuffer(t.fragment),t.length=t.fragment.length();var l=e.macFunction(e.macKey,e.sequenceNumber,t);return e.updateSequenceNumber(),r=Tst(e.macKey,a,l)&&r,r}function Tst(t,e,r){var n=ey.hmac.create();return n.start("SHA1",t),n.update(e),e=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),e===r}});var jee=R((aIr,UCe)=>{var ti=dr();af();Qr();var aL=UCe.exports=ti.sha512=ti.sha512||{};ti.md.sha512=ti.md.algorithms.sha512=aL;var MCe=ti.sha384=ti.sha512.sha384=ti.sha512.sha384||{};MCe.create=function(){return aL.create("SHA-384")};ti.md.sha384=ti.md.algorithms.sha384=MCe;ti.sha512.sha256=ti.sha512.sha256||{create:function(){return aL.create("SHA-512/256")}};ti.md["sha512/256"]=ti.md.algorithms["sha512/256"]=ti.sha512.sha256;ti.sha512.sha224=ti.sha512.sha224||{create:function(){return aL.create("SHA-512/224")}};ti.md["sha512/224"]=ti.md.algorithms["sha512/224"]=ti.sha512.sha224;aL.create=function(t){if(FCe||Est(),typeof t>"u"&&(t="SHA-512"),!(t in Px))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Px[t],r=null,n=ti.util.createBuffer(),o=new Array(80),s=0;s<80;++s)o[s]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var c={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength128=[];for(var l=c.messageLengthSize/4,u=0;u<l;++u)c.fullMessageLength.push(0);n=ti.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return c},c.start(),c.update=function(l,u){u==="utf8"&&(l=ti.util.encodeUtf8(l));var d=l.length;c.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var p=c.fullMessageLength.length-1;p>=0;--p)c.fullMessageLength[p]+=d[1],d[1]=d[0]+(c.fullMessageLength[p]/4294967296>>>0),c.fullMessageLength[p]=c.fullMessageLength[p]>>>0,d[0]=d[1]/4294967296>>>0;return n.putBytes(l),OCe(r,o,n),(n.read>2048||n.length()===0)&&n.compact(),c},c.digest=function(){var l=ti.util.createBuffer();l.putBytes(n.bytes());var u=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,d=u&c.blockLength-1;l.putBytes(Bee.substr(0,c.blockLength-d));for(var p,f,m=c.fullMessageLength[0]*8,h=0;h<c.fullMessageLength.length-1;++h)p=c.fullMessageLength[h+1]*8,f=p/4294967296>>>0,m+=f,l.putInt32(m>>>0),m=p>>>0;l.putInt32(m);for(var g=new Array(r.length),h=0;h<r.length;++h)g[h]=r[h].slice(0);OCe(g,o,l);var v=ti.util.createBuffer(),b;t==="SHA-512"?b=g.length:t==="SHA-384"?b=g.length-2:b=g.length-4;for(var h=0;h<b;++h)v.putInt32(g[h][0]),(h!==b-1||t!=="SHA-512/224")&&v.putInt32(g[h][1]);return v},c};var Bee=null,FCe=!1,qee=null,Px=null;function Est(){Bee="\x80",Bee+=ti.util.fillString("\0",128),qee=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Px={},Px["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Px["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Px["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Px["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],FCe=!0}function OCe(t,e,r){for(var n,o,s,a,c,l,u,d,p,f,m,h,g,v,b,_,x,S,I,w,k,M,H,F,ue,Z,V,A,P,B,U,$,ce,W,Y,Se=r.length();Se>=128;){for(P=0;P<16;++P)e[P][0]=r.getInt32()>>>0,e[P][1]=r.getInt32()>>>0;for(;P<80;++P)$=e[P-2],B=$[0],U=$[1],n=((B>>>19|U<<13)^(U>>>29|B<<3)^B>>>6)>>>0,o=((B<<13|U>>>19)^(U<<3|B>>>29)^(B<<26|U>>>6))>>>0,W=e[P-15],B=W[0],U=W[1],s=((B>>>1|U<<31)^(B>>>8|U<<24)^B>>>7)>>>0,a=((B<<31|U>>>1)^(B<<24|U>>>8)^(B<<25|U>>>7))>>>0,ce=e[P-7],Y=e[P-16],U=o+ce[1]+a+Y[1],e[P][0]=n+ce[0]+s+Y[0]+(U/4294967296>>>0)>>>0,e[P][1]=U>>>0;for(g=t[0][0],v=t[0][1],b=t[1][0],_=t[1][1],x=t[2][0],S=t[2][1],I=t[3][0],w=t[3][1],k=t[4][0],M=t[4][1],H=t[5][0],F=t[5][1],ue=t[6][0],Z=t[6][1],V=t[7][0],A=t[7][1],P=0;P<80;++P)u=((k>>>14|M<<18)^(k>>>18|M<<14)^(M>>>9|k<<23))>>>0,d=((k<<18|M>>>14)^(k<<14|M>>>18)^(M<<23|k>>>9))>>>0,p=(ue^k&(H^ue))>>>0,f=(Z^M&(F^Z))>>>0,c=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,l=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,m=(g&b|x&(g^b))>>>0,h=(v&_|S&(v^_))>>>0,U=A+d+f+qee[P][1]+e[P][1],n=V+u+p+qee[P][0]+e[P][0]+(U/4294967296>>>0)>>>0,o=U>>>0,U=l+h,s=c+m+(U/4294967296>>>0)>>>0,a=U>>>0,V=ue,A=Z,ue=H,Z=F,H=k,F=M,U=w+o,k=I+n+(U/4294967296>>>0)>>>0,M=U>>>0,I=x,w=S,x=b,S=_,b=g,_=v,U=o+a,g=n+s+(U/4294967296>>>0)>>>0,v=U>>>0;U=t[0][1]+v,t[0][0]=t[0][0]+g+(U/4294967296>>>0)>>>0,t[0][1]=U>>>0,U=t[1][1]+_,t[1][0]=t[1][0]+b+(U/4294967296>>>0)>>>0,t[1][1]=U>>>0,U=t[2][1]+S,t[2][0]=t[2][0]+x+(U/4294967296>>>0)>>>0,t[2][1]=U>>>0,U=t[3][1]+w,t[3][0]=t[3][0]+I+(U/4294967296>>>0)>>>0,t[3][1]=U>>>0,U=t[4][1]+M,t[4][0]=t[4][0]+k+(U/4294967296>>>0)>>>0,t[4][1]=U>>>0,U=t[5][1]+F,t[5][0]=t[5][0]+H+(U/4294967296>>>0)>>>0,t[5][1]=U>>>0,U=t[6][1]+Z,t[6][0]=t[6][0]+ue+(U/4294967296>>>0)>>>0,t[6][1]=U>>>0,U=t[7][1]+A,t[7][0]=t[7][0]+V+(U/4294967296>>>0)>>>0,t[7][1]=U>>>0,Se-=128}}});var BCe=R(Vee=>{var wst=dr();Ld();var Is=wst.asn1;Vee.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Is.Class.UNIVERSAL,type:Is.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Is.Class.UNIVERSAL,type:Is.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Is.Class.UNIVERSAL,type:Is.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Is.Class.UNIVERSAL,type:Is.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Is.Class.UNIVERSAL,type:Is.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Vee.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Is.Class.UNIVERSAL,type:Is.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Is.Class.UNIVERSAL,type:Is.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Is.Class.UNIVERSAL,type:Is.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Is.Class.UNIVERSAL,type:Is.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var JCe=R((lIr,XCe)=>{var Hs=dr();nL();su();jee();Qr();var zCe=BCe(),kst=zCe.publicKeyValidator,Rst=zCe.privateKeyValidator;typeof qCe>"u"&&(qCe=Hs.jsbn.BigInteger);var qCe,zee=Hs.util.ByteBuffer,Ec=typeof Buffer>"u"?Uint8Array:Buffer;Hs.pki=Hs.pki||{};XCe.exports=Hs.pki.ed25519=Hs.ed25519=Hs.ed25519||{};var Rr=Hs.ed25519;Rr.constants={};Rr.constants.PUBLIC_KEY_BYTE_LENGTH=32;Rr.constants.PRIVATE_KEY_BYTE_LENGTH=64;Rr.constants.SEED_BYTE_LENGTH=32;Rr.constants.SIGN_BYTE_LENGTH=64;Rr.constants.HASH_BYTE_LENGTH=64;Rr.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=Hs.random.getBytesSync(Rr.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==Rr.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Rr.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Ih({message:e,encoding:"binary"});for(var r=new Ec(Rr.constants.PUBLIC_KEY_BYTE_LENGTH),n=new Ec(Rr.constants.PRIVATE_KEY_BYTE_LENGTH),o=0;o<32;++o)n[o]=e[o];return Nst(r,n),{publicKey:r,privateKey:n}};Rr.privateKeyFromAsn1=function(t){var e={},r=[],n=Hs.asn1.validate(t,Rst,e,r);if(!n){var o=new Error("Invalid Key.");throw o.errors=r,o}var s=Hs.asn1.derToOid(e.privateKeyOid),a=Hs.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.privateKey,l=Ih({message:Hs.asn1.fromDer(c).value,encoding:"binary"});return{privateKeyBytes:l}};Rr.publicKeyFromAsn1=function(t){var e={},r=[],n=Hs.asn1.validate(t,kst,e,r);if(!n){var o=new Error("Invalid Key.");throw o.errors=r,o}var s=Hs.asn1.derToOid(e.publicKeyOid),a=Hs.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.ed25519PublicKey;if(c.length!==Rr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Ih({message:c,encoding:"binary"})};Rr.publicKeyFromPrivateKey=function(t){t=t||{};var e=Ih({message:t.privateKey,encoding:"binary"});if(e.length!==Rr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Rr.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Ec(Rr.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=e[32+n];return r};Rr.sign=function(t){t=t||{};var e=Ih(t),r=Ih({message:t.privateKey,encoding:"binary"});if(r.length===Rr.constants.SEED_BYTE_LENGTH){var n=Rr.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==Rr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Rr.constants.SEED_BYTE_LENGTH+" or "+Rr.constants.PRIVATE_KEY_BYTE_LENGTH);var o=new Ec(Rr.constants.SIGN_BYTE_LENGTH+e.length);Lst(o,e,e.length,r);for(var s=new Ec(Rr.constants.SIGN_BYTE_LENGTH),a=0;a<s.length;++a)s[a]=o[a];return s};Rr.verify=function(t){t=t||{};var e=Ih(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=Ih({message:t.signature,encoding:"binary"});if(r.length!==Rr.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Rr.constants.SIGN_BYTE_LENGTH);var n=Ih({message:t.publicKey,encoding:"binary"});if(n.length!==Rr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Rr.constants.PUBLIC_KEY_BYTE_LENGTH);var o=new Ec(Rr.constants.SIGN_BYTE_LENGTH+e.length),s=new Ec(Rr.constants.SIGN_BYTE_LENGTH+e.length),a;for(a=0;a<Rr.constants.SIGN_BYTE_LENGTH;++a)o[a]=r[a];for(a=0;a<e.length;++a)o[a+Rr.constants.SIGN_BYTE_LENGTH]=e[a];return Ost(s,o,o.length,n)>=0};function Ih(t){var e=t.message;if(e instanceof Uint8Array||e instanceof Ec)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,r);e=new zee(e,r)}else if(!(e instanceof zee))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new Ec(e.length()),o=0;o<n.length;++o)n[o]=e.at(o);return n}var $ee=qt(),j7=qt([1]),Pst=qt([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Ast=qt([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),jCe=qt([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),VCe=qt([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Hee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),Dst=qt([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function cL(t,e){var r=Hs.md.sha512.create(),n=new zee(t);r.update(n.getBytes(e),"binary");var o=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(o,"binary");for(var s=new Ec(Rr.constants.HASH_BYTE_LENGTH),a=0;a<64;++a)s[a]=o.charCodeAt(a);return s}function Nst(t,e){var r=[qt(),qt(),qt(),qt()],n,o=cL(e,32);for(o[0]&=248,o[31]&=127,o[31]|=64,Qee(r,o),Yee(t,r),n=0;n<32;++n)e[n+32]=t[n];return 0}function Lst(t,e,r,n){var o,s,a=new Float64Array(64),c=[qt(),qt(),qt(),qt()],l=cL(n,32);l[0]&=248,l[31]&=127,l[31]|=64;var u=r+64;for(o=0;o<r;++o)t[64+o]=e[o];for(o=0;o<32;++o)t[32+o]=l[32+o];var d=cL(t.subarray(32),r+32);for(Wee(d),Qee(c,d),Yee(t,c),o=32;o<64;++o)t[o]=n[o];var p=cL(t,r+64);for(Wee(p),o=32;o<64;++o)a[o]=0;for(o=0;o<32;++o)a[o]=d[o];for(o=0;o<32;++o)for(s=0;s<32;s++)a[o+s]+=p[o]*l[s];return $Ce(t.subarray(32),a),u}function Ost(t,e,r,n){var o,s,a=new Ec(32),c=[qt(),qt(),qt(),qt()],l=[qt(),qt(),qt(),qt()];if(s=-1,r<64||Mst(l,n))return-1;for(o=0;o<r;++o)t[o]=e[o];for(o=0;o<32;++o)t[o+32]=n[o];var u=cL(t,r);if(Wee(u),YCe(c,l,u),Qee(l,e.subarray(32)),Kee(c,l),Yee(a,c),r-=64,WCe(e,0,a,0)){for(o=0;o<r;++o)t[o]=0;return-1}for(o=0;o<r;++o)t[o]=e[o+64];return s=r,s}function $Ce(t,e){var r,n,o,s;for(n=63;n>=32;--n){for(r=0,o=n-32,s=n-12;o<s;++o)e[o]+=r-16*e[n]*Hee[o-(n-32)],r=e[o]+128>>8,e[o]-=r*256;e[o]+=r,e[n]=0}for(r=0,o=0;o<32;++o)e[o]+=r-(e[31]>>4)*Hee[o],r=e[o]>>8,e[o]&=255;for(o=0;o<32;++o)e[o]-=r*Hee[o];for(n=0;n<32;++n)e[n+1]+=e[n]>>8,t[n]=e[n]&255}function Wee(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;$Ce(t,e)}function Kee(t,e){var r=qt(),n=qt(),o=qt(),s=qt(),a=qt(),c=qt(),l=qt(),u=qt(),d=qt();kE(r,t[1],t[0]),kE(d,e[1],e[0]),Mn(r,r,d),wE(n,t[0],t[1]),wE(d,e[0],e[1]),Mn(n,n,d),Mn(o,t[3],e[3]),Mn(o,o,Ast),Mn(s,t[2],e[2]),wE(s,s,s),kE(a,n,r),kE(c,s,o),wE(l,s,o),wE(u,n,r),Mn(t[0],a,c),Mn(t[1],u,l),Mn(t[2],l,c),Mn(t[3],a,u)}function HCe(t,e,r){for(var n=0;n<4;++n)QCe(t[n],e[n],r)}function Yee(t,e){var r=qt(),n=qt(),o=qt();qst(o,e[2]),Mn(r,e[0],o),Mn(n,e[1],o),V7(t,n),t[31]^=KCe(r)<<7}function V7(t,e){var r,n,o,s=qt(),a=qt();for(r=0;r<16;++r)a[r]=e[r];for(Gee(a),Gee(a),Gee(a),n=0;n<2;++n){for(s[0]=a[0]-65517,r=1;r<15;++r)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,QCe(a,s,1-o)}for(r=0;r<16;r++)t[2*r]=a[r]&255,t[2*r+1]=a[r]>>8}function Mst(t,e){var r=qt(),n=qt(),o=qt(),s=qt(),a=qt(),c=qt(),l=qt();return ty(t[2],j7),Fst(t[1],e),Ax(o,t[1]),Mn(s,o,Pst),kE(o,o,t[2]),wE(s,t[2],s),Ax(a,s),Ax(c,a),Mn(l,c,a),Mn(r,l,o),Mn(r,r,s),Ust(r,r),Mn(r,r,o),Mn(r,r,s),Mn(r,r,s),Mn(t[0],r,s),Ax(n,t[0]),Mn(n,n,s),GCe(n,o)&&Mn(t[0],t[0],Dst),Ax(n,t[0]),Mn(n,n,s),GCe(n,o)?-1:(KCe(t[0])===e[31]>>7&&kE(t[0],$ee,t[0]),Mn(t[3],t[0],t[1]),0)}function Fst(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function Ust(t,e){var r=qt(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=250;n>=0;--n)Ax(r,r),n!==1&&Mn(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function GCe(t,e){var r=new Ec(32),n=new Ec(32);return V7(r,t),V7(n,e),WCe(r,0,n,0)}function WCe(t,e,r,n){return Bst(t,e,r,n,32)}function Bst(t,e,r,n,o){var s,a=0;for(s=0;s<o;++s)a|=t[e+s]^r[n+s];return(1&a-1>>>8)-1}function KCe(t){var e=new Ec(32);return V7(e,t),e[0]&1}function YCe(t,e,r){var n,o;for(ty(t[0],$ee),ty(t[1],j7),ty(t[2],j7),ty(t[3],$ee),o=255;o>=0;--o)n=r[o/8|0]>>(o&7)&1,HCe(t,e,n),Kee(e,t),Kee(t,t),HCe(t,e,n)}function Qee(t,e){var r=[qt(),qt(),qt(),qt()];ty(r[0],jCe),ty(r[1],VCe),ty(r[2],j7),Mn(r[3],jCe,VCe),YCe(t,r,e)}function ty(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}function qst(t,e){var r=qt(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=253;n>=0;--n)Ax(r,r),n!==2&&n!==4&&Mn(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function Gee(t){var e,r,n=1;for(e=0;e<16;++e)r=t[e]+n+65535,n=Math.floor(r/65536),t[e]=r-n*65536;t[0]+=n-1+37*(n-1)}function QCe(t,e,r){for(var n,o=~(r-1),s=0;s<16;++s)n=o&(t[s]^e[s]),t[s]^=n,e[s]^=n}function qt(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}function wE(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]+r[n]}function kE(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]-r[n]}function Ax(t,e){Mn(t,e,e)}function Mn(t,e,r){var n,o,s=0,a=0,c=0,l=0,u=0,d=0,p=0,f=0,m=0,h=0,g=0,v=0,b=0,_=0,x=0,S=0,I=0,w=0,k=0,M=0,H=0,F=0,ue=0,Z=0,V=0,A=0,P=0,B=0,U=0,$=0,ce=0,W=r[0],Y=r[1],Se=r[2],ee=r[3],Ie=r[4],Xe=r[5],Ot=r[6],Tr=r[7],_e=r[8],ut=r[9],G=r[10],pe=r[11],me=r[12],De=r[13],Ee=r[14],vt=r[15];n=e[0],s+=n*W,a+=n*Y,c+=n*Se,l+=n*ee,u+=n*Ie,d+=n*Xe,p+=n*Ot,f+=n*Tr,m+=n*_e,h+=n*ut,g+=n*G,v+=n*pe,b+=n*me,_+=n*De,x+=n*Ee,S+=n*vt,n=e[1],a+=n*W,c+=n*Y,l+=n*Se,u+=n*ee,d+=n*Ie,p+=n*Xe,f+=n*Ot,m+=n*Tr,h+=n*_e,g+=n*ut,v+=n*G,b+=n*pe,_+=n*me,x+=n*De,S+=n*Ee,I+=n*vt,n=e[2],c+=n*W,l+=n*Y,u+=n*Se,d+=n*ee,p+=n*Ie,f+=n*Xe,m+=n*Ot,h+=n*Tr,g+=n*_e,v+=n*ut,b+=n*G,_+=n*pe,x+=n*me,S+=n*De,I+=n*Ee,w+=n*vt,n=e[3],l+=n*W,u+=n*Y,d+=n*Se,p+=n*ee,f+=n*Ie,m+=n*Xe,h+=n*Ot,g+=n*Tr,v+=n*_e,b+=n*ut,_+=n*G,x+=n*pe,S+=n*me,I+=n*De,w+=n*Ee,k+=n*vt,n=e[4],u+=n*W,d+=n*Y,p+=n*Se,f+=n*ee,m+=n*Ie,h+=n*Xe,g+=n*Ot,v+=n*Tr,b+=n*_e,_+=n*ut,x+=n*G,S+=n*pe,I+=n*me,w+=n*De,k+=n*Ee,M+=n*vt,n=e[5],d+=n*W,p+=n*Y,f+=n*Se,m+=n*ee,h+=n*Ie,g+=n*Xe,v+=n*Ot,b+=n*Tr,_+=n*_e,x+=n*ut,S+=n*G,I+=n*pe,w+=n*me,k+=n*De,M+=n*Ee,H+=n*vt,n=e[6],p+=n*W,f+=n*Y,m+=n*Se,h+=n*ee,g+=n*Ie,v+=n*Xe,b+=n*Ot,_+=n*Tr,x+=n*_e,S+=n*ut,I+=n*G,w+=n*pe,k+=n*me,M+=n*De,H+=n*Ee,F+=n*vt,n=e[7],f+=n*W,m+=n*Y,h+=n*Se,g+=n*ee,v+=n*Ie,b+=n*Xe,_+=n*Ot,x+=n*Tr,S+=n*_e,I+=n*ut,w+=n*G,k+=n*pe,M+=n*me,H+=n*De,F+=n*Ee,ue+=n*vt,n=e[8],m+=n*W,h+=n*Y,g+=n*Se,v+=n*ee,b+=n*Ie,_+=n*Xe,x+=n*Ot,S+=n*Tr,I+=n*_e,w+=n*ut,k+=n*G,M+=n*pe,H+=n*me,F+=n*De,ue+=n*Ee,Z+=n*vt,n=e[9],h+=n*W,g+=n*Y,v+=n*Se,b+=n*ee,_+=n*Ie,x+=n*Xe,S+=n*Ot,I+=n*Tr,w+=n*_e,k+=n*ut,M+=n*G,H+=n*pe,F+=n*me,ue+=n*De,Z+=n*Ee,V+=n*vt,n=e[10],g+=n*W,v+=n*Y,b+=n*Se,_+=n*ee,x+=n*Ie,S+=n*Xe,I+=n*Ot,w+=n*Tr,k+=n*_e,M+=n*ut,H+=n*G,F+=n*pe,ue+=n*me,Z+=n*De,V+=n*Ee,A+=n*vt,n=e[11],v+=n*W,b+=n*Y,_+=n*Se,x+=n*ee,S+=n*Ie,I+=n*Xe,w+=n*Ot,k+=n*Tr,M+=n*_e,H+=n*ut,F+=n*G,ue+=n*pe,Z+=n*me,V+=n*De,A+=n*Ee,P+=n*vt,n=e[12],b+=n*W,_+=n*Y,x+=n*Se,S+=n*ee,I+=n*Ie,w+=n*Xe,k+=n*Ot,M+=n*Tr,H+=n*_e,F+=n*ut,ue+=n*G,Z+=n*pe,V+=n*me,A+=n*De,P+=n*Ee,B+=n*vt,n=e[13],_+=n*W,x+=n*Y,S+=n*Se,I+=n*ee,w+=n*Ie,k+=n*Xe,M+=n*Ot,H+=n*Tr,F+=n*_e,ue+=n*ut,Z+=n*G,V+=n*pe,A+=n*me,P+=n*De,B+=n*Ee,U+=n*vt,n=e[14],x+=n*W,S+=n*Y,I+=n*Se,w+=n*ee,k+=n*Ie,M+=n*Xe,H+=n*Ot,F+=n*Tr,ue+=n*_e,Z+=n*ut,V+=n*G,A+=n*pe,P+=n*me,B+=n*De,U+=n*Ee,$+=n*vt,n=e[15],S+=n*W,I+=n*Y,w+=n*Se,k+=n*ee,M+=n*Ie,H+=n*Xe,F+=n*Ot,ue+=n*Tr,Z+=n*_e,V+=n*ut,A+=n*G,P+=n*pe,B+=n*me,U+=n*De,$+=n*Ee,ce+=n*vt,s+=38*I,a+=38*w,c+=38*k,l+=38*M,u+=38*H,d+=38*F,p+=38*ue,f+=38*Z,m+=38*V,h+=38*A,g+=38*P,v+=38*B,b+=38*U,_+=38*$,x+=38*ce,o=1,n=s+o+65535,o=Math.floor(n/65536),s=n-o*65536,n=a+o+65535,o=Math.floor(n/65536),a=n-o*65536,n=c+o+65535,o=Math.floor(n/65536),c=n-o*65536,n=l+o+65535,o=Math.floor(n/65536),l=n-o*65536,n=u+o+65535,o=Math.floor(n/65536),u=n-o*65536,n=d+o+65535,o=Math.floor(n/65536),d=n-o*65536,n=p+o+65535,o=Math.floor(n/65536),p=n-o*65536,n=f+o+65535,o=Math.floor(n/65536),f=n-o*65536,n=m+o+65535,o=Math.floor(n/65536),m=n-o*65536,n=h+o+65535,o=Math.floor(n/65536),h=n-o*65536,n=g+o+65535,o=Math.floor(n/65536),g=n-o*65536,n=v+o+65535,o=Math.floor(n/65536),v=n-o*65536,n=b+o+65535,o=Math.floor(n/65536),b=n-o*65536,n=_+o+65535,o=Math.floor(n/65536),_=n-o*65536,n=x+o+65535,o=Math.floor(n/65536),x=n-o*65536,n=S+o+65535,o=Math.floor(n/65536),S=n-o*65536,s+=o-1+37*(o-1),o=1,n=s+o+65535,o=Math.floor(n/65536),s=n-o*65536,n=a+o+65535,o=Math.floor(n/65536),a=n-o*65536,n=c+o+65535,o=Math.floor(n/65536),c=n-o*65536,n=l+o+65535,o=Math.floor(n/65536),l=n-o*65536,n=u+o+65535,o=Math.floor(n/65536),u=n-o*65536,n=d+o+65535,o=Math.floor(n/65536),d=n-o*65536,n=p+o+65535,o=Math.floor(n/65536),p=n-o*65536,n=f+o+65535,o=Math.floor(n/65536),f=n-o*65536,n=m+o+65535,o=Math.floor(n/65536),m=n-o*65536,n=h+o+65535,o=Math.floor(n/65536),h=n-o*65536,n=g+o+65535,o=Math.floor(n/65536),g=n-o*65536,n=v+o+65535,o=Math.floor(n/65536),v=n-o*65536,n=b+o+65535,o=Math.floor(n/65536),b=n-o*65536,n=_+o+65535,o=Math.floor(n/65536),_=n-o*65536,n=x+o+65535,o=Math.floor(n/65536),x=n-o*65536,n=S+o+65535,o=Math.floor(n/65536),S=n-o*65536,s+=o-1+37*(o-1),t[0]=s,t[1]=a,t[2]=c,t[3]=l,t[4]=u,t[5]=d,t[6]=p,t[7]=f,t[8]=m,t[9]=h,t[10]=g,t[11]=v,t[12]=b,t[13]=_,t[14]=x,t[15]=S}});var rTe=R((uIr,tTe)=>{var yl=dr();Qr();su();nL();tTe.exports=yl.kem=yl.kem||{};var ZCe=yl.jsbn.BigInteger;yl.kem.rsa={};yl.kem.rsa.create=function(t,e){e=e||{};var r=e.prng||yl.random,n={};return n.encrypt=function(o,s){var a=Math.ceil(o.n.bitLength()/8),c;do c=new ZCe(yl.util.bytesToHex(r.getBytesSync(a)),16).mod(o.n);while(c.compareTo(ZCe.ONE)<=0);c=yl.util.hexToBytes(c.toString(16));var l=a-c.length;l>0&&(c=yl.util.fillString("\0",l)+c);var u=o.encrypt(c,"NONE"),d=t.generate(c,s);return{encapsulation:u,key:d}},n.decrypt=function(o,s,a){var c=o.decrypt(s,"NONE");return t.generate(c,a)},n};yl.kem.kdf1=function(t,e){eTe(this,t,0,e||t.digestLength)};yl.kem.kdf2=function(t,e){eTe(this,t,1,e||t.digestLength)};function eTe(t,e,r,n){t.generate=function(o,s){for(var a=new yl.util.ByteBuffer,c=Math.ceil(s/n)+r,l=new yl.util.ByteBuffer,u=r;u<c;++u){l.putInt32(u),e.start(),e.update(o+l.getBytes());var d=e.digest();a.putBytes(d.getBytes(n))}return a.truncate(a.length()-s),a.getBytes()}}});var sTe=R((dIr,oTe)=>{var Fr=dr();Qr();oTe.exports=Fr.log=Fr.log||{};Fr.log.levels=["none","error","warning","info","debug","verbose","max"];var H7={},Zee=[],uL=null;Fr.log.LEVEL_LOCKED=2;Fr.log.NO_LEVEL_CHECK=4;Fr.log.INTERPOLATE=8;for(hf=0;hf<Fr.log.levels.length;++hf)Xee=Fr.log.levels[hf],H7[Xee]={index:hf,name:Xee.toUpperCase()};var Xee,hf;Fr.log.logMessage=function(t){for(var e=H7[t.level].index,r=0;r<Zee.length;++r){var n=Zee[r];if(n.flags&Fr.log.NO_LEVEL_CHECK)n.f(t);else{var o=H7[n.level].index;e<=o&&n.f(n,t)}}};Fr.log.prepareStandard=function(t){"standard"in t||(t.standard=H7[t.level].name+" ["+t.category+"] "+t.message)};Fr.log.prepareFull=function(t){if(!("full"in t)){var e=[t.message];e=e.concat([]),t.full=Fr.util.format.apply(this,e)}};Fr.log.prepareStandardFull=function(t){"standardFull"in t||(Fr.log.prepareStandard(t),t.standardFull=t.standard)};for(Jee=["error","warning","info","debug","verbose"],hf=0;hf<Jee.length;++hf)(function(e){Fr.log[e]=function(r,n){var o=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:e,category:r,message:n,arguments:o};Fr.log.logMessage(s)}})(Jee[hf]);var Jee,hf;Fr.log.makeLogger=function(t){var e={flags:0,f:t};return Fr.log.setLevel(e,"none"),e};Fr.log.setLevel=function(t,e){var r=!1;if(t&&!(t.flags&Fr.log.LEVEL_LOCKED))for(var n=0;n<Fr.log.levels.length;++n){var o=Fr.log.levels[n];if(e==o){t.level=e,r=!0;break}}return r};Fr.log.lock=function(t,e){typeof e>"u"||e?t.flags|=Fr.log.LEVEL_LOCKED:t.flags&=~Fr.log.LEVEL_LOCKED};Fr.log.addLogger=function(t){Zee.push(t)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(nTe={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},dL=function(t,e){Fr.log.prepareStandard(e);var r=nTe[e.level],n=[e.standard];n=n.concat(e.arguments.slice()),r.apply(console,n)},RE=Fr.log.makeLogger(dL)):(dL=function(e,r){Fr.log.prepareStandardFull(r),console.log(r.standardFull)},RE=Fr.log.makeLogger(dL)),Fr.log.setLevel(RE,"debug"),Fr.log.addLogger(RE),uL=RE):console={log:function(){}};var RE,nTe,dL;uL!==null&&typeof window<"u"&&window.location&&(lL=new URL(window.location.href).searchParams,lL.has("console.level")&&Fr.log.setLevel(uL,lL.get("console.level").slice(-1)[0]),lL.has("console.lock")&&(iTe=lL.get("console.lock").slice(-1)[0],iTe=="true"&&Fr.log.lock(uL)));var lL,iTe;Fr.log.consoleLogger=uL});var cTe=R((pIr,aTe)=>{aTe.exports=af();S7();SE();pee();jee()});var dTe=R((fIr,uTe)=>{var Je=dr();W0();Ld();tL();K0();Cx();Eee();su();Qr();M7();var X=Je.asn1,Ba=uTe.exports=Je.pkcs7=Je.pkcs7||{};Ba.messageFromPem=function(t){var e=Je.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=X.fromDer(e.body);return Ba.messageFromAsn1(n)};Ba.messageToPem=function(t,e){var r={type:"PKCS7",body:X.toDer(t.toAsn1()).getBytes()};return Je.pem.encode(r,{maxline:e})};Ba.messageFromAsn1=function(t){var e={},r=[];if(!X.validate(t,Ba.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var o=X.derToOid(e.contentType),s;switch(o){case Je.pki.oids.envelopedData:s=Ba.createEnvelopedData();break;case Je.pki.oids.encryptedData:s=Ba.createEncryptedData();break;case Je.pki.oids.signedData:s=Ba.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Ba.createSignedData=function(){var t=null;return t={type:Je.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(tte(t,n,Ba.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var o=t.rawCapture.certificates.value,s=0;s<o.length;++s)t.certificates.push(Je.pki.certificateFromAsn1(o[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],o=0;o<t.certificates.length;++o)n.push(Je.pki.certificateToAsn1(t.certificates[o]));var s=[],a=X.create(X.Class.CONTEXT_SPECIFIC,0,!0,[X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.INTEGER,!1,X.integerToDer(t.version).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&a.value[0].value.push(X.create(X.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&a.value[0].value.push(X.create(X.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push(X.create(X.Class.UNIVERSAL,X.Type.SET,!0,t.signerInfos)),X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.type).getBytes()),a])},addSigner:function(n){var o=n.issuer,s=n.serialNumber;if(n.certificate){var a=n.certificate;typeof a=="string"&&(a=Je.pki.certificateFromPem(a)),o=a.issuer.attributes,s=a.serialNumber}var c=n.key;if(!c)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof c=="string"&&(c=Je.pki.privateKeyFromPem(c));var l=n.digestAlgorithm||Je.pki.oids.sha1;switch(l){case Je.pki.oids.sha1:case Je.pki.oids.sha256:case Je.pki.oids.sha384:case Je.pki.oids.sha512:case Je.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+l)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var d=!1,p=!1,f=0;f<u.length;++f){var m=u[f];if(!d&&m.type===Je.pki.oids.contentType){if(d=!0,p)break;continue}if(!p&&m.type===Je.pki.oids.messageDigest){if(p=!0,d)break;continue}}if(!d||!p)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:c,version:1,issuer:o,serialNumber:s,digestAlgorithm:l,signatureAlgorithm:Je.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(Je.pki.oids.data).getBytes())]),"content"in t)){var o;t.content instanceof Je.util.ByteBuffer?o=t.content.bytes():typeof t.content=="string"&&(o=Je.util.encodeUtf8(t.content)),n.detached?t.detachedContent=X.create(X.Class.UNIVERSAL,X.Type.OCTETSTRING,!1,o):t.contentInfo.value.push(X.create(X.Class.CONTEXT_SPECIFIC,0,!0,[X.create(X.Class.UNIVERSAL,X.Type.OCTETSTRING,!1,o)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=Je.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},o=0;o<t.signers.length;++o){var s=t.signers[o],a=s.digestAlgorithm;a in n||(n[a]=Je.md[Je.pki.oids[a]].create()),s.authenticatedAttributes.length===0?s.md=n[a]:s.md=Je.md[Je.pki.oids[a]].create()}t.digestAlgorithmIdentifiers=[];for(var a in n)t.digestAlgorithmIdentifiers.push(X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(a).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.NULL,!1,"")]));return n}function r(n){var o;if(t.detachedContent?o=t.detachedContent:(o=t.contentInfo.value[1],o=o.value[0]),!o)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=X.derToOid(t.contentInfo.value[0].value),a=X.toDer(o);a.getByte(),X.getBerValueLength(a),a=a.getBytes();for(var c in n)n[c].start().update(a);for(var l=new Date,u=0;u<t.signers.length;++u){var d=t.signers[u];if(d.authenticatedAttributes.length===0){if(s!==Je.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=X.create(X.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=X.create(X.Class.UNIVERSAL,X.Type.SET,!0,[]),f=0;f<d.authenticatedAttributes.length;++f){var m=d.authenticatedAttributes[f];m.type===Je.pki.oids.messageDigest?m.value=n[d.digestAlgorithm].digest():m.type===Je.pki.oids.signingTime&&(m.value||(m.value=l)),p.value.push(ete(m)),d.authenticatedAttributesAsn1.value.push(ete(m))}a=X.toDer(p).getBytes(),d.md.start().update(a)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=$st(t.signers)}};Ba.createEncryptedData=function(){var t=null;return t={type:Je.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Je.pki.oids["aes256-CBC"]},fromAsn1:function(e){tte(t,e,Ba.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),lTe(t)}},t};Ba.createEnvelopedData=function(){var t=null;return t={type:Je.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Je.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=tte(t,e,Ba.asn1.envelopedDataValidator);t.recipients=Hst(r.recipientInfos.value)},toAsn1:function(){return X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.type).getBytes()),X.create(X.Class.CONTEXT_SPECIFIC,0,!0,[X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.INTEGER,!1,X.integerToDer(t.version).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.SET,!0,Gst(t.recipients)),X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,Wst(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var o=t.recipients[n],s=o.issuer;if(o.serialNumber===e.serialNumber&&s.length===r.length){for(var a=!0,c=0;c<r.length;++c)if(s[c].type!==r[c].type||s[c].value!==r[c].value){a=!1;break}if(a)return o}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case Je.pki.oids.rsaEncryption:case Je.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=Je.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}lTe(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Je.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,o,s;switch(r){case Je.pki.oids["aes128-CBC"]:n=16,o=16,s=Je.aes.createEncryptionCipher;break;case Je.pki.oids["aes192-CBC"]:n=24,o=16,s=Je.aes.createEncryptionCipher;break;case Je.pki.oids["aes256-CBC"]:n=32,o=16,s=Je.aes.createEncryptionCipher;break;case Je.pki.oids["des-EDE3-CBC"]:n=24,o=8,s=Je.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=Je.util.createBuffer(Je.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=Je.util.createBuffer(Je.random.getBytes(o));var a=s(e);if(a.start(t.encryptedContent.parameter.copy()),a.update(t.content),!a.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=a.output}for(var c=0;c<t.recipients.length;++c){var l=t.recipients[c];if(l.encryptedContent.content===void 0)switch(l.encryptedContent.algorithm){case Je.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}},t};function jst(t){var e={},r=[];if(!X.validate(t,Ba.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:Je.pki.RDNAttributesAsArray(e.issuer),serialNumber:Je.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:X.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function Vst(t){return X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.INTEGER,!1,X.integerToDer(t.version).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[Je.pki.distinguishedNameToAsn1({attributes:t.issuer}),X.create(X.Class.UNIVERSAL,X.Type.INTEGER,!1,Je.util.hexToBytes(t.serialNumber))]),X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.encryptedContent.algorithm).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.NULL,!1,"")]),X.create(X.Class.UNIVERSAL,X.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function Hst(t){for(var e=[],r=0;r<t.length;++r)e.push(jst(t[r]));return e}function Gst(t){for(var e=[],r=0;r<t.length;++r)e.push(Vst(t[r]));return e}function zst(t){var e=X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.INTEGER,!1,X.integerToDer(t.version).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[Je.pki.distinguishedNameToAsn1({attributes:t.issuer}),X.create(X.Class.UNIVERSAL,X.Type.INTEGER,!1,Je.util.hexToBytes(t.serialNumber))]),X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.digestAlgorithm).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.signatureAlgorithm).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.NULL,!1,"")])),e.value.push(X.create(X.Class.UNIVERSAL,X.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=X.create(X.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var o=t.unauthenticatedAttributes[n];r.values.push(ete(o))}e.value.push(r)}return e}function $st(t){for(var e=[],r=0;r<t.length;++r)e.push(zst(t[r]));return e}function ete(t){var e;if(t.type===Je.pki.oids.contentType)e=X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.value).getBytes());else if(t.type===Je.pki.oids.messageDigest)e=X.create(X.Class.UNIVERSAL,X.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===Je.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),o=t.value;if(typeof o=="string"){var s=Date.parse(o);isNaN(s)?o.length===13?o=X.utcTimeToDate(o):o=X.generalizedTimeToDate(o):o=new Date(s)}o>=r&&o<n?e=X.create(X.Class.UNIVERSAL,X.Type.UTCTIME,!1,X.dateToUtcTime(o)):e=X.create(X.Class.UNIVERSAL,X.Type.GENERALIZEDTIME,!1,X.dateToGeneralizedTime(o))}return X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.type).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.SET,!0,[e])])}function Wst(t){return[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(Je.pki.oids.data).getBytes()),X.create(X.Class.UNIVERSAL,X.Type.SEQUENCE,!0,[X.create(X.Class.UNIVERSAL,X.Type.OID,!1,X.oidToDer(t.algorithm).getBytes()),t.parameter?X.create(X.Class.UNIVERSAL,X.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),X.create(X.Class.CONTEXT_SPECIFIC,0,!0,[X.create(X.Class.UNIVERSAL,X.Type.OCTETSTRING,!1,t.content.getBytes())])]}function tte(t,e,r){var n={},o=[];if(!X.validate(e,r,n,o)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var a=X.derToOid(n.contentType);if(a!==Je.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var c="";if(Je.util.isArray(n.encryptedContent))for(var l=0;l<n.encryptedContent.length;++l){if(n.encryptedContent[l].type!==X.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=n.encryptedContent[l].value}else c=n.encryptedContent;t.encryptedContent={algorithm:X.derToOid(n.encAlgorithm),parameter:Je.util.createBuffer(n.encParameter.value),content:Je.util.createBuffer(c)}}if(n.content){var c="";if(Je.util.isArray(n.content))for(var l=0;l<n.content.length;++l){if(n.content[l].type!==X.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");c+=n.content[l].value}else c=n.content;t.content=Je.util.createBuffer(c)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function lTe(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case Je.pki.oids["aes128-CBC"]:case Je.pki.oids["aes192-CBC"]:case Je.pki.oids["aes256-CBC"]:e=Je.aes.createDecryptionCipher(t.encryptedContent.key);break;case Je.pki.oids.desCBC:case Je.pki.oids["des-EDE3-CBC"]:e=Je.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var fTe=R((mIr,pTe)=>{var Eo=dr();W0();yE();S7();SE();Qr();var z7=pTe.exports=Eo.ssh=Eo.ssh||{};z7.privateKeyToPutty=function(t,e,r){r=r||"",e=e||"";var n="ssh-rsa",o=e===""?"none":"aes256-cbc",s="PuTTY-User-Key-File-2: "+n+`\r
`;s+="Encryption: "+o+`\r
`,s+="Comment: "+r+`\r
`;var a=Eo.util.createBuffer();PE(a,n),gf(a,t.e),gf(a,t.n);var c=Eo.util.encode64(a.bytes(),64),l=Math.floor(c.length/66)+1;s+="Public-Lines: "+l+`\r
`,s+=c;var u=Eo.util.createBuffer();gf(u,t.d),gf(u,t.p),gf(u,t.q),gf(u,t.qInv);var d;if(!e)d=Eo.util.encode64(u.bytes(),64);else{var p=u.length()+16-1;p-=p%16;var f=G7(u.bytes());f.truncate(f.length()-p+u.length()),u.putBuffer(f);var m=Eo.util.createBuffer();m.putBuffer(G7("\0\0\0\0",e)),m.putBuffer(G7("\0\0\0",e));var h=Eo.aes.createEncryptionCipher(m.truncate(8),"CBC");h.start(Eo.util.createBuffer().fillWithByte(0,16)),h.update(u.copy()),h.finish();var g=h.output;g.truncate(16),d=Eo.util.encode64(g.bytes(),64)}l=Math.floor(d.length/66)+1,s+=`\r
Private-Lines: `+l+`\r
`,s+=d;var v=G7("putty-private-key-file-mac-key",e),b=Eo.util.createBuffer();PE(b,n),PE(b,o),PE(b,r),b.putInt32(a.length()),b.putBuffer(a),b.putInt32(u.length()),b.putBuffer(u);var _=Eo.hmac.create();return _.start("sha1",v),_.update(b.bytes()),s+=`\r
Private-MAC: `+_.digest().toHex()+`\r
`,s};z7.publicKeyToOpenSSH=function(t,e){var r="ssh-rsa";e=e||"";var n=Eo.util.createBuffer();return PE(n,r),gf(n,t.e),gf(n,t.n),r+" "+Eo.util.encode64(n.bytes())+" "+e};z7.privateKeyToOpenSSH=function(t,e){return e?Eo.pki.encryptRsaPrivateKey(t,e,{legacy:!0,algorithm:"aes128"}):Eo.pki.privateKeyToPem(t)};z7.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||Eo.md.md5.create(),n="ssh-rsa",o=Eo.util.createBuffer();PE(o,n),gf(o,t.e),gf(o,t.n),r.start(),r.update(o.getBytes());var s=r.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};function gf(t,e){var r=e.toString(16);r[0]>="8"&&(r="00"+r);var n=Eo.util.hexToBytes(r);t.putInt32(n.length),t.putBytes(n)}function PE(t,e){t.putInt32(e.length),t.putString(e)}function G7(){for(var t=Eo.md.sha1.create(),e=arguments.length,r=0;r<e;++r)t.update(arguments[r]);return t.digest()}});var hTe=R((hIr,mTe)=>{mTe.exports=dr();W0();LCe();Ld();h7();tL();JCe();yE();rTe();sTe();cTe();wee();E7();Cx();xee();Pee();dTe();Dee();Iee();fee();N7();su();gee();fTe();Uee();Qr()});var gTe=R((gIr,Kst)=>{Kst.exports={name:"@roamhq/mac-ca",version:"1.0.7",description:"Get Mac OS Root certificates",main:"index.js",repository:{type:"git",url:"https://github.com/WonderInventions/mac-ca.git"},scripts:{test:'echo "Error: no test specified" && exit 1',lint:"eslint ."},license:"BSD-3-Clause",dependencies:{"node-forge":"^1.3.1"},devDependencies:{eslint:"^8.22.0"}}});var bTe=R((vIr,rte)=>{var W7=hTe(),vTe=gTe(),$7=rte.exports.validFormats={der:0,pem:1,txt:2,asn1:3};function yTe(t){let e=W7.pki.pemToDer(t),r=W7.asn1,n=r.fromDer(e.data.toString("binary")).value[0].value,o=n[0],s=o.tagClass===r.Class.CONTEXT_SPECIFIC&&o.type===0&&o.constructed,a=n.slice(s);return{serial:a[0],issuer:a[2],valid:a[3],subject:a[4]}}function Yst(t){let e=yTe(t),r=new Date,n=e.subject.value.map(a=>a.value[0].value[1].value).join("/"),o=e.valid.value.map(a=>a.value).join(" - "),s=r.toTimeString().replace(/\s*\(.*\)\s*/,"");return[`Subject	${n}`,`Valid	${o}`,`Saved	${r.toLocaleDateString()} ${s} by ${vTe.name}@${vTe.version}`,String(t)].join(`
`)}rte.exports.transform=function(t){return function(e){try{switch(t){case $7.der:return W7.pki.pemToDer(e);case $7.pem:return e;case $7.txt:return Yst(e);case $7.asn1:return yTe(e);default:return W7.pki.certificateFromPem(e)}}catch{return}}}});var _Te=R((yIr,AE)=>{var nte=require("https"),ite=bTe();if(process.platform!=="darwin")AE.exports.all=()=>[],AE.exports.each=()=>{};else{let c=function(u,d,p){return p.indexOf(u)===d};Qst=c;let t=require("child_process"),e=/(?=-----BEGIN\sCERTIFICATE-----)/g,r="/System/Library/Keychains/SystemRootCertificates.keychain",n=["find-certificate","-a","-p"],o=t.spawnSync("/usr/bin/security",n).stdout.toString().split(e),s=t.spawnSync("/usr/bin/security",n.concat(r)).stdout.toString().split(e);nte.globalAgent.options.ca=nte.globalAgent.options.ca||[];let a=nte.globalAgent.options.ca,l=o.concat(s);l.filter(c).forEach(u=>a.push(u)),AE.exports.der2=ite.validFormats,AE.exports.all=function(u){return l.map(ite.transform(u)).filter(d=>d)},AE.exports.each=function(u,d){return typeof u=="function"&&(d=u,u=void 0),l.map(ite.transform(u)).filter(p=>p).forEach(d)}}var Qst});var gwe=R((z7r,hwe)=>{function awe(t){return Array.isArray(t)?t:[t]}var dwe="",cwe=" ",ure="\\",Nct=/^\s+$/,Lct=/(?:[^\\]|^)\\$/,Oct=/^\\!/,Mct=/^\\#/,Fct=/\r?\n/g,Uct=/^\.*\/|^\.+$/,dre="/",pwe="node-ignore";typeof Symbol<"u"&&(pwe=Symbol.for("node-ignore"));var lwe=pwe,Bct=(t,e,r)=>Object.defineProperty(t,e,{value:r}),qct=/([0-z])-([0-z])/g,fwe=()=>!1,jct=t=>t.replace(qct,(e,r,n)=>r.charCodeAt(0)<=n.charCodeAt(0)?e:dwe),Vct=t=>{let{length:e}=t;return t.slice(0,e-e%2)},Hct=[[/\\?\s+$/,t=>t.indexOf("\\")===0?cwe:dwe],[/\\\s/g,()=>cwe],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,r)=>e+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,r)=>{let n=r.replace(/\\\*/g,"[^\\/]*");return e+n}],[/\\\\\\(?=[$.|*+(){^])/g,()=>ure],[/\\\\/g,()=>ure],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,r,n,o)=>e===ure?`\\[${r}${Vct(n)}${o}`:o==="]"&&n.length%2===0?`[${jct(r)}${n}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],uwe=Object.create(null),Gct=(t,e)=>{let r=uwe[t];return r||(r=Hct.reduce((n,o)=>n.replace(o[0],o[1].bind(t)),t),uwe[t]=r),e?new RegExp(r,"i"):new RegExp(r)},mre=t=>typeof t=="string",zct=t=>t&&mre(t)&&!Nct.test(t)&&!Lct.test(t)&&t.indexOf("#")!==0,$ct=t=>t.split(Fct),pre=class{constructor(e,r,n,o){this.origin=e,this.pattern=r,this.negative=n,this.regex=o}},Wct=(t,e)=>{let r=t,n=!1;t.indexOf("!")===0&&(n=!0,t=t.substr(1)),t=t.replace(Oct,"!").replace(Mct,"#");let o=Gct(t,e);return new pre(r,t,n,o)},Kct=(t,e)=>{throw new e(t)},Dh=(t,e,r)=>mre(t)?t?Dh.isNotRelative(t)?r(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:r("path must not be empty",TypeError):r(`path must be a string, but got \`${e}\``,TypeError),mwe=t=>Uct.test(t);Dh.isNotRelative=mwe;Dh.convert=t=>t;var fre=class{constructor({ignorecase:e=!0,ignoreCase:r=e,allowRelativePaths:n=!1}={}){Bct(this,lwe,!0),this._rules=[],this._ignoreCase=r,this._allowRelativePaths=n,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[lwe]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(zct(e)){let r=Wct(e,this._ignoreCase);this._added=!0,this._rules.push(r)}}add(e){return this._added=!1,awe(mre(e)?$ct(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,r){let n=!1,o=!1;return this._rules.forEach(s=>{let{negative:a}=s;if(o===a&&n!==o||a&&!n&&!o&&!r)return;s.regex.test(e)&&(n=!a,o=a)}),{ignored:n,unignored:o}}_test(e,r,n,o){let s=e&&Dh.convert(e);return Dh(s,e,this._allowRelativePaths?fwe:Kct),this._t(s,r,n,o)}_t(e,r,n,o){if(e in r)return r[e];if(o||(o=e.split(dre)),o.pop(),!o.length)return r[e]=this._testOne(e,n);let s=this._t(o.join(dre)+dre,r,n,o);return r[e]=s.ignored?s:this._testOne(e,n)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return awe(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},cB=t=>new fre(t),Yct=t=>Dh(t&&Dh.convert(t),t,fwe);cB.isPathValid=Yct;cB.default=cB;hwe.exports=cB;if(typeof process<"u"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let t=r=>/^\\\\\?\\/.test(r)||/["<>|\u0000-\u001F]+/u.test(r)?r:r.replace(/\\/g,"/");Dh.convert=t;let e=/^[a-z]:\//i;Dh.isNotRelative=r=>e.test(r)||mwe(r)}});var Iwe=R((Q7r,Swe)=>{"use strict";Swe.exports=_we;function _we(t,e,r){t instanceof RegExp&&(t=bwe(t,r)),e instanceof RegExp&&(e=bwe(e,r));var n=xwe(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function bwe(t,e){var r=e.match(t);return r?r[0]:null}_we.range=xwe;function xwe(t,e,r){var n,o,s,a,c,l=r.indexOf(t),u=r.indexOf(e,l+1),d=l;if(l>=0&&u>0){if(t===e)return[l,u];for(n=[],s=r.length;d>=0&&!c;)d==l?(n.push(d),l=r.indexOf(t,d+1)):n.length==1?c=[n.pop(),u]:(o=n.pop(),o<s&&(s=o,a=u),u=r.indexOf(e,d+1)),d=l<u&&l>=0?l:u;n.length&&(c=[s,a])}return c}});var Awe=R((X7r,Pwe)=>{var Cwe=Iwe();Pwe.exports=Jct;var Twe="\0SLASH"+Math.random()+"\0",Ewe="\0OPEN"+Math.random()+"\0",gre="\0CLOSE"+Math.random()+"\0",wwe="\0COMMA"+Math.random()+"\0",kwe="\0PERIOD"+Math.random()+"\0";function hre(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Qct(t){return t.split("\\\\").join(Twe).split("\\{").join(Ewe).split("\\}").join(gre).split("\\,").join(wwe).split("\\.").join(kwe)}function Xct(t){return t.split(Twe).join("\\").split(Ewe).join("{").split(gre).join("}").split(wwe).join(",").split(kwe).join(".")}function Rwe(t){if(!t)return[""];var e=[],r=Cwe("{","}",t);if(!r)return t.split(",");var n=r.pre,o=r.body,s=r.post,a=n.split(",");a[a.length-1]+="{"+o+"}";var c=Rwe(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}function Jct(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),$L(Qct(t),!0).map(Xct)):[]}function Zct(t){return"{"+t+"}"}function elt(t){return/^-?0\d/.test(t)}function tlt(t,e){return t<=e}function rlt(t,e){return t>=e}function $L(t,e){var r=[],n=Cwe("{","}",t);if(!n)return[t];var o=n.pre,s=n.post.length?$L(n.post,!1):[""];if(/\$$/.test(n.pre))for(var a=0;a<s.length;a++){var c=o+"{"+n.body+"}"+s[a];r.push(c)}else{var l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),d=l||u,p=n.body.indexOf(",")>=0;if(!d&&!p)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+gre+n.post,$L(t)):[t];var f;if(d)f=n.body.split(/\.\./);else if(f=Rwe(n.body),f.length===1&&(f=$L(f[0],!1).map(Zct),f.length===1))return s.map(function(F){return n.pre+f[0]+F});var m;if(d){var h=hre(f[0]),g=hre(f[1]),v=Math.max(f[0].length,f[1].length),b=f.length==3?Math.abs(hre(f[2])):1,_=tlt,x=g<h;x&&(b*=-1,_=rlt);var S=f.some(elt);m=[];for(var I=h;_(I,g);I+=b){var w;if(u)w=String.fromCharCode(I),w==="\\"&&(w="");else if(w=String(I),S){var k=v-w.length;if(k>0){var M=new Array(k+1).join("0");I<0?w="-"+M+w.slice(1):w=M+w}}m.push(w)}}else{m=[];for(var H=0;H<f.length;H++)m.push.apply(m,$L(f[H],!1))}for(var H=0;H<m.length;H++)for(var a=0;a<s.length;a++){var c=o+m[H]+s[a];(!e||d||c)&&r.push(c)}}return r}});var TB=R((exports,module)=>{var Module=Module!==void 0?Module:{},TreeSitter=function(){var initPromise,document=typeof window=="object"?{currentScript:window.document.currentScript}:null;class Parser{constructor(){this.initialize()}initialize(){throw new Error("cannot construct a Parser before calling `init()`")}static init(moduleOptions){return initPromise||(Module=Object.assign({},Module,moduleOptions),initPromise=new Promise(resolveInitPromise=>{var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=(t,e)=>{throw e},ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof importScripts=="function",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",scriptDirectory="",read_,readAsync,readBinary;function locateFile(t){return Module.locateFile?Module.locateFile(t,scriptDirectory):scriptDirectory+t}if(ENVIRONMENT_IS_NODE){var fs=require("fs"),nodePath=require("path");scriptDirectory=ENVIRONMENT_IS_WORKER?nodePath.dirname(scriptDirectory)+"/":__dirname+"/",read_=(t,e)=>(t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFileSync(t,e?void 0:"utf8")),readBinary=t=>{var e=read_(t,!0);return e.buffer||(e=new Uint8Array(e)),e},readAsync=(t,e,r,n=!0)=>{t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFile(t,n?void 0:"utf8",(o,s)=>{o?r(o):e(n?s.buffer:s)})},!Module.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),typeof module<"u"&&(module.exports=Module),quit_=(t,e)=>{throw process.exitCode=t,e}}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:document!==void 0&&document.currentScript&&(scriptDirectory=document.currentScript.src),scriptDirectory=scriptDirectory.startsWith("blob:")?"":scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1),read_=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},ENVIRONMENT_IS_WORKER&&(readBinary=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),readAsync=(t,e,r)=>{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{n.status==200||n.status==0&&n.response?e(n.response):r()},n.onerror=r,n.send(null)});var out=Module.print||console.log.bind(console),err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram),Module.quit&&(quit_=Module.quit);var dynamicLibraries=Module.dynamicLibraries||[],wasmBinary,wasmMemory;Module.wasmBinary&&(wasmBinary=Module.wasmBinary),typeof WebAssembly!="object"&&abort("no native wasm support detected");var ABORT=!1,EXITSTATUS,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var t=wasmMemory.buffer;Module.HEAP8=HEAP8=new Int8Array(t),Module.HEAP16=HEAP16=new Int16Array(t),Module.HEAPU8=HEAPU8=new Uint8Array(t),Module.HEAPU16=HEAPU16=new Uint16Array(t),Module.HEAP32=HEAP32=new Int32Array(t),Module.HEAPU32=HEAPU32=new Uint32Array(t),Module.HEAPF32=HEAPF32=new Float32Array(t),Module.HEAPF64=HEAPF64=new Float64Array(t)}var INITIAL_MEMORY=Module.INITIAL_MEMORY||33554432;wasmMemory=Module.wasmMemory?Module.wasmMemory:new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:32768}),updateMemoryViews(),INITIAL_MEMORY=wasmMemory.buffer.byteLength;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATPOSTRUN__=[],__RELOC_FUNCS__=[],runtimeInitialized=!1;function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),callRuntimeCallbacks(__ATINIT__)}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(t){__ATPRERUN__.unshift(t)}function addOnInit(t){__ATINIT__.unshift(t)}function addOnPostRun(t){__ATPOSTRUN__.unshift(t)}var runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function getUniqueRunDependency(t){return t}function addRunDependency(t){runDependencies++,Module.monitorRunDependencies?.(runDependencies)}function removeRunDependency(t){if(runDependencies--,Module.monitorRunDependencies?.(runDependencies),runDependencies==0&&(runDependencyWatcher!==null&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}function abort(t){throw Module.onAbort?.(t),err(t="Aborted("+t+")"),ABORT=!0,EXITSTATUS=1,t+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(t)}var dataURIPrefix="data:application/octet-stream;base64,",isDataURI=t=>t.startsWith(dataURIPrefix),isFileURI=t=>t.startsWith("file://"),wasmBinaryFile;function getBinarySync(t){if(t==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(t);throw"both async and sync fetching of the wasm failed"}function getBinaryPromise(t){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"&&!isFileURI(t))return fetch(t,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw`failed to load wasm binary file at '${t}'`;return e.arrayBuffer()}).catch(()=>getBinarySync(t));if(readAsync)return new Promise((e,r)=>{readAsync(t,n=>e(new Uint8Array(n)),r)})}return Promise.resolve().then(()=>getBinarySync(t))}function instantiateArrayBuffer(t,e,r){return getBinaryPromise(t).then(n=>WebAssembly.instantiate(n,e)).then(r,n=>{err(`failed to asynchronously prepare wasm: ${n}`),abort(n)})}function instantiateAsync(t,e,r,n){return t||typeof WebAssembly.instantiateStreaming!="function"||isDataURI(e)||isFileURI(e)||ENVIRONMENT_IS_NODE||typeof fetch!="function"?instantiateArrayBuffer(e,r,n):fetch(e,{credentials:"same-origin"}).then(o=>WebAssembly.instantiateStreaming(o,r).then(n,function(s){return err(`wasm streaming compile failed: ${s}`),err("falling back to ArrayBuffer instantiation"),instantiateArrayBuffer(e,r,n)}))}function createWasm(){var t={env:wasmImports,wasi_snapshot_preview1:wasmImports,"GOT.mem":new Proxy(wasmImports,GOTHandler),"GOT.func":new Proxy(wasmImports,GOTHandler)};function e(r,n){wasmExports=r.exports,wasmExports=relocateExports(wasmExports,1024);var o=getDylinkMetadata(n);return o.neededDynlibs&&(dynamicLibraries=o.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(wasmExports,"main"),LDSO.init(),loadDylibs(),addOnInit(wasmExports.__wasm_call_ctors),__RELOC_FUNCS__.push(wasmExports.__wasm_apply_data_relocs),removeRunDependency("wasm-instantiate"),wasmExports}if(addRunDependency("wasm-instantiate"),Module.instantiateWasm)try{return Module.instantiateWasm(t,e)}catch(r){return err(`Module.instantiateWasm callback failed with error: ${r}`),!1}return instantiateAsync(wasmBinary,wasmBinaryFile,t,function(r){e(r.instance,r.module)}),{}}wasmBinaryFile="tree-sitter.wasm",isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile));var ASM_CONSTS={};function ExitStatus(t){this.name="ExitStatus",this.message=`Program terminated with exit(${t})`,this.status=t}var GOT={},currentModuleWeakSymbols=new Set([]),GOTHandler={get(t,e){var r=GOT[e];return r||(r=GOT[e]=new WebAssembly.Global({value:"i32",mutable:!0})),currentModuleWeakSymbols.has(e)||(r.required=!0),r}},callRuntimeCallbacks=t=>{for(;t.length>0;)t.shift()(Module)},UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,UTF8ArrayToString=(t,e,r)=>{for(var n=e+r,o=e;t[o]&&!(o>=n);)++o;if(o-e>16&&t.buffer&&UTF8Decoder)return UTF8Decoder.decode(t.subarray(e,o));for(var s="";e<o;){var a=t[e++];if(128&a){var c=63&t[e++];if((224&a)!=192){var l=63&t[e++];if((a=(240&a)==224?(15&a)<<12|c<<6|l:(7&a)<<18|c<<12|l<<6|63&t[e++])<65536)s+=String.fromCharCode(a);else{var u=a-65536;s+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else s+=String.fromCharCode((31&a)<<6|c)}else s+=String.fromCharCode(a)}return s},getDylinkMetadata=t=>{var e=0,r=0;function n(){for(var b=0,_=1;;){var x=t[e++];if(b+=(127&x)*_,_*=128,!(128&x))break}return b}function o(){var b=n();return UTF8ArrayToString(t,(e+=b)-b,b)}function s(b,_){if(b)throw new Error(_)}var a="dylink.0";if(t instanceof WebAssembly.Module){var c=WebAssembly.Module.customSections(t,a);c.length===0&&(a="dylink",c=WebAssembly.Module.customSections(t,a)),s(c.length===0,"need dylink section"),r=(t=new Uint8Array(c[0])).length}else{s(new Uint32Array(new Uint8Array(t.subarray(0,24)).buffer)[0]!=1836278016,"need to see wasm magic number"),s(t[8]!==0,"need the dylink section to be first"),e=9;var l=n();r=e+l,a=o()}var u={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(a=="dylink"){u.memorySize=n(),u.memoryAlign=n(),u.tableSize=n(),u.tableAlign=n();for(var d=n(),p=0;p<d;++p){var f=o();u.neededDynlibs.push(f)}}else for(s(a!=="dylink.0");e<r;){var m=t[e++],h=n();if(m===1)u.memorySize=n(),u.memoryAlign=n(),u.tableSize=n(),u.tableAlign=n();else if(m===2)for(d=n(),p=0;p<d;++p)f=o(),u.neededDynlibs.push(f);else if(m===3)for(var g=n();g--;){var v=o();256&n()&&u.tlsExports.add(v)}else if(m===4)for(g=n();g--;)o(),v=o(),(3&n())==1&&u.weakImports.add(v);else e+=h}return u};function getValue(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return HEAP8[t];case"i16":return HEAP16[t>>1];case"i32":return HEAP32[t>>2];case"i64":abort("to do getValue(i64) use WASM_BIGINT");case"float":return HEAPF32[t>>2];case"double":return HEAPF64[t>>3];case"*":return HEAPU32[t>>2];default:abort(`invalid type for getValue: ${e}`)}}var newDSO=(t,e,r)=>{var n={refcount:1/0,name:t,exports:r,global:!0};return LDSO.loadedLibsByName[t]=n,e!=null&&(LDSO.loadedLibsByHandle[e]=n),n},LDSO={loadedLibsByName:{},loadedLibsByHandle:{},init(){newDSO("__main__",0,wasmImports)}},___heap_base=78096,zeroMemory=(t,e)=>(HEAPU8.fill(0,t,t+e),t),alignMemory=(t,e)=>Math.ceil(t/e)*e,getMemory=t=>{if(runtimeInitialized)return zeroMemory(_malloc(t),t);var e=___heap_base,r=e+alignMemory(t,16);return ___heap_base=r,GOT.__heap_base.value=r,e},isInternalSym=t=>["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm","__start_em_js","__stop_em_js"].includes(t)||t.startsWith("__em_js__"),uleb128Encode=(t,e)=>{t<128?e.push(t):e.push(t%128|128,t>>7)},sigToWasmTypes=t=>{for(var e={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},r={parameters:[],results:t[0]=="v"?[]:[e[t[0]]]},n=1;n<t.length;++n)r.parameters.push(e[t[n]]);return r},generateFuncType=(t,e)=>{var r=t.slice(0,1),n=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111};e.push(96),uleb128Encode(n.length,e);for(var s=0;s<n.length;++s)e.push(o[n[s]]);r=="v"?e.push(0):e.push(1,o[r])},convertJsFunctionToWasm=(t,e)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(e),t);var r=[1];generateFuncType(e,r);var n=[0,97,115,109,1,0,0,0,1];uleb128Encode(r.length,n),n.push(...r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(o,{e:{f:t}}).exports.f},wasmTableMirror=[],wasmTable=new WebAssembly.Table({initial:27,element:"anyfunc"}),getWasmTableEntry=t=>{var e=wasmTableMirror[t];return e||(t>=wasmTableMirror.length&&(wasmTableMirror.length=t+1),wasmTableMirror[t]=e=wasmTable.get(t)),e},updateTableMap=(t,e)=>{if(functionsInTableMap)for(var r=t;r<t+e;r++){var n=getWasmTableEntry(r);n&&functionsInTableMap.set(n,r)}},functionsInTableMap,getFunctionAddress=t=>(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.get(t)||0),freeTableIndexes=[],getEmptyTableSlot=()=>{if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(t){throw t instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":t}return wasmTable.length-1},setWasmTableEntry=(t,e)=>{wasmTable.set(t,e),wasmTableMirror[t]=wasmTable.get(t)},addFunction=(t,e)=>{var r=getFunctionAddress(t);if(r)return r;var n=getEmptyTableSlot();try{setWasmTableEntry(n,t)}catch(s){if(!(s instanceof TypeError))throw s;var o=convertJsFunctionToWasm(t,e);setWasmTableEntry(n,o)}return functionsInTableMap.set(t,n),n},updateGOT=(t,e)=>{for(var r in t)if(!isInternalSym(r)){var n=t[r];r.startsWith("orig$")&&(r=r.split("$")[1],e=!0),GOT[r]||=new WebAssembly.Global({value:"i32",mutable:!0}),(e||GOT[r].value==0)&&(typeof n=="function"?GOT[r].value=addFunction(n):typeof n=="number"?GOT[r].value=n:err(`unhandled export type for '${r}': ${typeof n}`))}},relocateExports=(t,e,r)=>{var n={};for(var o in t){var s=t[o];typeof s=="object"&&(s=s.value),typeof s=="number"&&(s+=e),n[o]=s}return updateGOT(n,r),n},isSymbolDefined=t=>{var e=wasmImports[t];return!(!e||e.stub)},dynCallLegacy=(t,e,r)=>(0,Module["dynCall_"+t])(e,...r),dynCall=(t,e,r=[])=>t.includes("j")?dynCallLegacy(t,e,r):getWasmTableEntry(e)(...r),createInvokeFunction=t=>function(){var e=stackSave();try{return dynCall(t,arguments[0],Array.prototype.slice.call(arguments,1))}catch(r){if(stackRestore(e),r!==r+0)throw r;_setThrew(1,0)}},resolveGlobalSymbol=(t,e=!1)=>{var r;return e&&"orig$"+t in wasmImports&&(t="orig$"+t),isSymbolDefined(t)?r=wasmImports[t]:t.startsWith("invoke_")&&(r=wasmImports[t]=createInvokeFunction(t.split("_")[1])),{sym:r,name:t}},UTF8ToString=(t,e)=>t?UTF8ArrayToString(HEAPU8,t,e):"",loadWebAssemblyModule=(binary,flags,libName,localScope,handle)=>{var metadata=getDylinkMetadata(binary);function loadModule(){var firstLoad=!handle||!HEAP8[handle+8];if(firstLoad){var memAlign=Math.pow(2,metadata.memoryAlign),memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0;handle&&(HEAP8[handle+8]=1,HEAPU32[handle+12>>2]=memoryBase,HEAP32[handle+16>>2]=metadata.memorySize,HEAPU32[handle+20>>2]=tableBase,HEAP32[handle+24>>2]=metadata.tableSize)}else memoryBase=HEAPU32[handle+12>>2],tableBase=HEAPU32[handle+20>>2];var tableGrowthNeeded=tableBase+metadata.tableSize-wasmTable.length,moduleExports;function resolveSymbol(t){var e=resolveGlobalSymbol(t).sym;return!e&&localScope&&(e=localScope[t]),e||(e=moduleExports[t]),e}tableGrowthNeeded>0&&wasmTable.grow(tableGrowthNeeded);var proxyHandler={get(t,e){switch(e){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(e in wasmImports&&!wasmImports[e].stub)return wasmImports[e];var r;return e in t||(t[e]=(...n)=>(r||=resolveSymbol(e),r(...n))),t[e]}},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(module,instance){function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func=`(${args}) => { ${body} };`;ASM_CONSTS[start]=eval(func)}if(updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols(),"__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}function addEmJs(name,cSig,body){var jsArgs=[];if(cSig=cSig.slice(1,-1),cSig!="void")for(var i in cSig=cSig.split(","),cSig){var jsArg=cSig[i].split(" ").pop();jsArgs.push(jsArg.replace("*",""))}var func=`(${jsArgs}) => ${body};`;moduleExports[name]=eval(func)}for(var name in moduleExports)if(name.startsWith("__em_js__")){var start=moduleExports[name],jsString=UTF8ToString(start),parts=jsString.split("<::>");addEmJs(name.replace("__em_js__",""),parts[0],parts[1]),delete moduleExports[name]}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():__ATINIT__.push(init)),moduleExports}if(flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(binary,instance))}return WebAssembly.instantiate(binary,info).then(t=>postInstantiation(t.module,t.instance))}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(module,instance)}return currentModuleWeakSymbols=metadata.weakImports,flags.loadAsync?metadata.neededDynlibs.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,flags)),Promise.resolve()).then(loadModule):(metadata.neededDynlibs.forEach(t=>loadDynamicLibrary(t,flags,localScope)),loadModule())},mergeLibSymbols=(t,e)=>{for(var[r,n]of Object.entries(t)){let o=a=>{isSymbolDefined(a)||(wasmImports[a]=n)};o(r);let s="__main_argc_argv";r=="main"&&o(s),r==s&&o("main"),r.startsWith("dynCall_")&&!Module.hasOwnProperty(r)&&(Module[r]=n)}},asyncLoad=(t,e,r,n)=>{var o=n?"":`al ${t}`;readAsync(t,s=>{e(new Uint8Array(s)),o&&removeRunDependency(o)},s=>{if(!r)throw`Loading data file "${t}" failed.`;r()}),o&&addRunDependency(o)};function loadDynamicLibrary(t,e={global:!0,nodelete:!0},r,n){var o=LDSO.loadedLibsByName[t];if(o)return e.global?o.global||(o.global=!0,mergeLibSymbols(o.exports,t)):r&&Object.assign(r,o.exports),e.nodelete&&o.refcount!==1/0&&(o.refcount=1/0),o.refcount++,n&&(LDSO.loadedLibsByHandle[n]=o),!e.loadAsync||Promise.resolve(!0);function s(){if(n){var l=HEAPU32[n+28>>2],u=HEAPU32[n+32>>2];if(l&&u){var d=HEAP8.slice(l,l+u);return e.loadAsync?Promise.resolve(d):d}}var p=locateFile(t);if(e.loadAsync)return new Promise(function(f,m){asyncLoad(p,f,m)});if(!readBinary)throw new Error(`${p}: file not found, and synchronous loading of external files is not available`);return readBinary(p)}function a(){return e.loadAsync?s().then(l=>loadWebAssemblyModule(l,e,t,r,n)):loadWebAssemblyModule(s(),e,t,r,n)}function c(l){o.global?mergeLibSymbols(l,t):r&&Object.assign(r,l),o.exports=l}return(o=newDSO(t,n,"loading")).refcount=e.nodelete?1/0:1,o.global=e.global,e.loadAsync?a().then(l=>(c(l),!0)):(c(a()),!0)}var reportUndefinedSymbols=()=>{for(var[t,e]of Object.entries(GOT))if(e.value==0){var r=resolveGlobalSymbol(t,!0).sym;if(!r&&!e.required)continue;if(typeof r=="function")e.value=addFunction(r,r.sig);else{if(typeof r!="number")throw new Error(`bad export type for '${t}': ${typeof r}`);e.value=r}}},loadDylibs=()=>{dynamicLibraries.length?(addRunDependency("loadDylibs"),dynamicLibraries.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})),Promise.resolve()).then(()=>{reportUndefinedSymbols(),removeRunDependency("loadDylibs")})):reportUndefinedSymbols()},noExitRuntime=Module.noExitRuntime||!0;function setValue(t,e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":case"i8":HEAP8[t]=e;break;case"i16":HEAP16[t>>1]=e;break;case"i32":HEAP32[t>>2]=e;break;case"i64":abort("to do setValue(i64) use WASM_BIGINT");case"float":HEAPF32[t>>2]=e;break;case"double":HEAPF64[t>>3]=e;break;case"*":HEAPU32[t>>2]=e;break;default:abort(`invalid type for setValue: ${r}`)}}var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},78096),___table_base=new WebAssembly.Global({value:"i32",mutable:!1},1),nowIsMonotonic=1,__emscripten_get_now_is_monotonic=()=>nowIsMonotonic;__emscripten_get_now_is_monotonic.sig="i";var _abort=()=>{abort("")};_abort.sig="v";var _emscripten_date_now=()=>Date.now(),_emscripten_get_now;_emscripten_date_now.sig="d",_emscripten_get_now=()=>performance.now(),_emscripten_get_now.sig="d";var _emscripten_memcpy_js=(t,e,r)=>HEAPU8.copyWithin(t,e,e+r);_emscripten_memcpy_js.sig="vppp";var getHeapMax=()=>2147483648,growMemory=t=>{var e=(t-wasmMemory.buffer.byteLength+65535)/65536;try{return wasmMemory.grow(e),updateMemoryViews(),1}catch{}},_emscripten_resize_heap=t=>{var e=HEAPU8.length;t>>>=0;var r=getHeapMax();if(t>r)return!1;for(var n,o,s=1;s<=4;s*=2){var a=e*(1+.2/s);a=Math.min(a,t+100663296);var c=Math.min(r,(n=Math.max(t,a))+((o=65536)-n%o)%o);if(growMemory(c))return!0}return!1};_emscripten_resize_heap.sig="ip";var _fd_close=t=>52;_fd_close.sig="ii";var convertI32PairToI53Checked=(t,e)=>e+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*e:NaN;function _fd_seek(t,e,r,n,o){return convertI32PairToI53Checked(e,r),70}_fd_seek.sig="iiiiip";var printCharBuffers=[null,[],[]],printChar=(t,e)=>{var r=printCharBuffers[t];e===0||e===10?((t===1?out:err)(UTF8ArrayToString(r,0)),r.length=0):r.push(e)},SYSCALLS={varargs:void 0,get(){var t=HEAP32[+SYSCALLS.varargs>>2];return SYSCALLS.varargs+=4,t},getp:()=>SYSCALLS.get(),getStr:t=>UTF8ToString(t)},_fd_write=(t,e,r,n)=>{for(var o=0,s=0;s<r;s++){var a=HEAPU32[e>>2],c=HEAPU32[e+4>>2];e+=8;for(var l=0;l<c;l++)printChar(t,HEAPU8[a+l]);o+=c}return HEAPU32[n>>2]=o,0};function _tree_sitter_log_callback(t,e){if(currentLogCallback){let r=UTF8ToString(e);currentLogCallback(r,t!==0)}}function _tree_sitter_parse_callback(t,e,r,n,o){let s=currentParseCallback(e,{row:r,column:n});typeof s=="string"?(setValue(o,s.length,"i32"),stringToUTF16(s,t,10240)):setValue(o,0,"i32")}_fd_write.sig="iippp";var runtimeKeepaliveCounter=0,keepRuntimeAlive=()=>noExitRuntime||runtimeKeepaliveCounter>0,_proc_exit=t=>{EXITSTATUS=t,keepRuntimeAlive()||(Module.onExit?.(t),ABORT=!0),quit_(t,new ExitStatus(t))};_proc_exit.sig="vi";var exitJS=(t,e)=>{EXITSTATUS=t,_proc_exit(t)},handleException=t=>{if(t instanceof ExitStatus||t=="unwind")return EXITSTATUS;quit_(1,t)},lengthBytesUTF8=t=>{for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++r):e+=3}return e},stringToUTF8Array=(t,e,r,n)=>{if(!(n>0))return 0;for(var o=r,s=r+n-1,a=0;a<t.length;++a){var c=t.charCodeAt(a);if(c>=55296&&c<=57343&&(c=65536+((1023&c)<<10)|1023&t.charCodeAt(++a)),c<=127){if(r>=s)break;e[r++]=c}else if(c<=2047){if(r+1>=s)break;e[r++]=192|c>>6,e[r++]=128|63&c}else if(c<=65535){if(r+2>=s)break;e[r++]=224|c>>12,e[r++]=128|c>>6&63,e[r++]=128|63&c}else{if(r+3>=s)break;e[r++]=240|c>>18,e[r++]=128|c>>12&63,e[r++]=128|c>>6&63,e[r++]=128|63&c}}return e[r]=0,r-o},stringToUTF8=(t,e,r)=>stringToUTF8Array(t,HEAPU8,e,r),stringToUTF8OnStack=t=>{var e=lengthBytesUTF8(t)+1,r=stackAlloc(e);return stringToUTF8(t,r,e),r},stringToUTF16=(t,e,r)=>{if(r??=2147483647,r<2)return 0;for(var n=e,o=(r-=2)<2*t.length?r/2:t.length,s=0;s<o;++s){var a=t.charCodeAt(s);HEAP16[e>>1]=a,e+=2}return HEAP16[e>>1]=0,e-n},AsciiToString=t=>{for(var e="";;){var r=HEAPU8[t++];if(!r)return e;e+=String.fromCharCode(r)}},wasmImports={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,__table_base:___table_base,_emscripten_get_now_is_monotonic:__emscripten_get_now_is_monotonic,abort:_abort,emscripten_get_now:_emscripten_get_now,emscripten_memcpy_js:_emscripten_memcpy_js,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,memory:wasmMemory,tree_sitter_log_callback:_tree_sitter_log_callback,tree_sitter_parse_callback:_tree_sitter_parse_callback},wasmExports=createWasm(),___wasm_call_ctors=()=>(___wasm_call_ctors=wasmExports.__wasm_call_ctors)(),___wasm_apply_data_relocs=()=>(___wasm_apply_data_relocs=wasmExports.__wasm_apply_data_relocs)(),_malloc=Module._malloc=t=>(_malloc=Module._malloc=wasmExports.malloc)(t),_calloc=Module._calloc=(t,e)=>(_calloc=Module._calloc=wasmExports.calloc)(t,e),_realloc=Module._realloc=(t,e)=>(_realloc=Module._realloc=wasmExports.realloc)(t,e),_free=Module._free=t=>(_free=Module._free=wasmExports.free)(t),_ts_language_symbol_count=Module._ts_language_symbol_count=t=>(_ts_language_symbol_count=Module._ts_language_symbol_count=wasmExports.ts_language_symbol_count)(t),_ts_language_state_count=Module._ts_language_state_count=t=>(_ts_language_state_count=Module._ts_language_state_count=wasmExports.ts_language_state_count)(t),_ts_language_version=Module._ts_language_version=t=>(_ts_language_version=Module._ts_language_version=wasmExports.ts_language_version)(t),_ts_language_field_count=Module._ts_language_field_count=t=>(_ts_language_field_count=Module._ts_language_field_count=wasmExports.ts_language_field_count)(t),_ts_language_next_state=Module._ts_language_next_state=(t,e,r)=>(_ts_language_next_state=Module._ts_language_next_state=wasmExports.ts_language_next_state)(t,e,r),_ts_language_symbol_name=Module._ts_language_symbol_name=(t,e)=>(_ts_language_symbol_name=Module._ts_language_symbol_name=wasmExports.ts_language_symbol_name)(t,e),_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=(t,e,r,n)=>(_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=wasmExports.ts_language_symbol_for_name)(t,e,r,n),_strncmp=Module._strncmp=(t,e,r)=>(_strncmp=Module._strncmp=wasmExports.strncmp)(t,e,r),_ts_language_symbol_type=Module._ts_language_symbol_type=(t,e)=>(_ts_language_symbol_type=Module._ts_language_symbol_type=wasmExports.ts_language_symbol_type)(t,e),_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=(t,e)=>(_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=wasmExports.ts_language_field_name_for_id)(t,e),_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=(t,e)=>(_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=wasmExports.ts_lookahead_iterator_new)(t,e),_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=t=>(_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=wasmExports.ts_lookahead_iterator_delete)(t),_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=(t,e)=>(_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=wasmExports.ts_lookahead_iterator_reset_state)(t,e),_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=(t,e,r)=>(_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=wasmExports.ts_lookahead_iterator_reset)(t,e,r),_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=t=>(_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=wasmExports.ts_lookahead_iterator_next)(t),_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=t=>(_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=wasmExports.ts_lookahead_iterator_current_symbol)(t),_memset=Module._memset=(t,e,r)=>(_memset=Module._memset=wasmExports.memset)(t,e,r),_memcpy=Module._memcpy=(t,e,r)=>(_memcpy=Module._memcpy=wasmExports.memcpy)(t,e,r),_ts_parser_delete=Module._ts_parser_delete=t=>(_ts_parser_delete=Module._ts_parser_delete=wasmExports.ts_parser_delete)(t),_ts_parser_reset=Module._ts_parser_reset=t=>(_ts_parser_reset=Module._ts_parser_reset=wasmExports.ts_parser_reset)(t),_ts_parser_set_language=Module._ts_parser_set_language=(t,e)=>(_ts_parser_set_language=Module._ts_parser_set_language=wasmExports.ts_parser_set_language)(t,e),_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=t=>(_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=wasmExports.ts_parser_timeout_micros)(t),_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=(t,e,r)=>(_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=wasmExports.ts_parser_set_timeout_micros)(t,e,r),_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=(t,e,r)=>(_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=wasmExports.ts_parser_set_included_ranges)(t,e,r),_memmove=Module._memmove=(t,e,r)=>(_memmove=Module._memmove=wasmExports.memmove)(t,e,r),_memcmp=Module._memcmp=(t,e,r)=>(_memcmp=Module._memcmp=wasmExports.memcmp)(t,e,r),_ts_query_new=Module._ts_query_new=(t,e,r,n,o)=>(_ts_query_new=Module._ts_query_new=wasmExports.ts_query_new)(t,e,r,n,o),_ts_query_delete=Module._ts_query_delete=t=>(_ts_query_delete=Module._ts_query_delete=wasmExports.ts_query_delete)(t),_iswspace=Module._iswspace=t=>(_iswspace=Module._iswspace=wasmExports.iswspace)(t),_iswalnum=Module._iswalnum=t=>(_iswalnum=Module._iswalnum=wasmExports.iswalnum)(t),_ts_query_pattern_count=Module._ts_query_pattern_count=t=>(_ts_query_pattern_count=Module._ts_query_pattern_count=wasmExports.ts_query_pattern_count)(t),_ts_query_capture_count=Module._ts_query_capture_count=t=>(_ts_query_capture_count=Module._ts_query_capture_count=wasmExports.ts_query_capture_count)(t),_ts_query_string_count=Module._ts_query_string_count=t=>(_ts_query_string_count=Module._ts_query_string_count=wasmExports.ts_query_string_count)(t),_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=(t,e,r)=>(_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=wasmExports.ts_query_capture_name_for_id)(t,e,r),_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=(t,e,r)=>(_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=wasmExports.ts_query_string_value_for_id)(t,e,r),_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=(t,e,r)=>(_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=wasmExports.ts_query_predicates_for_pattern)(t,e,r),_ts_query_disable_capture=Module._ts_query_disable_capture=(t,e,r)=>(_ts_query_disable_capture=Module._ts_query_disable_capture=wasmExports.ts_query_disable_capture)(t,e,r),_ts_tree_copy=Module._ts_tree_copy=t=>(_ts_tree_copy=Module._ts_tree_copy=wasmExports.ts_tree_copy)(t),_ts_tree_delete=Module._ts_tree_delete=t=>(_ts_tree_delete=Module._ts_tree_delete=wasmExports.ts_tree_delete)(t),_ts_init=Module._ts_init=()=>(_ts_init=Module._ts_init=wasmExports.ts_init)(),_ts_parser_new_wasm=Module._ts_parser_new_wasm=()=>(_ts_parser_new_wasm=Module._ts_parser_new_wasm=wasmExports.ts_parser_new_wasm)(),_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=(t,e)=>(_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=wasmExports.ts_parser_enable_logger_wasm)(t,e),_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=(t,e,r,n,o)=>(_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=wasmExports.ts_parser_parse_wasm)(t,e,r,n,o),_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=t=>(_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=wasmExports.ts_parser_included_ranges_wasm)(t),_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=(t,e)=>(_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=wasmExports.ts_language_type_is_named_wasm)(t,e),_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=(t,e)=>(_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=wasmExports.ts_language_type_is_visible_wasm)(t,e),_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=t=>(_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=wasmExports.ts_tree_root_node_wasm)(t),_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=t=>(_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=wasmExports.ts_tree_root_node_with_offset_wasm)(t),_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=t=>(_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=wasmExports.ts_tree_edit_wasm)(t),_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=t=>(_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=wasmExports.ts_tree_included_ranges_wasm)(t),_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=(t,e)=>(_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=wasmExports.ts_tree_get_changed_ranges_wasm)(t,e),_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=t=>(_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=wasmExports.ts_tree_cursor_new_wasm)(t),_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=t=>(_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=wasmExports.ts_tree_cursor_delete_wasm)(t),_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=t=>(_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=wasmExports.ts_tree_cursor_reset_wasm)(t),_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=(t,e)=>(_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=wasmExports.ts_tree_cursor_reset_to_wasm)(t,e),_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=t=>(_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=wasmExports.ts_tree_cursor_goto_first_child_wasm)(t),_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=t=>(_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=wasmExports.ts_tree_cursor_goto_last_child_wasm)(t),_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=t=>(_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_index_wasm)(t),_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=t=>(_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_position_wasm)(t),_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=t=>(_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=wasmExports.ts_tree_cursor_goto_next_sibling_wasm)(t),_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=t=>(_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=wasmExports.ts_tree_cursor_goto_previous_sibling_wasm)(t),_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=(t,e)=>(_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=wasmExports.ts_tree_cursor_goto_descendant_wasm)(t,e),_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=t=>(_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=wasmExports.ts_tree_cursor_goto_parent_wasm)(t),_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=t=>(_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=wasmExports.ts_tree_cursor_current_node_type_id_wasm)(t),_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=t=>(_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=wasmExports.ts_tree_cursor_current_node_state_id_wasm)(t),_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=t=>(_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=wasmExports.ts_tree_cursor_current_node_is_named_wasm)(t),_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=t=>(_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=wasmExports.ts_tree_cursor_current_node_is_missing_wasm)(t),_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=t=>(_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=wasmExports.ts_tree_cursor_current_node_id_wasm)(t),_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=t=>(_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=wasmExports.ts_tree_cursor_start_position_wasm)(t),_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=t=>(_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=wasmExports.ts_tree_cursor_end_position_wasm)(t),_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=t=>(_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=wasmExports.ts_tree_cursor_start_index_wasm)(t),_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=t=>(_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=wasmExports.ts_tree_cursor_end_index_wasm)(t),_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=t=>(_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=wasmExports.ts_tree_cursor_current_field_id_wasm)(t),_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=t=>(_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=wasmExports.ts_tree_cursor_current_depth_wasm)(t),_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=t=>(_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=wasmExports.ts_tree_cursor_current_descendant_index_wasm)(t),_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=t=>(_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=wasmExports.ts_tree_cursor_current_node_wasm)(t),_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=t=>(_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=wasmExports.ts_node_symbol_wasm)(t),_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=(t,e)=>(_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=wasmExports.ts_node_field_name_for_child_wasm)(t,e),_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=(t,e)=>(_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=wasmExports.ts_node_children_by_field_id_wasm)(t,e),_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=t=>(_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=wasmExports.ts_node_first_child_for_byte_wasm)(t),_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=t=>(_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=wasmExports.ts_node_first_named_child_for_byte_wasm)(t),_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=t=>(_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=wasmExports.ts_node_grammar_symbol_wasm)(t),_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=t=>(_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=wasmExports.ts_node_child_count_wasm)(t),_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=t=>(_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=wasmExports.ts_node_named_child_count_wasm)(t),_ts_node_child_wasm=Module._ts_node_child_wasm=(t,e)=>(_ts_node_child_wasm=Module._ts_node_child_wasm=wasmExports.ts_node_child_wasm)(t,e),_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=(t,e)=>(_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=wasmExports.ts_node_named_child_wasm)(t,e),_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=(t,e)=>(_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=wasmExports.ts_node_child_by_field_id_wasm)(t,e),_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=t=>(_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=wasmExports.ts_node_next_sibling_wasm)(t),_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=t=>(_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=wasmExports.ts_node_prev_sibling_wasm)(t),_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=t=>(_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=wasmExports.ts_node_next_named_sibling_wasm)(t),_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=t=>(_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=wasmExports.ts_node_prev_named_sibling_wasm)(t),_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=t=>(_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=wasmExports.ts_node_descendant_count_wasm)(t),_ts_node_parent_wasm=Module._ts_node_parent_wasm=t=>(_ts_node_parent_wasm=Module._ts_node_parent_wasm=wasmExports.ts_node_parent_wasm)(t),_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=t=>(_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=wasmExports.ts_node_descendant_for_index_wasm)(t),_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=t=>(_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=wasmExports.ts_node_named_descendant_for_index_wasm)(t),_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=t=>(_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=wasmExports.ts_node_descendant_for_position_wasm)(t),_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=t=>(_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=wasmExports.ts_node_named_descendant_for_position_wasm)(t),_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=t=>(_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=wasmExports.ts_node_start_point_wasm)(t),_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=t=>(_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=wasmExports.ts_node_end_point_wasm)(t),_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=t=>(_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=wasmExports.ts_node_start_index_wasm)(t),_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=t=>(_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=wasmExports.ts_node_end_index_wasm)(t),_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=t=>(_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=wasmExports.ts_node_to_string_wasm)(t),_ts_node_children_wasm=Module._ts_node_children_wasm=t=>(_ts_node_children_wasm=Module._ts_node_children_wasm=wasmExports.ts_node_children_wasm)(t),_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=t=>(_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=wasmExports.ts_node_named_children_wasm)(t),_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=(t,e,r,n,o,s,a)=>(_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=wasmExports.ts_node_descendants_of_type_wasm)(t,e,r,n,o,s,a),_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=t=>(_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=wasmExports.ts_node_is_named_wasm)(t),_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=t=>(_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=wasmExports.ts_node_has_changes_wasm)(t),_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=t=>(_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=wasmExports.ts_node_has_error_wasm)(t),_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=t=>(_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=wasmExports.ts_node_is_error_wasm)(t),_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=t=>(_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=wasmExports.ts_node_is_missing_wasm)(t),_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=t=>(_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=wasmExports.ts_node_is_extra_wasm)(t),_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=t=>(_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=wasmExports.ts_node_parse_state_wasm)(t),_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=t=>(_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=wasmExports.ts_node_next_parse_state_wasm)(t),_ts_query_matches_wasm=Module._ts_query_matches_wasm=(t,e,r,n,o,s,a,c,l,u)=>(_ts_query_matches_wasm=Module._ts_query_matches_wasm=wasmExports.ts_query_matches_wasm)(t,e,r,n,o,s,a,c,l,u),_ts_query_captures_wasm=Module._ts_query_captures_wasm=(t,e,r,n,o,s,a,c,l,u)=>(_ts_query_captures_wasm=Module._ts_query_captures_wasm=wasmExports.ts_query_captures_wasm)(t,e,r,n,o,s,a,c,l,u),_iswalpha=Module._iswalpha=t=>(_iswalpha=Module._iswalpha=wasmExports.iswalpha)(t),_iswblank=Module._iswblank=t=>(_iswblank=Module._iswblank=wasmExports.iswblank)(t),_iswdigit=Module._iswdigit=t=>(_iswdigit=Module._iswdigit=wasmExports.iswdigit)(t),_iswlower=Module._iswlower=t=>(_iswlower=Module._iswlower=wasmExports.iswlower)(t),_iswupper=Module._iswupper=t=>(_iswupper=Module._iswupper=wasmExports.iswupper)(t),_iswxdigit=Module._iswxdigit=t=>(_iswxdigit=Module._iswxdigit=wasmExports.iswxdigit)(t),_memchr=Module._memchr=(t,e,r)=>(_memchr=Module._memchr=wasmExports.memchr)(t,e,r),_strlen=Module._strlen=t=>(_strlen=Module._strlen=wasmExports.strlen)(t),_strcmp=Module._strcmp=(t,e)=>(_strcmp=Module._strcmp=wasmExports.strcmp)(t,e),_strncat=Module._strncat=(t,e,r)=>(_strncat=Module._strncat=wasmExports.strncat)(t,e,r),_strncpy=Module._strncpy=(t,e,r)=>(_strncpy=Module._strncpy=wasmExports.strncpy)(t,e,r),_towlower=Module._towlower=t=>(_towlower=Module._towlower=wasmExports.towlower)(t),_towupper=Module._towupper=t=>(_towupper=Module._towupper=wasmExports.towupper)(t),_setThrew=(t,e)=>(_setThrew=wasmExports.setThrew)(t,e),stackSave=()=>(stackSave=wasmExports.stackSave)(),stackRestore=t=>(stackRestore=wasmExports.stackRestore)(t),stackAlloc=t=>(stackAlloc=wasmExports.stackAlloc)(t),dynCall_jiji=Module.dynCall_jiji=(t,e,r,n,o)=>(dynCall_jiji=Module.dynCall_jiji=wasmExports.dynCall_jiji)(t,e,r,n,o),_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=t=>(_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=wasmExports.orig$ts_parser_timeout_micros)(t),_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=(t,e)=>(_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=wasmExports.orig$ts_parser_set_timeout_micros)(t,e),calledRun;function callMain(t=[]){var e=resolveGlobalSymbol("main").sym;if(e){t.unshift(thisProgram);var r=t.length,n=stackAlloc(4*(r+1)),o=n;t.forEach(a=>{HEAPU32[o>>2]=stringToUTF8OnStack(a),o+=4}),HEAPU32[o>>2]=0;try{var s=e(r,n);return exitJS(s,!0),s}catch(a){return handleException(a)}}}function run(t=arguments_){function e(){calledRun||(calledRun=!0,Module.calledRun=!0,ABORT||(initRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),shouldRunNow&&callMain(t),postRun()))}runDependencies>0||(preRun(),runDependencies>0||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),e()},1)):e()))}if(Module.AsciiToString=AsciiToString,Module.stringToUTF16=stringToUTF16,dependenciesFulfilled=function t(){calledRun||run(),calledRun||(dependenciesFulfilled=t)},Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),run();let C=Module,INTERNAL={},SIZE_OF_INT=4,SIZE_OF_CURSOR=4*SIZE_OF_INT,SIZE_OF_NODE=5*SIZE_OF_INT,SIZE_OF_POINT=2*SIZE_OF_INT,SIZE_OF_RANGE=2*SIZE_OF_INT+2*SIZE_OF_POINT,ZERO_POINT={row:0,column:0},QUERY_WORD_REGEX=/[\w-.]*/g,PREDICATE_STEP_TYPE_CAPTURE=1,PREDICATE_STEP_TYPE_STRING=2,LANGUAGE_FUNCTION_REGEX=/^_?tree_sitter_\w+/,VERSION,MIN_COMPATIBLE_VERSION,TRANSFER_BUFFER,currentParseCallback,currentLogCallback;class ParserImpl{static init(){TRANSFER_BUFFER=C._ts_init(),VERSION=getValue(TRANSFER_BUFFER,"i32"),MIN_COMPATIBLE_VERSION=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}initialize(){C._ts_parser_new_wasm(),this[0]=getValue(TRANSFER_BUFFER,"i32"),this[1]=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}delete(){C._ts_parser_delete(this[0]),C._free(this[1]),this[0]=0,this[1]=0}setLanguage(e){let r;if(e){if(e.constructor!==Language)throw new Error("Argument must be a Language");{r=e[0];let n=C._ts_language_version(r);if(n<MIN_COMPATIBLE_VERSION||VERSION<n)throw new Error(`Incompatible language version ${n}. Compatibility range ${MIN_COMPATIBLE_VERSION} through ${VERSION}.`)}}else r=0,e=null;return this.language=e,C._ts_parser_set_language(this[0],r),this}getLanguage(){return this.language}parse(e,r,n){if(typeof e=="string")currentParseCallback=(l,u)=>e.slice(l);else{if(typeof e!="function")throw new Error("Argument must be a string or a function");currentParseCallback=e}this.logCallback?(currentLogCallback=this.logCallback,C._ts_parser_enable_logger_wasm(this[0],1)):(currentLogCallback=null,C._ts_parser_enable_logger_wasm(this[0],0));let o=0,s=0;if(n?.includedRanges){o=n.includedRanges.length,s=C._calloc(o,SIZE_OF_RANGE);let l=s;for(let u=0;u<o;u++)marshalRange(l,n.includedRanges[u]),l+=SIZE_OF_RANGE}let a=C._ts_parser_parse_wasm(this[0],this[1],r?r[0]:0,s,o);if(!a)throw currentParseCallback=null,currentLogCallback=null,new Error("Parsing failed");let c=new Tree(INTERNAL,a,this.language,currentParseCallback);return currentParseCallback=null,currentLogCallback=null,c}reset(){C._ts_parser_reset(this[0])}getIncludedRanges(){C._ts_parser_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let o=r;for(let s=0;s<e;s++)n[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(r)}return n}getTimeoutMicros(){return C._ts_parser_timeout_micros(this[0])}setTimeoutMicros(e){C._ts_parser_set_timeout_micros(this[0],e)}setLogger(e){if(e){if(typeof e!="function")throw new Error("Logger callback must be a function")}else e=null;return this.logCallback=e,this}getLogger(){return this.logCallback}}class Tree{constructor(e,r,n,o){assertInternal(e),this[0]=r,this.language=n,this.textCallback=o}copy(){let e=C._ts_tree_copy(this[0]);return new Tree(INTERNAL,e,this.language,this.textCallback)}delete(){C._ts_tree_delete(this[0]),this[0]=0}edit(e){marshalEdit(e),C._ts_tree_edit_wasm(this[0])}get rootNode(){return C._ts_tree_root_node_wasm(this[0]),unmarshalNode(this)}rootNodeWithOffset(e,r){let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),marshalPoint(n+SIZE_OF_INT,r),C._ts_tree_root_node_with_offset_wasm(this[0]),unmarshalNode(this)}getLanguage(){return this.language}walk(){return this.rootNode.walk()}getChangedRanges(e){if(e.constructor!==Tree)throw new TypeError("Argument must be a Tree");C._ts_tree_get_changed_ranges_wasm(this[0],e[0]);let r=getValue(TRANSFER_BUFFER,"i32"),n=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(r);if(r>0){let s=n;for(let a=0;a<r;a++)o[a]=unmarshalRange(s),s+=SIZE_OF_RANGE;C._free(n)}return o}getIncludedRanges(){C._ts_tree_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let o=r;for(let s=0;s<e;s++)n[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(r)}return n}}class Node{constructor(e,r){assertInternal(e),this.tree=r}get typeId(){return marshalNode(this),C._ts_node_symbol_wasm(this.tree[0])}get grammarId(){return marshalNode(this),C._ts_node_grammar_symbol_wasm(this.tree[0])}get type(){return this.tree.language.types[this.typeId]||"ERROR"}get grammarType(){return this.tree.language.types[this.grammarId]||"ERROR"}get endPosition(){return marshalNode(this),C._ts_node_end_point_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endIndex(){return marshalNode(this),C._ts_node_end_index_wasm(this.tree[0])}get text(){return getText(this.tree,this.startIndex,this.endIndex)}get parseState(){return marshalNode(this),C._ts_node_parse_state_wasm(this.tree[0])}get nextParseState(){return marshalNode(this),C._ts_node_next_parse_state_wasm(this.tree[0])}get isNamed(){return marshalNode(this),C._ts_node_is_named_wasm(this.tree[0])===1}get hasError(){return marshalNode(this),C._ts_node_has_error_wasm(this.tree[0])===1}get hasChanges(){return marshalNode(this),C._ts_node_has_changes_wasm(this.tree[0])===1}get isError(){return marshalNode(this),C._ts_node_is_error_wasm(this.tree[0])===1}get isMissing(){return marshalNode(this),C._ts_node_is_missing_wasm(this.tree[0])===1}get isExtra(){return marshalNode(this),C._ts_node_is_extra_wasm(this.tree[0])===1}equals(e){return this.id===e.id}child(e){return marshalNode(this),C._ts_node_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}namedChild(e){return marshalNode(this),C._ts_node_named_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldId(e){return marshalNode(this),C._ts_node_child_by_field_id_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1?this.childForFieldId(r):null}fieldNameForChild(e){marshalNode(this);let r=C._ts_node_field_name_for_child_wasm(this.tree[0],e);return r?AsciiToString(r):null}childrenForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1&&r!==0?this.childrenForFieldId(r):[]}childrenForFieldId(e){marshalNode(this),C._ts_node_children_by_field_id_wasm(this.tree[0],e);let r=getValue(TRANSFER_BUFFER,"i32"),n=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(r);if(r>0){let s=n;for(let a=0;a<r;a++)o[a]=unmarshalNode(this.tree,s),s+=SIZE_OF_NODE;C._free(n)}return o}firstChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}firstNamedChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_named_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}get childCount(){return marshalNode(this),C._ts_node_child_count_wasm(this.tree[0])}get namedChildCount(){return marshalNode(this),C._ts_node_named_child_count_wasm(this.tree[0])}get firstChild(){return this.child(0)}get firstNamedChild(){return this.namedChild(0)}get lastChild(){return this.child(this.childCount-1)}get lastNamedChild(){return this.namedChild(this.namedChildCount-1)}get children(){if(!this._children){marshalNode(this),C._ts_node_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._children=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._children[o]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._children}get namedChildren(){if(!this._namedChildren){marshalNode(this),C._ts_node_named_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._namedChildren=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._namedChildren[o]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._namedChildren}descendantsOfType(e,r,n){Array.isArray(e)||(e=[e]),r||(r=ZERO_POINT),n||(n=ZERO_POINT);let o=[],s=this.tree.language.types;for(let d=0,p=s.length;d<p;d++)e.includes(s[d])&&o.push(d);let a=C._malloc(SIZE_OF_INT*o.length);for(let d=0,p=o.length;d<p;d++)setValue(a+d*SIZE_OF_INT,o[d],"i32");marshalNode(this),C._ts_node_descendants_of_type_wasm(this.tree[0],a,o.length,r.row,r.column,n.row,n.column);let c=getValue(TRANSFER_BUFFER,"i32"),l=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),u=new Array(c);if(c>0){let d=l;for(let p=0;p<c;p++)u[p]=unmarshalNode(this.tree,d),d+=SIZE_OF_NODE}return C._free(l),C._free(a),u}get nextSibling(){return marshalNode(this),C._ts_node_next_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousSibling(){return marshalNode(this),C._ts_node_prev_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get nextNamedSibling(){return marshalNode(this),C._ts_node_next_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousNamedSibling(){return marshalNode(this),C._ts_node_prev_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get descendantCount(){return marshalNode(this),C._ts_node_descendant_count_wasm(this.tree[0])}get parent(){return marshalNode(this),C._ts_node_parent_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_named_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_named_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}walk(){return marshalNode(this),C._ts_tree_cursor_new_wasm(this.tree[0]),new TreeCursor(INTERNAL,this.tree)}toString(){marshalNode(this);let e=C._ts_node_to_string_wasm(this.tree[0]),r=AsciiToString(e);return C._free(e),r}}class TreeCursor{constructor(e,r){assertInternal(e),this.tree=r,unmarshalTreeCursor(this)}delete(){marshalTreeCursor(this),C._ts_tree_cursor_delete_wasm(this.tree[0]),this[0]=this[1]=this[2]=0}reset(e){marshalNode(e),marshalTreeCursor(this,TRANSFER_BUFFER+SIZE_OF_NODE),C._ts_tree_cursor_reset_wasm(this.tree[0]),unmarshalTreeCursor(this)}resetTo(e){marshalTreeCursor(this,TRANSFER_BUFFER),marshalTreeCursor(e,TRANSFER_BUFFER+SIZE_OF_CURSOR),C._ts_tree_cursor_reset_to_wasm(this.tree[0],e.tree[0]),unmarshalTreeCursor(this)}get nodeType(){return this.tree.language.types[this.nodeTypeId]||"ERROR"}get nodeTypeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_type_id_wasm(this.tree[0])}get nodeStateId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_state_id_wasm(this.tree[0])}get nodeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_id_wasm(this.tree[0])}get nodeIsNamed(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_named_wasm(this.tree[0])===1}get nodeIsMissing(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_missing_wasm(this.tree[0])===1}get nodeText(){marshalTreeCursor(this);let e=C._ts_tree_cursor_start_index_wasm(this.tree[0]),r=C._ts_tree_cursor_end_index_wasm(this.tree[0]);return getText(this.tree,e,r)}get startPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_start_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_end_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get startIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_start_index_wasm(this.tree[0])}get endIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_end_index_wasm(this.tree[0])}get currentNode(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_wasm(this.tree[0]),unmarshalNode(this.tree)}get currentFieldId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_field_id_wasm(this.tree[0])}get currentFieldName(){return this.tree.language.fields[this.currentFieldId]}get currentDepth(){return marshalTreeCursor(this),C._ts_tree_cursor_current_depth_wasm(this.tree[0])}get currentDescendantIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_current_descendant_index_wasm(this.tree[0])}gotoFirstChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_first_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoLastChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_last_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoFirstChildForIndex(e){marshalTreeCursor(this),setValue(TRANSFER_BUFFER+SIZE_OF_CURSOR,e,"i32");let r=C._ts_tree_cursor_goto_first_child_for_index_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}gotoFirstChildForPosition(e){marshalTreeCursor(this),marshalPoint(TRANSFER_BUFFER+SIZE_OF_CURSOR,e);let r=C._ts_tree_cursor_goto_first_child_for_position_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}gotoNextSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_next_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoPreviousSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_previous_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoDescendant(e){marshalTreeCursor(this),C._ts_tree_cursor_goto_descendant_wasm(this.tree[0],e),unmarshalTreeCursor(this)}gotoParent(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_parent_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}}class Language{constructor(e,r){assertInternal(e),this[0]=r,this.types=new Array(C._ts_language_symbol_count(this[0]));for(let n=0,o=this.types.length;n<o;n++)C._ts_language_symbol_type(this[0],n)<2&&(this.types[n]=UTF8ToString(C._ts_language_symbol_name(this[0],n)));this.fields=new Array(C._ts_language_field_count(this[0])+1);for(let n=0,o=this.fields.length;n<o;n++){let s=C._ts_language_field_name_for_id(this[0],n);this.fields[n]=s!==0?UTF8ToString(s):null}}get version(){return C._ts_language_version(this[0])}get fieldCount(){return this.fields.length-1}get stateCount(){return C._ts_language_state_count(this[0])}fieldIdForName(e){let r=this.fields.indexOf(e);return r!==-1?r:null}fieldNameForId(e){return this.fields[e]||null}idForNodeType(e,r){let n=lengthBytesUTF8(e),o=C._malloc(n+1);stringToUTF8(e,o,n+1);let s=C._ts_language_symbol_for_name(this[0],o,n,r);return C._free(o),s||null}get nodeTypeCount(){return C._ts_language_symbol_count(this[0])}nodeTypeForId(e){let r=C._ts_language_symbol_name(this[0],e);return r?UTF8ToString(r):null}nodeTypeIsNamed(e){return!!C._ts_language_type_is_named_wasm(this[0],e)}nodeTypeIsVisible(e){return!!C._ts_language_type_is_visible_wasm(this[0],e)}nextState(e,r){return C._ts_language_next_state(this[0],e,r)}lookaheadIterator(e){let r=C._ts_lookahead_iterator_new(this[0],e);return r?new LookaheadIterable(INTERNAL,r,this):null}query(e){let r=lengthBytesUTF8(e),n=C._malloc(r+1);stringToUTF8(e,n,r+1);let o=C._ts_query_new(this[0],n,r,TRANSFER_BUFFER,TRANSFER_BUFFER+SIZE_OF_INT);if(!o){let g=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),v=getValue(TRANSFER_BUFFER,"i32"),b=UTF8ToString(n,v).length,_=e.substr(b,100).split(`
`)[0],x,S=_.match(QUERY_WORD_REGEX)[0];switch(g){case 2:x=new RangeError(`Bad node name '${S}'`);break;case 3:x=new RangeError(`Bad field name '${S}'`);break;case 4:x=new RangeError(`Bad capture name @${S}`);break;case 5:x=new TypeError(`Bad pattern structure at offset ${b}: '${_}'...`),S="";break;default:x=new SyntaxError(`Bad syntax at offset ${b}: '${_}'...`),S=""}throw x.index=b,x.length=S.length,C._free(n),x}let s=C._ts_query_string_count(o),a=C._ts_query_capture_count(o),c=C._ts_query_pattern_count(o),l=new Array(a),u=new Array(s);for(let g=0;g<a;g++){let v=C._ts_query_capture_name_for_id(o,g,TRANSFER_BUFFER),b=getValue(TRANSFER_BUFFER,"i32");l[g]=UTF8ToString(v,b)}for(let g=0;g<s;g++){let v=C._ts_query_string_value_for_id(o,g,TRANSFER_BUFFER),b=getValue(TRANSFER_BUFFER,"i32");u[g]=UTF8ToString(v,b)}let d=new Array(c),p=new Array(c),f=new Array(c),m=new Array(c),h=new Array(c);for(let g=0;g<c;g++){let v=C._ts_query_predicates_for_pattern(o,g,TRANSFER_BUFFER),b=getValue(TRANSFER_BUFFER,"i32");m[g]=[],h[g]=[];let _=[],x=v;for(let S=0;S<b;S++){let I=getValue(x,"i32");x+=SIZE_OF_INT;let w=getValue(x,"i32");if(x+=SIZE_OF_INT,I===PREDICATE_STEP_TYPE_CAPTURE)_.push({type:"capture",name:l[w]});else if(I===PREDICATE_STEP_TYPE_STRING)_.push({type:"string",value:u[w]});else if(_.length>0){if(_[0].type!=="string")throw new Error("Predicates must begin with a literal value");let k=_[0].value,M,H=!0,F=!0;switch(k){case"any-not-eq?":case"not-eq?":H=!1;case"any-eq?":case"eq?":if(_.length!==3)throw new Error(`Wrong number of arguments to \`#${k}\` predicate. Expected 2, got ${_.length-1}`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${k}\` predicate must be a capture. Got "${_[1].value}"`);if(F=!k.startsWith("any-"),_[2].type==="capture"){let A=_[1].name,P=_[2].name;h[g].push(B=>{let U=[],$=[];for(let W of B)W.name===A&&U.push(W.node),W.name===P&&$.push(W.node);let ce=(W,Y,Se)=>Se?W.text===Y.text:W.text!==Y.text;return F?U.every(W=>$.some(Y=>ce(W,Y,H))):U.some(W=>$.some(Y=>ce(W,Y,H)))})}else{M=_[1].name;let A=_[2].value,P=U=>U.text===A,B=U=>U.text!==A;h[g].push(U=>{let $=[];for(let W of U)W.name===M&&$.push(W.node);let ce=H?P:B;return F?$.every(ce):$.some(ce)})}break;case"any-not-match?":case"not-match?":H=!1;case"any-match?":case"match?":if(_.length!==3)throw new Error(`Wrong number of arguments to \`#${k}\` predicate. Expected 2, got ${_.length-1}.`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${k}\` predicate must be a capture. Got "${_[1].value}".`);if(_[2].type!=="string")throw new Error(`Second argument of \`#${k}\` predicate must be a string. Got @${_[2].value}.`);M=_[1].name;let ue=new RegExp(_[2].value);F=!k.startsWith("any-"),h[g].push(A=>{let P=[];for(let U of A)U.name===M&&P.push(U.node.text);let B=(U,$)=>$?ue.test(U):!ue.test(U);return P.length===0?!H:F?P.every(U=>B(U,H)):P.some(U=>B(U,H))});break;case"set!":if(_.length<2||_.length>3)throw new Error(`Wrong number of arguments to \`#set!\` predicate. Expected 1 or 2. Got ${_.length-1}.`);if(_.some(A=>A.type!=="string"))throw new Error('Arguments to `#set!` predicate must be a strings.".');d[g]||(d[g]={}),d[g][_[1].value]=_[2]?_[2].value:null;break;case"is?":case"is-not?":if(_.length<2||_.length>3)throw new Error(`Wrong number of arguments to \`#${k}\` predicate. Expected 1 or 2. Got ${_.length-1}.`);if(_.some(A=>A.type!=="string"))throw new Error(`Arguments to \`#${k}\` predicate must be a strings.".`);let Z=k==="is?"?p:f;Z[g]||(Z[g]={}),Z[g][_[1].value]=_[2]?_[2].value:null;break;case"not-any-of?":H=!1;case"any-of?":if(_.length<2)throw new Error(`Wrong number of arguments to \`#${k}\` predicate. Expected at least 1. Got ${_.length-1}.`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${k}\` predicate must be a capture. Got "${_[1].value}".`);for(let A=2;A<_.length;A++)if(_[A].type!=="string")throw new Error(`Arguments to \`#${k}\` predicate must be a strings.".`);M=_[1].name;let V=_.slice(2).map(A=>A.value);h[g].push(A=>{let P=[];for(let B of A)B.name===M&&P.push(B.node.text);return P.length===0?!H:P.every(B=>V.includes(B))===H});break;default:m[g].push({operator:k,operands:_.slice(1)})}_.length=0}}Object.freeze(d[g]),Object.freeze(p[g]),Object.freeze(f[g])}return C._free(n),new Query(INTERNAL,o,l,h,m,Object.freeze(d),Object.freeze(p),Object.freeze(f))}static load(e){let r;if(e instanceof Uint8Array)r=Promise.resolve(e);else{let n=e;if(typeof process<"u"&&process.versions&&process.versions.node){let o=require("fs");r=Promise.resolve(o.readFileSync(n))}else r=fetch(n).then(o=>o.arrayBuffer().then(s=>{if(o.ok)return new Uint8Array(s);{let a=new TextDecoder("utf-8").decode(s);throw new Error(`Language.load failed with status ${o.status}.

${a}`)}}))}return r.then(n=>loadWebAssemblyModule(n,{loadAsync:!0})).then(n=>{let o=Object.keys(n),s=o.find(c=>LANGUAGE_FUNCTION_REGEX.test(c)&&!c.includes("external_scanner_"));s||console.log(`Couldn't find language function in WASM file. Symbols:
${JSON.stringify(o,null,2)}`);let a=n[s]();return new Language(INTERNAL,a)})}}class LookaheadIterable{constructor(e,r,n){assertInternal(e),this[0]=r,this.language=n}get currentTypeId(){return C._ts_lookahead_iterator_current_symbol(this[0])}get currentType(){return this.language.types[this.currentTypeId]||"ERROR"}delete(){C._ts_lookahead_iterator_delete(this[0]),this[0]=0}resetState(e){return C._ts_lookahead_iterator_reset_state(this[0],e)}reset(e,r){return!!C._ts_lookahead_iterator_reset(this[0],e[0],r)&&(this.language=e,!0)}[Symbol.iterator](){let e=this;return{next:()=>C._ts_lookahead_iterator_next(e[0])?{done:!1,value:e.currentType}:{done:!0,value:""}}}}class Query{constructor(e,r,n,o,s,a,c,l){assertInternal(e),this[0]=r,this.captureNames=n,this.textPredicates=o,this.predicates=s,this.setProperties=a,this.assertedProperties=c,this.refutedProperties=l,this.exceededMatchLimit=!1}delete(){C._ts_query_delete(this[0]),this[0]=0}matches(e,{startPosition:r=ZERO_POINT,endPosition:n=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_matches_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o,s,a,c);let l=getValue(TRANSFER_BUFFER,"i32"),u=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=new Array(l);this.exceededMatchLimit=!!d;let f=0,m=u;for(let h=0;h<l;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let v=getValue(m,"i32");m+=SIZE_OF_INT;let b=new Array(v);if(m=unmarshalCaptures(this,e.tree,m,b),this.textPredicates[g].every(_=>_(b))){p[f]={pattern:g,captures:b};let _=this.setProperties[g];_&&(p[f].setProperties=_);let x=this.assertedProperties[g];x&&(p[f].assertedProperties=x);let S=this.refutedProperties[g];S&&(p[f].refutedProperties=S),f++}}return p.length=f,C._free(u),p}captures(e,{startPosition:r=ZERO_POINT,endPosition:n=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_captures_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o,s,a,c);let l=getValue(TRANSFER_BUFFER,"i32"),u=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=[];this.exceededMatchLimit=!!d;let f=[],m=u;for(let h=0;h<l;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let v=getValue(m,"i32");m+=SIZE_OF_INT;let b=getValue(m,"i32");if(m+=SIZE_OF_INT,f.length=v,m=unmarshalCaptures(this,e.tree,m,f),this.textPredicates[g].every(_=>_(f))){let _=f[b],x=this.setProperties[g];x&&(_.setProperties=x);let S=this.assertedProperties[g];S&&(_.assertedProperties=S);let I=this.refutedProperties[g];I&&(_.refutedProperties=I),p.push(_)}}return C._free(u),p}predicatesForPattern(e){return this.predicates[e]}disableCapture(e){let r=lengthBytesUTF8(e),n=C._malloc(r+1);stringToUTF8(e,n,r+1),C._ts_query_disable_capture(this[0],n,r),C._free(n)}didExceedMatchLimit(){return this.exceededMatchLimit}}function getText(t,e,r){let n=r-e,o=t.textCallback(e,null,r);for(e+=o.length;e<r;){let s=t.textCallback(e,null,r);if(!(s&&s.length>0))break;e+=s.length,o+=s}return e>r&&(o=o.slice(0,n)),o}function unmarshalCaptures(t,e,r,n){for(let o=0,s=n.length;o<s;o++){let a=getValue(r,"i32"),c=unmarshalNode(e,r+=SIZE_OF_INT);r+=SIZE_OF_NODE,n[o]={name:t.captureNames[a],node:c}}return r}function assertInternal(t){if(t!==INTERNAL)throw new Error("Illegal constructor")}function isPoint(t){return t&&typeof t.row=="number"&&typeof t.column=="number"}function marshalNode(t){let e=TRANSFER_BUFFER;setValue(e,t.id,"i32"),e+=SIZE_OF_INT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.row,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.column,"i32"),e+=SIZE_OF_INT,setValue(e,t[0],"i32")}function unmarshalNode(t,e=TRANSFER_BUFFER){let r=getValue(e,"i32");if(r===0)return null;let n=getValue(e+=SIZE_OF_INT,"i32"),o=getValue(e+=SIZE_OF_INT,"i32"),s=getValue(e+=SIZE_OF_INT,"i32"),a=getValue(e+=SIZE_OF_INT,"i32"),c=new Node(INTERNAL,t);return c.id=r,c.startIndex=n,c.startPosition={row:o,column:s},c[0]=a,c}function marshalTreeCursor(t,e=TRANSFER_BUFFER){setValue(e+0*SIZE_OF_INT,t[0],"i32"),setValue(e+1*SIZE_OF_INT,t[1],"i32"),setValue(e+2*SIZE_OF_INT,t[2],"i32"),setValue(e+3*SIZE_OF_INT,t[3],"i32")}function unmarshalTreeCursor(t){t[0]=getValue(TRANSFER_BUFFER+0*SIZE_OF_INT,"i32"),t[1]=getValue(TRANSFER_BUFFER+1*SIZE_OF_INT,"i32"),t[2]=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),t[3]=getValue(TRANSFER_BUFFER+3*SIZE_OF_INT,"i32")}function marshalPoint(t,e){setValue(t,e.row,"i32"),setValue(t+SIZE_OF_INT,e.column,"i32")}function unmarshalPoint(t){return{row:getValue(t,"i32")>>>0,column:getValue(t+SIZE_OF_INT,"i32")>>>0}}function marshalRange(t,e){marshalPoint(t,e.startPosition),marshalPoint(t+=SIZE_OF_POINT,e.endPosition),setValue(t+=SIZE_OF_POINT,e.startIndex,"i32"),setValue(t+=SIZE_OF_INT,e.endIndex,"i32"),t+=SIZE_OF_INT}function unmarshalRange(t){let e={};return e.startPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.endPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.startIndex=getValue(t,"i32")>>>0,t+=SIZE_OF_INT,e.endIndex=getValue(t,"i32")>>>0,e}function marshalEdit(t){let e=TRANSFER_BUFFER;marshalPoint(e,t.startPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.oldEndPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.newEndPosition),e+=SIZE_OF_POINT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.oldEndIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.newEndIndex,"i32"),e+=SIZE_OF_INT}for(let t of Object.getOwnPropertyNames(ParserImpl.prototype))Object.defineProperty(Parser.prototype,t,{value:ParserImpl.prototype[t],enumerable:!1,writable:!1});Parser.Language=Language,Module.onRuntimeInitialized=()=>{ParserImpl.init(),resolveInitPromise()}}))}}return Parser}();typeof exports=="object"&&(module.exports=TreeSitter)});var Ure=R(Pr=>{"use strict";var Mre=Pr&&Pr.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},Fre=Pr&&Pr.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.getShallowFileSize=Pr.getShallowDirectorySizeSync=Pr.getShallowDirectorySize=Pr.confirmDirExists=Pr.unlinkAsync=Pr.readdirAsync=Pr.readFileAsync=Pr.writeFileAsync=Pr.appendFileAsync=Pr.accessAsync=Pr.mkdirAsync=Pr.lstatAsync=Pr.statAsync=void 0;var Ud=require("fs"),Mke=require("path"),Lh=require("util");Pr.statAsync=Lh.promisify(Ud.stat);Pr.lstatAsync=Lh.promisify(Ud.lstat);Pr.mkdirAsync=Lh.promisify(Ud.mkdir);Pr.accessAsync=Lh.promisify(Ud.access);Pr.appendFileAsync=Lh.promisify(Ud.appendFile);Pr.writeFileAsync=Lh.promisify(Ud.writeFile);Pr.readFileAsync=Lh.promisify(Ud.readFile);Pr.readdirAsync=Lh.promisify(Ud.readdir);Pr.unlinkAsync=Lh.promisify(Ud.unlink);var Uut=function(t){return Mre(void 0,void 0,void 0,function(){var e,r,n;return Fre(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,7]),[4,Pr.lstatAsync(t)];case 1:if(e=o.sent(),!e.isDirectory())throw new Error("Path existed but was not a directory");return[3,7];case 2:if(r=o.sent(),!(r&&r.code==="ENOENT"))return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,Pr.mkdirAsync(t)];case 4:return o.sent(),[3,6];case 5:if(n=o.sent(),n&&n.code!=="EEXIST")throw n;return[3,6];case 6:return[3,7];case 7:return[2]}})})};Pr.confirmDirExists=Uut;var But=function(t){return Mre(void 0,void 0,void 0,function(){var e,r,n,o,s,a;return Fre(this,function(c){switch(c.label){case 0:return[4,Pr.readdirAsync(t)];case 1:e=c.sent(),r=0,n=0,o=e,c.label=2;case 2:return n<o.length?(s=o[n],[4,Pr.statAsync(Mke.join(t,s))]):[3,5];case 3:a=c.sent(),a.isFile()&&(r+=a.size),c.label=4;case 4:return n++,[3,2];case 5:return[2,r]}})})};Pr.getShallowDirectorySize=But;var qut=function(t){for(var e=Ud.readdirSync(t),r=0,n=0;n<e.length;n++)r+=Ud.statSync(Mke.join(t,e[n])).size;return r};Pr.getShallowDirectorySizeSync=qut;var jut=function(t){return Mre(void 0,void 0,void 0,function(){var e;return Fre(this,function(r){switch(r.label){case 0:return[4,Pr.statAsync(t)];case 1:return e=r.sent(),e.isFile()?[2,e.size]:[2]}})})};Pr.getShallowFileSize=jut});var Bke=R((Yx,Uke)=>{"use strict";var Bre=Yx&&Yx.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},qre=Yx&&Yx.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Fke=Yx&&Yx.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)n[o]=s[a];return n},Vut=require("fs"),Hut=require("os"),Kx=require("path"),Ef=Ure(),Gut=function(){function t(){var e=this;this.TAG="Logger",this._cleanupTimeOut=60*30*1e3,this._tempDir="",this._logFileName="",this._fileFullPath="",this._backUpNameFormat="",this._logToFile=!1,this._logToConsole=!0;var r=process.env.APPLICATIONINSIGHTS_LOG_DESTINATION;r=="file+console"&&(this._logToFile=!0),r=="file"&&(this._logToFile=!0,this._logToConsole=!1),this.maxSizeBytes=5e4,this.maxHistory=1,this._logFileName="applicationinsights.log";var n=process.env.APPLICATIONINSIGHTS_LOGDIR;n?Kx.isAbsolute(n)?this._tempDir=n:this._tempDir=Kx.join(process.cwd(),n):this._tempDir=Kx.join(Hut.tmpdir(),"appInsights-node"),this._fileFullPath=Kx.join(this._tempDir,this._logFileName),this._backUpNameFormat="."+this._logFileName,this._logToFile&&(t._fileCleanupTimer||(t._fileCleanupTimer=setInterval(function(){e._fileCleanupTask()},this._cleanupTimeOut),t._fileCleanupTimer.unref()))}return t.prototype.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e?Fke([e],r):r;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.info.apply(console,o)},t.prototype.warning=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e?Fke([e],r):r;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.warn.apply(console,o)},t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype._storeToDisk=function(e){return Bre(this,void 0,void 0,function(){var r,n,o,s,a,c;return qre(this,function(l){switch(l.label){case 0:r=e+`\r
`,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Ef.confirmDirExists(this._tempDir)];case 2:return l.sent(),[3,4];case 3:return n=l.sent(),console.log(this.TAG,"Failed to create directory for log file: "+(n&&n.message)),[2];case 4:return l.trys.push([4,6,,11]),[4,Ef.accessAsync(this._fileFullPath,Vut.constants.F_OK)];case 5:return l.sent(),[3,11];case 6:o=l.sent(),l.label=7;case 7:return l.trys.push([7,9,,10]),[4,Ef.appendFileAsync(this._fileFullPath,r)];case 8:return l.sent(),[2];case 9:return s=l.sent(),console.log(this.TAG,"Failed to put log into file: "+(o&&o.message)),[2];case 10:return[3,11];case 11:return l.trys.push([11,17,,18]),[4,Ef.getShallowFileSize(this._fileFullPath)];case 12:return a=l.sent(),a>this.maxSizeBytes?[4,this._createBackupFile(r)]:[3,14];case 13:return l.sent(),[3,16];case 14:return[4,Ef.appendFileAsync(this._fileFullPath,r)];case 15:l.sent(),l.label=16;case 16:return[3,18];case 17:return c=l.sent(),console.log(this.TAG,"Failed to create backup file: "+(c&&c.message)),[3,18];case 18:return[2]}})})},t.prototype._createBackupFile=function(e){return Bre(this,void 0,void 0,function(){var r,n,o;return qre(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,4,5]),[4,Ef.readFileAsync(this._fileFullPath)];case 1:return r=s.sent(),n=Kx.join(this._tempDir,new Date().getTime()+"."+this._logFileName),[4,Ef.writeFileAsync(n,r)];case 2:return s.sent(),[3,5];case 3:return o=s.sent(),console.log("Failed to generate backup log file",o),[3,5];case 4:return Ef.writeFileAsync(this._fileFullPath,e),[7];case 5:return[2]}})})},t.prototype._fileCleanupTask=function(){return Bre(this,void 0,void 0,function(){var e,r,n,o,s,a=this;return qre(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,Ef.readdirAsync(this._tempDir)];case 1:e=c.sent(),e=e.filter(function(l){return Kx.basename(l).indexOf(a._backUpNameFormat)>-1}),e.sort(function(l,u){var d=new Date(parseInt(l.split(a._backUpNameFormat)[0])),p=new Date(parseInt(u.split(a._backUpNameFormat)[0]));if(d<p)return-1;if(d>=p)return 1}),r=e.length,n=0,c.label=2;case 2:return n<r-this.maxHistory?(o=Kx.join(this._tempDir,e[n]),[4,Ef.unlinkAsync(o)]):[3,5];case 3:c.sent(),c.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:return s=c.sent(),console.log(this.TAG,"Failed to cleanup log files: "+(s&&s.message)),[3,7];case 7:return[2]}})})},t._fileCleanupTimer=null,t}();Uke.exports=Gut});var ri=R((lVr,jke)=>{"use strict";var qke=Bke(),zut="APPLICATION_INSIGHTS_ENABLE_DEBUG_LOGS",$ut="APPLICATION_INSIGHTS_DISABLE_WARNING_LOGS",Wut=function(){function t(){}return t.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enableDebug&&qke.getInstance().info(this.TAG+e,r)},t.warn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.disableWarnings||qke.getInstance().warning(this.TAG+e,r)},t.enableDebug=!!process.env[zut],t.disableWarnings=!!process.env[$ut],t.TAG="ApplicationInsights:",t}();jke.exports=Wut});var qB=R(BB=>{"use strict";Object.defineProperty(BB,"__esModule",{value:!0});BB.JsonConfig=void 0;var Kut=require("fs"),UB=require("path"),jre=ri(),Yut="APPLICATIONINSIGHTS_CONFIGURATION_FILE",Qut="APPLICATIONINSIGHTS_CONNECTION_STRING",Vke="APPSETTING_",Hke="APPINSIGHTS_INSTRUMENTATIONKEY",Gke="APPINSIGHTS_INSTRUMENTATION_KEY",Xut="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",Jut="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",Zut="http_proxy",edt="https_proxy",tdt="APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL",rdt="APPLICATION_INSIGHTS_NO_STATSBEAT",ndt="APPLICATION_INSIGHTS_NO_HTTP_AGENT_KEEP_ALIVE",idt="APPLICATION_INSIGHTS_NO_PATCH_MODULES",odt="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_ENABLED",sdt="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_CONNECTION_STRING",adt="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_SOURCE",cdt="APPLICATIONINSIGHTS_WEB_SNIPPET_ENABLED",ldt="APPLICATIONINSIGHTS_WEB_SNIPPET_CONNECTION_STRING",udt=function(){function t(){this.connectionString=process.env[Qut],this.instrumentationKey=process.env[Hke]||process.env[Vke+Hke]||process.env[Gke]||process.env[Vke+Gke],!this.connectionString&&this.instrumentationKey&&jre.warn("APPINSIGHTS_INSTRUMENTATIONKEY is in path of deprecation, please use APPLICATIONINSIGHTS_CONNECTION_STRING env variable to setup the SDK."),this.disableAllExtendedMetrics=!!process.env[Jut],this.extendedMetricDisablers=process.env[Xut],this.proxyHttpUrl=process.env[Zut],this.proxyHttpsUrl=process.env[edt],this.noDiagnosticChannel=!!process.env[tdt],this.disableStatsbeat=!!process.env[rdt],this.noHttpAgentKeepAlive=!!process.env[ndt],this.noPatchModules=process.env[idt]||"",this.enableWebInstrumentation=!!process.env[odt]||!!process.env[cdt],this.webInstrumentationSrc=process.env[adt]||"",this.webInstrumentationConnectionString=process.env[sdt]||process.env[ldt]||"",this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.webSnippetConnectionString=this.webInstrumentationConnectionString,this._loadJsonFile()}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype._loadJsonFile=function(){var e="",r="{}";if(r)e=r;else{var n="applicationinsights.json",o=UB.join(__dirname,"../../"),s=UB.join(o,n),a=process.env[Yut];a&&(UB.isAbsolute(a)?s=a:s=UB.join(o,a));try{e=Kut.readFileSync(s,"utf8")}catch(l){jre.warn("Failed to read JSON config file: ",l)}}try{var c=JSON.parse(e);c.disableStatsbeat!=null&&(this.disableStatsbeat=c.disableStatsbeat),c.disableAllExtendedMetrics!=null&&(this.disableAllExtendedMetrics=c.disableStatsbeat),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.noHttpAgentKeepAlive!=null&&(this.noHttpAgentKeepAlive=c.noHttpAgentKeepAlive),c.connectionString!=null&&(this.connectionString=c.connectionString),c.extendedMetricDisablers!=null&&(this.extendedMetricDisablers=c.extendedMetricDisablers),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.proxyHttpUrl!=null&&(this.proxyHttpUrl=c.proxyHttpUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.noPatchModules!=null&&(this.noPatchModules=c.noPatchModules),c.enableAutoWebSnippetInjection!=null&&(this.enableWebInstrumentation=c.enableAutoWebSnippetInjection,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.enableWebInstrumentation!=null&&(this.enableWebInstrumentation=c.enableWebInstrumentation,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.webSnippetConnectionString!=null&&(this.webInstrumentationConnectionString=c.webSnippetConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConnectionString!=null&&(this.webInstrumentationConnectionString=c.webInstrumentationConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConfig!=null&&(this.webInstrumentationConfig=c.webInstrumentationConfig),c.webInstrumentationSrc!=null&&(this.webInstrumentationSrc=c.webInstrumentationSrc),c.enableLoggerErrorToTrace!=null&&(this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace),this.endpointUrl=c.endpointUrl,this.maxBatchSize=c.maxBatchSize,this.maxBatchIntervalMs=c.maxBatchIntervalMs,this.disableAppInsights=c.disableAppInsights,this.samplingPercentage=c.samplingPercentage,this.correlationIdRetryIntervalMs=c.correlationIdRetryIntervalMs,this.correlationHeaderExcludedDomains=c.correlationHeaderExcludedDomains,this.ignoreLegacyHeaders=c.ignoreLegacyHeaders,this.distributedTracingMode=c.distributedTracingMode,this.enableAutoCollectExternalLoggers=c.enableAutoCollectExternalLoggers,this.enableAutoCollectConsole=c.enableAutoCollectConsole,this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace,this.enableAutoCollectExceptions=c.enableAutoCollectExceptions,this.enableAutoCollectPerformance=c.enableAutoCollectPerformance,this.enableAutoCollectExtendedMetrics=c.enableAutoCollectExtendedMetrics,this.enableAutoCollectPreAggregatedMetrics=c.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectHeartbeat=c.enableAutoCollectHeartbeat,this.enableAutoCollectRequests=c.enableAutoCollectRequests,this.enableAutoCollectDependencies=c.enableAutoCollectDependencies,this.enableAutoDependencyCorrelation=c.enableAutoDependencyCorrelation,this.enableAutoCollectIncomingRequestAzureFunctions=c.enableAutoCollectIncomingRequestAzureFunctions,this.enableUseAsyncHooks=c.enableUseAsyncHooks,this.enableUseDiskRetryCaching=c.enableUseDiskRetryCaching,this.enableResendInterval=c.enableResendInterval,this.enableMaxBytesOnDisk=c.enableMaxBytesOnDisk,this.enableInternalDebugLogging=c.enableInternalDebugLogging,this.enableInternalWarningLogging=c.enableInternalWarningLogging,this.enableSendLiveMetrics=c.enableSendLiveMetrics,this.quickPulseHost=c.quickPulseHost}catch(l){jre.warn("Invalid JSON config file: ",l)}},t}();BB.JsonConfig=udt});var iO=R((dVr,zke)=>{var ddt="2.0.0",pdt=Number.MAX_SAFE_INTEGER||9007199254740991,fdt=16,mdt=250,hdt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];zke.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:fdt,MAX_SAFE_BUILD_LENGTH:mdt,MAX_SAFE_INTEGER:pdt,RELEASE_TYPES:hdt,SEMVER_SPEC_VERSION:ddt,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var oO=R((pVr,$ke)=>{var gdt=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};$ke.exports=gdt});var bk=R((Oh,Wke)=>{var{MAX_SAFE_COMPONENT_LENGTH:Vre,MAX_SAFE_BUILD_LENGTH:vdt,MAX_LENGTH:ydt}=iO(),bdt=oO();Oh=Wke.exports={};var _dt=Oh.re=[],xdt=Oh.safeRe=[],pt=Oh.src=[],ft=Oh.t={},Sdt=0,Hre="[a-zA-Z0-9-]",Idt=[["\\s",1],["\\d",ydt],[Hre,vdt]],Cdt=t=>{for(let[e,r]of Idt)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},rr=(t,e,r)=>{let n=Cdt(e),o=Sdt++;bdt(t,o,e),ft[t]=o,pt[o]=e,_dt[o]=new RegExp(e,r?"g":void 0),xdt[o]=new RegExp(n,r?"g":void 0)};rr("NUMERICIDENTIFIER","0|[1-9]\\d*");rr("NUMERICIDENTIFIERLOOSE","\\d+");rr("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Hre}*`);rr("MAINVERSION",`(${pt[ft.NUMERICIDENTIFIER]})\\.(${pt[ft.NUMERICIDENTIFIER]})\\.(${pt[ft.NUMERICIDENTIFIER]})`);rr("MAINVERSIONLOOSE",`(${pt[ft.NUMERICIDENTIFIERLOOSE]})\\.(${pt[ft.NUMERICIDENTIFIERLOOSE]})\\.(${pt[ft.NUMERICIDENTIFIERLOOSE]})`);rr("PRERELEASEIDENTIFIER",`(?:${pt[ft.NUMERICIDENTIFIER]}|${pt[ft.NONNUMERICIDENTIFIER]})`);rr("PRERELEASEIDENTIFIERLOOSE",`(?:${pt[ft.NUMERICIDENTIFIERLOOSE]}|${pt[ft.NONNUMERICIDENTIFIER]})`);rr("PRERELEASE",`(?:-(${pt[ft.PRERELEASEIDENTIFIER]}(?:\\.${pt[ft.PRERELEASEIDENTIFIER]})*))`);rr("PRERELEASELOOSE",`(?:-?(${pt[ft.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${pt[ft.PRERELEASEIDENTIFIERLOOSE]})*))`);rr("BUILDIDENTIFIER",`${Hre}+`);rr("BUILD",`(?:\\+(${pt[ft.BUILDIDENTIFIER]}(?:\\.${pt[ft.BUILDIDENTIFIER]})*))`);rr("FULLPLAIN",`v?${pt[ft.MAINVERSION]}${pt[ft.PRERELEASE]}?${pt[ft.BUILD]}?`);rr("FULL",`^${pt[ft.FULLPLAIN]}$`);rr("LOOSEPLAIN",`[v=\\s]*${pt[ft.MAINVERSIONLOOSE]}${pt[ft.PRERELEASELOOSE]}?${pt[ft.BUILD]}?`);rr("LOOSE",`^${pt[ft.LOOSEPLAIN]}$`);rr("GTLT","((?:<|>)?=?)");rr("XRANGEIDENTIFIERLOOSE",`${pt[ft.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);rr("XRANGEIDENTIFIER",`${pt[ft.NUMERICIDENTIFIER]}|x|X|\\*`);rr("XRANGEPLAIN",`[v=\\s]*(${pt[ft.XRANGEIDENTIFIER]})(?:\\.(${pt[ft.XRANGEIDENTIFIER]})(?:\\.(${pt[ft.XRANGEIDENTIFIER]})(?:${pt[ft.PRERELEASE]})?${pt[ft.BUILD]}?)?)?`);rr("XRANGEPLAINLOOSE",`[v=\\s]*(${pt[ft.XRANGEIDENTIFIERLOOSE]})(?:\\.(${pt[ft.XRANGEIDENTIFIERLOOSE]})(?:\\.(${pt[ft.XRANGEIDENTIFIERLOOSE]})(?:${pt[ft.PRERELEASELOOSE]})?${pt[ft.BUILD]}?)?)?`);rr("XRANGE",`^${pt[ft.GTLT]}\\s*${pt[ft.XRANGEPLAIN]}$`);rr("XRANGELOOSE",`^${pt[ft.GTLT]}\\s*${pt[ft.XRANGEPLAINLOOSE]}$`);rr("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Vre}})(?:\\.(\\d{1,${Vre}}))?(?:\\.(\\d{1,${Vre}}))?`);rr("COERCE",`${pt[ft.COERCEPLAIN]}(?:$|[^\\d])`);rr("COERCEFULL",pt[ft.COERCEPLAIN]+`(?:${pt[ft.PRERELEASE]})?(?:${pt[ft.BUILD]})?(?:$|[^\\d])`);rr("COERCERTL",pt[ft.COERCE],!0);rr("COERCERTLFULL",pt[ft.COERCEFULL],!0);rr("LONETILDE","(?:~>?)");rr("TILDETRIM",`(\\s*)${pt[ft.LONETILDE]}\\s+`,!0);Oh.tildeTrimReplace="$1~";rr("TILDE",`^${pt[ft.LONETILDE]}${pt[ft.XRANGEPLAIN]}$`);rr("TILDELOOSE",`^${pt[ft.LONETILDE]}${pt[ft.XRANGEPLAINLOOSE]}$`);rr("LONECARET","(?:\\^)");rr("CARETTRIM",`(\\s*)${pt[ft.LONECARET]}\\s+`,!0);Oh.caretTrimReplace="$1^";rr("CARET",`^${pt[ft.LONECARET]}${pt[ft.XRANGEPLAIN]}$`);rr("CARETLOOSE",`^${pt[ft.LONECARET]}${pt[ft.XRANGEPLAINLOOSE]}$`);rr("COMPARATORLOOSE",`^${pt[ft.GTLT]}\\s*(${pt[ft.LOOSEPLAIN]})$|^$`);rr("COMPARATOR",`^${pt[ft.GTLT]}\\s*(${pt[ft.FULLPLAIN]})$|^$`);rr("COMPARATORTRIM",`(\\s*)${pt[ft.GTLT]}\\s*(${pt[ft.LOOSEPLAIN]}|${pt[ft.XRANGEPLAIN]})`,!0);Oh.comparatorTrimReplace="$1$2$3";rr("HYPHENRANGE",`^\\s*(${pt[ft.XRANGEPLAIN]})\\s+-\\s+(${pt[ft.XRANGEPLAIN]})\\s*$`);rr("HYPHENRANGELOOSE",`^\\s*(${pt[ft.XRANGEPLAINLOOSE]})\\s+-\\s+(${pt[ft.XRANGEPLAINLOOSE]})\\s*$`);rr("STAR","(<|>)?=?\\s*\\*");rr("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");rr("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var jB=R((fVr,Kke)=>{var Tdt=Object.freeze({loose:!0}),Edt=Object.freeze({}),wdt=t=>t?typeof t!="object"?Tdt:t:Edt;Kke.exports=wdt});var Gre=R((mVr,Xke)=>{var Yke=/^[0-9]+$/,Qke=(t,e)=>{let r=Yke.test(t),n=Yke.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},kdt=(t,e)=>Qke(e,t);Xke.exports={compareIdentifiers:Qke,rcompareIdentifiers:kdt}});var da=R((hVr,tRe)=>{var VB=oO(),{MAX_LENGTH:Jke,MAX_SAFE_INTEGER:HB}=iO(),{safeRe:Zke,t:eRe}=bk(),Rdt=jB(),{compareIdentifiers:_k}=Gre(),zre=class t{constructor(e,r){if(r=Rdt(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Jke)throw new TypeError(`version is longer than ${Jke} characters`);VB("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?Zke[eRe.LOOSE]:Zke[eRe.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>HB||this.major<0)throw new TypeError("Invalid major version");if(this.minor>HB||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>HB||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let s=+o;if(s>=0&&s<HB)return s}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(VB("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),_k(this.major,e.major)||_k(this.minor,e.minor)||_k(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],o=e.prerelease[r];if(VB("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return _k(n,o)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],o=e.build[r];if(VB("build compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return _k(n,o)}while(++r)}inc(e,r,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(r){let s=[r,o];n===!1&&(s=[r]),_k(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};tRe.exports=zre});var Qx=R((gVr,nRe)=>{var rRe=da(),Pdt=(t,e,r=!1)=>{if(t instanceof rRe)return t;try{return new rRe(t,e)}catch(n){if(!r)return null;throw n}};nRe.exports=Pdt});var oRe=R((vVr,iRe)=>{var Adt=Qx(),Ddt=(t,e)=>{let r=Adt(t,e);return r?r.version:null};iRe.exports=Ddt});var aRe=R((yVr,sRe)=>{var Ndt=Qx(),Ldt=(t,e)=>{let r=Ndt(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};sRe.exports=Ldt});var uRe=R((bVr,lRe)=>{var cRe=da(),Odt=(t,e,r,n,o)=>{typeof r=="string"&&(o=n,n=r,r=void 0);try{return new cRe(t instanceof cRe?t.version:t,r).inc(e,n,o).version}catch{return null}};lRe.exports=Odt});var fRe=R((_Vr,pRe)=>{var dRe=Qx(),Mdt=(t,e)=>{let r=dRe(t,null,!0),n=dRe(e,null,!0),o=r.compare(n);if(o===0)return null;let s=o>0,a=s?r:n,c=s?n:r,l=!!a.prerelease.length;if(!!c.prerelease.length&&!l)return!c.patch&&!c.minor?"major":a.patch?"patch":a.minor?"minor":"major";let d=l?"pre":"";return r.major!==n.major?d+"major":r.minor!==n.minor?d+"minor":r.patch!==n.patch?d+"patch":"prerelease"};pRe.exports=Mdt});var hRe=R((xVr,mRe)=>{var Fdt=da(),Udt=(t,e)=>new Fdt(t,e).major;mRe.exports=Udt});var vRe=R((SVr,gRe)=>{var Bdt=da(),qdt=(t,e)=>new Bdt(t,e).minor;gRe.exports=qdt});var bRe=R((IVr,yRe)=>{var jdt=da(),Vdt=(t,e)=>new jdt(t,e).patch;yRe.exports=Vdt});var xRe=R((CVr,_Re)=>{var Hdt=Qx(),Gdt=(t,e)=>{let r=Hdt(t,e);return r&&r.prerelease.length?r.prerelease:null};_Re.exports=Gdt});var bu=R((TVr,IRe)=>{var SRe=da(),zdt=(t,e,r)=>new SRe(t,r).compare(new SRe(e,r));IRe.exports=zdt});var TRe=R((EVr,CRe)=>{var $dt=bu(),Wdt=(t,e,r)=>$dt(e,t,r);CRe.exports=Wdt});var wRe=R((wVr,ERe)=>{var Kdt=bu(),Ydt=(t,e)=>Kdt(t,e,!0);ERe.exports=Ydt});var GB=R((kVr,RRe)=>{var kRe=da(),Qdt=(t,e,r)=>{let n=new kRe(t,r),o=new kRe(e,r);return n.compare(o)||n.compareBuild(o)};RRe.exports=Qdt});var ARe=R((RVr,PRe)=>{var Xdt=GB(),Jdt=(t,e)=>t.sort((r,n)=>Xdt(r,n,e));PRe.exports=Jdt});var NRe=R((PVr,DRe)=>{var Zdt=GB(),ept=(t,e)=>t.sort((r,n)=>Zdt(n,r,e));DRe.exports=ept});var sO=R((AVr,LRe)=>{var tpt=bu(),rpt=(t,e,r)=>tpt(t,e,r)>0;LRe.exports=rpt});var zB=R((DVr,ORe)=>{var npt=bu(),ipt=(t,e,r)=>npt(t,e,r)<0;ORe.exports=ipt});var $re=R((NVr,MRe)=>{var opt=bu(),spt=(t,e,r)=>opt(t,e,r)===0;MRe.exports=spt});var Wre=R((LVr,FRe)=>{var apt=bu(),cpt=(t,e,r)=>apt(t,e,r)!==0;FRe.exports=cpt});var $B=R((OVr,URe)=>{var lpt=bu(),upt=(t,e,r)=>lpt(t,e,r)>=0;URe.exports=upt});var WB=R((MVr,BRe)=>{var dpt=bu(),ppt=(t,e,r)=>dpt(t,e,r)<=0;BRe.exports=ppt});var Kre=R((FVr,qRe)=>{var fpt=$re(),mpt=Wre(),hpt=sO(),gpt=$B(),vpt=zB(),ypt=WB(),bpt=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return fpt(t,r,n);case"!=":return mpt(t,r,n);case">":return hpt(t,r,n);case">=":return gpt(t,r,n);case"<":return vpt(t,r,n);case"<=":return ypt(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};qRe.exports=bpt});var VRe=R((UVr,jRe)=>{var _pt=da(),xpt=Qx(),{safeRe:KB,t:YB}=bk(),Spt=(t,e)=>{if(t instanceof _pt)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?KB[YB.COERCEFULL]:KB[YB.COERCE]);else{let l=e.includePrerelease?KB[YB.COERCERTLFULL]:KB[YB.COERCERTL],u;for(;(u=l.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||u.index+u[0].length!==r.index+r[0].length)&&(r=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(r===null)return null;let n=r[2],o=r[3]||"0",s=r[4]||"0",a=e.includePrerelease&&r[5]?`-${r[5]}`:"",c=e.includePrerelease&&r[6]?`+${r[6]}`:"";return xpt(`${n}.${o}.${s}${a}${c}`,e)};jRe.exports=Spt});var GRe=R((BVr,HRe)=>{var Yre=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,r)}return this}};HRe.exports=Yre});var _u=R((qVr,KRe)=>{var Qre=class t{constructor(e,r){if(r=Cpt(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof Xre)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!$Re(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&Apt(o[0])){this.set=[o];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&Rpt)|(this.options.loose&&Ppt))+":"+e,o=zRe.get(n);if(o)return o;let s=this.options.loose,a=s?Rc[Va.HYPHENRANGELOOSE]:Rc[Va.HYPHENRANGE];e=e.replace(a,jpt(this.options.includePrerelease)),ni("hyphen replace",e),e=e.replace(Rc[Va.COMPARATORTRIM],Ept),ni("comparator trim",e),e=e.replace(Rc[Va.TILDETRIM],wpt),ni("tilde trim",e),e=e.replace(Rc[Va.CARETTRIM],kpt),ni("caret trim",e);let c=e.split(" ").map(p=>Dpt(p,this.options)).join(" ").split(/\s+/).map(p=>qpt(p,this.options));s&&(c=c.filter(p=>(ni("loose invalid filter",p,this.options),!!p.match(Rc[Va.COMPARATORLOOSE])))),ni("range list",c);let l=new Map,u=c.map(p=>new Xre(p,this.options));for(let p of u){if($Re(p))return[p];l.set(p.value,p)}l.size>1&&l.has("")&&l.delete("");let d=[...l.values()];return zRe.set(n,d),d}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>WRe(n,r)&&e.set.some(o=>WRe(o,r)&&n.every(s=>o.every(a=>s.intersects(a,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Tpt(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Vpt(this.set[r],e,this.options))return!0;return!1}};KRe.exports=Qre;var Ipt=GRe(),zRe=new Ipt,Cpt=jB(),Xre=aO(),ni=oO(),Tpt=da(),{safeRe:Rc,t:Va,comparatorTrimReplace:Ept,tildeTrimReplace:wpt,caretTrimReplace:kpt}=bk(),{FLAG_INCLUDE_PRERELEASE:Rpt,FLAG_LOOSE:Ppt}=iO(),$Re=t=>t.value==="<0.0.0-0",Apt=t=>t.value==="",WRe=(t,e)=>{let r=!0,n=t.slice(),o=n.pop();for(;r&&n.length;)r=n.every(s=>o.intersects(s,e)),o=n.pop();return r},Dpt=(t,e)=>(ni("comp",t,e),t=Opt(t,e),ni("caret",t),t=Npt(t,e),ni("tildes",t),t=Fpt(t,e),ni("xrange",t),t=Bpt(t,e),ni("stars",t),t),Ha=t=>!t||t.toLowerCase()==="x"||t==="*",Npt=(t,e)=>t.trim().split(/\s+/).map(r=>Lpt(r,e)).join(" "),Lpt=(t,e)=>{let r=e.loose?Rc[Va.TILDELOOSE]:Rc[Va.TILDE];return t.replace(r,(n,o,s,a,c)=>{ni("tilde",t,n,o,s,a,c);let l;return Ha(o)?l="":Ha(s)?l=`>=${o}.0.0 <${+o+1}.0.0-0`:Ha(a)?l=`>=${o}.${s}.0 <${o}.${+s+1}.0-0`:c?(ni("replaceTilde pr",c),l=`>=${o}.${s}.${a}-${c} <${o}.${+s+1}.0-0`):l=`>=${o}.${s}.${a} <${o}.${+s+1}.0-0`,ni("tilde return",l),l})},Opt=(t,e)=>t.trim().split(/\s+/).map(r=>Mpt(r,e)).join(" "),Mpt=(t,e)=>{ni("caret",t,e);let r=e.loose?Rc[Va.CARETLOOSE]:Rc[Va.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(o,s,a,c,l)=>{ni("caret",t,o,s,a,c,l);let u;return Ha(s)?u="":Ha(a)?u=`>=${s}.0.0${n} <${+s+1}.0.0-0`:Ha(c)?s==="0"?u=`>=${s}.${a}.0${n} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.0${n} <${+s+1}.0.0-0`:l?(ni("replaceCaret pr",l),s==="0"?a==="0"?u=`>=${s}.${a}.${c}-${l} <${s}.${a}.${+c+1}-0`:u=`>=${s}.${a}.${c}-${l} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.${c}-${l} <${+s+1}.0.0-0`):(ni("no pr"),s==="0"?a==="0"?u=`>=${s}.${a}.${c}${n} <${s}.${a}.${+c+1}-0`:u=`>=${s}.${a}.${c}${n} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.${c} <${+s+1}.0.0-0`),ni("caret return",u),u})},Fpt=(t,e)=>(ni("replaceXRanges",t,e),t.split(/\s+/).map(r=>Upt(r,e)).join(" ")),Upt=(t,e)=>{t=t.trim();let r=e.loose?Rc[Va.XRANGELOOSE]:Rc[Va.XRANGE];return t.replace(r,(n,o,s,a,c,l)=>{ni("xRange",t,n,o,s,a,c,l);let u=Ha(s),d=u||Ha(a),p=d||Ha(c),f=p;return o==="="&&f&&(o=""),l=e.includePrerelease?"-0":"",u?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),o==="<"&&(l="-0"),n=`${o+s}.${a}.${c}${l}`):d?n=`>=${s}.0.0${l} <${+s+1}.0.0-0`:p&&(n=`>=${s}.${a}.0${l} <${s}.${+a+1}.0-0`),ni("xRange return",n),n})},Bpt=(t,e)=>(ni("replaceStars",t,e),t.trim().replace(Rc[Va.STAR],"")),qpt=(t,e)=>(ni("replaceGTE0",t,e),t.trim().replace(Rc[e.includePrerelease?Va.GTE0PRE:Va.GTE0],"")),jpt=t=>(e,r,n,o,s,a,c,l,u,d,p,f)=>(Ha(n)?r="":Ha(o)?r=`>=${n}.0.0${t?"-0":""}`:Ha(s)?r=`>=${n}.${o}.0${t?"-0":""}`:a?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,Ha(u)?l="":Ha(d)?l=`<${+u+1}.0.0-0`:Ha(p)?l=`<${u}.${+d+1}.0-0`:f?l=`<=${u}.${d}.${p}-${f}`:t?l=`<${u}.${d}.${+p+1}-0`:l=`<=${l}`,`${r} ${l}`.trim()),Vpt=(t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(ni(t[n].semver),t[n].semver!==Xre.ANY&&t[n].semver.prerelease.length>0){let o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var aO=R((jVr,ePe)=>{var cO=Symbol("SemVer ANY"),ene=class t{static get ANY(){return cO}constructor(e,r){if(r=YRe(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Zre("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===cO?this.value="":this.value=this.operator+this.semver.version,Zre("comp",this)}parse(e){let r=this.options.loose?QRe[XRe.COMPARATORLOOSE]:QRe[XRe.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new JRe(n[2],this.options.loose):this.semver=cO}toString(){return this.value}test(e){if(Zre("Comparator.test",e,this.options.loose),this.semver===cO||e===cO)return!0;if(typeof e=="string")try{e=new JRe(e,this.options)}catch{return!1}return Jre(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new ZRe(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new ZRe(this.value,r).test(e.semver):(r=YRe(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Jre(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Jre(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};ePe.exports=ene;var YRe=jB(),{safeRe:QRe,t:XRe}=bk(),Jre=Kre(),Zre=oO(),JRe=da(),ZRe=_u()});var lO=R((VVr,tPe)=>{var Hpt=_u(),Gpt=(t,e,r)=>{try{e=new Hpt(e,r)}catch{return!1}return e.test(t)};tPe.exports=Gpt});var nPe=R((HVr,rPe)=>{var zpt=_u(),$pt=(t,e)=>new zpt(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));rPe.exports=$pt});var oPe=R((GVr,iPe)=>{var Wpt=da(),Kpt=_u(),Ypt=(t,e,r)=>{let n=null,o=null,s=null;try{s=new Kpt(e,r)}catch{return null}return t.forEach(a=>{s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new Wpt(n,r))}),n};iPe.exports=Ypt});var aPe=R((zVr,sPe)=>{var Qpt=da(),Xpt=_u(),Jpt=(t,e,r)=>{let n=null,o=null,s=null;try{s=new Xpt(e,r)}catch{return null}return t.forEach(a=>{s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new Qpt(n,r))}),n};sPe.exports=Jpt});var uPe=R(($Vr,lPe)=>{var tne=da(),Zpt=_u(),cPe=sO(),eft=(t,e)=>{t=new Zpt(t,e);let r=new tne("0.0.0");if(t.test(r)||(r=new tne("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let o=t.set[n],s=null;o.forEach(a=>{let c=new tne(a.semver.version);switch(a.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!s||cPe(c,s))&&(s=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!r||cPe(r,s))&&(r=s)}return r&&t.test(r)?r:null};lPe.exports=eft});var pPe=R((WVr,dPe)=>{var tft=_u(),rft=(t,e)=>{try{return new tft(t,e).range||"*"}catch{return null}};dPe.exports=rft});var QB=R((KVr,gPe)=>{var nft=da(),hPe=aO(),{ANY:ift}=hPe,oft=_u(),sft=lO(),fPe=sO(),mPe=zB(),aft=WB(),cft=$B(),lft=(t,e,r,n)=>{t=new nft(t,n),e=new oft(e,n);let o,s,a,c,l;switch(r){case">":o=fPe,s=aft,a=mPe,c=">",l=">=";break;case"<":o=mPe,s=cft,a=fPe,c="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(sft(t,e,n))return!1;for(let u=0;u<e.set.length;++u){let d=e.set[u],p=null,f=null;if(d.forEach(m=>{m.semver===ift&&(m=new hPe(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===l||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===l&&a(t,f.semver))return!1}return!0};gPe.exports=lft});var yPe=R((YVr,vPe)=>{var uft=QB(),dft=(t,e,r)=>uft(t,e,">",r);vPe.exports=dft});var _Pe=R((QVr,bPe)=>{var pft=QB(),fft=(t,e,r)=>pft(t,e,"<",r);bPe.exports=fft});var IPe=R((XVr,SPe)=>{var xPe=_u(),mft=(t,e,r)=>(t=new xPe(t,r),e=new xPe(e,r),t.intersects(e,r));SPe.exports=mft});var TPe=R((JVr,CPe)=>{var hft=lO(),gft=bu();CPe.exports=(t,e,r)=>{let n=[],o=null,s=null,a=t.sort((d,p)=>gft(d,p,r));for(let d of a)hft(d,e,r)?(s=d,o||(o=d)):(s&&n.push([o,s]),s=null,o=null);o&&n.push([o,null]);let c=[];for(let[d,p]of n)d===p?c.push(d):!p&&d===a[0]?c.push("*"):p?d===a[0]?c.push(`<=${p}`):c.push(`${d} - ${p}`):c.push(`>=${d}`);let l=c.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return l.length<u.length?l:e}});var APe=R((ZVr,PPe)=>{var EPe=_u(),nne=aO(),{ANY:rne}=nne,uO=lO(),ine=bu(),vft=(t,e,r={})=>{if(t===e)return!0;t=new EPe(t,r),e=new EPe(e,r);let n=!1;e:for(let o of t.set){for(let s of e.set){let a=bft(o,s,r);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},yft=[new nne(">=0.0.0-0")],wPe=[new nne(">=0.0.0")],bft=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===rne){if(e.length===1&&e[0].semver===rne)return!0;r.includePrerelease?t=yft:t=wPe}if(e.length===1&&e[0].semver===rne){if(r.includePrerelease)return!0;e=wPe}let n=new Set,o,s;for(let m of t)m.operator===">"||m.operator===">="?o=kPe(o,m,r):m.operator==="<"||m.operator==="<="?s=RPe(s,m,r):n.add(m.semver);if(n.size>1)return null;let a;if(o&&s){if(a=ine(o.semver,s.semver,r),a>0)return null;if(a===0&&(o.operator!==">="||s.operator!=="<="))return null}for(let m of n){if(o&&!uO(m,String(o),r)||s&&!uO(m,String(s),r))return null;for(let h of e)if(!uO(m,String(h),r))return!1;return!0}let c,l,u,d,p=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1,f=o&&!r.includePrerelease&&o.semver.prerelease.length?o.semver:!1;p&&p.prerelease.length===1&&s.operator==="<"&&p.prerelease[0]===0&&(p=!1);for(let m of e){if(d=d||m.operator===">"||m.operator===">=",u=u||m.operator==="<"||m.operator==="<=",o){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator===">"||m.operator===">="){if(c=kPe(o,m,r),c===m&&c!==o)return!1}else if(o.operator===">="&&!uO(o.semver,String(m),r))return!1}if(s){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator==="<"||m.operator==="<="){if(l=RPe(s,m,r),l===m&&l!==s)return!1}else if(s.operator==="<="&&!uO(s.semver,String(m),r))return!1}if(!m.operator&&(s||o)&&a!==0)return!1}return!(o&&u&&!s&&a!==0||s&&d&&!o&&a!==0||f||p)},kPe=(t,e,r)=>{if(!t)return e;let n=ine(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},RPe=(t,e,r)=>{if(!t)return e;let n=ine(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};PPe.exports=vft});var OPe=R((eHr,LPe)=>{var one=bk(),DPe=iO(),_ft=da(),NPe=Gre(),xft=Qx(),Sft=oRe(),Ift=aRe(),Cft=uRe(),Tft=fRe(),Eft=hRe(),wft=vRe(),kft=bRe(),Rft=xRe(),Pft=bu(),Aft=TRe(),Dft=wRe(),Nft=GB(),Lft=ARe(),Oft=NRe(),Mft=sO(),Fft=zB(),Uft=$re(),Bft=Wre(),qft=$B(),jft=WB(),Vft=Kre(),Hft=VRe(),Gft=aO(),zft=_u(),$ft=lO(),Wft=nPe(),Kft=oPe(),Yft=aPe(),Qft=uPe(),Xft=pPe(),Jft=QB(),Zft=yPe(),emt=_Pe(),tmt=IPe(),rmt=TPe(),nmt=APe();LPe.exports={parse:xft,valid:Sft,clean:Ift,inc:Cft,diff:Tft,major:Eft,minor:wft,patch:kft,prerelease:Rft,compare:Pft,rcompare:Aft,compareLoose:Dft,compareBuild:Nft,sort:Lft,rsort:Oft,gt:Mft,lt:Fft,eq:Uft,neq:Bft,gte:qft,lte:jft,cmp:Vft,coerce:Hft,Comparator:Gft,Range:zft,satisfies:$ft,toComparators:Wft,maxSatisfying:Kft,minSatisfying:Yft,minVersion:Qft,validRange:Xft,outside:Jft,gtr:Zft,ltr:emt,intersects:tmt,simplifyRange:rmt,subset:nmt,SemVer:_ft,re:one.re,src:one.src,tokens:one.t,SEMVER_SPEC_VERSION:DPe.SEMVER_SPEC_VERSION,RELEASE_TYPES:DPe.RELEASE_TYPES,compareIdentifiers:NPe.compareIdentifiers,rcompareIdentifiers:NPe.rcompareIdentifiers}});var sne=R(XB=>{"use strict";Object.defineProperty(XB,"__esModule",{value:!0});XB.makePatchingRequire=void 0;var imt=require("path"),omt=OPe(),MPe=Gi(),UPe=require("module"),smt=Object.keys(process.binding("natives")),FPe=UPe.prototype.require;function amt(t){var e={};return function(n){var o=FPe.apply(this,arguments);if(t[n]){var s=UPe._resolveFilename(n,this);if(e.hasOwnProperty(s))return e[s];var a=void 0;if(smt.indexOf(n)<0)try{a=FPe.call(this,imt.join(n,"package.json")).version}catch{return o}else a=process.version.substring(1);var c=a.indexOf("-");c>=0&&(a=a.substring(0,c));for(var l=o,u=0,d=t[n];u<d.length;u++){var p=d[u];if(omt.satisfies(a,p.versionSpecifier)&&(l=p.patch(l,s),MPe.channel)){var f=p.publisherName||n;MPe.channel.addPatchedModule(f,a)}}return e[s]=l}return o}}XB.makePatchingRequire=amt});var BPe=R((rHr,cmt)=>{cmt.exports={name:"diagnostic-channel",version:"1.1.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"eslint ./ --fix",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js",debug:"mocha --inspect-brk ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^7.5.3"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",sinon:"1.17.6",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var Gi=R(xu=>{"use strict";Object.defineProperty(xu,"__esModule",{value:!0});xu.channel=xu.ContextPreservingEventEmitter=xu.trueFilter=xu.makePatchingRequire=void 0;var lmt=sne(),umt=sne();Object.defineProperty(xu,"makePatchingRequire",{enumerable:!0,get:function(){return umt.makePatchingRequire}});var dmt=function(t){return!0};xu.trueFilter=dmt;var jPe=function(){function t(){this.version=BPe().version,this.subscribers={},this.contextPreservationFunction=function(e){return e},this.knownPatches={},this.modulesPatched=[],this.currentlyPublishing=!1}return t.prototype.shouldPublish=function(e){var r=this.subscribers[e];return r?r.some(function(n){var o=n.filter;return!o||o(!1)}):!1},t.prototype.publish=function(e,r){if(!this.currentlyPublishing){var n=this.subscribers[e];if(n){var o={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var a=s.listener,c=s.filter;try{c&&c(!0)&&a(o)}catch{}}),this.currentlyPublishing=!1}}},t.prototype.subscribe=function(e,r,n,o){n===void 0&&(n=xu.trueFilter),this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push({listener:r,filter:n,patchCallback:o});var s=this.checkIfModuleIsAlreadyPatched(e);s&&o&&o(s.name,s.version)},t.prototype.unsubscribe=function(e,r,n){n===void 0&&(n=xu.trueFilter);var o=this.subscribers[e];if(o){for(var s=0;s<o.length;++s)if(o[s].listener===r&&o[s].filter===n)return o.splice(s,1),!0}return!1},t.prototype.reset=function(){var e=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete e.knownPatches[r]})},t.prototype.bindToContext=function(e){return this.contextPreservationFunction(e)},t.prototype.addContextPreservation=function(e){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return e(r(n))}},t.prototype.registerMonkeyPatch=function(e,r){this.knownPatches[e]||(this.knownPatches[e]=[]),this.knownPatches[e].push(r)},t.prototype.getPatchesObject=function(){return this.knownPatches},t.prototype.addPatchedModule=function(e,r){for(var n=0,o=this.modulesPatched;n<o.length;n++){var s=o[n];if(s.name===e)return}this.modulesPatched.push({name:e,version:r});var a=this.subscribers[e];a&&a.forEach(function(c){c.patchCallback&&c.patchCallback(e,r)})},t.prototype.checkIfModuleIsAlreadyPatched=function(e){for(var r=0,n=this.modulesPatched;r<n.length;r++){var o=n[r];if(o.name===e)return o}return null},t}();xu.ContextPreservingEventEmitter=jPe;global.diagnosticsSource||(global.diagnosticsSource=new jPe,qPe=require("module"),qPe.prototype.require=lmt.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var qPe;xu.channel=global.diagnosticsSource});var VPe,HPe=D(()=>{VPe=typeof globalThis=="object"?globalThis:global});var GPe=D(()=>{HPe()});var zPe=D(()=>{GPe()});var Mh,ane=D(()=>{Mh="1.6.0"});function pmt(t){var e=new Set([t]),r=new Set,n=t.match($Pe);if(!n)return function(){return!1};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(l){return l===t};function s(c){return r.add(c),!1}function a(c){return e.add(c),!0}return function(l){if(e.has(l))return!0;if(r.has(l))return!1;var u=l.match($Pe);if(!u)return s(l);var d={major:+u[1],minor:+u[2],patch:+u[3],prerelease:u[4]};return d.prerelease!=null||o.major!==d.major?s(l):o.major===0?o.minor===d.minor&&o.patch<=d.patch?a(l):s(l):o.minor<=d.minor?a(l):s(l)}}var $Pe,WPe,KPe=D(()=>{ane();$Pe=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;WPe=pmt(Mh)});function wf(t,e,r,n){var o;n===void 0&&(n=!1);var s=pO[dO]=(o=pO[dO])!==null&&o!==void 0?o:{version:Mh};if(!n&&s[t]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(a.stack||a.message),!1}if(s.version!==Mh){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+Mh);return r.error(a.stack||a.message),!1}return s[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+Mh+"."),!0}function bl(t){var e,r,n=(e=pO[dO])===null||e===void 0?void 0:e.version;if(!(!n||!WPe(n)))return(r=pO[dO])===null||r===void 0?void 0:r[t]}function kf(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+Mh+".");var r=pO[dO];r&&delete r[t]}var fmt,dO,pO,Xx=D(()=>{zPe();ane();KPe();fmt=Mh.split(".")[0],dO=Symbol.for("opentelemetry.js.api."+fmt),pO=VPe});function fO(t,e,r){var n=bl("diag");if(n)return r.unshift(e),n[t].apply(n,hmt([],mmt(r),!1))}var mmt,hmt,YPe,QPe=D(()=>{Xx();mmt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},hmt=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},YPe=function(){function t(e){this._namespace=e.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return fO("debug",this._namespace,e)},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return fO("error",this._namespace,e)},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return fO("info",this._namespace,e)},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return fO("warn",this._namespace,e)},t.prototype.verbose=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return fO("verbose",this._namespace,e)},t}()});var Gn,JB=D(()=>{(function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})(Gn||(Gn={}))});function XPe(t,e){t<Gn.NONE?t=Gn.NONE:t>Gn.ALL&&(t=Gn.ALL),e=e||{};function r(n,o){var s=e[n];return typeof s=="function"&&t>=o?s.bind(e):function(){}}return{error:r("error",Gn.ERROR),warn:r("warn",Gn.WARN),info:r("info",Gn.INFO),debug:r("debug",Gn.DEBUG),verbose:r("verbose",Gn.VERBOSE)}}var JPe=D(()=>{JB()});var gmt,vmt,ymt,pa,Jx=D(()=>{QPe();JPe();JB();Xx();gmt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},vmt=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},ymt="diag",pa=function(){function t(){function e(o){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=bl("diag");if(c)return c[o].apply(c,vmt([],gmt(s),!1))}}var r=this,n=function(o,s){var a,c,l;if(s===void 0&&(s={logLevel:Gn.INFO}),o===r){var u=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((a=u.stack)!==null&&a!==void 0?a:u.message),!1}typeof s=="number"&&(s={logLevel:s});var d=bl("diag"),p=XPe((c=s.logLevel)!==null&&c!==void 0?c:Gn.INFO,o);if(d&&!s.suppressOverrideMessage){var f=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";d.warn("Current logger will be overwritten from "+f),p.warn("Current logger will overwrite one already registered from "+f)}return wf("diag",p,r,!0)};r.setLogger=n,r.disable=function(){kf(ymt,r)},r.createComponentLogger=function(o){return new YPe(o)},r.verbose=e("verbose"),r.debug=e("debug"),r.info=e("info"),r.warn=e("warn"),r.error=e("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}()});var bmt,_mt,ZPe,eAe=D(()=>{bmt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},_mt=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ZPe=function(){function t(e){this._entries=e?new Map(e):new Map}return t.prototype.getEntry=function(e){var r=this._entries.get(e);if(r)return Object.assign({},r)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var r=bmt(e,2),n=r[0],o=r[1];return[n,o]})},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=new t(this._entries);try{for(var a=_mt(n),c=a.next();!c.done;c=a.next()){var l=c.value;s._entries.delete(l)}}catch(u){e={error:u}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t}()});var tAe,rAe=D(()=>{tAe=Symbol("BaggageEntryMetadata")});function nAe(t){return t===void 0&&(t={}),new ZPe(new Map(Object.entries(t)))}function ZB(t){return typeof t!="string"&&(xmt.error("Cannot create baggage metadata from unknown type: "+typeof t),t=""),{__TYPE__:tAe,toString:function(){return t}}}var xmt,cne=D(()=>{Jx();eAe();rAe();xmt=pa.instance()});function Rf(t){return Symbol.for(t)}var Smt,eq,mO=D(()=>{Smt=function(){function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var s=new t(r._currentContext);return s._currentContext.set(n,o),s},r.deleteValue=function(n){var o=new t(r._currentContext);return o._currentContext.delete(n),o}}return t}(),eq=new Smt});var lne,iAe,oAe=D(()=>{lne=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],iAe=function(){function t(){function e(n){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];if(console){var a=console[n];if(typeof a!="function"&&(a=console.log),typeof a=="function")return a.apply(console,o)}}}for(var r=0;r<lne.length;r++)this[lne[r].n]=e(lne[r].c)}return t}()});function sAe(){return pne}var xk,Imt,une,Cmt,Tmt,Emt,dne,wmt,kmt,Rmt,pne,Pmt,Amt,Dmt,Nmt,Lmt,Omt,fne=D(()=>{xk=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Imt=function(){function t(){}return t.prototype.createHistogram=function(e,r){return Amt},t.prototype.createCounter=function(e,r){return Pmt},t.prototype.createUpDownCounter=function(e,r){return Dmt},t.prototype.createObservableGauge=function(e,r){return Lmt},t.prototype.createObservableCounter=function(e,r){return Nmt},t.prototype.createObservableUpDownCounter=function(e,r){return Omt},t.prototype.addBatchObservableCallback=function(e,r){},t.prototype.removeBatchObservableCallback=function(e){},t}(),une=function(){function t(){}return t}(),Cmt=function(t){xk(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e}(une),Tmt=function(t){xk(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e}(une),Emt=function(t){xk(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.record=function(r,n){},e}(une),dne=function(){function t(){}return t.prototype.addCallback=function(e){},t.prototype.removeCallback=function(e){},t}(),wmt=function(t){xk(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(dne),kmt=function(t){xk(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(dne),Rmt=function(t){xk(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(dne),pne=new Imt,Pmt=new Cmt,Amt=new Emt,Dmt=new Tmt,Nmt=new wmt,Lmt=new kmt,Omt=new Rmt});var tq,aAe=D(()=>{(function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"})(tq||(tq={}))});var rq,nq,mne=D(()=>{rq={get:function(t,e){if(t!=null)return t[e]},keys:function(t){return t==null?[]:Object.keys(t)}},nq={set:function(t,e,r){t!=null&&(t[e]=r)}}});var Mmt,Fmt,cAe,lAe=D(()=>{mO();Mmt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Fmt=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},cAe=function(){function t(){}return t.prototype.active=function(){return eq},t.prototype.with=function(e,r,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.call.apply(r,Fmt([n],Mmt(o),!1))},t.prototype.bind=function(e,r){return r},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}()});var Umt,Bmt,hne,qmt,xy,hO=D(()=>{lAe();Xx();Jx();Umt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Bmt=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},hne="context",qmt=new cAe,xy=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(e){return wf(hne,e,pa.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(e,r,n){for(var o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return(o=this._getContextManager()).with.apply(o,Bmt([e,r,n],Umt(s),!1))},t.prototype.bind=function(e,r){return this._getContextManager().bind(e,r)},t.prototype._getContextManager=function(){return bl(hne)||qmt},t.prototype.disable=function(){this._getContextManager().disable(),kf(hne,pa.instance())},t}()});var io,gne=D(()=>{(function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})(io||(io={}))});var gO,vO,Sk,iq=D(()=>{gne();gO="0000000000000000",vO="00000000000000000000000000000000",Sk={traceId:vO,spanId:gO,traceFlags:io.NONE}});var Sy,oq=D(()=>{iq();Sy=function(){function t(e){e===void 0&&(e=Sk),this._spanContext=e}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return this},t.prototype.setAttributes=function(e){return this},t.prototype.addEvent=function(e,r){return this},t.prototype.setStatus=function(e){return this},t.prototype.updateName=function(e){return this},t.prototype.end=function(e){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(e,r){},t}()});function sq(t){return t.getValue(vne)||void 0}function uAe(){return sq(xy.getInstance().active())}function yO(t,e){return t.setValue(vne,e)}function dAe(t){return t.deleteValue(vne)}function pAe(t,e){return yO(t,new Sy(e))}function aq(t){var e;return(e=sq(t))===null||e===void 0?void 0:e.spanContext()}var vne,yne=D(()=>{mO();oq();hO();vne=Rf("OpenTelemetry Context Key SPAN")});function Zx(t){return jmt.test(t)&&t!==vO}function bne(t){return Vmt.test(t)&&t!==gO}function Su(t){return Zx(t.traceId)&&bne(t.spanId)}function fAe(t){return new Sy(t)}var jmt,Vmt,cq=D(()=>{iq();oq();jmt=/^([0-9a-f]{32})$/i,Vmt=/^[0-9a-f]{16}$/i});function Hmt(t){return typeof t=="object"&&typeof t.spanId=="string"&&typeof t.traceId=="string"&&typeof t.traceFlags=="number"}var _ne,lq,xne=D(()=>{hO();yne();oq();cq();_ne=xy.getInstance(),lq=function(){function t(){}return t.prototype.startSpan=function(e,r,n){n===void 0&&(n=_ne.active());var o=!!r?.root;if(o)return new Sy;var s=n&&aq(n);return Hmt(s)&&Su(s)?new Sy(s):new Sy},t.prototype.startActiveSpan=function(e,r,n,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=r:arguments.length===3?(s=r,c=n):(s=r,a=n,c=o);var l=a??_ne.active(),u=this.startSpan(e,s,l),d=yO(l,u);return _ne.with(d,c,void 0,u)}},t}()});var Gmt,uq,Sne=D(()=>{xne();Gmt=new lq,uq=function(){function t(e,r,n,o){this._provider=e,this.name=r,this.version=n,this.options=o}return t.prototype.startSpan=function(e,r,n){return this._getTracer().startSpan(e,r,n)},t.prototype.startActiveSpan=function(e,r,n,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):Gmt},t}()});var mAe,hAe=D(()=>{xne();mAe=function(){function t(){}return t.prototype.getTracer=function(e,r,n){return new lq},t}()});var zmt,bO,Ine=D(()=>{Sne();hAe();zmt=new mAe,bO=function(){function t(){}return t.prototype.getTracer=function(e,r,n){var o;return(o=this.getDelegateTracer(e,r,n))!==null&&o!==void 0?o:new uq(this,e,r,n)},t.prototype.getDelegate=function(){var e;return(e=this._delegate)!==null&&e!==void 0?e:zmt},t.prototype.setDelegate=function(e){this._delegate=e},t.prototype.getDelegateTracer=function(e,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getTracer(e,r,n)},t}()});var Pc,gAe=D(()=>{(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Pc||(Pc={}))});var Ik,vAe=D(()=>{(function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})(Ik||(Ik={}))});var Ck,yAe=D(()=>{(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(Ck||(Ck={}))});function bAe(t){return Kmt.test(t)}function _Ae(t){return Ymt.test(t)&&!Qmt.test(t)}var Cne,$mt,Wmt,Kmt,Ymt,Qmt,xAe=D(()=>{Cne="[_0-9a-z-*/]",$mt="[a-z]"+Cne+"{0,255}",Wmt="[a-z0-9]"+Cne+"{0,240}@[a-z]"+Cne+"{0,13}",Kmt=new RegExp("^(?:"+$mt+"|"+Wmt+")$"),Ymt=/^[ -~]{0,255}[!-~]$/,Qmt=/,|=/});var SAe,Xmt,IAe,CAe,TAe,EAe=D(()=>{xAe();SAe=32,Xmt=512,IAe=",",CAe="=",TAe=function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+CAe+e.get(n)),r},[]).join(IAe)},t.prototype._parse=function(e){e.length>Xmt||(this._internalState=e.split(IAe).reverse().reduce(function(r,n){var o=n.trim(),s=o.indexOf(CAe);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,n.length);bAe(a)&&_Ae(c)&&r.set(a,c)}return r},new Map),this._internalState.size>SAe&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,SAe))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}()});function wAe(t){return new TAe(t)}var kAe=D(()=>{EAe()});var Ga,RAe=D(()=>{hO();Ga=xy.getInstance()});var Et,PAe=D(()=>{Jx();Et=pa.instance()});var Jmt,AAe,DAe=D(()=>{fne();Jmt=function(){function t(){}return t.prototype.getMeter=function(e,r,n){return pne},t}(),AAe=new Jmt});var Tne,NAe,LAe=D(()=>{DAe();Xx();Jx();Tne="metrics",NAe=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(e){return wf(Tne,e,pa.instance())},t.prototype.getMeterProvider=function(){return bl(Tne)||AAe},t.prototype.getMeter=function(e,r,n){return this.getMeterProvider().getMeter(e,r,n)},t.prototype.disable=function(){kf(Tne,pa.instance())},t}()});var Ene,OAe=D(()=>{LAe();Ene=NAe.getInstance()});var MAe,FAe=D(()=>{MAe=function(){function t(){}return t.prototype.inject=function(e,r){},t.prototype.extract=function(e,r){return e},t.prototype.fields=function(){return[]},t}()});function kne(t){return t.getValue(wne)||void 0}function UAe(){return kne(xy.getInstance().active())}function BAe(t,e){return t.setValue(wne,e)}function qAe(t){return t.deleteValue(wne)}var wne,jAe=D(()=>{hO();mO();wne=Rf("OpenTelemetry Baggage Key")});var Rne,Zmt,VAe,HAe=D(()=>{Xx();FAe();mne();jAe();cne();Jx();Rne="propagation",Zmt=new MAe,VAe=function(){function t(){this.createBaggage=nAe,this.getBaggage=kne,this.getActiveBaggage=UAe,this.setBaggage=BAe,this.deleteBaggage=qAe}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(e){return wf(Rne,e,pa.instance())},t.prototype.inject=function(e,r,n){return n===void 0&&(n=nq),this._getGlobalPropagator().inject(e,r,n)},t.prototype.extract=function(e,r,n){return n===void 0&&(n=rq),this._getGlobalPropagator().extract(e,r,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){kf(Rne,pa.instance())},t.prototype._getGlobalPropagator=function(){return bl(Rne)||Zmt},t}()});var Fh,GAe=D(()=>{HAe();Fh=VAe.getInstance()});var Pne,zAe,$Ae=D(()=>{Xx();Ine();cq();yne();Jx();Pne="trace",zAe=function(){function t(){this._proxyTracerProvider=new bO,this.wrapSpanContext=fAe,this.isSpanContextValid=Su,this.deleteSpan=dAe,this.getSpan=sq,this.getActiveSpan=uAe,this.getSpanContext=aq,this.setSpan=yO,this.setSpanContext=pAe}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(e){var r=wf(Pne,this._proxyTracerProvider,pa.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},t.prototype.getTracerProvider=function(){return bl(Pne)||this._proxyTracerProvider},t.prototype.getTracer=function(e,r){return this.getTracerProvider().getTracer(e,r)},t.prototype.disable=function(){kf(Pne,pa.instance()),this._proxyTracerProvider=new bO},t}()});var Qo,WAe=D(()=>{$Ae();Qo=zAe.getInstance()});var Tk={};Pn(Tk,{DiagConsoleLogger:()=>iAe,DiagLogLevel:()=>Gn,INVALID_SPANID:()=>gO,INVALID_SPAN_CONTEXT:()=>Sk,INVALID_TRACEID:()=>vO,ProxyTracer:()=>uq,ProxyTracerProvider:()=>bO,ROOT_CONTEXT:()=>eq,SamplingDecision:()=>Pc,SpanKind:()=>Ik,SpanStatusCode:()=>Ck,TraceFlags:()=>io,ValueType:()=>tq,baggageEntryMetadataFromString:()=>ZB,context:()=>Ga,createContextKey:()=>Rf,createNoopMeter:()=>sAe,createTraceState:()=>wAe,default:()=>eht,defaultTextMapGetter:()=>rq,defaultTextMapSetter:()=>nq,diag:()=>Et,isSpanContextValid:()=>Su,isValidSpanId:()=>bne,isValidTraceId:()=>Zx,metrics:()=>Ene,propagation:()=>Fh,trace:()=>Qo});var eht,Ur=D(()=>{cne();mO();oAe();JB();fne();aAe();mne();Sne();Ine();gAe();vAe();yAe();gne();kAe();cq();iq();RAe();PAe();OAe();GAe();WAe();eht={context:Ga,diag:Et,metrics:Ene,propagation:Fh,trace:Qo}});function _O(t){return t.setValue(Ane,!0)}function tht(t){return t.deleteValue(Ane)}function eS(t){return t.getValue(Ane)===!0}var Ane,xO=D(()=>{Ur();Ane=Rf("OpenTelemetry SDK Context Key SUPPRESS_TRACING")});var KAe,dq,Ek,pq,YAe,QAe,XAe,Dne=D(()=>{KAe="=",dq=";",Ek=",",pq="baggage",YAe=180,QAe=4096,XAe=8192});var One={};Pn(One,{getKeyPairs:()=>Lne,parseKeyPairsIntoRecord:()=>nht,parsePairKeyValue:()=>fq,serializeKeyPairs:()=>Nne});function Nne(t){return t.reduce(function(e,r){var n=""+e+(e!==""?Ek:"")+r;return n.length>XAe?e:n},"")}function Lne(t){return t.getAllEntries().map(function(e){var r=rht(e,2),n=r[0],o=r[1],s=encodeURIComponent(n)+"="+encodeURIComponent(o.value);return o.metadata!==void 0&&(s+=dq+o.metadata.toString()),s})}function fq(t){var e=t.split(dq);if(!(e.length<=0)){var r=e.shift();if(r){var n=r.indexOf(KAe);if(!(n<=0)){var o=decodeURIComponent(r.substring(0,n).trim()),s=decodeURIComponent(r.substring(n+1).trim()),a;return e.length>0&&(a=ZB(e.join(dq))),{key:o,value:s,metadata:a}}}}}function nht(t){return typeof t!="string"||t.length===0?{}:t.split(Ek).map(function(e){return fq(e)}).filter(function(e){return e!==void 0&&e.value.length>0}).reduce(function(e,r){return e[r.key]=r.value,e},{})}var rht,Mne=D(()=>{Ur();Dne();rht=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}});var Fne,JAe=D(()=>{Ur();xO();Dne();Mne();Fne=function(){function t(){}return t.prototype.inject=function(e,r,n){var o=Fh.getBaggage(e);if(!(!o||eS(e))){var s=Lne(o).filter(function(c){return c.length<=QAe}).slice(0,YAe),a=Nne(s);a.length>0&&n.set(r,pq,a)}},t.prototype.extract=function(e,r,n){var o=n.get(r,pq),s=Array.isArray(o)?o.join(Ek):o;if(!s)return e;var a={};if(s.length===0)return e;var c=s.split(Ek);return c.forEach(function(l){var u=fq(l);if(u){var d={value:u.value};u.metadata&&(d.metadata=u.metadata),a[u.key]=d}}),Object.entries(a).length===0?e:Fh.setBaggage(e,Fh.createBaggage(a))},t.prototype.fields=function(){return[pq]},t}()});var iht,ZAe=D(()=>{iht=function(){function t(e,r){this._monotonicClock=r,this._epochMillis=e.now(),this._performanceMillis=r.now()}return t.prototype.now=function(){var e=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+e},t}()});function tS(t){var e,r,n={};if(typeof t!="object"||t==null)return n;try{for(var o=e2e(Object.entries(t)),s=o.next();!s.done;s=o.next()){var a=oht(s.value,2),c=a[0],l=a[1];if(!t2e(c)){Et.warn("Invalid attribute key: "+c);continue}if(!mq(l)){Et.warn("Invalid attribute value set for key: "+c);continue}Array.isArray(l)?n[c]=l.slice():n[c]=l}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n}function t2e(t){return typeof t=="string"&&t.length>0}function mq(t){return t==null?!0:Array.isArray(t)?sht(t):r2e(t)}function sht(t){var e,r,n;try{for(var o=e2e(t),s=o.next();!s.done;s=o.next()){var a=s.value;if(a!=null){if(!n){if(r2e(a)){n=typeof a;continue}return!1}if(typeof a!==n)return!1}}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!0}function r2e(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}var e2e,oht,n2e=D(()=>{Ur();e2e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},oht=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}});function Une(){return function(t){Et.error(aht(t))}}function aht(t){return typeof t=="string"?t:JSON.stringify(cht(t))}function cht(t){for(var e={},r=t;r!==null;)Object.getOwnPropertyNames(r).forEach(function(n){if(!e[n]){var o=r[n];o&&(e[n]=String(o))}}),r=Object.getPrototypeOf(r);return e}var Bne=D(()=>{Ur()});function lht(t){i2e=t}function Ac(t){try{i2e(t)}catch{}}var i2e,qne=D(()=>{Bne();i2e=Une()});var _l,jne=D(()=>{(function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})(_l||(_l={}))});var o2e,s2e=D(()=>{o2e=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{}});function pht(t){return dht.indexOf(t)>-1}function mht(t){return fht.indexOf(t)>-1}function ght(t){return hht.indexOf(t)>-1}function vht(t,e,r){if(!(typeof r[t]>"u")){var n=String(r[t]);e[t]=n.toLowerCase()==="true"}}function yht(t,e,r,n,o){if(n===void 0&&(n=-1/0),o===void 0&&(o=1/0),typeof r[t]<"u"){var s=Number(r[t]);isNaN(s)||(s<n?e[t]=n:s>o?e[t]=o:e[t]=s)}}function bht(t,e,r,n){n===void 0&&(n=uht);var o=r[t];typeof o=="string"&&(e[t]=o.split(n).map(function(s){return s.trim()}))}function xht(t,e,r){var n=r[t];if(typeof n=="string"){var o=_ht[n.toUpperCase()];o!=null&&(e[t]=o)}}function SO(t){var e={};for(var r in hq){var n=r;switch(n){case"OTEL_LOG_LEVEL":xht(n,e,t);break;default:if(pht(n))vht(n,e,t);else if(mht(n))yht(n,e,t);else if(ght(n))bht(n,e,t);else{var o=t[n];typeof o<"u"&&o!==null&&(e[n]=String(o))}}}return e}function Vne(){return typeof process<"u"&&process&&process.env?SO(process.env):SO(o2e)}var uht,dht,fht,hht,wk,kk,a2e,c2e,hq,_ht,Hne=D(()=>{Ur();jne();s2e();uht=",",dht=["OTEL_SDK_DISABLED"];fht=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];hht=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];wk=1/0,kk=128,a2e=128,c2e=128,hq={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:Gn.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:wk,OTEL_ATTRIBUTE_COUNT_LIMIT:kk,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:wk,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:kk,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:wk,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:kk,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:a2e,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:c2e,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:_l.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};_ht={ALL:Gn.ALL,VERBOSE:Gn.VERBOSE,DEBUG:Gn.DEBUG,INFO:Gn.INFO,WARN:Gn.WARN,ERROR:Gn.ERROR,NONE:Gn.NONE}});function Xo(){var t=SO(process.env);return Object.assign({HOSTNAME:l2e.hostname()},hq,t)}var l2e,u2e=D(()=>{l2e=q(require("os"));Hne()});var Sht,d2e=D(()=>{Sht=typeof globalThis=="object"?globalThis:global});function p2e(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function Tht(t){var e;t.length===16?e=Iht:t.length===32?e=Cht:e=Buffer.alloc(t.length/2);for(var r=0,n=0;n<t.length;n+=2){var o=p2e(t.charCodeAt(n)),s=p2e(t.charCodeAt(n+1));e.writeUInt8(o<<4|s,r++)}return e.toString("base64")}var Iht,Cht,f2e=D(()=>{Iht=Buffer.alloc(8),Cht=Buffer.alloc(16)});function m2e(t){return function(){for(var r=0;r<t/4;r++)gq.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,r*4);for(var r=0;r<t&&!(gq[r]>0);r++)r===t-1&&(gq[t-1]=1);return gq.toString("hex",0,t)}}var Eht,h2e,wht,gq,g2e=D(()=>{Eht=8,h2e=16,wht=function(){function t(){this.generateTraceId=m2e(h2e),this.generateSpanId=m2e(Eht)}return t}(),gq=Buffer.allocUnsafe(h2e)});var v2e,Uh,y2e=D(()=>{v2e=require("perf_hooks"),Uh=v2e.performance});var Gne,vq=D(()=>{Gne="1.17.0"});var Bh,kht,Rht,Pht,Aht,Dht,Nht,Lht,Oht,Mht,Fht,Uht,Bht,qht,b2e=D(()=>{Bh={AWS_LAMBDA_INVOKED_ARN:"aws.lambda.invoked_arn",DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",NET_HOST_CONNECTION_TYPE:"net.host.connection.type",NET_HOST_CONNECTION_SUBTYPE:"net.host.connection.subtype",NET_HOST_CARRIER_NAME:"net.host.carrier.name",NET_HOST_CARRIER_MCC:"net.host.carrier.mcc",NET_HOST_CARRIER_MNC:"net.host.carrier.mnc",NET_HOST_CARRIER_ICC:"net.host.carrier.icc",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_CONSUMER_ID:"messaging.consumer_id",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message",MESSAGE_TYPE:"message.type",MESSAGE_ID:"message.id",MESSAGE_COMPRESSED_SIZE:"message.compressed_size",MESSAGE_UNCOMPRESSED_SIZE:"message.uncompressed_size"},kht={OTHER_SQL:"other_sql",MSSQL:"mssql",MYSQL:"mysql",ORACLE:"oracle",DB2:"db2",POSTGRESQL:"postgresql",REDSHIFT:"redshift",HIVE:"hive",CLOUDSCAPE:"cloudscape",HSQLDB:"hsqldb",PROGRESS:"progress",MAXDB:"maxdb",HANADB:"hanadb",INGRES:"ingres",FIRSTSQL:"firstsql",EDB:"edb",CACHE:"cache",ADABAS:"adabas",FIREBIRD:"firebird",DERBY:"derby",FILEMAKER:"filemaker",INFORMIX:"informix",INSTANTDB:"instantdb",INTERBASE:"interbase",MARIADB:"mariadb",NETEZZA:"netezza",PERVASIVE:"pervasive",POINTBASE:"pointbase",SQLITE:"sqlite",SYBASE:"sybase",TERADATA:"teradata",VERTICA:"vertica",H2:"h2",COLDFUSION:"coldfusion",CASSANDRA:"cassandra",HBASE:"hbase",MONGODB:"mongodb",REDIS:"redis",COUCHBASE:"couchbase",COUCHDB:"couchdb",COSMOSDB:"cosmosdb",DYNAMODB:"dynamodb",NEO4J:"neo4j",GEODE:"geode",ELASTICSEARCH:"elasticsearch",MEMCACHED:"memcached",COCKROACHDB:"cockroachdb"},Rht={ALL:"all",EACH_QUORUM:"each_quorum",QUORUM:"quorum",LOCAL_QUORUM:"local_quorum",ONE:"one",TWO:"two",THREE:"three",LOCAL_ONE:"local_one",ANY:"any",SERIAL:"serial",LOCAL_SERIAL:"local_serial"},Pht={DATASOURCE:"datasource",HTTP:"http",PUBSUB:"pubsub",TIMER:"timer",OTHER:"other"},Aht={INSERT:"insert",EDIT:"edit",DELETE:"delete"},Dht={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},Nht={IP_TCP:"ip_tcp",IP_UDP:"ip_udp",IP:"ip",UNIX:"unix",PIPE:"pipe",INPROC:"inproc",OTHER:"other"},Lht={WIFI:"wifi",WIRED:"wired",CELL:"cell",UNAVAILABLE:"unavailable",UNKNOWN:"unknown"},Oht={GPRS:"gprs",EDGE:"edge",UMTS:"umts",CDMA:"cdma",EVDO_0:"evdo_0",EVDO_A:"evdo_a",CDMA2000_1XRTT:"cdma2000_1xrtt",HSDPA:"hsdpa",HSUPA:"hsupa",HSPA:"hspa",IDEN:"iden",EVDO_B:"evdo_b",LTE:"lte",EHRPD:"ehrpd",HSPAP:"hspap",GSM:"gsm",TD_SCDMA:"td_scdma",IWLAN:"iwlan",NR:"nr",NRNSA:"nrnsa",LTE_CA:"lte_ca"},Mht={HTTP_1_0:"1.0",HTTP_1_1:"1.1",HTTP_2_0:"2.0",SPDY:"SPDY",QUIC:"QUIC"},Fht={QUEUE:"queue",TOPIC:"topic"},Uht={RECEIVE:"receive",PROCESS:"process"},Bht={OK:0,CANCELLED:1,UNKNOWN:2,INVALID_ARGUMENT:3,DEADLINE_EXCEEDED:4,NOT_FOUND:5,ALREADY_EXISTS:6,PERMISSION_DENIED:7,RESOURCE_EXHAUSTED:8,FAILED_PRECONDITION:9,ABORTED:10,OUT_OF_RANGE:11,UNIMPLEMENTED:12,INTERNAL:13,UNAVAILABLE:14,DATA_LOSS:15,UNAUTHENTICATED:16},qht={SENT:"SENT",RECEIVED:"RECEIVED"}});var _2e=D(()=>{b2e()});var Ir,jht,Vht,Hht,Ght,zht,zne,x2e=D(()=>{Ir={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"},jht={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},Vht={ALIBABA_CLOUD_ECS:"alibaba_cloud_ecs",ALIBABA_CLOUD_FC:"alibaba_cloud_fc",AWS_EC2:"aws_ec2",AWS_ECS:"aws_ecs",AWS_EKS:"aws_eks",AWS_LAMBDA:"aws_lambda",AWS_ELASTIC_BEANSTALK:"aws_elastic_beanstalk",AZURE_VM:"azure_vm",AZURE_CONTAINER_INSTANCES:"azure_container_instances",AZURE_AKS:"azure_aks",AZURE_FUNCTIONS:"azure_functions",AZURE_APP_SERVICE:"azure_app_service",GCP_COMPUTE_ENGINE:"gcp_compute_engine",GCP_CLOUD_RUN:"gcp_cloud_run",GCP_KUBERNETES_ENGINE:"gcp_kubernetes_engine",GCP_CLOUD_FUNCTIONS:"gcp_cloud_functions",GCP_APP_ENGINE:"gcp_app_engine"},Hht={EC2:"ec2",FARGATE:"fargate"},Ght={AMD64:"amd64",ARM32:"arm32",ARM64:"arm64",IA64:"ia64",PPC32:"ppc32",PPC64:"ppc64",X86:"x86"},zht={WINDOWS:"windows",LINUX:"linux",DARWIN:"darwin",FREEBSD:"freebsd",NETBSD:"netbsd",OPENBSD:"openbsd",DRAGONFLYBSD:"dragonflybsd",HPUX:"hpux",AIX:"aix",SOLARIS:"solaris",Z_OS:"z_os"},zne={CPP:"cpp",DOTNET:"dotnet",ERLANG:"erlang",GO:"go",JAVA:"java",NODEJS:"nodejs",PHP:"php",PYTHON:"python",RUBY:"ruby",WEBJS:"webjs"}});var S2e=D(()=>{x2e()});var $ne={};Pn($ne,{AwsEcsLaunchtypeValues:()=>Hht,CloudPlatformValues:()=>Vht,CloudProviderValues:()=>jht,DbCassandraConsistencyLevelValues:()=>Rht,DbSystemValues:()=>kht,FaasDocumentOperationValues:()=>Aht,FaasInvokedProviderValues:()=>Dht,FaasTriggerValues:()=>Pht,HostArchValues:()=>Ght,HttpFlavorValues:()=>Mht,MessageTypeValues:()=>qht,MessagingDestinationKindValues:()=>Fht,MessagingOperationValues:()=>Uht,NetHostConnectionSubtypeValues:()=>Oht,NetHostConnectionTypeValues:()=>Lht,NetTransportValues:()=>Nht,OsTypeValues:()=>zht,RpcGrpcStatusCodeValues:()=>Bht,SemanticAttributes:()=>Bh,SemanticResourceAttributes:()=>Ir,TelemetrySdkLanguageValues:()=>zne});var Bd=D(()=>{_2e();S2e()});var Rk,IO,I2e=D(()=>{vq();Bd();IO=(Rk={},Rk[Ir.TELEMETRY_SDK_NAME]="opentelemetry",Rk[Ir.PROCESS_RUNTIME_NAME]="node",Rk[Ir.TELEMETRY_SDK_LANGUAGE]=zne.NODEJS,Rk[Ir.TELEMETRY_SDK_VERSION]=Gne,Rk)});function Wne(t){t.unref()}var C2e=D(()=>{});var T2e=D(()=>{u2e();d2e();f2e();g2e();y2e();I2e();C2e()});var Kne=D(()=>{T2e()});function Pf(t){var e=t/1e3,r=Math.trunc(e),n=Math.round(t%1e3*Wht);return[r,n]}function CO(){var t=Uh.timeOrigin;if(typeof t!="number"){var e=Uh;t=e.timing&&e.timing.fetchStart}return t}function bq(t){var e=Pf(CO()),r=Pf(typeof t=="number"?t:Uh.now());return Sq(e,r)}function Kht(t){if(TO(t))return t;if(typeof t=="number")return t<CO()?bq(t):Pf(t);if(t instanceof Date)return Pf(t.getTime());throw TypeError("Invalid input type")}function Yne(t,e){var r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=yq),[r,n]}function Yht(t){var e=E2e,r=""+"0".repeat(e)+t[1]+"Z",n=r.substr(r.length-e-1),o=new Date(t[0]*1e3).toISOString();return o.replace("000Z",n)}function Qht(t){return t[0]*yq+t[1]}function Xht(t){return t[0]*1e3+t[1]/1e6}function _q(t){return t[0]*1e6+t[1]/1e3}function TO(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function xq(t){return TO(t)||typeof t=="number"||t instanceof Date}function Sq(t,e){var r=[t[0]+e[0],t[1]+e[1]];return r[1]>=yq&&(r[1]-=yq,r[0]+=1),r}var E2e,$ht,Wht,yq,w2e=D(()=>{Kne();E2e=9,$ht=6,Wht=Math.pow(10,$ht),yq=Math.pow(10,E2e)});var k2e=D(()=>{});var Iu,R2e=D(()=>{(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(Iu||(Iu={}))});var Jht,Qne,P2e=D(()=>{Ur();Jht=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Qne=function(){function t(e){e===void 0&&(e={});var r;this._propagators=(r=e.propagators)!==null&&r!==void 0?r:[],this._fields=Array.from(new Set(this._propagators.map(function(n){return typeof n.fields=="function"?n.fields():[]}).reduce(function(n,o){return n.concat(o)},[])))}return t.prototype.inject=function(e,r,n){var o,s;try{for(var a=Jht(this._propagators),c=a.next();!c.done;c=a.next()){var l=c.value;try{l.inject(e,r,n)}catch(u){Et.warn("Failed to inject with "+l.constructor.name+". Err: "+u.message)}}}catch(u){o={error:u}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(o)throw o.error}}},t.prototype.extract=function(e,r,n){return this._propagators.reduce(function(o,s){try{return s.extract(o,r,n)}catch(a){Et.warn("Failed to inject with "+s.constructor.name+". Err: "+a.message)}return o},e)},t.prototype.fields=function(){return this._fields.slice()},t}()});function A2e(t){return tgt.test(t)}function D2e(t){return rgt.test(t)&&!ngt.test(t)}var Xne,Zht,egt,tgt,rgt,ngt,N2e=D(()=>{Xne="[_0-9a-z-*/]",Zht="[a-z]"+Xne+"{0,255}",egt="[a-z0-9]"+Xne+"{0,240}@[a-z]"+Xne+"{0,13}",tgt=new RegExp("^(?:"+Zht+"|"+egt+")$"),rgt=/^[ -~]{0,255}[!-~]$/,ngt=/,|=/});var L2e,igt,O2e,M2e,Jne,Zne=D(()=>{N2e();L2e=32,igt=512,O2e=",",M2e="=",Jne=function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+M2e+e.get(n)),r},[]).join(O2e)},t.prototype._parse=function(e){e.length>igt||(this._internalState=e.split(O2e).reverse().reduce(function(r,n){var o=n.trim(),s=o.indexOf(M2e);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,n.length);A2e(a)&&D2e(c)&&r.set(a,c)}return r},new Map),this._internalState.size>L2e&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,L2e))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}()});function F2e(t){var e=ugt.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}var Iq,Cq,ogt,sgt,agt,cgt,lgt,ugt,eie,U2e=D(()=>{Ur();xO();Zne();Iq="traceparent",Cq="tracestate",ogt="00",sgt="(?!ff)[\\da-f]{2}",agt="(?![0]{32})[\\da-f]{32}",cgt="(?![0]{16})[\\da-f]{16}",lgt="[\\da-f]{2}",ugt=new RegExp("^\\s?("+sgt+")-("+agt+")-("+cgt+")-("+lgt+")(-.*)?\\s?$");eie=function(){function t(){}return t.prototype.inject=function(e,r,n){var o=Qo.getSpanContext(e);if(!(!o||eS(e)||!Su(o))){var s=ogt+"-"+o.traceId+"-"+o.spanId+"-0"+Number(o.traceFlags||io.NONE).toString(16);n.set(r,Iq,s),o.traceState&&n.set(r,Cq,o.traceState.serialize())}},t.prototype.extract=function(e,r,n){var o=n.get(r,Iq);if(!o)return e;var s=Array.isArray(o)?o[0]:o;if(typeof s!="string")return e;var a=F2e(s);if(!a)return e;a.isRemote=!0;var c=n.get(r,Cq);if(c){var l=Array.isArray(c)?c.join(","):c;a.traceState=new Jne(typeof l=="string"?l:void 0)}return Qo.setSpanContext(e,a)},t.prototype.fields=function(){return[Iq,Cq]},t}()});var B2e=D(()=>{});function dgt(t,e){return t.setValue(rie,e)}function pgt(t){return t.deleteValue(rie)}function fgt(t){return t.getValue(rie)}var rie,tie,q2e=D(()=>{Ur();rie=Rf("OpenTelemetry SDK Context Key RPC_METADATA");(function(t){t.HTTP="http"})(tie||(tie={}))});var Tq,nie=D(()=>{Ur();Tq=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Pc.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}()});var EO,iie=D(()=>{Ur();EO=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Pc.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}()});var mgt,j2e=D(()=>{Ur();qne();nie();iie();mgt=function(){function t(e){var r,n,o,s;this._root=e.root,this._root||(Ac(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new EO),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new EO,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new Tq,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new EO,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new Tq}return t.prototype.shouldSample=function(e,r,n,o,s,a){var c=Qo.getSpanContext(e);return!c||!Su(c)?this._root.shouldSample(e,r,n,o,s,a):c.isRemote?c.traceFlags&io.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,s,a):this._remoteParentNotSampled.shouldSample(e,r,n,o,s,a):c.traceFlags&io.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,s,a):this._localParentNotSampled.shouldSample(e,r,n,o,s,a)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}()});var hgt,V2e=D(()=>{Ur();hgt=function(){function t(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return t.prototype.shouldSample=function(e,r){return{decision:Zx(r)&&this._accumulate(r)<this._upperBound?Pc.RECORD_AND_SAMPLED:Pc.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},t.prototype._accumulate=function(e){for(var r=0,n=0;n<e.length/8;n++){var o=n*8,s=parseInt(e.slice(o,o+8),16);r=(r^s)>>>0}return r},t}()});function Sgt(t,e){return function(r){return t(e(r))}}function oie(t){if(!Igt(t)||Cgt(t)!==ggt)return!1;var e=xgt(t);if(e===null)return!0;var r=z2e.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&H2e.call(r)===_gt}function Igt(t){return t!=null&&typeof t=="object"}function Cgt(t){return t==null?t===void 0?ygt:vgt:rS&&rS in Object(t)?Tgt(t):Egt(t)}function Tgt(t){var e=z2e.call(t,rS),r=t[rS],n=!1;try{t[rS]=void 0,n=!0}catch{}var o=$2e.call(t);return n&&(e?t[rS]=r:delete t[rS]),o}function Egt(t){return $2e.call(t)}var ggt,vgt,ygt,bgt,H2e,_gt,xgt,G2e,z2e,rS,$2e,W2e=D(()=>{ggt="[object Object]",vgt="[object Null]",ygt="[object Undefined]",bgt=Function.prototype,H2e=bgt.toString,_gt=H2e.call(Object),xgt=Sgt(Object.getPrototypeOf,Object),G2e=Object.prototype,z2e=G2e.hasOwnProperty,rS=Symbol?Symbol.toStringTag:void 0,$2e=G2e.toString});function aie(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.shift(),n=new WeakMap;t.length>0;)r=Y2e(r,t.shift(),0,n);return r}function sie(t){return wq(t)?t.slice():t}function Y2e(t,e,r,n){r===void 0&&(r=0);var o;if(!(r>wgt)){if(r++,Eq(t)||Eq(e)||Q2e(e))o=sie(e);else if(wq(t)){if(o=t.slice(),wq(e))for(var s=0,a=e.length;s<a;s++)o.push(sie(e[s]));else if(wO(e))for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var l=c[s];o[l]=sie(e[l])}}else if(wO(t))if(wO(e)){if(!kgt(t,e))return e;o=Object.assign({},t);for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var l=c[s],u=e[l];if(Eq(u))typeof u>"u"?delete o[l]:o[l]=u;else{var d=o[l],p=u;if(K2e(t,l,n)||K2e(e,l,n))delete o[l];else{if(wO(d)&&wO(p)){var f=n.get(d)||[],m=n.get(p)||[];f.push({obj:t,key:l}),m.push({obj:e,key:l}),n.set(d,f),n.set(p,m)}o[l]=Y2e(o[l],u,r,n)}}}}else o=e;return o}}function K2e(t,e,r){for(var n=r.get(t[e])||[],o=0,s=n.length;o<s;o++){var a=n[o];if(a.key===e&&a.obj===t)return!0}return!1}function wq(t){return Array.isArray(t)}function Q2e(t){return typeof t=="function"}function wO(t){return!Eq(t)&&!wq(t)&&!Q2e(t)&&typeof t=="object"}function Eq(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function kgt(t,e){return!(!oie(t)||!oie(e))}var wgt,X2e=D(()=>{W2e();wgt=20});function Pgt(t,e){var r,n=new Promise(function(s,a){r=setTimeout(function(){a(new J2e("Operation timed out."))},e)});return Promise.race([t,n]).then(function(o){return clearTimeout(r),o},function(o){throw clearTimeout(r),o})}var Rgt,J2e,Z2e=D(()=>{Rgt=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),J2e=function(t){Rgt(e,t);function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return e}(Error)});function eDe(t,e){return typeof e=="string"?t===e:!!t.match(e)}function Dgt(t,e){var r,n;if(!e)return!1;try{for(var o=Agt(e),s=o.next();!s.done;s=o.next()){var a=s.value;if(eDe(t,a))return!0}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}var Agt,tDe=D(()=>{Agt=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});function Ngt(t){return typeof t=="function"&&typeof t.__original=="function"&&typeof t.__unwrap=="function"&&t.__wrapped===!0}var rDe=D(()=>{});var nDe,iDe=D(()=>{nDe=function(){function t(){var e=this;this._promise=new Promise(function(r,n){e._resolve=r,e._reject=n})}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),t.prototype.resolve=function(e){this._resolve(e)},t.prototype.reject=function(e){this._reject(e)},t}()});var Lgt,Ogt,kO,oDe=D(()=>{iDe();Lgt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Ogt=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},kO=function(){function t(e,r){this._callback=e,this._that=r,this._isCalled=!1,this._deferred=new nDe}return Object.defineProperty(t.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),t.prototype.call=function(){for(var e,r=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,Ogt([this._that],Lgt(n),!1))).then(function(s){return r._deferred.resolve(s)},function(s){return r._deferred.reject(s)})}catch(s){this._deferred.reject(s)}}return this._deferred.promise},t}()});function sDe(t,e){return new Promise(function(r){Ga.with(_O(Ga.active()),function(){t.export(e,function(n){r(n)})})})}var aDe=D(()=>{Ur();xO()});var cDe={};Pn(cDe,{AlwaysOffSampler:()=>Tq,AlwaysOnSampler:()=>EO,AnchoredClock:()=>iht,BindOnceFuture:()=>kO,CompositePropagator:()=>Qne,DEFAULT_ATTRIBUTE_COUNT_LIMIT:()=>kk,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:()=>wk,DEFAULT_ENVIRONMENT:()=>hq,DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:()=>a2e,DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:()=>c2e,ExportResultCode:()=>Iu,ParentBasedSampler:()=>mgt,RPCType:()=>tie,RandomIdGenerator:()=>wht,SDK_INFO:()=>IO,TRACE_PARENT_HEADER:()=>Iq,TRACE_STATE_HEADER:()=>Cq,TimeoutError:()=>J2e,TraceIdRatioBasedSampler:()=>hgt,TraceState:()=>Jne,TracesSamplerValues:()=>_l,VERSION:()=>Gne,W3CBaggagePropagator:()=>Fne,W3CTraceContextPropagator:()=>eie,_globalThis:()=>Sht,addHrTimes:()=>Sq,baggageUtils:()=>One,callWithTimeout:()=>Pgt,deleteRPCMetadata:()=>pgt,getEnv:()=>Xo,getEnvWithoutDefaults:()=>Vne,getRPCMetadata:()=>fgt,getTimeOrigin:()=>CO,globalErrorHandler:()=>Ac,hexToBase64:()=>Tht,hrTime:()=>bq,hrTimeDuration:()=>Yne,hrTimeToMicroseconds:()=>_q,hrTimeToMilliseconds:()=>Xht,hrTimeToNanoseconds:()=>Qht,hrTimeToTimeStamp:()=>Yht,internal:()=>cie,isAttributeKey:()=>t2e,isAttributeValue:()=>mq,isTimeInput:()=>xq,isTimeInputHrTime:()=>TO,isTracingSuppressed:()=>eS,isUrlIgnored:()=>Dgt,isWrapped:()=>Ngt,loggingErrorHandler:()=>Une,merge:()=>aie,millisToHrTime:()=>Pf,otperformance:()=>Uh,parseEnvironment:()=>SO,parseTraceParent:()=>F2e,sanitizeAttributes:()=>tS,setGlobalErrorHandler:()=>lht,setRPCMetadata:()=>dgt,suppressTracing:()=>_O,timeInputToHrTime:()=>Kht,unrefTimer:()=>Wne,unsuppressTracing:()=>tht,urlMatches:()=>eDe});var cie,za=D(()=>{JAe();ZAe();n2e();qne();Bne();w2e();k2e();R2e();vq();Mne();Kne();P2e();U2e();B2e();q2e();nie();iie();j2e();V2e();xO();Zne();Hne();X2e();jne();Z2e();tDe();rDe();oDe();vq();aDe();cie={_export:sDe}});var lDe,uDe=D(()=>{lDe="exception"});var Mgt,Fgt,lie,uie=D(()=>{Ur();za();Bd();uDe();Mgt=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Fgt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},lie=function(){function t(e,r,n,o,s,a,c,l,u){c===void 0&&(c=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:Ck.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=o,this.parentSpanId=a,this.kind=s,this.links=c;var d=Date.now();this._performanceStartTime=Uh.now(),this._performanceOffset=d-(this._performanceStartTime+CO()),this._startTimeProvided=l!=null,this.startTime=this._getTime(l??d),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,r),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return r==null||this._isSpanEnded()?this:e.length===0?(Et.warn("Invalid attribute key: "+e),this):mq(r)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(r),this):(Et.warn("Invalid attribute value set for key: "+e),this)},t.prototype.setAttributes=function(e){var r,n;try{for(var o=Mgt(Object.entries(e)),s=o.next();!s.done;s=o.next()){var a=Fgt(s.value,2),c=a[0],l=a[1];this.setAttribute(c,l)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this},t.prototype.addEvent=function(e,r,n){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return Et.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(Et.warn("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),xq(r)&&(xq(n)||(n=r),r=void 0);var o=tS(r);return this.events.push({name:e,attributes:o,time:this._getTime(n),droppedAttributesCount:0}),this},t.prototype.setStatus=function(e){return this._isSpanEnded()?this:(this.status=e,this)},t.prototype.updateName=function(e){return this._isSpanEnded()?this:(this.name=e,this)},t.prototype.end=function(e){if(this._isSpanEnded()){Et.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once.");return}this._ended=!0,this.endTime=this._getTime(e),this._duration=Yne(this.startTime,this.endTime),this._duration[0]<0&&(Et.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this)},t.prototype._getTime=function(e){if(typeof e=="number"&&e<Uh.now())return bq(e+this._performanceOffset);if(typeof e=="number")return Pf(e);if(e instanceof Date)return Pf(e.getTime());if(TO(e))return e;if(this._startTimeProvided)return Pf(Date.now());var r=Uh.now()-this._performanceStartTime;return Sq(this.startTime,Pf(r))},t.prototype.isRecording=function(){return this._ended===!1},t.prototype.recordException=function(e,r){var n={};typeof e=="string"?n[Bh.EXCEPTION_MESSAGE]=e:e&&(e.code?n[Bh.EXCEPTION_TYPE]=e.code.toString():e.name&&(n[Bh.EXCEPTION_TYPE]=e.name),e.message&&(n[Bh.EXCEPTION_MESSAGE]=e.message),e.stack&&(n[Bh.EXCEPTION_STACKTRACE]=e.stack)),n[Bh.EXCEPTION_TYPE]||n[Bh.EXCEPTION_MESSAGE]?this.addEvent(lDe,n,r):Et.warn("Failed to record an exception "+e)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),t.prototype._isSpanEnded=function(){return this._ended&&Et.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},t.prototype._truncateToLimitUtil=function(e,r){return e.length<=r?e:e.substr(0,r)},t.prototype._truncateToSize=function(e){var r=this,n=this._attributeValueLengthLimit;return n<=0?(Et.warn("Attribute value limit must be positive, got "+n),e):typeof e=="string"?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map(function(o){return typeof o=="string"?r._truncateToLimitUtil(o,n):o}):e},t}()});var Af,RO=D(()=>{(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Af||(Af={}))});var nS,kq=D(()=>{RO();nS=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Af.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}()});var qh,Rq=D(()=>{RO();qh=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Af.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}()});var PO,die=D(()=>{Ur();za();kq();Rq();PO=function(){function t(e){var r,n,o,s;this._root=e.root,this._root||(Ac(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new qh),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new qh,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new nS,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new qh,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new nS}return t.prototype.shouldSample=function(e,r,n,o,s,a){var c=Qo.getSpanContext(e);return!c||!Su(c)?this._root.shouldSample(e,r,n,o,s,a):c.isRemote?c.traceFlags&io.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,s,a):this._remoteParentNotSampled.shouldSample(e,r,n,o,s,a):c.traceFlags&io.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,s,a):this._localParentNotSampled.shouldSample(e,r,n,o,s,a)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}()});var Pq,pie=D(()=>{Ur();RO();Pq=function(){function t(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return t.prototype.shouldSample=function(e,r){return{decision:Zx(r)&&this._accumulate(r)<this._upperBound?Af.RECORD_AND_SAMPLED:Af.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},t.prototype._accumulate=function(e){for(var r=0,n=0;n<e.length/8;n++){var o=n*8,s=parseInt(e.slice(o,o+8),16);r=(r^s)>>>0}return r},t}()});function Aq(){return{sampler:fie(Ugt),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:Xo().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:Xo().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:Xo().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:Xo().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:Xo().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:Xo().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:Xo().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:Xo().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function fie(t){switch(t===void 0&&(t=Xo()),t.OTEL_TRACES_SAMPLER){case _l.AlwaysOn:return new qh;case _l.AlwaysOff:return new nS;case _l.ParentBasedAlwaysOn:return new PO({root:new qh});case _l.ParentBasedAlwaysOff:return new PO({root:new nS});case _l.TraceIdRatio:return new Pq(dDe(t));case _l.ParentBasedTraceIdRatio:return new PO({root:new Pq(dDe(t))});default:return Et.error('OTEL_TRACES_SAMPLER value "'+t.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+Bgt+'".'),new qh}}function dDe(t){if(t.OTEL_TRACES_SAMPLER_ARG===void 0||t.OTEL_TRACES_SAMPLER_ARG==="")return Et.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+Pk+"."),Pk;var e=Number(t.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(Et.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+Pk+"."),Pk):e<0||e>1?(Et.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+Pk+"."),Pk):e}var Ugt,Bgt,Pk,mie=D(()=>{Ur();za();kq();Rq();die();pie();Ugt=Xo(),Bgt=_l.AlwaysOn,Pk=1});function pDe(t){var e={sampler:fie()},r=Aq(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}function fDe(t){var e,r,n,o,s,a,c,l,u,d,p,f,m=Object.assign({},t.spanLimits),h=Vne();return m.attributeCountLimit=(a=(s=(o=(r=(e=t.spanLimits)===null||e===void 0?void 0:e.attributeCountLimit)!==null&&r!==void 0?r:(n=t.generalLimits)===null||n===void 0?void 0:n.attributeCountLimit)!==null&&o!==void 0?o:h.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&s!==void 0?s:h.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&a!==void 0?a:kk,m.attributeValueLengthLimit=(f=(p=(d=(l=(c=t.spanLimits)===null||c===void 0?void 0:c.attributeValueLengthLimit)!==null&&l!==void 0?l:(u=t.generalLimits)===null||u===void 0?void 0:u.attributeValueLengthLimit)!==null&&d!==void 0?d:h.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&p!==void 0?p:h.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&f!==void 0?f:wk,Object.assign({},t,{spanLimits:m})}var hie=D(()=>{mie();za()});var mDe,hDe=D(()=>{Ur();za();mDe=function(){function t(e,r){this._exporter=e,this._finishedSpans=[],this._droppedSpansCount=0;var n=Xo();this._maxExportBatchSize=typeof r?.maxExportBatchSize=="number"?r.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof r?.maxQueueSize=="number"?r.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof r?.scheduledDelayMillis=="number"?r.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof r?.exportTimeoutMillis=="number"?r.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new kO(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Et.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return t.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){this._shutdownOnce.isCalled||e.spanContext().traceFlags&io.SAMPLED&&this._addToBuffer(e)},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){var e=this;return Promise.resolve().then(function(){return e.onShutdown()}).then(function(){return e._flushAll()}).then(function(){return e._exporter.shutdown()})},t.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&Et.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(Et.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},t.prototype._flushAll=function(){var e=this;return new Promise(function(r,n){for(var o=[],s=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize),a=0,c=s;a<c;a++)o.push(e._flushOneBatch());Promise.all(o).then(function(){r()}).catch(n)})},t.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise(function(r,n){var o=setTimeout(function(){n(new Error("Timeout"))},e._exportTimeoutMillis);Ga.with(_O(Ga.active()),function(){var s=e._finishedSpans.splice(0,e._maxExportBatchSize),a=function(){return e._exporter.export(s,function(l){var u;clearTimeout(o),l.code===Iu.SUCCESS?r():n((u=l.error)!==null&&u!==void 0?u:new Error("BatchSpanProcessor: span export failed"))})},c=s.map(function(l){return l.resource}).filter(function(l){return l.asyncAttributesPending});c.length===0?a():Promise.all(c.map(function(l){var u;return(u=l.waitForAsyncAttributes)===null||u===void 0?void 0:u.call(l)})).then(a,function(l){Ac(l),n(l)})})})},t.prototype._maybeStartTimer=function(){var e=this;this._timer===void 0&&(this._timer=setTimeout(function(){e._flushOneBatch().then(function(){e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())}).catch(function(r){Ac(r)})},this._scheduledDelayMillis),Wne(this._timer))},t.prototype._clearTimer=function(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)},t}()});var qgt,gie,gDe=D(()=>{hDe();qgt=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),gie=function(t){qgt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.onShutdown=function(){},e}(mDe)});function vDe(t){return function(){for(var r=0;r<t/4;r++)Dq.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,r*4);for(var r=0;r<t&&!(Dq[r]>0);r++)r===t-1&&(Dq[t-1]=1);return Dq.toString("hex",0,t)}}var jgt,yDe,vie,Dq,bDe=D(()=>{jgt=8,yDe=16,vie=function(){function t(){this.generateTraceId=vDe(yDe),this.generateSpanId=vDe(jgt)}return t}(),Dq=Buffer.allocUnsafe(yDe)});var _De=D(()=>{gDe();bDe()});var Nq=D(()=>{_De()});var yie,xDe=D(()=>{Ur();za();uie();hie();Nq();yie=function(){function t(e,r,n){this._tracerProvider=n;var o=pDe(r);this._sampler=o.sampler,this._generalLimits=o.generalLimits,this._spanLimits=o.spanLimits,this._idGenerator=r.idGenerator||new vie,this.resource=n.resource,this.instrumentationLibrary=e}return t.prototype.startSpan=function(e,r,n){var o,s,a;r===void 0&&(r={}),n===void 0&&(n=Ga.active()),r.root&&(n=Qo.deleteSpan(n));var c=Qo.getSpan(n);if(eS(n)){Et.debug("Instrumentation suppressed, returning Noop Span");var l=Qo.wrapSpanContext(Sk);return l}var u=c?.spanContext(),d=this._idGenerator.generateSpanId(),p,f,m;!u||!Qo.isSpanContextValid(u)?p=this._idGenerator.generateTraceId():(p=u.traceId,f=u.traceState,m=u.spanId);var h=(o=r.kind)!==null&&o!==void 0?o:Ik.INTERNAL,g=((s=r.links)!==null&&s!==void 0?s:[]).map(function(w){return{context:w.context,attributes:tS(w.attributes)}}),v=tS(r.attributes),b=this._sampler.shouldSample(n,p,e,h,v,g);f=(a=b.traceState)!==null&&a!==void 0?a:f;var _=b.decision===Pc.RECORD_AND_SAMPLED?io.SAMPLED:io.NONE,x={traceId:p,spanId:d,traceFlags:_,traceState:f};if(b.decision===Pc.NOT_RECORD){Et.debug("Recording is off, propagating context in a non-recording span");var l=Qo.wrapSpanContext(x);return l}var S=new lie(this,n,e,x,h,m,g,r.startTime),I=tS(Object.assign(v,b.attributes));return S.setAttributes(I),S},t.prototype.startActiveSpan=function(e,r,n,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=r:arguments.length===3?(s=r,c=n):(s=r,a=n,c=o);var l=a??Ga.active(),u=this.startSpan(e,s,l),d=Qo.setSpan(l,u);return Ga.with(d,c,void 0,u)}},t.prototype.getGeneralLimits=function(){return this._generalLimits},t.prototype.getSpanLimits=function(){return this._spanLimits},t.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},t}()});function SDe(){return"unknown_service:"+process.argv0}var IDe=D(()=>{});var CDe,TDe,bie=D(()=>{CDe=function(t){switch(t){case"arm":return"arm32";case"ppc":return"ppc32";case"x64":return"amd64";default:return t}},TDe=function(t){switch(t){case"sunos":return"solaris";case"win32":return"windows";default:return t}}});var EDe,wDe,Ak,Lq=D(()=>{EDe=q(require("child_process")),wDe=q(require("util")),Ak=wDe.promisify(EDe.exec)});var kDe={};Pn(kDe,{getMachineId:()=>Ggt});function Ggt(){return Vgt(this,void 0,void 0,function(){var t,e,r,n;return Hgt(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Ak('ioreg -rd1 -c "IOPlatformExpertDevice"')];case 1:return t=o.sent(),e=t.stdout.split(`
`).find(function(s){return s.includes("IOPlatformUUID")}),e?(r=e.split('" = "'),r.length===2?[2,r[1].slice(0,-1)]:[3,3]):[2,""];case 2:return n=o.sent(),Et.debug("error reading machine id: "+n),[3,3];case 3:return[2,""]}})})}var Vgt,Hgt,RDe=D(()=>{Lq();Ur();Vgt=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},Hgt=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var ADe={};Pn(ADe,{getMachineId:()=>Kgt});function Kgt(){return zgt(this,void 0,void 0,function(){var t,e,r,n,o,s,a,c,l;return $gt(this,function(u){switch(u.label){case 0:t=["/etc/machine-id","/var/lib/dbus/machine-id"],u.label=1;case 1:u.trys.push([1,8,9,10]),e=Wgt(t),r=e.next(),u.label=2;case 2:if(r.done)return[3,7];n=r.value,u.label=3;case 3:return u.trys.push([3,5,,6]),[4,PDe.promises.readFile(n,{encoding:"utf8"})];case 4:return o=u.sent(),[2,o.trim()];case 5:return s=u.sent(),Et.debug("error reading machine id: "+s),[3,6];case 6:return r=e.next(),[3,2];case 7:return[3,10];case 8:return a=u.sent(),c={error:a},[3,10];case 9:try{r&&!r.done&&(l=e.return)&&l.call(e)}finally{if(c)throw c.error}return[7];case 10:return[2,""]}})})}var PDe,zgt,$gt,Wgt,DDe=D(()=>{PDe=require("fs");Ur();zgt=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},$gt=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Wgt=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});var LDe={};Pn(LDe,{getMachineId:()=>Xgt});function Xgt(){return Ygt(this,void 0,void 0,function(){var e,t,e,r;return Qgt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,NDe.promises.readFile("/etc/hostid",{encoding:"utf8"})];case 1:return e=n.sent(),[2,e.trim()];case 2:return t=n.sent(),Et.debug("error reading machine id: "+t),[3,3];case 3:return n.trys.push([3,5,,6]),[4,Ak("kenv -q smbios.system.uuid")];case 4:return e=n.sent(),[2,e.stdout.trim()];case 5:return r=n.sent(),Et.debug("error reading machine id: "+r),[3,6];case 6:return[2,""]}})})}var NDe,Ygt,Qgt,ODe=D(()=>{NDe=require("fs");Lq();Ur();Ygt=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},Qgt=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var MDe={};Pn(MDe,{getMachineId:()=>evt});function evt(){return Jgt(this,void 0,void 0,function(){var t,e,r,n,o;return Zgt(this,function(s){switch(s.label){case 0:t="QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",e="%windir%\\System32\\REG.exe",Oq.arch==="ia32"&&"PROCESSOR_ARCHITEW6432"in Oq.env&&(e="%windir%\\sysnative\\cmd.exe /c "+e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Ak(e+" "+t)];case 2:return r=s.sent(),n=r.stdout.split("REG_SZ"),n.length===2?[2,n[1].trim()]:[3,4];case 3:return o=s.sent(),Et.debug("error reading machine id: "+o),[3,4];case 4:return[2,""]}})})}var Oq,Jgt,Zgt,FDe=D(()=>{Oq=q(require("process"));Lq();Ur();Jgt=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},Zgt=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var UDe={};Pn(UDe,{getMachineId:()=>nvt});function nvt(){return tvt(this,void 0,void 0,function(){return rvt(this,function(t){return Et.debug("could not read machine-id: unsupported platform"),[2,""]})})}var tvt,rvt,BDe=D(()=>{Ur();tvt=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},rvt=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var qDe,iS,jDe=D(()=>{qDe=q(require("process"));switch(qDe.platform){case"darwin":iS=(RDe(),fo(kDe)).getMachineId;break;case"linux":iS=(DDe(),fo(ADe)).getMachineId;break;case"freebsd":iS=(ODe(),fo(LDe)).getMachineId;break;case"win32":iS=(FDe(),fo(MDe)).getMachineId;break;default:iS=(BDe(),fo(UDe)).getMachineId}});var Mq,ivt,VDe,_ie=D(()=>{Bd();Dk();Mq=require("os");bie();jDe();ivt=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[Ir.HOST_NAME]=(0,Mq.hostname)(),r[Ir.HOST_ARCH]=CDe((0,Mq.arch)()),r);return new $a(n,this._getAsyncAttributes())},t.prototype._getAsyncAttributes=function(){return iS().then(function(e){var r={};return e&&(r[Ir.HOST_ID]=e),r})},t}(),VDe=new ivt});var ovt,qKr,HDe=D(()=>{_ie();ovt=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(VDe.detect(e))},t}(),qKr=new ovt});var Fq,svt,GDe,xie=D(()=>{Bd();Dk();Fq=require("os");bie();svt=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[Ir.OS_TYPE]=TDe((0,Fq.platform)()),r[Ir.OS_VERSION]=(0,Fq.release)(),r);return new $a(n)},t}(),GDe=new svt});var avt,WKr,zDe=D(()=>{xie();avt=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(GDe.detect(e))},t}(),WKr=new avt});var KDe,$De,WDe,cvt,YDe,Sie=D(()=>{Ur();Bd();Dk();KDe=q(require("os")),$De=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},WDe=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},cvt=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[Ir.PROCESS_PID]=process.pid,r[Ir.PROCESS_EXECUTABLE_NAME]=process.title,r[Ir.PROCESS_EXECUTABLE_PATH]=process.execPath,r[Ir.PROCESS_COMMAND_ARGS]=WDe(WDe([process.argv[0]],$De(process.execArgv),!1),$De(process.argv.slice(1)),!1),r[Ir.PROCESS_RUNTIME_VERSION]=process.versions.node,r[Ir.PROCESS_RUNTIME_NAME]="nodejs",r[Ir.PROCESS_RUNTIME_DESCRIPTION]="Node.js",r);process.argv.length>1&&(n[Ir.PROCESS_COMMAND]=process.argv[1]);try{var o=KDe.userInfo();n[Ir.PROCESS_OWNER]=o.username}catch(s){Et.debug("error obtaining process owner: "+s)}return new $a(n)},t}(),YDe=new cvt});var lvt,eYr,QDe=D(()=>{Sie();lvt=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(YDe.detect(e))},t}(),eYr=new lvt});var XDe=D(()=>{IDe();HDe();zDe();_ie();xie();QDe();Sie()});var Iie=D(()=>{XDe()});var Iy,uvt,dvt,pvt,$a,Dk=D(()=>{Ur();Bd();za();Iie();Iy=function(){return Iy=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Iy.apply(this,arguments)},uvt=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},dvt=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},pvt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},$a=function(){function t(e,r){var n=this,o;this._attributes=e,this.asyncAttributesPending=r!=null,this._syncAttributes=(o=this._attributes)!==null&&o!==void 0?o:{},this._asyncAttributesPromise=r?.then(function(s){return n._attributes=Object.assign({},n._attributes,s),n.asyncAttributesPending=!1,s},function(s){return Et.debug("a resource's async attributes promise rejected: %s",s),n.asyncAttributesPending=!1,{}})}return t.empty=function(){return t.EMPTY},t.default=function(){var e;return new t((e={},e[Ir.SERVICE_NAME]=SDe(),e[Ir.TELEMETRY_SDK_LANGUAGE]=IO[Ir.TELEMETRY_SDK_LANGUAGE],e[Ir.TELEMETRY_SDK_NAME]=IO[Ir.TELEMETRY_SDK_NAME],e[Ir.TELEMETRY_SDK_VERSION]=IO[Ir.TELEMETRY_SDK_VERSION],e))},Object.defineProperty(t.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&Et.error("Accessing resource attributes before async attributes settled"),(e=this._attributes)!==null&&e!==void 0?e:{}},enumerable:!1,configurable:!0}),t.prototype.waitForAsyncAttributes=function(){return uvt(this,void 0,void 0,function(){return dvt(this,function(e){switch(e.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.merge=function(e){var r=this,n;if(!e)return this;var o=Iy(Iy({},this._syncAttributes),(n=e._syncAttributes)!==null&&n!==void 0?n:e.attributes);if(!this._asyncAttributesPromise&&!e._asyncAttributesPromise)return new t(o);var s=Promise.all([this._asyncAttributesPromise,e._asyncAttributesPromise]).then(function(a){var c,l=pvt(a,2),u=l[0],d=l[1];return Iy(Iy(Iy(Iy({},r._syncAttributes),u),(c=e._syncAttributes)!==null&&c!==void 0?c:e.attributes),d)});return new t(o,s)},t.EMPTY=new t({}),t}()});var JDe=D(()=>{});var ZDe=D(()=>{});var eNe=D(()=>{});var fvt,yYr,tNe=D(()=>{Uq();fvt=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(rNe.detect(e))},t}(),yYr=new fvt});var mvt,hvt,gvt,nNe,Cie=D(()=>{Ur();za();Bd();Dk();mvt=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},hvt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},gvt=function(){function t(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}return t.prototype.detect=function(e){var r={},n=Xo(),o=n.OTEL_RESOURCE_ATTRIBUTES,s=n.OTEL_SERVICE_NAME;if(o)try{var a=this._parseResourceAttributes(o);Object.assign(r,a)}catch(c){Et.debug("EnvDetector failed: "+c.message)}return s&&(r[Ir.SERVICE_NAME]=s),new $a(r)},t.prototype._parseResourceAttributes=function(e){var r,n;if(!e)return{};var o={},s=e.split(this._COMMA_SEPARATOR,-1);try{for(var a=mvt(s),c=a.next();!c.done;c=a.next()){var l=c.value,u=l.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(u.length===2){var d=hvt(u,2),p=d[0],f=d[1];if(p=p.trim(),f=f.trim().split(/^"|"$/).join(""),!this._isValidAndNotEmpty(p))throw new Error("Attribute key "+this._ERROR_MESSAGE_INVALID_CHARS);if(!this._isValid(f))throw new Error("Attribute value "+this._ERROR_MESSAGE_INVALID_VALUE);o[p]=decodeURIComponent(f)}}}catch(m){r={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},t.prototype._isValid=function(e){return e.length<=this._MAX_LENGTH&&this._isBaggageOctetString(e)},t.prototype._isBaggageOctetString=function(e){for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n<33||n===44||n===59||n===92||n>126)return!1}return!0},t.prototype._isValidAndNotEmpty=function(e){return e.length>0&&this._isValid(e)},t}(),nNe=new gvt});var vvt,EYr,iNe=D(()=>{Cie();vvt=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(nNe.detect(e))},t}(),EYr=new vvt});var Tie,yvt,rNe,oNe=D(()=>{Bd();Uq();Ur();Tie=function(){return Tie=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Tie.apply(this,arguments)},yvt=function(){function t(){}return t.prototype.detect=function(e){var r,n=typeof navigator<"u";if(!n)return $a.empty();var o=(r={},r[Ir.PROCESS_RUNTIME_NAME]="browser",r[Ir.PROCESS_RUNTIME_DESCRIPTION]="Web Browser",r[Ir.PROCESS_RUNTIME_VERSION]=navigator.userAgent,r);return this._getResourceAttributes(o,e)},t.prototype._getResourceAttributes=function(e,r){return e[Ir.PROCESS_RUNTIME_VERSION]===""?(Et.debug("BrowserDetector failed: Unable to find required browser resources. "),$a.empty()):new $a(Tie({},e))},t}(),rNe=new yvt});var sNe=D(()=>{tNe();iNe();oNe();Cie()});var aNe=D(()=>{});var Uq=D(()=>{Dk();JDe();Iie();ZDe();eNe();sNe();aNe()});var Bq,cNe,lNe=D(()=>{za();Bq=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},cNe=function(){function t(e){this._spanProcessors=e}return t.prototype.forceFlush=function(){var e,r,n=[];try{for(var o=Bq(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;n.push(a.forceFlush())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return new Promise(function(c){Promise.all(n).then(function(){c()}).catch(function(l){Ac(l||new Error("MultiSpanProcessor: forceFlush failed")),c()})})},t.prototype.onStart=function(e,r){var n,o;try{for(var s=Bq(this._spanProcessors),a=s.next();!a.done;a=s.next()){var c=a.value;c.onStart(e,r)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},t.prototype.onEnd=function(e){var r,n;try{for(var o=Bq(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;a.onEnd(e)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},t.prototype.shutdown=function(){var e,r,n=[];try{for(var o=Bq(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;n.push(a.shutdown())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return new Promise(function(c,l){Promise.all(n).then(function(){c()},l)})},t}()});var Eie,wie=D(()=>{Eie=function(){function t(){}return t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve()},t}()});var Cy,bvt,uNe=D(()=>{Ur();za();Uq();kie();mie();lNe();wie();Nq();hie();(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(Cy||(Cy={}));bvt=function(){function t(e){e===void 0&&(e={});var r;this._registeredSpanProcessors=[],this._tracers=new Map;var n=aie({},Aq(),fDe(e));this.resource=(r=n.resource)!==null&&r!==void 0?r:$a.empty(),this.resource=$a.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var o=this._buildExporterFromEnv();if(o!==void 0){var s=new gie(o);this.activeSpanProcessor=s}else this.activeSpanProcessor=new Eie}return t.prototype.getTracer=function(e,r,n){var o=e+"@"+(r||"")+":"+(n?.schemaUrl||"");return this._tracers.has(o)||this._tracers.set(o,new yie({name:e,version:r,schemaUrl:n?.schemaUrl},this._config,this)),this._tracers.get(o)},t.prototype.addSpanProcessor=function(e){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(function(r){return Et.error("Error while trying to shutdown current span processor",r)}),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new cNe(this._registeredSpanProcessors)},t.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},t.prototype.register=function(e){e===void 0&&(e={}),Qo.setGlobalTracerProvider(this),e.propagator===void 0&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&Ga.setGlobalContextManager(e.contextManager),e.propagator&&Fh.setGlobalPropagator(e.propagator)},t.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map(function(n){return new Promise(function(o){var s,a=setTimeout(function(){o(new Error("Span processor did not completed within timeout period of "+e+" ms")),s=Cy.timeout},e);n.forceFlush().then(function(){clearTimeout(a),s!==Cy.timeout&&(s=Cy.resolved,o(s))}).catch(function(c){clearTimeout(a),s=Cy.error,o(c)})})});return new Promise(function(n,o){Promise.all(r).then(function(s){var a=s.filter(function(c){return c!==Cy.resolved});a.length>0?o(a):n()}).catch(function(s){return o([s])})})},t.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},t.prototype._getPropagator=function(e){var r;return(r=this.constructor._registeredPropagators.get(e))===null||r===void 0?void 0:r()},t.prototype._getSpanExporter=function(e){var r;return(r=this.constructor._registeredExporters.get(e))===null||r===void 0?void 0:r()},t.prototype._buildPropagatorFromEnv=function(){var e=this,r=Array.from(new Set(Xo().OTEL_PROPAGATORS)),n=r.map(function(s){var a=e._getPropagator(s);return a||Et.warn('Propagator "'+s+'" requested through environment variable is unavailable.'),a}),o=n.reduce(function(s,a){return a&&s.push(a),s},[]);if(o.length!==0)return r.length===1?o[0]:new Qne({propagators:o})},t.prototype._buildExporterFromEnv=function(){var e=Xo().OTEL_TRACES_EXPORTER;if(!(e==="none"||e==="")){var r=this._getSpanExporter(e);return r||Et.error('Exporter "'+e+'" requested through environment variable is unavailable.'),r}},t._registeredPropagators=new Map([["tracecontext",function(){return new eie}],["baggage",function(){return new Fne}]]),t._registeredExporters=new Map,t}()});var _vt,xvt,dNe=D(()=>{za();_vt=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xvt=function(){function t(){}return t.prototype.export=function(e,r){return this._sendSpans(e,r)},t.prototype.shutdown=function(){return this._sendSpans([]),this.forceFlush()},t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype._exportInfo=function(e){var r;return{traceId:e.spanContext().traceId,parentId:e.parentSpanId,traceState:(r=e.spanContext().traceState)===null||r===void 0?void 0:r.serialize(),name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:_q(e.startTime),duration:_q(e.duration),attributes:e.attributes,status:e.status,events:e.events,links:e.links}},t.prototype._sendSpans=function(e,r){var n,o;try{for(var s=_vt(e),a=s.next();!a.done;a=s.next()){var c=a.value;console.dir(this._exportInfo(c),{depth:3})}}catch(l){n={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}if(r)return r({code:Iu.SUCCESS})},t}()});var Svt,Ivt,Cvt,pNe=D(()=>{za();Svt=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Ivt=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Cvt=function(){function t(){this._finishedSpans=[],this._stopped=!1}return t.prototype.export=function(e,r){var n;if(this._stopped)return r({code:Iu.FAILED,error:new Error("Exporter has been stopped")});(n=this._finishedSpans).push.apply(n,Ivt([],Svt(e),!1)),setTimeout(function(){return r({code:Iu.SUCCESS})},0)},t.prototype.shutdown=function(){return this._stopped=!0,this._finishedSpans=[],this.forceFlush()},t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.reset=function(){this._finishedSpans=[]},t.prototype.getFinishedSpans=function(){return this._finishedSpans},t}()});var fNe=D(()=>{});var Tvt,Evt,wvt,mNe=D(()=>{Ur();za();Tvt=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},Evt=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},wvt=function(){function t(e){this._exporter=e,this._shutdownOnce=new kO(this._shutdown,this),this._unresolvedExports=new Set}return t.prototype.forceFlush=function(){return Tvt(this,void 0,void 0,function(){return Evt(this,function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._unresolvedExports))];case 1:return e.sent(),this._exporter.forceFlush?[4,this._exporter.forceFlush()]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){var r=this,n,o;if(!this._shutdownOnce.isCalled&&e.spanContext().traceFlags&io.SAMPLED){var s=function(){return cie._export(r._exporter,[e]).then(function(c){var l;c.code!==Iu.SUCCESS&&Ac((l=c.error)!==null&&l!==void 0?l:new Error("SimpleSpanProcessor: span export failed (status "+c+")"))}).catch(function(c){Ac(c)})};if(e.resource.asyncAttributesPending){var a=(o=(n=e.resource).waitForAsyncAttributes)===null||o===void 0?void 0:o.call(n).then(function(){return a!=null&&r._unresolvedExports.delete(a),s()},function(c){return Ac(c)});a!=null&&this._unresolvedExports.add(a)}else s()}},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){return this._exporter.shutdown()},t}()});var hNe=D(()=>{});var gNe=D(()=>{});var vNe=D(()=>{});var yNe=D(()=>{});var bNe=D(()=>{});var _Ne={};Pn(_Ne,{AlwaysOffSampler:()=>nS,AlwaysOnSampler:()=>qh,BasicTracerProvider:()=>bvt,BatchSpanProcessor:()=>gie,ConsoleSpanExporter:()=>xvt,ForceFlushState:()=>Cy,InMemorySpanExporter:()=>Cvt,NoopSpanProcessor:()=>Eie,ParentBasedSampler:()=>PO,RandomIdGenerator:()=>vie,SamplingDecision:()=>Af,SimpleSpanProcessor:()=>wvt,Span:()=>lie,TraceIdRatioBasedSampler:()=>Pq,Tracer:()=>yie});var kie=D(()=>{xDe();uNe();Nq();dNe();pNe();fNe();mNe();hNe();wie();kq();Rq();die();pie();RO();uie();gNe();vNe();yNe();bNe()});var SNe=R(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.enable=Cu.azureCoreTracing=Cu.AzureMonitorSymbol=void 0;var Rie=Gi();Cu.AzureMonitorSymbol="Azure_Monitor_Tracer";var Pie="azure-coretracing",xNe=!1,kvt=function(t){if(xNe)return t;try{var e=(kie(),fo(_Ne)),r=(Ur(),fo(Tk)),n=new e.BasicTracerProvider,o=n.getTracer("applicationinsights tracer");if(t.setTracer){var s=t.setTracer;t.setTracer=function(u){var d=u.startSpan;u.startSpan=function(p,f,m){var h=d.call(this,p,f,m),g=h.end;return h.end=function(){var v=g.apply(this,arguments);return Rie.channel.publish(Pie,h),v},h},u[Cu.AzureMonitorSymbol]=!0,s.call(this,u)},r.trace.getSpan(r.context.active()),t.setTracer(o)}else{var a=r.trace.setGlobalTracerProvider;r.trace.setGlobalTracerProvider=function(u){var d=u.getTracer;return u.getTracer=function(p,f){var m=d.call(this,p,f);if(!m[Cu.AzureMonitorSymbol]){var h=m.startSpan;m.startSpan=function(g,v,b){var _=h.call(this,g,v,b),x=_.end;return _.end=function(){var S=x.apply(this,arguments);return Rie.channel.publish(Pie,_),S},_},m[Cu.AzureMonitorSymbol]=!0}return m},a.call(this,u)},n.register(),r.trace.getSpan(r.context.active());var c=require("@opentelemetry/instrumentation"),l=require("@azure/opentelemetry-instrumentation-azure-sdk");c.registerInstrumentations({instrumentations:[l.createAzureSdkInstrumentation()]})}xNe=!0}catch{}return t};Cu.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:kvt,publisherName:Pie};function Rvt(){Rie.channel.registerMonkeyPatch("@azure/core-tracing",Cu.azureCoreTracing)}Cu.enable=Rvt});var CNe=R(oS=>{"use strict";Object.defineProperty(oS,"__esModule",{value:!0});oS.enable=oS.bunyan=void 0;var INe=Gi(),Pvt=function(t){var e=t.prototype._emit;return t.prototype._emit=function(r,n){var o=e.apply(this,arguments);if(!n){var s=o;s||(s=e.call(this,r,!0)),INe.channel.publish("bunyan",{level:r.level,result:s})}return o},t};oS.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:Pvt};function Avt(){INe.channel.registerMonkeyPatch("bunyan",oS.bunyan)}oS.enable=Avt});var ENe=R(sS=>{"use strict";Object.defineProperty(sS,"__esModule",{value:!0});sS.enable=sS.console=void 0;var Aie=Gi(),TNe=require("stream"),Dvt=function(t){var e=new TNe.Writable,r=new TNe.Writable;e.write=function(u){if(!u)return!0;var d=u.toString();return Aie.channel.publish("console",{message:d}),!0},r.write=function(u){if(!u)return!0;var d=u.toString();return Aie.channel.publish("console",{message:d,stderr:!0}),!0};for(var n=new t.Console(e,r),o=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(u){var d=t[u];d&&(t[u]=function(){if(n[u])try{n[u].apply(n,arguments)}catch{}return d.apply(t,arguments)})},a=0,c=o;a<c.length;a++){var l=c[a];s(l)}return t};sS.console={versionSpecifier:">= 4.0.0",patch:Dvt};function Nvt(){Aie.channel.registerMonkeyPatch("console",sS.console),require("console")}sS.enable=Nvt});var wNe=R(aS=>{"use strict";Object.defineProperty(aS,"__esModule",{value:!0});aS.enable=aS.mongoCore=void 0;var Die=Gi(),Lvt=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),o=this.s.pool.write;this.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=Die.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Die.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t};aS.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Lvt};function Ovt(){Die.channel.registerMonkeyPatch("mongodb-core",aS.mongoCore)}aS.enable=Ovt});var kNe=R(Wa=>{"use strict";var Nk=Wa&&Wa.__assign||function(){return Nk=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Nk.apply(this,arguments)};Object.defineProperty(Wa,"__esModule",{value:!0});Wa.enable=Wa.mongo330=Wa.mongo3=Wa.mongo2=void 0;var fa=Gi(),Mvt=function(t){var e=t.instrument({operationIdGenerator:{next:function(){return fa.channel.bindToContext(function(n){return n()})}}}),r={};return e.on("started",function(n){r[n.requestId]||(r[n.requestId]=Nk(Nk({},n),{time:new Date}))}),e.on("succeeded",function(n){var o=r[n.requestId];o&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return fa.channel.publish("mongodb",{startedData:o,event:n,succeeded:!0})}):fa.channel.publish("mongodb",{startedData:o,event:n,succeeded:!0})}),e.on("failed",function(n){var o=r[n.requestId];o&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return fa.channel.publish("mongodb",{startedData:o,event:n,succeeded:!1})}):fa.channel.publish("mongodb",{startedData:o,event:n,succeeded:!1})}),t},Fvt=function(t){var e=t.instrument(),r={},n={};return e.on("started",function(o){r[o.requestId]||(n[o.requestId]=fa.channel.bindToContext(function(s){return s()}),r[o.requestId]=Nk(Nk({},o),{time:new Date}))}),e.on("succeeded",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return fa.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete n[o.requestId])}),e.on("failed",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return fa.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete n[o.requestId])}),t},Uvt=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),o=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=fa.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=fa.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t},Bvt=function(t){Uvt(t);var e=t.instrument(),r={},n={};return e.on("started",function(o){r[o.requestId]||(n[o.requestId]=fa.channel.bindToContext(function(s){return s()}),r[o.requestId]=o)}),e.on("succeeded",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return fa.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete n[o.requestId])}),e.on("failed",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return fa.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete n[o.requestId])}),t};Wa.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:Mvt};Wa.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:Fvt};Wa.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:Bvt};function qvt(){fa.channel.registerMonkeyPatch("mongodb",Wa.mongo2),fa.channel.registerMonkeyPatch("mongodb",Wa.mongo3),fa.channel.registerMonkeyPatch("mongodb",Wa.mongo330)}Wa.enable=qvt});var PNe=R(cS=>{"use strict";Object.defineProperty(cS,"__esModule",{value:!0});cS.enable=cS.mysql=void 0;var qq=Gi(),RNe=require("path"),jvt=function(t,e){var r=function(l,u){return function(d,p){var f=l[d];f&&(l[d]=function(){for(var h=arguments.length-1,g=arguments.length-1;g>=0;--g)if(typeof arguments[g]=="function"){h=g;break}else if(typeof arguments[g]<"u")break;var v=arguments[h],b={result:null,startTime:null,startDate:null};typeof v=="function"&&(p?(b.startTime=process.hrtime(),b.startDate=new Date,arguments[h]=qq.channel.bindToContext(p(b,v))):arguments[h]=qq.channel.bindToContext(v));var _=f.apply(this,arguments);return b.result=_,_})}},n=function(l,u){return r(l.prototype,u+".prototype")},o=["connect","changeUser","ping","statistics","end"],s=require(RNe.dirname(e)+"/lib/Connection");o.forEach(function(l){return n(s,"Connection")(l)}),r(s,"Connection")("createQuery",function(l,u){return function(d){var p=process.hrtime(l.startTime),f=p[0]*1e3+p[1]/1e6|0;qq.channel.publish("mysql",{query:l.result,callbackArgs:arguments,err:d,duration:f,time:l.startDate}),u.apply(this,arguments)}});var a=["_enqueueCallback"],c=require(RNe.dirname(e)+"/lib/Pool");return a.forEach(function(l){return n(c,"Pool")(l)}),t};cS.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:jvt};function Vvt(){qq.channel.registerMonkeyPatch("mysql",cS.mysql)}cS.enable=Vvt});var DNe=R(lS=>{"use strict";Object.defineProperty(lS,"__esModule",{value:!0});lS.enable=lS.postgresPool1=void 0;var ANe=Gi();function Hvt(t){var e=t.prototype.connect;return t.prototype.connect=function(n){return n&&(arguments[0]=ANe.channel.bindToContext(n)),e.apply(this,arguments)},t}lS.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:Hvt};function Gvt(){ANe.channel.registerMonkeyPatch("pg-pool",lS.postgresPool1)}lS.enable=Gvt});var LNe=R(Df=>{"use strict";Object.defineProperty(Df,"__esModule",{value:!0});Df.enable=Df.postgres=Df.postgres6=void 0;var Lk=Gi(),NNe=require("events"),Nie="postgres";function zvt(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,a,c){var l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},u=process.hrtime(),d;function p(f){f&&f[n]&&(f=f[n]);var m=Lk.channel.bindToContext(function(h,g){var v=process.hrtime(u);if(l.result=g&&{rowCount:g.rowCount,command:g.command},l.error=h,l.duration=Math.ceil(v[0]*1e3+v[1]/1e6),Lk.channel.publish(Nie,l),h){if(f)return f.apply(this,arguments);d&&d instanceof NNe.EventEmitter&&d.emit("error",h)}else f&&f.apply(this,arguments)});try{return Object.defineProperty(m,n,{value:f}),m}catch{return f}}try{typeof s=="string"?a instanceof Array?(l.query.preparable={text:s,args:a},c=p(c)):(l.query.text=s,c?c=p(c):a=p(a)):(typeof s.name=="string"?l.query.plan=s.name:s.values instanceof Array?l.query.preparable={text:s.text,args:s.values}:l.query.text=s.text,c?c=p(c):a?a=p(a):s.callback=p(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3,d=r.apply(this,arguments),d},t}function $vt(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,a,c){var l=this,u,d,p=!!c,f={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},m,h=process.hrtime();function g(_){_&&_[n]&&(_=_[n]);var x=Lk.channel.bindToContext(function(S,I){var w=process.hrtime(h);if(f.result=I&&{rowCount:I.rowCount,command:I.command},f.error=S,f.duration=Math.ceil(w[0]*1e3+w[1]/1e6),Lk.channel.publish(Nie,f),S){if(_)return _.apply(this,arguments);m&&m instanceof NNe.EventEmitter&&m.emit("error",S)}else _&&_.apply(this,arguments)});try{return Object.defineProperty(x,n,{value:_}),x}catch{return _}}try{typeof s=="string"?a instanceof Array?(f.query.preparable={text:s,args:a},p=typeof c=="function",c=p?g(c):c):(f.query.text=s,c?(p=typeof c=="function",c=p?g(c):c):(p=typeof a=="function",a=p?g(a):a)):(typeof s.name=="string"?f.query.plan=s.name:s.values instanceof Array?f.query.preparable={text:s.text,args:s.values}:s.cursor?f.query.text=(u=s.cursor)===null||u===void 0?void 0:u.text:f.query.text=s.text,c?(p=typeof c=="function",c=g(c)):a?(p=typeof a=="function",a=p?g(a):a):(p=typeof s.callback=="function",s.callback=p?g(s.callback):s.callback))}catch{return r.apply(this,arguments)}arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3;try{m=r.apply(this,arguments)}catch(_){throw g()(_,void 0),_}if(!p){if(m instanceof Promise)return m.then(function(_){return g()(void 0,_),new l._Promise(function(x,S){x(_)})}).catch(function(_){return g()(_,void 0),new l._Promise(function(x,S){S(_)})});var v=m.text?m.text:"";if(m.cursor&&(v=(d=m.cursor)===null||d===void 0?void 0:d.text),v){var b={command:v,rowCount:0};g()(void 0,b)}}return m},t}Df.postgres6={versionSpecifier:"6.*",patch:zvt};Df.postgres={versionSpecifier:">=7.* <=8.*",patch:$vt,publisherName:Nie};function Wvt(){Lk.channel.registerMonkeyPatch("pg",Df.postgres6),Lk.channel.registerMonkeyPatch("pg",Df.postgres)}Df.enable=Wvt});var ONe=R(uS=>{"use strict";Object.defineProperty(uS,"__esModule",{value:!0});uS.enable=uS.redis=void 0;var Lie=Gi(),Kvt=function(t){var e=t.RedisClient.prototype.internal_send_command;return t.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var o=this.address,s=process.hrtime(),a=new Date;r.callback=Lie.channel.bindToContext(function(c,l){var u=process.hrtime(s),d=u[0]*1e3+u[1]/1e6|0;Lie.channel.publish("redis",{duration:d,address:o,commandObj:r,err:c,result:l,time:a}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return e.call(this,r)},t};uS.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Kvt};function Yvt(){Lie.channel.registerMonkeyPatch("redis",uS.redis)}uS.enable=Yvt});var MNe=R(jh=>{"use strict";var jq=jh&&jh.__assign||function(){return jq=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},jq.apply(this,arguments)};Object.defineProperty(jh,"__esModule",{value:!0});jh.enable=jh.tedious=void 0;var Oie=Gi(),Qvt=function(t){var e=t.Connection.prototype.makeRequest;return t.Connection.prototype.makeRequest=function(){function n(s){var a=process.hrtime(),c={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return Oie.channel.bindToContext(function(l,u,d){var p=process.hrtime(a);c=jq(jq({},c),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!l&&{rowCount:u,rows:d},query:{text:this.parametersByName.statement.value},error:l,duration:Math.ceil(p[0]*1e3+p[1]/1e6)}),Oie.channel.publish("tedious",c),s.call(this,l,u,d)})}var o=arguments[0];arguments[0].callback=n(o.callback),e.apply(this,arguments)},t};jh.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:Qvt};function Xvt(){Oie.channel.registerMonkeyPatch("tedious",jh.tedious)}jh.enable=Xvt});var FNe=R(Dc=>{"use strict";var Jvt=Dc&&Dc.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zvt=Dc&&Dc.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.enable=Dc.winston2=Dc.winston3=void 0;var Vq=Gi(),e0t=function(t){var e=t.Logger.prototype.log,r,n=function(o,s,a){var c;return r===t.config.npm.levels?c="npm":r===t.config.syslog.levels?c="syslog":c="unknown",Vq.channel.publish("winston",{level:o,message:s,meta:a,levelKind:c}),s};return t.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),e.apply(this,arguments)},t},t0t=function(t){var e=function(a,c){var l;return a.config.npm.levels[c]!=null?l="npm":a.config.syslog.levels[c]!=null?l="syslog":l="unknown",l},r=function(a){Jvt(c,a);function c(l,u){var d=a.call(this,u)||this;return d.winston=l,d}return c.prototype.log=function(l,u){var d=l.message,p=l.level,f=l.meta,m=Zvt(l,["message","level","meta"]);p=typeof Symbol.for=="function"?l[Symbol.for("level")]:p,d=l instanceof Error?l:d;var h=e(this.winston,p);f=f||{};for(var g in m)m.hasOwnProperty(g)&&(f[g]=m[g]);Vq.channel.publish("winston",{message:d,level:p,levelKind:h,meta:f}),u()},c}(t.Transport);function n(){var a=t.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(a=arguments[0].levels);var c;for(var l in a)a.hasOwnProperty(l)&&(c=c===void 0||a[l]>a[c]?l:c);this.add(new r(t,{level:c}))}var o=t.createLogger;t.createLogger=function(){var c=t.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(c=arguments[0].levels);var l;for(var u in c)c.hasOwnProperty(u)&&(l=l===void 0||c[u]>c[l]?u:l);var d=o.apply(this,arguments);d.add(new r(t,{level:l}));var p=d.configure;return d.configure=function(){p.apply(this,arguments),n.apply(this,arguments)},d};var s=t.configure;return t.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},t.add(new r(t)),t};Dc.winston3={versionSpecifier:"3.x",patch:t0t};Dc.winston2={versionSpecifier:"2.x",patch:e0t};function r0t(){Vq.channel.registerMonkeyPatch("winston",Dc.winston2),Vq.channel.registerMonkeyPatch("winston",Dc.winston3)}Dc.enable=r0t});var YNe=R(zn=>{"use strict";Object.defineProperty(zn,"__esModule",{value:!0});zn.enable=zn.tedious=zn.pgPool=zn.pg=zn.winston=zn.redis=zn.mysql=zn.mongodb=zn.mongodbCore=zn.console=zn.bunyan=zn.azuresdk=void 0;var UNe=SNe();zn.azuresdk=UNe;var BNe=CNe();zn.bunyan=BNe;var qNe=ENe();zn.console=qNe;var jNe=wNe();zn.mongodbCore=jNe;var VNe=kNe();zn.mongodb=VNe;var HNe=PNe();zn.mysql=HNe;var GNe=DNe();zn.pgPool=GNe;var zNe=LNe();zn.pg=zNe;var $Ne=ONe();zn.redis=$Ne;var WNe=MNe();zn.tedious=WNe;var KNe=FNe();zn.winston=KNe;function n0t(){BNe.enable(),qNe.enable(),jNe.enable(),VNe.enable(),HNe.enable(),zNe.enable(),GNe.enable(),$Ne.enable(),KNe.enable(),UNe.enable(),WNe.enable()}zn.enable=n0t});var zq=R(Ty=>{"use strict";Object.defineProperty(Ty,"__esModule",{value:!0});Ty.registerContextPreservation=Ty.IsInitialized=void 0;var Mie=ri(),XNe=qB();Ty.IsInitialized=!XNe.JsonConfig.getInstance().noDiagnosticChannel;var Fie="DiagnosticChannel";if(Ty.IsInitialized){qd=YNe(),QNe=XNe.JsonConfig.getInstance().noPatchModules,Hq=QNe.split(","),Uie={bunyan:qd.bunyan,console:qd.console,mongodb:qd.mongodb,mongodbCore:qd.mongodbCore,mysql:qd.mysql,redis:qd.redis,pg:qd.pg,pgPool:qd.pgPool,winston:qd.winston,azuresdk:qd.azuresdk};for(Gq in Uie)Hq.indexOf(Gq)===-1&&(Uie[Gq].enable(),Mie.info(Fie,"Subscribed to "+Gq+" events"));Hq.length>0&&Mie.info(Fie,"Some modules will not be patched",Hq)}else Mie.info(Fie,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var qd,QNe,Hq,Uie,Gq;function i0t(t){if(Ty.IsInitialized){var e=Gi();e.channel.addContextPreservation(t)}}Ty.registerContextPreservation=i0t});var Ok=R((GQr,JNe)=>{"use strict";JNe.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var zs=R((jie,ZNe)=>{"use strict";var wy=jie&&jie.__assign||function(){return wy=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},wy.apply(this,arguments)},o0t=require("http"),Bie=require("https"),qie=require("url"),Ey=require("constants"),dS=ri(),Mk=Ok(),s0t=qB(),a0t=function(){function t(){t._addCloseHandler()}return t.getCookie=function(e,r){var n="";if(e&&e.length&&typeof r=="string")for(var o=e+"=",s=r.split(";"),a=0;a<s.length;a++){var r=s[a];if(r=t.trim(r),r&&r.indexOf(o)===0){n=r.substring(o.length,s[a].length);break}}return n},t.trim=function(e){return typeof e=="string"?e.replace(/^\s+|\s+$/g,""):""},t.int32ArrayToBase64=function(e){var r=function(c,l){return String.fromCharCode(c>>l&255)},n=function(c){return r(c,24)+r(c,16)+r(c,8)+r(c,0)},o=e.map(n).join(""),s=Buffer.from?Buffer.from(o,"binary"):new Buffer(o,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},t.random32=function(){return 4294967296*Math.random()|0},t.randomu32=function(){return t.random32()+2147483648},t.w3cTraceId=function(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,o=0;o<4;o++)n=t.random32(),r+=e[n&15]+e[n>>4&15]+e[n>>8&15]+e[n>>12&15]+e[n>>16&15]+e[n>>20&15]+e[n>>24&15]+e[n>>28&15];var s=e[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},t.w3cSpanId=function(){return t.w3cTraceId().substring(16)},t.isValidW3CId=function(e){return e.length===32&&e!=="00000000000000000000000000000000"},t.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.isError=function(e){return Object.prototype.toString.call(e)==="[object Error]"},t.isPrimitive=function(e){var r=typeof e;return r==="string"||r==="number"||r==="boolean"},t.isDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"},t.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var r=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(e/(1e3*60))%60,o=""+Math.floor(e/(1e3*60*60))%24,s=Math.floor(e/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,o=o.length<2?"0"+o:o;var a=s>0?s+".":"";return a+o+":"+n+":"+r},t.extractError=function(e){var r=e;return{message:e.message,code:r.code||r.id||""}},t.extractObject=function(e){return e instanceof Error?t.extractError(e):typeof e.toJSON=="function"?e.toJSON():e},t.validateStringMap=function(e){if(typeof e!="object"){dS.info("Invalid properties dropped from payload");return}var r={};for(var n in e){var o="",s=e[n],a=typeof s;if(t.isPrimitive(s))o=s.toString();else if(s===null||a==="undefined")o="";else if(a==="function"){dS.info("key: "+n+" was function; will not serialize");continue}else{var c=t.isArray(s)?s:t.extractObject(s);try{t.isPrimitive(c)?o=c:o=JSON.stringify(c)}catch(l){o=s.constructor.name.toString()+" (Error: "+l.message+")",dS.info("key: "+n+", could not be serialized")}}r[n]=o.substring(0,t.MAX_PROPERTY_LENGTH)}return r},t.canIncludeCorrelationHeader=function(e,r){var n=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var o=0;o<n.length;o++){var s=new RegExp(n[o].replace(/\./g,".").replace(/\*/g,".*"));try{if(s.test(new qie.URL(r).hostname))return!1}catch{}}return!0},t.getCorrelationContextTarget=function(e,r){var n=e.headers&&e.headers[Mk.requestContextHeader];if(n)for(var o=n.split(","),s=0;s<o.length;++s){var a=o[s].split("=");if(a.length==2&&a[0]==r)return a[1]}},t.makeRequest=function(e,r,n,o,s,a){s===void 0&&(s=!0),a===void 0&&(a=!0),r&&r.indexOf("//")===0&&(r="https:"+r);var c=new qie.URL(r),l=wy(wy({},n),{host:c.hostname,port:c.port,path:c.pathname}),u=void 0;if(s&&(c.protocol==="https:"&&(u=e.proxyHttpsUrl||void 0),c.protocol==="http:"&&(u=e.proxyHttpUrl||void 0),u)){u.indexOf("//")===0&&(u="http:"+u);try{var d=new qie.URL(u);d.protocol==="https:"?(dS.info("Proxies that use HTTPS are not supported"),u=void 0):l=wy(wy({},l),{host:d.hostname,port:d.port||"80",path:r,headers:wy(wy({},l.headers),{Host:c.hostname})})}catch{dS.warn("Wrong proxy URL provided")}}var p=c.protocol==="https:"&&!u;return a&&(p&&e.httpsAgent!==void 0?l.agent=e.httpsAgent:!p&&e.httpAgent!==void 0?l.agent=e.httpAgent:p&&(l.agent=t._useKeepAlive?t.keepAliveAgent:t.tlsRestrictedAgent)),p?Bie.request(l,o):o0t.request(l,o)},t.safeIncludeCorrelationHeader=function(e,r,n){var o;if(typeof n=="string")o=n;else if(n instanceof Array)o=n.join(",");else if(n&&typeof n.toString=="function")try{o=n.toString()}catch(s){dS.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}o?t.addCorrelationIdHeaderFromString(e,r,o):r.setHeader(Mk.requestContextHeader,Mk.requestContextSourceKey+"="+e.config.correlationId)},t.dumpObj=function(e){if(e)try{var r=Object.prototype.toString.call(e),n="";return r==="[object Error]"?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":n=this.stringify(e),r+n}catch{return e.toString()}},t.stringify=function(e){try{return JSON.stringify(e)}catch(r){dS.warn("Failed to serialize payload",r,e)}},t.addCorrelationIdHeaderFromString=function(e,r,n){var o=n.split(","),s=Mk.requestContextSourceKey+"=",a=o.some(function(c){return c.substring(0,s.length)===s});a||r.setHeader(Mk.requestContextHeader,n+","+Mk.requestContextSourceKey+"="+e.config.correlationId)},t._addCloseHandler=function(){t._listenerAttached||(process.on("exit",function(){t.isNodeExit=!0,t._useKeepAlive=!1}),t._listenerAttached=!0)},t._useKeepAlive=!s0t.JsonConfig.getInstance().noHttpAgentKeepAlive,t._listenerAttached=!1,t.MAX_PROPERTY_LENGTH=8192,t.keepAliveAgent=new Bie.Agent({keepAlive:!0,maxSockets:25,secureOptions:Ey.SSL_OP_NO_SSLv2|Ey.SSL_OP_NO_SSLv3|Ey.SSL_OP_NO_TLSv1|Ey.SSL_OP_NO_TLSv1_1}),t.tlsRestrictedAgent=new Bie.Agent({secureOptions:Ey.SSL_OP_NO_SSLv2|Ey.SSL_OP_NO_SSLv3|Ey.SSL_OP_NO_TLSv1|Ey.SSL_OP_NO_TLSv1_1}),t.isNodeExit=!1,t}();ZNe.exports=a0t});var pS=R((zQr,eLe)=>{"use strict";var Vie=zs(),c0t=function(){function t(){}return t.queryCorrelationId=function(e,r){},t.cancelCorrelationIdQuery=function(e,r){},t.generateRequestId=function(e){if(e){e=e[0]=="|"?e:"|"+e,e[e.length-1]!=="."&&(e+=".");var r=(t.currentRootId++).toString(16);return t.appendSuffix(e,r,"_")}else return t.generateRootId()},t.getRootId=function(e){var r=e.indexOf(".");r<0&&(r=e.length);var n=e[0]==="|"?1:0;return e.substring(n,r)},t.generateRootId=function(){return"|"+Vie.w3cTraceId()+"."},t.appendSuffix=function(e,r,n){if(e.length+r.length<t.requestIdMaxLength)return e+r+n;var o=t.requestIdMaxLength-9;if(e.length>o)for(;o>1;--o){var s=e[o-1];if(s==="."||s==="_")break}if(o<=1)return t.generateRootId();for(r=Vie.randomu32().toString(16);r.length<8;)r="0"+r;return e.substring(0,o)+r+"#"},t.correlationIdPrefix="cid-v1:",t.w3cEnabled=!0,t.HTTP_TIMEOUT=2500,t.requestIdMaxLength=1024,t.currentRootId=Vie.randomu32(),t}();eLe.exports=c0t});var $q=R(($Qr,tLe)=>{"use strict";var $s=zs(),l0t=pS(),u0t=function(){function t(e,r){if(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.version=t.DEFAULT_VERSION,e&&typeof e=="string")if(e.split(",").length>1)this.traceId=$s.w3cTraceId(),this.spanId=$s.w3cTraceId().substr(0,16);else{var n=e.trim().split("-"),o=n.length;o>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=$s.w3cTraceId(),this.spanId=$s.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=t.DEFAULT_VERSION,this.traceId=$s.w3cTraceId()),this.version==="00"&&o!==4&&(this.traceId=$s.w3cTraceId(),this.spanId=$s.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=t.DEFAULT_VERSION,this.traceId=$s.w3cTraceId(),this.spanId=$s.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=t.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.traceId=$s.w3cTraceId()),t.isValidTraceId(this.traceId)||(this.traceId=$s.w3cTraceId()),t.isValidSpanId(this.spanId)||(this.spanId=$s.w3cTraceId().substr(0,16),this.traceId=$s.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=l0t.getRootId(r);t.isValidTraceId(s)||(this.legacyRootId=s,s=$s.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=$s.w3cTraceId(),this.spanId=$s.w3cTraceId().substr(0,16)}return t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.formatOpenTelemetryTraceFlags=function(e){var r="0"+e.toString(16);return r.substring(r.length-2)},t.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},t.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},t.prototype.updateSpanId=function(){this.spanId=$s.w3cTraceId().substr(0,16)},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}();tLe.exports=u0t});var Hie=R((WQr,rLe)=>{"use strict";var d0t=function(){function t(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return t.prototype.toString=function(){var e=this.fieldmap;return!e||e.length==0?null:e.join(", ")},t.validateKeyChars=function(e){var r=e.split("@");if(r.length==2){var n=r[0].trim(),o=r[1].trim(),s=!!n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/),a=!!o.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/);return s&&a}else if(r.length==1)return!!e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/);return!1},t.prototype.parseHeader=function(e){var r=[],n={},o=e.split(",");if(o.length>32)return null;for(var s=0,a=o;s<a.length;s++){var c=a[s],l=c.trim();if(l.length!==0){var u=l.split("=");if(u.length!==2||!t.validateKeyChars(u[0])||n[u[0]])return null;n[u[0]]=!0,r.push(l)}}return r},t.strict=!0,t}();rLe.exports=d0t});var Vh=R((KQr,nLe)=>{"use strict";var p0t=function(){function t(){}return t}();nLe.exports=p0t});var oLe=R((Gie,iLe)=>{"use strict";var f0t=Gie&&Gie.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),m0t=Vh(),h0t=function(t){f0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(m0t);iLe.exports=h0t});var zie=R((YQr,sLe)=>{"use strict";var g0t=function(){function t(){}return t}();sLe.exports=g0t});var cLe=R((QQr,aLe)=>{"use strict";var v0t=function(){function t(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return t}();aLe.exports=v0t});var uLe=R(($ie,lLe)=>{"use strict";var y0t=$ie&&$ie.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),b0t=zie(),_0t=function(t){y0t(e,t);function e(){return t.call(this)||this}return e}(b0t);lLe.exports=_0t});var Kie=R((XQr,dLe)=>{"use strict";var Wie;(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(Wie||(Wie={}));dLe.exports=Wie});var fLe=R((JQr,pLe)=>{"use strict";var x0t=Kie(),S0t=function(){function t(){this.kind=x0t.Measurement}return t}();pLe.exports=S0t});var hLe=R((ZQr,mLe)=>{"use strict";var I0t=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return t}();mLe.exports=I0t});var Qie=R((Yie,gLe)=>{"use strict";var C0t=Yie&&Yie.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),T0t=Vh(),E0t=function(t){C0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(T0t);gLe.exports=E0t});var yLe=R((Xie,vLe)=>{"use strict";var w0t=Xie&&Xie.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),k0t=Vh(),R0t=function(t){w0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return e}(k0t);vLe.exports=R0t});var _Le=R((eXr,bLe)=>{"use strict";var P0t=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return t}();bLe.exports=P0t});var SLe=R((Jie,xLe)=>{"use strict";var A0t=Jie&&Jie.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),D0t=Vh(),N0t=function(t){A0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r}return e}(D0t);xLe.exports=N0t});var CLe=R((Zie,ILe)=>{"use strict";var L0t=Zie&&Zie.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),O0t=Vh(),M0t=function(t){L0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return e}(O0t);ILe.exports=M0t});var ELe=R((eoe,TLe)=>{"use strict";var F0t=eoe&&eoe.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),U0t=Qie(),B0t=function(t){F0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(U0t);TLe.exports=B0t});var kLe=R((toe,wLe)=>{"use strict";var q0t=toe&&toe.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),j0t=Vh(),V0t=function(t){q0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return e}(j0t);wLe.exports=V0t});var PLe=R((roe,RLe)=>{"use strict";var H0t=roe&&roe.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),G0t=Vh(),z0t=function(t){H0t(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(G0t);RLe.exports=z0t});var DLe=R((tXr,ALe)=>{"use strict";var noe;(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(noe||(noe={}));ALe.exports=noe});var LLe=R((rXr,NLe)=>{"use strict";var $0t=function(){function t(){}return t}();NLe.exports=$0t});var ioe=R(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.AvailabilityData=oLe();wo.Base=zie();wo.ContextTagKeys=cLe();wo.Data=uLe();wo.DataPoint=fLe();wo.DataPointType=Kie();wo.Domain=Vh();wo.Envelope=hLe();wo.EventData=Qie();wo.ExceptionData=yLe();wo.ExceptionDetails=_Le();wo.MessageData=SLe();wo.MetricData=CLe();wo.PageViewData=ELe();wo.RemoteDependencyData=kLe();wo.RequestData=PLe();wo.SeverityLevel=DLe();wo.StackFrame=LLe()});var OLe=R(Fk=>{"use strict";Object.defineProperty(Fk,"__esModule",{value:!0});Fk.domainSupportsProperties=Fk.RemoteDependencyDataConstants=void 0;var fS=ioe(),W0t=function(){function t(){}return t.TYPE_HTTP="Http",t.TYPE_AI="Http (tracked component)",t}();Fk.RemoteDependencyDataConstants=W0t;function K0t(t){return"properties"in t||t instanceof fS.EventData||t instanceof fS.ExceptionData||t instanceof fS.MessageData||t instanceof fS.MetricData||t instanceof fS.PageViewData||t instanceof fS.RemoteDependencyData||t instanceof fS.RequestData}Fk.domainSupportsProperties=K0t});var FLe=R(MLe=>{"use strict";Object.defineProperty(MLe,"__esModule",{value:!0})});var BLe=R(ULe=>{"use strict";Object.defineProperty(ULe,"__esModule",{value:!0})});var jLe=R(qLe=>{"use strict";Object.defineProperty(qLe,"__esModule",{value:!0})});var HLe=R(VLe=>{"use strict";Object.defineProperty(VLe,"__esModule",{value:!0})});var zLe=R(GLe=>{"use strict";Object.defineProperty(GLe,"__esModule",{value:!0})});var WLe=R($Le=>{"use strict";Object.defineProperty($Le,"__esModule",{value:!0})});var YLe=R(KLe=>{"use strict";Object.defineProperty(KLe,"__esModule",{value:!0})});var XLe=R(QLe=>{"use strict";Object.defineProperty(QLe,"__esModule",{value:!0})});var ZLe=R(JLe=>{"use strict";Object.defineProperty(JLe,"__esModule",{value:!0})});var tOe=R(eOe=>{"use strict";Object.defineProperty(eOe,"__esModule",{value:!0})});var nOe=R(rOe=>{"use strict";Object.defineProperty(rOe,"__esModule",{value:!0})});var oOe=R(iOe=>{"use strict";Object.defineProperty(iOe,"__esModule",{value:!0})});var sOe=R(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});jd.TelemetryType=jd.TelemetryTypeString=jd.baseTypeToTelemetryType=jd.telemetryTypeToBaseType=void 0;function Y0t(t){switch(t){case Ws.Event:return"EventData";case Ws.Exception:return"ExceptionData";case Ws.Trace:return"MessageData";case Ws.Metric:return"MetricData";case Ws.Request:return"RequestData";case Ws.Dependency:return"RemoteDependencyData";case Ws.Availability:return"AvailabilityData";case Ws.PageView:return"PageViewData"}}jd.telemetryTypeToBaseType=Y0t;function Q0t(t){switch(t){case"EventData":return Ws.Event;case"ExceptionData":return Ws.Exception;case"MessageData":return Ws.Trace;case"MetricData":return Ws.Metric;case"RequestData":return Ws.Request;case"RemoteDependencyData":return Ws.Dependency;case"AvailabilityData":return Ws.Availability;case"PageViewData":return Ws.PageView}}jd.baseTypeToTelemetryType=Q0t;jd.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var Ws;(function(t){t[t.Event=0]="Event",t[t.Exception=1]="Exception",t[t.Trace=2]="Trace",t[t.Metric=3]="Metric",t[t.Request=4]="Request",t[t.Dependency=5]="Dependency",t[t.Availability=6]="Availability",t[t.PageView=7]="PageView"})(Ws=jd.TelemetryType||(jd.TelemetryType={}))});var aOe=R(Jo=>{"use strict";var X0t=Jo&&Jo.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),xl=Jo&&Jo.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&X0t(e,t,r)};Object.defineProperty(Jo,"__esModule",{value:!0});xl(FLe(),Jo);xl(BLe(),Jo);xl(jLe(),Jo);xl(HLe(),Jo);xl(zLe(),Jo);xl(WLe(),Jo);xl(YLe(),Jo);xl(XLe(),Jo);xl(ZLe(),Jo);xl(tOe(),Jo);xl(nOe(),Jo);xl(oOe(),Jo);xl(sOe(),Jo)});var lOe=R(cOe=>{"use strict";Object.defineProperty(cOe,"__esModule",{value:!0})});var dOe=R(uOe=>{"use strict";Object.defineProperty(uOe,"__esModule",{value:!0})});var fOe=R(pOe=>{"use strict";Object.defineProperty(pOe,"__esModule",{value:!0})});var hOe=R(mOe=>{"use strict";Object.defineProperty(mOe,"__esModule",{value:!0})});var vOe=R(gOe=>{"use strict";Object.defineProperty(gOe,"__esModule",{value:!0})});var bOe=R(yOe=>{"use strict";Object.defineProperty(yOe,"__esModule",{value:!0})});var xOe=R(_Oe=>{"use strict";Object.defineProperty(_Oe,"__esModule",{value:!0})});var IOe=R(SOe=>{"use strict";Object.defineProperty(SOe,"__esModule",{value:!0})});var COe=R(Nc=>{"use strict";var J0t=Nc&&Nc.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ky=Nc&&Nc.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&J0t(e,t,r)};Object.defineProperty(Nc,"__esModule",{value:!0});ky(lOe(),Nc);ky(dOe(),Nc);ky(fOe(),Nc);ky(hOe(),Nc);ky(vOe(),Nc);ky(bOe(),Nc);ky(xOe(),Nc);ky(IOe(),Nc)});var ma=R(Nf=>{"use strict";var Z0t=Nf&&Nf.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Wq=Nf&&Nf.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Z0t(e,t,r)};Object.defineProperty(Nf,"__esModule",{value:!0});Wq(OLe(),Nf);Wq(ioe(),Nf);Wq(aOe(),Nf);Wq(COe(),Nf)});var ooe=R((RXr,TOe)=>{"use strict";var eyt=function(){function t(){}return t.prototype.getUrl=function(){return this.url},t.prototype.RequestParser=function(){this.startTime=+new Date},t.prototype._setStatus=function(e,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=e;var o=this.properties||{};if(r){if(typeof r=="string")o.error=r;else if(r instanceof Error)o.error=r.message;else if(typeof r=="object")for(var s in r)o[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=o},t.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},t}();TOe.exports=eyt});var Ei=R($e=>{"use strict";var Vd;Object.defineProperty($e,"__esModule",{value:!0});$e.WEB_INSTRUMENTATION_DEPRECATED_SOURCE=$e.WEB_INSTRUMENTATION_DEFAULT_SOURCE=$e.TIME_SINCE_ENQUEUED=$e.ENQUEUED_TIME=$e.MessageBusDestination=$e.MicrosoftEventHub=$e.AzNamespace=$e.HttpRequestCookieNames=$e.StatsbeatNetworkCategory=$e.StatsbeatFeatureType=$e.StatsbeatInstrumentation=$e.StatsbeatFeature=$e.StatsbeatCounter=$e.StatsbeatAttach=$e.StatsbeatResourceProvider=$e.StatsbeatTelemetryName=$e.HeartBeatMetricName=$e.DependencyTypeName=$e.TelemetryTypeStringToQuickPulseDocumentType=$e.TelemetryTypeStringToQuickPulseType=$e.QuickPulseType=$e.QuickPulseDocumentType=$e.PerformanceToQuickPulseCounter=$e.MetricId=$e.PerformanceCounter=$e.QuickPulseCounter=$e.DEFAULT_LIVEMETRICS_HOST=$e.DEFAULT_LIVEMETRICS_ENDPOINT=$e.DEFAULT_BREEZE_ENDPOINT=$e.APPLICATION_INSIGHTS_SDK_VERSION=void 0;$e.APPLICATION_INSIGHTS_SDK_VERSION="2.9.1";$e.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";$e.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";$e.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var ha;(function(t){t.COMMITTED_BYTES="\\Memory\\Committed Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",t.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",t.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",t.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",t.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",t.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",t.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(ha=$e.QuickPulseCounter||($e.QuickPulseCounter={}));var Kq;(function(t){t.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",t.AVAILABLE_BYTES="\\Memory\\Available Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",t.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",t.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(Kq=$e.PerformanceCounter||($e.PerformanceCounter={}));var tyt;(function(t){t.REQUESTS_DURATION="requests/duration",t.DEPENDENCIES_DURATION="dependencies/duration",t.EXCEPTIONS_COUNT="exceptions/count",t.TRACES_COUNT="traces/count"})(tyt=$e.MetricId||($e.MetricId={}));$e.PerformanceToQuickPulseCounter=(Vd={},Vd[Kq.PROCESSOR_TIME]=ha.PROCESSOR_TIME,Vd[Kq.REQUEST_RATE]=ha.REQUEST_RATE,Vd[Kq.REQUEST_DURATION]=ha.REQUEST_DURATION,Vd[ha.COMMITTED_BYTES]=ha.COMMITTED_BYTES,Vd[ha.REQUEST_FAILURE_RATE]=ha.REQUEST_FAILURE_RATE,Vd[ha.DEPENDENCY_RATE]=ha.DEPENDENCY_RATE,Vd[ha.DEPENDENCY_FAILURE_RATE]=ha.DEPENDENCY_FAILURE_RATE,Vd[ha.DEPENDENCY_DURATION]=ha.DEPENDENCY_DURATION,Vd[ha.EXCEPTION_RATE]=ha.EXCEPTION_RATE,Vd);$e.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};$e.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};$e.TelemetryTypeStringToQuickPulseType={EventData:$e.QuickPulseType.Event,ExceptionData:$e.QuickPulseType.Exception,MessageData:$e.QuickPulseType.Trace,MetricData:$e.QuickPulseType.Metric,RequestData:$e.QuickPulseType.Request,RemoteDependencyData:$e.QuickPulseType.Dependency,AvailabilityData:$e.QuickPulseType.Availability,PageViewData:$e.QuickPulseType.PageView};$e.TelemetryTypeStringToQuickPulseDocumentType={EventData:$e.QuickPulseDocumentType.Event,ExceptionData:$e.QuickPulseDocumentType.Exception,MessageData:$e.QuickPulseDocumentType.Trace,MetricData:$e.QuickPulseDocumentType.Metric,RequestData:$e.QuickPulseDocumentType.Request,RemoteDependencyData:$e.QuickPulseDocumentType.Dependency,AvailabilityData:$e.QuickPulseDocumentType.Availability,PageViewData:$e.QuickPulseDocumentType.PageView};$e.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc",Sql:"SQL",QueueMessage:"Queue Message"};$e.HeartBeatMetricName="HeartbeatState";$e.StatsbeatTelemetryName="Statsbeat";$e.StatsbeatResourceProvider={appsvc:"appsvc",aks:"aks",functions:"functions",vm:"vm",unknown:"unknown"};$e.StatsbeatAttach={codeless:"codeless",sdk:"sdk"};$e.StatsbeatCounter={REQUEST_SUCCESS:"Request Success Count",REQUEST_FAILURE:"Request Failure Count",REQUEST_DURATION:"Request Duration",RETRY_COUNT:"Retry Count",THROTTLE_COUNT:"Throttle Count",EXCEPTION_COUNT:"Exception Count",ATTACH:"Attach",FEATURE:"Feature"};var ryt;(function(t){t[t.NONE=0]="NONE",t[t.DISK_RETRY=1]="DISK_RETRY",t[t.AAD_HANDLING=2]="AAD_HANDLING",t[t.WEB_SNIPPET=4]="WEB_SNIPPET"})(ryt=$e.StatsbeatFeature||($e.StatsbeatFeature={}));var nyt;(function(t){t[t.NONE=0]="NONE",t[t.AZURE_CORE_TRACING=1]="AZURE_CORE_TRACING",t[t.MONGODB=2]="MONGODB",t[t.MYSQL=4]="MYSQL",t[t.REDIS=8]="REDIS",t[t.POSTGRES=16]="POSTGRES",t[t.BUNYAN=32]="BUNYAN",t[t.WINSTON=64]="WINSTON",t[t.CONSOLE=128]="CONSOLE"})(nyt=$e.StatsbeatInstrumentation||($e.StatsbeatInstrumentation={}));var iyt;(function(t){t[t.Feature=0]="Feature",t[t.Instrumentation=1]="Instrumentation"})(iyt=$e.StatsbeatFeatureType||($e.StatsbeatFeatureType={}));var oyt;(function(t){t[t.Breeze=0]="Breeze",t[t.Quickpulse=1]="Quickpulse"})(oyt=$e.StatsbeatNetworkCategory||($e.StatsbeatNetworkCategory={}));var syt;(function(t){t.SESSION="ai_session",t.USER="ai_user",t.AUTH_USER="ai_authUser"})(syt=$e.HttpRequestCookieNames||($e.HttpRequestCookieNames={}));$e.AzNamespace="az.namespace";$e.MicrosoftEventHub="Microsoft.EventHub";$e.MessageBusDestination="message_bus.destination";$e.ENQUEUED_TIME="enqueuedTime";$e.TIME_SINCE_ENQUEUED="timeSinceEnqueued";$e.WEB_INSTRUMENTATION_DEFAULT_SOURCE="https://js.monitor.azure.com/scripts/b/ai";$e.WEB_INSTRUMENTATION_DEPRECATED_SOURCE="https://az416426.vo.msecnd.net/scripts/b/ai"});var loe=R((coe,EOe)=>{"use strict";var ayt=coe&&coe.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yq=require("url"),cyt=ma(),soe=zs(),Sl=Ok(),lyt=ooe(),Ry=pS(),uyt=Hie(),aoe=$q(),dyt=ri(),Qq=Ei(),pyt=function(t){ayt(e,t);function e(r,n){var o=t.call(this)||this;return r&&(o.method=r.method,o.url=o._getAbsoluteUrl(r),o.startTime=+new Date,o.socketRemoteAddress=r.socket&&r.socket.remoteAddress,o.parseHeaders(r,n),r.connection&&(o.connectionRemoteAddress=r.connection.remoteAddress,o.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),o}return e.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},e.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},e.prototype.getRequestTelemetry=function(r){var n=this.method;try{n+=" "+new Yq.URL(this.url).pathname}catch{}var o={id:this.requestId,name:n,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?o.time=r.time:this.startTime&&(o.time=new Date(this.startTime)),r){for(var s in r)o[s]||(o[s]=r[s]);if(r.properties)for(var s in r.properties)o.properties[s]=r.properties[s]}return o},e.prototype.getRequestTags=function(r){var n={};for(var o in r)n[o]=r[o];return n[e.keys.locationIp]=r[e.keys.locationIp]||this._getIp(),n[e.keys.sessionId]=r[e.keys.sessionId]||this._getId(Qq.HttpRequestCookieNames.SESSION),n[e.keys.userId]=r[e.keys.userId]||this._getId(Qq.HttpRequestCookieNames.USER),n[e.keys.userAuthUserId]=r[e.keys.userAuthUserId]||this._getId(Qq.HttpRequestCookieNames.AUTH_USER),n[e.keys.operationName]=this.getOperationName(r),n[e.keys.operationParentId]=this.getOperationParentId(r),n[e.keys.operationId]=this.getOperationId(r),n},e.prototype.getOperationId=function(r){return r[e.keys.operationId]||this.operationId},e.prototype.getOperationParentId=function(r){return r[e.keys.operationParentId]||this.parentId||this.getOperationId(r)},e.prototype.getOperationName=function(r){if(r[e.keys.operationName])return r[e.keys.operationName];var n="";try{n=new Yq.URL(this.url).pathname}catch{}var o=this.method;return n&&(o+=" "+n),o},e.prototype.getRequestId=function(){return this.requestId},e.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},e.prototype.getTraceparent=function(){return this.traceparent},e.prototype.getTracestate=function(){return this.tracestate},e.prototype.getLegacyRootId=function(){return this.legacyRootId},e.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,o=n||r.headers["x-forwarded-proto"]=="https"?"https":"http",s=o+"://"+r.headers.host+"/",a="",c="";try{var l=new Yq.URL(r.url,s);a=l.pathname,c=l.search}catch{}var u=Yq.format({protocol:o,host:r.headers.host,pathname:a,search:c});return u},e.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var a=r.exec(s);if(a)return a[0]},o=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!o&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(o="127.0.0.1"),o},e.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"";if(r===Qq.HttpRequestCookieNames.AUTH_USER)try{n=decodeURI(n)}catch(s){n="",dyt.warn("Could not decode the auth cookie with error: ",soe.dumpObj(s))}var o=e.parseId(soe.getCookie(r,n));return o},e.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},e.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=soe.getCorrelationContextTarget(r,Sl.requestContextSourceKey),r.headers){var o=r.headers[Sl.traceStateHeader]?r.headers[Sl.traceStateHeader].toString():null,s=r.headers[Sl.traceparentHeader]?r.headers[Sl.traceparentHeader].toString():null,a=r.headers[Sl.requestIdHeader]?r.headers[Sl.requestIdHeader].toString():null,c=r.headers[Sl.parentIdHeader]?r.headers[Sl.parentIdHeader].toString():null,l=r.headers[Sl.rootIdHeader]?r.headers[Sl.rootIdHeader].toString():null;this.correlationContextHeader=r.headers[Sl.correlationContextHeader]?r.headers[Sl.correlationContextHeader].toString():null,Ry.w3cEnabled&&(s||o)?(this.traceparent=new aoe(s?s.toString():null),this.tracestate=s&&o&&new uyt(o?o.toString():null),this.setBackCompatFromThisTraceContext()):a?Ry.w3cEnabled?(this.traceparent=new aoe(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=Ry.generateRequestId(this.parentId),this.operationId=Ry.getRootId(this.requestId)):Ry.w3cEnabled?(this.traceparent=new aoe,this.traceparent.parentId=c,this.traceparent.legacyRootId=l||c,this.setBackCompatFromThisTraceContext()):(this.parentId=c,this.requestId=Ry.generateRequestId(l||this.parentId),this.correlationContextHeader=null,this.operationId=Ry.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=Ry.getRootId(this.requestId))}},e.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},e.keys=new cyt.ContextTagKeys,e}(lyt);EOe.exports=pyt});var HOe=R((Qt,VOe)=>{Qt=VOe.exports=jr;var xn;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?xn=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:xn=function(){};Qt.SEMVER_SPEC_VERSION="2.0.0";var AO=256,Xq=Number.MAX_SAFE_INTEGER||9007199254740991,uoe=16,fyt=AO-6,DO=Qt.re=[],$n=Qt.safeRe=[],Ne=Qt.src=[],Br=0,hoe="[a-zA-Z0-9-]",doe=[["\\s",1],["\\d",AO],[hoe,fyt]];function nj(t){for(var e=0;e<doe.length;e++){var r=doe[e][0],n=doe[e][1];t=t.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return t}var Uk=Br++;Ne[Uk]="0|[1-9]\\d*";var Bk=Br++;Ne[Bk]="\\d+";var goe=Br++;Ne[goe]="\\d*[a-zA-Z-]"+hoe+"*";var kOe=Br++;Ne[kOe]="("+Ne[Uk]+")\\.("+Ne[Uk]+")\\.("+Ne[Uk]+")";var ROe=Br++;Ne[ROe]="("+Ne[Bk]+")\\.("+Ne[Bk]+")\\.("+Ne[Bk]+")";var poe=Br++;Ne[poe]="(?:"+Ne[Uk]+"|"+Ne[goe]+")";var foe=Br++;Ne[foe]="(?:"+Ne[Bk]+"|"+Ne[goe]+")";var voe=Br++;Ne[voe]="(?:-("+Ne[poe]+"(?:\\."+Ne[poe]+")*))";var yoe=Br++;Ne[yoe]="(?:-?("+Ne[foe]+"(?:\\."+Ne[foe]+")*))";var moe=Br++;Ne[moe]=hoe+"+";var LO=Br++;Ne[LO]="(?:\\+("+Ne[moe]+"(?:\\."+Ne[moe]+")*))";var boe=Br++,POe="v?"+Ne[kOe]+Ne[voe]+"?"+Ne[LO]+"?";Ne[boe]="^"+POe+"$";var _oe="[v=\\s]*"+Ne[ROe]+Ne[yoe]+"?"+Ne[LO]+"?",xoe=Br++;Ne[xoe]="^"+_oe+"$";var Gk=Br++;Ne[Gk]="((?:<|>)?=?)";var Jq=Br++;Ne[Jq]=Ne[Bk]+"|x|X|\\*";var Zq=Br++;Ne[Zq]=Ne[Uk]+"|x|X|\\*";var mS=Br++;Ne[mS]="[v=\\s]*("+Ne[Zq]+")(?:\\.("+Ne[Zq]+")(?:\\.("+Ne[Zq]+")(?:"+Ne[voe]+")?"+Ne[LO]+"?)?)?";var jk=Br++;Ne[jk]="[v=\\s]*("+Ne[Jq]+")(?:\\.("+Ne[Jq]+")(?:\\.("+Ne[Jq]+")(?:"+Ne[yoe]+")?"+Ne[LO]+"?)?)?";var AOe=Br++;Ne[AOe]="^"+Ne[Gk]+"\\s*"+Ne[mS]+"$";var DOe=Br++;Ne[DOe]="^"+Ne[Gk]+"\\s*"+Ne[jk]+"$";var NOe=Br++;Ne[NOe]="(?:^|[^\\d])(\\d{1,"+uoe+"})(?:\\.(\\d{1,"+uoe+"}))?(?:\\.(\\d{1,"+uoe+"}))?(?:$|[^\\d])";var ij=Br++;Ne[ij]="(?:~>?)";var Vk=Br++;Ne[Vk]="(\\s*)"+Ne[ij]+"\\s+";DO[Vk]=new RegExp(Ne[Vk],"g");$n[Vk]=new RegExp(nj(Ne[Vk]),"g");var myt="$1~",LOe=Br++;Ne[LOe]="^"+Ne[ij]+Ne[mS]+"$";var OOe=Br++;Ne[OOe]="^"+Ne[ij]+Ne[jk]+"$";var oj=Br++;Ne[oj]="(?:\\^)";var Hk=Br++;Ne[Hk]="(\\s*)"+Ne[oj]+"\\s+";DO[Hk]=new RegExp(Ne[Hk],"g");$n[Hk]=new RegExp(nj(Ne[Hk]),"g");var hyt="$1^",MOe=Br++;Ne[MOe]="^"+Ne[oj]+Ne[mS]+"$";var FOe=Br++;Ne[FOe]="^"+Ne[oj]+Ne[jk]+"$";var Soe=Br++;Ne[Soe]="^"+Ne[Gk]+"\\s*("+_oe+")$|^$";var Ioe=Br++;Ne[Ioe]="^"+Ne[Gk]+"\\s*("+POe+")$|^$";var hS=Br++;Ne[hS]="(\\s*)"+Ne[Gk]+"\\s*("+_oe+"|"+Ne[mS]+")";DO[hS]=new RegExp(Ne[hS],"g");$n[hS]=new RegExp(nj(Ne[hS]),"g");var gyt="$1$2$3",UOe=Br++;Ne[UOe]="^\\s*("+Ne[mS]+")\\s+-\\s+("+Ne[mS]+")\\s*$";var BOe=Br++;Ne[BOe]="^\\s*("+Ne[jk]+")\\s+-\\s+("+Ne[jk]+")\\s*$";var qOe=Br++;Ne[qOe]="(<|>)?=?\\s*\\*";for(Lf=0;Lf<Br;Lf++)xn(Lf,Ne[Lf]),DO[Lf]||(DO[Lf]=new RegExp(Ne[Lf]),$n[Lf]=new RegExp(nj(Ne[Lf])));var Lf;Qt.parse=gS;function gS(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof jr)return t;if(typeof t!="string"||t.length>AO)return null;var r=e.loose?$n[xoe]:$n[boe];if(!r.test(t))return null;try{return new jr(t,e)}catch{return null}}Qt.valid=vyt;function vyt(t,e){var r=gS(t,e);return r?r.version:null}Qt.clean=yyt;function yyt(t,e){var r=gS(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}Qt.SemVer=jr;function jr(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof jr){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>AO)throw new TypeError("version is longer than "+AO+" characters");if(!(this instanceof jr))return new jr(t,e);xn("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?$n[xoe]:$n[boe]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Xq||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Xq||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Xq||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var o=+n;if(o>=0&&o<Xq)return o}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}jr.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};jr.prototype.toString=function(){return this.version};jr.prototype.compare=function(t){return xn("SemVer.compare",this.version,this.options,t),t instanceof jr||(t=new jr(t,this.options)),this.compareMain(t)||this.comparePre(t)};jr.prototype.compareMain=function(t){return t instanceof jr||(t=new jr(t,this.options)),qk(this.major,t.major)||qk(this.minor,t.minor)||qk(this.patch,t.patch)};jr.prototype.comparePre=function(t){if(t instanceof jr||(t=new jr(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(xn("prerelease compare",e,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return qk(r,n)}while(++e)};jr.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};Qt.inc=byt;function byt(t,e,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new jr(t,r).inc(e,n).version}catch{return null}}Qt.diff=_yt;function _yt(t,e){if(Coe(t,e))return null;var r=gS(t),n=gS(e),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return o+a;return s}Qt.compareIdentifiers=qk;var wOe=/^[0-9]+$/;function qk(t,e){var r=wOe.test(t),n=wOe.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}Qt.rcompareIdentifiers=xyt;function xyt(t,e){return qk(e,t)}Qt.major=Syt;function Syt(t,e){return new jr(t,e).major}Qt.minor=Iyt;function Iyt(t,e){return new jr(t,e).minor}Qt.patch=Cyt;function Cyt(t,e){return new jr(t,e).patch}Qt.compare=Hh;function Hh(t,e,r){return new jr(t,r).compare(new jr(e,r))}Qt.compareLoose=Tyt;function Tyt(t,e){return Hh(t,e,!0)}Qt.rcompare=Eyt;function Eyt(t,e,r){return Hh(e,t,r)}Qt.sort=wyt;function wyt(t,e){return t.sort(function(r,n){return Qt.compare(r,n,e)})}Qt.rsort=kyt;function kyt(t,e){return t.sort(function(r,n){return Qt.rcompare(r,n,e)})}Qt.gt=NO;function NO(t,e,r){return Hh(t,e,r)>0}Qt.lt=ej;function ej(t,e,r){return Hh(t,e,r)<0}Qt.eq=Coe;function Coe(t,e,r){return Hh(t,e,r)===0}Qt.neq=jOe;function jOe(t,e,r){return Hh(t,e,r)!==0}Qt.gte=Toe;function Toe(t,e,r){return Hh(t,e,r)>=0}Qt.lte=Eoe;function Eoe(t,e,r){return Hh(t,e,r)<=0}Qt.cmp=tj;function tj(t,e,r,n){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Coe(t,r,n);case"!=":return jOe(t,r,n);case">":return NO(t,r,n);case">=":return Toe(t,r,n);case"<":return ej(t,r,n);case"<=":return Eoe(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}Qt.Comparator=Tu;function Tu(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Tu){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof Tu))return new Tu(t,e);t=t.trim().split(/\s+/).join(" "),xn("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===OO?this.value="":this.value=this.operator+this.semver.version,xn("comp",this)}var OO={};Tu.prototype.parse=function(t){var e=this.options.loose?$n[Soe]:$n[Ioe],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new jr(r[2],this.options.loose):this.semver=OO};Tu.prototype.toString=function(){return this.value};Tu.prototype.test=function(t){return xn("Comparator.test",t,this.options.loose),this.semver===OO?!0:(typeof t=="string"&&(t=new jr(t,this.options)),tj(t,this.operator,this.semver,this.options))};Tu.prototype.intersects=function(t,e){if(!(t instanceof Tu))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return r=new wi(t.value,e),rj(this.value,r,e);if(t.operator==="")return r=new wi(this.value,e),rj(t.semver,r,e);var n=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),c=tj(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),l=tj(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return n||o||s&&a||c||l};Qt.Range=wi;function wi(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof wi)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new wi(t.raw,e);if(t instanceof Tu)return new wi(t.value,e);if(!(this instanceof wi))return new wi(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}wi.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};wi.prototype.toString=function(){return this.range};wi.prototype.parseRange=function(t){var e=this.options.loose,r=e?$n[BOe]:$n[UOe];t=t.replace(r,Uyt),xn("hyphen replace",t),t=t.replace($n[hS],gyt),xn("comparator trim",t,$n[hS]),t=t.replace($n[Vk],myt),t=t.replace($n[Hk],hyt);var n=e?$n[Soe]:$n[Ioe],o=t.split(" ").map(function(s){return Pyt(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(n)})),o=o.map(function(s){return new Tu(s,this.options)},this),o};wi.prototype.intersects=function(t,e){if(!(t instanceof wi))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return t.set.some(function(o){return o.every(function(s){return n.intersects(s,e)})})})})};Qt.toComparators=Ryt;function Ryt(t,e){return new wi(t,e).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Pyt(t,e){return xn("comp",t,e),t=Nyt(t,e),xn("caret",t),t=Ayt(t,e),xn("tildes",t),t=Oyt(t,e),xn("xrange",t),t=Fyt(t,e),xn("stars",t),t}function Ka(t){return!t||t.toLowerCase()==="x"||t==="*"}function Ayt(t,e){return t.trim().split(/\s+/).map(function(r){return Dyt(r,e)}).join(" ")}function Dyt(t,e){var r=e.loose?$n[OOe]:$n[LOe];return t.replace(r,function(n,o,s,a,c){xn("tilde",t,n,o,s,a,c);var l;return Ka(o)?l="":Ka(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":Ka(a)?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(xn("replaceTilde pr",c),l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",xn("tilde return",l),l})}function Nyt(t,e){return t.trim().split(/\s+/).map(function(r){return Lyt(r,e)}).join(" ")}function Lyt(t,e){xn("caret",t,e);var r=e.loose?$n[FOe]:$n[MOe];return t.replace(r,function(n,o,s,a,c){xn("caret",t,n,o,s,a,c);var l;return Ka(o)?l="":Ka(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":Ka(a)?o==="0"?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(xn("replaceCaret pr",c),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(xn("no pr"),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),xn("caret return",l),l})}function Oyt(t,e){return xn("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return Myt(r,e)}).join(" ")}function Myt(t,e){t=t.trim();var r=e.loose?$n[DOe]:$n[AOe];return t.replace(r,function(n,o,s,a,c,l){xn("xRange",t,n,o,s,a,c,l);var u=Ka(s),d=u||Ka(a),p=d||Ka(c),f=p;return o==="="&&f&&(o=""),u?o===">"||o==="<"?n="<0.0.0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),n=o+s+"."+a+"."+c):d?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),xn("xRange return",n),n})}function Fyt(t,e){return xn("replaceStars",t,e),t.trim().replace($n[qOe],"")}function Uyt(t,e,r,n,o,s,a,c,l,u,d,p,f){return Ka(r)?e="":Ka(n)?e=">="+r+".0.0":Ka(o)?e=">="+r+"."+n+".0":e=">="+e,Ka(l)?c="":Ka(u)?c="<"+(+l+1)+".0.0":Ka(d)?c="<"+l+"."+(+u+1)+".0":p?c="<="+l+"."+u+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}wi.prototype.test=function(t){if(!t)return!1;typeof t=="string"&&(t=new jr(t,this.options));for(var e=0;e<this.set.length;e++)if(Byt(this.set[e],t,this.options))return!0;return!1};function Byt(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(n=0;n<t.length;n++)if(xn(t[n].semver),t[n].semver!==OO&&t[n].semver.prerelease.length>0){var o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}Qt.satisfies=rj;function rj(t,e,r){try{e=new wi(e,r)}catch{return!1}return e.test(t)}Qt.maxSatisfying=qyt;function qyt(t,e,r){var n=null,o=null;try{var s=new wi(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new jr(n,r))}),n}Qt.minSatisfying=jyt;function jyt(t,e,r){var n=null,o=null;try{var s=new wi(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new jr(n,r))}),n}Qt.minVersion=Vyt;function Vyt(t,e){t=new wi(t,e);var r=new jr("0.0.0");if(t.test(r)||(r=new jr("0.0.0-0"),t.test(r)))return r;r=null;for(var n=0;n<t.set.length;++n){var o=t.set[n];o.forEach(function(s){var a=new jr(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||NO(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&t.test(r)?r:null}Qt.validRange=Hyt;function Hyt(t,e){try{return new wi(t,e).range||"*"}catch{return null}}Qt.ltr=Gyt;function Gyt(t,e,r){return woe(t,e,"<",r)}Qt.gtr=zyt;function zyt(t,e,r){return woe(t,e,">",r)}Qt.outside=woe;function woe(t,e,r,n){t=new jr(t,n),e=new wi(e,n);var o,s,a,c,l;switch(r){case">":o=NO,s=Eoe,a=ej,c=">",l=">=";break;case"<":o=ej,s=Toe,a=NO,c="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(rj(t,e,n))return!1;for(var u=0;u<e.set.length;++u){var d=e.set[u],p=null,f=null;if(d.forEach(function(m){m.semver===OO&&(m=new Tu(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===l||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===l&&a(t,f.semver))return!1}return!0}Qt.prerelease=$yt;function $yt(t,e){var r=gS(t,e);return r&&r.prerelease.length?r.prerelease:null}Qt.intersects=Wyt;function Wyt(t,e,r){return t=new wi(t,r),e=new wi(e,r),t.intersects(e)}Qt.coerce=Kyt;function Kyt(t){if(t instanceof jr)return t;if(typeof t!="string")return null;var e=t.match($n[NOe]);return e==null?null:gS(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var sj=R((AXr,$Oe)=>{"use strict";function koe(t){return typeof t=="function"}var Ya=console.error.bind(console);function MO(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function FO(t){t&&t.logger&&(koe(t.logger)?Ya=t.logger:Ya("new logger isn't a function, not replacing"))}function GOe(t,e,r){if(!t||!t[e]){Ya("no original function "+e+" to wrap");return}if(!r){Ya("no wrapper function"),Ya(new Error().stack);return}if(!koe(t[e])||!koe(r)){Ya("original object and wrapper must be functions");return}var n=t[e],o=r(n,e);return MO(o,"__original",n),MO(o,"__unwrap",function(){t[e]===o&&MO(t,e,n)}),MO(o,"__wrapped",!0),MO(t,e,o),o}function Yyt(t,e,r){if(t)Array.isArray(t)||(t=[t]);else{Ya("must provide one or more modules to patch"),Ya(new Error().stack);return}if(!(e&&Array.isArray(e))){Ya("must provide one or more functions to wrap on modules");return}t.forEach(function(n){e.forEach(function(o){GOe(n,o,r)})})}function zOe(t,e){if(!t||!t[e]){Ya("no function to unwrap."),Ya(new Error().stack);return}if(!t[e].__unwrap)Ya("no original to unwrap to -- has "+e+" already been unwrapped?");else return t[e].__unwrap()}function Qyt(t,e){if(t)Array.isArray(t)||(t=[t]);else{Ya("must provide one or more modules to patch"),Ya(new Error().stack);return}if(!(e&&Array.isArray(e))){Ya("must provide one or more functions to unwrap on modules");return}t.forEach(function(r){e.forEach(function(n){zOe(r,n)})})}FO.wrap=GOe;FO.massWrap=Yyt;FO.unwrap=zOe;FO.massUnwrap=Qyt;$Oe.exports=FO});var lj=R((DXr,QOe)=>{"use strict";var KOe=sj(),zk=KOe.wrap,aj=KOe.unwrap,Gh="wrap@before";function cj(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function Xyt(t,e){for(var r=e.length,n=0;n<r;n++){var o=e[n],s=t[Gh];if(typeof s=="function")s(o);else if(Array.isArray(s))for(var a=s.length,c=0;c<a;c++)s[c](o)}}function YOe(t,e){var r;return r=t._events&&t._events[e],Array.isArray(r)||(r?r=[r]:r=[]),r}function Jyt(t,e,r){var n=YOe(t,e),o=n.filter(function(s){return r.indexOf(s)===-1});o.length>0&&Xyt(t,o)}function WOe(t,e){if(t){var r=t;if(typeof t=="function")r=e(t);else if(Array.isArray(t)){r=[];for(var n=0;n<t.length;n++)r[n]=e(t[n])}return r}}QOe.exports=function(e,r,n){if(!e||!e.on||!e.addListener||!e.removeListener||!e.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function o(a){return function(l,u){var d=YOe(this,l).slice();try{var p=a.call(this,l,u);return Jyt(this,l,d),p}finally{this.on.__wrapped||zk(this,"on",o),this.addListener.__wrapped||zk(this,"addListener",o)}}}function s(a){return function(l){if(!this._events||!this._events[l])return a.apply(this,arguments);var u=this._events[l];function d(p){return function(){this._events[l]=u;try{return p.apply(this,arguments)}finally{u=this._events[l],this._events[l]=WOe(u,n)}}}zk(this,"removeListener",d);try{return this._events[l]=WOe(u,n),a.apply(this,arguments)}finally{aj(this,"removeListener"),this._events[l]=u}}}e[Gh]?typeof e[Gh]=="function"?cj(e,Gh,[e[Gh],r]):Array.isArray(e[Gh])&&e[Gh].push(r):cj(e,Gh,r),e.__wrapped||(zk(e,"addListener",o),zk(e,"on",o),zk(e,"emit",s),cj(e,"__unwrap",function(){aj(e,"addListener"),aj(e,"on"),aj(e,"emit"),delete e[Gh],delete e.__wrapped}),cj(e,"__wrapped",!0))}});var e4e=R((NXr,ZOe)=>{"use strict";var cn=require("util"),zh=require("assert"),Zyt=lj(),ii=require("async_hooks"),UO="cls@contexts",BO="error@context",ki=process.env.DEBUG_CLS_HOOKED,an=-1;ZOe.exports={getNamespace:XOe,createNamespace:ebt,destroyNamespace:JOe,reset:tbt,ERROR_SYMBOL:BO};function Eu(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}Eu.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[e]=r,ki){let n=" ".repeat(this._indent<0?0:this._indent);fi(n+"CONTEXT-SET KEY:"+e+"="+r+" in ns:"+this.name+" currentUid:"+an+" active:"+cn.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};Eu.prototype.get=function(e){if(!this.active){if(ki){let r=ii.currentId(),n=ii.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);fi(`${o}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${an} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(ki){let r=ii.executionAsyncId(),n=ii.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);fi(o+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+an+" active:"+cn.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),fi(`${o}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${an} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${cn.inspect(this.active)}`)}return this.active[e]};Eu.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=an,ki){let r=ii.executionAsyncId(),n=ii.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);fi(`${o}CONTEXT-CREATED Context: (${this.name}) currentUid:${an} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${cn.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e};Eu.prototype.run=function(e){let r=this.createContext();this.enter(r);try{if(ki){let n=ii.triggerAsyncId(),o=ii.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);fi(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${an} triggerId:${n} asyncHooksCurrentId:${o} len:${this._set.length} context:${cn.inspect(r)}`)}return e(r),r}catch(n){throw n&&(n[BO]=r),n}finally{if(ki){let n=ii.triggerAsyncId(),o=ii.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);fi(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${an} triggerId:${n} asyncHooksCurrentId:${o} len:${this._set.length} ${cn.inspect(r)}`)}this.exit(r)}};Eu.prototype.runAndReturn=function(e){let r;return this.run(function(n){r=e(n)}),r};Eu.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return ki&&fi("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+an+" len:"+this._set.length+" "+cn.inspect(r)),n.then(o=>(ki&&fi("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+an+" len:"+this._set.length+" "+cn.inspect(r)),this.exit(r),o)).catch(o=>{throw o[BO]=r,ki&&fi("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+an+" len:"+this._set.length+" "+cn.inspect(r)),this.exit(r),o})};Eu.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[BO]=r),s}finally{n.exit(r)}}};Eu.prototype.enter=function(e){if(zh.ok(e,"context must be provided for entering"),ki){let r=ii.executionAsyncId(),n=ii.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);fi(`${o}CONTEXT-ENTER: (${this.name}) currentUid:${an} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${cn.inspect(e)}`)}this._set.push(this.active),this.active=e};Eu.prototype.exit=function(e){if(zh.ok(e,"context must be provided for exiting"),ki){let n=ii.executionAsyncId(),o=ii.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);fi(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${an} triggerId:${o} asyncHooksCurrentId:${n} len:${this._set.length} ${cn.inspect(e)}`)}if(this.active===e){zh.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(ki&&fi("??ERROR?? context exiting but not entered - ignoring: "+cn.inspect(e)),zh.ok(r>=0,`context not currently entered; can't exit. 
`+cn.inspect(this)+`
`+cn.inspect(e))):(zh.ok(r,"can't remove top context"),this._set.splice(r,1))};Eu.prototype.bindEmitter=function(e){zh.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function o(a){a&&(a[UO]||(a[UO]=Object.create(null)),a[UO][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[UO]))return a;let c=a,l=a[UO];return Object.keys(l).forEach(function(u){let d=l[u];c=d.namespace.bind(c,d.context)}),c}Zyt(e,o,s)};Eu.prototype.fromException=function(e){return e[BO]};function XOe(t){return process.namespaces[t]}function ebt(t){zh.ok(t,"namespace must be given a name."),ki&&fi(`NS-CREATING NAMESPACE (${t})`);let e=new Eu(t);return e.id=an,ii.createHook({init(n,o,s,a){if(an=ii.executionAsyncId(),e.active){if(e._contexts.set(n,e.active),ki){let c=" ".repeat(e._indent<0?0:e._indent);fi(`${c}INIT [${o}] (${t}) asyncId:${n} currentUid:${an} triggerId:${s} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(an===0){let c=ii.triggerAsyncId(),l=e._contexts.get(c);if(l){if(e._contexts.set(n,l),ki){let u=" ".repeat(e._indent<0?0:e._indent);fi(`${u}INIT USING CONTEXT FROM TRIGGERID [${o}] (${t}) asyncId:${n} currentUid:${an} triggerId:${c} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(ki){let u=" ".repeat(e._indent<0?0:e._indent);fi(`${u}INIT MISSING CONTEXT [${o}] (${t}) asyncId:${n} currentUid:${an} triggerId:${c} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(ki&&o==="PROMISE"){fi(cn.inspect(a,{showHidden:!0}));let c=a.parentId,l=" ".repeat(e._indent<0?0:e._indent);fi(`${l}INIT RESOURCE-PROMISE [${o}] (${t}) parentId:${c} asyncId:${n} currentUid:${an} triggerId:${s} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(n){an=ii.executionAsyncId();let o;if(o=e._contexts.get(n)||e._contexts.get(an),o){if(ki){let s=ii.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);fi(`${a}BEFORE (${t}) asyncId:${n} currentUid:${an} triggerId:${s} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${cn.inspect(o)}`),e._indent+=2}e.enter(o)}else if(ki){let s=ii.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);fi(`${a}BEFORE MISSING CONTEXT (${t}) asyncId:${n} currentUid:${an} triggerId:${s} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${cn.inspect(e._contexts,{showHidden:!0,depth:2,colors:!0})}`),e._indent+=2}},after(n){an=ii.executionAsyncId();let o;if(o=e._contexts.get(n)||e._contexts.get(an),o){if(ki){let s=ii.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);fi(`${a}AFTER (${t}) asyncId:${n} currentUid:${an} triggerId:${s} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${cn.inspect(o)}`)}e.exit(o)}else if(ki){let s=ii.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);fi(`${a}AFTER MISSING CONTEXT (${t}) asyncId:${n} currentUid:${an} triggerId:${s} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${cn.inspect(o)}`)}},destroy(n){if(an=ii.executionAsyncId(),ki){let o=ii.triggerAsyncId(),s=" ".repeat(e._indent<0?0:e._indent);fi(`${s}DESTROY (${t}) currentUid:${an} asyncId:${n} triggerId:${o} active:${cn.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${cn.inspect(e._contexts.get(an))}`)}e._contexts.delete(n)}}).enable(),process.namespaces[t]=e,e}function JOe(t){let e=XOe(t);zh.ok(e,`can't delete nonexistent namespace! "`+t+'"'),zh.ok(e.id,"don't assign to process.namespaces directly! "+cn.inspect(e)),process.namespaces[t]=null}function tbt(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){JOe(t)}),process.namespaces=Object.create(null)}process.namespaces={};function fi(...t){ki&&process._rawDebug(`${cn.format(...t)}`)}});var r4e=R((LXr,t4e)=>{"use strict";function rbt(){}t4e.exports=function(){let e=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let o=new Array(arguments.length);for(let l=0;l<arguments.length;l++)o[l]=arguments[l];let s=o[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new rbt,c=--r.counter;return e.init.call(a,c,0,null,null),o[0]=function(){e.pre.call(a,c);let l=!0;try{s.apply(this,arguments),l=!1}finally{l&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(a,c,!0),e.destroy.call(null,c)})}e.post.call(a,c,!1),e.destroy.call(null,c)},n.apply(process,o)}}});var i4e=R((OXr,n4e)=>{"use strict";function nbt(){}n4e.exports=function(){let e=this._hooks,r=this._state,n=global.Promise,o=n.prototype.then;n.prototype.then=l;function s(u,d,p,f){return typeof u!="function"?f?a(p):c(p):function(){e.pre.call(d,p);try{return u.apply(this,arguments)}finally{e.post.call(d,p,!1),e.destroy.call(null,p)}}}function a(u){return function(p){return e.destroy.call(null,u),p}}function c(u){return function(p){throw e.destroy.call(null,u),p}}function l(u,d){if(!r.enabled)return o.call(this,u,d);let p=new nbt,f=--r.counter;return e.init.call(p,f,0,null,null),o.call(this,s(u,p,f,!0),s(d,p,f,!1))}}});var s4e=R((MXr,o4e)=>{"use strict";var Il=require("timers");function ibt(){}function obt(){}function sbt(){}var abt=new Map,cbt=new Map,lbt=new Map,Roe=null,Poe=!1;o4e.exports=function(){Aoe(this._hooks,this._state,"setTimeout","clearTimeout",ibt,abt,!0),Aoe(this._hooks,this._state,"setInterval","clearInterval",obt,cbt,!1),Aoe(this._hooks,this._state,"setImmediate","clearImmediate",sbt,lbt,!0),global.setTimeout=Il.setTimeout,global.setInterval=Il.setInterval,global.setImmediate=Il.setImmediate,global.clearTimeout=Il.clearTimeout,global.clearInterval=Il.clearInterval,global.clearImmediate=Il.clearImmediate};function Aoe(t,e,r,n,o,s,a){let c=Il[r],l=Il[n];Il[r]=function(){if(!e.enabled)return c.apply(Il,arguments);let u=new Array(arguments.length);for(let h=0;h<arguments.length;h++)u[h]=arguments[h];let d=u[0];if(typeof d!="function")throw new TypeError('"callback" argument must be a function');let p=new o,f=--e.counter,m;return t.init.call(p,f,0,null,null),u[0]=function(){Roe=m,t.pre.call(p,f);let h=!0;try{d.apply(this,arguments),h=!1}finally{h&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(p,f,!0),s.delete(m),t.destroy.call(null,f)})}t.post.call(p,f,!1),Roe=null,(a||Poe)&&(Poe=!1,s.delete(m),t.destroy.call(null,f))},m=c.apply(Il,u),s.set(m,f),m},Il[n]=function(u){if(Roe===u&&u!==null)Poe=!0;else if(s.has(u)){let d=s.get(u);s.delete(u),t.destroy.call(null,d)}l.apply(Il,arguments)}}});var l4e=R((FXr,c4e)=>{"use strict";var jO=process.binding("async_wrap"),ubt=jO.Providers.TIMERWRAP,a4e={nextTick:r4e(),promise:i4e(),timers:s4e()},qO=new Set;function dbt(){this.enabled=!1,this.counter=0}function Doe(){let t=this.initFns=[],e=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(o,s,a,c){if(s===ubt){qO.add(o);return}for(let l of t)l(o,this,s,a,c)},this.pre=function(o){if(!qO.has(o))for(let s of e)s(o,this)},this.post=function(o,s){if(!qO.has(o))for(let a of r)a(o,this,s)},this.destroy=function(o){if(qO.has(o)){qO.delete(o);return}for(let s of n)s(o)}}Doe.prototype.add=function(t){t.init&&this.initFns.push(t.init),t.pre&&this.preFns.push(t.pre),t.post&&this.postFns.push(t.post),t.destroy&&this.destroyFns.push(t.destroy)};function uj(t,e){let r=t.indexOf(e);r!==-1&&t.splice(r,1)}Doe.prototype.remove=function(t){t.init&&uj(this.initFns,t.init),t.pre&&uj(this.preFns,t.pre),t.post&&uj(this.postFns,t.post),t.destroy&&uj(this.destroyFns,t.destroy)};function VO(){this._state=new dbt,this._hooks=new Doe,this.version=require("./package.json").version,this.providers=jO.Providers;for(let t of Object.keys(a4e))a4e[t].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),jO.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}c4e.exports=VO;VO.prototype.addHooks=function(t){this._hooks.add(t)};VO.prototype.removeHooks=function(t){this._hooks.remove(t)};VO.prototype.enable=function(){this._state.enabled=!0,jO.enable()};VO.prototype.disable=function(){this._state.enabled=!1,jO.disable()}});var d4e=R((UXr,u4e)=>{function pbt(t){try{return Error.prototype.toString.call(t)}catch(e){try{return"<error: "+e+">"}catch{return"<error>"}}}u4e.exports=function(e,r){var n=[];n.push(pbt(e));for(var o=0;o<r.length;o++){var s=r[o],a;try{a=s.toString()}catch(c){try{a="<error: "+c+">"}catch{a="<error>"}}n.push("    at "+a)}return n.join(`
`)}});var h4e=R((BXr,m4e)=>{var dj=d4e();function f4e(){this.extend=new HO,this.filter=new HO,this.format=new GO,this.version=require("./package.json").version}var Loe=!1;f4e.prototype.callSite=function t(e){e||(e={}),Loe=!0;var r={};Error.captureStackTrace(r,t);var n=r.stack;return Loe=!1,n=n.slice(e.slice||0),e.extend&&(n=this.extend._modify(r,n)),e.filter&&(n=this.filter._modify(r,n)),n};var Py=new f4e;function HO(){this._modifiers=[]}HO.prototype._modify=function(t,e){for(var r=0,n=this._modifiers.length;r<n;r++)e=this._modifiers[r](t,e);return e};HO.prototype.attach=function(t){this._modifiers.push(t)};HO.prototype.deattach=function(t){var e=this._modifiers.indexOf(t);return e===-1?!1:(this._modifiers.splice(e,1),!0)};function GO(){this._formater=dj,this._previous=void 0}GO.prototype.replace=function(t){t?this._formater=t:this.restore()};GO.prototype.restore=function(){this._formater=dj,this._previous=void 0};GO.prototype._backup=function(){this._previous=this._formater};GO.prototype._roolback=function(){this._previous===dj?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&Py.format.replace(Error.prepareStackTrace);var Noe=!1;function p4e(t,e){if(Loe)return e;if(Noe)return dj(t,e);var r=e.concat();r=Py.extend._modify(t,r),r=Py.filter._modify(t,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(t)&&Object.getOwnPropertyDescriptor(t,"callSite")===void 0&&(t.callSite={original:e,mutated:r}),Noe=!0;var n=Py.format._formater(t,r);return Noe=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return p4e},set:function(t){t===p4e?Py.format._roolback():(Py.format._backup(),Py.format.replace(t))}});function fbt(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:fbt,set:function(t){Object.defineProperty(this,"callSite",{value:t,writable:!0,configurable:!0})},configurable:!0});m4e.exports=Py});var Moe=R((qXr,Ooe)=>{if(global._stackChain)if(global._stackChain.version===require("./package.json").version)Ooe.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else Ooe.exports=global._stackChain=h4e()});var g4e=R((jXr,Foe)=>{"use strict";var mbt=l4e();if(global._asyncHook)if(global._asyncHook.version===require("./package.json").version)Foe.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else Moe().filter.attach(function(e,r){return r.filter(function(n){let o=n.getFileName();return!(o&&o.slice(0,__dirname.length)===__dirname)})}),Foe.exports=global._asyncHook=new mbt});var S4e=R((VXr,x4e)=>{"use strict";var so=require("util"),$h=require("assert"),hbt=lj(),$k=g4e(),zO="cls@contexts",$O="error@context",y4e=[];for(let t in $k.providers)y4e[$k.providers[t]]=t;var zi=process.env.DEBUG_CLS_HOOKED,ko=-1;x4e.exports={getNamespace:b4e,createNamespace:gbt,destroyNamespace:_4e,reset:vbt,ERROR_SYMBOL:$O};function wu(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map}wu.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return zi&&oo("    SETTING KEY:"+e+"="+r+" in ns:"+this.name+" uid:"+ko+" active:"+so.inspect(this.active,!0)),this.active[e]=r,r};wu.prototype.get=function(e){if(!this.active){zi&&oo("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+ko+" active:"+so.inspect(this.active,!0));return}return zi&&oo("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+ko+" active:"+so.inspect(this.active,!0)),this.active[e]};wu.prototype.createContext=function(){zi&&oo("   CREATING Context: "+this.name+" uid:"+ko+" len:"+this._set.length+"  active:"+so.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=ko,zi&&oo("   CREATED Context: "+this.name+" uid:"+ko+" len:"+this._set.length+"  context:"+so.inspect(e,!0,2,!0)),e};wu.prototype.run=function(e){let r=this.createContext();this.enter(r);try{return zi&&oo(" BEFORE RUN: "+this.name+" uid:"+ko+" len:"+this._set.length+" "+so.inspect(r)),e(r),r}catch(n){throw n&&(n[$O]=r),n}finally{zi&&oo(" AFTER RUN: "+this.name+" uid:"+ko+" len:"+this._set.length+" "+so.inspect(r)),this.exit(r)}};wu.prototype.runAndReturn=function(e){var r;return this.run(function(n){r=e(n)}),r};wu.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return zi&&oo(" BEFORE runPromise: "+this.name+" uid:"+ko+" len:"+this._set.length+" "+so.inspect(r)),n.then(o=>(zi&&oo(" AFTER runPromise: "+this.name+" uid:"+ko+" len:"+this._set.length+" "+so.inspect(r)),this.exit(r),o)).catch(o=>{throw o[$O]=r,zi&&oo(" AFTER runPromise: "+this.name+" uid:"+ko+" len:"+this._set.length+" "+so.inspect(r)),this.exit(r),o})};wu.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[$O]=r),s}finally{n.exit(r)}}};wu.prototype.enter=function(e){$h.ok(e,"context must be provided for entering"),zi&&oo("  ENTER "+this.name+" uid:"+ko+" len:"+this._set.length+" context: "+so.inspect(e)),this._set.push(this.active),this.active=e};wu.prototype.exit=function(e){if($h.ok(e,"context must be provided for exiting"),zi&&oo("  EXIT "+this.name+" uid:"+ko+" len:"+this._set.length+" context: "+so.inspect(e)),this.active===e){$h.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(zi&&oo("??ERROR?? context exiting but not entered - ignoring: "+so.inspect(e)),$h.ok(r>=0,`context not currently entered; can't exit. 
`+so.inspect(this)+`
`+so.inspect(e))):($h.ok(r,"can't remove top context"),this._set.splice(r,1))};wu.prototype.bindEmitter=function(e){$h.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function o(a){a&&(a[zO]||(a[zO]=Object.create(null)),a[zO][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[zO]))return a;let c=a,l=a[zO];return Object.keys(l).forEach(function(u){let d=l[u];c=d.namespace.bind(c,d.context)}),c}hbt(e,o,s)};wu.prototype.fromException=function(e){return e[$O]};function b4e(t){return process.namespaces[t]}function gbt(t){$h.ok(t,"namespace must be given a name."),zi&&oo("CREATING NAMESPACE "+t);let e=new wu(t);return e.id=ko,$k.addHooks({init(r,n,o,s,a){ko=r,s?(e._contexts.set(r,e._contexts.get(s)),zi&&oo("PARENTID: "+t+" uid:"+r+" parent:"+s+" provider:"+o)):e._contexts.set(ko,e.active),zi&&oo("INIT "+t+" uid:"+r+" parent:"+s+" provider:"+y4e[o]+" active:"+so.inspect(e.active,!0))},pre(r,n){ko=r;let o=e._contexts.get(r);o?(zi&&oo(" PRE "+t+" uid:"+r+" handle:"+pj(n)+" context:"+so.inspect(o)),e.enter(o)):zi&&oo(" PRE MISSING CONTEXT "+t+" uid:"+r+" handle:"+pj(n))},post(r,n){ko=r;let o=e._contexts.get(r);o?(zi&&oo(" POST "+t+" uid:"+r+" handle:"+pj(n)+" context:"+so.inspect(o)),e.exit(o)):zi&&oo(" POST MISSING CONTEXT "+t+" uid:"+r+" handle:"+pj(n))},destroy(r){ko=r,zi&&oo("DESTROY "+t+" uid:"+r+" context:"+so.inspect(e._contexts.get(ko))+" active:"+so.inspect(e.active,!0)),e._contexts.delete(r)}}),process.namespaces[t]=e,e}function _4e(t){let e=b4e(t);$h.ok(e,`can't delete nonexistent namespace! "`+t+'"'),$h.ok(e.id,"don't assign to process.namespaces directly! "+so.inspect(e)),process.namespaces[t]=null}function vbt(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){_4e(t)}),process.namespaces=Object.create(null)}process.namespaces={};$k._state&&!$k._state.enabled&&$k.enable();function oo(t){process.env.DEBUG&&process._rawDebug(t)}function pj(t){if(!t)return t;if(typeof t=="function")return t.name?t.name:(t.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(t.constructor&&t.constructor.name)return t.constructor.name}if(zi){Uoe=Moe();for(v4e in Uoe.filter._modifiers)Uoe.filter.deattach(v4e)}var Uoe,v4e});var I4e=R((HXr,Boe)=>{"use strict";var ybt=HOe();process&&ybt.gte(process.versions.node,"8.0.0")?Boe.exports=e4e():Boe.exports=S4e()});var q4e=R((Xt,B4e)=>{Xt=B4e.exports=Vr;var Sn;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?Sn=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:Sn=function(){};Xt.SEMVER_SPEC_VERSION="2.0.0";var WO=256,fj=Number.MAX_SAFE_INTEGER||9007199254740991,qoe=16,bbt=WO-6,KO=Xt.re=[],Wn=Xt.safeRe=[],Le=Xt.src=[],qr=0,zoe="[a-zA-Z0-9-]",joe=[["\\s",1],["\\d",WO],[zoe,bbt]];function bj(t){for(var e=0;e<joe.length;e++){var r=joe[e][0],n=joe[e][1];t=t.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return t}var Wk=qr++;Le[Wk]="0|[1-9]\\d*";var Kk=qr++;Le[Kk]="\\d+";var $oe=qr++;Le[$oe]="\\d*[a-zA-Z-]"+zoe+"*";var T4e=qr++;Le[T4e]="("+Le[Wk]+")\\.("+Le[Wk]+")\\.("+Le[Wk]+")";var E4e=qr++;Le[E4e]="("+Le[Kk]+")\\.("+Le[Kk]+")\\.("+Le[Kk]+")";var Voe=qr++;Le[Voe]="(?:"+Le[Wk]+"|"+Le[$oe]+")";var Hoe=qr++;Le[Hoe]="(?:"+Le[Kk]+"|"+Le[$oe]+")";var Woe=qr++;Le[Woe]="(?:-("+Le[Voe]+"(?:\\."+Le[Voe]+")*))";var Koe=qr++;Le[Koe]="(?:-?("+Le[Hoe]+"(?:\\."+Le[Hoe]+")*))";var Goe=qr++;Le[Goe]=zoe+"+";var QO=qr++;Le[QO]="(?:\\+("+Le[Goe]+"(?:\\."+Le[Goe]+")*))";var Yoe=qr++,w4e="v?"+Le[T4e]+Le[Woe]+"?"+Le[QO]+"?";Le[Yoe]="^"+w4e+"$";var Qoe="[v=\\s]*"+Le[E4e]+Le[Koe]+"?"+Le[QO]+"?",Xoe=qr++;Le[Xoe]="^"+Qoe+"$";var Zk=qr++;Le[Zk]="((?:<|>)?=?)";var mj=qr++;Le[mj]=Le[Kk]+"|x|X|\\*";var hj=qr++;Le[hj]=Le[Wk]+"|x|X|\\*";var vS=qr++;Le[vS]="[v=\\s]*("+Le[hj]+")(?:\\.("+Le[hj]+")(?:\\.("+Le[hj]+")(?:"+Le[Woe]+")?"+Le[QO]+"?)?)?";var Qk=qr++;Le[Qk]="[v=\\s]*("+Le[mj]+")(?:\\.("+Le[mj]+")(?:\\.("+Le[mj]+")(?:"+Le[Koe]+")?"+Le[QO]+"?)?)?";var k4e=qr++;Le[k4e]="^"+Le[Zk]+"\\s*"+Le[vS]+"$";var R4e=qr++;Le[R4e]="^"+Le[Zk]+"\\s*"+Le[Qk]+"$";var P4e=qr++;Le[P4e]="(?:^|[^\\d])(\\d{1,"+qoe+"})(?:\\.(\\d{1,"+qoe+"}))?(?:\\.(\\d{1,"+qoe+"}))?(?:$|[^\\d])";var _j=qr++;Le[_j]="(?:~>?)";var Xk=qr++;Le[Xk]="(\\s*)"+Le[_j]+"\\s+";KO[Xk]=new RegExp(Le[Xk],"g");Wn[Xk]=new RegExp(bj(Le[Xk]),"g");var _bt="$1~",A4e=qr++;Le[A4e]="^"+Le[_j]+Le[vS]+"$";var D4e=qr++;Le[D4e]="^"+Le[_j]+Le[Qk]+"$";var xj=qr++;Le[xj]="(?:\\^)";var Jk=qr++;Le[Jk]="(\\s*)"+Le[xj]+"\\s+";KO[Jk]=new RegExp(Le[Jk],"g");Wn[Jk]=new RegExp(bj(Le[Jk]),"g");var xbt="$1^",N4e=qr++;Le[N4e]="^"+Le[xj]+Le[vS]+"$";var L4e=qr++;Le[L4e]="^"+Le[xj]+Le[Qk]+"$";var Joe=qr++;Le[Joe]="^"+Le[Zk]+"\\s*("+Qoe+")$|^$";var Zoe=qr++;Le[Zoe]="^"+Le[Zk]+"\\s*("+w4e+")$|^$";var yS=qr++;Le[yS]="(\\s*)"+Le[Zk]+"\\s*("+Qoe+"|"+Le[vS]+")";KO[yS]=new RegExp(Le[yS],"g");Wn[yS]=new RegExp(bj(Le[yS]),"g");var Sbt="$1$2$3",O4e=qr++;Le[O4e]="^\\s*("+Le[vS]+")\\s+-\\s+("+Le[vS]+")\\s*$";var M4e=qr++;Le[M4e]="^\\s*("+Le[Qk]+")\\s+-\\s+("+Le[Qk]+")\\s*$";var F4e=qr++;Le[F4e]="(<|>)?=?\\s*\\*";for(Of=0;Of<qr;Of++)Sn(Of,Le[Of]),KO[Of]||(KO[Of]=new RegExp(Le[Of]),Wn[Of]=new RegExp(bj(Le[Of])));var Of;Xt.parse=bS;function bS(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Vr)return t;if(typeof t!="string"||t.length>WO)return null;var r=e.loose?Wn[Xoe]:Wn[Yoe];if(!r.test(t))return null;try{return new Vr(t,e)}catch{return null}}Xt.valid=Ibt;function Ibt(t,e){var r=bS(t,e);return r?r.version:null}Xt.clean=Cbt;function Cbt(t,e){var r=bS(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}Xt.SemVer=Vr;function Vr(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Vr){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>WO)throw new TypeError("version is longer than "+WO+" characters");if(!(this instanceof Vr))return new Vr(t,e);Sn("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?Wn[Xoe]:Wn[Yoe]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>fj||this.major<0)throw new TypeError("Invalid major version");if(this.minor>fj||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>fj||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var o=+n;if(o>=0&&o<fj)return o}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}Vr.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Vr.prototype.toString=function(){return this.version};Vr.prototype.compare=function(t){return Sn("SemVer.compare",this.version,this.options,t),t instanceof Vr||(t=new Vr(t,this.options)),this.compareMain(t)||this.comparePre(t)};Vr.prototype.compareMain=function(t){return t instanceof Vr||(t=new Vr(t,this.options)),Yk(this.major,t.major)||Yk(this.minor,t.minor)||Yk(this.patch,t.patch)};Vr.prototype.comparePre=function(t){if(t instanceof Vr||(t=new Vr(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(Sn("prerelease compare",e,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return Yk(r,n)}while(++e)};Vr.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};Xt.inc=Tbt;function Tbt(t,e,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new Vr(t,r).inc(e,n).version}catch{return null}}Xt.diff=Ebt;function Ebt(t,e){if(ese(t,e))return null;var r=bS(t),n=bS(e),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return o+a;return s}Xt.compareIdentifiers=Yk;var C4e=/^[0-9]+$/;function Yk(t,e){var r=C4e.test(t),n=C4e.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}Xt.rcompareIdentifiers=wbt;function wbt(t,e){return Yk(e,t)}Xt.major=kbt;function kbt(t,e){return new Vr(t,e).major}Xt.minor=Rbt;function Rbt(t,e){return new Vr(t,e).minor}Xt.patch=Pbt;function Pbt(t,e){return new Vr(t,e).patch}Xt.compare=Wh;function Wh(t,e,r){return new Vr(t,r).compare(new Vr(e,r))}Xt.compareLoose=Abt;function Abt(t,e){return Wh(t,e,!0)}Xt.rcompare=Dbt;function Dbt(t,e,r){return Wh(e,t,r)}Xt.sort=Nbt;function Nbt(t,e){return t.sort(function(r,n){return Xt.compare(r,n,e)})}Xt.rsort=Lbt;function Lbt(t,e){return t.sort(function(r,n){return Xt.rcompare(r,n,e)})}Xt.gt=YO;function YO(t,e,r){return Wh(t,e,r)>0}Xt.lt=gj;function gj(t,e,r){return Wh(t,e,r)<0}Xt.eq=ese;function ese(t,e,r){return Wh(t,e,r)===0}Xt.neq=U4e;function U4e(t,e,r){return Wh(t,e,r)!==0}Xt.gte=tse;function tse(t,e,r){return Wh(t,e,r)>=0}Xt.lte=rse;function rse(t,e,r){return Wh(t,e,r)<=0}Xt.cmp=vj;function vj(t,e,r,n){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return ese(t,r,n);case"!=":return U4e(t,r,n);case">":return YO(t,r,n);case">=":return tse(t,r,n);case"<":return gj(t,r,n);case"<=":return rse(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}Xt.Comparator=ku;function ku(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof ku){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof ku))return new ku(t,e);t=t.trim().split(/\s+/).join(" "),Sn("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===XO?this.value="":this.value=this.operator+this.semver.version,Sn("comp",this)}var XO={};ku.prototype.parse=function(t){var e=this.options.loose?Wn[Joe]:Wn[Zoe],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new Vr(r[2],this.options.loose):this.semver=XO};ku.prototype.toString=function(){return this.value};ku.prototype.test=function(t){return Sn("Comparator.test",t,this.options.loose),this.semver===XO?!0:(typeof t=="string"&&(t=new Vr(t,this.options)),vj(t,this.operator,this.semver,this.options))};ku.prototype.intersects=function(t,e){if(!(t instanceof ku))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return r=new Ri(t.value,e),yj(this.value,r,e);if(t.operator==="")return r=new Ri(this.value,e),yj(t.semver,r,e);var n=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),c=vj(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),l=vj(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return n||o||s&&a||c||l};Xt.Range=Ri;function Ri(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Ri)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new Ri(t.raw,e);if(t instanceof ku)return new Ri(t.value,e);if(!(this instanceof Ri))return new Ri(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Ri.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};Ri.prototype.toString=function(){return this.range};Ri.prototype.parseRange=function(t){var e=this.options.loose,r=e?Wn[M4e]:Wn[O4e];t=t.replace(r,Gbt),Sn("hyphen replace",t),t=t.replace(Wn[yS],Sbt),Sn("comparator trim",t,Wn[yS]),t=t.replace(Wn[Xk],_bt),t=t.replace(Wn[Jk],xbt);var n=e?Wn[Joe]:Wn[Zoe],o=t.split(" ").map(function(s){return Mbt(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(n)})),o=o.map(function(s){return new ku(s,this.options)},this),o};Ri.prototype.intersects=function(t,e){if(!(t instanceof Ri))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return t.set.some(function(o){return o.every(function(s){return n.intersects(s,e)})})})})};Xt.toComparators=Obt;function Obt(t,e){return new Ri(t,e).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Mbt(t,e){return Sn("comp",t,e),t=Bbt(t,e),Sn("caret",t),t=Fbt(t,e),Sn("tildes",t),t=jbt(t,e),Sn("xrange",t),t=Hbt(t,e),Sn("stars",t),t}function Qa(t){return!t||t.toLowerCase()==="x"||t==="*"}function Fbt(t,e){return t.trim().split(/\s+/).map(function(r){return Ubt(r,e)}).join(" ")}function Ubt(t,e){var r=e.loose?Wn[D4e]:Wn[A4e];return t.replace(r,function(n,o,s,a,c){Sn("tilde",t,n,o,s,a,c);var l;return Qa(o)?l="":Qa(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":Qa(a)?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(Sn("replaceTilde pr",c),l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",Sn("tilde return",l),l})}function Bbt(t,e){return t.trim().split(/\s+/).map(function(r){return qbt(r,e)}).join(" ")}function qbt(t,e){Sn("caret",t,e);var r=e.loose?Wn[L4e]:Wn[N4e];return t.replace(r,function(n,o,s,a,c){Sn("caret",t,n,o,s,a,c);var l;return Qa(o)?l="":Qa(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":Qa(a)?o==="0"?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(Sn("replaceCaret pr",c),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(Sn("no pr"),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),Sn("caret return",l),l})}function jbt(t,e){return Sn("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return Vbt(r,e)}).join(" ")}function Vbt(t,e){t=t.trim();var r=e.loose?Wn[R4e]:Wn[k4e];return t.replace(r,function(n,o,s,a,c,l){Sn("xRange",t,n,o,s,a,c,l);var u=Qa(s),d=u||Qa(a),p=d||Qa(c),f=p;return o==="="&&f&&(o=""),u?o===">"||o==="<"?n="<0.0.0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),n=o+s+"."+a+"."+c):d?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),Sn("xRange return",n),n})}function Hbt(t,e){return Sn("replaceStars",t,e),t.trim().replace(Wn[F4e],"")}function Gbt(t,e,r,n,o,s,a,c,l,u,d,p,f){return Qa(r)?e="":Qa(n)?e=">="+r+".0.0":Qa(o)?e=">="+r+"."+n+".0":e=">="+e,Qa(l)?c="":Qa(u)?c="<"+(+l+1)+".0.0":Qa(d)?c="<"+l+"."+(+u+1)+".0":p?c="<="+l+"."+u+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}Ri.prototype.test=function(t){if(!t)return!1;typeof t=="string"&&(t=new Vr(t,this.options));for(var e=0;e<this.set.length;e++)if(zbt(this.set[e],t,this.options))return!0;return!1};function zbt(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(n=0;n<t.length;n++)if(Sn(t[n].semver),t[n].semver!==XO&&t[n].semver.prerelease.length>0){var o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}Xt.satisfies=yj;function yj(t,e,r){try{e=new Ri(e,r)}catch{return!1}return e.test(t)}Xt.maxSatisfying=$bt;function $bt(t,e,r){var n=null,o=null;try{var s=new Ri(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new Vr(n,r))}),n}Xt.minSatisfying=Wbt;function Wbt(t,e,r){var n=null,o=null;try{var s=new Ri(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new Vr(n,r))}),n}Xt.minVersion=Kbt;function Kbt(t,e){t=new Ri(t,e);var r=new Vr("0.0.0");if(t.test(r)||(r=new Vr("0.0.0-0"),t.test(r)))return r;r=null;for(var n=0;n<t.set.length;++n){var o=t.set[n];o.forEach(function(s){var a=new Vr(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||YO(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&t.test(r)?r:null}Xt.validRange=Ybt;function Ybt(t,e){try{return new Ri(t,e).range||"*"}catch{return null}}Xt.ltr=Qbt;function Qbt(t,e,r){return nse(t,e,"<",r)}Xt.gtr=Xbt;function Xbt(t,e,r){return nse(t,e,">",r)}Xt.outside=nse;function nse(t,e,r,n){t=new Vr(t,n),e=new Ri(e,n);var o,s,a,c,l;switch(r){case">":o=YO,s=rse,a=gj,c=">",l=">=";break;case"<":o=gj,s=tse,a=YO,c="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(yj(t,e,n))return!1;for(var u=0;u<e.set.length;++u){var d=e.set[u],p=null,f=null;if(d.forEach(function(m){m.semver===XO&&(m=new ku(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===l||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===l&&a(t,f.semver))return!1}return!0}Xt.prerelease=Jbt;function Jbt(t,e){var r=bS(t,e);return r&&r.prerelease.length?r.prerelease:null}Xt.intersects=Zbt;function Zbt(t,e,r){return t=new Ri(t,r),e=new Ri(e,r),t.intersects(e)}Xt.coerce=e_t;function e_t(t){if(t instanceof Vr)return t;if(typeof t!="string")return null;var e=t.match(Wn[P4e]);return e==null?null:bS(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var H4e=R((GXr,V4e)=>{var t_t=sj().wrap,ose=1,sse=2,ase=4,Ij=8,Fn=[],r_t=0,ga=!1,Ay=[],eR,cse;function lse(t,e){var r=t.length,n=e.length,o=[];if(r===0&&n===0)return o;for(var s=0;s<r;s++)o[s]=t[s];if(n===0)return o;for(var a=0;a<n;a++){var c=!0;for(s=0;s<r;s++)if(t[s].uid===e[a].uid){c=!1;break}c&&o.push(e[a])}return o}process._fatalException?(Sj=!1,eR=function(e){var r=Fn.length;if(Sj||r===0)return!1;var n=!1;Sj=!0;for(var o=0;o<r;++o){var s=Fn[o];if(s.flags&Ij){var a=tR&&tR[s.uid];n=s.error(a,e)||n}}return Sj=!1,Ay.length>0&&(Fn=Ay.pop()),tR=void 0,n&&!ga},cse=function(e,r,n){var o=[];ga=!0;for(var s=0;s<n;++s){var a=r[s];if(o[a.uid]=a.data,!!(a.flags&ose)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return ga=!1,function(){tR=o,Ay.push(Fn),Fn=lse(r,Fn),ga=!0;for(var l=0;l<n;++l)(r[l].flags&sse)>0&&r[l].before(this,o[r[l].uid]);ga=!1;var u=e.apply(this,arguments);for(ga=!0,l=0;l<n;++l)(r[l].flags&ase)>0&&r[l].after(this,o[r[l].uid]);return ga=!1,Fn=Ay.pop(),tR=void 0,u}},t_t(process,"_fatalException",function(t){return function(r){return eR(r)||t(r)}})):(ise=!1,eR=function(e){if(ise)throw e;for(var r=!1,n=Fn.length,o=0;o<n;++o){var s=Fn[o];s.flags&Ij&&(r=s.error(null,e)||r)}if(!r&&ga)throw e},cse=function(e,r,n){var o=[];ga=!0;for(var s=0;s<n;++s){var a=r[s];if(o[a.uid]=a.data,!!(a.flags&ose)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return ga=!1,function(){var l=!1,u=!1;Ay.push(Fn),Fn=lse(r,Fn),ga=!0;for(var d=0;d<n;++d)(r[d].flags&sse)>0&&r[d].before(this,o[r[d].uid]);ga=!1;var p;try{p=e.apply(this,arguments)}catch(f){l=!0;for(var d=0;d<n;++d)if(Fn[d].flags&Ij)try{u=Fn[d].error(o[r[d].uid],f)||u}catch(h){throw ise=!0,h}if(!u)throw process.removeListener("uncaughtException",eR),process._originalNextTick(function(){process.addListener("uncaughtException",eR)}),f}finally{if(!l||u){for(ga=!0,d=0;d<n;++d)(r[d].flags&ase)>0&&r[d].after(this,o[r[d].uid]);ga=!1}Fn=Ay.pop()}return p}},process.addListener("uncaughtException",eR));var Sj,tR,ise;function n_t(t,e,r){ga=!0;for(var n=0;n<r;++n){var o=e[n];o.create&&o.create(o.data)}return ga=!1,function(){Ay.push(Fn),Fn=lse(e,Fn);var s=t.apply(this,arguments);return Fn=Ay.pop(),s}}function i_t(t){var e=Fn.length;if(e===0)return t;for(var r=Fn.slice(),n=0;n<e;++n)if(r[n].flags>0)return cse(t,r,e);return n_t(t,r,e)}function Mf(t,e){typeof t.create=="function"&&(this.create=t.create,this.flags|=ose),typeof t.before=="function"&&(this.before=t.before,this.flags|=sse),typeof t.after=="function"&&(this.after=t.after,this.flags|=ase),typeof t.error=="function"&&(this.error=t.error,this.flags|=Ij),this.uid=++r_t,this.data=e===void 0?null:e}Mf.prototype.create=void 0;Mf.prototype.before=void 0;Mf.prototype.after=void 0;Mf.prototype.error=void 0;Mf.prototype.data=void 0;Mf.prototype.uid=0;Mf.prototype.flags=0;function j4e(t,e){if(typeof t!="object"||!t)throw new TypeError("callbacks argument must be an object");return t instanceof Mf?t:new Mf(t,e)}function o_t(t,e){var r;t instanceof Mf?r=t:r=j4e(t,e);for(var n=!1,o=0;o<Fn.length;o++)if(r===Fn[o]){n=!0;break}return n||Fn.push(r),r}function s_t(t){for(var e=0;e<Fn.length;e++)if(t===Fn[e]){Fn.splice(e,1);break}}process.createAsyncListener=j4e;process.addAsyncListener=o_t;process.removeAsyncListener=s_t;V4e.exports=i_t});var z4e=R(($Xr,G4e)=>{"use strict";G4e.exports=(t,e)=>class extends t{constructor(n){var o,s;super(c);var a=this;try{n.apply(o,s)}catch(l){s[1](l)}return a;function c(l,u){o=this,s=[d,p];function d(f){return e(a,!1),l(f)}function p(f){return e(a,!1),u(f)}}}}});var J4e=R(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var Y4e=sj(),Tj=q4e(),Lc=Y4e.wrap,Dy=Y4e.massWrap,Pi=H4e(),a_t=require("util"),c_t=Tj.gte(process.version,"6.0.0"),pse=Tj.gte(process.version,"7.0.0"),l_t=Tj.gte(process.version,"8.0.0"),u_t=Tj.gte(process.version,"11.0.0"),Ff=require("net");pse&&!Ff._normalizeArgs?Ff._normalizeArgs=function(t){if(t.length===0)return[{},null];var e=t[0],r={};typeof e=="object"&&e!==null?r=e:h_t(e)?r.path=e:(r.port=e,t.length>1&&typeof t[1]=="string"&&(r.host=t[1]));var n=t[t.length-1];return typeof n!="function"?[r,null]:[r,n]}:!pse&&!Ff._normalizeConnectArgs&&(Ff._normalizeConnectArgs=function(t){var e={};function r(o){return(o=Number(o))>=0?o:!1}typeof t[0]=="object"&&t[0]!==null?e=t[0]:typeof t[0]=="string"&&r(t[0])===!1?e.path=t[0]:(e.port=t[0],typeof t[1]=="string"&&(e.host=t[1]));var n=t[t.length-1];return typeof n=="function"?[e,n]:[e]});"_setUpListenHandle"in Ff.Server.prototype?Lc(Ff.Server.prototype,"_setUpListenHandle",$4e):Lc(Ff.Server.prototype,"_listen2",$4e);function $4e(t){return function(){this.on("connection",function(e){e._handle&&(e._handle.onread=Pi(e._handle.onread))});try{return t.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=Pi(this._handle.onconnection))}}}function Q4e(t){if(t&&t._handle){var e=t._handle;e._originalOnread||(e._originalOnread=e.onread),e.onread=Pi(e._originalOnread)}}Lc(Ff.Socket.prototype,"connect",function(t){return function(){var e;l_t&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?e=arguments[0]:e=pse?Ff._normalizeArgs(arguments):Ff._normalizeConnectArgs(arguments),e[1]&&(e[1]=Pi(e[1]));var r=t.apply(this,e);return Q4e(this),r}});var d_t=require("http");Lc(d_t.Agent.prototype,"addRequest",function(t){return function(e){var r=e.onSocket;return e.onSocket=Pi(function(n){return Q4e(n),r.apply(this,arguments)}),t.apply(this,arguments)}});var use=require("child_process");function W4e(t){Array.isArray(t.stdio)&&t.stdio.forEach(function(e){e&&e._handle&&(e._handle.onread=Pi(e._handle.onread),Lc(e._handle,"close",Ej))}),t._handle&&(t._handle.onexit=Pi(t._handle.onexit))}use.ChildProcess?Lc(use.ChildProcess.prototype,"spawn",function(t){return function(){var e=t.apply(this,arguments);return W4e(this),e}}):Dy(use,["execFile","fork","spawn"],function(t){return function(){var e=t.apply(this,arguments);return W4e(e),e}});process._fatalException||(process._originalNextTick=process.nextTick);var hse=[];process._nextDomainTick&&hse.push("_nextDomainTick");process._tickDomainCallback&&hse.push("_tickDomainCallback");Dy(process,hse,Uf);Lc(process,"nextTick",Ej);var gse=["setTimeout","setInterval"];global.setImmediate&&gse.push("setImmediate");var X4e=require("timers"),p_t=global.setTimeout===X4e.setTimeout;Dy(X4e,gse,Ej);p_t&&Dy(global,gse,Ej);var fse=require("dns");Dy(fse,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],Uf);fse.resolveNaptr&&Lc(fse,"resolveNaptr",Uf);var xS=require("fs");Dy(xS,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],Uf);xS.lchown&&Lc(xS,"lchown",Uf);xS.lchmod&&Lc(xS,"lchmod",Uf);xS.ftruncate&&Lc(xS,"ftruncate",Uf);var JO;try{JO=require("zlib")}catch{}JO&&JO.Deflate&&JO.Deflate.prototype&&(_S=Object.getPrototypeOf(JO.Deflate.prototype),_S._transform?Lc(_S,"_transform",Uf):_S.write&&_S.flush&&_S.end&&Dy(_S,["write","flush","end"],Uf));var _S,mse;try{mse=require("crypto")}catch{}mse&&(dse=["pbkdf2","randomBytes"],u_t||dse.push("pseudoRandomBytes"),Dy(mse,dse,Uf));var dse,Cj=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";Cj&&(K4e=process.addAsyncListener({create:function(){Cj=!1}}),global.Promise.resolve(!0).then(function(){Cj=!1}),process.removeAsyncListener(K4e));var K4e;Cj&&f_t();function f_t(){var t=global.Promise;function e(a){if(!(this instanceof e))return t(a);if(typeof a!="function")return new t(a);var c,l,u=new t(d);u.__proto__=e.prototype;try{a.apply(c,l)}catch(p){l[1](p)}return u;function d(p,f){c=this,l=[m,h];function m(g){return n(u,!1),p(g)}function h(g){return n(u,!1),f(g)}}}if(a_t.inherits(e,t),Lc(t.prototype,"then",s),t.prototype.chain&&Lc(t.prototype,"chain",s),c_t)global.Promise=z4e()(t,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(a){typeof t[a]=="function"&&(e[a]=t[a])}),global.Promise=e}function n(a,c){(!a.__asl_wrapper||c)&&(a.__asl_wrapper=Pi(o))}function o(a,c,l,u){var d;try{return d=c.call(a,l),{returnVal:d,error:!1}}catch(p){return{errorVal:p,error:!0}}finally{d instanceof t?u.__asl_wrapper=function(){var f=d.__asl_wrapper||o;return f.apply(this,arguments)}:n(u,!0)}}function s(a){return function(){var l=this,u=a.apply(l,Array.prototype.map.call(arguments,d));return u.__asl_wrapper=function(f,m,h,g){return l.__asl_wrapper?(l.__asl_wrapper(f,function(){},null,u),u.__asl_wrapper(f,m,h,g)):o(f,m,h,g)},u;function d(p){return typeof p!="function"?p:Pi(function(f){var m=(l.__asl_wrapper||o)(this,p,f,u);if(m.error)throw m.errorVal;return m.returnVal})}}}}function Uf(t){var e=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var o=0;o<arguments.length-1;o++)r[o]=arguments[o];r[n]=Pi(arguments[n])}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=Pi(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof n=="function"&&(n=Pi(n)),t.call(this,r,n))};case 3:return function(r,n,o){return arguments.length!==3?e.apply(this,arguments):(typeof o=="function"&&(o=Pi(o)),t.call(this,r,n,o))};case 4:return function(r,n,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof s=="function"&&(s=Pi(s)),t.call(this,r,n,o,s))};case 5:return function(r,n,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof a=="function"&&(a=Pi(a)),t.call(this,r,n,o,s,a))};case 6:return function(r,n,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof c=="function"&&(c=Pi(c)),t.call(this,r,n,o,s,a,c))};default:return e}}function Ej(t){var e=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=Pi(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=Pi(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof r=="function"&&(r=Pi(r)),t.call(this,r,n))};case 3:return function(r,n,o){return arguments.length!==3?e.apply(this,arguments):(typeof r=="function"&&(r=Pi(r)),t.call(this,r,n,o))};case 4:return function(r,n,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof r=="function"&&(r=Pi(r)),t.call(this,r,n,o,s))};case 5:return function(r,n,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof r=="function"&&(r=Pi(r)),t.call(this,r,n,o,s,a))};case 6:return function(r,n,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof r=="function"&&(r=Pi(r)),t.call(this,r,n,o,s,a,c))};default:return e}}function m_t(t){return(t=Number(t))>=0?t:!1}function h_t(t){return typeof t=="string"&&m_t(t)===!1}});var n3e=R((YXr,r3e)=>{"use strict";var Kh=require("assert"),g_t=lj(),ZO="cls@contexts",vse="error@context";process.addAsyncListener||J4e();function Hd(t){this.name=t,this.active=null,this._set=[],this.id=null}Hd.prototype.set=function(t,e){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[t]=e,e};Hd.prototype.get=function(t){if(this.active)return this.active[t]};Hd.prototype.createContext=function(){return Object.create(this.active)};Hd.prototype.run=function(t){var e=this.createContext();this.enter(e);try{return t(e),e}catch(r){throw r&&(r[vse]=e),r}finally{this.exit(e)}};Hd.prototype.runAndReturn=function(t){var e;return this.run(function(r){e=t(r)}),e};Hd.prototype.bind=function(t,e){e||(this.active?e=this.active:e=this.createContext());var r=this;return function(){r.enter(e);try{return t.apply(this,arguments)}catch(n){throw n&&(n[vse]=e),n}finally{r.exit(e)}}};Hd.prototype.enter=function(t){Kh.ok(t,"context must be provided for entering"),this._set.push(this.active),this.active=t};Hd.prototype.exit=function(t){if(Kh.ok(t,"context must be provided for exiting"),this.active===t){Kh.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var e=this._set.lastIndexOf(t);Kh.ok(e>=0,"context not currently entered; can't exit"),Kh.ok(e,"can't remove top context"),this._set.splice(e,1)};Hd.prototype.bindEmitter=function(t){Kh.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");var e=this,r="context@"+this.name;function n(s){s&&(s[ZO]||(s[ZO]=Object.create(null)),s[ZO][r]={namespace:e,context:e.active})}function o(s){if(!(s&&s[ZO]))return s;var a=s,c=s[ZO];return Object.keys(c).forEach(function(l){var u=c[l];a=u.namespace.bind(a,u.context)}),a}g_t(t,n,o)};Hd.prototype.fromException=function(t){return t[vse]};function Z4e(t){return process.namespaces[t]}function v_t(t){Kh.ok(t,"namespace must be given a name!");var e=new Hd(t);return e.id=process.addAsyncListener({create:function(){return e.active},before:function(r,n){n&&e.enter(n)},after:function(r,n){n&&e.exit(n)},error:function(r){r&&e.exit(r)}}),process.namespaces[t]=e,e}function e3e(t){var e=Z4e(t);Kh.ok(e,"can't delete nonexistent namespace!"),Kh.ok(e.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(e.id),process.namespaces[t]=null}function t3e(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){e3e(t)}),process.namespaces=Object.create(null)}process.namespaces||t3e();r3e.exports={getNamespace:Z4e,createNamespace:v_t,destroyNamespace:e3e,reset:t3e}});var Ny=R(kj=>{"use strict";Object.defineProperty(kj,"__esModule",{value:!0});kj.CorrelationContextManager=void 0;var rR=ri(),y_t=zq(),SS=$q(),yse=Hie(),i3e=loe(),wj=zs(),b_t=function(){function t(){}return t.getCurrentContext=function(){if(!t.enabled)return null;var e=t.session.get(t.CONTEXT_NAME);return e===void 0?null:e},t.generateContextObject=function(e,r,n,o,s,a){return r=r||e,this.enabled?{operation:{name:n,id:e,parentId:r,traceparent:s,tracestate:a},customProperties:new __t(o)}:null},t.spanToContextObject=function(e,r,n){var o=new SS;return o.traceId=e.traceId,o.spanId=e.spanId,o.traceFlag=SS.formatOpenTelemetryTraceFlags(e.traceFlags)||SS.DEFAULT_TRACE_FLAG,o.parentId=r,t.generateContextObject(o.traceId,o.parentId,n,null,o)},t.runWithContext=function(e,r){var n;if(t.enabled)try{return t.session.bind(r,(n={},n[t.CONTEXT_NAME]=e,n))()}catch(o){rR.warn("Error binding to session context",wj.dumpObj(o))}return r()},t.wrapEmitter=function(e){if(t.enabled)try{t.session.bindEmitter(e)}catch(r){rR.warn("Error binding to session context",wj.dumpObj(r))}},t.wrapCallback=function(e,r){var n;if(t.enabled)try{return t.session.bind(e,r?(n={},n[t.CONTEXT_NAME]=r,n):void 0)}catch(o){rR.warn("Error binding to session context",wj.dumpObj(o))}return e},t.enable=function(e){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}t.hasEverEnabled||(this.forceClsHooked=e,this.hasEverEnabled=!0,typeof this.cls>"u"&&(t.forceClsHooked===!0||t.forceClsHooked===void 0&&t.shouldUseClsHooked()?this.cls=I4e():this.cls=n3e()),t.session=this.cls.createNamespace("AI-CLS-Session"),y_t.registerContextPreservation(function(r){try{return t.session.bind(r)}catch(n){rR.warn("Error binding to session context",wj.dumpObj(n))}})),this.enabled=!0}},t.startOperation=function(e,r){var n=e&&e.traceContext||null,o=e&&e.spanContext?e:null,s=e&&e.traceId?e:null,a=e&&e.headers;if(o)return this.spanToContextObject(o.spanContext(),o.parentSpanId,o.name);if(s)return this.spanToContextObject(s,"|"+s.traceId+"."+s.spanId+".",typeof r=="string"?r:"");var c=typeof r=="string"?r:"";if(n){var l=null,u=null;if(c=n.attributes.OperationName||c,r){var d=r;d.headers&&(d.headers.traceparent?l=new SS(d.headers.traceparent):d.headers["request-id"]&&(l=new SS(null,d.headers["request-id"])),d.headers.tracestate&&(u=new yse(d.headers.tracestate)))}l||(l=new SS(n.traceParent||n.traceparent)),u||(u=new yse(n.traceState||n.tracestate));var p=void 0;if(typeof r=="object"){var f=new i3e(r);p=f.getCorrelationContextHeader(),c=f.getOperationName({})}var m=t.generateContextObject(l.traceId,l.parentId,c,p,l,u);return m}if(a){var l=new SS(a.traceparent?a.traceparent.toString():null),u=new yse(a.tracestate?a.tracestate.toString():null),f=new i3e(e),m=t.generateContextObject(l.traceId,l.parentId,f.getOperationName({}),f.getCorrelationContextHeader(),l,u);return m}return rR.warn("startOperation was called with invalid arguments",arguments),null},t.disable=function(){this.enabled=!1},t.reset=function(){t.hasEverEnabled&&(t.session=null,t.session=this.cls.createNamespace("AI-CLS-Session"))},t.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},t.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},t.canUseClsHooked=function(){var e=process.versions.node.split("."),r=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,n=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,o=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(r&&n)&&o},t.enabled=!1,t.hasEverEnabled=!1,t.forceClsHooked=void 0,t.CONTEXT_NAME="ApplicationInsights-Context",t}();kj.CorrelationContextManager=b_t;var __t=function(){function t(e){this.props=[],this.addHeaderData(e)}return t.prototype.addHeaderData=function(e){var r=e?e.split(", "):[];this.props=r.map(function(n){var o=n.split("=");return{key:o[0],value:o[1]}}).concat(this.props)},t.prototype.serializeToHeader=function(){return this.props.map(function(e){return e.key+"="+e.value}).join(", ")},t.prototype.getProperty=function(e){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===e)return n.value}},t.prototype.setProperty=function(e,r){if(t.bannedCharacters.test(e)||t.bannedCharacters.test(r)){rR.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+e+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var o=this.props[n];if(o.key===e){o.value=r;return}}this.props.push({key:e,value:r})},t.bannedCharacters=/[,=]/,t}()});var o3e=R(nR=>{"use strict";Object.defineProperty(nR,"__esModule",{value:!0});nR.dispose=nR.enable=void 0;var Rj=ma(),x_t=Ei(),Pj=Gi(),Ly=[],bse=function(t){var e=t.data.message;Ly.forEach(function(r){e instanceof Error&&!r.config.enableLoggerErrorToTrace?r.trackException({exception:e}):e instanceof Error?r.trackTrace({message:e.toString(),severity:t.data.stderr?Rj.SeverityLevel.Error:Rj.SeverityLevel.Information}):(e.lastIndexOf(`
`)==e.length-1&&(e=e.substring(0,e.length-1)),r.trackTrace({message:e,severity:t.data.stderr?Rj.SeverityLevel.Warning:Rj.SeverityLevel.Information}))})};function S_t(t,e){if(t){var r=Ly.find(function(n){return n==e});if(r)return;Ly.length===0&&Pj.channel.subscribe("console",bse,Pj.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(x_t.StatsbeatInstrumentation.CONSOLE)}),Ly.push(e)}else Ly=Ly.filter(function(n){return n!=e}),Ly.length===0&&Pj.channel.unsubscribe("console",bse)}nR.enable=S_t;function I_t(){Pj.channel.unsubscribe("console",bse),Ly=[]}nR.dispose=I_t});var s3e=R(oR=>{"use strict";Object.defineProperty(oR,"__esModule",{value:!0});oR.dispose=oR.enable=void 0;var iR=ma(),C_t=Ei(),Aj=Gi(),Oy=[],T_t={10:iR.SeverityLevel.Verbose,20:iR.SeverityLevel.Verbose,30:iR.SeverityLevel.Information,40:iR.SeverityLevel.Warning,50:iR.SeverityLevel.Error,60:iR.SeverityLevel.Critical},_se=function(t){var e=t.data.result,r=T_t[t.data.level];Oy.forEach(function(n){try{var o=JSON.parse(e);if(o.err){var s=new Error(o.err.message);if(s.name=o.err.name,s.stack=o.err.stack,n.config.enableLoggerErrorToTrace){n.trackTrace({message:e,severity:r});return}n.trackException({exception:s});return}}catch{}n.trackTrace({message:e,severity:r})})};function E_t(t,e){if(t){var r=Oy.find(function(n){return n==e});if(r)return;Oy.length===0&&Aj.channel.subscribe("bunyan",_se,Aj.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(C_t.StatsbeatInstrumentation.BUNYAN)}),Oy.push(e)}else Oy=Oy.filter(function(n){return n!=e}),Oy.length===0&&Aj.channel.unsubscribe("bunyan",_se)}oR.enable=E_t;function w_t(){Aj.channel.unsubscribe("bunyan",_se),Oy=[]}oR.dispose=w_t});var a3e=R(sR=>{"use strict";Object.defineProperty(sR,"__esModule",{value:!0});sR.dispose=sR.enable=void 0;var k_t=Ei(),Ks=ma(),Dj=Gi(),My=[],R_t={syslog:function(t){var e={emerg:Ks.SeverityLevel.Critical,alert:Ks.SeverityLevel.Critical,crit:Ks.SeverityLevel.Critical,error:Ks.SeverityLevel.Error,warning:Ks.SeverityLevel.Warning,notice:Ks.SeverityLevel.Information,info:Ks.SeverityLevel.Information,debug:Ks.SeverityLevel.Verbose};return e[t]===void 0?Ks.SeverityLevel.Information:e[t]},npm:function(t){var e={error:Ks.SeverityLevel.Error,warn:Ks.SeverityLevel.Warning,info:Ks.SeverityLevel.Information,verbose:Ks.SeverityLevel.Verbose,debug:Ks.SeverityLevel.Verbose,silly:Ks.SeverityLevel.Verbose};return e[t]===void 0?Ks.SeverityLevel.Information:e[t]},unknown:function(t){return Ks.SeverityLevel.Information}},xse=function(t){var e=t.data.message,r=R_t[t.data.levelKind](t.data.level);My.forEach(function(n){e instanceof Error&&!n.config.enableLoggerErrorToTrace?n.trackException({exception:e,properties:t.data.meta}):e instanceof Error?n.trackTrace({message:e.toString(),severity:r,properties:t.data.meta}):n.trackTrace({message:e,severity:r,properties:t.data.meta})})};function P_t(t,e){if(t){var r=My.find(function(n){return n==e});if(r)return;My.length===0&&Dj.channel.subscribe("winston",xse,Dj.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(k_t.StatsbeatInstrumentation.WINSTON)}),My.push(e)}else My=My.filter(function(n){return n!=e}),My.length===0&&Dj.channel.unsubscribe("winston",xse)}sR.enable=P_t;function A_t(){Dj.channel.unsubscribe("winston",xse),My=[]}sR.dispose=A_t});var l3e=R((eJr,c3e)=>{"use strict";var D_t=zq(),N_t=function(){function t(e){if(t.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=e,t.INSTANCE=this}return t.prototype.enable=function(e,r){D_t.IsInitialized&&(o3e().enable(e&&r,this._client),s3e().enable(e,this._client),a3e().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1,!1)},t._methodNames=["debug","info","log","warn","error"],t}();c3e.exports=N_t});var d3e=R((tJr,u3e)=>{"use strict";var L_t=function(){function t(e){if(t.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e;var r=process.versions.node.split(".");t._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.enable=function(e){var r=this;if(e){if(this._isInitialized=!0,!this._exceptionListenerHandle){var n=function(o,s,a){a===void 0&&(a=new Error(t._FALLBACK_ERROR_MESSAGE));var c={exception:a};c.contextObjects={},c.contextObjects.Error=a,r._client.trackException(c),r._client.flush({isAppCrashing:!0}),o&&s&&process.listeners(s).length===1&&(console.error(a),process.exit(1))};t._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=n.bind(this,!1,void 0),process.on(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=n.bind(this,!0,t.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=n.bind(this,!1,void 0),process.on(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(t._canUseUncaughtExceptionMonitor?process.removeListener(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.INSTANCE=null,t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",t.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",t.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",t._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",t._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",t._canUseUncaughtExceptionMonitor=!1,t}();u3e.exports=L_t});var Lj=R((rJr,p3e)=>{"use strict";var Nj=require("os"),Ru=Ei(),O_t=function(){function t(e,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,t.INSTANCE||(t.INSTANCE=this),this._lastRequests={totalRequestCount:0,totalFailedRequestCount:0,time:0},this._lastDependencies={totalDependencyCount:0,totalFailedDependencyCount:0,time:0},this._lastExceptions={totalExceptionCount:0,time:0},this._isInitialized=!1,this._client=e,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return t.prototype.enable=function(e,r){var n=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._lastCpus=Nj.cpus(),this._lastRequests={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:t._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},t.countRequest=function(e,r){var n;if(t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalRequestExecutionTime+=n,r===!1&&t._totalFailedRequestCount++,t._totalRequestCount++}},t.countException=function(){t._totalExceptionCount++},t.countDependency=function(e,r){var n;if(t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalDependencyExecutionTime+=n,r===!1&&t._totalFailedDependencyCount++,t._totalDependencyCount++}},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},t.prototype._trackCpu=function(){var e=Nj.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var r=0,n=0,o=0,s=0,a=0,c=0;e&&c<e.length;c++){var l=e[c],u=this._lastCpus[c],d="% cpu("+c+") ",p=l.model,f=l.speed,m=l.times,h=u.times,g=m.user-h.user||0;r+=g;var v=m.sys-h.sys||0;n+=v;var b=m.nice-h.nice||0;o+=b;var _=m.idle-h.idle||0;s+=_;var x=m.irq-h.irq||0;a+=x}var S=void 0;if(typeof process.cpuUsage=="function"){var I=process.cpuUsage(),w=process.hrtime(),k=I.user-this._lastAppCpuUsage.user+(I.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var M=(w[0]-this._lastHrtime[0])*1e6+(w[1]-this._lastHrtime[1])/1e3||0;S=100*k/(M*e.length)}this._lastAppCpuUsage=I,this._lastHrtime=w}var H=r+n+o+s+a||1;this._client.trackMetric({name:Ru.PerformanceCounter.PROCESSOR_TIME,value:(H-s)/H*100}),this._client.trackMetric({name:Ru.PerformanceCounter.PROCESS_TIME,value:S||r/H*100})}this._lastCpus=e},t.prototype._trackMemory=function(){var e=Nj.freemem(),r=process.memoryUsage().rss,n=Nj.totalmem()-e;this._client.trackMetric({name:Ru.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:Ru.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Ru.QuickPulseCounter.COMMITTED_BYTES,value:n})},t.prototype._trackNetwork=function(){var e=this._lastRequests,r={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-e.totalRequestCount||0,o=r.totalFailedRequestCount-e.totalFailedRequestCount||0,s=r.time-e.time,a=s/1e3,c=(t._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=t._intervalRequestExecutionTime,s>0){var l=n/a,u=o/a;this._client.trackMetric({name:Ru.PerformanceCounter.REQUEST_RATE,value:l}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Ru.PerformanceCounter.REQUEST_DURATION,value:c}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Ru.QuickPulseCounter.REQUEST_FAILURE_RATE,value:u})}this._lastRequests=r},t.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastDependencies,r={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-e.totalDependencyCount||0,o=r.totalFailedDependencyCount-e.totalFailedDependencyCount||0,s=r.time-e.time,a=s/1e3,c=(t._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=t._intervalDependencyExecutionTime,s>0){var l=n/a,u=o/a;this._client.trackMetric({name:Ru.QuickPulseCounter.DEPENDENCY_RATE,value:l}),this._client.trackMetric({name:Ru.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Ru.QuickPulseCounter.DEPENDENCY_DURATION,value:c})}this._lastDependencies=r}},t.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastExceptions,r={totalExceptionCount:t._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-e.totalExceptionCount||0,o=r.time-e.time,s=o/1e3;if(o>0){var a=n/s;this._client.trackMetric({name:Ru.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t._totalRequestCount=0,t._totalFailedRequestCount=0,t._totalDependencyCount=0,t._totalFailedDependencyCount=0,t._totalExceptionCount=0,t._intervalDependencyExecutionTime=0,t._intervalRequestExecutionTime=0,t}();p3e.exports=O_t});var f3e=R(Oj=>{"use strict";Object.defineProperty(Oj,"__esModule",{value:!0});Oj.AggregatedMetricCounter=void 0;var M_t=function(){function t(e){this.dimensions=e,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return t}();Oj.AggregatedMetricCounter=M_t});var m3e=R(Mj=>{"use strict";Object.defineProperty(Mj,"__esModule",{value:!0});Mj.PreaggregatedMetricPropertyNames=void 0;Mj.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}});var Ise=R((Sse,h3e)=>{"use strict";var Uj=Sse&&Sse.__assign||function(){return Uj=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Uj.apply(this,arguments)},Fj=Ei(),F_t=f3e(),U_t=m3e(),B_t=function(){function t(e,r){r===void 0&&(r=6e4),t.INSTANCE||(t.INSTANCE=this),this._isInitialized=!1,t._dependencyCountersCollection=[],t._requestCountersCollection=[],t._exceptionCountersCollection=[],t._traceCountersCollection=[],this._client=e,this._collectionInterval=r}return t.prototype.enable=function(e,r){var n=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},t.countException=function(e){if(t.isEnabled()){var r=t._getAggregatedCounter(e,this._exceptionCountersCollection);r.totalCount++}},t.countTrace=function(e){if(t.isEnabled()){var r=t._getAggregatedCounter(e,this._traceCountersCollection);r.totalCount++}},t.countRequest=function(e,r){if(t.isEnabled()){var n,o=t._getAggregatedCounter(r,this._requestCountersCollection);if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;o.intervalExecutionTime+=n,o.totalCount++}},t.countDependency=function(e,r){if(t.isEnabled()){var n=t._getAggregatedCounter(r,this._dependencyCountersCollection),o;if(typeof e=="string")o=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")o=e;else return;n.intervalExecutionTime+=o,n.totalCount++}},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},t._getAggregatedCounter=function(e,r){for(var n=!1,o=0;o<r.length;o++){if(e===r[o].dimensions)return r[o];if(Object.keys(e).length===Object.keys(r[o].dimensions).length){for(var s in e)if(e[s]!=r[o].dimensions[s]){n=!0;break}if(!n)return r[o];n=!1}}var a=new F_t.AggregatedMetricCounter(e);return r.push(a),a},t.prototype._trackRequestMetrics=function(){for(var e=0;e<t._requestCountersCollection.length;e++){var r=t._requestCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&n>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:r.dimensions,value:s,count:n,aggregationInterval:o,metricType:Fj.MetricId.REQUESTS_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackDependencyMetrics=function(){for(var e=0;e<t._dependencyCountersCollection.length;e++){var r=t._dependencyCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&n>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:r.dimensions,value:s,count:n,aggregationInterval:o,metricType:Fj.MetricId.DEPENDENCIES_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackExceptionMetrics=function(){for(var e=0;e<t._exceptionCountersCollection.length;e++){var r=t._exceptionCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;o>0&&n>0&&this._trackPreAggregatedMetric({name:"Exceptions",dimensions:r.dimensions,value:n,count:n,aggregationInterval:o,metricType:Fj.MetricId.EXCEPTIONS_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackTraceMetrics=function(){for(var e=0;e<t._traceCountersCollection.length;e++){var r=t._traceCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;o>0&&n>0&&this._trackPreAggregatedMetric({name:"Traces",dimensions:r.dimensions,value:n,count:n,aggregationInterval:o,metricType:Fj.MetricId.TRACES_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackPreAggregatedMetric=function(e){var r={};for(var n in e.dimensions)r[U_t.PreaggregatedMetricPropertyNames[n]]=e.dimensions[n];r=Uj(Uj({},r),{"_MS.MetricId":e.metricType,"_MS.AggregationIntervalMs":String(e.aggregationInterval),"_MS.IsAutocollected":"True"});var o={name:e.name,value:e.value,count:e.count,properties:r,kind:"Aggregation"};this._client.trackMetric(o)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();h3e.exports=B_t});var aR=R((oJr,g3e)=>{"use strict";var Yh=require("os"),q_t=require("fs"),j_t=require("path"),V_t=ma(),H_t=Ei(),G_t=ri(),z_t=function(){function t(e){this.keys=new V_t.ContextTagKeys,this.tags={},this._loadApplicationContext(e),this._loadDeviceContext(),this._loadInternalContext()}return t.prototype._loadApplicationContext=function(e){try{if(e=e||j_t.resolve(__dirname,"../../../../package.json"),!t.appVersion[e]){t.appVersion[e]="unknown";var r=JSON.parse(q_t.readFileSync(e,"utf8"));r&&typeof r.version=="string"&&(t.appVersion[e]=r.version)}this.tags[this.keys.applicationVersion]=t.appVersion[e]}catch(n){G_t.info("Failed to read app version: ",n)}},t.prototype._loadDeviceContext=function(){var e=Yh&&Yh.hostname(),r=t.DefaultRoleName;process.env.WEBSITE_SITE_NAME&&(r=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_INSTANCE_ID&&(e=process.env.WEBSITE_INSTANCE_ID),this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=e,this.tags[this.keys.deviceOSVersion]=Yh&&Yh.type()+" "+Yh.release(),this.tags[this.keys.cloudRole]=r,this.tags["ai.device.osArchitecture"]=Yh&&Yh.arch(),this.tags["ai.device.osPlatform"]=Yh&&Yh.platform()},t.prototype._loadInternalContext=function(){t.sdkVersion=H_t.APPLICATION_INSIGHTS_SDK_VERSION,this.tags[this.keys.internalSdkVersion]="node:"+t.sdkVersion},t.DefaultRoleName="Web",t.appVersion={},t.sdkVersion=null,t}();g3e.exports=z_t});var b3e=R((sJr,y3e)=>{"use strict";var $_t=require("crypto"),v3e=require("os"),W_t=Ei(),K_t=aR(),Y_t=function(){function t(e){this._collectionInterval=9e5,t.INSTANCE||(t.INSTANCE=this),this._isInitialized=!1,this._client=e}return t.prototype.enable=function(e){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._handle=setInterval(function(){return r.trackHeartBeat(r._client.config,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackHeartBeat=function(e,r){var n={},o=K_t.sdkVersion;n.sdkVersion=o,n.osType=v3e.type(),n.osVersion=v3e.release(),this._uniqueProcessId||(this._uniqueProcessId=$_t.randomBytes(16).toString("hex")),n.processSessionId=this._uniqueProcessId,process.env.WEBSITE_SITE_NAME&&(n.appSrv_SiteName=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_HOME_STAMPNAME&&(n.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME),process.env.WEBSITE_HOSTNAME&&(n.appSrv_wsHost=process.env.WEBSITE_HOSTNAME),process.env.WEBSITE_OWNER_NAME&&(n.appSrv_wsOwner=process.env.WEBSITE_OWNER_NAME),process.env.WEBSITE_RESOURCE_GROUP&&(n.appSrv_ResourceGroup=process.env.WEBSITE_RESOURCE_GROUP),process.env.WEBSITE_SLOT_NAME&&(n.appSrv_SlotName=process.env.WEBSITE_SLOT_NAME),this._client.trackMetric({name:W_t.HeartBeatMetricName,value:0,properties:n}),r()},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();y3e.exports=Y_t});var _3e=R(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.isContentTypeHeaderHtml=Jt.insertSnippetByIndex=Jt.getContentEncodingFromHeaders=Jt.isSupportedContentEncoding=Jt.findBufferEncodingType=Jt.isBufferType=Jt.getBrotliDecompressSync=Jt.getBrotliDecompressAsync=Jt.getBrotliCompressSync=Jt.getBrotliCompressAsync=Jt.inflateAsync=Jt.deflateAsync=Jt.gunzipAsync=Jt.gzipAsync=Jt.isBrotliSupperted=Jt.bufferEncodingTypes=Jt.contentEncodingMethod=void 0;var qj=require("zlib"),cR=require("util"),Bj;(function(t){t.GZIP="gzip",t.DEFLATE="deflate",t.BR="br"})(Bj=Jt.contentEncodingMethod||(Jt.contentEncodingMethod={}));Jt.bufferEncodingTypes=["utf8","utf16le","latin1","base64","hex","ascii","binary","ucs2"];var Q_t=function(){var t=process.versions.node.split(".")[0];return parseInt(t)>=10};Jt.isBrotliSupperted=Q_t;Jt.gzipAsync=cR.promisify(qj.gzip);Jt.gunzipAsync=cR.promisify(qj.gunzip);Jt.deflateAsync=cR.promisify(qj.deflate);Jt.inflateAsync=cR.promisify(qj.inflate);var X_t=function(t){var e=Jt.isBrotliSupperted();return e&&typeof t.brotliCompress=="function"?cR.promisify(t.brotliCompress):null};Jt.getBrotliCompressAsync=X_t;var J_t=function(t){var e=Jt.isBrotliSupperted();return e&&typeof t.brotliCompressSync=="function"?t.brotliCompressSync:null};Jt.getBrotliCompressSync=J_t;var Z_t=function(t){var e=Jt.isBrotliSupperted();return e&&typeof t.brotliDecompress=="function"?cR.promisify(t.brotliDecompress):null};Jt.getBrotliDecompressAsync=Z_t;var ext=function(t){var e=Jt.isBrotliSupperted();return e&&typeof t.brotliDecompressSync=="function"?t.brotliDecompressSync:null};Jt.getBrotliDecompressSync=ext;var txt=function(t,e){var r=e||"utf8",n=!1;if(Buffer.isEncoding(r)){var o=Buffer.from(t.toString(r),r);n=o.toJSON().data.toString()===t.toJSON().data.toString()}return n};Jt.isBufferType=txt;var rxt=function(t){var e=null;for(var r in Jt.bufferEncodingTypes){var n=Jt.bufferEncodingTypes[r];if(Buffer.isEncoding(n)&&Jt.isBufferType(t,n)){e=n;break}}return e};Jt.findBufferEncodingType=rxt;var nxt=function(t){var e=null;switch(t){case"gzip":e=Bj.GZIP;break;case"br":e=Bj.BR;break;case"deflate":e=Bj.DEFLATE;break;default:}return e};Jt.isSupportedContentEncoding=nxt;var ixt=function(t){var e=[],r=t.getHeader("Content-Encoding");if(!r)return null;if(typeof r=="string"){var n=Jt.isSupportedContentEncoding(r);n&&e.push(n)}return e};Jt.getContentEncodingFromHeaders=ixt;var oxt=function(t,e,r){if(t<0)return null;var n=null,o=e.substring(0,t),s=e.substring(t);return n=o+'<script type="text/javascript">'+r+"</script>"+s,n};Jt.insertSnippetByIndex=oxt;var sxt=function(t){var e=!1,r=t.getHeader("Content-Type");return r&&(typeof r=="string"?e=r.indexOf("html")>=0:e=r.toString().indexOf("html")>=0),e};Jt.isContentTypeHeaderHtml=sxt});var x3e=R(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.getResourceProvider=ws.getOsPrefix=ws.isFunctionApp=ws.isWebApp=ws.isLinux=ws.isWindows=void 0;var axt=function(){return process.platform==="win32"};ws.isWindows=axt;var cxt=function(){return process.platform==="linux"};ws.isLinux=cxt;var lxt=function(){return!!process.env.WEBSITE_SITE_NAME};ws.isWebApp=lxt;var uxt=function(){return!!process.env.FUNCTIONS_WORKER_RUNTIME};ws.isFunctionApp=uxt;var dxt=function(){return ws.isWindows()?"w":ws.isLinux()?"l":"u"};ws.getOsPrefix=dxt;var pxt=function(){return ws.isWebApp()?"a":ws.isFunctionApp()?"f":"u"};ws.getResourceProvider=pxt});var Cse=R((lJr,I3e)=>{"use strict";var S3e=Ei(),fxt=function(){function t(){}return t.parse=function(e){if(!e)return{};var r=e.split(t._FIELDS_SEPARATOR),n=r.reduce(function(s,a){var c=a.split(t._FIELD_KEY_VALUE_SEPARATOR);if(c.length===2){var l=c[0].toLowerCase(),u=c[1];s[l]=u}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var o=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+o+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+o+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||S3e.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||S3e.DEFAULT_LIVEMETRICS_ENDPOINT}return n},t.isIkeyValid=function(e){if(!e||e=="")return!1;var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(e)},t._FIELDS_SEPARATOR=";",t._FIELD_KEY_VALUE_SEPARATOR="=",t}();I3e.exports=fxt});var C3e={};Pn(C3e,{webSnippet:()=>mxt});var mxt,T3e=D(()=>{mxt=`!function(T,l,y){var S=T.location,k="script",D="instrumentationKey",C="ingestionendpoint",I="disableExceptionTracking",E="ai.device.",b="toLowerCase",w="crossOrigin",N="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"5",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[b](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:e,name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,u,p,l;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][b]()]=i[1])}if(!e[C]){var r=e.endpointsuffix,o=r?e.location:null;e[C]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[D]||d[D]||"",u=s[C],p=u?u+"/v2/track":d.endpointUrl,(l=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=p,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\\./g,"-"),hasFullStack:!1,stack:n+"\\nSnippet failed to load ["+a+"] -- Telemetry is disabled\\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\\nHost: "+(S&&S.pathname||"_unknown_")+"\\nEndpoint: "+i,parsedStack:[]}],r)),l.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,p)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:N,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(N,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(l,p))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(k);n.src=h;var e=y[w];return!e&&""!==e||"undefined"==n[w]||(n[w]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(k)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[I]&&!0!==s[I]){var c="onerror";t(["_"+c]);var u=T[c];T[c]=function(e,t,n,a,i){var r=u&&u(e,t,n,a,i);return!0!==r&&m["_"+c]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);function a(){y.onInit&&y.onInit(n)}(T[t]=n).queue&&0===n.queue.length?(n.queue.push(a),n.trackPageView({})):a()}(window,document,{\r
src: "https://js.monitor.azure.com/scripts/b/ai.2.min.js", // The SDK URL Source\r
// name: "appInsights", // Global SDK Instance name defaults to "appInsights" when not supplied\r
// ld: 0, // Defines the load delay (in ms) before attempting to load the sdk. -1 = block page load and add to head. (default) = 0ms load after timeout,\r
// useXhr: 1, // Use XHR instead of fetch to report failures (if available),\r
// crossOrigin: "anonymous", // When supplied this will add the provided value as the cross origin attribute on the script tag\r
// onInit: null, // Once the application insights instance has loaded and initialized this callback function will be called with 1 argument -- the sdk instance (DO NOT ADD anything to the sdk.queue -- As they won't get called)\r
cfg: { // Application Insights Configuration\r
    instrumentationKey: "INSTRUMENTATION_KEY"\r
}});`});var A3e=R((uJr,P3e)=>{"use strict";var E3e=require("http"),w3e=require("https"),lR=require("zlib"),Bf=ri(),Pu=_3e(),k3e=x3e(),e4=Ei(),R3e=Cse(),hxt=(T3e(),fo(C3e)),gxt=function(){function t(e){var r;if(this._isIkeyValid=!0,t.INSTANCE)throw new Error("Web snippet injection should be configured from the applicationInsights object");t.INSTANCE=this,t._aiUrl=e4.WEB_INSTRUMENTATION_DEFAULT_SOURCE,t._aiDeprecatedUrl=e4.WEB_INSTRUMENTATION_DEPRECATED_SOURCE;var n=this._getWebSnippetIkey((r=e.config)===null||r===void 0?void 0:r.webInstrumentationConnectionString);this._webInstrumentationIkey=n||e.config.instrumentationKey,this._clientWebInstrumentationConfig=e.config.webInstrumentationConfig,this._clientWebInstrumentationSrc=e.config.webInstrumentationSrc,this._statsbeat=e.getStatsbeat()}return t.prototype.enable=function(e,r){this._isEnabled=e,this._webInstrumentationIkey=this._getWebSnippetIkey(r)||this._webInstrumentationIkey,t._snippet=this._getWebInstrumentationReplacedStr(),this._isEnabled&&!this._isInitialized&&this._isIkeyValid?(this._statsbeat&&this._statsbeat.addFeature(e4.StatsbeatFeature.WEB_SNIPPET),this._initialize()):this._isEnabled||this._statsbeat&&this._statsbeat.removeFeature(e4.StatsbeatFeature.WEB_SNIPPET)},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._getWebSnippetIkey=function(e){var r=null;try{var n=R3e.parse(e),o=n.instrumentationkey||"";R3e.isIkeyValid(o)?(this._isIkeyValid=!0,r=o):(this._isIkeyValid=!1,Bf.info("Invalid web Instrumentation connection string, web Instrumentation is not enabled."))}catch(s){Bf.info("get web snippet ikey error: "+s)}return r},t.prototype._getWebInstrumentationReplacedStr=function(){var e=this._getClientWebInstrumentationConfigStr(this._clientWebInstrumentationConfig),r=k3e.getOsPrefix(),n=k3e.getResourceProvider(),o=this._webInstrumentationIkey+`",\r
`+e+` disableIkeyDeprecationMessage: true,\r
 sdkExtension: "`+n+r+"d_n_",s=hxt.webSnippet.replace("INSTRUMENTATION_KEY",o);return this._clientWebInstrumentationSrc?s.replace(e4.WEB_INSTRUMENTATION_DEFAULT_SOURCE+".2.min.js",this._clientWebInstrumentationSrc):s},t.prototype._getClientWebInstrumentationConfigStr=function(e){var r="";try{e!=null&&e.length>0&&e.forEach(function(n){var o=n.name;if(o!==void 0){var s=n.value,a="";switch(typeof s){case"function":break;case"object":break;case"string":a=" "+o+': "'+s+`",\r
`,r+=a;break;default:a=" "+o+": "+s+`,\r
`,r+=a;break}}})}catch{this._isEnabled=!1,Bf.info("Parse client web instrumentation error. Web Instrumentation is disabled")}return r},t.prototype._initialize=function(){this._isInitialized=!0;var e=E3e.createServer,r=w3e.createServer,n=this._isEnabled;E3e.createServer=function(o){var s=o;return s&&(o=function(a,c){var l=c.write,u=a.method=="GET";c.write=function(f,m,h){try{if(n&&u){var g=Pu.getContentEncodingFromHeaders(c),v=void 0;if(typeof m=="string"&&(v=m),g==null)t.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,void 0,v));else if(g.length){var b=g[0];arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,b)}}}catch(_){Bf.warn("Inject snippet error: "+_)}return l.apply(c,arguments)};var d=c.end;return c.end=function(f,m,h){if(n&&u)try{if(n&&u){var g=Pu.getContentEncodingFromHeaders(c),v=void 0;if(typeof m=="string"&&(v=m),g==null)t.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,void 0,v));else if(g.length){var b=g[0];arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,b)}}}catch(_){Bf.warn("Inject snipet error: "+_)}return d.apply(c,arguments)},s(a,c)}),e(o)},w3e.createServer=function(o,s){var a=s;if(a)return s=function(c,l){var u=c.method=="GET",d=l.write,p=l.end;return l.write=function(m,h,g){try{if(n&&u){var v=Pu.getContentEncodingFromHeaders(l),b=void 0;if(typeof h=="string"&&(b=h),v==null)t.INSTANCE.ValidateInjection(l,m)&&(arguments[0]=this.InjectWebSnippet(l,m,void 0,b));else if(v.length){var _=v[0];arguments[0]=t.INSTANCE.InjectWebSnippet(l,m,_)}}}catch(x){Bf.warn("Inject snippet error: "+x)}return d.apply(l,arguments)},l.end=function(m,h,g){try{if(n&&u){var v=Pu.getContentEncodingFromHeaders(l),b=void 0;if(typeof h=="string"&&(b=h),v==null)t.INSTANCE.ValidateInjection(l,m)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(l,m,void 0,b));else if(v.length){var _=v[0];arguments[0]=t.INSTANCE.InjectWebSnippet(l,m,_)}}}catch(x){Bf.warn("Inject snippet error: "+x)}return p.apply(l,arguments)},a(c,l)},r(o,s)}},t.prototype.ValidateInjection=function(e,r){try{if(!e||!r||e.statusCode!=200)return!1;var n=Pu.isContentTypeHeaderHtml(e);if(!n)return!1;var o=r.slice().toString();if(o.indexOf("<head>")>=0&&o.indexOf("</head>")>=0&&o.indexOf(t._aiUrl)<0&&o.indexOf(t._aiDeprecatedUrl)<0)return!0}catch(s){Bf.info("validate injections error: "+s)}return!1},t.prototype.InjectWebSnippet=function(e,r,n,o){try{var s=!!n;if(s)e.removeHeader("Content-Length"),r=this._getInjectedCompressBuffer(e,r,n),e.setHeader("Content-Length",r.length);else{var a=r.toString(),c=a.indexOf("</head>");if(c<0)return r;var l=Pu.insertSnippetByIndex(c,a,t._snippet);if(typeof r=="string")e.removeHeader("Content-Length"),r=l,e.setHeader("Content-Length",Buffer.byteLength(r));else if(Buffer.isBuffer(r)){var u=o||"utf8",d=Pu.isBufferType(r,u);if(d){e.removeHeader("Content-Length");var p=Buffer.from(l).toString(u);r=Buffer.from(p,u),e.setHeader("Content-Length",r.length)}}}}catch(f){Bf.warn("Failed to inject web snippet and change content-lenght headers. Exception:"+f)}return r},t.prototype._getInjectedCompressBuffer=function(e,r,n){try{switch(n){case Pu.contentEncodingMethod.GZIP:var o=lR.gunzipSync(r);if(this.ValidateInjection(e,o)){var s=this.InjectWebSnippet(e,o);r=lR.gzipSync(s)}break;case Pu.contentEncodingMethod.DEFLATE:var a=lR.inflateSync(r);if(this.ValidateInjection(e,a)){var c=this.InjectWebSnippet(e,a);r=lR.deflateSync(c)}break;case Pu.contentEncodingMethod.BR:var l=Pu.getBrotliDecompressSync(lR),u=Pu.getBrotliCompressSync(lR);if(l&&u){var d=l(r);if(this.ValidateInjection(e,d)){var p=this.InjectWebSnippet(e,d);r=u(p)}break}}}catch(f){Bf.info("get web injection compress buffer error: "+f)}return r},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();P3e.exports=gxt});var N3e=R((Ese,D3e)=>{"use strict";var vxt=Ese&&Ese.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Au=require("url"),Tse=ma(),yxt=zs(),bxt=Ok(),_xt=ooe(),xxt=pS(),Sxt=function(t){vxt(e,t);function e(r,n){var o=t.call(this)||this;return n&&n.method&&r&&(o.method=n.method,o.url=e._getUrlFromRequestOptions(r,n),o.startTime=+new Date),o}return e.prototype.onError=function(r){this._setStatus(void 0,r)},e.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=yxt.getCorrelationContextTarget(r,bxt.requestContextTargetKey)},e.prototype.getDependencyTelemetry=function(r,n){var o=this.method.toUpperCase(),s=Tse.RemoteDependencyDataConstants.TYPE_HTTP,a="";try{var c=new Au.URL(this.url);c.search=void 0,c.hash=void 0,o+=" "+c.pathname,a=c.hostname,c.port&&(a+=":"+c.port)}catch{}this.correlationId?(s=Tse.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==xxt.correlationIdPrefix&&(a+=" | "+this.correlationId)):s=Tse.RemoteDependencyDataConstants.TYPE_HTTP;var l={id:n,name:o,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:s,target:a};if(r&&r.time?l.time=r.time:this.startTime&&(l.time=new Date(this.startTime)),r){for(var u in r)l[u]||(l[u]=r[u]);if(r.properties)for(var u in r.properties)l.properties[u]=r.properties[u]}return l},e._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)try{r=new Au.URL(r)}catch{}else try{var o=new Au.URL("http://"+r);o.port==="443"?r=new Au.URL("https://"+r):r=new Au.URL("http://"+r)}catch{}else{if(r&&typeof Au.URL=="function"&&r instanceof Au.URL)return Au.format(r);var s=r;r={},s&&Object.keys(s).forEach(function(l){r[l]=s[l]})}if(r.path&&r.host)try{var a=new Au.URL(r.path,"http://"+r.host+r.path);r.pathname=a.pathname,r.search=a.search}catch{}if(r.path&&r.hostname&&!r.host)try{var a=new Au.URL(r.path,"http://"+r.hostname+r.path);r.pathname=a.pathname,r.search=a.search}catch{}if(r.host&&r.port)try{var c=new Au.URL("http://"+r.host);!c.port&&r.port&&(r.hostname=r.host,delete r.host)}catch{}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",Au.format(r)},e}(_xt);D3e.exports=Sxt});var L3e=R(uR=>{"use strict";var jj=uR&&uR.__assign||function(){return jj=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},jj.apply(this,arguments)};Object.defineProperty(uR,"__esModule",{value:!0});uR.parseEventHubSpan=void 0;var wse=(Ur(),fo(Tk)),Ixt=(za(),fo(cDe)),Cxt=(Bd(),fo($ne)),t4=Ei(),Txt=function(t){var e=0,r=0,n=Ixt.hrTimeToMilliseconds(t.startTime);return t.links.forEach(function(o){var s=o.attributes,a=s?.[t4.ENQUEUED_TIME];a&&(e+=1,r+=n-(parseFloat(a.toString())||0))}),Math.max(r/(e||1),0)},Ext=function(t,e){var r,n=t.attributes[t4.AzNamespace],o=(t.attributes[Cxt.SemanticAttributes.NET_PEER_NAME]||t.attributes["peer.address"]||"unknown").replace(/\/$/g,""),s=t.attributes[t4.MessageBusDestination]||"unknown";switch(t.kind){case wse.SpanKind.CLIENT:e.dependencyTypeName=n,e.target=o+"/"+s;break;case wse.SpanKind.PRODUCER:e.dependencyTypeName=t4.DependencyTypeName.QueueMessage+" | "+n,e.target=o+"/"+s;break;case wse.SpanKind.CONSUMER:e.source=o+"/"+s,e.measurements=jj(jj({},e.measurements),(r={},r[t4.TIME_SINCE_ENQUEUED]=Txt(t),r));break;default:}};uR.parseEventHubSpan=Ext});var F3e=R(Vj=>{"use strict";Object.defineProperty(Vj,"__esModule",{value:!0});Vj.spanToTelemetryContract=void 0;var O3e=require("url"),Gd=(Ur(),fo(Tk)),fr=(Bd(),fo($ne)),Qh=Ei(),wxt=L3e(),kxt=zs();function Rxt(t){for(var e={},r=0,n=Object.keys(t.attributes);r<n.length;r++){var o=n[r];o.startsWith("http.")||o.startsWith("rpc.")||o.startsWith("db.")||o.startsWith("peer.")||o.startsWith("net.")||(e[o]=t.attributes[o])}var s=t.links.map(function(a){return{operation_Id:a.context.traceId,id:a.context.spanId}});return s.length>0&&(e["_MS.links"]=kxt.stringify(s)),e}function Pxt(t){return t===fr.DbSystemValues.DB2||t===fr.DbSystemValues.DERBY||t===fr.DbSystemValues.MARIADB||t===fr.DbSystemValues.MSSQL||t===fr.DbSystemValues.ORACLE||t===fr.DbSystemValues.SQLITE||t===fr.DbSystemValues.OTHER_SQL||t===fr.DbSystemValues.HSQLDB||t===fr.DbSystemValues.H2}function M3e(t){var e=t.attributes[fr.SemanticAttributes.HTTP_METHOD];if(e){var r=t.attributes[fr.SemanticAttributes.HTTP_URL];if(r)return String(r);var n=t.attributes[fr.SemanticAttributes.HTTP_SCHEME],o=t.attributes[fr.SemanticAttributes.HTTP_TARGET];if(n&&o){var s=t.attributes[fr.SemanticAttributes.HTTP_HOST];if(s)return n+"://"+s+o;var a=t.attributes[fr.SemanticAttributes.NET_PEER_PORT];if(a){var c=t.attributes[fr.SemanticAttributes.NET_PEER_NAME];if(c)return n+"://"+c+":"+a+o;var l=t.attributes[fr.SemanticAttributes.NET_PEER_IP];if(l)return n+"://"+l+":"+a+o}}}return""}function kse(t){var e=t.attributes[fr.SemanticAttributes.PEER_SERVICE],r=t.attributes[fr.SemanticAttributes.HTTP_HOST],n=t.attributes[fr.SemanticAttributes.HTTP_URL],o=t.attributes[fr.SemanticAttributes.NET_PEER_NAME],s=t.attributes[fr.SemanticAttributes.NET_PEER_IP];return e?String(e):r?String(r):n?String(n):o?String(o):s?String(s):""}function Axt(t){var e={name:t.name,success:t.status.code!=Gd.SpanStatusCode.ERROR,resultCode:"0",duration:0,data:"",dependencyTypeName:""};t.kind===Gd.SpanKind.PRODUCER&&(e.dependencyTypeName=Qh.DependencyTypeName.QueueMessage),t.kind===Gd.SpanKind.INTERNAL&&t.parentSpanId&&(e.dependencyTypeName=Qh.DependencyTypeName.InProc);var r=t.attributes[fr.SemanticAttributes.HTTP_METHOD],n=t.attributes[fr.SemanticAttributes.DB_SYSTEM],o=t.attributes[fr.SemanticAttributes.RPC_SYSTEM];if(r){e.dependencyTypeName=Qh.DependencyTypeName.Http;var s=t.attributes[fr.SemanticAttributes.HTTP_URL];if(s){var a="";try{var c=new O3e.URL(String(s));a=c.pathname}catch{}e.name=r+" "+a}e.data=M3e(t);var l=t.attributes[fr.SemanticAttributes.HTTP_STATUS_CODE];l&&(e.resultCode=String(l));var u=kse(t);if(u){try{var d=new RegExp(/(https?)(:\/\/.*)(:\d+)(\S*)/),p=d.exec(u);if(p!=null){var f=p[1],m=p[3];(f=="https"&&m==":443"||f=="http"&&m==":80")&&(u=p[1]+p[2]+p[4])}}catch{}e.target=""+u}}else if(n){String(n)===fr.DbSystemValues.MYSQL?e.dependencyTypeName="mysql":String(n)===fr.DbSystemValues.POSTGRESQL?e.dependencyTypeName="postgresql":String(n)===fr.DbSystemValues.MONGODB?e.dependencyTypeName="mongodb":String(n)===fr.DbSystemValues.REDIS?e.dependencyTypeName="redis":Pxt(String(n))?e.dependencyTypeName="SQL":e.dependencyTypeName=String(n);var h=t.attributes[fr.SemanticAttributes.DB_STATEMENT],g=t.attributes[fr.SemanticAttributes.DB_OPERATION];h?e.data=String(h):g&&(e.data=String(g));var u=kse(t),v=t.attributes[fr.SemanticAttributes.DB_NAME];u?e.target=v?u+"|"+v:""+u:e.target=v?""+v:""+n}else if(o){e.dependencyTypeName=Qh.DependencyTypeName.Grpc;var b=t.attributes[fr.SemanticAttributes.RPC_GRPC_STATUS_CODE];b&&(e.resultCode=String(b));var u=kse(t);u?e.target=""+u:o&&(e.target=String(o))}return e}function Dxt(t){var e={name:t.name,success:t.status.code!=Gd.SpanStatusCode.ERROR,resultCode:"0",duration:0,url:"",source:void 0},r=t.attributes[fr.SemanticAttributes.HTTP_METHOD],n=t.attributes[fr.SemanticAttributes.RPC_GRPC_STATUS_CODE];if(r){if(t.kind==Gd.SpanKind.SERVER){var o=t.attributes[fr.SemanticAttributes.HTTP_ROUTE],s=t.attributes[fr.SemanticAttributes.HTTP_URL];if(o)e.name=r+" "+o;else if(s)try{var a=new O3e.URL(String(s));e.name=r+" "+a.pathname}catch{}}e.url=M3e(t);var c=t.attributes[fr.SemanticAttributes.HTTP_STATUS_CODE];c&&(e.resultCode=String(c))}else n&&(e.resultCode=String(n));return e}function Nxt(t){var e;switch(t.kind){case Gd.SpanKind.CLIENT:case Gd.SpanKind.PRODUCER:case Gd.SpanKind.INTERNAL:e=Axt(t);break;case Gd.SpanKind.SERVER:case Gd.SpanKind.CONSUMER:e=Dxt(t);break}var r=t.spanContext?t.spanContext():t.context(),n=""+r.spanId,o=Math.round(t.duration[0]*1e3+t.duration[1]/1e6);return e.id=n,e.duration=o,e.properties=Rxt(t),t.attributes[Qh.AzNamespace]&&(t.kind===Gd.SpanKind.INTERNAL&&(e.dependencyTypeName=Qh.DependencyTypeName.InProc+" | "+t.attributes[Qh.AzNamespace]),t.attributes[Qh.AzNamespace]===Qh.MicrosoftEventHub&&wxt.parseEventHubSpan(t,e)),e}Vj.spanToTelemetryContract=Nxt});var B3e=R(Uy=>{"use strict";var dR=Uy&&Uy.__assign||function(){return dR=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},dR.apply(this,arguments)};Object.defineProperty(Uy,"__esModule",{value:!0});Uy.AsyncScopeManager=Uy.OpenTelemetryScopeManagerWrapper=void 0;var Fy=Ny(),Lxt=require("events"),U3e=function(){function t(){}return t.prototype.active=function(){var e=this,r=Fy.CorrelationContextManager.getCurrentContext();return dR(dR({},r),{getValue:function(n){return e._activeSymbol?n===e._activeSymbol?r:!1:(e._activeSymbol=n,r)},setValue:function(){}})},t.prototype.with=function(e,r){var n=e.parentSpanId,o=e.name,s=t._spanToContext(e,n,o);return Fy.CorrelationContextManager.runWithContext(s,r)()},t.prototype.bind=function(e){return typeof e=="function"?Fy.CorrelationContextManager.wrapCallback(e):(e instanceof Lxt.EventEmitter&&Fy.CorrelationContextManager.wrapEmitter(e),e)},t.prototype.enable=function(){return Fy.CorrelationContextManager.enable(),this},t.prototype.disable=function(){return Fy.CorrelationContextManager.disable(),this},t._spanToContext=function(e,r,n){var o=e.spanContext?e.spanContext():e.context(),s=dR(dR({},e.spanContext()),{traceFlags:e.spanContext().traceFlags}),a=r?"|"+o.traceId+"."+r+".":o.traceId,c=Fy.CorrelationContextManager.getCurrentContext();c&&(s.traceId=c.operation.id,r||(a=c.operation.parentId));var l=Fy.CorrelationContextManager.spanToContextObject(s,a,n);return l},t}();Uy.OpenTelemetryScopeManagerWrapper=U3e;Uy.AsyncScopeManager=new U3e});var q3e=R(By=>{"use strict";Object.defineProperty(By,"__esModule",{value:!0});By.enable=By.subscriber=void 0;var r4=(Ur(),fo(Tk)),Oxt=Ei(),Rse=Gi(),Mxt=F3e(),Fxt=B3e(),IS=[],Uxt=function(t){try{var e=t.data,r=Mxt.spanToTelemetryContract(e);Fxt.AsyncScopeManager.with(e,function(){IS.forEach(function(n){e.kind===r4.SpanKind.SERVER||e.kind===r4.SpanKind.CONSUMER?n.trackRequest(r):(e.kind===r4.SpanKind.CLIENT||e.kind===r4.SpanKind.INTERNAL||e.kind===r4.SpanKind.PRODUCER)&&n.trackDependency(r)})})}catch{}};By.subscriber=Uxt;function Bxt(t,e){if(t){var r=IS.find(function(n){return n==e});if(r)return;IS.length===0&&Rse.channel.subscribe("azure-coretracing",By.subscriber,Rse.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Oxt.StatsbeatInstrumentation.AZURE_CORE_TRACING)}),IS.push(e)}else IS=IS.filter(function(n){return n!=e}),IS.length===0&&Rse.channel.unsubscribe("azure-coretracing",By.subscriber)}By.enable=Bxt});var j3e=R(qy=>{"use strict";Object.defineProperty(qy,"__esModule",{value:!0});qy.enable=qy.subscriber=void 0;var qxt=Ei(),Pse=Gi(),CS=[],jxt=function(t){t.data.event.commandName!=="ismaster"&&CS.forEach(function(e){var r=t.data.startedData&&t.data.startedData.databaseName||"Unknown database";e.trackDependency({target:r,data:t.data.event.commandName,name:t.data.event.commandName,duration:t.data.event.duration,success:t.data.succeeded,resultCode:t.data.succeeded?"0":"1",time:t.data.startedData.time,dependencyTypeName:"mongodb"})})};qy.subscriber=jxt;function Vxt(t,e){if(t){var r=CS.find(function(n){return n==e});if(r)return;CS.length===0&&Pse.channel.subscribe("mongodb",qy.subscriber,Pse.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(qxt.StatsbeatInstrumentation.MONGODB)}),CS.push(e)}else CS=CS.filter(function(n){return n!=e}),CS.length===0&&Pse.channel.unsubscribe("mongodb",qy.subscriber)}qy.enable=Vxt});var V3e=R(jy=>{"use strict";Object.defineProperty(jy,"__esModule",{value:!0});jy.enable=jy.subscriber=void 0;var Hxt=Ei(),Ase=Gi(),TS=[],Gxt=function(t){TS.forEach(function(e){var r=t.data.query||{},n=r.sql||"Unknown query",o=!t.data.err,s=r._connection||{},a=s.config||{},c=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;e.trackDependency({target:c,data:n,name:n,duration:t.data.duration,success:o,resultCode:o?"0":"1",time:t.data.time,dependencyTypeName:"mysql"})})};jy.subscriber=Gxt;function zxt(t,e){if(t){var r=TS.find(function(n){return n==e});if(r)return;TS.length===0&&Ase.channel.subscribe("mysql",jy.subscriber,Ase.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Hxt.StatsbeatInstrumentation.MYSQL)}),TS.push(e)}else TS=TS.filter(function(n){return n!=e}),TS.length===0&&Ase.channel.unsubscribe("mysql",jy.subscriber)}jy.enable=zxt});var H3e=R(Vy=>{"use strict";Object.defineProperty(Vy,"__esModule",{value:!0});Vy.enable=Vy.subscriber=void 0;var $xt=Ei(),Dse=Gi(),ES=[],Wxt=function(t){ES.forEach(function(e){t.data.commandObj.command!=="info"&&e.trackDependency({target:t.data.address,name:t.data.commandObj.command,data:t.data.commandObj.command,duration:t.data.duration,success:!t.data.err,resultCode:t.data.err?"1":"0",time:t.data.time,dependencyTypeName:"redis"})})};Vy.subscriber=Wxt;function Kxt(t,e){if(t){var r=ES.find(function(n){return n==e});if(r)return;ES.length===0&&Dse.channel.subscribe("redis",Vy.subscriber,Dse.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation($xt.StatsbeatInstrumentation.REDIS)}),ES.push(e)}else ES=ES.filter(function(n){return n!=e}),ES.length===0&&Dse.channel.unsubscribe("redis",Vy.subscriber)}Vy.enable=Kxt});var G3e=R(Hy=>{"use strict";Object.defineProperty(Hy,"__esModule",{value:!0});Hy.enable=Hy.subscriber=void 0;var Yxt=Ei(),Nse=Gi(),wS=[],Qxt=function(t){wS.forEach(function(e){var r=t.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",o=!t.data.error,s=t.data.database.host+":"+t.data.database.port;e.trackDependency({target:s,data:n,name:n,duration:t.data.duration,success:o,resultCode:o?"0":"1",time:t.data.time,dependencyTypeName:"postgres"})})};Hy.subscriber=Qxt;function Xxt(t,e){if(t){var r=wS.find(function(n){return n==e});if(r)return;wS.length===0&&Nse.channel.subscribe("postgres",Hy.subscriber,Nse.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Yxt.StatsbeatInstrumentation.POSTGRES)}),wS.push(e)}else wS=wS.filter(function(n){return n!=e}),wS.length===0&&Nse.channel.unsubscribe("postgres",Hy.subscriber)}Hy.enable=Xxt});var mR=R((Ose,z3e)=>{"use strict";var Hj=Ose&&Ose.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)n[o]=s[a];return n},pR=require("http"),fR=require("https"),Gj=ri(),Lse=zs(),Gy=Ok(),Jxt=N3e(),n4=Ny(),zj=$q(),Zxt=zq(),i4=pS(),eSt=function(){function t(e){if(t.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),Zxt.IsInitialized&&(q3e().enable(e,this._client),j3e().enable(e,this._client),V3e().enable(e,this._client),H3e().enable(e,this._client),G3e().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._initialize=function(){var e=this;this._isInitialized=!0;var r=pR.request,n=fR.request,o=function(s,a){try{var c=!a[t.disableCollectionRequestOption]&&!s[t.alreadyAutoCollectedFlag],l=null;if(a.headers&&(l=a.headers["User-Agent"]||a.headers["user-agent"],l&&l.toString().indexOf("azsdk-js")!==-1&&(c=!1)),s&&a&&c&&(n4.CorrelationContextManager.wrapEmitter(s),e._isEnabled))if(s[t.alreadyAutoCollectedFlag]=!0,n4.CorrelationContextManager.getCurrentContext())t.trackRequest(e._client,{options:a,request:s});else{var u=null;if(i4.w3cEnabled){var d=new zj;u=d.traceId}else{var p=i4.generateRequestId(null);u=i4.getRootId(p)}var f=n4.CorrelationContextManager.generateContextObject(u);n4.CorrelationContextManager.runWithContext(f,function(){t.trackRequest(e._client,{options:a,request:s})})}}catch(m){Gj.warn("Failed to generate dependency telemetry.",Lse.dumpObj(m))}};pR.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=r.call.apply(r,Hj([pR,s],a));return o(l,s),l},fR.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=n.call.apply(n,Hj([fR,s],a));return o(l,s),l},pR.get=function(s){for(var a,c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l];var u=(a=pR.request).call.apply(a,Hj([pR,s],c));return u.end(),u},fR.get=function(s){for(var a,c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l];var u=(a=fR.request).call.apply(a,Hj([fR,s],c));return u.end(),u}},t.trackRequest=function(e,r){if(!r.options||!r.request||!e){Gj.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!e);return}var n=new Jxt(r.options,r.request),o=n4.CorrelationContextManager.getCurrentContext(),s,a;if(o&&o.operation&&o.operation.traceparent&&zj.isValidTraceId(o.operation.traceparent.traceId))o.operation.traceparent.updateSpanId(),s=o.operation.traceparent.getBackCompatRequestId();else if(i4.w3cEnabled){var c=new zj;a=c.toString(),s=c.getBackCompatRequestId()}else s=o&&o.operation&&o.operation.parentId+t.requestNumber+++".";if(Lse.canIncludeCorrelationHeader(e,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&e.config&&e.config.correlationId){var l=r.request.getHeader(Gy.requestContextHeader);try{Lse.safeIncludeCorrelationHeader(e,r.request,l)}catch(p){Gj.warn("Request-Context header could not be set. Correlation of requests may be lost",p)}if(o&&o.operation)try{if(r.request.setHeader(Gy.requestIdHeader,s),e.config.ignoreLegacyHeaders||(r.request.setHeader(Gy.parentIdHeader,o.operation.id),r.request.setHeader(Gy.rootIdHeader,s)),a||o.operation.traceparent)r.request.setHeader(Gy.traceparentHeader,a||o.operation.traceparent.toString());else if(i4.w3cEnabled){var c=new zj().toString();r.request.setHeader(Gy.traceparentHeader,c)}if(o.operation.tracestate){var u=o.operation.tracestate.toString();u&&r.request.setHeader(Gy.traceStateHeader,u)}var d=o.customProperties.serializeToHeader();d&&r.request.setHeader(Gy.correlationContextHeader,d)}catch(p){Gj.warn("Correlation headers could not be set. Correlation of requests may be lost.",p)}}r.request.on&&(r.request.on("response",function(p){if(!r.isProcessed){r.isProcessed=!0,n.onResponse(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects["http.ClientResponse"]=p,e.trackDependency(f)}}),r.request.on("error",function(p){if(!r.isProcessed){r.isProcessed=!0,n.onError(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects.Error=p,e.trackDependency(f)}}),r.request.on("abort",function(){if(!r.isProcessed){r.isProcessed=!0,n.onError(new Error("The request has been aborted and the network socket has closed."));var p=n.getDependencyTelemetry(r,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=r.options,p.contextObjects["http.ClientRequest"]=r.request,e.trackDependency(p)}}))},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.disableCollectionRequestOption="disableAppInsightsAutoCollection",t.requestNumber=1,t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();z3e.exports=eSt});var Fse=R((bJr,Q3e)=>{"use strict";var $3e=require("http"),W3e=require("https"),K3e=ri(),Y3e=zs(),tSt=Ok(),Mse=loe(),Xh=Ny(),rSt=Lj(),nSt=function(){function t(e){if(t.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||rSt.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},t.prototype.useAutoCorrelation=function(e,r){e&&!this._isAutoCorrelating?Xh.CorrelationContextManager.enable(r):!e&&this._isAutoCorrelating&&Xh.CorrelationContextManager.disable(),this._isAutoCorrelating=e},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},t.prototype._generateCorrelationContext=function(e){if(this._isAutoCorrelating)return Xh.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},t.prototype._registerRequest=function(e,r,n){var o=this,s=new Mse(e),a=this._generateCorrelationContext(s);Xh.CorrelationContextManager.runWithContext(a,function(){o._isEnabled&&(e[t.alreadyAutoCollectedFlag]=!0,t.trackRequest(o._client,{request:e,response:r},s)),typeof n=="function"&&n(e,r)})},t.prototype._initialize=function(){if(this._isInitialized=!0,!t.HANDLER_READY){t.HANDLER_READY=!0;var e=function(s){if(s){if(typeof s!="function")throw new Error("onRequest handler must be a function");return function(a,c){Xh.CorrelationContextManager.wrapEmitter(a),Xh.CorrelationContextManager.wrapEmitter(c);var l=a&&!a[t.alreadyAutoCollectedFlag];a&&l&&t.INSTANCE?t.INSTANCE._registerRequest(a,c,s):s(a,c)}}},r=function(s){var a=s.addListener.bind(s);s.addListener=function(c,l){switch(c){case"request":case"checkContinue":return a(c,e(l));default:return a(c,l)}},s.on=s.addListener},n=$3e.createServer;$3e.createServer=function(s,a){if(a&&typeof a=="function"){var c=n(s,e(a));return r(c),c}else{var c=n(e(s));return r(c),c}};var o=W3e.createServer;W3e.createServer=function(s,a){var c=o(s,e(a));return r(c),c}}},t.trackRequestSync=function(e,r){if(!r.request||!r.response||!e){K3e.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!e);return}r.isProcessed=!1,t.addResponseCorrelationIdHeader(e,r.response);var n=Xh.CorrelationContextManager.getCurrentContext(),o=new Mse(r.request,n&&n.operation.parentId);n&&(n.operation.id=o.getOperationId(e.context.tags)||n.operation.id,n.operation.name=o.getOperationName(e.context.tags)||n.operation.name,n.operation.parentId=o.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(o.getCorrelationContextHeader())),t.endRequest(e,o,r,r.duration,r.error)},t.trackRequest=function(e,r,n){if(!r.request||!r.response||!e){K3e.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!e);return}r.isProcessed=!1;var o=Xh.CorrelationContextManager.getCurrentContext(),s=n||new Mse(r.request,o&&o.operation.parentId);Y3e.canIncludeCorrelationHeader(e,s.getUrl())&&t.addResponseCorrelationIdHeader(e,r.response),o&&!n&&(o.operation.id=s.getOperationId(e.context.tags)||o.operation.id,o.operation.name=s.getOperationName(e.context.tags)||o.operation.name,o.operation.parentId=s.getOperationParentId(e.context.tags)||o.operation.parentId,o.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){t.endRequest(e,s,r,null,null)}),r.request.on&&r.request.on("error",function(a){t.endRequest(e,s,r,null,a)}),r.request.on&&r.request.on("aborted",function(){var a="The request has been aborted and the network socket has closed.";t.endRequest(e,s,r,null,a)})},t.addResponseCorrelationIdHeader=function(e,r){if(e.config&&e.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(tSt.requestContextHeader);Y3e.safeIncludeCorrelationHeader(e,r,n)}},t.endRequest=function(e,r,n,o,s){if(!n.isProcessed){n.isProcessed=!0,s?r.onError(s,o):r.onResponse(n.response,o);var a=r.getRequestTelemetry(n);if(a.tagOverrides=r.getRequestTags(e.context.tags),n.tagOverrides)for(var c in n.tagOverrides)a.tagOverrides[c]=n.tagOverrides[c];var l=r.getLegacyRootId();l&&(a.properties.ai_legacyRootId=l),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=n.request,a.contextObjects["http.ServerResponse"]=n.response,e.trackRequest(a)}},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1,Xh.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},t.HANDLER_READY=!1,t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();Q3e.exports=nSt});var Z3e=R((Bse,J3e)=>{"use strict";var Du=Bse&&Bse.__assign||function(){return Du=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Du.apply(this,arguments)},Use=require("os"),kS=ma(),X3e=Ei(),iSt=zs(),oSt=ri(),sSt=iSt.w3cTraceId(),aSt=function(){function t(){}return t.createQuickPulseEnvelope=function(e,r,n,o){var s=Use&&typeof Use.hostname=="function"&&Use.hostname()||"Unknown",a=o.tags&&o.keys&&o.keys.cloudRoleInstance&&o.tags[o.keys.cloudRoleInstance]||s,c=o.tags&&o.keys&&o.keys.cloudRole&&o.tags[o.keys.cloudRole]||null,l={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:o.tags[o.keys.internalSdkVersion],StreamId:sSt,MachineName:s,Instance:a,RoleName:c};return l},t.createQuickPulseMetric=function(e){var r;return r={Name:e.name,Value:e.value,Weight:e.count||1},r},t.telemetryEnvelopeToQuickPulseDocument=function(e){switch(e.data.baseType){case kS.TelemetryTypeString.Event:return t.createQuickPulseEventDocument(e);case kS.TelemetryTypeString.Exception:return t.createQuickPulseExceptionDocument(e);case kS.TelemetryTypeString.Trace:return t.createQuickPulseTraceDocument(e);case kS.TelemetryTypeString.Dependency:return t.createQuickPulseDependencyDocument(e);case kS.TelemetryTypeString.Request:return t.createQuickPulseRequestDocument(e)}return null},t.createQuickPulseEventDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.name,o=Du(Du({},r),{Name:n});return o},t.createQuickPulseTraceDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.severityLevel||0,o=Du(Du({},r),{Message:e.data.baseData.message,SeverityLevel:kS.SeverityLevel[n]});return o},t.createQuickPulseExceptionDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.exceptions,o="",s="",a="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(l){o+=l.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(o=n[0].stack),s=n[0].message,a=n[0].typeName);var c=Du(Du({},r),{Exception:o,ExceptionMessage:s,ExceptionType:a});return c},t.createQuickPulseRequestDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,o=Du(Du({},r),{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return o},t.createQuickPulseDependencyDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,o=Du(Du({},r),{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return o},t.createQuickPulseDocument=function(e){var r,n,o,s;e.data.baseType?(n=X3e.TelemetryTypeStringToQuickPulseType[e.data.baseType],r=X3e.TelemetryTypeStringToQuickPulseDocumentType[e.data.baseType]):oSt.warn("Document type invalid; not sending live metric document",e.data.baseType),o=e.tags[t.keys.operationId],s=t.aggregateProperties(e);var a={DocumentType:r,__type:n,OperationId:o,Version:"1.0",Properties:s};return a},t.aggregateProperties=function(e){var r=[],n=e.data.baseData.measurements||{};for(var o in n)if(n.hasOwnProperty(o)){var s=n[o],a={key:o,value:s};r.push(a)}var c=e.data.baseData.properties||{};for(var o in c)if(c.hasOwnProperty(o)){var s=c[o],a={key:o,value:s};r.push(a)}return r},t.keys=new kS.ContextTagKeys,t}();J3e.exports=aSt});var tMe=R((_Jr,eMe)=>{"use strict";var cSt=function(){return(Date.now()+621355968e5)*1e4};eMe.exports={getTransmissionTime:cSt}});var oMe=R((o4,iMe)=>{"use strict";var rMe=o4&&o4.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},nMe=o4&&o4.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},lSt=require("https"),uSt=mR(),qse=ri(),dSt=tMe(),jse=zs(),pSt=require("url"),Nu={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect-v2",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},fSt=function(){function t(e,r){this._config=e,this._consecutiveErrors=0,this._getAuthorizationHandler=r}return t.prototype.ping=function(e,r,n){var o=[{name:Nu.streamId,value:e.StreamId},{name:Nu.machineName,value:e.MachineName},{name:Nu.roleName,value:e.RoleName},{name:Nu.instanceName,value:e.Instance},{name:Nu.invariantVersion,value:e.InvariantVersion.toString()}];this._submitData(e,r,n,"ping",o)},t.prototype.post=function(e,r,n){return rMe(this,void 0,void 0,function(){return nMe(this,function(o){switch(o.label){case 0:return[4,this._submitData([e],r,n,"post")];case 1:return o.sent(),[2]}})})},t.prototype._submitData=function(e,r,n,o,s){return rMe(this,void 0,void 0,function(){var a,c,l,u,d,p,f,m,h=this;return nMe(this,function(g){switch(g.label){case 0:if(a=jse.stringify(e),c=(f={},f[uSt.disableCollectionRequestOption]=!0,f.host=r&&r.length>0?r:this._config.quickPulseHost,f.method=Nu.method,f.path="/QuickPulseService.svc/"+o+"?ikey="+this._config.instrumentationKey,f.headers=(m={Expect:"100-continue"},m[Nu.time]=dSt.getTransmissionTime(),m["Content-Type"]="application/json",m["Content-Length"]=Buffer.byteLength(a),m),f),s&&s.length>0&&s.forEach(function(v){return c.headers[v.name]=v.value}),o!=="post")return[3,4];if(l=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!l)return[3,4];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,l.addAuthorizationHeader(c)];case 2:return g.sent(),[3,4];case 3:return u=g.sent(),d="Failed to get AAD bearer token for the Application. Error:",qse.info(t.TAG,d,u),[2];case 4:return this._config.httpsAgent?c.agent=this._config.httpsAgent:c.agent=jse.tlsRestrictedAgent,p=lSt.request(c,function(v){if(v.statusCode==200){var b=v.headers[Nu.subscribed]==="true",_=null;try{_=v.headers[Nu.endpointRedirect]?new pSt.URL(v.headers[Nu.endpointRedirect].toString()).host:null}catch(S){h._onError("Failed to parse redirect header from QuickPulse: "+jse.dumpObj(S))}var x=v.headers[Nu.pollingIntervalHint]?parseInt(v.headers[Nu.pollingIntervalHint].toString()):null;h._consecutiveErrors=0,n(b,v,_,x)}else h._onError("StatusCode:"+v.statusCode+" StatusMessage:"+v.statusMessage),n()}),p.on("error",function(v){h._onError(v),n()}),p.write(a),p.end(),[2]}})})},t.prototype._onError=function(e){this._consecutiveErrors++;var r="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%t.MAX_QPS_FAILURES_BEFORE_WARN===0?(r="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",qse.warn(t.TAG,r,e)):qse.info(t.TAG,r,e)},t.TAG="QuickPulseSender",t.MAX_QPS_FAILURES_BEFORE_WARN=25,t}();iMe.exports=fSt});var uMe=R((s4,lMe)=>{"use strict";var sMe=s4&&s4.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},aMe=s4&&s4.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},cMe=ri(),Vse=Z3e(),mSt=oMe(),hSt=Ei(),gSt=aR(),vSt=function(){function t(e,r,n){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=e,this.context=r||new gSt,this._sender=new mSt(this.config,n),this._isEnabled=!1}return t.prototype.addCollector=function(e){this._collectors.push(e)},t.prototype.trackMetric=function(e){this._addMetric(e)},t.prototype.addDocument=function(e){if(this._isCollectingData){var r=Vse.telemetryEnvelopeToQuickPulseDocument(e);r&&this._documents.push(r)}},t.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},t.prototype.enableCollectors=function(e){this._collectors.forEach(function(r){r.enable(e)})},t.prototype._addMetric=function(e){var r=e.value,n=e.count||1,o=hSt.PerformanceToQuickPulseCounter[e.name];o&&(this._metrics[o]?(this._metrics[o].Value=(this._metrics[o].Value*this._metrics[o].Weight+r*n)/(this._metrics[o].Weight+n),this._metrics[o].Weight+=n):(this._metrics[o]=Vse.createQuickPulseMetric(e),this._metrics[o].Name=o,this._metrics[o].Weight=1))},t.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},t.prototype._goQuickPulse=function(){return sMe(this,void 0,void 0,function(){var e,r,n,o,s=this;return aMe(this,function(a){switch(a.label){case 0:return e=Object.keys(this._metrics).map(function(c){return s._metrics[c]}),r=Vse.createQuickPulseEnvelope(e,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(r)]:[3,2];case 1:return a.sent(),[3,3];case 2:this._ping(r),a.label=3;case 3:return n=this._pollingIntervalHint>0?this._pollingIntervalHint:t.PING_INTERVAL,o=this._isCollectingData?t.POST_INTERVAL:n,this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,o=t.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(o=t.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),o),this._handle.unref(),[2]}})})},t.prototype._ping=function(e){this._sender.ping(e,this._redirectedHost,this._quickPulseDone.bind(this))},t.prototype._post=function(e){return sMe(this,void 0,void 0,function(){return aMe(this,function(r){switch(r.label){case 0:return[4,this._sender.post(e,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return r.sent(),[2]}})})},t.prototype._quickPulseDone=function(e,r,n,o){e!=null?(this._isCollectingData!==e&&(cMe.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,n&&n.length>0&&(this._redirectedHost=n,cMe.info("Redirecting endpoint to: ",n)),o&&o>0&&(this._pollingIntervalHint=o),r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},t.MAX_POST_WAIT_TIME=2e4,t.MAX_PING_WAIT_TIME=6e4,t.FALLBACK_INTERVAL=6e4,t.PING_INTERVAL=5e3,t.POST_INTERVAL=1e3,t}();lMe.exports=vSt});var dMe=R(hR=>{"use strict";var $j=hR&&hR.__assign||function(){return $j=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},$j.apply(this,arguments)};Object.defineProperty(hR,"__esModule",{value:!0});hR.AutoCollectNativePerformance=void 0;var a4=aR(),ySt=ri(),bSt=function(){function t(e){this._disabledMetrics={},t.INSTANCE&&t.INSTANCE.dispose(),t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e,r,n){var o=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),t._metricsAvailable==null&&e&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");t._emitter=new s,t._metricsAvailable=!0,ySt.info("Native metrics module successfully loaded!")}catch{t._metricsAvailable=!1;return}this._isEnabled=e,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&t._emitter?(t._emitter.enable(!0,n),this._handle||(this._handle=setInterval(function(){return o._trackNativeMetrics()},n),this._handle.unref())):t._emitter&&(t._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))},t.prototype.dispose=function(){this.enable(!1)},t.parseEnabled=function(e,r){var n=r.disableAllExtendedMetrics,o=r.extendedMetricDisablers;if(n)return{isEnabled:!1,disabledMetrics:{}};if(o){var s=o.split(","),a={};if(s.length>0)for(var c=0,l=s;c<l.length;c++){var u=l[c];a[u]=!0}return typeof e=="object"?{isEnabled:!0,disabledMetrics:$j($j({},e),a)}:{isEnabled:e,disabledMetrics:a}}return typeof e=="boolean"?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},t.prototype._trackNativeMetrics=function(){var e=!0;typeof this._isEnabled!="object"&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},t.prototype._trackGarbageCollection=function(){var e;if(!this._disabledMetrics.gc){var r=t._emitter.getGCData();for(var n in r){var o=r[n].metrics,s=n+" Garbage Collection Duration",a=Math.sqrt(o.sumSquares/o.count-Math.pow(o.total/o.count,2))||0;this._client.trackMetric({name:s,value:o.total,count:o.count,max:o.max,min:o.min,stdDev:a,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+a4.sdkVersion,e)})}}},t.prototype._trackEventLoop=function(){var e;if(!this._disabledMetrics.loop){var r=t._emitter.getLoopData(),n=r.loopUsage;if(n.count!=0){var o="Event Loop CPU Time",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:o,value:n.total,count:n.count,min:n.min,max:n.max,stdDev:s,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+a4.sdkVersion,e)})}}},t.prototype._trackHeapUsage=function(){var e,r,n;if(!this._disabledMetrics.heap){var o=process.memoryUsage(),s=o.heapUsed,a=o.heapTotal,c=o.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:s,count:1,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+a4.sdkVersion,e)}),this._client.trackMetric({name:"Memory Total (Heap)",value:a,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+a4.sdkVersion,r)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:c-a,count:1,tagOverrides:(n={},n[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+a4.sdkVersion,n)})}},t}();hR.AutoCollectNativePerformance=bSt});var mMe=R(zy=>{"use strict";var pMe=zy&&zy.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},fMe=zy&&zy.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(zy,"__esModule",{value:!0});zy.AzureFunctionsHook=void 0;var Wj=ri(),Hse=Ny(),_St=function(){function t(e){this._client=e,this._autoGenerateIncomingRequests=!1;try{this._functionsCoreModule=require("@azure/functions-core"),this._addPreInvocationHook(),this._addPostInvocationHook()}catch{Wj.info("AzureFunctionsHook failed to load, not running in Azure Functions")}}return t.prototype._getFuncModelHelper=function(){if(this._cachedModelHelper===void 0){var e=this._functionsCoreModule.getProgrammingModel();e.name==="@azure/functions"&&(e.version.startsWith("3.")?this._cachedModelHelper=new xSt:e.version.startsWith("4.")&&(this._cachedModelHelper=new SSt)),this._cachedModelHelper||(this._cachedModelHelper=null,Wj.warn('AzureFunctionsHook does not support model "'+e.name+'" version "'+e.version+'"'))}return this._cachedModelHelper},t.prototype.enable=function(e){this._autoGenerateIncomingRequests=e},t.prototype.dispose=function(){this.enable(!1),this._removeInvocationHooks(),this._functionsCoreModule=void 0},t.prototype._addPreInvocationHook=function(){var e=this;this._preInvocationHook||(this._preInvocationHook=this._functionsCoreModule.registerHook("preInvocation",function(r){return pMe(e,void 0,void 0,function(){var n,o,s,a;return fMe(this,function(c){try{n=this._getFuncModelHelper(),n&&(o=r.invocationContext,s=Hse.CorrelationContextManager.startOperation(o),s&&(s.customProperties.setProperty("InvocationId",o.invocationId),a=o.traceContext,a.attributes&&(s.customProperties.setProperty("ProcessId",a.attributes.ProcessId),s.customProperties.setProperty("LogLevel",a.attributes.LogLevel),s.customProperties.setProperty("Category",a.attributes.Category),s.customProperties.setProperty("HostInstanceId",a.attributes.HostInstanceId),s.customProperties.setProperty("AzFuncLiveLogsSessionId",a.attributes["#AzFuncLiveLogsSessionId"])),r.functionCallback=Hse.CorrelationContextManager.wrapCallback(r.functionCallback,s),n.isHttpTrigger(r)&&this._autoGenerateIncomingRequests&&(r.hookData.appInsightsExtractedContext=s,r.hookData.appInsightsStartTime=Date.now())))}catch(l){return Wj.warn("Failed to propagate context in Azure Functions",l),[2]}return[2]})})}))},t.prototype._addPostInvocationHook=function(){var e=this;this._postInvocationHook||(this._postInvocationHook=this._functionsCoreModule.registerHook("postInvocation",function(r){return pMe(e,void 0,void 0,function(){var n,o,s,a,c=this;return fMe(this,function(l){try{n=this._getFuncModelHelper(),n&&this._autoGenerateIncomingRequests&&n.isHttpTrigger(r)&&(o=r.inputs[0],o&&(s=r.hookData.appInsightsStartTime||Date.now(),a=r.hookData.appInsightsExtractedContext,a?Hse.CorrelationContextManager.runWithContext(a,function(){c._createIncomingRequestTelemetry(o,r,s,a.operation.parentId)}):this._createIncomingRequestTelemetry(o,r,s,null)))}catch(u){Wj.warn("Error creating automatic incoming request in Azure Functions",u)}return[2]})})}))},t.prototype._createIncomingRequestTelemetry=function(e,r,n,o){var s=this._getFuncModelHelper().getStatusCodes(r),a=200;if(s)for(var c=0,l=s;c<l.length;c++){var u=l[c];if(typeof u=="number"&&Number.isInteger(u)){a=u;break}else if(typeof u=="string"){var d=parseInt(u);if(!isNaN(d)){a=d;break}}}else a=void 0;this._client.trackRequest({name:e.method+" "+e.url,resultCode:a,success:typeof a=="number"?0<a&&a<400:void 0,url:e.url,time:new Date(n),duration:Date.now()-n,id:o}),this._client.flush()},t.prototype._removeInvocationHooks=function(){this._preInvocationHook&&(this._preInvocationHook.dispose(),this._preInvocationHook=void 0),this._postInvocationHook&&(this._postInvocationHook.dispose(),this._postInvocationHook=void 0)},t}();zy.AzureFunctionsHook=_St;var xSt=function(){function t(){}return t.prototype._getInvocationContext=function(e){return e.invocationContext},t.prototype.getStatusCodes=function(e){var r=this._getInvocationContext(e),n,o=r.bindingDefinitions.find(function(s){return s.direction==="out"&&s.type.toLowerCase()==="http"});return o?.name==="$return"?n=e.result:o&&r.bindings&&r.bindings[o.name]!==void 0?n=r.bindings[o.name]:n=r.res,n?[n.statusCode,n.status]:void 0},t.prototype.isHttpTrigger=function(e){var r=this._getInvocationContext(e);return!!r.bindingDefinitions.find(function(n){var o;return((o=n.type)===null||o===void 0?void 0:o.toLowerCase())==="httptrigger"})},t}(),SSt=function(){function t(){}return t.prototype._getInvocationContext=function(e){return e.invocationContext},t.prototype.getStatusCodes=function(e){var r=e.result;return r?[r.status]:void 0},t.prototype.isHttpTrigger=function(e){var r=this._getInvocationContext(e);return r.options.trigger.type.toLowerCase()==="httptrigger"},t}()});var Gse=R((IJr,vMe)=>{"use strict";var ISt=pS(),hMe=Cse(),CSt=ri(),gMe=Ei(),TSt=require("url"),ESt=qB(),wSt=function(){function t(e){this._endpointBase=gMe.DEFAULT_BREEZE_ENDPOINT,this._mergeConfig();var r=this._connectionString,n=hMe.parse(e),o=hMe.parse(r),s=!n.instrumentationkey&&Object.keys(n).length>0?null:e,a=this._instrumentationKey;this.instrumentationKey=n.instrumentationkey||s||o.instrumentationkey||a;var c=""+(this.endpointUrl||n.ingestionendpoint||o.ingestionendpoint||this._endpointBase);c.endsWith("/")&&(c=c.slice(0,-1)),this.endpointUrl=c+"/v2.1/track",this.maxBatchSize=this.maxBatchSize||250,this.maxBatchIntervalMs=this.maxBatchIntervalMs||15e3,this.disableAppInsights=this.disableAppInsights||!1,this.samplingPercentage=this.samplingPercentage||100,this.correlationIdRetryIntervalMs=this.correlationIdRetryIntervalMs||30*1e3,this.enableWebInstrumentation=this.enableWebInstrumentation||this.enableAutoWebSnippetInjection||!1,this.webInstrumentationConfig=this.webInstrumentationConfig||null,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.correlationHeaderExcludedDomains=this.correlationHeaderExcludedDomains||["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.ignoreLegacyHeaders=this.ignoreLegacyHeaders||!1,this.profileQueryEndpoint=n.ingestionendpoint||o.ingestionendpoint||process.env[t.ENV_profileQueryEndpoint]||this._endpointBase,this.quickPulseHost=this.quickPulseHost||n.liveendpoint||o.liveendpoint||process.env[t.ENV_quickPulseHost]||gMe.DEFAULT_LIVEMETRICS_HOST,this.webInstrumentationConnectionString=this.webInstrumentationConnectionString||this._webInstrumentationConnectionString||"",this.webSnippetConnectionString=this.webInstrumentationConnectionString,this.quickPulseHost.match(/^https?:\/\//)&&(this.quickPulseHost=new TSt.URL(this.quickPulseHost).host),this.aadAudience=n.aadaudience||o.aadaudience}return Object.defineProperty(t.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){this._profileQueryEndpoint=e,this.correlationId=ISt.correlationIdPrefix},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instrumentationKey",{get:function(){return this._instrumentationKey},set:function(e){t._validateInstrumentationKey(e)||CSt.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this._instrumentationKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webSnippetConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webInstrumentationConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),t.prototype._mergeConfig=function(){var e=ESt.JsonConfig.getInstance();this._connectionString=e.connectionString,this._instrumentationKey=e.instrumentationKey,this.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains,this.correlationIdRetryIntervalMs=e.correlationIdRetryIntervalMs,this.disableAllExtendedMetrics=e.disableAllExtendedMetrics,this.disableAppInsights=e.disableAppInsights,this.disableStatsbeat=e.disableStatsbeat,this.distributedTracingMode=e.distributedTracingMode,this.enableAutoCollectConsole=e.enableAutoCollectConsole,this.enableLoggerErrorToTrace=e.enableLoggerErrorToTrace,this.enableAutoCollectDependencies=e.enableAutoCollectDependencies,this.enableAutoCollectIncomingRequestAzureFunctions=e.enableAutoCollectIncomingRequestAzureFunctions,this.enableAutoCollectExceptions=e.enableAutoCollectExceptions,this.enableAutoCollectExtendedMetrics=e.enableAutoCollectExtendedMetrics,this.enableAutoCollectExternalLoggers=e.enableAutoCollectExternalLoggers,this.enableAutoCollectHeartbeat=e.enableAutoCollectHeartbeat,this.enableAutoCollectPerformance=e.enableAutoCollectPerformance,this.enableAutoCollectPreAggregatedMetrics=e.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectRequests=e.enableAutoCollectRequests,this.enableAutoDependencyCorrelation=e.enableAutoDependencyCorrelation,this.enableInternalDebugLogging=e.enableInternalDebugLogging,this.enableInternalWarningLogging=e.enableInternalWarningLogging,this.enableResendInterval=e.enableResendInterval,this.enableMaxBytesOnDisk=e.enableMaxBytesOnDisk,this.enableSendLiveMetrics=e.enableSendLiveMetrics,this.enableUseAsyncHooks=e.enableUseAsyncHooks,this.enableUseDiskRetryCaching=e.enableUseDiskRetryCaching,this.endpointUrl=e.endpointUrl,this.extendedMetricDisablers=e.extendedMetricDisablers,this.ignoreLegacyHeaders=e.ignoreLegacyHeaders,this.maxBatchIntervalMs=e.maxBatchIntervalMs,this.maxBatchSize=e.maxBatchSize,this.proxyHttpUrl=e.proxyHttpUrl,this.proxyHttpsUrl=e.proxyHttpsUrl,this.quickPulseHost=e.quickPulseHost,this.samplingPercentage=e.samplingPercentage,this.enableWebInstrumentation=e.enableWebInstrumentation,this._webInstrumentationConnectionString=e.webInstrumentationConnectionString,this.webInstrumentationConfig=e.webInstrumentationConfig,this.webInstrumentationSrc=e.webInstrumentationSrc},t._validateInstrumentationKey=function(e){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(e)},t.ENV_azurePrefix="APPSETTING_",t.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",t.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",t.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",t.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",t}();vMe.exports=wSt});function Kj(){return zse.create()}var yMe,zse,$se=D(()=>{yMe=new Set(["Deserialize","Serialize","Retry","Sign"]),zse=class t{constructor(e){var r;this._policies=[],this._policies=(r=e?.slice(0))!==null&&r!==void 0?r:[],this._orderedPolicies=void 0}addPolicy(e,r={}){if(r.phase&&r.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(r.phase&&!yMe.has(r.phase))throw new Error(`Invalid phase name: ${r.phase}`);if(r.afterPhase&&!yMe.has(r.afterPhase))throw new Error(`Invalid afterPhase name: ${r.afterPhase}`);this._policies.push({policy:e,options:r}),this._orderedPolicies=void 0}removePolicy(e){let r=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(r.push(n.policy),!1):!0),this._orderedPolicies=void 0,r}sendRequest(e,r){return this.getOrderedPolicies().reduceRight((s,a)=>c=>a.sendRequest(c,s),s=>e.sendRequest(s))(r)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new t(this._policies)}static create(){return new t}orderPolicies(){let e=[],r=new Map;function n(h){return{name:h,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),s=n("None"),a=n("Deserialize"),c=n("Retry"),l=n("Sign"),u=[o,s,a,c,l];function d(h){return h==="Retry"?c:h==="Serialize"?o:h==="Deserialize"?a:h==="Sign"?l:s}for(let h of this._policies){let g=h.policy,v=h.options,b=g.name;if(r.has(b))throw new Error("Duplicate policy names not allowed in pipeline");let _={policy:g,dependsOn:new Set,dependants:new Set};v.afterPhase&&(_.afterPhase=d(v.afterPhase),_.afterPhase.hasAfterPolicies=!0),r.set(b,_),d(v.phase).policies.add(_)}for(let h of this._policies){let{policy:g,options:v}=h,b=g.name,_=r.get(b);if(!_)throw new Error(`Missing node for policy ${b}`);if(v.afterPolicies)for(let x of v.afterPolicies){let S=r.get(x);S&&(_.dependsOn.add(S),S.dependants.add(_))}if(v.beforePolicies)for(let x of v.beforePolicies){let S=r.get(x);S&&(S.dependsOn.add(_),_.dependants.add(S))}}function p(h){h.hasRun=!0;for(let g of h.policies)if(!(g.afterPhase&&(!g.afterPhase.hasRun||g.afterPhase.policies.size))&&g.dependsOn.size===0){e.push(g.policy);for(let v of g.dependants)v.dependsOn.delete(g);r.delete(g.policy.name),h.policies.delete(g)}}function f(){for(let h of u){if(p(h),h.policies.size>0&&h!==s){s.hasRun||p(s);return}h.hasAfterPolicies&&p(s)}}let m=0;for(;r.size>0;){m++;let h=e.length;if(f(),e.length<=h&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}});function xMe(t,...e){process.stderr.write(`${_Me.default.format(t,...e)}${bMe.EOL}`)}var bMe,_Me,SMe=D(()=>{bMe=require("os"),_Me=q(require("util"))});function Yse(t){CMe=t,Wse=[],Kse=[];let e=/\*/g,r=t.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of r)n.startsWith("-")?Kse.push(new RegExp(`^${n.substr(1)}$`)):Wse.push(new RegExp(`^${n}$`));for(let n of Yj)n.enabled=Qse(n.namespace)}function Qse(t){if(t.endsWith("*"))return!0;for(let e of Kse)if(e.test(t))return!1;for(let e of Wse)if(e.test(t))return!0;return!1}function kSt(){let t=CMe||"";return Yse(""),t}function EMe(t){let e=Object.assign(r,{enabled:Qse(t),destroy:RSt,log:TMe.log,namespace:t,extend:PSt});function r(...n){e.enabled&&(n.length>0&&(n[0]=`${t} ${n[0]}`),e.log(...n))}return Yj.push(e),e}function RSt(){let t=Yj.indexOf(this);return t>=0?(Yj.splice(t,1),!0):!1}function PSt(t){let e=EMe(`${this.namespace}:${t}`);return e.log=this.log,e}var IMe,CMe,Wse,Kse,Yj,TMe,gR,wMe=D(()=>{SMe();IMe=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,Wse=[],Kse=[],Yj=[];IMe&&Yse(IMe);TMe=Object.assign(t=>EMe(t),{enable:Yse,enabled:Qse,disable:kSt,log:xMe});gR=TMe});function ASt(t){if(t&&!DMe(t))throw new Error(`Unknown log level '${t}'. Acceptable values: ${Zse.join(",")}`);Xse=t;let e=[];for(let r of RMe)AMe(r)&&e.push(r.namespace);gR.enable(e.join(","))}function Jj(t){let e=Jse.extend(t);return PMe(Jse,e),{error:Xj(e,"error"),warning:Xj(e,"warning"),info:Xj(e,"info"),verbose:Xj(e,"verbose")}}function PMe(t,e){e.log=(...r)=>{t.log(...r)}}function Xj(t,e){let r=Object.assign(t.extend(e),{level:e});if(PMe(t,r),AMe(r)){let n=gR.disable();gR.enable(n+","+r.namespace)}return RMe.add(r),r}function AMe(t){return!!(Xse&&kMe[t.level]<=kMe[Xse])}function DMe(t){return Zse.includes(t)}var RMe,Qj,Xse,Jse,Zse,kMe,eae=D(()=>{wMe();RMe=new Set,Qj=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,Jse=gR("azure");Jse.log=(...t)=>{gR.log(...t)};Zse=["verbose","info","warning","error"];Qj&&(DMe(Qj)?ASt(Qj):console.error(`AZURE_LOG_LEVEL set to unknown log level '${Qj}'; logging is not enabled. Acceptable values: ${Zse.join(", ")}.`));kMe={verbose:400,info:300,warning:200,error:100}});var Ys,vR=D(()=>{eae();Ys=Jj("core-rest-pipeline")});var tae,Zj,NMe=D(()=>{Zj=typeof process<"u"&&!!process.version&&!!(!((tae=process.versions)===null||tae===void 0)&&tae.node)});function rae(t){if(t.aborted)return;t.onabort&&t.onabort.call(t);let e=yR.get(t);e&&e.slice().forEach(r=>{r.call(t,{type:"abort"})}),eV.set(t,!0)}var yR,eV,c4,LMe=D(()=>{yR=new WeakMap,eV=new WeakMap,c4=class t{constructor(){this.onabort=null,yR.set(this,[]),eV.set(this,!1)}get aborted(){if(!eV.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return eV.get(this)}static get none(){return new t}addEventListener(e,r){if(!yR.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");yR.get(this).push(r)}removeEventListener(e,r){if(!yR.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");let n=yR.get(this),o=n.indexOf(r);o>-1&&n.splice(o,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}});var qf,l4,OMe=D(()=>{LMe();qf=class extends Error{constructor(e){super(e),this.name="AbortError"}},l4=class{constructor(e){if(this._signal=new c4,!!e){Array.isArray(e)||(e=arguments);for(let r of e)r.aborted?this.abort():r.addEventListener("abort",()=>{this.abort()})}}get signal(){return this._signal}abort(){rae(this._signal)}static timeout(e){let r=new c4,n=setTimeout(rae,e,r);return typeof n.unref=="function"&&n.unref(),r}}});var tV=D(()=>{OMe()});function nae(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}var MMe=D(()=>{});function u4(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}var iae=D(()=>{});function bR(t){if(u4(t)){let e=typeof t.name=="string",r=typeof t.message=="string";return e&&r}return!1}function _R(t){if(bR(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}var FMe=D(()=>{iae()});var xR=D(()=>{NMe();MMe();iae();FMe()});var oae,DSt,NSt,SR,sae=D(()=>{xR();oae="REDACTED",DSt=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],NSt=["api-version"],SR=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:r=[]}={}){e=DSt.concat(e),r=NSt.concat(r),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(r.map(n=>n.toLowerCase()))}sanitize(e){let r=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||u4(o)){if(r.has(o))return"[Circular]";r.add(o)}return o},2)}sanitizeHeaders(e){let r={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?r[n]=e[n]:r[n]=oae;return r}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let r={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?r[n]=e[n]:r[n]=oae;return r}sanitizeUrl(e){if(typeof e!="string"||e===null)return e;let r=new URL(e);if(!r.search)return e;for(let[n]of r.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||r.searchParams.set(n,oae);return r.toString()}}});function rV(t={}){var e;let r=(e=t.logger)!==null&&e!==void 0?e:Ys.info,n=new SR({additionalAllowedHeaderNames:t.additionalAllowedHeaderNames,additionalAllowedQueryParameters:t.additionalAllowedQueryParameters});return{name:aae,async sendRequest(o,s){if(!r.enabled)return s(o);r(`Request: ${n.sanitize(o)}`);let a=await s(o);return r(`Response status code: ${a.status}`),r(`Headers: ${n.sanitize(a.headers)}`),a}}}var aae,cae=D(()=>{vR();sae();aae="logPolicy"});function nV(t={}){let{maxRetries:e=20}=t;return{name:lae,async sendRequest(r,n){let o=await n(r);return BMe(n,o,e)}}}async function BMe(t,e,r,n=0){let{request:o,status:s,headers:a}=e,c=a.get("location");if(c&&(s===300||s===301&&UMe.includes(o.method)||s===302&&UMe.includes(o.method)||s===303&&o.method==="POST"||s===307)&&n<r){let l=new URL(c,o.url);o.url=l.toString(),s===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let u=await t(o);return BMe(t,u,r,n+1)}return e}var lae,UMe,uae=D(()=>{lae="redirectPolicy",UMe=["GET","HEAD"]});function qMe(){return"User-Agent"}function jMe(t){t.set("Node",process.version),t.set("OS",`(${IR.arch()}-${IR.type()}-${IR.release()})`)}var IR,VMe=D(()=>{IR=q(require("os"))});var iV,dae=D(()=>{iV="1.10.1"});function LSt(t){let e=[];for(let[r,n]of t){let o=n?`${r}/${n}`:r;e.push(o)}return e.join(" ")}function HMe(){return qMe()}function oV(t){let e=new Map;e.set("core-rest-pipeline",iV),jMe(e);let r=LSt(e);return t?`${t} ${r}`:r}var pae=D(()=>{VMe();dae()});function sV(t={}){let e=oV(t.userAgentPrefix);return{name:fae,async sendRequest(r,n){return r.headers.has(GMe)||r.headers.set(GMe,e),n(r)}}}var GMe,fae,mae=D(()=>{pae();GMe=HMe(),fae="userAgentPolicy"});function aV(){return{name:hae,async sendRequest(t,e){return t.method!=="HEAD"&&t.headers.set("Accept-Encoding","gzip,deflate"),e(t)}}}var hae,gae=D(()=>{hae="decompressResponsePolicy"});function cV(t,e,r){return new Promise((n,o)=>{let s,a,c=()=>o(new qf(r?.abortErrorMsg?r?.abortErrorMsg:OSt)),l=()=>{r?.abortSignal&&a&&r.abortSignal.removeEventListener("abort",a)};if(a=()=>(s&&clearTimeout(s),l(),c()),r?.abortSignal&&r.abortSignal.aborted)return c();s=setTimeout(()=>{l(),n(e)},t),r?.abortSignal&&r.abortSignal.addEventListener("abort",a)})}function zMe(t,e){let r=t.headers.get(e);if(!r)return;let n=Number(r);if(!Number.isNaN(n))return n}var OSt,lV=D(()=>{tV();OSt="The operation was aborted."});function $Me(t){if(t&&[429,503].includes(t.status))try{for(let o of MSt){let s=zMe(t,o);if(s===0||s)return s*(o===vae?1e3:1)}let e=t.headers.get(vae);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function WMe(t){return Number.isFinite($Me(t))}function uV(){return{name:"throttlingRetryStrategy",retry({response:t}){let e=$Me(t);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}var vae,MSt,dV=D(()=>{lV();vae="Retry-After",MSt=["retry-after-ms","x-ms-retry-after-ms",vae]});function CR(t={}){var e,r;let n=(e=t.retryDelayInMs)!==null&&e!==void 0?e:FSt,o=(r=t.maxRetryDelayInMs)!==null&&r!==void 0?r:USt,s=n;return{name:"exponentialRetryStrategy",retry({retryCount:a,response:c,responseError:l}){let u=qSt(l),d=u&&t.ignoreSystemErrors,p=BSt(c),f=p&&t.ignoreHttpStatusCodes;if(c&&(WMe(c)||!p)||f||d)return{skipStrategy:!0};if(l&&!u&&!p)return{errorToThrow:l};let h=s*Math.pow(2,a),g=Math.min(o,h);return s=g/2+nae(0,g/2),{retryAfterInMs:s}}}}function BSt(t){return!!(t&&t.status!==void 0&&(t.status>=500||t.status===408)&&t.status!==501&&t.status!==505)}function qSt(t){return t?t.code==="ETIMEDOUT"||t.code==="ESOCKETTIMEDOUT"||t.code==="ECONNREFUSED"||t.code==="ECONNRESET"||t.code==="ENOENT":!1}var FSt,USt,pV=D(()=>{xR();dV();FSt=1e3,USt=1e3*64});function jf(t,e={maxRetries:3}){let r=e.logger||KMe;return{name:jSt,async sendRequest(n,o){var s,a;let c,l,u=-1;e:for(;;){u+=1,c=void 0,l=void 0;try{r.info(`Retry ${u}: Attempting to send request`,n.requestId),c=await o(n),r.info(`Retry ${u}: Received a response from request`,n.requestId)}catch(d){if(r.error(`Retry ${u}: Received an error from request`,n.requestId),l=d,!d||l.name!=="RestError")throw d;c=l.response}if(!((s=n.abortSignal)===null||s===void 0)&&s.aborted)throw r.error(`Retry ${u}: Request aborted.`),new qf;if(u>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(r.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(c)return c;throw new Error("Maximum retries reached with no response or error to throw")}r.info(`Retry ${u}: Processing ${t.length} retry strategies.`);t:for(let d of t){let p=d.logger||KMe;p.info(`Retry ${u}: Processing retry strategy ${d.name}.`);let f=d.retry({retryCount:u,response:c,responseError:l});if(f.skipStrategy){p.info(`Retry ${u}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:h,redirectTo:g}=f;if(m)throw p.error(`Retry ${u}: Retry strategy ${d.name} throws error:`,m),m;if(h||h===0){p.info(`Retry ${u}: Retry strategy ${d.name} retries after ${h}`),await cV(h,void 0,{abortSignal:n.abortSignal});continue e}if(g){p.info(`Retry ${u}: Retry strategy ${d.name} redirects to ${g}`),n.url=g;continue e}}if(l)throw r.info("None of the retry strategies could work with the received error. Throwing it."),l;if(c)return r.info("None of the retry strategies could work with the received response. Returning it."),c}}}}var KMe,jSt,TR=D(()=>{lV();eae();tV();KMe=Jj("core-rest-pipeline retryPolicy"),jSt="retryPolicy"});function fV(t={}){var e;return{name:VSt,sendRequest:jf([uV(),CR(t)],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var VSt,yae=D(()=>{pV();dV();TR();VSt="defaultRetryPolicy"});var XMe=R((SZr,QMe)=>{var YMe=require("stream").Stream,HSt=require("util");QMe.exports=zd;function zd(){this.source=null,this.dataSize=0,this.maxDataSize=1024*1024,this.pauseStream=!0,this._maxDataSizeExceeded=!1,this._released=!1,this._bufferedEvents=[]}HSt.inherits(zd,YMe);zd.create=function(t,e){var r=new this;e=e||{};for(var n in e)r[n]=e[n];r.source=t;var o=t.emit;return t.emit=function(){return r._handleEmit(arguments),o.apply(t,arguments)},t.on("error",function(){}),r.pauseStream&&t.pause(),r};Object.defineProperty(zd.prototype,"readable",{configurable:!0,enumerable:!0,get:function(){return this.source.readable}});zd.prototype.setEncoding=function(){return this.source.setEncoding.apply(this.source,arguments)};zd.prototype.resume=function(){this._released||this.release(),this.source.resume()};zd.prototype.pause=function(){this.source.pause()};zd.prototype.release=function(){this._released=!0,this._bufferedEvents.forEach(function(t){this.emit.apply(this,t)}.bind(this)),this._bufferedEvents=[]};zd.prototype.pipe=function(){var t=YMe.prototype.pipe.apply(this,arguments);return this.resume(),t};zd.prototype._handleEmit=function(t){if(this._released){this.emit.apply(this,t);return}t[0]==="data"&&(this.dataSize+=t[1].length,this._checkIfMaxDataSizeExceeded()),this._bufferedEvents.push(t)};zd.prototype._checkIfMaxDataSizeExceeded=function(){if(!this._maxDataSizeExceeded&&!(this.dataSize<=this.maxDataSize)){this._maxDataSizeExceeded=!0;var t="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this.emit("error",new Error(t))}}});var tFe=R((IZr,eFe)=>{var GSt=require("util"),ZMe=require("stream").Stream,JMe=XMe();eFe.exports=$i;function $i(){this.writable=!1,this.readable=!0,this.dataSize=0,this.maxDataSize=2*1024*1024,this.pauseStreams=!0,this._released=!1,this._streams=[],this._currentStream=null,this._insideLoop=!1,this._pendingNext=!1}GSt.inherits($i,ZMe);$i.create=function(t){var e=new this;t=t||{};for(var r in t)e[r]=t[r];return e};$i.isStreamLike=function(t){return typeof t!="function"&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"&&!Buffer.isBuffer(t)};$i.prototype.append=function(t){var e=$i.isStreamLike(t);if(e){if(!(t instanceof JMe)){var r=JMe.create(t,{maxDataSize:1/0,pauseStream:this.pauseStreams});t.on("data",this._checkDataSize.bind(this)),t=r}this._handleErrors(t),this.pauseStreams&&t.pause()}return this._streams.push(t),this};$i.prototype.pipe=function(t,e){return ZMe.prototype.pipe.call(this,t,e),this.resume(),t};$i.prototype._getNext=function(){if(this._currentStream=null,this._insideLoop){this._pendingNext=!0;return}this._insideLoop=!0;try{do this._pendingNext=!1,this._realGetNext();while(this._pendingNext)}finally{this._insideLoop=!1}};$i.prototype._realGetNext=function(){var t=this._streams.shift();if(typeof t>"u"){this.end();return}if(typeof t!="function"){this._pipeNext(t);return}var e=t;e(function(r){var n=$i.isStreamLike(r);n&&(r.on("data",this._checkDataSize.bind(this)),this._handleErrors(r)),this._pipeNext(r)}.bind(this))};$i.prototype._pipeNext=function(t){this._currentStream=t;var e=$i.isStreamLike(t);if(e){t.on("end",this._getNext.bind(this)),t.pipe(this,{end:!1});return}var r=t;this.write(r),this._getNext()};$i.prototype._handleErrors=function(t){var e=this;t.on("error",function(r){e._emitError(r)})};$i.prototype.write=function(t){this.emit("data",t)};$i.prototype.pause=function(){this.pauseStreams&&(this.pauseStreams&&this._currentStream&&typeof this._currentStream.pause=="function"&&this._currentStream.pause(),this.emit("pause"))};$i.prototype.resume=function(){this._released||(this._released=!0,this.writable=!0,this._getNext()),this.pauseStreams&&this._currentStream&&typeof this._currentStream.resume=="function"&&this._currentStream.resume(),this.emit("resume")};$i.prototype.end=function(){this._reset(),this.emit("end")};$i.prototype.destroy=function(){this._reset(),this.emit("close")};$i.prototype._reset=function(){this.writable=!1,this._streams=[],this._currentStream=null};$i.prototype._checkDataSize=function(){if(this._updateDataSize(),!(this.dataSize<=this.maxDataSize)){var t="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this._emitError(new Error(t))}};$i.prototype._updateDataSize=function(){this.dataSize=0;var t=this;this._streams.forEach(function(e){e.dataSize&&(t.dataSize+=e.dataSize)}),this._currentStream&&this._currentStream.dataSize&&(this.dataSize+=this._currentStream.dataSize)};$i.prototype._emitError=function(t){this._reset(),this.emit("error",t)}});var rFe=R((CZr,zSt)=>{zSt.exports={"application/1d-interleaved-parityfec":{source:"iana"},"application/3gpdash-qoe-report+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/3gpp-ims+xml":{source:"iana",compressible:!0},"application/3gpphal+json":{source:"iana",compressible:!0},"application/3gpphalforms+json":{source:"iana",compressible:!0},"application/a2l":{source:"iana"},"application/ace+cbor":{source:"iana"},"application/activemessage":{source:"iana"},"application/activity+json":{source:"iana",compressible:!0},"application/alto-costmap+json":{source:"iana",compressible:!0},"application/alto-costmapfilter+json":{source:"iana",compressible:!0},"application/alto-directory+json":{source:"iana",compressible:!0},"application/alto-endpointcost+json":{source:"iana",compressible:!0},"application/alto-endpointcostparams+json":{source:"iana",compressible:!0},"application/alto-endpointprop+json":{source:"iana",compressible:!0},"application/alto-endpointpropparams+json":{source:"iana",compressible:!0},"application/alto-error+json":{source:"iana",compressible:!0},"application/alto-networkmap+json":{source:"iana",compressible:!0},"application/alto-networkmapfilter+json":{source:"iana",compressible:!0},"application/alto-updatestreamcontrol+json":{source:"iana",compressible:!0},"application/alto-updatestreamparams+json":{source:"iana",compressible:!0},"application/aml":{source:"iana"},"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applefile":{source:"iana"},"application/applixware":{source:"apache",extensions:["aw"]},"application/at+jwt":{source:"iana"},"application/atf":{source:"iana"},"application/atfx":{source:"iana"},"application/atom+xml":{source:"iana",compressible:!0,extensions:["atom"]},"application/atomcat+xml":{source:"iana",compressible:!0,extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",compressible:!0,extensions:["atomdeleted"]},"application/atomicmail":{source:"iana"},"application/atomsvc+xml":{source:"iana",compressible:!0,extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",compressible:!0,extensions:["dwd"]},"application/atsc-dynamic-event-message":{source:"iana"},"application/atsc-held+xml":{source:"iana",compressible:!0,extensions:["held"]},"application/atsc-rdt+json":{source:"iana",compressible:!0},"application/atsc-rsat+xml":{source:"iana",compressible:!0,extensions:["rsat"]},"application/atxml":{source:"iana"},"application/auth-policy+xml":{source:"iana",compressible:!0},"application/bacnet-xdd+zip":{source:"iana",compressible:!1},"application/batch-smtp":{source:"iana"},"application/bdoc":{compressible:!1,extensions:["bdoc"]},"application/beep+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/calendar+json":{source:"iana",compressible:!0},"application/calendar+xml":{source:"iana",compressible:!0,extensions:["xcs"]},"application/call-completion":{source:"iana"},"application/cals-1840":{source:"iana"},"application/captive+json":{source:"iana",compressible:!0},"application/cbor":{source:"iana"},"application/cbor-seq":{source:"iana"},"application/cccex":{source:"iana"},"application/ccmp+xml":{source:"iana",compressible:!0},"application/ccxml+xml":{source:"iana",compressible:!0,extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",compressible:!0,extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cdni":{source:"iana"},"application/cea":{source:"iana"},"application/cea-2018+xml":{source:"iana",compressible:!0},"application/cellml+xml":{source:"iana",compressible:!0},"application/cfw":{source:"iana"},"application/city+json":{source:"iana",compressible:!0},"application/clr":{source:"iana"},"application/clue+xml":{source:"iana",compressible:!0},"application/clue_info+xml":{source:"iana",compressible:!0},"application/cms":{source:"iana"},"application/cnrp+xml":{source:"iana",compressible:!0},"application/coap-group+json":{source:"iana",compressible:!0},"application/coap-payload":{source:"iana"},"application/commonground":{source:"iana"},"application/conference-info+xml":{source:"iana",compressible:!0},"application/cose":{source:"iana"},"application/cose-key":{source:"iana"},"application/cose-key-set":{source:"iana"},"application/cpl+xml":{source:"iana",compressible:!0,extensions:["cpl"]},"application/csrattrs":{source:"iana"},"application/csta+xml":{source:"iana",compressible:!0},"application/cstadata+xml":{source:"iana",compressible:!0},"application/csvm+json":{source:"iana",compressible:!0},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/cwt":{source:"iana"},"application/cybercash":{source:"iana"},"application/dart":{compressible:!0},"application/dash+xml":{source:"iana",compressible:!0,extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",compressible:!0,extensions:["mpp"]},"application/dashdelta":{source:"iana"},"application/davmount+xml":{source:"iana",compressible:!0,extensions:["davmount"]},"application/dca-rft":{source:"iana"},"application/dcd":{source:"iana"},"application/dec-dx":{source:"iana"},"application/dialog-info+xml":{source:"iana",compressible:!0},"application/dicom":{source:"iana"},"application/dicom+json":{source:"iana",compressible:!0},"application/dicom+xml":{source:"iana",compressible:!0},"application/dii":{source:"iana"},"application/dit":{source:"iana"},"application/dns":{source:"iana"},"application/dns+json":{source:"iana",compressible:!0},"application/dns-message":{source:"iana"},"application/docbook+xml":{source:"apache",compressible:!0,extensions:["dbk"]},"application/dots+cbor":{source:"iana"},"application/dskpp+xml":{source:"iana",compressible:!0},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",compressible:!0,extensions:["xdssc"]},"application/dvcs":{source:"iana"},"application/ecmascript":{source:"iana",compressible:!0,extensions:["es","ecma"]},"application/edi-consent":{source:"iana"},"application/edi-x12":{source:"iana",compressible:!1},"application/edifact":{source:"iana",compressible:!1},"application/efi":{source:"iana"},"application/elm+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/elm+xml":{source:"iana",compressible:!0},"application/emergencycalldata.cap+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/emergencycalldata.comment+xml":{source:"iana",compressible:!0},"application/emergencycalldata.control+xml":{source:"iana",compressible:!0},"application/emergencycalldata.deviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.ecall.msd":{source:"iana"},"application/emergencycalldata.providerinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.serviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.subscriberinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.veds+xml":{source:"iana",compressible:!0},"application/emma+xml":{source:"iana",compressible:!0,extensions:["emma"]},"application/emotionml+xml":{source:"iana",compressible:!0,extensions:["emotionml"]},"application/encaprtp":{source:"iana"},"application/epp+xml":{source:"iana",compressible:!0},"application/epub+zip":{source:"iana",compressible:!1,extensions:["epub"]},"application/eshop":{source:"iana"},"application/exi":{source:"iana",extensions:["exi"]},"application/expect-ct-report+json":{source:"iana",compressible:!0},"application/express":{source:"iana",extensions:["exp"]},"application/fastinfoset":{source:"iana"},"application/fastsoap":{source:"iana"},"application/fdt+xml":{source:"iana",compressible:!0,extensions:["fdt"]},"application/fhir+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/fhir+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/fido.trusted-apps+json":{compressible:!0},"application/fits":{source:"iana"},"application/flexfec":{source:"iana"},"application/font-sfnt":{source:"iana"},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/font-woff":{source:"iana",compressible:!1},"application/framework-attributes+xml":{source:"iana",compressible:!0},"application/geo+json":{source:"iana",compressible:!0,extensions:["geojson"]},"application/geo+json-seq":{source:"iana"},"application/geopackage+sqlite3":{source:"iana"},"application/geoxacml+xml":{source:"iana",compressible:!0},"application/gltf-buffer":{source:"iana"},"application/gml+xml":{source:"iana",compressible:!0,extensions:["gml"]},"application/gpx+xml":{source:"apache",compressible:!0,extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",compressible:!1,extensions:["gz"]},"application/h224":{source:"iana"},"application/held+xml":{source:"iana",compressible:!0},"application/hjson":{extensions:["hjson"]},"application/http":{source:"iana"},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/ibe-key-request+xml":{source:"iana",compressible:!0},"application/ibe-pkg-reply+xml":{source:"iana",compressible:!0},"application/ibe-pp-data":{source:"iana"},"application/iges":{source:"iana"},"application/im-iscomposing+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/index":{source:"iana"},"application/index.cmd":{source:"iana"},"application/index.obj":{source:"iana"},"application/index.response":{source:"iana"},"application/index.vnd":{source:"iana"},"application/inkml+xml":{source:"iana",compressible:!0,extensions:["ink","inkml"]},"application/iotp":{source:"iana"},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/ipp":{source:"iana"},"application/isup":{source:"iana"},"application/its+xml":{source:"iana",compressible:!0,extensions:["its"]},"application/java-archive":{source:"apache",compressible:!1,extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",compressible:!1,extensions:["ser"]},"application/java-vm":{source:"apache",compressible:!1,extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["js","mjs"]},"application/jf2feed+json":{source:"iana",compressible:!0},"application/jose":{source:"iana"},"application/jose+json":{source:"iana",compressible:!0},"application/jrd+json":{source:"iana",compressible:!0},"application/jscalendar+json":{source:"iana",compressible:!0},"application/json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["json","map"]},"application/json-patch+json":{source:"iana",compressible:!0},"application/json-seq":{source:"iana"},"application/json5":{extensions:["json5"]},"application/jsonml+json":{source:"apache",compressible:!0,extensions:["jsonml"]},"application/jwk+json":{source:"iana",compressible:!0},"application/jwk-set+json":{source:"iana",compressible:!0},"application/jwt":{source:"iana"},"application/kpml-request+xml":{source:"iana",compressible:!0},"application/kpml-response+xml":{source:"iana",compressible:!0},"application/ld+json":{source:"iana",compressible:!0,extensions:["jsonld"]},"application/lgr+xml":{source:"iana",compressible:!0,extensions:["lgr"]},"application/link-format":{source:"iana"},"application/load-control+xml":{source:"iana",compressible:!0},"application/lost+xml":{source:"iana",compressible:!0,extensions:["lostxml"]},"application/lostsync+xml":{source:"iana",compressible:!0},"application/lpf+zip":{source:"iana",compressible:!1},"application/lxf":{source:"iana"},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/macwriteii":{source:"iana"},"application/mads+xml":{source:"iana",compressible:!0,extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",compressible:!0,extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",compressible:!0,extensions:["mathml"]},"application/mathml-content+xml":{source:"iana",compressible:!0},"application/mathml-presentation+xml":{source:"iana",compressible:!0},"application/mbms-associated-procedure-description+xml":{source:"iana",compressible:!0},"application/mbms-deregister+xml":{source:"iana",compressible:!0},"application/mbms-envelope+xml":{source:"iana",compressible:!0},"application/mbms-msk+xml":{source:"iana",compressible:!0},"application/mbms-msk-response+xml":{source:"iana",compressible:!0},"application/mbms-protection-description+xml":{source:"iana",compressible:!0},"application/mbms-reception-report+xml":{source:"iana",compressible:!0},"application/mbms-register+xml":{source:"iana",compressible:!0},"application/mbms-register-response+xml":{source:"iana",compressible:!0},"application/mbms-schedule+xml":{source:"iana",compressible:!0},"application/mbms-user-service-description+xml":{source:"iana",compressible:!0},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",compressible:!0,extensions:["mpf"]},"application/media_control+xml":{source:"iana",compressible:!0},"application/mediaservercontrol+xml":{source:"iana",compressible:!0,extensions:["mscml"]},"application/merge-patch+json":{source:"iana",compressible:!0},"application/metalink+xml":{source:"apache",compressible:!0,extensions:["metalink"]},"application/metalink4+xml":{source:"iana",compressible:!0,extensions:["meta4"]},"application/mets+xml":{source:"iana",compressible:!0,extensions:["mets"]},"application/mf4":{source:"iana"},"application/mikey":{source:"iana"},"application/mipc":{source:"iana"},"application/missing-blocks+cbor-seq":{source:"iana"},"application/mmt-aei+xml":{source:"iana",compressible:!0,extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",compressible:!0,extensions:["musd"]},"application/mods+xml":{source:"iana",compressible:!0,extensions:["mods"]},"application/moss-keys":{source:"iana"},"application/moss-signature":{source:"iana"},"application/mosskey-data":{source:"iana"},"application/mosskey-request":{source:"iana"},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/mpeg4-generic":{source:"iana"},"application/mpeg4-iod":{source:"iana"},"application/mpeg4-iod-xmt":{source:"iana"},"application/mrb-consumer+xml":{source:"iana",compressible:!0},"application/mrb-publish+xml":{source:"iana",compressible:!0},"application/msc-ivr+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msc-mixer+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msword":{source:"iana",compressible:!1,extensions:["doc","dot"]},"application/mud+json":{source:"iana",compressible:!0},"application/multipart-core":{source:"iana"},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/nasdata":{source:"iana"},"application/news-checkgroups":{source:"iana",charset:"US-ASCII"},"application/news-groupinfo":{source:"iana",charset:"US-ASCII"},"application/news-transmission":{source:"iana"},"application/nlsml+xml":{source:"iana",compressible:!0},"application/node":{source:"iana",extensions:["cjs"]},"application/nss":{source:"iana"},"application/oauth-authz-req+jwt":{source:"iana"},"application/oblivious-dns-message":{source:"iana"},"application/ocsp-request":{source:"iana"},"application/ocsp-response":{source:"iana"},"application/octet-stream":{source:"iana",compressible:!1,extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/odm+xml":{source:"iana",compressible:!0},"application/odx":{source:"iana"},"application/oebps-package+xml":{source:"iana",compressible:!0,extensions:["opf"]},"application/ogg":{source:"iana",compressible:!1,extensions:["ogx"]},"application/omdoc+xml":{source:"apache",compressible:!0,extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{source:"iana",compressible:!0},"application/oscore":{source:"iana"},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p21":{source:"iana"},"application/p21+zip":{source:"iana",compressible:!1},"application/p2p-overlay+xml":{source:"iana",compressible:!0,extensions:["relo"]},"application/parityfec":{source:"iana"},"application/passport":{source:"iana"},"application/patch-ops-error+xml":{source:"iana",compressible:!0,extensions:["xer"]},"application/pdf":{source:"iana",compressible:!1,extensions:["pdf"]},"application/pdx":{source:"iana"},"application/pem-certificate-chain":{source:"iana"},"application/pgp-encrypted":{source:"iana",compressible:!1,extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pidf+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pidf-diff+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs12":{source:"iana"},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkcs8-encrypted":{source:"iana"},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",compressible:!0,extensions:["pls"]},"application/poc-settings+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/postscript":{source:"iana",compressible:!0,extensions:["ai","eps","ps"]},"application/ppsp-tracker+json":{source:"iana",compressible:!0},"application/problem+json":{source:"iana",compressible:!0},"application/problem+xml":{source:"iana",compressible:!0},"application/provenance+xml":{source:"iana",compressible:!0,extensions:["provx"]},"application/prs.alvestrand.titrax-sheet":{source:"iana"},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/prs.cyn":{source:"iana",charset:"7-BIT"},"application/prs.hpub+zip":{source:"iana",compressible:!1},"application/prs.nprend":{source:"iana"},"application/prs.plucker":{source:"iana"},"application/prs.rdf-xml-crypt":{source:"iana"},"application/prs.xsf+xml":{source:"iana",compressible:!0},"application/pskc+xml":{source:"iana",compressible:!0,extensions:["pskcxml"]},"application/pvd+json":{source:"iana",compressible:!0},"application/qsig":{source:"iana"},"application/raml+yaml":{compressible:!0,extensions:["raml"]},"application/raptorfec":{source:"iana"},"application/rdap+json":{source:"iana",compressible:!0},"application/rdf+xml":{source:"iana",compressible:!0,extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",compressible:!0,extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/remote-printing":{source:"iana"},"application/reputon+json":{source:"iana",compressible:!0},"application/resource-lists+xml":{source:"iana",compressible:!0,extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",compressible:!0,extensions:["rld"]},"application/rfc+xml":{source:"iana",compressible:!0},"application/riscos":{source:"iana"},"application/rlmi+xml":{source:"iana",compressible:!0},"application/rls-services+xml":{source:"iana",compressible:!0,extensions:["rs"]},"application/route-apd+xml":{source:"iana",compressible:!0,extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",compressible:!0,extensions:["sls"]},"application/route-usd+xml":{source:"iana",compressible:!0,extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-publication":{source:"iana"},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rpki-updown":{source:"iana"},"application/rsd+xml":{source:"apache",compressible:!0,extensions:["rsd"]},"application/rss+xml":{source:"apache",compressible:!0,extensions:["rss"]},"application/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"application/rtploopback":{source:"iana"},"application/rtx":{source:"iana"},"application/samlassertion+xml":{source:"iana",compressible:!0},"application/samlmetadata+xml":{source:"iana",compressible:!0},"application/sarif+json":{source:"iana",compressible:!0},"application/sarif-external-properties+json":{source:"iana",compressible:!0},"application/sbe":{source:"iana"},"application/sbml+xml":{source:"iana",compressible:!0,extensions:["sbml"]},"application/scaip+xml":{source:"iana",compressible:!0},"application/scim+json":{source:"iana",compressible:!0},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/secevent+jwt":{source:"iana"},"application/senml+cbor":{source:"iana"},"application/senml+json":{source:"iana",compressible:!0},"application/senml+xml":{source:"iana",compressible:!0,extensions:["senmlx"]},"application/senml-etch+cbor":{source:"iana"},"application/senml-etch+json":{source:"iana",compressible:!0},"application/senml-exi":{source:"iana"},"application/sensml+cbor":{source:"iana"},"application/sensml+json":{source:"iana",compressible:!0},"application/sensml+xml":{source:"iana",compressible:!0,extensions:["sensmlx"]},"application/sensml-exi":{source:"iana"},"application/sep+xml":{source:"iana",compressible:!0},"application/sep-exi":{source:"iana"},"application/session-info":{source:"iana"},"application/set-payment":{source:"iana"},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration":{source:"iana"},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/sgml":{source:"iana"},"application/sgml-open-catalog":{source:"iana"},"application/shf+xml":{source:"iana",compressible:!0,extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/simple-filter+xml":{source:"iana",compressible:!0},"application/simple-message-summary":{source:"iana"},"application/simplesymbolcontainer":{source:"iana"},"application/sipc":{source:"iana"},"application/slate":{source:"iana"},"application/smil":{source:"iana"},"application/smil+xml":{source:"iana",compressible:!0,extensions:["smi","smil"]},"application/smpte336m":{source:"iana"},"application/soap+fastinfoset":{source:"iana"},"application/soap+xml":{source:"iana",compressible:!0},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",compressible:!0,extensions:["srx"]},"application/spdx+json":{source:"iana",compressible:!0},"application/spirits-event+xml":{source:"iana",compressible:!0},"application/sql":{source:"iana"},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",compressible:!0,extensions:["grxml"]},"application/sru+xml":{source:"iana",compressible:!0,extensions:["sru"]},"application/ssdl+xml":{source:"apache",compressible:!0,extensions:["ssdl"]},"application/ssml+xml":{source:"iana",compressible:!0,extensions:["ssml"]},"application/stix+json":{source:"iana",compressible:!0},"application/swid+xml":{source:"iana",compressible:!0,extensions:["swidtag"]},"application/tamp-apex-update":{source:"iana"},"application/tamp-apex-update-confirm":{source:"iana"},"application/tamp-community-update":{source:"iana"},"application/tamp-community-update-confirm":{source:"iana"},"application/tamp-error":{source:"iana"},"application/tamp-sequence-adjust":{source:"iana"},"application/tamp-sequence-adjust-confirm":{source:"iana"},"application/tamp-status-query":{source:"iana"},"application/tamp-status-response":{source:"iana"},"application/tamp-update":{source:"iana"},"application/tamp-update-confirm":{source:"iana"},"application/tar":{compressible:!0},"application/taxii+json":{source:"iana",compressible:!0},"application/td+json":{source:"iana",compressible:!0},"application/tei+xml":{source:"iana",compressible:!0,extensions:["tei","teicorpus"]},"application/tetra_isi":{source:"iana"},"application/thraud+xml":{source:"iana",compressible:!0,extensions:["tfi"]},"application/timestamp-query":{source:"iana"},"application/timestamp-reply":{source:"iana"},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/tlsrpt+gzip":{source:"iana"},"application/tlsrpt+json":{source:"iana",compressible:!0},"application/tnauthlist":{source:"iana"},"application/token-introspection+jwt":{source:"iana"},"application/toml":{compressible:!0,extensions:["toml"]},"application/trickle-ice-sdpfrag":{source:"iana"},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",compressible:!0,extensions:["ttml"]},"application/tve-trigger":{source:"iana"},"application/tzif":{source:"iana"},"application/tzif-leap":{source:"iana"},"application/ubjson":{compressible:!1,extensions:["ubj"]},"application/ulpfec":{source:"iana"},"application/urc-grpsheet+xml":{source:"iana",compressible:!0},"application/urc-ressheet+xml":{source:"iana",compressible:!0,extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",compressible:!0,extensions:["td"]},"application/urc-uisocketdesc+xml":{source:"iana",compressible:!0},"application/vcard+json":{source:"iana",compressible:!0},"application/vcard+xml":{source:"iana",compressible:!0},"application/vemmi":{source:"iana"},"application/vividence.scriptfile":{source:"apache"},"application/vnd.1000minds.decision-model+xml":{source:"iana",compressible:!0,extensions:["1km"]},"application/vnd.3gpp-prose+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-prose-pc3ch+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-v2x-local-service-information":{source:"iana"},"application/vnd.3gpp.5gnas":{source:"iana"},"application/vnd.3gpp.access-transfer-events+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.bsf+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gmop+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gtpc":{source:"iana"},"application/vnd.3gpp.interworking-data":{source:"iana"},"application/vnd.3gpp.lpp":{source:"iana"},"application/vnd.3gpp.mc-signalling-ear":{source:"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-payload":{source:"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-signalling":{source:"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-floor-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-signed+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-init-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-transmission-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mid-call+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ngap":{source:"iana"},"application/vnd.3gpp.pfcp":{source:"iana"},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp.s1ap":{source:"iana"},"application/vnd.3gpp.sms":{source:"iana"},"application/vnd.3gpp.sms+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-ext+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.state-and-event-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ussd+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.bcmcsinfo+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.sms":{source:"iana"},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3lightssoftware.imagescal":{source:"iana"},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",compressible:!1,extensions:["air"]},"application/vnd.adobe.flash.movie":{source:"iana"},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{source:"iana"},"application/vnd.adobe.xdp+xml":{source:"iana",compressible:!0,extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.aether.imp":{source:"iana"},"application/vnd.afpc.afplinedata":{source:"iana"},"application/vnd.afpc.afplinedata-pagedef":{source:"iana"},"application/vnd.afpc.cmoca-cmresource":{source:"iana"},"application/vnd.afpc.foca-charset":{source:"iana"},"application/vnd.afpc.foca-codedfont":{source:"iana"},"application/vnd.afpc.foca-codepage":{source:"iana"},"application/vnd.afpc.modca":{source:"iana"},"application/vnd.afpc.modca-cmtable":{source:"iana"},"application/vnd.afpc.modca-formdef":{source:"iana"},"application/vnd.afpc.modca-mediummap":{source:"iana"},"application/vnd.afpc.modca-objectcontainer":{source:"iana"},"application/vnd.afpc.modca-overlay":{source:"iana"},"application/vnd.afpc.modca-pagesegment":{source:"iana"},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ah-barcode":{source:"iana"},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amadeus+json":{source:"iana",compressible:!0},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.amazon.mobi8-ebook":{source:"iana"},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.amundsen.maze+xml":{source:"iana",compressible:!0},"application/vnd.android.ota":{source:"iana"},"application/vnd.android.package-archive":{source:"apache",compressible:!1,extensions:["apk"]},"application/vnd.anki":{source:"iana"},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apache.arrow.file":{source:"iana"},"application/vnd.apache.arrow.stream":{source:"iana"},"application/vnd.apache.thrift.binary":{source:"iana"},"application/vnd.apache.thrift.compact":{source:"iana"},"application/vnd.apache.thrift.json":{source:"iana"},"application/vnd.api+json":{source:"iana",compressible:!0},"application/vnd.aplextor.warrp+json":{source:"iana",compressible:!0},"application/vnd.apothekende.reservation+json":{source:"iana",compressible:!0},"application/vnd.apple.installer+xml":{source:"iana",compressible:!0,extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.apple.pkpass":{compressible:!1,extensions:["pkpass"]},"application/vnd.arastra.swi":{source:"iana"},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.artisan+json":{source:"iana",compressible:!0},"application/vnd.artsquare":{source:"iana"},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.autopackage":{source:"iana"},"application/vnd.avalon+json":{source:"iana",compressible:!0},"application/vnd.avistar+xml":{source:"iana",compressible:!0},"application/vnd.balsamiq.bmml+xml":{source:"iana",compressible:!0,extensions:["bmml"]},"application/vnd.balsamiq.bmpr":{source:"iana"},"application/vnd.banana-accounting":{source:"iana"},"application/vnd.bbf.usp.error":{source:"iana"},"application/vnd.bbf.usp.msg":{source:"iana"},"application/vnd.bbf.usp.msg+json":{source:"iana",compressible:!0},"application/vnd.bekitzur-stech+json":{source:"iana",compressible:!0},"application/vnd.bint.med-content":{source:"iana"},"application/vnd.biopax.rdf+xml":{source:"iana",compressible:!0},"application/vnd.blink-idb-value-wrapper":{source:"iana"},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bluetooth.ep.oob":{source:"iana"},"application/vnd.bluetooth.le.oob":{source:"iana"},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.bpf":{source:"iana"},"application/vnd.bpf3":{source:"iana"},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.byu.uapi+json":{source:"iana",compressible:!0},"application/vnd.cab-jscript":{source:"iana"},"application/vnd.canon-cpdl":{source:"iana"},"application/vnd.canon-lips":{source:"iana"},"application/vnd.capasystems-pg+json":{source:"iana",compressible:!0},"application/vnd.cendio.thinlinc.clientconf":{source:"iana"},"application/vnd.century-systems.tcp_stream":{source:"iana"},"application/vnd.chemdraw+xml":{source:"iana",compressible:!0,extensions:["cdxml"]},"application/vnd.chess-pgn":{source:"iana"},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.ciedi":{source:"iana"},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.cirpack.isdn-ext":{source:"iana"},"application/vnd.citationstyles.style+xml":{source:"iana",compressible:!0,extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.coffeescript":{source:"iana"},"application/vnd.collabio.xodocuments.document":{source:"iana"},"application/vnd.collabio.xodocuments.document-template":{source:"iana"},"application/vnd.collabio.xodocuments.presentation":{source:"iana"},"application/vnd.collabio.xodocuments.presentation-template":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{source:"iana"},"application/vnd.collection+json":{source:"iana",compressible:!0},"application/vnd.collection.doc+json":{source:"iana",compressible:!0},"application/vnd.collection.next+json":{source:"iana",compressible:!0},"application/vnd.comicbook+zip":{source:"iana",compressible:!1},"application/vnd.comicbook-rar":{source:"iana"},"application/vnd.commerce-battelle":{source:"iana"},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.coreos.ignition+json":{source:"iana",compressible:!0},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",compressible:!0,extensions:["wbs"]},"application/vnd.cryptii.pipe+json":{source:"iana",compressible:!0},"application/vnd.crypto-shade-file":{source:"iana"},"application/vnd.cryptomator.encrypted":{source:"iana"},"application/vnd.cryptomator.vault":{source:"iana"},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.ctct.ws+xml":{source:"iana",compressible:!0},"application/vnd.cups-pdf":{source:"iana"},"application/vnd.cups-postscript":{source:"iana"},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.cups-raster":{source:"iana"},"application/vnd.cups-raw":{source:"iana"},"application/vnd.curl":{source:"iana"},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.cyan.dean.root+xml":{source:"iana",compressible:!0},"application/vnd.cybank":{source:"iana"},"application/vnd.cyclonedx+json":{source:"iana",compressible:!0},"application/vnd.cyclonedx+xml":{source:"iana",compressible:!0},"application/vnd.d2l.coursepackage1p0+zip":{source:"iana",compressible:!1},"application/vnd.d3m-dataset":{source:"iana"},"application/vnd.d3m-problem":{source:"iana"},"application/vnd.dart":{source:"iana",compressible:!0,extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.datapackage+json":{source:"iana",compressible:!0},"application/vnd.dataresource+json":{source:"iana",compressible:!0},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.debian.binary-package":{source:"iana"},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",compressible:!0,extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.desmume.movie":{source:"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{source:"iana"},"application/vnd.dm.delegation+xml":{source:"iana",compressible:!0},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.document+json":{source:"iana",compressible:!0},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dolby.mobile.1":{source:"iana"},"application/vnd.dolby.mobile.2":{source:"iana"},"application/vnd.doremir.scorecloud-binary-document":{source:"iana"},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.drive+json":{source:"iana",compressible:!0},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dtg.local":{source:"iana"},"application/vnd.dtg.local.flash":{source:"iana"},"application/vnd.dtg.local.html":{source:"iana"},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.dvbisl+xml":{source:"iana",compressible:!0},"application/vnd.dvb.dvbj":{source:"iana"},"application/vnd.dvb.esgcontainer":{source:"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess2":{source:"iana"},"application/vnd.dvb.ipdcesgpdd":{source:"iana"},"application/vnd.dvb.ipdcroaming":{source:"iana"},"application/vnd.dvb.iptv.alfec-base":{source:"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{source:"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-container+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-generic+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-msglist+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-request+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-response+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-init+xml":{source:"iana",compressible:!0},"application/vnd.dvb.pfr":{source:"iana"},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dxr":{source:"iana"},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.dzr":{source:"iana"},"application/vnd.easykaraoke.cdgdownload":{source:"iana"},"application/vnd.ecdis-update":{source:"iana"},"application/vnd.ecip.rlp":{source:"iana"},"application/vnd.eclipse.ditto+json":{source:"iana",compressible:!0},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.ecowin.filerequest":{source:"iana"},"application/vnd.ecowin.fileupdate":{source:"iana"},"application/vnd.ecowin.series":{source:"iana"},"application/vnd.ecowin.seriesrequest":{source:"iana"},"application/vnd.ecowin.seriesupdate":{source:"iana"},"application/vnd.efi.img":{source:"iana"},"application/vnd.efi.iso":{source:"iana"},"application/vnd.emclient.accessrequest+xml":{source:"iana",compressible:!0},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.enphase.envoy":{source:"iana"},"application/vnd.eprints.data+xml":{source:"iana",compressible:!0},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.ericsson.quickcall":{source:"iana"},"application/vnd.espass-espass+zip":{source:"iana",compressible:!1},"application/vnd.eszigno3+xml":{source:"iana",compressible:!0,extensions:["es3","et3"]},"application/vnd.etsi.aoc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.asic-e+zip":{source:"iana",compressible:!1},"application/vnd.etsi.asic-s+zip":{source:"iana",compressible:!1},"application/vnd.etsi.cug+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvcommand+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-bc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-cod+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-npvr+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvservice+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsync+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvueprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mcid+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mheg5":{source:"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{source:"iana",compressible:!0},"application/vnd.etsi.pstn+xml":{source:"iana",compressible:!0},"application/vnd.etsi.sci+xml":{source:"iana",compressible:!0},"application/vnd.etsi.simservs+xml":{source:"iana",compressible:!0},"application/vnd.etsi.timestamp-token":{source:"iana"},"application/vnd.etsi.tsl+xml":{source:"iana",compressible:!0},"application/vnd.etsi.tsl.der":{source:"iana"},"application/vnd.eu.kasparian.car+json":{source:"iana",compressible:!0},"application/vnd.eudora.data":{source:"iana"},"application/vnd.evolv.ecig.profile":{source:"iana"},"application/vnd.evolv.ecig.settings":{source:"iana"},"application/vnd.evolv.ecig.theme":{source:"iana"},"application/vnd.exstream-empower+zip":{source:"iana",compressible:!1},"application/vnd.exstream-package":{source:"iana"},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.f-secure.mobile":{source:"iana"},"application/vnd.familysearch.gedcom+zip":{source:"iana",compressible:!1},"application/vnd.fastcopy-disk-image":{source:"iana"},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.ffsns":{source:"iana"},"application/vnd.ficlab.flb+zip":{source:"iana",compressible:!1},"application/vnd.filmit.zfc":{source:"iana"},"application/vnd.fints":{source:"iana"},"application/vnd.firemonkeys.cloudcell":{source:"iana"},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.font-fontforge-sfd":{source:"iana"},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujifilm.fb.docuworks":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.binder":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.container":{source:"iana"},"application/vnd.fujifilm.fb.jfi+xml":{source:"iana",compressible:!0},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.art-ex":{source:"iana"},"application/vnd.fujixerox.art4":{source:"iana"},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fujixerox.docuworks.container":{source:"iana"},"application/vnd.fujixerox.hbpl":{source:"iana"},"application/vnd.fut-misnet":{source:"iana"},"application/vnd.futoin+cbor":{source:"iana"},"application/vnd.futoin+json":{source:"iana",compressible:!0},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.gentics.grd+json":{source:"iana",compressible:!0},"application/vnd.geo+json":{source:"iana",compressible:!0},"application/vnd.geocube+xml":{source:"iana",compressible:!0},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.slides":{source:"iana"},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gerber":{source:"iana"},"application/vnd.globalplatform.card-content-mgt":{source:"iana"},"application/vnd.globalplatform.card-content-mgt-response":{source:"iana"},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-apps.document":{compressible:!1,extensions:["gdoc"]},"application/vnd.google-apps.presentation":{compressible:!1,extensions:["gslides"]},"application/vnd.google-apps.spreadsheet":{compressible:!1,extensions:["gsheet"]},"application/vnd.google-earth.kml+xml":{source:"iana",compressible:!0,extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",compressible:!1,extensions:["kmz"]},"application/vnd.gov.sk.e-form+xml":{source:"iana",compressible:!0},"application/vnd.gov.sk.e-form+zip":{source:"iana",compressible:!1},"application/vnd.gov.sk.xmldatacontainer+xml":{source:"iana",compressible:!0},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.gridmp":{source:"iana"},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+json":{source:"iana",compressible:!0},"application/vnd.hal+xml":{source:"iana",compressible:!0,extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",compressible:!0,extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hc+json":{source:"iana",compressible:!0},"application/vnd.hcl-bireports":{source:"iana"},"application/vnd.hdt":{source:"iana"},"application/vnd.heroku+json":{source:"iana",compressible:!0},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hl7cda+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hl7v2+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.httphone":{source:"iana"},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.hyper+json":{source:"iana",compressible:!0},"application/vnd.hyper-item+json":{source:"iana",compressible:!0},"application/vnd.hyperdrive+json":{source:"iana",compressible:!0},"application/vnd.hzn-3d-crossword":{source:"iana"},"application/vnd.ibm.afplinedata":{source:"iana"},"application/vnd.ibm.electronic-media":{source:"iana"},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.ieee.1905":{source:"iana"},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.imagemeter.folder+zip":{source:"iana",compressible:!1},"application/vnd.imagemeter.image+zip":{source:"iana",compressible:!1},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.ims.imsccv1p1":{source:"iana"},"application/vnd.ims.imsccv1p2":{source:"iana"},"application/vnd.ims.imsccv1p3":{source:"iana"},"application/vnd.ims.lis.v2.result+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy.id+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings.simple+json":{source:"iana",compressible:!0},"application/vnd.informedcontrol.rms+xml":{source:"iana",compressible:!0},"application/vnd.informix-visionary":{source:"iana"},"application/vnd.infotech.project":{source:"iana"},"application/vnd.infotech.project+xml":{source:"iana",compressible:!0},"application/vnd.innopath.wamp.notification":{source:"iana"},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intertrust.digibox":{source:"iana"},"application/vnd.intertrust.nncp":{source:"iana"},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.conceptitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.knowledgeitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsmessage+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.packageitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.planningitem+xml":{source:"iana",compressible:!0},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",compressible:!0,extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.iso11783-10+zip":{source:"iana",compressible:!1},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.japannet-directory-service":{source:"iana"},"application/vnd.japannet-jpnstore-wakeup":{source:"iana"},"application/vnd.japannet-payment-wakeup":{source:"iana"},"application/vnd.japannet-registration":{source:"iana"},"application/vnd.japannet-registration-wakeup":{source:"iana"},"application/vnd.japannet-setstore-wakeup":{source:"iana"},"application/vnd.japannet-verification":{source:"iana"},"application/vnd.japannet-verification-wakeup":{source:"iana"},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.jsk.isdn-ngn":{source:"iana"},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las":{source:"iana"},"application/vnd.las.las+json":{source:"iana",compressible:!0},"application/vnd.las.las+xml":{source:"iana",compressible:!0,extensions:["lasxml"]},"application/vnd.laszip":{source:"iana"},"application/vnd.leap+json":{source:"iana",compressible:!0},"application/vnd.liberty-request+xml":{source:"iana",compressible:!0},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",compressible:!0,extensions:["lbe"]},"application/vnd.logipipe.circuit+zip":{source:"iana",compressible:!1},"application/vnd.loom":{source:"iana"},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.marlin.drm.actiontoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.conftoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.license+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.mdcf":{source:"iana"},"application/vnd.mason+json":{source:"iana",compressible:!0},"application/vnd.maxar.archive.3tz+zip":{source:"iana",compressible:!1},"application/vnd.maxmind.maxmind-db":{source:"iana"},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.meridian-slingshot":{source:"iana"},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micro+json":{source:"iana",compressible:!0},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.microsoft.portable-executable":{source:"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{source:"iana"},"application/vnd.miele+json":{source:"iana",compressible:!0},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.minisoft-hp3000-save":{source:"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{source:"iana"},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.motorola.flexsuite":{source:"iana"},"application/vnd.motorola.flexsuite.adsi":{source:"iana"},"application/vnd.motorola.flexsuite.fis":{source:"iana"},"application/vnd.motorola.flexsuite.gotap":{source:"iana"},"application/vnd.motorola.flexsuite.kmr":{source:"iana"},"application/vnd.motorola.flexsuite.ttc":{source:"iana"},"application/vnd.motorola.flexsuite.wem":{source:"iana"},"application/vnd.motorola.iprm":{source:"iana"},"application/vnd.mozilla.xul+xml":{source:"iana",compressible:!0,extensions:["xul"]},"application/vnd.ms-3mfdocument":{source:"iana"},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-asf":{source:"iana"},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-color.iccprofile":{source:"apache"},"application/vnd.ms-excel":{source:"iana",compressible:!1,extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",compressible:!0,extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-office.activex+xml":{source:"iana",compressible:!0},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-opentype":{source:"apache",compressible:!0},"application/vnd.ms-outlook":{compressible:!1,extensions:["msg"]},"application/vnd.ms-package.obfuscated-opentype":{source:"apache"},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-playready.initiator+xml":{source:"iana",compressible:!0},"application/vnd.ms-powerpoint":{source:"iana",compressible:!1,extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{source:"iana",compressible:!0},"application/vnd.ms-printing.printticket+xml":{source:"apache",compressible:!0},"application/vnd.ms-printschematicket+xml":{source:"iana",compressible:!0},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-tnef":{source:"iana"},"application/vnd.ms-windows.devicepairing":{source:"iana"},"application/vnd.ms-windows.nwprinting.oob":{source:"iana"},"application/vnd.ms-windows.printerpairing":{source:"iana"},"application/vnd.ms-windows.wsd.oob":{source:"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.lic-resp":{source:"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.meter-resp":{source:"iana"},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",compressible:!1,extensions:["xps"]},"application/vnd.msa-disk-image":{source:"iana"},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.msign":{source:"iana"},"application/vnd.multiad.creator":{source:"iana"},"application/vnd.multiad.creator.cif":{source:"iana"},"application/vnd.music-niff":{source:"iana"},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.nacamar.ybrid+json":{source:"iana",compressible:!0},"application/vnd.ncd.control":{source:"iana"},"application/vnd.ncd.reference":{source:"iana"},"application/vnd.nearst.inv+json":{source:"iana",compressible:!0},"application/vnd.nebumind.line":{source:"iana"},"application/vnd.nervana":{source:"iana"},"application/vnd.netfpx":{source:"iana"},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nimn":{source:"iana"},"application/vnd.nintendo.nitro.rom":{source:"iana"},"application/vnd.nintendo.snes.rom":{source:"iana"},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.catalogs":{source:"iana"},"application/vnd.nokia.conml+wbxml":{source:"iana"},"application/vnd.nokia.conml+xml":{source:"iana",compressible:!0},"application/vnd.nokia.iptv.config+xml":{source:"iana",compressible:!0},"application/vnd.nokia.isds-radio-presets":{source:"iana"},"application/vnd.nokia.landmark+wbxml":{source:"iana"},"application/vnd.nokia.landmark+xml":{source:"iana",compressible:!0},"application/vnd.nokia.landmarkcollection+xml":{source:"iana",compressible:!0},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",compressible:!0,extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.ncd":{source:"iana"},"application/vnd.nokia.pcd+wbxml":{source:"iana"},"application/vnd.nokia.pcd+xml":{source:"iana",compressible:!0},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.ntt-local.content-share":{source:"iana"},"application/vnd.ntt-local.file-transfer":{source:"iana"},"application/vnd.ntt-local.ogw_remote-access":{source:"iana"},"application/vnd.ntt-local.sip-ta_remote":{source:"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{source:"iana"},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",compressible:!1,extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",compressible:!1,extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",compressible:!1,extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",compressible:!1,extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.obn":{source:"iana"},"application/vnd.ocf+cbor":{source:"iana"},"application/vnd.oci.image.manifest.v1+json":{source:"iana",compressible:!0},"application/vnd.oftn.l10n+json":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessdownload+xml":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessstreaming+xml":{source:"iana",compressible:!0},"application/vnd.oipf.cspg-hexbinary":{source:"iana"},"application/vnd.oipf.dae.svg+xml":{source:"iana",compressible:!0},"application/vnd.oipf.dae.xhtml+xml":{source:"iana",compressible:!0},"application/vnd.oipf.mippvcontrolmessage+xml":{source:"iana",compressible:!0},"application/vnd.oipf.pae.gem":{source:"iana"},"application/vnd.oipf.spdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.oipf.spdlist+xml":{source:"iana",compressible:!0},"application/vnd.oipf.ueprofile+xml":{source:"iana",compressible:!0},"application/vnd.oipf.userprofile+xml":{source:"iana",compressible:!0},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma-scws-config":{source:"iana"},"application/vnd.oma-scws-http-request":{source:"iana"},"application/vnd.oma-scws-http-response":{source:"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.drm-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.imd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.ltkm":{source:"iana"},"application/vnd.oma.bcast.notification+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.provisioningtrigger":{source:"iana"},"application/vnd.oma.bcast.sgboot":{source:"iana"},"application/vnd.oma.bcast.sgdd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sgdu":{source:"iana"},"application/vnd.oma.bcast.simple-symbol-container":{source:"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sprov+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.stkm":{source:"iana"},"application/vnd.oma.cab-address-book+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-feature-handler+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-pcc+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-subs-invite+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-user-prefs+xml":{source:"iana",compressible:!0},"application/vnd.oma.dcd":{source:"iana"},"application/vnd.oma.dcdc":{source:"iana"},"application/vnd.oma.dd2+xml":{source:"iana",compressible:!0,extensions:["dd2"]},"application/vnd.oma.drm.risd+xml":{source:"iana",compressible:!0},"application/vnd.oma.group-usage-list+xml":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+cbor":{source:"iana"},"application/vnd.oma.lwm2m+json":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+tlv":{source:"iana"},"application/vnd.oma.pal+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.detailed-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.final-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.groups+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.invocation-descriptor+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.optimized-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.push":{source:"iana"},"application/vnd.oma.scidm.messages+xml":{source:"iana",compressible:!0},"application/vnd.oma.xcap-directory+xml":{source:"iana",compressible:!0},"application/vnd.omads-email+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-file+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-folder+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omaloc-supl-init":{source:"iana"},"application/vnd.onepager":{source:"iana"},"application/vnd.onepagertamp":{source:"iana"},"application/vnd.onepagertamx":{source:"iana"},"application/vnd.onepagertat":{source:"iana"},"application/vnd.onepagertatp":{source:"iana"},"application/vnd.onepagertatx":{source:"iana"},"application/vnd.openblox.game+xml":{source:"iana",compressible:!0,extensions:["obgx"]},"application/vnd.openblox.game-binary":{source:"iana"},"application/vnd.openeye.oeb":{source:"iana"},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",compressible:!0,extensions:["osm"]},"application/vnd.opentimestamps.ots":{source:"iana"},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawing+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",compressible:!1,extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",compressible:!1,extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.theme+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.vmldrawing":{source:"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",compressible:!1,extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.core-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.relationships+xml":{source:"iana",compressible:!0},"application/vnd.oracle.resource+json":{source:"iana",compressible:!0},"application/vnd.orange.indata":{source:"iana"},"application/vnd.osa.netdeploy":{source:"iana"},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.bundle":{source:"iana"},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.otps.ct-kip+xml":{source:"iana",compressible:!0},"application/vnd.oxli.countgraph":{source:"iana"},"application/vnd.pagerduty+json":{source:"iana",compressible:!0},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.panoply":{source:"iana"},"application/vnd.paos.xml":{source:"iana"},"application/vnd.patentdive":{source:"iana"},"application/vnd.patientecommsdoc":{source:"iana"},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pcos":{source:"iana"},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.piaccess.application-licence":{source:"iana"},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.poc.group-advertisement+xml":{source:"iana",compressible:!0},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.powerbuilder6-s":{source:"iana"},"application/vnd.powerbuilder7":{source:"iana"},"application/vnd.powerbuilder7-s":{source:"iana"},"application/vnd.powerbuilder75":{source:"iana"},"application/vnd.powerbuilder75-s":{source:"iana"},"application/vnd.preminet":{source:"iana"},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.psfs":{source:"iana"},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.pwg-multiplexed":{source:"iana"},"application/vnd.pwg-xhtml-print+xml":{source:"iana",compressible:!0},"application/vnd.qualcomm.brew-app-res":{source:"iana"},"application/vnd.quarantainenet":{source:"iana"},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{source:"iana"},"application/vnd.radisys.moml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conn+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-stream+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-base+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-detect+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-group+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-speech+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-transform+xml":{source:"iana",compressible:!0},"application/vnd.rainstor.data":{source:"iana"},"application/vnd.rapid":{source:"iana"},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",compressible:!0,extensions:["musicxml"]},"application/vnd.renlearn.rlprint":{source:"iana"},"application/vnd.resilient.logic":{source:"iana"},"application/vnd.restful+json":{source:"iana",compressible:!0},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",compressible:!0,extensions:["link66"]},"application/vnd.rs-274x":{source:"iana"},"application/vnd.ruckus.download":{source:"iana"},"application/vnd.s3sms":{source:"iana"},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.sar":{source:"iana"},"application/vnd.sbm.cid":{source:"iana"},"application/vnd.sbm.mid2":{source:"iana"},"application/vnd.scribus":{source:"iana"},"application/vnd.sealed.3df":{source:"iana"},"application/vnd.sealed.csf":{source:"iana"},"application/vnd.sealed.doc":{source:"iana"},"application/vnd.sealed.eml":{source:"iana"},"application/vnd.sealed.mht":{source:"iana"},"application/vnd.sealed.net":{source:"iana"},"application/vnd.sealed.ppt":{source:"iana"},"application/vnd.sealed.tiff":{source:"iana"},"application/vnd.sealed.xls":{source:"iana"},"application/vnd.sealedmedia.softseal.html":{source:"iana"},"application/vnd.sealedmedia.softseal.pdf":{source:"iana"},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.seis+json":{source:"iana",compressible:!0},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shade-save-file":{source:"iana"},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.shootproof+json":{source:"iana",compressible:!0},"application/vnd.shopkick+json":{source:"iana",compressible:!0},"application/vnd.shp":{source:"iana"},"application/vnd.shx":{source:"iana"},"application/vnd.sigrok.session":{source:"iana"},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.siren+json":{source:"iana",compressible:!0},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.notebook":{source:"iana"},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.snesdev-page-table":{source:"iana"},"application/vnd.software602.filler.form+xml":{source:"iana",compressible:!0,extensions:["fo"]},"application/vnd.software602.filler.form-xml-zip":{source:"iana"},"application/vnd.solent.sdkm+xml":{source:"iana",compressible:!0,extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.sqlite3":{source:"iana"},"application/vnd.sss-cod":{source:"iana"},"application/vnd.sss-dtf":{source:"iana"},"application/vnd.sss-ntf":{source:"iana"},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.street-stream":{source:"iana"},"application/vnd.sun.wadl+xml":{source:"iana",compressible:!0,extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.swiftview-ics":{source:"iana"},"application/vnd.sycle+xml":{source:"iana",compressible:!0},"application/vnd.syft+json":{source:"iana",compressible:!0},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xdm"]},"application/vnd.syncml.dm.notification":{source:"iana"},"application/vnd.syncml.dmddf+wbxml":{source:"iana"},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{source:"iana"},"application/vnd.syncml.dmtnds+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.syncml.ds.notification":{source:"iana"},"application/vnd.tableschema+json":{source:"iana",compressible:!0},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{source:"iana",compressible:!0},"application/vnd.tmd.mediaflex.api+xml":{source:"iana",compressible:!0},"application/vnd.tml":{source:"iana"},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.tri.onesource":{source:"iana"},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.truedoc":{source:"iana"},"application/vnd.ubisoft.webplayer":{source:"iana"},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",compressible:!0,extensions:["uoml"]},"application/vnd.uplanet.alert":{source:"iana"},"application/vnd.uplanet.alert-wbxml":{source:"iana"},"application/vnd.uplanet.bearer-choice":{source:"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{source:"iana"},"application/vnd.uplanet.cacheop":{source:"iana"},"application/vnd.uplanet.cacheop-wbxml":{source:"iana"},"application/vnd.uplanet.channel":{source:"iana"},"application/vnd.uplanet.channel-wbxml":{source:"iana"},"application/vnd.uplanet.list":{source:"iana"},"application/vnd.uplanet.list-wbxml":{source:"iana"},"application/vnd.uplanet.listcmd":{source:"iana"},"application/vnd.uplanet.listcmd-wbxml":{source:"iana"},"application/vnd.uplanet.signal":{source:"iana"},"application/vnd.uri-map":{source:"iana"},"application/vnd.valve.source.material":{source:"iana"},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.vd-study":{source:"iana"},"application/vnd.vectorworks":{source:"iana"},"application/vnd.vel+json":{source:"iana",compressible:!0},"application/vnd.verimatrix.vcas":{source:"iana"},"application/vnd.veritone.aion+json":{source:"iana",compressible:!0},"application/vnd.veryant.thin":{source:"iana"},"application/vnd.ves.encrypted":{source:"iana"},"application/vnd.vidsoft.vidconference":{source:"iana"},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vividence.scriptfile":{source:"iana"},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.sic":{source:"iana"},"application/vnd.wap.slc":{source:"iana"},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wfa.dpp":{source:"iana"},"application/vnd.wfa.p2p":{source:"iana"},"application/vnd.wfa.wsc":{source:"iana"},"application/vnd.windows.devicepairing":{source:"iana"},"application/vnd.wmc":{source:"iana"},"application/vnd.wmf.bootstrap":{source:"iana"},"application/vnd.wolfram.mathematica":{source:"iana"},"application/vnd.wolfram.mathematica.package":{source:"iana"},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wrq-hp3000-labelled":{source:"iana"},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.wv.csp+wbxml":{source:"iana"},"application/vnd.wv.csp+xml":{source:"iana",compressible:!0},"application/vnd.wv.ssp+xml":{source:"iana",compressible:!0},"application/vnd.xacml+json":{source:"iana",compressible:!0},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.xfdl.webform":{source:"iana"},"application/vnd.xmi+xml":{source:"iana",compressible:!0},"application/vnd.xmpie.cpkg":{source:"iana"},"application/vnd.xmpie.dpkg":{source:"iana"},"application/vnd.xmpie.plan":{source:"iana"},"application/vnd.xmpie.ppkg":{source:"iana"},"application/vnd.xmpie.xlim":{source:"iana"},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",compressible:!0,extensions:["osfpvg"]},"application/vnd.yamaha.remote-setup":{source:"iana"},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yamaha.through-ngn":{source:"iana"},"application/vnd.yamaha.tunnel-udpencap":{source:"iana"},"application/vnd.yaoweme":{source:"iana"},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.youtube.yt":{source:"iana"},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",compressible:!0,extensions:["zaz"]},"application/voicexml+xml":{source:"iana",compressible:!0,extensions:["vxml"]},"application/voucher-cms+json":{source:"iana",compressible:!0},"application/vq-rtcpxr":{source:"iana"},"application/wasm":{source:"iana",compressible:!0,extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",compressible:!0,extensions:["wif"]},"application/webpush-options+json":{source:"iana",compressible:!0},"application/whoispp-query":{source:"iana"},"application/whoispp-response":{source:"iana"},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wita":{source:"iana"},"application/wordperfect5.1":{source:"iana"},"application/wsdl+xml":{source:"iana",compressible:!0,extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",compressible:!0,extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",compressible:!1,extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-amf":{source:"apache"},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-arj":{compressible:!1,extensions:["arj"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bdoc":{compressible:!1,extensions:["bdoc"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",compressible:!1,extensions:["bz"]},"application/x-bzip2":{source:"apache",compressible:!1,extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-chrome-extension":{extensions:["crx"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-compress":{source:"apache"},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-deb":{compressible:!1},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",compressible:!0,extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",compressible:!0,extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",compressible:!0,extensions:["res"]},"application/x-dvi":{source:"apache",compressible:!1,extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-dos":{source:"apache"},"application/x-font-framemaker":{source:"apache"},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-libgrx":{source:"apache"},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-speedo":{source:"apache"},"application/x-font-sunos-news":{source:"apache"},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{source:"apache"},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-gzip":{source:"apache"},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-httpd-php":{compressible:!0,extensions:["php"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-iwork-keynote-sffkey":{extensions:["key"]},"application/x-iwork-numbers-sffnumbers":{extensions:["numbers"]},"application/x-iwork-pages-sffpages":{extensions:["pages"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",compressible:!1,extensions:["jnlp"]},"application/x-javascript":{compressible:!0},"application/x-keepass2":{extensions:["kdbx"]},"application/x-latex":{source:"apache",compressible:!1,extensions:["latex"]},"application/x-lua-bytecode":{extensions:["luac"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-mpegurl":{compressible:!1},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdos-program":{extensions:["exe"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-ns-proxy-autoconfig":{compressible:!0,extensions:["pac"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",compressible:!1,extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-pki-message":{source:"iana"},"application/x-rar-compressed":{source:"apache",compressible:!1,extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",compressible:!0,extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",compressible:!1,extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",compressible:!1,extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",compressible:!0,extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-virtualbox-hdd":{compressible:!0,extensions:["hdd"]},"application/x-virtualbox-ova":{compressible:!0,extensions:["ova"]},"application/x-virtualbox-ovf":{compressible:!0,extensions:["ovf"]},"application/x-virtualbox-vbox":{compressible:!0,extensions:["vbox"]},"application/x-virtualbox-vbox-extpack":{compressible:!1,extensions:["vbox-extpack"]},"application/x-virtualbox-vdi":{compressible:!0,extensions:["vdi"]},"application/x-virtualbox-vhd":{compressible:!0,extensions:["vhd"]},"application/x-virtualbox-vmdk":{compressible:!0,extensions:["vmdk"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-web-app-manifest+json":{compressible:!0,extensions:["webapp"]},"application/x-www-form-urlencoded":{source:"iana",compressible:!0},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-x509-ca-ra-cert":{source:"iana"},"application/x-x509-next-ca-cert":{source:"iana"},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",compressible:!0,extensions:["xlf"]},"application/x-xpinstall":{source:"apache",compressible:!1,extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{source:"iana"},"application/xacml+xml":{source:"iana",compressible:!0},"application/xaml+xml":{source:"apache",compressible:!0,extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",compressible:!0,extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",compressible:!0,extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",compressible:!0,extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",compressible:!0,extensions:["xel"]},"application/xcap-error+xml":{source:"iana",compressible:!0},"application/xcap-ns+xml":{source:"iana",compressible:!0,extensions:["xns"]},"application/xcon-conference-info+xml":{source:"iana",compressible:!0},"application/xcon-conference-info-diff+xml":{source:"iana",compressible:!0},"application/xenc+xml":{source:"iana",compressible:!0,extensions:["xenc"]},"application/xhtml+xml":{source:"iana",compressible:!0,extensions:["xhtml","xht"]},"application/xhtml-voice+xml":{source:"apache",compressible:!0},"application/xliff+xml":{source:"iana",compressible:!0,extensions:["xlf"]},"application/xml":{source:"iana",compressible:!0,extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",compressible:!0,extensions:["dtd"]},"application/xml-external-parsed-entity":{source:"iana"},"application/xml-patch+xml":{source:"iana",compressible:!0},"application/xmpp+xml":{source:"iana",compressible:!0},"application/xop+xml":{source:"iana",compressible:!0,extensions:["xop"]},"application/xproc+xml":{source:"apache",compressible:!0,extensions:["xpl"]},"application/xslt+xml":{source:"iana",compressible:!0,extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",compressible:!0,extensions:["xspf"]},"application/xv+xml":{source:"iana",compressible:!0,extensions:["mxml","xhvml","xvml","xvm"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yang-data+json":{source:"iana",compressible:!0},"application/yang-data+xml":{source:"iana",compressible:!0},"application/yang-patch+json":{source:"iana",compressible:!0},"application/yang-patch+xml":{source:"iana",compressible:!0},"application/yin+xml":{source:"iana",compressible:!0,extensions:["yin"]},"application/zip":{source:"iana",compressible:!1,extensions:["zip"]},"application/zlib":{source:"iana"},"application/zstd":{source:"iana"},"audio/1d-interleaved-parityfec":{source:"iana"},"audio/32kadpcm":{source:"iana"},"audio/3gpp":{source:"iana",compressible:!1,extensions:["3gpp"]},"audio/3gpp2":{source:"iana"},"audio/aac":{source:"iana"},"audio/ac3":{source:"iana"},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/amr-wb":{source:"iana"},"audio/amr-wb+":{source:"iana"},"audio/aptx":{source:"iana"},"audio/asc":{source:"iana"},"audio/atrac-advanced-lossless":{source:"iana"},"audio/atrac-x":{source:"iana"},"audio/atrac3":{source:"iana"},"audio/basic":{source:"iana",compressible:!1,extensions:["au","snd"]},"audio/bv16":{source:"iana"},"audio/bv32":{source:"iana"},"audio/clearmode":{source:"iana"},"audio/cn":{source:"iana"},"audio/dat12":{source:"iana"},"audio/dls":{source:"iana"},"audio/dsr-es201108":{source:"iana"},"audio/dsr-es202050":{source:"iana"},"audio/dsr-es202211":{source:"iana"},"audio/dsr-es202212":{source:"iana"},"audio/dv":{source:"iana"},"audio/dvi4":{source:"iana"},"audio/eac3":{source:"iana"},"audio/encaprtp":{source:"iana"},"audio/evrc":{source:"iana"},"audio/evrc-qcp":{source:"iana"},"audio/evrc0":{source:"iana"},"audio/evrc1":{source:"iana"},"audio/evrcb":{source:"iana"},"audio/evrcb0":{source:"iana"},"audio/evrcb1":{source:"iana"},"audio/evrcnw":{source:"iana"},"audio/evrcnw0":{source:"iana"},"audio/evrcnw1":{source:"iana"},"audio/evrcwb":{source:"iana"},"audio/evrcwb0":{source:"iana"},"audio/evrcwb1":{source:"iana"},"audio/evs":{source:"iana"},"audio/flexfec":{source:"iana"},"audio/fwdred":{source:"iana"},"audio/g711-0":{source:"iana"},"audio/g719":{source:"iana"},"audio/g722":{source:"iana"},"audio/g7221":{source:"iana"},"audio/g723":{source:"iana"},"audio/g726-16":{source:"iana"},"audio/g726-24":{source:"iana"},"audio/g726-32":{source:"iana"},"audio/g726-40":{source:"iana"},"audio/g728":{source:"iana"},"audio/g729":{source:"iana"},"audio/g7291":{source:"iana"},"audio/g729d":{source:"iana"},"audio/g729e":{source:"iana"},"audio/gsm":{source:"iana"},"audio/gsm-efr":{source:"iana"},"audio/gsm-hr-08":{source:"iana"},"audio/ilbc":{source:"iana"},"audio/ip-mr_v2.5":{source:"iana"},"audio/isac":{source:"apache"},"audio/l16":{source:"iana"},"audio/l20":{source:"iana"},"audio/l24":{source:"iana",compressible:!1},"audio/l8":{source:"iana"},"audio/lpc":{source:"iana"},"audio/melp":{source:"iana"},"audio/melp1200":{source:"iana"},"audio/melp2400":{source:"iana"},"audio/melp600":{source:"iana"},"audio/mhas":{source:"iana"},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp3":{compressible:!1,extensions:["mp3"]},"audio/mp4":{source:"iana",compressible:!1,extensions:["m4a","mp4a"]},"audio/mp4a-latm":{source:"iana"},"audio/mpa":{source:"iana"},"audio/mpa-robust":{source:"iana"},"audio/mpeg":{source:"iana",compressible:!1,extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{source:"iana"},"audio/musepack":{source:"apache"},"audio/ogg":{source:"iana",compressible:!1,extensions:["oga","ogg","spx","opus"]},"audio/opus":{source:"iana"},"audio/parityfec":{source:"iana"},"audio/pcma":{source:"iana"},"audio/pcma-wb":{source:"iana"},"audio/pcmu":{source:"iana"},"audio/pcmu-wb":{source:"iana"},"audio/prs.sid":{source:"iana"},"audio/qcelp":{source:"iana"},"audio/raptorfec":{source:"iana"},"audio/red":{source:"iana"},"audio/rtp-enc-aescm128":{source:"iana"},"audio/rtp-midi":{source:"iana"},"audio/rtploopback":{source:"iana"},"audio/rtx":{source:"iana"},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/scip":{source:"iana"},"audio/silk":{source:"apache",extensions:["sil"]},"audio/smv":{source:"iana"},"audio/smv-qcp":{source:"iana"},"audio/smv0":{source:"iana"},"audio/sofa":{source:"iana"},"audio/sp-midi":{source:"iana"},"audio/speex":{source:"iana"},"audio/t140c":{source:"iana"},"audio/t38":{source:"iana"},"audio/telephone-event":{source:"iana"},"audio/tetra_acelp":{source:"iana"},"audio/tetra_acelp_bb":{source:"iana"},"audio/tone":{source:"iana"},"audio/tsvcis":{source:"iana"},"audio/uemclip":{source:"iana"},"audio/ulpfec":{source:"iana"},"audio/usac":{source:"iana"},"audio/vdvi":{source:"iana"},"audio/vmr-wb":{source:"iana"},"audio/vnd.3gpp.iufp":{source:"iana"},"audio/vnd.4sb":{source:"iana"},"audio/vnd.audiokoz":{source:"iana"},"audio/vnd.celp":{source:"iana"},"audio/vnd.cisco.nse":{source:"iana"},"audio/vnd.cmles.radio-events":{source:"iana"},"audio/vnd.cns.anp1":{source:"iana"},"audio/vnd.cns.inf1":{source:"iana"},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dlna.adts":{source:"iana"},"audio/vnd.dolby.heaac.1":{source:"iana"},"audio/vnd.dolby.heaac.2":{source:"iana"},"audio/vnd.dolby.mlp":{source:"iana"},"audio/vnd.dolby.mps":{source:"iana"},"audio/vnd.dolby.pl2":{source:"iana"},"audio/vnd.dolby.pl2x":{source:"iana"},"audio/vnd.dolby.pl2z":{source:"iana"},"audio/vnd.dolby.pulse.1":{source:"iana"},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.dts.uhd":{source:"iana"},"audio/vnd.dvb.file":{source:"iana"},"audio/vnd.everad.plj":{source:"iana"},"audio/vnd.hns.audio":{source:"iana"},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nokia.mobile-xmf":{source:"iana"},"audio/vnd.nortel.vbk":{source:"iana"},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.octel.sbc":{source:"iana"},"audio/vnd.presonus.multitrack":{source:"iana"},"audio/vnd.qcelp":{source:"iana"},"audio/vnd.rhetorex.32kadpcm":{source:"iana"},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/vnd.rn-realaudio":{compressible:!1},"audio/vnd.sealedmedia.softseal.mpeg":{source:"iana"},"audio/vnd.vmx.cvsd":{source:"iana"},"audio/vnd.wave":{compressible:!1},"audio/vorbis":{source:"iana",compressible:!1},"audio/vorbis-config":{source:"iana"},"audio/wav":{compressible:!1,extensions:["wav"]},"audio/wave":{compressible:!1,extensions:["wav"]},"audio/webm":{source:"apache",compressible:!1,extensions:["weba"]},"audio/x-aac":{source:"apache",compressible:!1,extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",compressible:!1,extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-tta":{source:"apache"},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/xm":{source:"apache",extensions:["xm"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-pdb":{source:"apache"},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",compressible:!0,extensions:["otf"]},"font/sfnt":{source:"iana"},"font/ttf":{source:"iana",compressible:!0,extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"image/aces":{source:"iana",extensions:["exr"]},"image/apng":{compressible:!1,extensions:["apng"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",compressible:!1,extensions:["avif"]},"image/bmp":{source:"iana",compressible:!0,extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",compressible:!1,extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",compressible:!1,extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",compressible:!1,extensions:["jpeg","jpg","jpe"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",compressible:!1,extensions:["jpm"]},"image/jpx":{source:"iana",compressible:!1,extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/naplps":{source:"iana"},"image/pjpeg":{compressible:!1},"image/png":{source:"iana",compressible:!1,extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/pwg-raster":{source:"iana"},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",compressible:!0,extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",compressible:!1,extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",compressible:!0,extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.cns.inf2":{source:"iana"},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.globalgraphics.pgb":{source:"iana"},"image/vnd.microsoft.icon":{source:"iana",compressible:!0,extensions:["ico"]},"image/vnd.mix":{source:"iana"},"image/vnd.mozilla.apng":{source:"iana"},"image/vnd.ms-dds":{compressible:!0,extensions:["dds"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.radiance":{source:"iana"},"image/vnd.sealed.png":{source:"iana"},"image/vnd.sealedmedia.softseal.gif":{source:"iana"},"image/vnd.sealedmedia.softseal.jpg":{source:"iana"},"image/vnd.svf":{source:"iana"},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",compressible:!0,extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",compressible:!0,extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xcf":{compressible:!1},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"message/cpim":{source:"iana"},"message/delivery-status":{source:"iana"},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/external-body":{source:"iana"},"message/feedback-report":{source:"iana"},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/http":{source:"iana",compressible:!1},"message/imdn+xml":{source:"iana",compressible:!0},"message/news":{source:"iana"},"message/partial":{source:"iana",compressible:!1},"message/rfc822":{source:"iana",compressible:!0,extensions:["eml","mime"]},"message/s-http":{source:"iana"},"message/sip":{source:"iana"},"message/sipfrag":{source:"iana"},"message/tracking-status":{source:"iana"},"message/vnd.si.simp":{source:"iana"},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/e57":{source:"iana"},"model/gltf+json":{source:"iana",compressible:!0,extensions:["gltf"]},"model/gltf-binary":{source:"iana",compressible:!0,extensions:["glb"]},"model/iges":{source:"iana",compressible:!1,extensions:["igs","iges"]},"model/mesh":{source:"iana",compressible:!1,extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana"},"model/step+xml":{source:"iana",compressible:!0,extensions:["stpx"]},"model/step+zip":{source:"iana",compressible:!1,extensions:["stpz"]},"model/step-xml+zip":{source:"iana",compressible:!1,extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",compressible:!0,extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.flatland.3dml":{source:"iana"},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gs-gdl":{source:"apache"},"model/vnd.gs.gdl":{source:"iana"},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.moml+xml":{source:"iana",compressible:!0},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.pytha.pyox":{source:"iana"},"model/vnd.rosette.annotated-data-model":{source:"iana"},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",compressible:!1,extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",compressible:!1,extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",compressible:!1,extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",compressible:!1,extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",compressible:!0,extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"multipart/alternative":{source:"iana",compressible:!1},"multipart/appledouble":{source:"iana"},"multipart/byteranges":{source:"iana"},"multipart/digest":{source:"iana"},"multipart/encrypted":{source:"iana",compressible:!1},"multipart/form-data":{source:"iana",compressible:!1},"multipart/header-set":{source:"iana"},"multipart/mixed":{source:"iana"},"multipart/multilingual":{source:"iana"},"multipart/parallel":{source:"iana"},"multipart/related":{source:"iana",compressible:!1},"multipart/report":{source:"iana"},"multipart/signed":{source:"iana",compressible:!1},"multipart/vnd.bint.med-plus":{source:"iana"},"multipart/voice-message":{source:"iana"},"multipart/x-mixed-replace":{source:"iana"},"text/1d-interleaved-parityfec":{source:"iana"},"text/cache-manifest":{source:"iana",compressible:!0,extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/calender":{compressible:!0},"text/cmd":{compressible:!0},"text/coffeescript":{extensions:["coffee","litcoffee"]},"text/cql":{source:"iana"},"text/cql-expression":{source:"iana"},"text/cql-identifier":{source:"iana"},"text/css":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["css"]},"text/csv":{source:"iana",compressible:!0,extensions:["csv"]},"text/csv-schema":{source:"iana"},"text/directory":{source:"iana"},"text/dns":{source:"iana"},"text/ecmascript":{source:"iana"},"text/encaprtp":{source:"iana"},"text/enriched":{source:"iana"},"text/fhirpath":{source:"iana"},"text/flexfec":{source:"iana"},"text/fwdred":{source:"iana"},"text/gff3":{source:"iana"},"text/grammar-ref-list":{source:"iana"},"text/html":{source:"iana",compressible:!0,extensions:["html","htm","shtml"]},"text/jade":{extensions:["jade"]},"text/javascript":{source:"iana",compressible:!0},"text/jcr-cnd":{source:"iana"},"text/jsx":{compressible:!0,extensions:["jsx"]},"text/less":{compressible:!0,extensions:["less"]},"text/markdown":{source:"iana",compressible:!0,extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/mdx":{compressible:!0,extensions:["mdx"]},"text/mizar":{source:"iana"},"text/n3":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["n3"]},"text/parameters":{source:"iana",charset:"UTF-8"},"text/parityfec":{source:"iana"},"text/plain":{source:"iana",compressible:!0,extensions:["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{source:"iana",charset:"UTF-8"},"text/prs.fallenstein.rst":{source:"iana"},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/prs.prop.logic":{source:"iana"},"text/raptorfec":{source:"iana"},"text/red":{source:"iana"},"text/rfc822-headers":{source:"iana"},"text/richtext":{source:"iana",compressible:!0,extensions:["rtx"]},"text/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"text/rtp-enc-aescm128":{source:"iana"},"text/rtploopback":{source:"iana"},"text/rtx":{source:"iana"},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shaclc":{source:"iana"},"text/shex":{source:"iana",extensions:["shex"]},"text/slim":{extensions:["slim","slm"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/strings":{source:"iana"},"text/stylus":{extensions:["stylus","styl"]},"text/t140":{source:"iana"},"text/tab-separated-values":{source:"iana",compressible:!0,extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/ulpfec":{source:"iana"},"text/uri-list":{source:"iana",compressible:!0,extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",compressible:!0,extensions:["vcard"]},"text/vnd.a":{source:"iana"},"text/vnd.abc":{source:"iana"},"text/vnd.ascii-art":{source:"iana"},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.debian.copyright":{source:"iana",charset:"UTF-8"},"text/vnd.dmclientscript":{source:"iana"},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.esmertec.theme-descriptor":{source:"iana",charset:"UTF-8"},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.ficlab.flt":{source:"iana"},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.gml":{source:"iana"},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.hans":{source:"iana"},"text/vnd.hgl":{source:"iana"},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.iptc.newsml":{source:"iana"},"text/vnd.iptc.nitf":{source:"iana"},"text/vnd.latex-z":{source:"iana"},"text/vnd.motorola.reflex":{source:"iana"},"text/vnd.ms-mediapackage":{source:"iana"},"text/vnd.net2phone.commcenter.command":{source:"iana"},"text/vnd.radisys.msml-basic-layout":{source:"iana"},"text/vnd.senx.warpscript":{source:"iana"},"text/vnd.si.uricatalogue":{source:"iana"},"text/vnd.sosi":{source:"iana"},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.trolltech.linguist":{source:"iana",charset:"UTF-8"},"text/vnd.wap.si":{source:"iana"},"text/vnd.wap.sl":{source:"iana"},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-gwt-rpc":{compressible:!0},"text/x-handlebars-template":{extensions:["hbs"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-jquery-tmpl":{compressible:!0},"text/x-lua":{extensions:["lua"]},"text/x-markdown":{compressible:!0,extensions:["mkd"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-org":{compressible:!0,extensions:["org"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-processing":{compressible:!0,extensions:["pde"]},"text/x-sass":{extensions:["sass"]},"text/x-scss":{extensions:["scss"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-suse-ymp":{compressible:!0,extensions:["ymp"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",compressible:!0,extensions:["xml"]},"text/xml-external-parsed-entity":{source:"iana"},"text/yaml":{compressible:!0,extensions:["yaml","yml"]},"video/1d-interleaved-parityfec":{source:"iana"},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp-tt":{source:"iana"},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/av1":{source:"iana"},"video/bmpeg":{source:"iana"},"video/bt656":{source:"iana"},"video/celb":{source:"iana"},"video/dv":{source:"iana"},"video/encaprtp":{source:"iana"},"video/ffv1":{source:"iana"},"video/flexfec":{source:"iana"},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h263-1998":{source:"iana"},"video/h263-2000":{source:"iana"},"video/h264":{source:"iana",extensions:["h264"]},"video/h264-rcdo":{source:"iana"},"video/h264-svc":{source:"iana"},"video/h265":{source:"iana"},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpeg2000":{source:"iana"},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/jxsv":{source:"iana"},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp1s":{source:"iana"},"video/mp2p":{source:"iana"},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",compressible:!1,extensions:["mp4","mp4v","mpg4"]},"video/mp4v-es":{source:"iana"},"video/mpeg":{source:"iana",compressible:!1,extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{source:"iana"},"video/mpv":{source:"iana"},"video/nv":{source:"iana"},"video/ogg":{source:"iana",compressible:!1,extensions:["ogv"]},"video/parityfec":{source:"iana"},"video/pointer":{source:"iana"},"video/quicktime":{source:"iana",compressible:!1,extensions:["qt","mov"]},"video/raptorfec":{source:"iana"},"video/raw":{source:"iana"},"video/rtp-enc-aescm128":{source:"iana"},"video/rtploopback":{source:"iana"},"video/rtx":{source:"iana"},"video/scip":{source:"iana"},"video/smpte291":{source:"iana"},"video/smpte292m":{source:"iana"},"video/ulpfec":{source:"iana"},"video/vc1":{source:"iana"},"video/vc2":{source:"iana"},"video/vnd.cctv":{source:"iana"},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.mp4":{source:"iana"},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.directv.mpeg":{source:"iana"},"video/vnd.directv.mpeg-tts":{source:"iana"},"video/vnd.dlna.mpeg-tts":{source:"iana"},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.hns.video":{source:"iana"},"video/vnd.iptvforum.1dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.1dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.2dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.2dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.ttsavc":{source:"iana"},"video/vnd.iptvforum.ttsmpeg2":{source:"iana"},"video/vnd.motorola.video":{source:"iana"},"video/vnd.motorola.videop":{source:"iana"},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.nokia.interleaved-multimedia":{source:"iana"},"video/vnd.nokia.mp4vr":{source:"iana"},"video/vnd.nokia.videovoip":{source:"iana"},"video/vnd.objectvideo":{source:"iana"},"video/vnd.radgamettools.bink":{source:"iana"},"video/vnd.radgamettools.smacker":{source:"iana"},"video/vnd.sealed.mpeg1":{source:"iana"},"video/vnd.sealed.mpeg4":{source:"iana"},"video/vnd.sealed.swf":{source:"iana"},"video/vnd.sealedmedia.softseal.mov":{source:"iana"},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/vnd.youtube.yt":{source:"iana"},"video/vp8":{source:"iana"},"video/vp9":{source:"iana"},"video/webm":{source:"apache",compressible:!1,extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",compressible:!1,extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",compressible:!1,extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",compressible:!1,extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]},"x-shader/x-fragment":{compressible:!0},"x-shader/x-vertex":{compressible:!0}}});var iFe=R((TZr,nFe)=>{nFe.exports=rFe()});var aFe=R(Oc=>{"use strict";var mV=iFe(),$St=require("path").extname,oFe=/^\s*([^;\s]*)(?:;|\s|$)/,WSt=/^text\//i;Oc.charset=sFe;Oc.charsets={lookup:sFe};Oc.contentType=KSt;Oc.extension=YSt;Oc.extensions=Object.create(null);Oc.lookup=QSt;Oc.types=Object.create(null);XSt(Oc.extensions,Oc.types);function sFe(t){if(!t||typeof t!="string")return!1;var e=oFe.exec(t),r=e&&mV[e[1].toLowerCase()];return r&&r.charset?r.charset:e&&WSt.test(e[1])?"UTF-8":!1}function KSt(t){if(!t||typeof t!="string")return!1;var e=t.indexOf("/")===-1?Oc.lookup(t):t;if(!e)return!1;if(e.indexOf("charset")===-1){var r=Oc.charset(e);r&&(e+="; charset="+r.toLowerCase())}return e}function YSt(t){if(!t||typeof t!="string")return!1;var e=oFe.exec(t),r=e&&Oc.extensions[e[1].toLowerCase()];return!r||!r.length?!1:r[0]}function QSt(t){if(!t||typeof t!="string")return!1;var e=$St("x."+t).toLowerCase().substr(1);return e&&Oc.types[e]||!1}function XSt(t,e){var r=["nginx","apache",void 0,"iana"];Object.keys(mV).forEach(function(o){var s=mV[o],a=s.extensions;if(!(!a||!a.length)){t[o]=a;for(var c=0;c<a.length;c++){var l=a[c];if(e[l]){var u=r.indexOf(mV[e[l]].source),d=r.indexOf(s.source);if(e[l]!=="application/octet-stream"&&(u>d||u===d&&e[l].substr(0,12)==="application/"))continue}e[l]=o}}})}});var lFe=R((wZr,cFe)=>{cFe.exports=JSt;function JSt(t){var e=typeof setImmediate=="function"?setImmediate:typeof process=="object"&&typeof process.nextTick=="function"?process.nextTick:null;e?e(t):setTimeout(t,0)}});var bae=R((kZr,dFe)=>{var uFe=lFe();dFe.exports=ZSt;function ZSt(t){var e=!1;return uFe(function(){e=!0}),function(n,o){e?t(n,o):uFe(function(){t(n,o)})}}});var _ae=R((RZr,pFe)=>{pFe.exports=e1t;function e1t(t){Object.keys(t.jobs).forEach(t1t.bind(t)),t.jobs={}}function t1t(t){typeof this.jobs[t]=="function"&&this.jobs[t]()}});var xae=R((PZr,mFe)=>{var fFe=bae(),r1t=_ae();mFe.exports=n1t;function n1t(t,e,r,n){var o=r.keyedList?r.keyedList[r.index]:r.index;r.jobs[o]=i1t(e,o,t[o],function(s,a){o in r.jobs&&(delete r.jobs[o],s?r1t(r):r.results[o]=a,n(s,r.results))})}function i1t(t,e,r,n){var o;return t.length==2?o=t(r,fFe(n)):o=t(r,e,fFe(n)),o}});var Sae=R((AZr,hFe)=>{hFe.exports=o1t;function o1t(t,e){var r=!Array.isArray(t),n={index:0,keyedList:r||e?Object.keys(t):null,jobs:{},results:r?{}:[],size:r?Object.keys(t).length:t.length};return e&&n.keyedList.sort(r?e:function(o,s){return e(t[o],t[s])}),n}});var Iae=R((DZr,gFe)=>{var s1t=_ae(),a1t=bae();gFe.exports=c1t;function c1t(t){Object.keys(this.jobs).length&&(this.index=this.size,s1t(this),a1t(t)(null,this.results))}});var yFe=R((NZr,vFe)=>{var l1t=xae(),u1t=Sae(),d1t=Iae();vFe.exports=p1t;function p1t(t,e,r){for(var n=u1t(t);n.index<(n.keyedList||t).length;)l1t(t,e,n,function(o,s){if(o){r(o,s);return}if(Object.keys(n.jobs).length===0){r(null,n.results);return}}),n.index++;return d1t.bind(n,r)}});var Cae=R((LZr,hV)=>{var bFe=xae(),f1t=Sae(),m1t=Iae();hV.exports=h1t;hV.exports.ascending=_Fe;hV.exports.descending=g1t;function h1t(t,e,r,n){var o=f1t(t,r);return bFe(t,e,o,function s(a,c){if(a){n(a,c);return}if(o.index++,o.index<(o.keyedList||t).length){bFe(t,e,o,s);return}n(null,o.results)}),m1t.bind(o,n)}function _Fe(t,e){return t<e?-1:t>e?1:0}function g1t(t,e){return-1*_Fe(t,e)}});var SFe=R((OZr,xFe)=>{var v1t=Cae();xFe.exports=y1t;function y1t(t,e,r){return v1t(t,e,null,r)}});var CFe=R((MZr,IFe)=>{IFe.exports={parallel:yFe(),serial:SFe(),serialOrdered:Cae()}});var EFe=R((FZr,TFe)=>{TFe.exports=function(t,e){return Object.keys(e).forEach(function(r){t[r]=t[r]||e[r]}),t}});var RFe=R((UZr,kFe)=>{var kae=tFe(),wFe=require("util"),Tae=require("path"),b1t=require("http"),_1t=require("https"),x1t=require("url").parse,S1t=require("fs"),I1t=require("stream").Stream,Eae=aFe(),C1t=CFe(),wae=EFe();kFe.exports=Jr;wFe.inherits(Jr,kae);function Jr(t){if(!(this instanceof Jr))return new Jr(t);this._overheadLength=0,this._valueLength=0,this._valuesToMeasure=[],kae.call(this),t=t||{};for(var e in t)this[e]=t[e]}Jr.LINE_BREAK=`\r
`;Jr.DEFAULT_CONTENT_TYPE="application/octet-stream";Jr.prototype.append=function(t,e,r){r=r||{},typeof r=="string"&&(r={filename:r});var n=kae.prototype.append.bind(this);if(typeof e=="number"&&(e=""+e),wFe.isArray(e)){this._error(new Error("Arrays are not supported."));return}var o=this._multiPartHeader(t,e,r),s=this._multiPartFooter();n(o),n(e),n(s),this._trackLength(o,e,r)};Jr.prototype._trackLength=function(t,e,r){var n=0;r.knownLength!=null?n+=+r.knownLength:Buffer.isBuffer(e)?n=e.length:typeof e=="string"&&(n=Buffer.byteLength(e)),this._valueLength+=n,this._overheadLength+=Buffer.byteLength(t)+Jr.LINE_BREAK.length,!(!e||!e.path&&!(e.readable&&e.hasOwnProperty("httpVersion"))&&!(e instanceof I1t))&&(r.knownLength||this._valuesToMeasure.push(e))};Jr.prototype._lengthRetriever=function(t,e){t.hasOwnProperty("fd")?t.end!=null&&t.end!=1/0&&t.start!=null?e(null,t.end+1-(t.start?t.start:0)):S1t.stat(t.path,function(r,n){var o;if(r){e(r);return}o=n.size-(t.start?t.start:0),e(null,o)}):t.hasOwnProperty("httpVersion")?e(null,+t.headers["content-length"]):t.hasOwnProperty("httpModule")?(t.on("response",function(r){t.pause(),e(null,+r.headers["content-length"])}),t.resume()):e("Unknown stream")};Jr.prototype._multiPartHeader=function(t,e,r){if(typeof r.header=="string")return r.header;var n=this._getContentDisposition(e,r),o=this._getContentType(e,r),s="",a={"Content-Disposition":["form-data",'name="'+t+'"'].concat(n||[]),"Content-Type":[].concat(o||[])};typeof r.header=="object"&&wae(a,r.header);var c;for(var l in a)a.hasOwnProperty(l)&&(c=a[l],c!=null&&(Array.isArray(c)||(c=[c]),c.length&&(s+=l+": "+c.join("; ")+Jr.LINE_BREAK)));return"--"+this.getBoundary()+Jr.LINE_BREAK+s+Jr.LINE_BREAK};Jr.prototype._getContentDisposition=function(t,e){var r,n;return typeof e.filepath=="string"?r=Tae.normalize(e.filepath).replace(/\\/g,"/"):e.filename||t.name||t.path?r=Tae.basename(e.filename||t.name||t.path):t.readable&&t.hasOwnProperty("httpVersion")&&(r=Tae.basename(t.client._httpMessage.path||"")),r&&(n='filename="'+r+'"'),n};Jr.prototype._getContentType=function(t,e){var r=e.contentType;return!r&&t.name&&(r=Eae.lookup(t.name)),!r&&t.path&&(r=Eae.lookup(t.path)),!r&&t.readable&&t.hasOwnProperty("httpVersion")&&(r=t.headers["content-type"]),!r&&(e.filepath||e.filename)&&(r=Eae.lookup(e.filepath||e.filename)),!r&&typeof t=="object"&&(r=Jr.DEFAULT_CONTENT_TYPE),r};Jr.prototype._multiPartFooter=function(){return function(t){var e=Jr.LINE_BREAK,r=this._streams.length===0;r&&(e+=this._lastBoundary()),t(e)}.bind(this)};Jr.prototype._lastBoundary=function(){return"--"+this.getBoundary()+"--"+Jr.LINE_BREAK};Jr.prototype.getHeaders=function(t){var e,r={"content-type":"multipart/form-data; boundary="+this.getBoundary()};for(e in t)t.hasOwnProperty(e)&&(r[e.toLowerCase()]=t[e]);return r};Jr.prototype.setBoundary=function(t){this._boundary=t};Jr.prototype.getBoundary=function(){return this._boundary||this._generateBoundary(),this._boundary};Jr.prototype.getBuffer=function(){for(var t=new Buffer.alloc(0),e=this.getBoundary(),r=0,n=this._streams.length;r<n;r++)typeof this._streams[r]!="function"&&(Buffer.isBuffer(this._streams[r])?t=Buffer.concat([t,this._streams[r]]):t=Buffer.concat([t,Buffer.from(this._streams[r])]),(typeof this._streams[r]!="string"||this._streams[r].substring(2,e.length+2)!==e)&&(t=Buffer.concat([t,Buffer.from(Jr.LINE_BREAK)])));return Buffer.concat([t,Buffer.from(this._lastBoundary())])};Jr.prototype._generateBoundary=function(){for(var t="--------------------------",e=0;e<24;e++)t+=Math.floor(Math.random()*10).toString(16);this._boundary=t};Jr.prototype.getLengthSync=function(){var t=this._overheadLength+this._valueLength;return this._streams.length&&(t+=this._lastBoundary().length),this.hasKnownLength()||this._error(new Error("Cannot calculate proper length in synchronous way.")),t};Jr.prototype.hasKnownLength=function(){var t=!0;return this._valuesToMeasure.length&&(t=!1),t};Jr.prototype.getLength=function(t){var e=this._overheadLength+this._valueLength;if(this._streams.length&&(e+=this._lastBoundary().length),!this._valuesToMeasure.length){process.nextTick(t.bind(this,null,e));return}C1t.parallel(this._valuesToMeasure,this._lengthRetriever,function(r,n){if(r){t(r);return}n.forEach(function(o){e+=o}),t(null,e)})};Jr.prototype.submit=function(t,e){var r,n,o={method:"post"};return typeof t=="string"?(t=x1t(t),n=wae({port:t.port,path:t.pathname,host:t.hostname,protocol:t.protocol},o)):(n=wae(t,o),n.port||(n.port=n.protocol=="https:"?443:80)),n.headers=this.getHeaders(t.headers),n.protocol=="https:"?r=_1t.request(n):r=b1t.request(n),this.getLength(function(s,a){if(s&&s!=="Unknown stream"){this._error(s);return}if(a&&r.setHeader("Content-Length",a),this.pipe(r),e){var c,l=function(u,d){return r.removeListener("error",l),r.removeListener("response",c),e.call(this,u,d)};c=l.bind(this,null),r.on("error",l),r.on("response",c)}}.bind(this)),r};Jr.prototype._error=function(t){this.error||(this.error=t,this.pause(),this.emit("error",t))};Jr.prototype.toString=function(){return"[object FormData]"}});function gV(){return{name:Rae,async sendRequest(t,e){if(t.formData){let r=t.headers.get("Content-Type");r&&r.indexOf("application/x-www-form-urlencoded")!==-1?(t.body=T1t(t.formData),t.formData=void 0):await E1t(t.formData,t)}return e(t)}}}function T1t(t){let e=new URLSearchParams;for(let[r,n]of Object.entries(t))if(Array.isArray(n))for(let o of n)e.append(r,o.toString());else e.append(r,n.toString());return e.toString()}async function E1t(t,e){let r=new PFe.default;for(let o of Object.keys(t)){let s=t[o];if(Array.isArray(s))for(let a of s)r.append(o,a);else r.append(o,s)}e.body=r,e.formData=void 0;let n=e.headers.get("Content-Type");n&&n.indexOf("multipart/form-data")!==-1&&e.headers.set("Content-Type",`multipart/form-data; boundary=${r.getBoundary()}`);try{let o=await new Promise((s,a)=>{r.getLength((c,l)=>{c?a(c):s(l)})});e.headers.set("Content-Length",o)}catch{}}var PFe,Rae,Pae=D(()=>{PFe=q(RFe()),Rae="formDataPolicy"});var AFe=R(Aae=>{"use strict";Object.defineProperty(Aae,"__esModule",{value:!0});function w1t(t){return function(e,r){return new Promise((n,o)=>{t.call(this,e,r,(s,a)=>{s?o(s):n(a)})})}}Aae.default=w1t});var Lae=R((Nae,NFe)=>{"use strict";var DFe=Nae&&Nae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},k1t=require("events"),R1t=DFe(Pd()),P1t=DFe(AFe()),p4=R1t.default("agent-base");function A1t(t){return!!t&&typeof t.addRequest=="function"}function Dae(){let{stack:t}=new Error;return typeof t!="string"?!1:t.split(`
`).some(e=>e.indexOf("(https.js:")!==-1||e.indexOf("node:https:")!==-1)}function vV(t,e){return new vV.Agent(t,e)}(function(t){class e extends k1t.EventEmitter{constructor(n,o){super();let s=o;typeof n=="function"?this.callback=n:n&&(s=n),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:Dae()?443:80}set defaultPort(n){this.explicitDefaultPort=n}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:Dae()?"https:":"http:"}set protocol(n){this.explicitProtocol=n}callback(n,o,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(n,o){let s=Object.assign({},o);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=Dae()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80),s.protocol==null&&(s.protocol=s.secureEndpoint?"https:":"http:"),s.host&&s.path&&delete s.path,delete s.agent,delete s.hostname,delete s._defaultAgent,delete s.defaultPort,delete s.createConnection,n._last=!0,n.shouldKeepAlive=!1;let a=!1,c=null,l=s.timeout||this.timeout,u=m=>{n._hadError||(n.emit("error",m),n._hadError=!0)},d=()=>{c=null,a=!0;let m=new Error(`A "socket" was not created for HTTP request before ${l}ms`);m.code="ETIMEOUT",u(m)},p=m=>{a||(c!==null&&(clearTimeout(c),c=null),u(m))},f=m=>{if(a)return;if(c!=null&&(clearTimeout(c),c=null),A1t(m)){p4("Callback returned another Agent instance %o",m.constructor.name),m.addRequest(n,s);return}if(m){m.once("free",()=>{this.freeSocket(m,s)}),n.onSocket(m);return}let h=new Error(`no Duplex stream was returned to agent-base for \`${n.method} ${n.path}\``);u(h)};if(typeof this.callback!="function"){u(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(p4("Converting legacy callback function to promise"),this.promisifiedCallback=P1t.default(this.callback)):this.promisifiedCallback=this.callback),typeof l=="number"&&l>0&&(c=setTimeout(d,l)),"port"in s&&typeof s.port!="number"&&(s.port=Number(s.port));try{p4("Resolving socket for %o request: %o",s.protocol,`${n.method} ${n.path}`),Promise.resolve(this.promisifiedCallback(n,s)).then(f,p)}catch(m){Promise.reject(m).catch(p)}}freeSocket(n,o){p4("Freeing socket %o %o",n.constructor.name,o),n.destroy()}destroy(){p4("Destroying agent %o",this.constructor.name)}}t.Agent=e,t.prototype=t.Agent.prototype})(vV||(vV={}));NFe.exports=vV});var LFe=R(m4=>{"use strict";var D1t=m4&&m4.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(m4,"__esModule",{value:!0});var N1t=D1t(Pd()),f4=N1t.default("https-proxy-agent:parse-proxy-response");function L1t(t){return new Promise((e,r)=>{let n=0,o=[];function s(){let p=t.read();p?d(p):t.once("readable",s)}function a(){t.removeListener("end",l),t.removeListener("error",u),t.removeListener("close",c),t.removeListener("readable",s)}function c(p){f4("onclose had error %o",p)}function l(){f4("onend")}function u(p){a(),f4("onerror %o",p),r(p)}function d(p){o.push(p),n+=p.length;let f=Buffer.concat(o,n);if(f.indexOf(`\r
\r
`)===-1){f4("have not received end of HTTP headers yet..."),s();return}let h=f.toString("ascii",0,f.indexOf(`\r
`)),g=+h.split(" ")[1];f4("got proxy server response: %o",h),e({statusCode:g,buffered:f})}t.on("error",u),t.on("close",c),t.on("end",l),s()})}m4.default=L1t});var FFe=R(RS=>{"use strict";var O1t=RS&&RS.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},ER=RS&&RS.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(RS,"__esModule",{value:!0});var OFe=ER(require("net")),MFe=ER(require("tls")),M1t=ER(require("url")),F1t=ER(require("assert")),U1t=ER(Pd()),B1t=Lae(),q1t=ER(LFe()),h4=U1t.default("https-proxy-agent:agent"),Oae=class extends B1t.Agent{constructor(e){let r;if(typeof e=="string"?r=M1t.default.parse(e):r=e,!r)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");h4("creating new HttpsProxyAgent instance: %o",r),super(r);let n=Object.assign({},r);this.secureProxy=r.secureProxy||H1t(n.protocol),n.host=n.hostname||n.host,typeof n.port=="string"&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in n)&&(n.ALPNProtocols=["http 1.1"]),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,r){return O1t(this,void 0,void 0,function*(){let{proxy:n,secureProxy:o}=this,s;o?(h4("Creating `tls.Socket`: %o",n),s=MFe.default.connect(n)):(h4("Creating `net.Socket`: %o",n),s=OFe.default.connect(n));let a=Object.assign({},n.headers),l=`CONNECT ${`${r.host}:${r.port}`} HTTP/1.1\r
`;n.auth&&(a["Proxy-Authorization"]=`Basic ${Buffer.from(n.auth).toString("base64")}`);let{host:u,port:d,secureEndpoint:p}=r;V1t(d,p)||(u+=`:${d}`),a.Host=u,a.Connection="close";for(let v of Object.keys(a))l+=`${v}: ${a[v]}\r
`;let f=q1t.default(s);s.write(`${l}\r
`);let{statusCode:m,buffered:h}=yield f;if(m===200){if(e.once("socket",j1t),r.secureEndpoint){h4("Upgrading socket connection to TLS");let v=r.servername||r.host;return MFe.default.connect(Object.assign(Object.assign({},G1t(r,"host","hostname","path","port")),{socket:s,servername:v}))}return s}s.destroy();let g=new OFe.default.Socket({writable:!1});return g.readable=!0,e.once("socket",v=>{h4("replaying proxy buffer for failed request"),F1t.default(v.listenerCount("data")>0),v.push(h),v.push(null)}),g})}};RS.default=Oae;function j1t(t){t.resume()}function V1t(t,e){return!!(!e&&t===80||e&&t===443)}function H1t(t){return typeof t=="string"?/^https:?$/i.test(t):!1}function G1t(t,...e){let r={},n;for(n in t)e.includes(n)||(r[n]=t[n]);return r}});var BFe=R((Uae,UFe)=>{"use strict";var z1t=Uae&&Uae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},Mae=z1t(FFe());function Fae(t){return new Mae.default(t)}(function(t){t.HttpsProxyAgent=Mae.default,t.prototype=Mae.default.prototype})(Fae||(Fae={}));UFe.exports=Fae});var qFe=R(Bae=>{"use strict";Object.defineProperty(Bae,"__esModule",{value:!0});function $1t(t,e,{signal:r}={}){return new Promise((n,o)=>{function s(){r?.removeEventListener("abort",s),t.removeListener(e,a),t.removeListener("error",c)}function a(...l){s(),n(l)}function c(l){s(),o(l)}r?.addEventListener("abort",s),t.on(e,a),t.on("error",c)})}Bae.default=$1t});var jFe=R(PS=>{"use strict";var W1t=PS&&PS.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},g4=PS&&PS.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(PS,"__esModule",{value:!0});var K1t=g4(require("net")),Y1t=g4(require("tls")),qae=g4(require("url")),Q1t=g4(Pd()),X1t=g4(qFe()),J1t=Lae(),$y=(0,Q1t.default)("http-proxy-agent");function Z1t(t){return typeof t=="string"?/^https:?$/i.test(t):!1}var jae=class extends J1t.Agent{constructor(e){let r;if(typeof e=="string"?r=qae.default.parse(e):r=e,!r)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");$y("Creating new HttpProxyAgent instance: %o",r),super(r);let n=Object.assign({},r);this.secureProxy=r.secureProxy||Z1t(n.protocol),n.host=n.hostname||n.host,typeof n.port=="string"&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,r){return W1t(this,void 0,void 0,function*(){let{proxy:n,secureProxy:o}=this,s=qae.default.parse(e.path);s.protocol||(s.protocol="http:"),s.hostname||(s.hostname=r.hostname||r.host||null),s.port==null&&typeof r.port&&(s.port=String(r.port)),s.port==="80"&&(s.port=""),e.path=qae.default.format(s),n.auth&&e.setHeader("Proxy-Authorization",`Basic ${Buffer.from(n.auth).toString("base64")}`);let a;if(o?($y("Creating `tls.Socket`: %o",n),a=Y1t.default.connect(n)):($y("Creating `net.Socket`: %o",n),a=K1t.default.connect(n)),e._header){let c,l;$y("Regenerating stored HTTP header string for request"),e._header=null,e._implicitHeader(),e.output&&e.output.length>0?($y("Patching connection write() output buffer with updated header"),c=e.output[0],l=c.indexOf(`\r
\r
`)+4,e.output[0]=e._header+c.substring(l),$y("Output buffer: %o",e.output)):e.outputData&&e.outputData.length>0&&($y("Patching connection write() output buffer with updated header"),c=e.outputData[0].data,l=c.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+c.substring(l),$y("Output buffer: %o",e.outputData[0].data))}return yield(0,X1t.default)(a,"connect"),a})}};PS.default=jae});var HFe=R((Gae,VFe)=>{"use strict";var eIt=Gae&&Gae.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},Vae=eIt(jFe());function Hae(t){return new Vae.default(t)}(function(t){t.HttpProxyAgent=Vae.default,t.prototype=Vae.default.prototype})(Hae||(Hae={}));VFe.exports=Hae});function yV(t){if(process.env[t])return process.env[t];if(process.env[t.toLowerCase()])return process.env[t.toLowerCase()]}function sIt(){if(!process)return;let t=yV(tIt),e=yV(nIt),r=yV(rIt);return t||e||r}function aIt(t,e,r){if(e.length===0)return!1;let n=new URL(t).hostname;if(r?.has(n))return r.get(n);let o=!1;for(let s of e)s[0]==="."?(n.endsWith(s)||n.length===s.length-1&&n===s.slice(1))&&(o=!0):n===s&&(o=!0);return r?.set(n,o),o}function cIt(){let t=yV(iIt);return KFe=!0,t?t.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function $ae(t){if(!t&&(t=sIt(),!t))return;let e=new URL(t);return{host:(e.protocol?e.protocol+"//":"")+e.hostname,port:Number.parseInt(e.port||"80"),username:e.username,password:e.password}}function zFe(t,{headers:e,tlsSettings:r}){let n;try{n=new URL(t.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${t.host}".`)}r&&Ys.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let o={hostname:n.hostname,port:t.port,protocol:n.protocol,headers:e.toJSON()};return t.username&&t.password?o.auth=`${t.username}:${t.password}`:t.username&&(o.auth=`${t.username}`),o}function lIt(t,e){if(t.agent)return;let n=new URL(t.url).protocol!=="https:",o=t.proxySettings;if(o)if(n){if(!e.httpProxyAgent){let s=zFe(o,t);e.httpProxyAgent=new WFe.HttpProxyAgent(s)}t.agent=e.httpProxyAgent}else{if(!e.httpsProxyAgent){let s=zFe(o,t);e.httpsProxyAgent=new $Fe.HttpsProxyAgent(s)}t.agent=e.httpsProxyAgent}}function bV(t=$ae(),e){KFe||GFe.push(...cIt());let r={};return{name:zae,async sendRequest(n,o){var s;return!n.proxySettings&&!aIt(n.url,(s=e?.customNoProxyList)!==null&&s!==void 0?s:GFe,e?.customNoProxyList?void 0:oIt)&&(n.proxySettings=t),n.proxySettings&&lIt(n,r),o(n)}}}var $Fe,WFe,tIt,rIt,nIt,iIt,zae,GFe,KFe,oIt,Wae=D(()=>{$Fe=q(BFe()),WFe=q(HFe());vR();tIt="HTTPS_PROXY",rIt="HTTP_PROXY",nIt="ALL_PROXY",iIt="NO_PROXY",zae="proxyPolicy",GFe=[],KFe=!1,oIt=new Map});function _V(t="x-ms-client-request-id"){return{name:Kae,async sendRequest(e,r){return e.headers.has(t)||e.headers.set(t,e.requestId),r(e)}}}var Kae,Yae=D(()=>{Kae="setClientRequestIdPolicy"});function xV(t){return{name:Qae,sendRequest:async(e,r)=>(e.tlsSettings||(e.tlsSettings=t),r(e))}}var Qae,Xae=D(()=>{Qae="tlsPolicy"});function YFe(t={}){let e=new Jae(t.parentContext);return t.span&&(e=e.setValue(wR.span,t.span)),t.namespace&&(e=e.setValue(wR.namespace,t.namespace)),e}var wR,Jae,Zae=D(()=>{wR={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};Jae=class t{constructor(e){this._contextMap=e instanceof t?new Map(e._contextMap):new Map}setValue(e,r){let n=new t(this);return n._contextMap.set(e,r),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let r=new t(this);return r._contextMap.delete(e),r}}});function uIt(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function dIt(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(t,e)=>({span:uIt(),tracingContext:YFe({parentContext:e.tracingContext})}),withContext(t,e,...r){return e(...r)}}}function v4(){return ece||(ece=dIt()),ece}var ece,QFe=D(()=>{Zae()});function tce(t){let{namespace:e,packageName:r,packageVersion:n}=t;function o(u,d,p){var f;let m=v4().startSpan(u,Object.assign(Object.assign({},p),{packageName:r,packageVersion:n,tracingContext:(f=d?.tracingOptions)===null||f===void 0?void 0:f.tracingContext})),h=m.tracingContext,g=m.span;h.getValue(wR.namespace)||(h=h.setValue(wR.namespace,e)),g.setAttribute("az.namespace",h.getValue(wR.namespace));let v=Object.assign({},d,{tracingOptions:Object.assign(Object.assign({},d?.tracingOptions),{tracingContext:h})});return{span:g,updatedOptions:v}}async function s(u,d,p,f){let{span:m,updatedOptions:h}=o(u,d,f);try{let g=await a(h.tracingOptions.tracingContext,()=>Promise.resolve(p(h,m)));return m.setStatus({status:"success"}),g}catch(g){throw m.setStatus({status:"error",error:g}),g}finally{m.end()}}function a(u,d,...p){return v4().withContext(u,d,...p)}function c(u){return v4().parseTraceparentHeader(u)}function l(u){return v4().createRequestHeaders(u)}return{startSpan:o,withSpan:s,withContext:a,parseTraceparentHeader:c,createRequestHeaders:l}}var XFe=D(()=>{QFe();Zae()});var JFe=D(()=>{XFe()});var ZFe,e5e,t5e=D(()=>{ZFe=require("util"),e5e=ZFe.inspect.custom});function SV(t){return t instanceof Cl?!0:bR(t)&&t.name==="RestError"}var pIt,Cl,IV=D(()=>{xR();t5e();sae();pIt=new SR,Cl=class t extends Error{constructor(e,r={}){super(e),this.name="RestError",this.code=r.code,this.statusCode=r.statusCode,this.request=r.request,this.response=r.response,Object.setPrototypeOf(this,t.prototype)}[e5e](){return`RestError: ${this.message} 
 ${pIt.sanitize(this)}`}};Cl.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";Cl.PARSE_ERROR="PARSE_ERROR"});function CV(t={}){let e=oV(t.userAgentPrefix),r=fIt();return{name:rce,async sendRequest(n,o){var s,a;if(!r||!(!((s=n.tracingOptions)===null||s===void 0)&&s.tracingContext))return o(n);let{span:c,tracingContext:l}=(a=mIt(r,n,e))!==null&&a!==void 0?a:{};if(!c||!l)return o(n);try{let u=await r.withContext(l,o,n);return gIt(c,u),u}catch(u){throw hIt(c,u),u}}}}function fIt(){try{return tce({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:iV})}catch(t){Ys.warning(`Error when creating the TracingClient: ${_R(t)}`);return}}function mIt(t,e,r){try{let{span:n,updatedOptions:o}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":e.method,"http.url":e.url,requestId:e.requestId}});if(!n.isRecording()){n.end();return}r&&n.setAttribute("http.user_agent",r);let s=t.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,c]of Object.entries(s))e.headers.set(a,c);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){Ys.warning(`Skipping creating a tracing span due to an error: ${_R(n)}`);return}}function hIt(t,e){try{t.setStatus({status:"error",error:bR(e)?e:void 0}),SV(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(r){Ys.warning(`Skipping tracing span processing due to an error: ${_R(r)}`)}}function gIt(t,e){try{t.setAttribute("http.status_code",e.status);let r=e.headers.get("x-ms-request-id");r&&t.setAttribute("serviceRequestId",r),t.setStatus({status:"success"}),t.end()}catch(r){Ys.warning(`Skipping tracing span processing due to an error: ${_R(r)}`)}}var rce,nce=D(()=>{JFe();dae();pae();vR();xR();IV();rce="tracingPolicy"});function r5e(t){let e=Kj();return Zj&&(t.tlsOptions&&e.addPolicy(xV(t.tlsOptions)),e.addPolicy(bV(t.proxyOptions)),e.addPolicy(aV())),e.addPolicy(gV()),e.addPolicy(sV(t.userAgentOptions)),e.addPolicy(_V()),e.addPolicy(fV(t.retryOptions),{phase:"Retry"}),e.addPolicy(CV(t.userAgentOptions),{afterPhase:"Retry"}),Zj&&e.addPolicy(nV(t.redirectOptions),{afterPhase:"Retry"}),e.addPolicy(rV(t.loggingOptions),{afterPhase:"Sign"}),e}var n5e=D(()=>{cae();$se();uae();mae();gae();yae();Pae();xR();Wae();Yae();Xae();nce()});function TV(t){return t.toLowerCase()}function*vIt(t){for(let e of t.values())yield[e.name,e.value]}function kR(t){return new ice(t)}var ice,EV=D(()=>{ice=class{constructor(e){if(this._headersMap=new Map,e)for(let r of Object.keys(e))this.set(r,e[r])}set(e,r){this._headersMap.set(TV(e),{name:e,value:String(r)})}get(e){var r;return(r=this._headersMap.get(TV(e)))===null||r===void 0?void 0:r.value}has(e){return this._headersMap.has(TV(e))}delete(e){this._headersMap.delete(TV(e))}toJSON(e={}){let r={};if(e.preserveCase)for(let n of this._headersMap.values())r[n.name]=n.value;else for(let[n,o]of this._headersMap)r[n]=o.value;return r}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return vIt(this._headersMap)}}});function y4(t){return t&&typeof t.pipe=="function"}function i5e(t){return new Promise(e=>{t.on("close",e),t.on("end",e),t.on("error",e)})}function s5e(t){return t&&typeof t.byteLength=="number"}function bIt(t){let e=kR();for(let r of Object.keys(t.headers)){let n=t.headers[r];Array.isArray(n)?n.length>0&&e.set(r,n[0]):n&&e.set(r,n)}return e}function _It(t,e){let r=e.get("Content-Encoding");if(r==="gzip"){let n=kV.createGunzip();return t.pipe(n),n}else if(r==="deflate"){let n=kV.createInflate();return t.pipe(n),n}return t}function xIt(t){return new Promise((e,r)=>{let n=[];t.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),t.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),t.on("error",o=>{o&&o?.name==="AbortError"?r(o):r(new Cl(`Error reading response as text: ${o.message}`,{code:Cl.PARSE_ERROR}))})})}function SIt(t){return t?Buffer.isBuffer(t)?t.length:y4(t)?null:s5e(t)?t.byteLength:typeof t=="string"?Buffer.from(t).length:null:0}function a5e(){return new oce}var RR,PR,kV,o5e,yIt,wV,oce,c5e=D(()=>{RR=q(require("http")),PR=q(require("https")),kV=q(require("zlib")),o5e=require("stream");tV();EV();IV();vR();yIt={};wV=class extends o5e.Transform{constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}_transform(e,r,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}},oce=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var r,n,o;let s=new l4,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new qf("The operation was aborted.");a=p=>{p.type==="abort"&&s.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{s.abort()},e.timeout);let c=e.headers.get("Accept-Encoding"),l=c?.includes("gzip")||c?.includes("deflate"),u=typeof e.body=="function"?e.body():e.body;if(u&&!e.headers.has("Content-Length")){let p=SIt(u);p!==null&&e.headers.set("Content-Length",p)}let d;try{if(u&&e.onUploadProgress){let v=e.onUploadProgress,b=new wV(v);b.on("error",_=>{Ys.error("Error in upload progress",_)}),y4(u)?u.pipe(b):b.end(u),u=b}let p=await this.makeRequest(e,s,u),f=bIt(p),h={status:(r=p.statusCode)!==null&&r!==void 0?r:0,headers:f,request:e};if(e.method==="HEAD")return p.resume(),h;d=l?_It(p,f):p;let g=e.onDownloadProgress;if(g){let v=new wV(g);v.on("error",b=>{Ys.error("Error in download progress",b)}),d.pipe(v),d=v}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(h.status)?h.readableStreamBody=d:h.bodyAsText=await xIt(d),h}finally{if(e.abortSignal&&a){let p=Promise.resolve();y4(u)&&(p=i5e(u));let f=Promise.resolve();y4(d)&&(f=i5e(d)),Promise.all([p,f]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{Ys.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,r,n){var o;let s=new URL(e.url),a=s.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let l={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:s.hostname,path:`${s.pathname}${s.search}`,port:s.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((u,d)=>{let p=a?RR.request(l,u):PR.request(l,u);p.once("error",f=>{var m;d(new Cl(f.message,{code:(m=f.code)!==null&&m!==void 0?m:Cl.REQUEST_SEND_ERROR,request:e}))}),r.signal.addEventListener("abort",()=>{let f=new qf("The operation was aborted.");p.destroy(f),d(f)}),n&&y4(n)?n.pipe(p):n?typeof n=="string"||Buffer.isBuffer(n)?p.end(n):s5e(n)?p.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(Ys.error("Unrecognized body type",n),d(new Cl("Unrecognized body type"))):p.end()})}getOrCreateAgent(e,r){var n;let o=e.disableKeepAlive;if(r)return o?RR.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new RR.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return PR.globalAgent;let s=(n=e.tlsSettings)!==null&&n!==void 0?n:yIt,a=this.cachedHttpsAgents.get(s);return a&&a.options.keepAlive===!o||(Ys.info("No cached TLS Agent exist, creating a new Agent"),a=new PR.Agent(Object.assign({keepAlive:!o},s)),this.cachedHttpsAgents.set(s,a)),a}}}});function l5e(){return a5e()}var u5e=D(()=>{c5e()});function sce(){return RV>PV.length-16&&(d5e.default.randomFillSync(PV),RV=0),PV.slice(RV,RV+=16)}var d5e,PV,RV,p5e=D(()=>{d5e=q(require("crypto")),PV=new Uint8Array(256),RV=PV.length});var f5e,m5e=D(()=>{f5e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function IIt(t){return typeof t=="string"&&f5e.test(t)}var h5e,g5e=D(()=>{m5e();h5e=IIt});function CIt(t,e=0){let r=(Qs[t[e+0]]+Qs[t[e+1]]+Qs[t[e+2]]+Qs[t[e+3]]+"-"+Qs[t[e+4]]+Qs[t[e+5]]+"-"+Qs[t[e+6]]+Qs[t[e+7]]+"-"+Qs[t[e+8]]+Qs[t[e+9]]+"-"+Qs[t[e+10]]+Qs[t[e+11]]+Qs[t[e+12]]+Qs[t[e+13]]+Qs[t[e+14]]+Qs[t[e+15]]).toLowerCase();if(!h5e(r))throw TypeError("Stringified UUID is invalid");return r}var Qs,v5e,y5e=D(()=>{g5e();Qs=[];for(let t=0;t<256;++t)Qs.push((t+256).toString(16).substr(1));v5e=CIt});function TIt(t,e,r){t=t||{};let n=t.random||(t.rng||sce)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let o=0;o<16;++o)e[r+o]=n[o];return e}return v5e(n)}var ace,b5e=D(()=>{p5e();y5e();ace=TIt});var _5e=D(()=>{b5e()});function x5e(){return ace()}var S5e=D(()=>{_5e()});function I5e(t){return new cce(t)}var cce,C5e=D(()=>{EV();S5e();cce=class{constructor(e){var r,n,o,s,a,c,l;this.url=e.url,this.body=e.body,this.headers=(r=e.headers)!==null&&r!==void 0?r:kR(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.formData=e.formData,this.disableKeepAlive=(s=e.disableKeepAlive)!==null&&s!==void 0?s:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||x5e(),this.allowInsecureConnection=(c=e.allowInsecureConnection)!==null&&c!==void 0?c:!1,this.enableBrowserStreams=(l=e.enableBrowserStreams)!==null&&l!==void 0?l:!1}}});function E5e(t={}){var e;return jf([CR(Object.assign(Object.assign({},t),{ignoreSystemErrors:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3})}var T5e,w5e=D(()=>{pV();TR();T5e="exponentialRetryPolicy"});function k5e(t={}){var e;return{name:lce,sendRequest:jf([CR(Object.assign(Object.assign({},t),{ignoreHttpStatusCodes:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var lce,R5e=D(()=>{pV();TR();lce="systemErrorRetryPolicy"});function P5e(t={}){var e;return{name:uce,sendRequest:jf([uV()],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var uce,A5e=D(()=>{dV();TR();uce="throttlingRetryPolicy"});async function wIt(t,e,r){async function n(){if(Date.now()<r)try{return await t()}catch{return null}else{let s=await t();if(s===null)throw new Error("Failed to refresh access token.");return s}}let o=await n();for(;o===null;)await cV(e),o=await n();return o}function D5e(t,e){let r=null,n=null,o,s=Object.assign(Object.assign({},EIt),e),a={get isRefreshing(){return r!==null},get shouldRefresh(){var l;return!a.isRefreshing&&((l=n?.expiresOnTimestamp)!==null&&l!==void 0?l:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function c(l,u){var d;return a.isRefreshing||(r=wIt(()=>t.getToken(l,u),s.retryIntervalInMs,(d=n?.expiresOnTimestamp)!==null&&d!==void 0?d:Date.now()).then(f=>(r=null,n=f,o=u.tenantId,n)).catch(f=>{throw r=null,n=null,o=void 0,f})),r}return async(l,u)=>o!==u.tenantId||!!u.claims||a.mustRefresh?c(l,u):(a.shouldRefresh&&c(l,u),n)}var EIt,N5e=D(()=>{lV();EIt={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2}});async function kIt(t){let{scopes:e,getAccessToken:r,request:n}=t,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions},s=await r(e,o);s&&t.request.headers.set("Authorization",`Bearer ${s.token}`)}function RIt(t){let e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function L5e(t){var e;let{credential:r,scopes:n,challengeCallbacks:o}=t,s=t.logger||Ys,a=Object.assign({authorizeRequest:(e=o?.authorizeRequest)!==null&&e!==void 0?e:kIt,authorizeRequestOnChallenge:o?.authorizeRequestOnChallenge},o),c=r?D5e(r):()=>Promise.resolve(null);return{name:dce,async sendRequest(l,u){if(!l.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await a.authorizeRequest({scopes:Array.isArray(n)?n:[n],request:l,getAccessToken:c,logger:s});let d,p;try{d=await u(l)}catch(f){p=f,d=f.response}if(a.authorizeRequestOnChallenge&&d?.status===401&&RIt(d)&&await a.authorizeRequestOnChallenge({scopes:Array.isArray(n)?n:[n],request:l,response:d,getAccessToken:c,logger:s}))return u(l);if(p)throw p;return d}}}var dce,O5e=D(()=>{N5e();vR();dce="bearerTokenAuthenticationPolicy"});function M5e(){return{name:pce,async sendRequest(t,e){if(typeof t.body=="string"&&t.body.startsWith("[")){let r=JSON.parse(t.body);Array.isArray(r)&&(t.body=r.map(n=>JSON.stringify(n)+`
`).join(""))}return e(t)}}}var pce,F5e=D(()=>{pce="ndJsonPolicy"});var U5e={};Pn(U5e,{RestError:()=>Cl,bearerTokenAuthenticationPolicy:()=>L5e,bearerTokenAuthenticationPolicyName:()=>dce,createDefaultHttpClient:()=>l5e,createEmptyPipeline:()=>Kj,createHttpHeaders:()=>kR,createPipelineFromOptions:()=>r5e,createPipelineRequest:()=>I5e,decompressResponsePolicy:()=>aV,decompressResponsePolicyName:()=>hae,defaultRetryPolicy:()=>fV,exponentialRetryPolicy:()=>E5e,exponentialRetryPolicyName:()=>T5e,formDataPolicy:()=>gV,formDataPolicyName:()=>Rae,getDefaultProxySettings:()=>$ae,isRestError:()=>SV,logPolicy:()=>rV,logPolicyName:()=>aae,ndJsonPolicy:()=>M5e,ndJsonPolicyName:()=>pce,proxyPolicy:()=>bV,proxyPolicyName:()=>zae,redirectPolicy:()=>nV,redirectPolicyName:()=>lae,retryPolicy:()=>jf,setClientRequestIdPolicy:()=>_V,setClientRequestIdPolicyName:()=>Kae,systemErrorRetryPolicy:()=>k5e,systemErrorRetryPolicyName:()=>lce,throttlingRetryPolicy:()=>P5e,throttlingRetryPolicyName:()=>uce,tlsPolicy:()=>xV,tlsPolicyName:()=>Qae,tracingPolicy:()=>CV,tracingPolicyName:()=>rce,userAgentPolicy:()=>sV,userAgentPolicyName:()=>fae});var B5e=D(()=>{$se();n5e();u5e();EV();C5e();IV();gae();w5e();Yae();cae();Wae();uae();R5e();A5e();TR();nce();yae();mae();Xae();Pae();O5e();F5e()});var V5e=R((b4,j5e)=>{"use strict";var PIt=b4&&b4.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},AIt=b4&&b4.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},q5e=(B5e(),fo(U5e)),DIt="https://monitor.azure.com//.default";function NIt(t){return null}var LIt=function(){function t(e,r){var n=r?[r]:[DIt];this._azureTokenPolicy=q5e.bearerTokenAuthenticationPolicy({credential:e,scopes:n})}return t.prototype.addAuthorizationHeader=function(e){return PIt(this,void 0,void 0,function(){var r,n;return AIt(this,function(o){switch(o.label){case 0:return r="authorization",n=q5e.createPipelineRequest({url:"https://"}),[4,this._azureTokenPolicy.sendRequest(n,NIt)];case 1:return o.sent(),e.headers[r]=n.headers.get(r),[2]}})})},t}();j5e.exports=LIt});var G5e=R((Otn,H5e)=>{"use strict";var OIt=ri(),MIt=zs(),FIt=function(){function t(e,r,n,o){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=o}return t.prototype.setUseDiskRetryCaching=function(e,r,n){this._sender.setDiskRetryMode(e,r,n)},t.prototype.send=function(e){var r=this;if(!this._isDisabled()){if(!e){OIt.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(e),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}},t.prototype.triggerSend=function(e,r){var n=this._buffer.length<1;n||(e||MIt.isNodeExit?(this._sender.saveOnCrash(this._buffer),typeof r=="function"&&r("data saved on crash")):this._sender.send(this._buffer,r)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},t}();H5e.exports=FIt});var z5e=R(AV=>{"use strict";Object.defineProperty(AV,"__esModule",{value:!0});AV.azureRoleEnvironmentTelemetryProcessor=void 0;function UIt(t,e){}AV.azureRoleEnvironmentTelemetryProcessor=UIt});var K5e=R(AR=>{"use strict";Object.defineProperty(AR,"__esModule",{value:!0});AR.getSamplingHashCode=AR.samplingTelemetryProcessor=void 0;var $5e=ma();function BIt(t,e){var r=t.sampleRate,n=!1;return r==null||r>=100||t.data&&$5e.TelemetryType.Metric===$5e.baseTypeToTelemetryType(t.data.baseType)?!0:(e.correlationContext&&e.correlationContext.operation?n=W5e(e.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}AR.samplingTelemetryProcessor=BIt;function W5e(t){var e=-2147483648,r=2147483647,n=5381;if(!t)return 0;for(;t.length<8;)t=t+t;for(var o=0;o<t.length;o++)n=((n<<5)+n|0)+t.charCodeAt(o)|0;return n=n<=e?r:Math.abs(n),n/r*100}AR.getSamplingHashCode=W5e});var Y5e=R(DV=>{"use strict";Object.defineProperty(DV,"__esModule",{value:!0});DV.performanceMetricsTelemetryProcessor=void 0;var fce=Lj(),mce=ma();function qIt(t,e){switch(e&&e.addDocument(t),t.data.baseType){case mce.TelemetryTypeString.Exception:fce.countException();break;case mce.TelemetryTypeString.Request:var r=t.data.baseData;fce.countRequest(r.duration,r.success);break;case mce.TelemetryTypeString.Dependency:var n=t.data.baseData;fce.countDependency(n.duration,n.success);break}return!0}DV.performanceMetricsTelemetryProcessor=qIt});var Q5e=R(DR=>{"use strict";var Vf=DR&&DR.__assign||function(){return Vf=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Vf.apply(this,arguments)};Object.defineProperty(DR,"__esModule",{value:!0});DR.preAggregatedMetricsTelemetryProcessor=void 0;var jIt=ma(),_4=Ise(),NV=ma();function VIt(t,e){if(_4.isEnabled())switch(t.data.baseType){case NV.TelemetryTypeString.Exception:var r=t.data.baseData;r.properties=Vf(Vf({},r.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var n={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole]};_4.countException(n);break;case NV.TelemetryTypeString.Trace:var o=t.data.baseData;o.properties=Vf(Vf({},o.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var s={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],traceSeverityLevel:jIt.SeverityLevel[o.severity]};_4.countTrace(s);break;case NV.TelemetryTypeString.Request:var a=t.data.baseData;a.properties=Vf(Vf({},a.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var c={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],operationSynthetic:t.tags[e.keys.operationSyntheticSource],requestSuccess:a.success,requestResultCode:a.responseCode};_4.countRequest(a.duration,c);break;case NV.TelemetryTypeString.Dependency:var l=t.data.baseData;l.properties=Vf(Vf({},l.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var u={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],operationSynthetic:t.tags[e.keys.operationSyntheticSource],dependencySuccess:l.success,dependencyType:l.type,dependencyTarget:l.target,dependencyResultCode:l.resultCode};_4.countDependency(l.duration,u);break}return!0}DR.preAggregatedMetricsTelemetryProcessor=VIt});var X5e=R(Hf=>{"use strict";var HIt=Hf&&Hf.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),LV=Hf&&Hf.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&HIt(e,t,r)};Object.defineProperty(Hf,"__esModule",{value:!0});LV(z5e(),Hf);LV(K5e(),Hf);LV(Y5e(),Hf);LV(Q5e(),Hf)});var hce=R((jtn,e6e)=>{"use strict";var zt=ma(),Mc=zs(),J5e=Ny(),GIt=ri(),zIt=function(){function t(){}return t.createEnvelope=function(e,r,n,o,s){var a=null;switch(r){case zt.TelemetryType.Trace:a=t.createTraceData(e);break;case zt.TelemetryType.Dependency:a=t.createDependencyData(e);break;case zt.TelemetryType.Event:a=t.createEventData(e);break;case zt.TelemetryType.Exception:a=t.createExceptionData(e);break;case zt.TelemetryType.Request:a=t.createRequestData(e);break;case zt.TelemetryType.Metric:a=t.createMetricData(e);break;case zt.TelemetryType.Availability:a=t.createAvailabilityData(e);break;case zt.TelemetryType.PageView:a=t.createPageViewData(e);break}if(a&&a.baseData&&zt.domainSupportsProperties(a.baseData)){if(n)if(!a.baseData.properties)a.baseData.properties=n;else for(var c in n)a.baseData.properties[c]||(a.baseData.properties[c]=n[c]);t.addAzureFunctionsCorrelationProperties(a.baseData.properties),a.baseData.properties&&(a.baseData.properties=Mc.validateStringMap(a.baseData.properties))}var l=s&&s.instrumentationKey||"",u=new zt.Envelope;return u.data=a,u.iKey=l,u.name="Microsoft.ApplicationInsights."+l.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),u.tags=this.getTags(o,e.tagOverrides),u.time=new Date().toISOString(),u.ver=1,u.sampleRate=s?s.samplingPercentage:100,r===zt.TelemetryType.Metric&&(u.sampleRate=100),u},t.addAzureFunctionsCorrelationProperties=function(e){var r=J5e.CorrelationContextManager.getCurrentContext();if(r&&r.customProperties&&r.customProperties.getProperty instanceof Function){e=e||{};var n=r.customProperties.getProperty("InvocationId");n&&(e.InvocationId=n),n=r.customProperties.getProperty("ProcessId"),n&&(e.ProcessId=n),n=r.customProperties.getProperty("LogLevel"),n&&(e.LogLevel=n),n=r.customProperties.getProperty("Category"),n&&(e.Category=n),n=r.customProperties.getProperty("HostInstanceId"),n&&(e.HostInstanceId=n),n=r.customProperties.getProperty("AzFuncLiveLogsSessionId"),n&&(e.AzFuncLiveLogsSessionId=n)}},t.truncateProperties=function(e){if(e.properties)try{for(var r={},n=Object.keys(e.properties),o=Object.values(e.properties),s=0;s<n.length;s++)n[s].length<=150&&(Mc.isDate(o[s])||(o[s]==null&&(o[s]=""),typeof o[s]=="object"&&(o[s]=Mc.stringify(o[s])),r[n[s]]=String(o[s]).substring(0,8192)),r[n[s]]=o[s]);return r}catch(a){GIt.warn("Failed to properly truncate telemetry properties: ",a)}},t.createTraceData=function(e){var r,n=new zt.MessageData;n.message=(r=e.message)===null||r===void 0?void 0:r.substring(0,32768),n.properties=this.truncateProperties(e),isNaN(e.severity)?n.severityLevel=zt.SeverityLevel.Information:n.severityLevel=e.severity;var o=new zt.Data;return o.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.Trace),o.baseData=n,o},t.createDependencyData=function(e){var r,n,o,s=new zt.RemoteDependencyData;s.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),s.data=(n=e.data)===null||n===void 0?void 0:n.substring(0,8192),s.target=(o=e.target)===null||o===void 0?void 0:o.substring(0,1024),s.duration=Mc.msToTimeSpan(e.duration),s.success=e.success,s.type=e.dependencyTypeName,s.properties=this.truncateProperties(e),s.resultCode=e.resultCode?e.resultCode.toString():"0",e.id?s.id=e.id:s.id=Mc.w3cTraceId();var a=new zt.Data;return a.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.Dependency),a.baseData=s,a},t.createEventData=function(e){var r,n=new zt.EventData;n.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,512),n.properties=this.truncateProperties(e),n.measurements=e.measurements;var o=new zt.Data;return o.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.Event),o.baseData=n,o},t.createExceptionData=function(e){var r,n,o=new zt.ExceptionData;o.properties=this.truncateProperties(e),isNaN(e.severity)?o.severityLevel=zt.SeverityLevel.Error:o.severityLevel=e.severity,o.measurements=e.measurements,o.exceptions=[];var s=e.exception.stack,a=new zt.ExceptionDetails;a.message=(r=e.exception.message)===null||r===void 0?void 0:r.substring(0,32768),a.typeName=(n=e.exception.name)===null||n===void 0?void 0:n.substring(0,1024),a.parsedStack=this.parseStack(s),a.hasFullStack=Mc.isArray(a.parsedStack)&&a.parsedStack.length>0,o.exceptions.push(a);var c=new zt.Data;return c.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.Exception),c.baseData=o,c},t.createRequestData=function(e){var r,n,o,s,a=new zt.RequestData;e.id?a.id=e.id:a.id=Mc.w3cTraceId(),a.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),a.url=(n=e.url)===null||n===void 0?void 0:n.substring(0,2048),a.source=(o=e.source)===null||o===void 0?void 0:o.substring(0,1024),a.duration=Mc.msToTimeSpan(e.duration),a.responseCode=(s=e.resultCode?e.resultCode.toString():"0")===null||s===void 0?void 0:s.substring(0,1024),a.success=e.success,a.properties=this.truncateProperties(e),a.measurements=e.measurements;var c=new zt.Data;return c.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.Request),c.baseData=a,c},t.createMetricData=function(e){var r,n=new zt.MetricData;n.metrics=[];var o=new zt.DataPoint;o.count=isNaN(e.count)?1:e.count,o.kind=zt.DataPointType.Aggregation,o.max=isNaN(e.max)?e.value:e.max,o.min=isNaN(e.min)?e.value:e.min,o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.stdDev=isNaN(e.stdDev)?0:e.stdDev,o.value=e.value,o.ns=e.namespace,n.metrics.push(o),n.properties=this.truncateProperties(e);var s=new zt.Data;return s.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.Metric),s.baseData=n,s},t.createAvailabilityData=function(e){var r,n,o=new zt.AvailabilityData;e.id?o.id=e.id:o.id=Mc.w3cTraceId(),o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.duration=Mc.msToTimeSpan(e.duration),o.success=e.success,o.runLocation=e.runLocation,o.message=(n=e.message)===null||n===void 0?void 0:n.substring(0,8192),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new zt.Data;return s.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.Availability),s.baseData=o,s},t.createPageViewData=function(e){var r,n,o=new zt.PageViewData;o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.duration=Mc.msToTimeSpan(e.duration),o.url=(n=e.url)===null||n===void 0?void 0:n.substring(0,2048),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new zt.Data;return s.baseType=zt.telemetryTypeToBaseType(zt.TelemetryType.PageView),s.baseData=o,s},t.getTags=function(e,r){var n=J5e.CorrelationContextManager.getCurrentContext(),o={};if(e&&e.tags)for(var s in e.tags)o[s]=e.tags[s];if(r)for(var s in r)o[s]=r[s];return n&&(o[e.keys.operationId]=o[e.keys.operationId]||n.operation.id,o[e.keys.operationName]=o[e.keys.operationName]||n.operation.name,o[e.keys.operationParentId]=o[e.keys.operationParentId]||n.operation.parentId),o},t.parseStack=function(e){var r=void 0;if(typeof e=="string"){var n=e.split(`
`);r=[];for(var o=0,s=0,a=0;a<=n.length;a++){var c=n[a];if(Z5e.regex.test(c)){var l=new Z5e(n[a],o++);s+=l.sizeInBytes,r.push(l)}}var u=32*1024;if(s>u)for(var d=0,p=r.length-1,f=0,m=d,h=p;d<p;){var g=r[d].sizeInBytes,v=r[p].sizeInBytes;if(f+=g+v,f>u){var b=h-m+1;r.splice(m,b);break}m=d,h=p,d++,p--}}return r},t}(),Z5e=function(){function t(e,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=Mc.trim(e);var n=e.match(t.regex);n&&n.length>=5&&(this.method=Mc.trim(n[2])||this.method,this.fileName=Mc.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=t.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return t.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,t.baseSize=58,t}();e6e.exports=zIt});var t6e=R(Wy=>{"use strict";var $It=Wy&&Wy.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},WIt=Wy&&Wy.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Wy,"__esModule",{value:!0});Wy.FileAccessControl=void 0;var KIt=require("fs"),YIt=require("os"),NR=require("child_process"),QIt=ri(),XIt=function(){function t(){}return t.checkFileProtection=function(){if(!t.OS_PROVIDES_FILE_PROTECTION&&!t.OS_FILE_PROTECTION_CHECKED)if(t.OS_FILE_PROTECTION_CHECKED=!0,t.USE_ICACLS){try{t.OS_PROVIDES_FILE_PROTECTION=KIt.existsSync(t.ICACLS_PATH)}catch{}t.OS_PROVIDES_FILE_PROTECTION||QIt.warn(t.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else t.OS_PROVIDES_FILE_PROTECTION=!0},t.applyACLRules=function(e){return $It(this,void 0,void 0,function(){var r,n;return WIt(this,function(o){switch(o.label){case 0:if(!t.USE_ICACLS)return[3,7];if(t.ACLED_DIRECTORIES[e]!==void 0)return[3,6];t.ACLED_DIRECTORIES[e]=!1,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this._getACLIdentity()];case 2:return r=o.sent(),[4,this._runICACLS(this._getACLArguments(e,r))];case 3:return o.sent(),t.ACLED_DIRECTORIES[e]=!0,[3,5];case 4:throw n=o.sent(),t.ACLED_DIRECTORIES[e]=!1,n;case 5:return[3,7];case 6:if(!t.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)");o.label=7;case 7:return[2]}})})},t.applyACLRulesSync=function(e){if(t.USE_ICACLS){if(t.ACLED_DIRECTORIES[e]===void 0){this._runICACLSSync(this._getACLArguments(e,this._getACLIdentitySync())),t.ACLED_DIRECTORIES[e]=!0;return}else if(!t.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},t._runICACLS=function(e){return new Promise(function(r,n){var o=NR.spawn(t.ICACLS_PATH,e,{windowsHide:!0});o.on("error",function(s){return n(s)}),o.on("close",function(s,a){s===0?r():n(new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+s+")"))})})},t._runICACLSSync=function(e){if(NR.spawnSync){var r=NR.spawnSync(t.ICACLS_PATH,e,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},t._getACLIdentity=function(){return new Promise(function(e,r){t.ACL_IDENTITY&&e(t.ACL_IDENTITY);var n=NR.spawn(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),o="";n.stdout.on("data",function(s){return o+=s}),n.on("error",function(s){return r(s)}),n.on("close",function(s,a){t.ACL_IDENTITY=o&&o.trim(),s===0?e(t.ACL_IDENTITY):r(new Error("Getting ACL identity did not succeed (PS returned code "+s+")"))})})},t._getACLIdentitySync=function(){if(t.ACL_IDENTITY)return t.ACL_IDENTITY;if(NR.spawnSync){var e=NR.spawnSync(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(e.error)throw e.error;if(e.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+e.status+")");return t.ACL_IDENTITY=e.stdout&&e.stdout.toString().trim(),t.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},t._getACLArguments=function(e,r){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},t.TAG="FileAccessControl",t.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",t.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",t.ACLED_DIRECTORIES={},t.ACL_IDENTITY=null,t.OS_FILE_PROTECTION_CHECKED=!1,t.OS_PROVIDES_FILE_PROTECTION=!1,t.USE_ICACLS=YIt.type()==="Windows_NT",t}();Wy.FileAccessControl=XIt});var vce=R((S4,n6e)=>{"use strict";var OV=S4&&S4.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},MV=S4&&S4.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},gce=require("fs"),JIt=require("os"),AS=require("path"),ZIt=require("zlib"),Ky=Ei(),eCt=mR(),Jh=Ure(),Fc=zs(),tCt=require("url"),r6e=ri(),x4=t6e(),rCt=439,nCt=402,iCt=[200,206,402,408,429,439,500],oCt=function(){function t(e,r,n,o,s,a,c){this._redirectedHost=null,this._config=e,this._onSuccess=n,this._onError=o,this._statsbeat=s,this._enableDiskRetryMode=!1,this._resendInterval=t.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=t.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._getAuthorizationHandler=r,this._fileCleanupTimer=null,this._tempDir=AS.join(JIt.tmpdir(),t.TEMPDIR_PREFIX+this._config.instrumentationKey),this._isStatsbeatSender=a||!1,this._shutdownStatsbeat=c,this._failedToIngestCounter=0,this._statsbeatHasReachedIngestionAtLeastOnce=!1}return t.prototype.setDiskRetryMode=function(e,r,n){var o=this;e&&x4.FileAccessControl.checkFileProtection(),this._enableDiskRetryMode=x4.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&e,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),e&&!x4.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,this._logWarn("Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?(this._statsbeat&&this._statsbeat.addFeature(Ky.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){o._fileCleanupTask()},t.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref())):(this._statsbeat&&this._statsbeat.removeFeature(Ky.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer))},t.prototype.send=function(e,r){return OV(this,void 0,void 0,function(){var n,o,s,a,c,l,u,d,p=this;return MV(this,function(f){switch(f.label){case 0:if(!e)return[3,5];if(n=this._redirectedHost||this._config.endpointUrl,o=new tCt.URL(n).hostname,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},a=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!a)return[3,4];this._statsbeat&&this._statsbeat.addFeature(Ky.StatsbeatFeature.AAD_HANDLING),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,a.addAuthorizationHeader(s)];case 2:return f.sent(),[3,4];case 3:return c=f.sent(),l="Failed to get AAD bearer token for the Application.",this._enableDiskRetryMode&&(l+="This batch of telemetry items will be retried. ",this._storeToDisk(e)),l+="Error:"+c.toString(),this._logWarn(l),typeof r=="function"&&r(l),[2];case 4:u="",e.forEach(function(m){var h=Fc.stringify(m);typeof h=="string"&&(u+=h+`
`)}),u.length>0&&(u=u.substring(0,u.length-1)),d=Buffer.from?Buffer.from(u):new Buffer(u),ZIt.gzip(d,function(m,h){var g=h;m?(p._logWarn(Fc.dumpObj(m)),g=d,s.headers["Content-Length"]=d.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=h.length.toString()),p._logInfo(Fc.dumpObj(s)),s[eCt.disableCollectionRequestOption]=!0;var v=+new Date,b=function(x){x.setEncoding("utf-8");var S="";x.on("data",function(I){S+=I}),x.on("end",function(){var I=+new Date,w=I-v;if(p._numConsecutiveFailures=0,p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&(iCt.includes(x.statusCode)?p._statsbeatHasReachedIngestionAtLeastOnce=!0:p._statsbeatFailedToIngest()),p._statsbeat&&(x.statusCode==nCt||x.statusCode==rCt?p._statsbeat.countThrottle(Ky.StatsbeatNetworkCategory.Breeze,o,x.statusCode):p._statsbeat.countRequest(Ky.StatsbeatNetworkCategory.Breeze,o,w,x.statusCode===200,x.statusCode)),p._enableDiskRetryMode){if(x.statusCode===200)p._resendTimer||(p._resendTimer=setTimeout(function(){p._resendTimer=null,p._sendFirstFileOnDisk()},p._resendInterval),p._resendTimer.unref());else if(p._isRetriable(x.statusCode))try{p._statsbeat&&p._statsbeat.countRetry(Ky.StatsbeatNetworkCategory.Breeze,o,x.statusCode);var k=JSON.parse(S),M=[];k.errors&&(k.errors.forEach(function(ue){(ue.statusCode==429||ue.statusCode==500||ue.statusCode==503)&&M.push(e[ue.index])}),M.length>0&&p._storeToDisk(M))}catch{p._storeToDisk(e)}}if(x.statusCode===307||x.statusCode===308)if(p._numConsecutiveRedirects++,p._numConsecutiveRedirects<10){var H=x.headers.location?x.headers.location.toString():null;H&&(p._redirectedHost=H,p.send(e,r))}else{var F={name:"Circular Redirect",message:"Error sending telemetry because of circular redirects."};p._statsbeat&&p._statsbeat.countException(Ky.StatsbeatNetworkCategory.Breeze,o,F),typeof r=="function"&&r("Error sending telemetry because of circular redirects.")}else p._numConsecutiveRedirects=0,typeof r=="function"&&r(S),p._logInfo(S),typeof p._onSuccess=="function"&&p._onSuccess(S)})},_=Fc.makeRequest(p._config,n,s,b);_.setTimeout(t.HTTP_TIMEOUT,function(){p._requestTimedOut=!0,_.abort()}),_.on("error",function(x){if(p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&p._statsbeatFailedToIngest(),p._numConsecutiveFailures++,p._statsbeat&&p._statsbeat.countException(Ky.StatsbeatNetworkCategory.Breeze,o,x),!p._enableDiskRetryMode||p._numConsecutiveFailures>0&&p._numConsecutiveFailures%t.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var S="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";p._enableDiskRetryMode&&(S="Ingestion endpoint could not be reached "+p._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),p._logWarn(S,Fc.dumpObj(x))}else{var S="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";p._logInfo(S,Fc.dumpObj(x))}p._onErrorHelper(x),typeof r=="function"&&(x?(p._requestTimedOut&&(x.name="telemetry timeout",x.message="telemetry request timed out"),r(Fc.dumpObj(x))):r("Error sending telemetry")),p._enableDiskRetryMode&&p._storeToDisk(e)}),_.write(g),_.end()}),f.label=5;case 5:return[2]}})})},t.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(Fc.stringify(e))},t.prototype._isRetriable=function(e){return e===206||e===401||e===403||e===408||e===429||e===500||e===502||e===503||e===504},t.prototype._logInfo=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._isStatsbeatSender||r6e.info(t.TAG,e,r)},t.prototype._logWarn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._isStatsbeatSender||r6e.warn(t.TAG,e,r)},t.prototype._statsbeatFailedToIngest=function(){this._shutdownStatsbeat&&(this._failedToIngestCounter++,this._failedToIngestCounter>=3&&this._shutdownStatsbeat())},t.prototype._storeToDisk=function(e){return OV(this,void 0,void 0,function(){var r,n,o,s,a,c,l;return MV(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),this._logInfo("Checking existence of data storage directory: "+this._tempDir),[4,Jh.confirmDirExists(this._tempDir)];case 1:return u.sent(),[3,3];case 2:return r=u.sent(),this._logWarn("Failed to create folder to put telemetry: "+Fc.dumpObj(r)),this._onErrorHelper(r),[2];case 3:return u.trys.push([3,5,,6]),[4,x4.FileAccessControl.applyACLRules(this._tempDir)];case 4:return u.sent(),[3,6];case 5:return n=u.sent(),this._logWarn("Failed to apply file access control to folder: "+Fc.dumpObj(n)),this._onErrorHelper(n),[2];case 6:return u.trys.push([6,8,,9]),[4,Jh.getShallowDirectorySize(this._tempDir)];case 7:return o=u.sent(),o>this._maxBytesOnDisk?(this._logWarn("Not saving data due to max size limit being met. Directory size in bytes is: "+o),[2]):[3,9];case 8:return s=u.sent(),this._logWarn("Failed to read directory for retriable telemetry: "+Fc.dumpObj(s)),this._onErrorHelper(s),[2];case 9:return u.trys.push([9,11,,12]),a=new Date().getTime()+".ai.json",c=AS.join(this._tempDir,a),this._logInfo("saving data to disk at: "+c),[4,Jh.writeFileAsync(c,Fc.stringify(e),{mode:384})];case 10:return u.sent(),[3,12];case 11:return l=u.sent(),this._logWarn("Failed to persist telemetry to disk: "+Fc.dumpObj(l)),this._onErrorHelper(l),[2];case 12:return[2]}})})},t.prototype._storeToDiskSync=function(e){try{this._logInfo("Checking existence of data storage directory: "+this._tempDir),gce.existsSync(this._tempDir)||gce.mkdirSync(this._tempDir),x4.FileAccessControl.applyACLRulesSync(this._tempDir);var r=Jh.getShallowDirectorySizeSync(this._tempDir);if(r>this._maxBytesOnDisk){this._logInfo("Not saving data due to max size limit being met. Directory size in bytes is: "+r);return}var n=new Date().getTime()+".ai.json",o=AS.join(this._tempDir,n);this._logInfo("saving data before crash to disk at: "+o),gce.writeFileSync(o,e,{mode:384})}catch(s){this._logWarn("Error while saving data to disk: "+Fc.dumpObj(s)),this._onErrorHelper(s)}},t.prototype._sendFirstFileOnDisk=function(){return OV(this,void 0,void 0,function(){var e,r,n,o,s,a;return MV(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,Jh.readdirAsync(this._tempDir)];case 1:return e=c.sent(),e=e.filter(function(l){return AS.basename(l).indexOf(".ai.json")>-1}),e.length>0?(r=e[0],n=AS.join(this._tempDir,r),[4,Jh.readFileAsync(n)]):[3,5];case 2:return o=c.sent(),[4,Jh.unlinkAsync(n)];case 3:return c.sent(),s=JSON.parse(o.toString()),[4,this.send(s)];case 4:c.sent(),c.label=5;case 5:return[3,7];case 6:return a=c.sent(),this._onErrorHelper(a),[3,7];case 7:return[2]}})})},t.prototype._onErrorHelper=function(e){typeof this._onError=="function"&&this._onError(e)},t.prototype._fileCleanupTask=function(){return OV(this,void 0,void 0,function(){var e,r,n,o,s,a,c=this;return MV(this,function(l){switch(l.label){case 0:return l.trys.push([0,6,,7]),[4,Jh.readdirAsync(this._tempDir)];case 1:if(e=l.sent(),e=e.filter(function(u){return AS.basename(u).indexOf(".ai.json")>-1}),!(e.length>0))return[3,5];r=0,l.label=2;case 2:return r<e.length?(n=new Date(parseInt(e[r].split(".ai.json")[0])),o=new Date(+new Date-t.FILE_RETEMPTION_PERIOD)>n,o?(s=AS.join(this._tempDir,e[r]),[4,Jh.unlinkAsync(s).catch(function(u){c._onErrorHelper(u)})]):[3,4]):[3,5];case 3:l.sent(),l.label=4;case 4:return r++,[3,2];case 5:return[3,7];case 6:return a=l.sent(),a.code!="ENOENT"&&this._onErrorHelper(a),[3,7];case 7:return[2]}})})},t.TAG="Sender",t.WAIT_BETWEEN_RESEND=60*1e3,t.MAX_BYTES_ON_DISK=50*1024*1024,t.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,t.CLEANUP_TIMEOUT=60*60*1e3,t.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,t.TEMPDIR_PREFIX="appInsights-node",t.HTTP_TIMEOUT=2e4,t}();n6e.exports=oCt});var o6e=R(FV=>{"use strict";Object.defineProperty(FV,"__esModule",{value:!0});FV.AzureVirtualMachine=void 0;var i6e=ri(),sCt=zs(),aCt=mR(),cCt="http://169.254.169.254/metadata/instance/compute",lCt="api-version=2017-12-01",uCt="format=json",dCt="UNREACH",pCt=function(){function t(){}return t.getAzureComputeMetadata=function(e,r){var n,o=this,s={},a=cCt+"?"+lCt+"&"+uCt,c=(n={method:"GET"},n[aCt.disableCollectionRequestOption]=!0,n.headers={Metadata:"True"},n),l=sCt.makeRequest(e,a,c,function(u){if(u.statusCode===200){s.isVM=!0;var d="";u.on("data",function(p){d+=p}),u.on("end",function(){try{var p=JSON.parse(d);s.id=p.vmId||"",s.subscriptionId=p.subscriptionId||"",s.osType=p.osType||""}catch(f){i6e.info(t.TAG,f)}r(s)})}else r(s)},!1,!1);l&&(setTimeout(function(){o._requestTimedOut=!0,l.abort()},t.HTTP_TIMEOUT),l.on("error",function(u){o._requestTimedOut&&u&&(u.name="telemetry timeout",u.message="telemetry request timed out"),u&&u.message&&u.message.indexOf(dCt)>-1?s.isVM=!1:i6e.info(t.TAG,u),r(s)}),l.end())},t.HTTP_TIMEOUT=2500,t.TAG="AzureVirtualMachine",t}();FV.AzureVirtualMachine=pCt});var s6e=R(UV=>{"use strict";Object.defineProperty(UV,"__esModule",{value:!0});UV.NetworkStatsbeat=void 0;var fCt=function(){function t(e,r){this.endpoint=e,this.host=r,this.totalRequestCount=0,this.totalSuccesfulRequestCount=0,this.totalFailedRequestCount=[],this.retryCount=[],this.exceptionCount=[],this.throttleCount=[],this.intervalRequestExecutionTime=0,this.lastIntervalRequestExecutionTime=0,this.lastTime=+new Date,this.lastRequestCount=0}return t}();UV.NetworkStatsbeat=fCt});var d6e=R((DS,u6e)=>{"use strict";var Gf=DS&&DS.__assign||function(){return Gf=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Gf.apply(this,arguments)},yce=DS&&DS.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{u(n.next(d))}catch(p){a(p)}}function l(d){try{u(n.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((n=n.apply(t,e||[])).next())})},bce=DS&&DS.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},mCt=require("os"),hCt=hce(),a6e=ri(),gCt=vce(),oi=Ei(),vCt=ma(),yCt=o6e(),bCt=Gse(),c6e=aR(),_Ct=s6e(),l6e=zs(),xCt="node",SCt=function(){function t(e,r){this._attach=oi.StatsbeatAttach.sdk,this._feature=oi.StatsbeatFeature.NONE,this._instrumentation=oi.StatsbeatInstrumentation.NONE,this._isInitialized=!1,this._statbeatMetrics=[],this._networkStatsbeatCollection=[],this._config=e,this._context=r||new c6e;var n=this._getConnectionString(e);this._statsbeatConfig=new bCt(n),this._statsbeatConfig.samplingPercentage=100,this._sender=new gCt(this._statsbeatConfig,null,null,null,null,!0,this._shutdownStatsbeat.bind(this))}return t.prototype.enable=function(e){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._getCustomProperties(),this._isInitialized=!0),e?(this._handle||(this._handle=setInterval(function(){r.trackShortIntervalStatsbeats()},t.STATS_COLLECTION_SHORT_INTERVAL),this._handle.unref()),this._longHandle||(this.trackLongIntervalStatsbeats(),this._longHandle=setInterval(function(){r.trackLongIntervalStatsbeats()},t.STATS_COLLECTION_LONG_INTERVAL),this._longHandle.unref())):(this._handle&&(clearInterval(this._handle),this._handle=null),this._longHandle&&(clearInterval(this._longHandle),this._longHandle=null))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.isEnabled=function(){return this._isEnabled},t.prototype.setCodelessAttach=function(){this._attach=oi.StatsbeatAttach.codeless},t.prototype.addFeature=function(e){this._feature|=e},t.prototype.removeFeature=function(e){this._feature&=~e},t.prototype.addInstrumentation=function(e){this._instrumentation|=e},t.prototype.removeInstrumentation=function(e){this._instrumentation&=~e},t.prototype.countRequest=function(e,r,n,o,s){if(this.isEnabled()){var a=this._getNetworkStatsbeatCounter(e,r);if(a.totalRequestCount++,a.intervalRequestExecutionTime+=n,o===!1){if(!s)return;var c=a.totalFailedRequestCount.find(function(l){return s===l.statusCode});c?c.count++:a.totalFailedRequestCount.push({statusCode:s,count:1})}else a.totalSuccesfulRequestCount++}},t.prototype.countException=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.exceptionCount.find(function(a){return n.name===a.exceptionType});s?s.count++:o.exceptionCount.push({exceptionType:n.name,count:1})}},t.prototype.countThrottle=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.throttleCount.find(function(a){return n===a.statusCode});s?s.count++:o.throttleCount.push({statusCode:n,count:1})}},t.prototype.countRetry=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.retryCount.find(function(a){return n===a.statusCode});s?s.count++:o.retryCount.push({statusCode:n,count:1})}},t.prototype.trackShortIntervalStatsbeats=function(){return yce(this,void 0,void 0,function(){var e,r;return bce(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return n.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},this._trackRequestDuration(e),this._trackRequestsCount(e),[4,this._sendStatsbeats()];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),a6e.info(t.TAG,"Failed to send Statsbeat metrics: "+l6e.dumpObj(r)),[3,4];case 4:return[2]}})})},t.prototype.trackLongIntervalStatsbeats=function(){return yce(this,void 0,void 0,function(){var e,r,n,o,s;return bce(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return a.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},r=Object.assign({rpId:this._resourceIdentifier},e),this._statbeatMetrics.push({name:oi.StatsbeatCounter.ATTACH,value:1,properties:r}),this._instrumentation!=oi.StatsbeatInstrumentation.NONE&&(n=Object.assign({feature:this._instrumentation,type:oi.StatsbeatFeatureType.Instrumentation},e),this._statbeatMetrics.push({name:oi.StatsbeatCounter.FEATURE,value:1,properties:n})),this._feature!=oi.StatsbeatFeature.NONE&&(o=Object.assign({feature:this._feature,type:oi.StatsbeatFeatureType.Feature},e),this._statbeatMetrics.push({name:oi.StatsbeatCounter.FEATURE,value:1,properties:o})),[4,this._sendStatsbeats()];case 2:return a.sent(),[3,4];case 3:return s=a.sent(),a6e.info(t.TAG,"Failed to send Statsbeat metrics: "+l6e.dumpObj(s)),[3,4];case 4:return[2]}})})},t.prototype._getNetworkStatsbeatCounter=function(e,r){for(var n=this._getShortHost(r),o=0;o<this._networkStatsbeatCollection.length;o++)if(e===this._networkStatsbeatCollection[o].endpoint&&n===this._networkStatsbeatCollection[o].host)return this._networkStatsbeatCollection[o];var s=new _Ct.NetworkStatsbeat(e,n);return this._networkStatsbeatCollection.push(s),s},t.prototype._trackRequestDuration=function(e){for(var r=0;r<this._networkStatsbeatCollection.length;r++){var n=this._networkStatsbeatCollection[r];n.time=+new Date;var o=n.totalRequestCount-n.lastRequestCount||0,s=n.intervalRequestExecutionTime-n.lastIntervalRequestExecutionTime,a=s>0&&s/o||0;if(n.lastIntervalRequestExecutionTime=n.intervalRequestExecutionTime,o>0){var c=Object.assign({endpoint:this._networkStatsbeatCollection[r].endpoint,host:this._networkStatsbeatCollection[r].host},e);this._statbeatMetrics.push({name:oi.StatsbeatCounter.REQUEST_DURATION,value:a,properties:c})}n.lastRequestCount=n.totalRequestCount,n.lastTime=n.time}},t.prototype._getShortHost=function(e){var r=e;try{var n=new RegExp(/^https?:\/\/(?:www\.)?([^\/.-]+)/),o=n.exec(e);o!=null&&o.length>1&&(r=o[1]),r=r.replace(".in.applicationinsights.azure.com","")}catch{}return r},t.prototype._trackRequestsCount=function(e){for(var r=this,n=function(c){s=o._networkStatsbeatCollection[c];var l=Object.assign({endpoint:s.endpoint,host:s.host},e);s.totalSuccesfulRequestCount>0&&(o._statbeatMetrics.push({name:oi.StatsbeatCounter.REQUEST_SUCCESS,value:s.totalSuccesfulRequestCount,properties:l}),s.totalSuccesfulRequestCount=0),s.totalFailedRequestCount.length>0&&(s.totalFailedRequestCount.forEach(function(u){l=Object.assign(Gf(Gf({},l),{statusCode:u.statusCode})),r._statbeatMetrics.push({name:oi.StatsbeatCounter.REQUEST_FAILURE,value:u.count,properties:l})}),s.totalFailedRequestCount=[]),s.retryCount.length>0&&(s.retryCount.forEach(function(u){l=Object.assign(Gf(Gf({},l),{statusCode:u.statusCode})),r._statbeatMetrics.push({name:oi.StatsbeatCounter.RETRY_COUNT,value:u.count,properties:l})}),s.retryCount=[]),s.throttleCount.length>0&&(s.throttleCount.forEach(function(u){l=Object.assign(Gf(Gf({},l),{statusCode:u.statusCode})),r._statbeatMetrics.push({name:oi.StatsbeatCounter.THROTTLE_COUNT,value:u.count,properties:l})}),s.throttleCount=[]),s.exceptionCount.length>0&&(s.exceptionCount.forEach(function(u){l=Object.assign(Gf(Gf({},l),{exceptionType:u.exceptionType})),r._statbeatMetrics.push({name:oi.StatsbeatCounter.EXCEPTION_COUNT,value:u.count,properties:l})}),s.exceptionCount=[])},o=this,s,a=0;a<this._networkStatsbeatCollection.length;a++)n(a)},t.prototype._sendStatsbeats=function(){return yce(this,void 0,void 0,function(){var e,r,n,o;return bce(this,function(s){switch(s.label){case 0:for(e=[],r=0;r<this._statbeatMetrics.length;r++)n={name:this._statbeatMetrics[r].name,value:this._statbeatMetrics[r].value,properties:this._statbeatMetrics[r].properties},o=hCt.createEnvelope(n,vCt.TelemetryType.Metric,null,this._context,this._statsbeatConfig),o.name=oi.StatsbeatTelemetryName,e.push(o);return this._statbeatMetrics=[],[4,this._sender.send(e)];case 1:return s.sent(),[2]}})})},t.prototype._getCustomProperties=function(){this._language=xCt,this._cikey=this._config.instrumentationKey,this._sdkVersion=c6e.sdkVersion,this._os=mCt.type(),this._runtimeVersion=process.version},t.prototype._getResourceProvider=function(){var e=this;return new Promise(function(r,n){var o=!1;e._resourceProvider=oi.StatsbeatResourceProvider.unknown,e._resourceIdentifier=oi.StatsbeatResourceProvider.unknown,process.env.AKS_ARM_NAMESPACE_ID?(e._resourceProvider=oi.StatsbeatResourceProvider.aks,e._resourceIdentifier=process.env.AKS_ARM_NAMESPACE_ID):process.env.WEBSITE_SITE_NAME?(e._resourceProvider=oi.StatsbeatResourceProvider.appsvc,e._resourceIdentifier=process.env.WEBSITE_SITE_NAME,process.env.WEBSITE_HOME_STAMPNAME&&(e._resourceIdentifier+="/"+process.env.WEBSITE_HOME_STAMPNAME)):process.env.FUNCTIONS_WORKER_RUNTIME?(e._resourceProvider=oi.StatsbeatResourceProvider.functions,process.env.WEBSITE_HOSTNAME&&(e._resourceIdentifier=process.env.WEBSITE_HOSTNAME)):e._config&&(e._isVM===void 0||e._isVM==!0?(o=!0,yCt.AzureVirtualMachine.getAzureComputeMetadata(e._config,function(s){e._isVM=s.isVM,e._isVM&&(e._resourceProvider=oi.StatsbeatResourceProvider.vm,e._resourceIdentifier=s.id+"/"+s.subscriptionId,s.osType&&(e._os=s.osType)),r()})):e._resourceProvider=oi.StatsbeatResourceProvider.unknown),o||r()})},t.prototype._shutdownStatsbeat=function(){this.enable(!1)},t.prototype._getConnectionString=function(e){for(var r=e.endpointUrl,n=["westeurope","northeurope","francecentral","francesouth","germanywestcentral","norwayeast","norwaywest","swedencentral","switzerlandnorth","switzerlandwest","uksouth","ukwest"],o=0;o<n.length;o++)if(r.indexOf(n[o])>-1)return t.EU_CONNECTION_STRING;return t.NON_EU_CONNECTION_STRING},t.NON_EU_CONNECTION_STRING="InstrumentationKey=c4a29126-a7cb-47e5-b348-11414998b11e;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com",t.EU_CONNECTION_STRING="InstrumentationKey=7dc56bab-3c0c-4e9f-9ebb-d1acadee8d0f;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com",t.STATS_COLLECTION_SHORT_INTERVAL=9e5,t.STATS_COLLECTION_LONG_INTERVAL=864e5,t.TAG="Statsbeat",t}();u6e.exports=SCt});var m6e=R((ztn,f6e)=>{"use strict";var ICt=require("url"),CCt=Gse(),TCt=V5e(),ECt=aR(),Zh=ma(),wCt=G5e(),_ce=X5e(),p6e=Ny(),kCt=d6e(),RCt=vce(),xce=zs(),BV=ri(),PCt=hce(),ACt=function(){function t(e){this._telemetryProcessors=[];var r=new CCt(e);if(this.config=r,!this.config.instrumentationKey||this.config.instrumentationKey=="")throw new Error("Instrumentation key not found, please provide a connection string before starting Application Insights SDK.");this.context=new ECt,this.commonProperties={},this.authorizationHandler=null,this.config.disableStatsbeat||(this._statsbeat=new kCt(this.config,this.context),this._statsbeat.enable(!0));var n=new RCt(this.config,this.getAuthorizationHandler,null,null,this._statsbeat);this.channel=new wCt(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return t.prototype.trackAvailability=function(e){this.track(e,Zh.TelemetryType.Availability)},t.prototype.trackPageView=function(e){this.track(e,Zh.TelemetryType.PageView)},t.prototype.trackTrace=function(e){this.track(e,Zh.TelemetryType.Trace)},t.prototype.trackMetric=function(e){this.track(e,Zh.TelemetryType.Metric)},t.prototype.trackException=function(e){e&&e.exception&&!xce.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,Zh.TelemetryType.Exception)},t.prototype.trackEvent=function(e){this.track(e,Zh.TelemetryType.Event)},t.prototype.trackRequest=function(e){this.track(e,Zh.TelemetryType.Request)},t.prototype.trackDependency=function(e){if(e&&!e.target&&e.data)try{e.target=new ICt.URL(e.data).host}catch(r){e.target=null,BV.warn(t.TAG,"The URL object is failed to create.",r)}this.track(e,Zh.TelemetryType.Dependency)},t.prototype.flush=function(e){this.channel.triggerSend(e?!!e.isAppCrashing:!1,e?e.callback:void 0)},t.prototype.track=function(e,r){if(e&&Zh.telemetryTypeToBaseType(r)){var n=PCt.createEnvelope(e,r,this.commonProperties,this.context,this.config);e.time&&(n.time=e.time.toISOString());var o=this.runTelemetryProcessors(n,e.contextObjects);o=o&&_ce.samplingTelemetryProcessor(n,{correlationContext:p6e.CorrelationContextManager.getCurrentContext()}),_ce.preAggregatedMetricsTelemetryProcessor(n,this.context),o&&(_ce.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else BV.warn(t.TAG,"track() requires telemetry object and telemetryType to be specified.")},t.prototype.setAutoPopulateAzureProperties=function(e){},t.prototype.getAuthorizationHandler=function(e){return e&&e.aadTokenCredential?(this.authorizationHandler||(BV.info(t.TAG,"Adding authorization handler"),this.authorizationHandler=new TCt(e.aadTokenCredential,e.aadAudience)),this.authorizationHandler):null},t.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},t.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},t.prototype.runTelemetryProcessors=function(e,r){var n=!0,o=this._telemetryProcessors.length;if(o===0)return n;r=r||{},r.correlationContext=p6e.CorrelationContextManager.getCurrentContext();for(var s=0;s<o;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[e,r])===!1){n=!1;break}}catch(c){n=!0,BV.warn(t.TAG,"One of telemetry processors failed, telemetry item will be sent.",c,e)}return n&&(e&&e.tags&&(e.tags=xce.validateStringMap(e.tags)),e&&e.data&&e.data.baseData&&e.data.baseData.properties&&(e.data.baseData.properties=xce.validateStringMap(e.data.baseData.properties))),n},t.prototype.getStatsbeat=function(){return this._statsbeat},t.TAG="TelemetryClient",t}();f6e.exports=ACt});var v6e=R((Sce,g6e)=>{"use strict";var DCt=Sce&&Sce.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),NCt=m6e(),h6e=Fse(),LCt=mR(),qV=ri(),OCt=function(t){DCt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?h6e.trackRequestSync(this,r):qV.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},e.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&qV.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?h6e.trackRequest(this,r):qV.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},e.prototype.trackNodeHttpDependency=function(r){r&&r.request?LCt.trackRequest(this,r):qV.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},e}(NCt);g6e.exports=OCt});var b6e=R(y6e=>{"use strict";Object.defineProperty(y6e,"__esModule",{value:!0})});var C6e=R(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.dispose=ae.Configuration=ae.wrapWithCorrelationContext=ae.startOperation=ae.getCorrelationContext=ae.start=ae.setup=ae.liveMetricsClient=ae.defaultClient=ae.DistributedTracingModes=void 0;var Ice=Ny(),MCt=l3e(),FCt=d3e(),Cce=Lj(),UCt=Ise(),BCt=b3e(),qCt=A3e(),jCt=mR(),VCt=Fse(),_6e=pS(),I4=ri(),x6e=uMe(),Tce=dMe(),HCt=mMe();ae.TelemetryClient=v6e();ae.Contracts=ma();ae.azureFunctionsTypes=b6e();var S6e;(function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C"})(S6e=ae.DistributedTracingModes||(ae.DistributedTracingModes={}));var C4,T4,E4,w4,k4,LR,OR,NS,R4,P4,Tl=!1,jV;function GCt(t){return ae.defaultClient?I4.info("The default client is already setup"):(ae.defaultClient=new ae.TelemetryClient(t),C4=new MCt(ae.defaultClient),T4=new FCt(ae.defaultClient),E4=new Cce(ae.defaultClient),w4=new UCt(ae.defaultClient),k4=new BCt(ae.defaultClient),LR=new qCt(ae.defaultClient),NS=new VCt(ae.defaultClient),R4=new jCt(ae.defaultClient),OR||(OR=new Tce.AutoCollectNativePerformance(ae.defaultClient)),P4=new HCt.AzureFunctionsHook(ae.defaultClient)),Ece}ae.setup=GCt;function zCt(){ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectExternalLoggers==null&&(ae.defaultClient.config.enableAutoCollectExternalLoggers=!0),ae.defaultClient.config.enableAutoCollectConsole==null&&(ae.defaultClient.config.enableAutoCollectConsole=!1),ae.defaultClient.config.enableAutoCollectExceptions==null&&(ae.defaultClient.config.enableAutoCollectExceptions=!0),ae.defaultClient.config.enableAutoCollectPerformance==null&&(ae.defaultClient.config.enableAutoCollectPerformance=!0),ae.defaultClient.config.enableAutoCollectPreAggregatedMetrics==null&&(ae.defaultClient.config.enableAutoCollectPreAggregatedMetrics=!0),ae.defaultClient.config.enableAutoCollectHeartbeat==null&&(ae.defaultClient.config.enableAutoCollectHeartbeat=!0),ae.defaultClient.config.enableAutoCollectRequests==null&&(ae.defaultClient.config.enableAutoCollectRequests=!0),ae.defaultClient.config.enableAutoCollectDependencies==null&&(ae.defaultClient.config.enableAutoCollectDependencies=!0),ae.defaultClient.config.enableUseDiskRetryCaching==null&&(ae.defaultClient.config.enableUseDiskRetryCaching=!0),ae.defaultClient.config.enableAutoDependencyCorrelation==null&&(ae.defaultClient.config.enableAutoDependencyCorrelation=!0),ae.defaultClient.config.enableSendLiveMetrics==null&&(ae.defaultClient.config.enableSendLiveMetrics=!1),ae.defaultClient.config.enableAutoCollectExtendedMetrics==null&&(ae.defaultClient.config.enableAutoCollectExtendedMetrics=!0),ae.defaultClient.config.enableWebInstrumentation==null&&(ae.defaultClient.config.enableWebInstrumentation=!1),ae.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions==null&&(ae.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=!1))}function I6e(){if(ae.defaultClient){Tl=!0,zCt(),C4.enable(ae.defaultClient.config.enableAutoCollectExternalLoggers,ae.defaultClient.config.enableAutoCollectConsole),T4.enable(ae.defaultClient.config.enableAutoCollectExceptions),E4.enable(ae.defaultClient.config.enableAutoCollectPerformance),w4.enable(ae.defaultClient.config.enableAutoCollectPreAggregatedMetrics),k4.enable(ae.defaultClient.config.enableAutoCollectHeartbeat),NS.useAutoCorrelation(ae.defaultClient.config.enableAutoDependencyCorrelation,ae.defaultClient.config.enableUseAsyncHooks),NS.enable(ae.defaultClient.config.enableAutoCollectRequests),R4.enable(ae.defaultClient.config.enableAutoCollectDependencies),LR.enable(ae.defaultClient.config.enableWebInstrumentation,ae.defaultClient.config.webInstrumentationConnectionString),ae.defaultClient.config.enableSendLiveMetrics&&(ae.liveMetricsClient||(ae.liveMetricsClient=new x6e(ae.defaultClient.config,ae.defaultClient.context,ae.defaultClient.getAuthorizationHandler),jV=new Cce(ae.liveMetricsClient,1e3,!0),ae.liveMetricsClient.addCollector(jV),ae.defaultClient.quickPulseClient=ae.liveMetricsClient),ae.liveMetricsClient.enable(ae.defaultClient.config.enableSendLiveMetrics)),P4.enable(ae.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions);var t=Tce.AutoCollectNativePerformance.parseEnabled(ae.defaultClient.config.enableAutoCollectExtendedMetrics,ae.defaultClient.config);OR.enable(ae.defaultClient.config.enableAutoCollectExtendedMetrics,t.disabledMetrics),ae.defaultClient&&ae.defaultClient.channel&&ae.defaultClient.channel.setUseDiskRetryCaching(ae.defaultClient.config.enableUseDiskRetryCaching,ae.defaultClient.config.enableResendInterval,ae.defaultClient.config.enableMaxBytesOnDisk)}else I4.warn("Start cannot be called before setup");return Ece}ae.start=I6e;function $Ct(){return Ice.CorrelationContextManager.getCurrentContext()}ae.getCorrelationContext=$Ct;function WCt(t,e){return Ice.CorrelationContextManager.startOperation(t,e)}ae.startOperation=WCt;function KCt(t,e){return Ice.CorrelationContextManager.wrapCallback(t,e)}ae.wrapWithCorrelationContext=KCt;var Ece=function(){function t(){}return t.setDistributedTracingMode=function(e){return _6e.w3cEnabled=e===S6e.AI_AND_W3C,t},t.setAutoCollectConsole=function(e,r){return r===void 0&&(r=!1),ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectExternalLoggers=e,ae.defaultClient.config.enableAutoCollectConsole=r,Tl&&C4.enable(e,r)),t},t.setAutoCollectExceptions=function(e){return ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectExceptions=e,Tl&&T4.enable(e)),t},t.setAutoCollectPerformance=function(e,r){if(r===void 0&&(r=!0),ae.defaultClient){ae.defaultClient.config.enableAutoCollectPerformance=e;var n=Tce.AutoCollectNativePerformance.parseEnabled(r,ae.defaultClient.config);ae.defaultClient.config.enableAutoCollectExtendedMetrics=n.isEnabled,Tl&&(E4.enable(e),OR.enable(ae.defaultClient.config.enableAutoCollectExtendedMetrics,n.disabledMetrics))}return t},t.setAutoCollectPreAggregatedMetrics=function(e){return ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectPreAggregatedMetrics=e,Tl&&w4.enable(e)),t},t.setAutoCollectHeartbeat=function(e){return ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectHeartbeat=e,Tl&&k4.enable(e)),t},t.enableAutoWebSnippetInjection=function(e,r){return ae.defaultClient&&(ae.defaultClient.config.enableWebInstrumentation=e,ae.defaultClient.config.webInstrumentationConnectionString=r,Tl&&LR.enable(ae.defaultClient.config.enableAutoWebSnippetInjection,ae.defaultClient.config.webSnippetConnectionString)),t},t.enableWebInstrumentation=function(e,r){return ae.defaultClient&&(ae.defaultClient.config.enableWebInstrumentation=e,ae.defaultClient.config.webInstrumentationConnectionString=r,Tl&&LR.enable(ae.defaultClient.config.enableWebInstrumentation,ae.defaultClient.config.webInstrumentationConnectionString)),t},t.setAutoCollectRequests=function(e){return ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectRequests=e,Tl&&NS.enable(e)),t},t.setAutoCollectDependencies=function(e){return ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectDependencies=e,Tl&&R4.enable(e)),t},t.setAutoDependencyCorrelation=function(e,r){return ae.defaultClient&&(ae.defaultClient.config.enableAutoDependencyCorrelation=e,ae.defaultClient.config.enableUseAsyncHooks=r,Tl&&NS.useAutoCorrelation(e,r)),t},t.setUseDiskRetryCaching=function(e,r,n){return ae.defaultClient&&(ae.defaultClient.config.enableUseDiskRetryCaching=e,ae.defaultClient.config.enableResendInterval=r,ae.defaultClient.config.enableMaxBytesOnDisk=n,ae.defaultClient.channel&&ae.defaultClient.channel.setUseDiskRetryCaching(ae.defaultClient.config.enableUseDiskRetryCaching,ae.defaultClient.config.enableResendInterval,ae.defaultClient.config.enableMaxBytesOnDisk)),t},t.setInternalLogging=function(e,r){return e===void 0&&(e=!1),r===void 0&&(r=!0),I4.enableDebug=e,I4.disableWarnings=!r,t},t.setAutoCollectIncomingRequestAzureFunctions=function(e){return ae.defaultClient&&(ae.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=e,Tl&&P4.enable(e)),t},t.setSendLiveMetrics=function(e){return e===void 0&&(e=!1),ae.defaultClient?(!ae.liveMetricsClient&&e?(ae.liveMetricsClient=new x6e(ae.defaultClient.config,ae.defaultClient.context,ae.defaultClient.getAuthorizationHandler),jV=new Cce(ae.liveMetricsClient,1e3,!0),ae.liveMetricsClient.addCollector(jV),ae.defaultClient.quickPulseClient=ae.liveMetricsClient):ae.liveMetricsClient&&ae.liveMetricsClient.enable(e),ae.defaultClient.config.enableSendLiveMetrics=e,t):(I4.warn("Live metrics client cannot be setup without the default client"),t)},t.start=I6e,t}();ae.Configuration=Ece;function YCt(){_6e.w3cEnabled=!0,ae.defaultClient=null,Tl=!1,C4&&C4.dispose(),T4&&T4.dispose(),E4&&E4.dispose(),w4&&w4.dispose(),k4&&k4.dispose(),LR&&LR.dispose(),OR&&OR.dispose(),NS&&NS.dispose(),R4&&R4.dispose(),ae.liveMetricsClient&&(ae.liveMetricsClient.enable(!1),ae.liveMetricsClient=void 0),P4&&P4.dispose()}ae.dispose=YCt});var kce=R(Yy=>{"use strict";Object.defineProperty(Yy,"__esModule",{value:!0});Yy.TargetPopulation=Yy.Filters=Yy.VSCodeFilterProvider=void 0;var HV=require("vscode"),wce=class t{constructor(e,r,n){this.extensionName=e,this.extensionVersion=r,this.targetPopulation=n}static trimVersionSuffix(e){let r=/\-[a-zA-Z0-9]+$/;return e.split(r)[0]}getFilterValue(e){switch(e){case zf.ApplicationVersion:return t.trimVersionSuffix(HV.version);case zf.Build:return HV.env.appName;case zf.ClientId:return HV.env.machineId;case zf.ExtensionName:return this.extensionName;case zf.ExtensionVersion:return t.trimVersionSuffix(this.extensionVersion);case zf.Language:return HV.env.language;case zf.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,r=Object.values(zf);for(let n of r)e.set(n,this.getFilterValue(n));return e}};Yy.VSCodeFilterProvider=wce;var zf;(function(t){t.Market="X-MSEdge-Market",t.CorpNet="X-FD-Corpnet",t.ApplicationVersion="X-VSCode-AppVersion",t.Build="X-VSCode-Build",t.ClientId="X-MSEdge-ClientId",t.ExtensionName="X-VSCode-ExtensionName",t.ExtensionVersion="X-VSCode-ExtensionVersion",t.Language="X-VSCode-Language",t.TargetPopulation="X-VSCode-TargetPopulation"})(zf||(Yy.Filters=zf={}));var R6e;(function(t){t.Team="team",t.Internal="internal",t.Insiders="insider",t.Public="public"})(R6e||(Yy.TargetPopulation=R6e={}))});var P6e=R(GV=>{"use strict";Object.defineProperty(GV,"__esModule",{value:!0});GV.BaseFeatureProvider=void 0;var Rce=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};GV.BaseFeatureProvider=Rce});var A6e=R(zV=>{"use strict";Object.defineProperty(zV,"__esModule",{value:!0});zV.FilteredFeatureProvider=void 0;var JCt=P6e(),Pce=class extends JCt.BaseFeatureProvider{constructor(e,r){super(e),this.telemetry=e,this.filterProviders=r,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let r of this.filterProviders){let n=r.getFilters();for(let o of n.keys()){let s=n.get(o);e.set(o,s)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let r=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",r]])),this.cachedTelemetryEvents.push(e)}};zV.FilteredFeatureProvider=Pce});var D6e=R(Qy=>{"use strict";Object.defineProperty(Qy,"__esModule",{value:!0});Qy.TasApiFeatureProvider=Qy.TASAPI_FETCHERROR_EVENTNAME=void 0;var ZCt=A6e();Qy.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var Ace="ErrorType",Dce=class extends ZCt.FilteredFeatureProvider{constructor(e,r,n){super(r,n),this.httpClient=e,this.telemetry=r,this.filterProviders=n}async fetch(){let e=this.getFilters(),r={};for(let c of e.keys()){let l=e.get(c);r[c]=l}let n;try{n=await this.httpClient.get({headers:r})}catch(c){let l=c,u=new Map;l.responseReceived&&!l.responseOk?u.set(Ace,"ServerError"):l.responseReceived===!1?u.set(Ace,"NoResponse"):u.set(Ace,"GenericError"),this.telemetry.postEvent(Qy.TASAPI_FETCHERROR_EVENTNAME,u)}if(!n)throw Error(Qy.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(r);let o=n.data,s=o.Configs,a=[];for(let c of s)if(c.Parameters)for(let l of Object.keys(c.Parameters)){let u=l+(c.Parameters[l]?"":"cf");a.includes(u)||a.push(u)}return{features:a,assignmentContext:o.AssignmentContext,configs:s}}};Qy.TasApiFeatureProvider=Dce});var N6e=R(UR=>{"use strict";Object.defineProperty(UR,"__esModule",{value:!0});UR.HttpClient=UR.FetchError=void 0;var FR=class extends Error{constructor(e,r,n){super(e),this.responseReceived=r,this.responseOk=n}};UR.FetchError=FR;var Nce=class{constructor(e){this.endpoint=e}async get(e){let r=await fetch(this.endpoint,{method:"GET",headers:e?.headers});if(!r)throw new FR("No response received",!1);if(!r.ok)throw new FR("Response not ok",!0,!1);let n=await r.json();if(!n)throw new FR("No data received",!1);return{data:n}}};UR.HttpClient=Nce});var L6e=R($V=>{"use strict";Object.defineProperty($V,"__esModule",{value:!0});$V.MemoryKeyValueStorage=void 0;var Lce=class{constructor(){this.storage=new Map}async getValue(e,r){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(r||void 0)}setValue(e,r){this.storage.set(e,r)}};$V.MemoryKeyValueStorage=Lce});var O6e=R(WV=>{"use strict";Object.defineProperty(WV,"__esModule",{value:!0});WV.ExperimentationServiceBase=void 0;var eTt=L6e(),Oce=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,r,n,o,s){this.telemetry=e,this.assignmentContextTelemetryPropertyName=r,this.telemetryEventName=n,this.storageKey=o,this.storage=s,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(s=new eTt.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((a,c)=>{this.resolveInitialFetchPromise=a})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch{}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let r=await this.fetchPromise;this.updateFeatures(r,e)}catch{}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,r=!1){let n={features:[],assignmentContext:"",configs:[]};for(let o of e){for(let s of o.features)n.features.includes(s)||n.features.push(s);for(let s of o.configs){let a=n.configs.find(c=>c.Id===s.Id);a?a.Parameters=Object.assign(Object.assign({},a.Parameters),s.Parameters):n.configs.push(s)}n.assignmentContext+=o.assignmentContext}(r||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let r=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),r.features.includes(e)}getTreatmentVariable(e,r){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${r}`);let n=this.features.configs.find(o=>o.Id===e);return n?.Parameters[r]}async getTreatmentVariableAsync(e,r,n){if(n){let o=this.featuresConsumed,s=this.getTreatmentVariable(e,r);if(s===void 0)this.featuresConsumed=o;else return s}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,r)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let r of e)this.featureProviders.push(r)}};WV.ExperimentationServiceBase=Oce});var M6e=R(KV=>{"use strict";Object.defineProperty(KV,"__esModule",{value:!0});KV.PollingService=void 0;var Mce=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};KV.PollingService=Mce});var F6e=R(YV=>{"use strict";Object.defineProperty(YV,"__esModule",{value:!0});YV.ExperimentationServiceAutoPolling=void 0;var tTt=O6e(),rTt=M6e(),Fce=class extends tTt.ExperimentationServiceBase{constructor(e,r,n,o,s,a,c){if(super(e,o,s,a,c),this.telemetry=e,this.filterProviders=r,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=o,this.telemetryEventName=s,this.storageKey=a,this.storage=c,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new rTt.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let r=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),r}else return await super.getFeaturesAsync(e)}};YV.ExperimentationServiceAutoPolling=Fce});var U6e=R(XV=>{"use strict";Object.defineProperty(XV,"__esModule",{value:!0});XV.ExperimentationService=void 0;var nTt=D6e(),iTt=N6e(),oTt=F6e(),QV=class extends oTt.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new nTt.TasApiFeatureProvider(new iTt.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};XV.ExperimentationService=QV;QV.REFRESH_RATE_IN_MINUTES=30});var B6e=R(JV=>{"use strict";Object.defineProperty(JV,"__esModule",{value:!0});JV.ExperimentationService=void 0;var sTt=U6e();Object.defineProperty(JV,"ExperimentationService",{enumerable:!0,get:function(){return sTt.ExperimentationService}})});var q6e=R(ZV=>{"use strict";Object.defineProperty(ZV,"__esModule",{value:!0});ZV.MementoKeyValueStorage=void 0;var Uce=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,r){return await this.mementoGlobalStorage.get(e)||r}setValue(e,r){this.mementoGlobalStorage.update(e,r)}};ZV.MementoKeyValueStorage=Uce});var j6e=R(qce=>{"use strict";Object.defineProperty(qce,"__esModule",{value:!0});var Bce=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,r){}getTreatmentVariableAsync(e,r){return Promise.resolve(void 0)}};qce.default=Bce});var H6e=R(BR=>{"use strict";Object.defineProperty(BR,"__esModule",{value:!0});BR.getExperimentationServiceAsync=BR.getExperimentationService=void 0;var aTt=kce(),cTt=B6e(),jce=require("vscode"),lTt=q6e(),uTt=j6e(),dTt="https://default.exp-tas.com/vscode/ab",pTt="query-expfeature",fTt="abexp.assignmentcontext",mTt="VSCode.ABExp.FeatureData",hTt=1e3*60*30;function V6e(t,e,r,n,o,...s){if(!o)throw new Error("Memento storage was not provided.");let a=jce.workspace.getConfiguration("telemetry");if(!(jce.env.isTelemetryEnabled===void 0?a.get("enableTelemetry",!0):jce.env.isTelemetryEnabled))return new uTt.default;let u=[new aTt.VSCodeFilterProvider(t,e,r),...s],d=new lTt.MementoKeyValueStorage(o);return new cTt.ExperimentationService({filterProviders:u,telemetry:n,storageKey:mTt,keyValueStorage:d,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:fTt,telemetryEventName:pTt,endpoint:dTt,refetchInterval:hTt})}BR.getExperimentationService=V6e;async function gTt(t,e,r,n,o,...s){let a=V6e(t,e,r,n,o,...s);return await a.initializePromise,a}BR.getExperimentationServiceAsync=gTt});var z6e=R(Xy=>{"use strict";Object.defineProperty(Xy,"__esModule",{value:!0});Xy.TargetPopulation=Xy.getExperimentationServiceAsync=Xy.getExperimentationService=void 0;var G6e=H6e();Object.defineProperty(Xy,"getExperimentationService",{enumerable:!0,get:function(){return G6e.getExperimentationService}});Object.defineProperty(Xy,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return G6e.getExperimentationServiceAsync}});var vTt=kce();Object.defineProperty(Xy,"TargetPopulation",{enumerable:!0,get:function(){return vTt.TargetPopulation}})});var K6e=R(nH=>{"use strict";Object.defineProperty(nH,"__esModule",{value:!0});nH.BaseTelemetryReporter=void 0;var Hce=class{constructor(e,r,n){this.telemetrySender=e,this.vscodeAPI=r,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,r,n,o){o?this.telemetrySender.sendEventData(e,{properties:r,measurements:n}):this.telemetryLogger.logUsage(e,{properties:r,measurements:n})}sendTelemetryEvent(e,r,n){this.internalSendTelemetryEvent(e,r,n,!1)}sendRawTelemetryEvent(e,r,n){let o={...r};for(let s of Object.keys(o??{})){let a=o[s];typeof s=="string"&&a!==void 0&&(o[s]=new this.vscodeAPI.TelemetryTrustedValue(typeof a=="string"?a:a.value))}this.sendTelemetryEvent(e,o,n)}sendDangerousTelemetryEvent(e,r,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,r,n,!0)}internalSendTelemetryErrorEvent(e,r,n,o){o?this.telemetrySender.sendEventData(e,{properties:r,measurements:n}):this.telemetryLogger.logError(e,{properties:r,measurements:n})}sendTelemetryErrorEvent(e,r,n){this.internalSendTelemetryErrorEvent(e,r,n,!1)}sendDangerousTelemetryErrorEvent(e,r,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,r,n,!0)}async dispose(){return await this.telemetrySender.dispose(),this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}};nH.BaseTelemetryReporter=Hce});var Y6e=R(iH=>{"use strict";Object.defineProperty(iH,"__esModule",{value:!0});iH.BaseTelemetrySender=void 0;var eg;(function(t){t[t.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",t[t.INSTANTIATING=1]="INSTANTIATING",t[t.INSTANTIATED=2]="INSTANTIATED"})(eg||(eg={}));var Gce=class{constructor(e,r){this._instantiationStatus=eg.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=r,this._key=e}sendEventData(e,r){if(!this._telemetryClient){this._instantiationStatus!==eg.INSTANTIATED&&this._eventQueue.push({eventName:e,data:r});return}this._telemetryClient.logEvent(e,r)}sendErrorData(e,r){if(!this._telemetryClient){this._instantiationStatus!==eg.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:r});return}let n={stack:e.stack,message:e.message,name:e.name};if(r){let o=r.properties||r;r.properties={...o,...n}}else r={properties:n};this._telemetryClient.logEvent("unhandlederror",r)}async flush(){return this._telemetryClient?.flush()}async dispose(){this._telemetryClient&&(await this._telemetryClient.dispose(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:r})=>this.sendEventData(e,r)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:r})=>this.sendErrorData(e,r)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===eg.NOT_INSTANTIATED&&(this._instantiationStatus=eg.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=eg.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=eg.INSTANTIATED}))}};iH.BaseTelemetrySender=Gce});var $ce=R(oH=>{"use strict";Object.defineProperty(oH,"__esModule",{value:!0});oH.TelemetryUtil=void 0;var zce=class t{static applyReplacements(e,r){for(let n of Object.keys(e))for(let o of r)o.lookup.test(n)&&(o.replacementString!==void 0?e[n]=o.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.9.4"}}static getInstance(){return t._instance||(t._instance=new t),t._instance}};oH.TelemetryUtil=zce});var qR,tg,$f,$d,jR,D4,Wce=D(()=>{qR="function",tg="object",$f="undefined",$d="prototype",jR=Object,D4=jR[$d]});var ao,Wi,VR,Jy,rg,Lu,N4,ng,L4,O4,Q6e,Ou,M4,In,HR,Ki,GR,Kce,El,Yce,Qce,ig,Uc,gr=D(()=>{ao=void 0,Wi=null,VR="",Jy="function",rg="object",Lu="prototype",N4="__proto__",ng="undefined",L4="constructor",O4="Symbol",Q6e="_polyfill",Ou="length",M4="name",In="call",HR="toString",Ki=Object,GR=Ki[Lu],Kce=String,El=Kce[Lu],Yce=Math,Qce=Array,ig=Qce[Lu],Uc=ig.slice});function va(t,e){try{return{v:t.apply(this,e)}}catch(r){return{e:r}}}var zR=D(()=>{});function X6e(t,e){var r=va(t);return r.e?e:r.v}var J6e=D(()=>{zR()});function sH(t){return function(e){return typeof e===t}}function Z6e(t){var e="[object "+t+"]";return function(r){return!!(r&&F4(r)===e)}}function F4(t){return GR.toString.call(t)}function aH(t,e){return typeof t===e}function Vt(t){return typeof t===ng||t===ng}function Pe(t){return t===Wi||Vt(t)}function Jce(t){return t===Wi||!cH(t)}function cH(t){return!!t||t!==ao}function Zce(t){return!Xce&&(Xce=["string","number","boolean",ng,"symbol","bigint"]),t!==rg&&Xce.indexOf(t)!==-1}function Kn(t){return!t&&Pe(t)?!1:!!t&&typeof t===rg}function eb(t){return!!(t&&t.then&&wt(t.then))}function lH(t){return!t||!Mu(t)}function Mu(t){return!(!t||X6e(function(){return!(t&&0+t)},!t))}var Xce,$t,wt,mt,$R,ya,Wd,Zy,wl=D(()=>{gr();J6e();$t=sH("string"),wt=sH(Jy);mt=Qce.isArray,$R=Z6e("Date"),ya=sH("number"),Wd=sH("boolean"),Zy=Z6e("Error")});var LS,uH=D(()=>{gr();LS=Ki.getOwnPropertyDescriptor});function co(t,e){return!!t&&GR.hasOwnProperty[In](t,e)}var dH=D(()=>{gr()});function e8e(t,e){return co(t,e)||!!LS(t,e)}var Bc,pH=D(()=>{gr();uH();dH();Bc=Ki.hasOwn||e8e});function it(t,e,r){if(t&&Kn(t)){for(var n in t)if(Bc(t,n)&&e[In](r||t,n,t[n])===-1)break}}var tb=D(()=>{wl();gr();pH()});function ele(t,e,r,n){var o={};return it(t,function(s,a){o[s]=e?a:s,o[a]=r?a:s}),n(o)}var t8e=D(()=>{tb()});function Ai(t){throw new Error(t)}function mi(t){throw new TypeError(t)}var rb=D(()=>{});function r8e(t){var e=[];return it(t,function(r,n){e.push([r,n])}),e}function n8e(t){var e=[];return it(t,function(r,n){e.push(n)}),e}var i8e=D(()=>{tb()});function o8e(t){return t}function bTt(t){return t[N4]||Wi}function Xa(t){return tle&&it(t,function(e,r){(mt(r)||Kn(r))&&tle(r)}),Wf(t)}var tle,OS,Zo,Wf,fH,WR,_Tt,snn,KR=D(()=>{gr();wl();tb();i8e();tle=Ki.freeze;OS=Ki.assign,Zo=Ki.keys;Wf=tle||o8e,fH=Ki.seal||o8e,WR=Ki.getPrototypeOf||bTt,_Tt=Ki.entries||r8e,snn=Ki.values||n8e});function rle(t){return ele(t,1,0,Xa)}function nle(t){return ele(t,0,0,Xa)}function s8e(t){var e={};return it(t,function(r,n){e[r]=n[1],e[n[0]]=n[1]}),Xa(e)}function ile(t){return s8e(t)}var ole=D(()=>{t8e();tb();KR()});var mH,sle=D(()=>{ole();mH=nle({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12})});var si,MS=D(()=>{gr();si=Kce});function cle(){var t;return typeof globalThis!==ng&&(t=globalThis),!t&&typeof self!==ng&&(t=self),!t&&typeof window!==ng&&(t=window),!t&&typeof global!==ng&&(t=global),t}function hH(){if(!ale){var t=va(cle).v||{};ale=t[a8e]=t[a8e]||{}}return ale}var a8e,ale,gH=D(()=>{zR();gr();a8e="__tsUtils$gblCfg"});function et(t,e){var r=VR,n=GR[HR][In](t);n===xTt&&(t={stack:si(t.stack),message:si(t.message),name:si(t.name)});try{r=JSON.stringify(t,Wi,e?typeof e=="number"?e:4:ao),r=r&&r.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: ")||si(t)}catch(o){r=" - "+et(o,e)}return n+": "+r}var xTt,nb=D(()=>{gr();MS();xTt="[object Error]"});function Kd(t,e,r){var n=e&&e[t];return function(o){var s=o&&o[t]||n;if(s||r){var a=arguments;return(s||r).apply(o,s?Uc[In](a,1):a)}mi('"'+si(t)+'" not defined for '+et(o))}}function c8e(t){return function(e){return e[t]}}var Fu,Uu=D(()=>{nb();rb();MS();gr();Fu=Kd});var knn,l8e,u8e=D(()=>{gr();knn=Yce.min,l8e=Yce.max});var lle,d8e=D(()=>{gr();Uu();lle=Fu("slice",El)});function p8e(t,e,r){return Pe(t)&&mi("'polyStrSubstr called with invalid "+et(t)),r<0?VR:(e=e||0,e<0&&(e=l8e(e+t[Ou],0)),Vt(r)?lle(t,e):lle(t,e,e+r))}function ib(t,e){return Yi(t,0,e)}var Yi,Yd,vH=D(()=>{wl();nb();rb();gr();Uu();u8e();d8e();Yi=Fu("substring",El),Yd=Kd("substr",El,p8e)});function STt(){if(!ule){var t=hH();ule=t.gblSym=t.gblSym||{k:{},s:{}}}return ule}function bH(t){var e={description:si(t),toString:function(){return O4+"("+t+")"}};return e[Q6e]=!0,e}function m8e(t){var e=STt();if(!Bc(e.k,t)){var r=bH(t),n=Zo(e.s).length;r[f8e]=function(){return n+"_"+r[HR]()},e.k[t]=r,e.s[r[f8e]()]=si(t)}return e.k[t]}function h8e(t){!yH&&(yH={});var e,r=mH[t];return r&&(e=yH[r]=yH[r]||bH(O4+"."+r)),e}var f8e,ule,yH,g8e=D(()=>{sle();gr();pH();MS();gH();KR();f8e="_urid"});function v8e(t){var e={};if(e[_H.c]=!0,e[_H.e]=!0,t.l){e.get=function(){return t.l.v};var r=LS(t.l,"v");r&&r.set&&(e.set=function(n){t.l.v=n})}return it(t,function(n,o){e[_H[n]]=Vt(o)?e[_H[n]]:o}),e}function xH(t,e,r,n,o,s){var a={e:s,c:o};return r&&(a.g=r),n&&(a.s=n),Qi(t,e,v8e(a))}function nn(t,e,r){return Qi(t,e,v8e(r))}var _H,Qi,ITt,FS=D(()=>{gr();wl();tb();uH();_H={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};Qi=Ki.defineProperty,ITt=Ki.defineProperties});function Qd(){Xi=hH()}function Xd(t){var e={};return!Xi&&Qd(),e.b=Xi.lzy,Qi(e,"v",{configurable:!0,get:function(){var r=t();return Xi.lzy||Qi(e,"v",{value:r}),e.b=Xi.lzy,r}}),e}var Xi,US=D(()=>{gH();FS()});function YR(t,e){return Xd(function(){var r=va(t);return r.e?e:r.v})}var dle=D(()=>{US();zR()});function U4(t){return Qi({toJSON:function(){return t}},"v",{value:t})}var ple=D(()=>{FS()});function q4(t,e){var r;return function(){return!Xi&&Qd(),(!r||Xi.lzy)&&(r=U4(va(t,e).v)),r.v}}function og(t){return Xd(function(){return va(yn,[t]).v||ao})}function ba(t){return!Xi&&Qd(),(!B4||t===!1||Xi.lzy)&&(B4=U4(va(cle).v||Wi)),B4.v}function yn(t,e){var r=!B4||e===!1?ba(e):B4.v;return r&&r[t]?r[t]:t===y8e?Ni():Wi}function ob(){return!!Di()}function sb(){return!!Ni()}function QR(){return!!Ro()}function SH(){return!!j4()}var y8e,B4,Di,Ni,Ro,j4,fle,V4=D(()=>{gr();gH();US();ple();zR();y8e="window";Di=q4(yn,["document"]);Ni=q4(yn,[y8e]);Ro=q4(yn,["navigator"]);j4=q4(yn,["history"]),fle=q4(function(){return!!va(function(){return process&&(process.versions||{}).node}).v})});function IH(){(!_a||!_a.b)&&(_a=og(O4),mle=YR(function(){return _a.v?_a.v.for:ao},ao),CTt=YR(function(){return _a.v?_a.v.keyFor:ao},ao))}function hle(){return!!b8e()}function b8e(){return!Xi&&Qd(),(!_a||Xi.lzy)&&IH(),_a.v}function BS(t,e){var r=mH[t];return!Xi&&Qd(),(!_a||Xi.lzy)&&IH(),_a.v?_a.v[r||t]:e?ao:h8e(t)}function qS(t,e){return!Xi&&Qd(),(!_a||Xi.lzy)&&IH(),_a.v?_a.v(t):e?Wi:bH(t)}function H4(t){return!Xi&&Qd(),(!mle||!_a||Xi.lzy)&&IH(),(mle.v||m8e)(t)}var _a,mle,CTt,CH=D(()=>{gr();g8e();sle();US();dle();V4()});function G4(t){return!!t&&wt(t.next)}function _8e(t){return!Jce(t)&&wt(t[BS(3)])}var gle=D(()=>{CH();wl()});function x8e(t,e,r){if(t&&(G4(t)||(!TH&&(TH=U4(BS(3))),t=t[TH.v]?t[TH.v]():null),G4(t))){var n=void 0,o=void 0;try{for(var s=0;!(o=t.next()).done&&e[In](r||t,o.value,s,t)!==-1;)s++}catch(a){n={e:a},t.throw&&(o=null,t.throw(n))}finally{try{o&&!o.done&&t.return&&t.return(o)}finally{if(n)throw n.e}}}}var TH,S8e=D(()=>{ple();gr();CH();gle()});function sg(t,e,r){return t.apply(e,r)}var EH=D(()=>{});function Bu(t,e){return!Vt(e)&&t&&(mt(e)?sg(t.push,t,e):G4(e)||_8e(e)?x8e(e,function(r){t.push(r)}):t.push(e)),t}var I8e=D(()=>{wl();gle();S8e();EH()});function Ce(t,e,r){if(t)for(var n=t[Ou]>>>0,o=0;o<n&&!(o in t&&e[In](r||t,t[o],o,t)===-1);o++);}var wH=D(()=>{gr()});var $r,vle=D(()=>{gr();Uu();$r=Fu("indexOf",ig)});var Kf,C8e=D(()=>{gr();Uu();Kf=Fu("map",ig)});function ab(t,e,r){return(t&&t.slice||Uc).apply(t,Uc[In](arguments,1))}var T8e=D(()=>{gr()});function E8e(t,e,r){return $r(t,e,r)!==-1}var w8e=D(()=>{vle()});var kH,k8e=D(()=>{gr();Uu();w8e();kH=Kd("includes",ig,E8e)});var XR,R8e=D(()=>{gr();Uu();XR=Fu("reduce",ig)});function TTt(t){if(!t)return{};var e=typeof t;e!==rg&&e!==Jy&&mi("Prototype must be an Object or function: "+et(t));function r(){}return r[Lu]=t,new r}var qu,yle=D(()=>{gr();nb();rb();qu=Ki.create||TTt});function _le(t,e){var r=Ki.setPrototypeOf||function(n,o){!ble&&(ble=Xd(function(){var s;return s={},s[N4]=[],s instanceof Array})),ble.v?n[N4]=o:it(o,function(s,a){return n[s]=a})};return r(t,e)}var ble,P8e=D(()=>{US();gr();tb()});function ETt(t,e,r){va(nn,[e,M4,{v:t,c:!0,e:!1}]),e=_le(e,r);function n(){this.constructor=e,va(nn,[this,M4,{v:t,c:!0,e:!1}])}return e[Lu]=r===Wi?qu(r):(n[Lu]=r[Lu],new n),e}function A8e(t,e){e&&(t[M4]=e)}function xle(t,e,r){var n=r||Error,o=n[Lu][M4],s=Error.captureStackTrace;return ETt(t,function(){var a=this,c=arguments;try{va(A8e,[n,t]);var l=sg(n,a,Uc[In](c))||a;if(l!==a){var u=WR(a);u!==WR(l)&&_le(l,u)}return s&&s(l,a[L4]),e&&e(l,c),l}finally{va(A8e,[n,o])}},n)}var D8e=D(()=>{EH();gr();yle();FS();KR();P8e();zR()});function Li(){return(Date.now||N8e)()}function N8e(){return new Date().getTime()}var Sle=D(()=>{});function wTt(t){return function(r){return Pe(r)&&mi("strTrim called ["+et(r)+"]"),r&&r.replace&&(r=r.replace(t,VR)),r}}var L8e,O8e=D(()=>{wl();nb();rb();gr();L8e=wTt(/^\s+|(?=\s)\s+$/g)});var Zr,M8e=D(()=>{gr();Uu();O8e();Zr=Kd("trim",El,L8e)});function es(t){if(!t||typeof t!==rg)return!1;Tle||(Tle=sb()?Ni():!0);var e=!1;if(t!==Tle){Cle||(Ile=Function[Lu][HR],Cle=Ile[In](Ki));try{var r=WR(t);e=!r,e||(co(r,L4)&&(r=r[L4]),e=r&&typeof r===Jy&&Ile[In](r)===Cle)}catch{}}return e}var Ile,Cle,Tle,Ele=D(()=>{V4();gr();dH();KR()});function kTt(t){return t.value&&j8e(t),!0}function RTt(t,e,r,n){var o;return Ce(t,function(s){if(s.k===e)return o=s,-1}),o||(o={k:e,v:e},t.push(o),n(o)),o.v}function wle(t,e,r,n){var o=r.handler,s=r.path?n?r.path.concat(n):r.path:[],a={handler:r.handler,src:r.src,path:s},c=typeof e,l=!1,u=!1;e&&c===rg?l=es(e):u=e===Wi||Zce(c);var d={type:c,isPrim:u,isPlain:l,value:e,result:e,path:s,origin:r.src,copy:function(p,f){return wle(t,p,f?a:r,f)},copyTo:function(p,f){return U8e(t,p,f,a)}};return d.isPrim?o&&o[In](r,d)?d.result:e:RTt(t,e,s,function(p){nn(d,"result",{g:function(){return p.v},s:function(h){p.v=h}});for(var f=0,m=o;!(m||(f<F8e.length?F8e[f++]:kTt))[In](r,d);)m=Wi})}function U8e(t,e,r,n){if(!Pe(r))for(var o in r)e[o]=wle(t,r[o],n,o);return e}function B8e(t,e,r){var n={handler:r,src:e,path:[]};return U8e([],t,e,n)}function q8e(t,e){var r={handler:e,src:t};return wle([],t,r)}function PTt(t){var e=t.value;if(mt(e)){var r=t.result=[];return r.length=e.length,t.copyTo(r,e),!0}return!1}function ATt(t){var e=t.value;return $R(e)?(t.result=new Date(e.getTime()),!0):!1}function DTt(t){return t.type===Jy}function j8e(t){var e=t.value;if(e&&t.isPlain){var r=t.result={};return t.copyTo(r,e),!0}return!1}var F8e,V8e=D(()=>{wH();wl();gr();FS();Ele();F8e=[PTt,j8e,DTt,ATt]});function NTt(t,e){return Ce(e,function(r){B8e(t,r)}),t}function RH(t,e,r,n,o,s,a){return NTt(q8e(t)||{},Uc[In](arguments))}var H8e=D(()=>{wH();gr();V8e()});var JR,G8e=D(()=>{gr();Uu();JR=c8e(Ou)});function ag(){return!Xi&&Qd(),(!PH||!PH.b&&Xi.lzy)&&(PH=og("performance")),PH.v}function ZR(){var t=ag();return t&&t.now?t.now():Li()}var PH,z8e=D(()=>{Sle();V4();US()});function LTt(t,e,r){$t(t)||mi("'"+et(t)+"' is not a string");var n=$t(e)?e:si(e),o=!Vt(r)&&r<t[Ou]?r:t[Ou];return Yi(t,o-n[Ou],o)===n}var cb,$8e=D(()=>{wl();nb();rb();gr();Uu();MS();vH();cb=Kd("endsWith",El,LTt)});var Ja,W8e=D(()=>{gr();Uu();Ja=Fu("indexOf",El)});function OTt(t,e,r){$t(t)||mi("'"+et(t)+"' is not a string");var n=$t(e)?e:si(e),o=r>0?r:0;return Yi(t,o,o+n[Ou])===n}var jS,K8e=D(()=>{wl();nb();rb();gr();Uu();MS();vH();jS=Kd("startsWith",El,OTt)});function Y8e(t,e,r){var n=!0,o=t?e(Wi):Wi,s;function a(){return n=!1,o&&o[Rle]&&o[Rle](),s}function c(){o&&r(o),o=Wi}function l(){return o=e(o),n||a(),s}function u(d){!d&&o&&c(),d&&!o&&l()}return s={cancel:c,refresh:l},s[Ple]=function(){return o&&o[Ple]?o[Ple]():n},s[kle]=function(){return n=!0,o&&o[kle]&&o[kle](),s},s[Rle]=a,s=Qi(s,MTt,{get:function(){return!!o},set:u}),{h:s,dn:function(){o=Wi}}}var kle,Rle,Ple,MTt,Q8e=D(()=>{gr();FS();kle="ref",Rle="unref",Ple="hasRef",MTt="enabled"});function Ale(t,e,r){var n=mt(e),o=n?e.length:0,s=(o>0?e[0]:n?ao:e)||setTimeout,a=(o>1?e[1]:ao)||clearTimeout,c=r[0];r[0]=function(){l.dn(),sg(c,ao,Uc[In](arguments))};var l=Y8e(t,function(u){if(u){if(u.refresh)return u.refresh(),u;sg(a,ao,[u])}return sg(s,ao,r)},function(u){sg(a,ao,[u])});return l.h}function qc(t,e){return Ale(!0,ao,Uc[In](arguments))}function Dle(t,e,r){return Ale(!0,t,Uc[In](arguments,1))}function Nle(t,e){return Ale(!1,ao,Uc[In](arguments))}var X8e=D(()=>{EH();wl();gr();Q8e()});var Dt=D(()=>{I8e();wH();k8e();vle();C8e();R8e();T8e();wl();D8e();Sle();nb();ole();V4();H8e();US();G8e();z8e();dle();rb();yle();FS();tb();uH();pH();dH();Ele();KR();$8e();W8e();K8e();vH();MS();M8e();CH();X8e()});function jc(t,e){typeof e!==qR&&e!==null&&mi("Class extends value "+String(e)+" is not a constructor or null"),Lle(t,e);function r(){this.constructor=t}t[$d]=e===null?qu(e):(r[$d]=e[$d],new r)}function AH(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t}var Man,Fan,J8e,BTt,ju,Lle,Z8e=D(()=>{Dt();Wce();Man=(ba()||{}).Symbol,Fan=(ba()||{}).Reflect,J8e="hasOwnProperty",BTt=function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)D4[J8e].call(e,o)&&(t[o]=e[o])}return t},ju=OS||BTt,Lle=function(t,e){return Lle=jR.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n[J8e](o)&&(r[o]=n[o])},Lle(t,e)}});var e9e=D(()=>{});var Vc=D(()=>{Wce();Z8e();e9e();Dt()});function OH(t){return t&&(t===Vle[cg]||t===Array[cg])}function Hle(t){return OH(t)||t===Function[cg]}function VS(t){var e;if(t){if($4)return $4(t);var r=t[jle]||t[cg]||(t[MH]?t[MH][cg]:null);e=t[NH]||r,co(t,NH)||(delete t[Ole],e=t[NH]=t[Ole]||t[NH],t[Ole]=r)}return e}function BH(t,e){var r=[];if(n9e)r=n9e(t);else for(var n in t)typeof n=="string"&&co(t,n)&&r.push(n);if(r&&r.length>0)for(var o=0;o<r.length;o++)e(r[o])}function Gle(t,e,r){return e!==MH&&typeof t[e]===FH&&(r||co(t,e))&&e!==jle&&e!==cg}function qH(t){mi("DynamicProto: "+t)}function jTt(t){var e=qu(null);return BH(t,function(r){!e[r]&&Gle(t,r,!1)&&(e[r]=t[r])}),e}function zle(t,e){for(var r=t.length-1;r>=0;r--)if(t[r]===e)return!0;return!1}function VTt(t,e,r,n){function o(l,u,d){var p=u[d];if(p[Fle]&&n){var f=l[UH]||{};f[z4]!==!1&&(p=(f[u[eP]]||{})[d]||p)}return function(){return p.apply(l,arguments)}}var s=qu(null);BH(r,function(l){s[l]=o(e,r,l)});for(var a=VS(t),c=[];a&&!Hle(a)&&!zle(c,a);)BH(a,function(l){!s[l]&&Gle(a,l,!$4)&&(s[l]=o(e,a,l))}),c.push(a),a=VS(a);return s}function HTt(t,e,r,n){var o=null;if(t&&co(r,eP)){var s=t[UH]||qu(null);if(o=(s[r[eP]]||qu(null))[e],o||qH("Missing ["+e+"] "+FH),!o[Ule]&&s[z4]!==!1){for(var a=!co(t,e),c=VS(t),l=[];a&&c&&!Hle(c)&&!zle(l,c);){var u=c[e];if(u){a=u===n;break}l.push(c),c=VS(c)}try{a&&(t[e]=o),o[Ule]=1}catch{s[z4]=!1}}}return o}function GTt(t,e,r){var n=e[t];return n===r&&(n=VS(e)[t]),typeof n!==FH&&qH("["+t+"] is not a "+FH),n}function zTt(t,e,r,n,o){function s(l,u){var d=function(){var p=HTt(this,u,l,d)||GTt(u,l,d);return p.apply(this,arguments)};return d[Fle]=1,d}if(!OH(t)){var a=r[UH]=r[UH]||qu(null);if(!OH(a)){var c=a[e]=a[e]||qu(null);a[z4]!==!1&&(a[z4]=!!o),OH(c)||BH(r,function(l){Gle(r,l,!1)&&r[l]!==n[l]&&(c[l]=r[l],delete r[l],(!co(t,l)||t[l]&&!t[l][Fle])&&(t[l]=s(t,l)))})}}}function $Tt(t,e){if($4){for(var r=[],n=VS(e);n&&!Hle(n)&&!zle(r,n);){if(n===t)return!0;r.push(n),n=VS(n)}return!1}return!0}function Mle(t,e){return co(t,cg)?t.name||e||t9e:((t||{})[MH]||{}).name||e||t9e}function vr(t,e,r,n){co(t,cg)||qH("theClass is an invalid class definition.");var o=t[cg];$Tt(o,e)||qH("["+Mle(t)+"] not in hierarchy of ["+Mle(e)+"]");var s=null;co(o,eP)?s=o[eP]:(s=qTt+Mle(t,"_")+"$"+qle.n,qle.n++,o[eP]=s);var a=vr[o9e],c=!!a[LH];c&&n&&n[LH]!==void 0&&(c=!!n[LH]);var l=jTt(e),u=VTt(o,e,l,c);r(e,u);var d=!!$4&&!!a[Ble];d&&n&&(d=!!n[Ble]),zTt(o,s,e,l,d!==!1)}var DH,MH,cg,FH,UH,Fle,eP,qTt,Ule,z4,o9e,t9e,jle,NH,r9e,Ole,LH,Ble,Vle,$4,n9e,i9e,qle,ks=D(()=>{Dt();MH="constructor",cg="prototype",FH="function",UH="_dynInstFuncs",Fle="_isDynProxy",eP="_dynClass",qTt="_dynCls$",Ule="_dynInstChk",z4=Ule,o9e="_dfOpts",t9e="_unknown_",jle="__proto__",NH="_dyn"+jle,r9e="__dynProto$Gbl",Ole="_dynInstProto",LH="useBaseInst",Ble="setInstFuncs",Vle=Object,$4=Vle.getPrototypeOf,n9e=Vle.getOwnPropertyNames,i9e=ba(),qle=i9e[r9e]||(i9e[r9e]={o:(DH={},DH[Ble]=!0,DH[LH]=!0,DH),n:1e3});vr[o9e]=qle.o});var $le,s9e=D(()=>{"use strict";$le=100});var Po,Wle,jH=D(()=>{Dt();Po=rle,Wle=ile});var Jd,WTt,a9e=D(()=>{jH();Jd=Po({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),WTt=Po({Unknown:0,NonRetryableStatus:1,CleanStorage:2,MaxInStorageTimeExceeded:3})});var Hc,lb,bt,HS,GS,tP,lg,Zd,Vu,Rn,ub,Cr,Yf,VH,zS,ug,Qf,Gc,db,Kle,xa,pb,ts,HH,rP,nP,iP,fb,Yle,zc,W4,$S,GH,Xf,kl,oP,Jf,ep,$c,mb,WS,Rl,hb,zH,K4,Hu,$H,tp,Qle,Wc,Y4,KS,Xle,Jle,Zle,Q4,gb,YS,rp,WH,sP,eue,KH,QS,tue,aP,cP,vb,Un=D(()=>{Hc="toLowerCase",lb="blkVal",bt="length",HS="rdOnly",GS="notify",tP="warnToConsole",lg="throwInternal",Zd="setDf",Vu="watch",Rn="logger",ub="apply",Cr="push",Yf="splice",VH="hdlr",zS="cancel",ug="initialize",Qf="identifier",Gc="isInitialized",db="getPlugin",Kle="pollInternalLogs",xa="name",pb="time",ts="processNext",HH="getProcessTelContext",rP="getNotifyMgr",nP="addNotificationListener",iP="removeNotificationListener",fb="enabled",Yle="stopPollingInternalLogs",zc="unload",W4="onComplete",$S="version",GH="loggingLevelConsole",Xf="createNew",kl="teardown",oP="messageId",Jf="message",ep="isAsync",$c="diagLog",mb="_doTeardown",WS="update",Rl="getNext",hb="setNextPlugin",zH="protocol",K4="userAgent",Hu="split",$H="nodeType",tp="replace",Qle="logInternalMessage",Wc="type",Y4="handler",KS="status",Xle="itemsReceived",Jle="getResponseHeader",Zle="getAllResponseHeaders",Q4="isChildEvt",gb="data",YS="getCtx",rp="setCtx",WH="complete",sP="urlString",eue="sendPOST",KH="headers",QS="timeout",tue="setRequestHeader",aP="traceId",cP="spanId",vb="traceFlags"});function c9e(t,e){rue||(rue=xle("AggregationError",function(n,o){o[bt]>1&&(n.errors=o[1])}));var r=t||"One or more errors occurred.";throw Ce(e,function(n,o){r+=`
`.concat(o," > ").concat(et(n))}),new rue(r,e||[])}var rue,l9e=D(()=>{Dt();Un()});function yb(t,e){return YH(t,function(r){return e?e({value:r,rejected:!1}):r},function(r){return e?e({rejected:!0,reason:r}):r})}function YH(t,e,r,n){var o=t;return eb(t)?(e||r)&&(o=t.then(e,r)):e&&(o=e(t)),n&&u9e(o,n),o}function u9e(t,e){var r=t;return e&&(eb(t)?t.finally?r=t.finally(e):r=t.then(function(n){return e(),n},function(n){throw e(),n}):e()),r}var nue=D(()=>{Dt()});function d9e(t,e,r,n){iue=iue||{toString:function(){return"[[PromiseState]]"}},oue=oue||{toString:function(){return"[[PromiseResult]]"}},sue=sue||{toString:function(){return"[[PromiseIsHandled]]"}},Qi(t,iue,{get:e}),Qi(t,oue,{get:r}),Qi(t,sue,{get:n})}var iue,oue,sue,aue,p9e=D(()=>{Dt();aue=!1});var QH,cue=D(()=>{QH=["pending","resolving","resolved","rejected"]});function m9e(t,e,r,n){var o=Di();!XH&&(XH=YR(function(){var l;return o&&o.createEvent&&(l=o.createEvent("Event")),!!l&&l.initEvent},null));var s=XH.v?o.createEvent("Event"):n?new Event(e):{};if(r&&r(s),XH.v&&s.initEvent(e,!1,!0),s&&t[f9e])t[f9e](s);else{var a=t["on"+e];if(a)a(s);else{var c=yn("console");c&&(c.error||c.log)(e,et(s))}}}var f9e,XH,h9e=D(()=>{Dt();f9e="dispatchEvent"});var lP,lue=D(()=>{lP="Promise"});function g9e(t){return wt(t)?t.toString():et(t)}function y9e(t,e,r){var n=ab(arguments,3),o=0,s=!1,a,c=[],l=YTt++,u=X4.length>0?X4[X4.length-1]:void 0,d=!1,p=null,f;!uue&&(uue=og(lP+"RejectionEvent"));var m=function(I,w){try{X4.push(l),d=!0,p&&p.cancel(),p=null;var k=t(function(M,H){c.push(function(){try{var F=o===2?I:w,ue=Vt(F)?a:wt(F)?F(a):F;eb(ue)?ue.then(M,H):F?M(ue):o===3?H(ue):M(ue)}catch(Z){H(Z)}}),s&&b()},n);return k}finally{X4.pop()}},h=function(I){return m(void 0,I)},g=function(I){var w=I,k=I;return wt(I)&&(w=function(M){return I&&I(),M},k=function(M){throw I&&I(),M}),m(w,k)},v=function(){return QH[o]},b=function(){if(c.length>0){var I=c.slice();c=[],d=!0,e(I),p&&p.cancel(),p=null}},_=function(I,w){return function(k){if(o===w){if(I===2&&eb(k)){o=1,k.then(_(2,1),_(3,1));return}o=I,s=!0,a=k,b(),!d&&I===3&&!p&&(p=qc(x,QTt))}}},x=function(){if(!d)if(fle())process.emit(v9e,a,f);else{var I=Ni()||ba();m9e(I,KTt,function(w){return nn(w,"promise",{g:function(){return f}}),w.reason=a,w},!!uue.v)}};f={then:m,catch:h,finally:g},Qi(f,"state",{get:v}),aue&&d9e(f,v,function(){return F4(a)},function(){return d}),hle()&&(f[BS(11)]="IPromise");var S=function(){return"IPromise"+(aue?"["+l+(Vt(u)?"":":"+u)+"]":"")+" "+v()+(s?" - "+g9e(a):"")};return f.toString=S,function(){wt(r)||mi(lP+": executor is not a function - "+g9e(r));var w=_(3,0);try{r.call(f,_(2,0),w)}catch(k){w(k)}}(),f}function uP(t){return function(e){var r=ab(arguments,1);return t(function(n,o){try{var s=[],a=1;Ce(e,function(c,l){c&&(a++,YH(c,function(u){s[l]=u,--a===0&&n(s)},o))}),a--,a===0&&n(s)}catch(c){o(c)}},r)}}function dP(t){return function(e){var r=ab(arguments,1);return eb(e)?e:t(function(n){n(e)},r)}}function pP(t){return function(e){var r=ab(arguments,1);return t(function(n,o){o(e)},r)}}var v9e,KTt,X4,YTt,QTt,uue,JH=D(()=>{Dt();nue();p9e();cue();h9e();lue();v9e="unhandledRejection",KTt=v9e.toLowerCase(),X4=[],YTt=0,QTt=10});function b9e(t){var e=ya(t)?t:0;return function(r){qc(function(){XTt(r)},e)}}var XTt,_9e=D(()=>{Dt();XTt=function(t){Ce(t,function(e){try{e()}catch{}})}});function fP(t,e){return y9e(fP,b9e(e),t,e)}var Ocn,Mcn,Fcn,x9e=D(()=>{JH();_9e();Ocn=uP(fP),Mcn=dP(fP),Fcn=pP(fP)});function J4(t,e){!due&&(due=og(lP));var r=due.v;if(!r)return fP(t);wt(t)||mi(lP+": executor is not a function - "+et(t));var n=0;function o(){return QH[n]}var s=new r(function(a,c){function l(d){n=2,a(d)}function u(d){n=3,c(d)}t(l,u)});return Qi(s,"state",{get:o}),s}var due,Gcn,zcn,$cn,S9e=D(()=>{x9e();JH();cue();Dt();lue();Gcn=uP(J4),zcn=dP(J4),$cn=pP(J4)});function Za(t,e){return!pue&&(pue=Xd(function(){return J4})),pue.v.call(this,t,e)}var pue,fue,JTt,ZTt,I9e=D(()=>{Dt();JH();S9e();fue=uP(Za),JTt=dP(Za),ZTt=pP(Za)});var mP=D(()=>{nue();I9e()});var Pl,Ht,bb,Oi,ZH,Z4,dg,XS,Kc,JS,hP,_b,gP,Zf,eG,tG,rG,vP,nG,iG,C9e,Ao=D(()=>{Pl=void 0,Ht="",bb="channels",Oi="core",ZH="createPerfMgr",Z4="disabled",dg="extensionConfig",XS="extensions",Kc="processTelemetry",JS="priority",hP="eventsSent",_b="eventsDiscarded",gP="eventsSendRequest",Zf="perfEvent",eG="offlineEventsStored",tG="offlineBatchSent",rG="offlineBatchDrop",vP="getPerfMgr",nG="domain",iG="path",C9e="Not dynamic - "});function eEt(t,e){return function(){var r=arguments,n=hue(e);if(n){var o=n.listener;o&&o[t]&&o[t][ub](o,r)}}}function tEt(){var t=yn("Microsoft");return t&&(sG=t.ApplicationInsights),sG}function hue(t){var e=sG;return!e&&t.disableDbgExt!==!0&&(e=sG||tEt()),e?e.ChromeDbgExt:null}function T9e(t){if(!oG){oG={};for(var e=0;e<mue[bt];e++)oG[mue[e]]=eEt(mue[e],t)}return oG}var mue,sG,oG,gue=D(()=>{Dt();Un();Ao();mue=[hP,_b,gP,Zf],sG=null});function R9e(t,e){var r=!1;if(t){try{if(r=e in t,!r){var n=t[$d];n&&(r=e in n)}}catch{}if(!r)try{var o=new t;r=!Vt(o[e])}catch{}}return r}function Sue(t){k9e=t}function ZS(t){if(t&&k9e){var e=yn("__mockLocation");if(e)return e}return typeof location===tg&&location?location:yn(nEt)}function e3(){return typeof console!==$f?console:yn(iEt)}function em(){return!!(typeof JSON===tg&&JSON||yn(E9e)!==null)}function Xs(){return em()?JSON||yn(E9e):null}function t3(){return yn(oEt)}function r3(){return yn(sEt)}function xb(){var t=Ro();return t&&t.product?t.product===aEt:!1}function Sb(){var t=Ro();if(t&&(t[K4]!==yue||vue===null)){yue=t[K4];var e=(yue||Ht)[Hc]();vue=lo(e,_ue)||lo(e,xue)}return vue}function n3(t){if(t===void 0&&(t=null),!t){var e=Ro()||{};t=e?(e.userAgent||Ht)[Hc]():Ht}var r=(t||Ht)[Hc]();if(lo(r,_ue)){var n=Di()||{};return Math.max(parseInt(r[Hu](_ue)[1]),n[rEt]||0)}else if(lo(r,xue)){var o=parseInt(r[Hu](xue)[1]);if(o)return o+4}return null}function Yc(t){return(bue===null||t===!1)&&(bue=QR()&&!!Ro().sendBeacon),bue}function pg(t){var e=!1;try{e=!!yn("fetch");var r=yn("Request");e&&t&&r&&(e=R9e(r,"keepalive"))}catch{}return e}function i3(){return yP===null&&(yP=typeof XDomainRequest!==$f,yP&&bP()&&(yP=yP&&!R9e(yn(w9e),"withCredentials"))),yP}function bP(){var t=!1;try{var e=yn(w9e);t=!!e}catch{}return t}function P9e(t,e){if(t)for(var r=0;r<t[bt];r++){var n=t[r];if(n[xa]&&n[xa]===e)return n}return{}}function Iue(t){var e=Di();return e&&t?P9e(e.querySelectorAll("meta"),t).content:null}function Cue(t){var e,r=ag();if(r){var n=r.getEntriesByType("navigation")||[];e=P9e((n[bt]>0?n[0]:{}).serverTiming,t).description}return e}var rEt,nEt,iEt,E9e,oEt,sEt,aEt,_ue,xue,w9e,vue,yue,k9e,yP,bue,Ib=D(()=>{"use strict";Vc();Dt();Un();tm();Ao();rEt="documentMode",nEt="location",iEt="console",E9e="JSON",oEt="crypto",sEt="msCrypto",aEt="ReactNative",_ue="msie",xue="trident/",w9e="XMLHttpRequest",vue=null,yue=null,k9e=!1,yP=null,bue=null});function A9e(t){return t?'"'+t[tp](/\"/g,Ht)+'"':Ht}function Tue(t,e){var r=e3();if(r){var n="log";r[t]&&(n=t),wt(r[n])&&r[n](e)}}function np(t,e){return(t||{})[Rn]||new Cb(e)}function Eue(t){return t||new Cb}function ze(t,e,r,n,o,s){s===void 0&&(s=!1),Eue(t)[lg](e,r,n,o,s)}function ec(t,e){Eue(t)[tP](e)}function wue(t,e,r){Eue(t)[Qle](e,r)}var _P,D9e,cEt,lEt,uEt,dEt,pEt,e1,Cb,ip=D(()=>{"use strict";ks();Dt();Tb();Un();gue();Ib();Ao();D9e="warnToConsole",cEt="AI (Internal): ",lEt="AI: ",uEt="AITR_",dEt={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},pEt=(_P={},_P[0]=null,_P[1]="errorToConsole",_P[2]=D9e,_P[3]="debugToConsole",_P);e1=function(){function t(e,r,n,o){n===void 0&&(n=!1);var s=this;s[oP]=e,s[Jf]=(n?lEt:cEt)+e;var a=Ht;em()&&(a=Xs().stringify(o));var c=(r?" message:"+A9e(r):Ht)+(o?" props:"+A9e(a):Ht);s[Jf]+=c}return t.dataType="MessageData",t}();Cb=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var r=0,n={},o,s,a,c,l;vr(t,this,function(u){l=p(e||{}),u.consoleLoggingLevel=function(){return o},u[lg]=function(h,g,v,b,_){_===void 0&&(_=!1);var x=new e1(g,v,_,b);if(c)throw et(x);var S=pEt[h]||D9e;if(Vt(x[Jf]))m("throw"+(h===1?"Critical":"Warning"),x);else{if(_){var I=+x[oP];!n[I]&&o>=h&&(u[S](x[Jf]),n[I]=!0)}else o>=h&&u[S](x[Jf]);d(h,x)}},u.debugToConsole=function(h){Tue("debug",h),m("warning",h)},u[tP]=function(h){Tue("warn",h),m("warning",h)},u.errorToConsole=function(h){Tue("error",h),m("error",h)},u.resetInternalMessageCount=function(){r=0,n={}},u[Qle]=d,u[zc]=function(h){l&&l.rm(),l=null};function d(h,g){if(!f()){var v=!0,b=uEt+g[oP];if(n[b]?v=!1:n[b]=!0,v&&(h<=s&&(u.queue[Cr](g),r++,m(h===1?"error":"warn",g)),r===a)){var _="Internal events throttle limit per PageView reached for this app.",x=new e1(23,_,!1);u.queue[Cr](x),h===1?u.errorToConsole(_):u[tP](_)}}}function p(h){return Do(hi(h,dEt,u).cfg,function(g){var v=g.cfg;o=v[GH],s=v.loggingLevelTelemetry,a=v.maxMessageLimit,c=v.enableDebug})}function f(){return r>=a}function m(h,g){var v=hue(e||{});v&&v[$c]&&v[$c](h,g)}})}return t.__ieDyn=1,t}()});function rm(t){return!Pe(t)}function t1(t){var e=t;return e&&$t(e)&&(e=e[tp](mEt,function(r,n){return n.toUpperCase()}),e=e[tp](hEt,"_"),e=e[tp](gEt,function(r,n){return"_"+n})),e}function lo(t,e){return t&&e?Ja(t,e)!==-1:!1}function Al(t){return t&&t.toISOString()||""}function Yn(t){return Zy(t)?t[xa]:Ht}function Gu(t,e,r,n,o){var s=r;return t&&(s=t[e],s!==r&&(!o||o(s))&&(!n||n(r))&&(s=r,t[e]=s)),s}function o3(t,e,r){var n;return t?(n=t[e],!n&&Pe(n)&&(n=Vt(r)?{}:r,t[e]=n)):n=Vt(r)?{}:r,n}function L9e(t,e){var r=null,n=null;return wt(t)?r=t:n=t,function(){var o=arguments;if(r&&(n=r()),n)return n[e][ub](n,o)}}function kue(t,e,r){if(t&&e&&Kn(t)&&Kn(e)){var n=function(s){if($t(s)){var a=e[s];wt(a)?(!r||r(s,!0,e,t))&&(t[s]=L9e(e,s)):(!r||r(s,!1,e,t))&&(Bc(t,s)&&delete t[s],nn(t,s,{g:function(){return e[s]},s:function(c){e[s]=c}}))}};for(var o in e)n(o)}return t}function fg(t,e,r,n,o){t&&e&&r&&(o!==!1||Vt(t[e]))&&(t[e]=L9e(r,n))}function Dl(t,e,r,n){return t&&e&&Kn(t)&&mt(r)&&Ce(r,function(o){$t(o)&&fg(t,o,e,o,n)}),t}function Rue(t){return function(){function e(){var r=this;t&&it(t,function(n,o){r[n]=o})}return e}()}function zu(t){return t&&OS&&(t=jR(OS({},t))),t}function aG(t,e,r,n,o,s){var a=arguments,c=a[0]||{},l=a[bt],u=!1,d=1;for(l>0&&Wd(c)&&(u=c,c=a[d]||{},d++),Kn(c)||(c={});d<l;d++){var p=a[d],f=mt(p),m=Kn(p);for(var h in p){var g=f&&h in p||m&&Bc(p,h);if(g){var v=p[h],b=void 0;if(u&&v&&((b=mt(v))||es(v))){var _=c[h];b?mt(_)||(_=[]):es(_)||(_={}),v=aG(u,_,v)}v!==void 0&&(c[h]=v)}}}return c}function op(t){try{return t.responseText}catch{}return null}function r1(t,e){return t?"XDomainRequest,Response:"+op(t)||"":e}function mg(t,e){return t?"XMLHttpRequest,Status:"+t[KS]+",Response:"+op(t)||t.response||"":e}function hg(t,e){return e&&(ya(e)?t=[e].concat(t):mt(e)&&(t=e.concat(t))),t}function n1(t,e){try{if(t&&t!==""){var r=Xs().parse(t);if(r&&r[Xle]&&r[Xle]>=r.itemsAccepted&&r.itemsReceived-r.itemsAccepted===r.errors[bt])return r}}catch(n){ze(e,1,43,"Cannot parse the response. "+Yn(n),{response:t})}return null}function Pue(t,e,r,n,o,s){n===void 0&&(n=!1),o===void 0&&(o=!1);function a(l,u,d){try{l[u]=d}catch{}}var c=new XMLHttpRequest;return n&&a(c,vEt,n),r&&a(c,N9e,r),c.open(t,e,!o),r&&a(c,N9e,r),!o&&s&&a(c,yEt,s),c}function cG(t){var e={};if($t(t)){var r=Zr(t)[Hu](/[\r\n]+/);Ce(r,function(n){if(n){var o=n.indexOf(": ");if(o!==-1){var s=Zr(n.substring(0,o))[Hc](),a=Zr(n.substring(o+1));e[s]=a}else e[Zr(n)]=1}})}return e}function xP(t,e,r){if(!t[r]&&e&&e[Jle]){var n=e[Jle](r);n&&(t[r]=Zr(n))}return t}function gg(t,e){var r={};return t[Zle]?r=cG(t[Zle]()):e&&(r=xP(r,t,xEt),r=xP(r,t,bEt),r=xP(r,t,_Et)),r}var fEt,mEt,hEt,gEt,wln,vEt,N9e,yEt,bEt,_Et,xEt,tm=D(()=>{Vc();Dt();Un();ip();Ib();Ao();fEt="getPrototypeOf",mEt=/-([a-z])/g,hEt=/([^\w\d_$])/g,gEt=/^(\d+[\w\d_$])/,wln=Object[fEt];vEt="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",N9e="withCredentials",yEt="timeout";bEt="kill-duration",_Et="kill-duration-seconds",xEt="time-delta-millis"});function SEt(t){t<0&&(t>>>=0),s3=M9e+t&Eb,a3=F9e-t&Eb,U9e=!0}function IEt(){try{var t=Li()&2147483647;SEt((Math.random()*O9e^t)+t)}catch{}}function c3(t){return t>0?Math.floor(vg()/Eb*(t+1))>>>0:0}function vg(t){var e=0,r=t3()||r3();return r&&r.getRandomValues&&(e=r.getRandomValues(new Uint32Array(1))[0]&Eb),e===0&&Sb()&&(U9e||IEt(),e=B9e()&Eb),e===0&&(e=Math.floor(O9e*Math.random()|0)),t||(e>>>=0),e}function B9e(t){a3=36969*(a3&65535)+(a3>>16)&Eb,s3=18e3*(s3&65535)+(s3>>16)&Eb;var e=(a3<<16)+(s3&65535)>>>0&Eb|0;return t||(e>>>=0),e}function l3(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=vg()>>>0,n=0,o=Ht;o[bt]<t;)n++,o+=e.charAt(r&63),r>>>=6,n===5&&(r=(vg()<<2&4294967295|r&3)>>>0,n=0);return o}var O9e,Eb,M9e,F9e,U9e,s3,a3,lG=D(()=>{Dt();Un();Ib();Ao();O9e=4294967296,Eb=4294967295,M9e=123456789,F9e=987654321,U9e=!1,s3=M9e,a3=F9e});function j9e(t){return t[$H]===1||t[$H]===9||!+t[$H]}function EEt(t,e){var r=e[t.id];if(!r){r={};try{j9e(e)&&nn(e,t.id,{e:!1,v:r})}catch{}}return r}function Js(t,e){return e===void 0&&(e=!1),t1(t+TEt+++(e?"."+q9e:Ht)+CEt)}function uG(t){var e={id:Js("_aiData-"+(t||Ht)+"."+q9e),accept:function(r){return j9e(r)},get:function(r,n,o,s){var a=r[e.id];return a?a[t1(n)]:(s&&(a=EEt(e,r),a[t1(n)]=o),o)},kill:function(r,n){if(r&&r[n])try{delete r[n]}catch{}}};return e}var q9e,CEt,TEt,SP=D(()=>{Dt();Un();tm();Ao();lG();q9e="3.0.5",CEt="."+l3(6),TEt=0});function dG(t){return t&&Kn(t)&&(t.isVal||t.fb||Bc(t,"v")||Bc(t,"mrg")||Bc(t,"ref")||t.set)}function V9e(t,e,r){var n,o=r.dfVal||cH;if(e&&r.fb){var s=r.fb;mt(s)||(s=[s]);for(var a=0;a<s[bt];a++){var c=s[a],l=e[c];if(o(l)?n=l:t&&(l=t.cfg[c],o(l)&&(n=l),t.set(t.cfg,si(c),l)),o(n))break}}return!o(n)&&o(r.v)&&(n=r.v),n}function Aue(t,e,r){var n=r;if(r&&dG(r)&&(n=V9e(t,e,r)),n){dG(n)&&(n=Aue(t,e,n));var o;mt(n)?(o=[],o[bt]=n[bt]):es(n)&&(o={}),o&&(it(n,function(s,a){a&&dG(a)&&(a=Aue(t,e,a)),o[s]=a}),n=o)}return n}function u3(t,e,r,n){var o,s,a,c=n,l,u,d,p;dG(c)?(o=c.isVal,s=c.set,d=c[HS],p=c[lb],l=c.mrg,u=c.ref,!u&&Vt(u)&&(u=!!l),a=V9e(t,e,c)):a=n,p&&t[lb](e,r);var f,m=!0,h=e[r];(h||!Pe(h))&&(f=h,m=!1,o&&f!==a&&!o(f)&&(f=a,m=!0),s&&(f=s(f,a,e),m=f===a)),m?a?f=Aue(t,e,a):f=a:(es(f)||mt(a))&&l&&a&&(es(a)||mt(a))&&it(a,function(g,v){u3(t,f,g,v)}),t.set(e,r,f),u&&t.ref(e,r),d&&t[HS](e,r)}var Due=D(()=>{Dt();Un()});function Nue(t){if(t){var e;if(mt(t)?(e=[],e[bt]=t[bt]):es(t)&&(e={}),e)return it(t,function(r,n){e[r]=Nue(n)}),e}return t}function d3(t){if(t){var e=t[nm]||t;if(e.cfg&&(e.cfg===t||e.cfg[nm]===e))return e}return null}function p3(t){if(t&&(es(t)||mt(t)))try{t[H9e]=!0}catch{}return t}function Lue(t){if(t)try{t[G9e]=!0}catch{}return t}function pG(t,e,r){var n=!1;return r&&!t[e.blkVal]&&(n=r[G9e],!n&&!r[H9e]&&(n=es(r)||mt(r))),n}function fG(t){mi("InvalidAccess:"+t)}var nm,H9e,G9e,mG=D(()=>{Dt();Un();nm=H4("[[ai_dynCfg_1]]"),H9e=H4("[[ai_blkDynCfg_1]]"),G9e=H4("[[ai_frcDynCfg_1]]")});function kEt(t,e,r){mt(e)&&Ce(wEt,function(n){var o=e[n];e[n]=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=o[ub](this,s);return f3(t,e,r,"Patching"),c}})}function hG(t,e){var r=LS(t,e);return r&&r.get}function REt(t,e,r,n){var o={n:r,h:[],trk:function(u){u&&u.fn&&($r(o.h,u)===-1&&o.h[Cr](u),t.trk(u,o))},clr:function(u){var d=$r(o.h,u);d!==-1&&o.h[Yf](d,1)}},s=!0,a=!1;function c(){s&&(a=a||pG(c,t,n),n&&!n[nm]&&a&&(n=f3(t,n,r,"Converting")),s=!1);var u=t.act;return u&&o.trk(u),n}c[t.prop]={chng:function(){t.add(o)}};function l(u){if(n!==u){c[t.ro]&&!t.upd&&fG("["+r+"] is read-only:"+et(e)),s&&(a=a||pG(c,t,n),s=!1);var d=a&&c[t.rf];if(a)if(d){it(n,function(f){n[f]=u?u[f]:Pl});try{it(u,function(f,m){m3(t,n,f,m)}),u=n}catch(f){IP((t.hdlr||{})[Rn],r,"Assigning",f),a=!1}}else n&&n[nm]&&it(n,function(f){var m=hG(n,f);if(m){var h=m[t.prop];h&&h.chng()}});if(u!==n){var p=u&&pG(c,t,u);!d&&p&&(u=f3(t,u,r,"Converting")),n=u,a=p}t.add(o)}}nn(e,o.n,{g:c,s:l})}function m3(t,e,r,n){if(e){var o=hG(e,r),s=o&&!!o[t.prop];s?e[r]=n:REt(t,e,r,n)}return e}function gG(t,e,r,n){if(e){var o=hG(e,r),s=o&&!!o[t.prop],a=n&&n[0],c=n&&n[1],l=n&&n[2];if(!s){if(l)try{p3(e)}catch(u){IP((t.hdlr||{})[Rn],r,"Blocking",u)}try{m3(t,e,r,e[r]),o=hG(e,r)}catch(u){IP((t.hdlr||{})[Rn],r,"State",u)}}a&&(o[t.rf]=a),c&&(o[t.ro]=c),l&&(o[t.blkVal]=!0)}return e}function f3(t,e,r,n){try{it(e,function(o,s){m3(t,e,o,s)}),e[nm]||(Qi(e,nm,{get:function(){return t[VH]}}),kEt(t,e,r))}catch(o){IP((t.hdlr||{})[Rn],r,n,o)}return e}var wEt,IP,z9e=D(()=>{Dt();Ao();Un();mG();wEt=["push","pop","shift","unshift","splice"],IP=function(t,e,r,n){t&&t[lg](3,108,"".concat(r," [").concat(e,"] failed - ")+et(n))}});function $9e(t){var e,r=qS(h3+"get"+t.uid+g3),n=qS(h3+"ro"+t.uid+g3),o=qS(h3+"rf"+t.uid+g3),s=qS(h3+"blkVal"+t.uid+g3),a=qS(h3+"dtl"+t.uid+g3),c=null,l=null,u;function d(h,g){var v=u.act;try{u.act=h,h&&h[a]&&(Ce(h[a],function(_){_.clr(h)}),h[a]=[]),g({cfg:t.cfg,set:t.set.bind(t),setDf:t[Zd].bind(t),ref:t.ref.bind(t),rdOnly:t[HS].bind(t)})}catch(_){var b=t[Rn];throw b&&b[lg](1,107,et(_)),_}finally{u.act=v||null}}function p(){if(c){var h=c;c=null,l&&l[zS](),l=null;var g=[];if(Ce(h,function(v){if(v&&(v[a]&&(Ce(v[a],function(b){b.clr(v)}),v[a]=null),v.fn))try{d(v,v.fn)}catch(b){g[Cr](b)}}),c)try{p()}catch(v){g[Cr](v)}g[bt]>0&&c9e("Watcher error(s): ",g)}}function f(h){if(h&&h.h[bt]>0){c||(c=[]),l||(l=qc(function(){l=null,p()},0));for(var g=0;g<h.h[bt];g++){var v=h.h[g];v&&$r(c,v)===-1&&c[Cr](v)}}}function m(h,g){if(h){var v=h[a]=h[a]||[];$r(v,g)===-1&&v[Cr](g)}}return u=(e={prop:r,ro:n,rf:o},e[lb]=s,e[VH]=t,e.add=f,e[GS]=p,e.use=d,e.trk=m,e),u}var h3,g3,W9e=D(()=>{Dt();l9e();Un();h3="[[ai_",g3="]]"});function PEt(t,e){var r={fn:e,rm:function(){r.fn=null,t=null,e=null}};return t.use(r,e),r}function AEt(t,e,r){var n,o=d3(e);if(o)return o;var s=Js("dyncfg",!0),a=e&&r!==!1?e:Nue(e),c;function l(){c[GS]()}function u(b,_,x){try{b=m3(c,b,_,x)}catch(S){IP(t,_,"Setting value",S)}return b[_]}function d(b){return PEt(c,b)}function p(b,_){c.use(null,function(x){var S=c.upd;try{Vt(_)||(c.upd=_),b(x)}finally{c.upd=S}})}function f(b,_){var x;return gG(c,b,_,(x={},x[0]=!0,x))[_]}function m(b,_){var x;return gG(c,b,_,(x={},x[1]=!0,x))[_]}function h(b,_){var x;return gG(c,b,_,(x={},x[2]=!0,x))[_]}function g(b,_){return _&&it(_,function(x,S){u3(v,b,x,S)}),b}var v=(n={uid:null,cfg:a},n[Rn]=t,n[GS]=l,n.set=u,n[Zd]=g,n[Vu]=d,n.ref=f,n[HS]=m,n[lb]=h,n._block=p,n);return nn(v,"uid",{c:!1,e:!1,w:!1,v:s}),c=$9e(v),f3(c,a,"config","Creating"),v}function DEt(t,e){t?(t[tP](e),t[lg](2,108,e)):fG(e)}function hi(t,e,r,n){var o=AEt(r,t||{},n);return e&&o[Zd](o.cfg,e),o}function Do(t,e,r){var n=t[nm]||t;return n.cfg&&(n.cfg===t||n.cfg[nm]===n)?n[Vu](e):(DEt(r,C9e+et(t)),hi(t,null,r)[Vu](e))}var Tb=D(()=>{Dt();SP();Ao();Un();Due();z9e();W9e();mG()});function yg(t,e){if(t&&t[zc])return t[zc](e)}function vG(t,e,r){var n;return r||(n=Za(function(o){r=o})),t&&JR(t)>0?yb(yg(t[0],e),function(){vG(ab(t,1),e,r)}):r(),n}var Oue=D(()=>{mP();Dt();Un()});var K9e,Mue,Fue=D(()=>{K9e=500,Mue="Microsoft_ApplicationInsights_BypassAjaxInstrumentation"});function NEt(t,e,r){return!t&&Pe(t)?e:Wd(t)?t:si(t)[Hc]()==="true"}function Uue(t){return{mrg:!0,v:t}}function CP(t,e,r){return{fb:r,isVal:t,v:e}}function $u(t,e){return{fb:e,set:NEt,v:!!t}}var Bue=D(()=>{Dt();Un()});function zue(){!im&&(im=Xd(function(){return Di()}))}function OEt(t,e){var r=bg[wb]||_G[wb];return r||(r=bg[wb]=bg(t,e),_G[wb]=r),r}function bG(t){return t?t.isEnabled():!0}function i7e(t,e){return e&&t&&mt(t.ignoreCookies)?$r(t.ignoreCookies,e)!==-1:!1}function MEt(t,e){return e&&t&&mt(t.blockedCookies)&&$r(t.blockedCookies,e)!==-1?!0:i7e(t,e)}function e7e(t,e){var r=e[fb];if(Pe(r)){var n=void 0;Vt(t[X9e])||(n=!t[X9e]),Vt(t[Hue])||(n=!t[Hue]),r=n}return r}function $ue(t,e){var r;if(t)r=t.getCookieMgr();else if(e){var n=e.cookieCfg;n&&n[wb]?r=n[wb]:r=bg(e)}return r||(r=OEt(e,(t||{})[Rn])),r}function bg(t,e){var r,n,o,s,a,c,l,u,d;t=hi(t||_G,null,e).cfg,a=Do(t,function(f){f[Zd](f.cfg,LEt),n=f.ref(f.cfg,"cookieCfg"),o=n[iG]||"/",s=n[nG],c=e7e(t,n)!==!1,l=n.getCookie||FEt,u=n.setCookie||n7e,d=n.delCookie||n7e},e);var p=(r={isEnabled:function(){var f=e7e(t,n)!==!1&&c&&TP(e),m=_G[wb];return f&&m&&p!==m&&(f=bG(m)),f},setEnabled:function(f){c=f!==!1,n[fb]=f},set:function(f,m,h,g,v){var b=!1;if(bG(p)&&!MEt(n,f)){var _={},x=Zr(m||Ht),S=Ja(x,";");if(S!==-1&&(x=Zr(ib(m,S)),_=o7e(Yi(m,S+1))),Gu(_,nG,g||s,Mu,Vt),!Pe(h)){var I=Sb();if(Vt(_[jue])){var w=Li(),k=w+h*1e3;if(k>0){var M=new Date;M.setTime(k),Gu(_,jue,t7e(M,I?Y9e:Q9e)||t7e(M,I?Y9e:Q9e)||Ht,Mu)}}I||Gu(_,"max-age",Ht+h,null,Vt)}var H=ZS();H&&H[zH]==="https:"&&(Gu(_,"secure",null,null,Vt),Vue===null&&(Vue=!xG((Ro()||{})[K4])),Vue&&Gu(_,"SameSite","None",null,Vt)),Gu(_,iG,v||o,null,Vt),u(f,r7e(x,_)),b=!0}return b},get:function(f){var m=Ht;return bG(p)&&!i7e(n,f)&&(m=l(f)),m},del:function(f,m){var h=!1;return bG(p)&&(h=p.purge(f,m)),h},purge:function(f,m){var h,g=!1;if(TP(e)){var v=(h={},h[iG]=m||"/",h[jue]="Thu, 01 Jan 1970 00:00:01 GMT",h);Sb()||(v["max-age"]="0"),d(f,r7e(Ht,v)),g=!0}return g}},r[zc]=function(f){a&&a.rm(),a=null},r);return p[wb]=p,p}function TP(t){if(yG===null){yG=!1,!im&&zue();try{var e=im.v||{};yG=e[Gue]!==void 0}catch(r){ze(t,2,68,"Cannot access document.cookie - "+Yn(r),{exception:et(r)})}}return yG}function o7e(t){var e={};if(t&&t[bt]){var r=Zr(t)[Hu](";");Ce(r,function(n){if(n=Zr(n||Ht),n){var o=Ja(n,"=");o===-1?e[n]=null:e[Zr(ib(n,o))]=Zr(Yi(n,o+1))}})}return e}function t7e(t,e){return wt(t[e])?t[e]():null}function r7e(t,e){var r=t||Ht;return it(e,function(n,o){r+="; "+n+(Pe(o)?Ht:"="+o)}),r}function FEt(t){var e=Ht;if(!im&&zue(),im.v){var r=im.v[Gue]||Ht;J9e!==r&&(Z9e=o7e(r),J9e=r),e=Zr(Z9e[t]||Ht)}return e}function n7e(t,e){!im&&zue(),im.v&&(im.v[Gue]=t+"="+e)}function xG(t){return $t(t)?!!(lo(t,"CPU iPhone OS 12")||lo(t,"iPad; CPU OS 12")||lo(t,"Macintosh; Intel Mac OS X 10_14")&&lo(t,"Version/")&&lo(t,"Safari")||lo(t,"Macintosh; Intel Mac OS X 10_14")&&cb(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||lo(t,"Chrome/5")||lo(t,"Chrome/6")||lo(t,"UnrealEngine")&&!lo(t,"Chrome")||lo(t,"UCBrowser/12")||lo(t,"UCBrowser/11")):!1}var que,i1,Y9e,Q9e,Gue,jue,X9e,Hue,wb,yG,Vue,J9e,im,Z9e,_G,LEt,Wue=D(()=>{Dt();Bue();Tb();Un();ip();Ib();tm();Ao();Y9e="toGMTString",Q9e="toUTCString",Gue="cookie",jue="expires",X9e="isCookieUseDisabled",Hue="disableCookiesUsage",wb="_ckMgr",yG=null,Vue=null,J9e=null,Z9e={},_G={},LEt=(que={cookieCfg:Uue((i1={},i1[nG]={fb:"cookieDomain",dfVal:rm},i1.path={fb:"cookiePath",dfVal:rm},i1.enabled=Pl,i1.ignoreCookies=Pl,i1.blockedCookies=Pl,i1)),cookieDomain:Pl,cookiePath:Pl},que[Hue]=Pl,que)});function kb(t,e,r,n){Ce(t,function(o){if(o&&o[e])if(r)qc(function(){return n(o)},0);else try{n(o)}catch{}})}var UEt,v3,Kue=D(()=>{ks();mP();Dt();Tb();Un();Ao();UEt={perfEvtsSendAll:!1};v3=function(){function t(e){this.listeners=[];var r,n,o=[],s=hi(e,UEt);n=s[Vu](function(a){r=!!a.cfg.perfEvtsSendAll}),vr(t,this,function(a){nn(a,"listeners",{g:function(){return o}}),a[nP]=function(c){o[Cr](c)},a[iP]=function(c){for(var l=$r(o,c);l>-1;)o[Yf](l,1),l=$r(o,c)},a[hP]=function(c){kb(o,hP,!0,function(l){l[hP](c)})},a[_b]=function(c,l){kb(o,_b,!0,function(u){u[_b](c,l)})},a[gP]=function(c,l){kb(o,gP,l,function(u){u[gP](c,l)})},a[Zf]=function(c){c&&(r||!c[Q4]())&&kb(o,Zf,!1,function(l){c[ep]?qc(function(){return l[Zf](c)},0):l[Zf](c)})},a[eG]=function(c){c&&c[bt]&&kb(o,eG,!0,function(l){l[eG](c)})},a[tG]=function(c){c&&c[gb]&&kb(o,tG,!0,function(l){l[tG](c)})},a[rG]=function(c,l){if(c>0){var u=l||0;kb(o,rG,!0,function(d){d[rG](c,u)})}},a[zc]=function(c){var l=function(){n&&n.rm(),n=null,o=[]},u;if(kb(o,"unload",!1,function(d){var p=d[zc](c);p&&(u||(u=[]),u[Cr](p))}),u)return Za(function(d){return yb(fue(u),function(){l(),d()})});l()}})}return t.__ieDyn=1,t}()});function Ji(t,e,r,n,o){if(t){var s=t;if(s[vP]&&(s=s[vP]()),s){var a=void 0,c=s[YS](Yue);try{if(a=s.create(e(),n,o),a){if(c&&a[rp]&&(a[rp](o1[Que],c),c[YS]&&c[rp])){var l=c[YS](o1[y3]);l||(l=[],c[rp](o1[y3],l)),l[Cr](a)}return s[rp](Yue,a),r(a)}}catch(u){a&&a[rp]&&a[rp]("exception",u)}finally{a&&s.fire(a),s[rp](Yue,c)}}}return r()}function Xue(){return BEt}var EP,Que,y3,BEt,o1,b3,Yue,SG=D(()=>{ks();Dt();Un();Ao();EP="ctx",Que="ParentContextKey",y3="ChildrenContextKey",BEt=null,o1=function(){function t(e,r,n){var o=this;if(o.start=Li(),o[xa]=e,o[ep]=n,o[Q4]=function(){return!1},wt(r)){var s;nn(o,"payload",{g:function(){return!s&&wt(r)&&(s=r(),r=null),s}})}o[YS]=function(a){return a?a===t[Que]||a===t[y3]?o[a]:(o[EP]||{})[a]:null},o[rp]=function(a,c){if(a)if(a===t[Que])o[a]||(o[Q4]=function(){return!0}),o[a]=c;else if(a===t[y3])o[a]=c;else{var l=o[EP]=o[EP]||{};l[a]=c}},o[WH]=function(){var a=0,c=o[YS](t[y3]);if(mt(c))for(var l=0;l<c[bt];l++){var u=c[l];u&&(a+=u[pb])}o[pb]=Li()-o.start,o.exTime=o[pb]-a,o[WH]=function(){}}}return t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),b3=function(){function t(e){this.ctx={},vr(t,this,function(r){r.create=function(n,o,s){return new o1(n,o,s)},r.fire=function(n){n&&(n[WH](),e&&wt(e[Zf])&&e[Zf](n))},r[rp]=function(n,o){if(n){var s=r[EP]=r[EP]||{};s[n]=o}},r[YS]=function(n){return(r[EP]||{})[n]}})}return t.__ieDyn=1,t}(),Yue="CoreUtils.doPerf"});function _3(){var t=s1();return Yi(t,0,8)+"-"+Yi(t,8,12)+"-"+Yi(t,12,16)+"-"+Yi(t,16,20)+"-"+Yi(t,20)}function s1(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Ht,r,n=0;n<4;n++)r=vg(),e+=t[r&15]+t[r>>4&15]+t[r>>8&15]+t[r>>12&15]+t[r>>16&15]+t[r>>20&15]+t[r>>24&15]+t[r>>28&15];var o=t[8+(vg()&3)|0];return Yd(e,0,8)+Yd(e,9,4)+"4"+Yd(e,13,3)+o+Yd(e,16,3)+Yd(e,19,12)}var Jue=D(()=>{"use strict";Dt();Ao();lG()});function _g(t,e,r){return t&&t[bt]===e&&t!==r?!!t.match(/^[\da-f]*$/i):!1}function a7e(t,e,r){return _g(t,e)?t:r}function c7e(t){(isNaN(t)||t<0||t>255)&&(t=1);for(var e=t.toString(16);e[bt]<2;)e="0"+e;return e}function x3(t,e,r,n){var o;return o={},o[$S]=_g(n,2,ede)?n:Zue,o[aP]=om(t)?t:s1(),o[cP]=sm(e)?e:ib(s1(),16),o.traceFlags=r>=0&&r<=255?r:1,o}function a1(t,e){var r;if(!t||(mt(t)&&(t=t[0]||""),!t||!$t(t)||t[bt]>8192))return null;if(t.indexOf(",")!==-1){var n=t[Hu](",");t=n[e>0&&n[bt]>e?e:0]}var o=qEt.exec(Zr(t));return!o||o[1]===ede||o[2]===IG||o[3]===CG?null:(r={version:(o[1]||Ht)[Hc](),traceId:(o[2]||Ht)[Hc](),spanId:(o[3]||Ht)[Hc]()},r[vb]=parseInt(o[4],16),r)}function om(t){return _g(t,32,IG)}function sm(t){return _g(t,16,CG)}function wP(t){return!(!t||!_g(t[$S],2,ede)||!_g(t[aP],32,IG)||!_g(t[cP],16,CG)||!_g(c7e(t[vb]),2))}function S3(t){return wP(t)?(t[vb]&s7e)===s7e:!1}function I3(t){if(t){var e=c7e(t[vb]);_g(e,2)||(e="01");var r=t[$S]||Zue;return r!=="00"&&r!=="ff"&&(r=Zue),"".concat(r.toLowerCase(),"-").concat(a7e(t.traceId,32,IG).toLowerCase(),"-").concat(a7e(t.spanId,16,CG).toLowerCase(),"-").concat(e.toLowerCase())}return""}function C3(t){var e="traceparent",r=a1(Iue(e),t);return r||(r=a1(Cue(e),t)),r}var qEt,Zue,ede,IG,CG,s7e,tde=D(()=>{Dt();Un();Jue();Ib();Ao();qEt=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]{1,64})?$/i,Zue="00",ede="ff",IG="00000000000000000000000000000000",CG="0000000000000000",s7e=1});function xg(t){return jEt.get(t,"state",{},!0)}function rde(t,e){for(var r=[],n=null,o=t[Rl](),s;o;){var a=o[db]();if(a){n&&n[hb]&&a[Kc]&&n[hb](a),s=xg(a);var c=!!s[Gc];a[Gc]&&(c=a[Gc]()),c||r[Cr](a),n=a,o=o[Rl]()}}Ce(r,function(l){var u=t[Oi]();l[ug](t.getCfg(),u,e,t[Rl]()),s=xg(l),!l[Oi]&&!s[Oi]&&(s[Oi]=u),s[Gc]=!0,delete s[kl]})}function TG(t){return t.sort(function(e,r){var n=0;if(r){var o=r[Kc];e[Kc]?n=o?e[JS]-r[JS]:1:o&&(n=-1)}else n=e?1:-1;return n})}function l7e(t){var e={};return{getName:function(){return e[xa]},setName:function(r){t&&t.setName(r),e[xa]=r},getTraceId:function(){return e[aP]},setTraceId:function(r){t&&t.setTraceId(r),om(r)&&(e[aP]=r)},getSpanId:function(){return e[cP]},setSpanId:function(r){t&&t.setSpanId(r),sm(r)&&(e[cP]=r)},getTraceFlags:function(){return e[vb]},setTraceFlags:function(r){t&&t.setTraceFlags(r),e[vb]=r}}}var jEt,nde=D(()=>{"use strict";Dt();Un();SP();Ao();tde();jEt=uG("plugin")});function HEt(t,e,r){for(;t;){if(t[db]()===r)return t;t=t[Rl]()}return Rb([r],e.config||{},e)}function ide(t,e,r,n){var o=null,s=[];e||(e=hi({},null,r[Rn])),n!==null&&(o=n?HEt(t,r,n):t);var a={_next:l,ctx:{core:function(){return r},diagLog:function(){return np(r,e.cfg)},getCfg:function(){return e.cfg},getExtCfg:d,getConfig:p,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(m){o=m},iterate:f,onComplete:c}};function c(m,h){for(var g=[],v=2;v<arguments.length;v++)g[v-2]=arguments[v];m&&s[Cr]({func:m,self:Vt(h)?a.ctx:h,args:g})}function l(){var m=o;if(o=m?m[Rl]():null,!m){var h=s;h&&h[bt]>0&&(Ce(h,function(g){try{g.func.call(g.self,g.args)}catch(v){ze(r[Rn],2,73,"Unexpected Exception during onComplete - "+et(v))}}),s=[])}return m}function u(m,h){var g=null,v=e.cfg;if(v&&m){var b=v[dg];!b&&h&&(b={}),v[dg]=b,b=e.ref(v,dg),b&&(g=b[m],!g&&h&&(g={}),b[m]=g,g=e.ref(b,m))}return g}function d(m,h){var g=u(m,!0);return h&&it(h,function(v,b){if(Pe(g[v])){var _=e.cfg[v];(_||!Pe(_))&&(g[v]=_)}u3(e,g,v,b)}),e[Zd](g,h)}function p(m,h,g){g===void 0&&(g=!1);var v,b=u(m,!1),_=e.cfg;return b&&(b[h]||!Pe(b[h]))?v=b[h]:(_[h]||!Pe(_[h]))&&(v=_[h]),v||!Pe(v)?v:g}function f(m){for(var h;h=a._next();){var g=h[db]();g&&m(g)}}return a}function tc(t,e,r,n){var o=hi(e),s=ide(t,o,r,n),a=s.ctx;function c(u){var d=s._next();return d&&d[Kc](u,a),!d}function l(u,d){return u===void 0&&(u=null),mt(u)&&(u=Rb(u,o.cfg,r,d)),tc(u||a[Rl](),o.cfg,r,d)}return a[ts]=c,a[Xf]=l,a}function kP(t,e,r){var n=hi(e.config),o=ide(t,n,e,r),s=o.ctx;function a(l){var u=o._next();return u&&u[zc](s,l),!u}function c(l,u){return l===void 0&&(l=null),mt(l)&&(l=Rb(l,n.cfg,e,u)),kP(l||s[Rl](),e,u)}return s[ts]=a,s[Xf]=c,s}function T3(t,e,r){var n=hi(e.config),o=ide(t,n,e,r),s=o.ctx;function a(l){return s.iterate(function(u){wt(u[WS])&&u[WS](s,l)})}function c(l,u){return l===void 0&&(l=null),mt(l)&&(l=Rb(l,n.cfg,e,u)),T3(l||s[Rl](),e,u)}return s[ts]=a,s[Xf]=c,s}function Rb(t,e,r,n){var o=null,s=!n;if(mt(t)&&t[bt]>0){var a=null;Ce(t,function(c){if(!s&&n===c&&(s=!0),s&&c&&wt(c[Kc])){var l=GEt(c,e,r);o||(o=l),a&&a._setNext(l),a=l}})}return n&&!o?Rb([n],e,r):o}function GEt(t,e,r){var n=null,o=wt(t[Kc]),s=wt(t[hb]),a;t?a=t[Qf]+"-"+t[JS]+"-"+p7e++:a="Unknown-0-"+p7e++;var c={getPlugin:function(){return t},getNext:function(){return n},processTelemetry:d,unload:p,update:f,_id:a,_setNext:function(m){n=m}};function l(){var m;return t&&wt(t[d7e])&&(m=t[d7e]()),m||(m=tc(c,e,r)),m}function u(m,h,g,v,b){var _=!1,x=t?t[Qf]:VEt,S=m[u7e];return S||(S=m[u7e]={}),m.setNext(n),t&&Ji(m[Oi](),function(){return x+":"+g},function(){S[a]=!0;try{var I=n?n._id:Ht;I&&(S[I]=!1),_=h(m)}catch(k){var w=n?S[n._id]:!0;w&&(_=!0),(!n||!w)&&ze(m[$c](),1,73,"Plugin ["+x+"] failed during "+g+" - "+et(k)+", run flags: "+et(S))}},v,b),_}function d(m,h){h=h||l();function g(v){if(!t||!o)return!1;var b=xg(t);return b[kl]||b[Z4]?!1:(s&&t[hb](n),t[Kc](m,v),!0)}u(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[ts](m)}function p(m,h){function g(){var v=!1;if(t){var b=xg(t),_=t[Oi]||b[Oi];t&&(!_||_===m.core())&&!b[kl]&&(b[Oi]=null,b[kl]=!0,b[Gc]=!1,t[kl]&&t[kl](m,h)===!0&&(v=!0))}return v}u(m,g,"unload",function(){},h[ep])||m[ts](h)}function f(m,h){function g(){var v=!1;if(t){var b=xg(t),_=t[Oi]||b[Oi];t&&(!_||_===m.core())&&!b[kl]&&t[WS]&&t[WS](m,h)===!0&&(v=!0)}return v}u(m,g,"update",function(){},!1)||m[ts](h)}return Wf(c)}var VEt,u7e,d7e,p7e,ode,EG=D(()=>{"use strict";Dt();Due();Tb();Un();ip();tm();Ao();SG();nde();VEt="TelemetryPluginChain",u7e="_hasRun",d7e="_getTelCtx",p7e=0;ode=function(){function t(e,r,n,o){var s=this,a=tc(e,r,n,o);Dl(s,a,Zo(a))}return t}()});function c1(){var t=[];function e(n){n&&t[Cr](n)}function r(n,o){Ce(t,function(s){try{s(n,o)}catch(a){ze(n[$c](),2,73,"Unexpected error calling unload handler - "+et(a))}}),t=[]}return{add:e,run:r}}var wG=D(()=>{Dt();Un();ip()});function kG(){var t=[];function e(n){var o=t;t=[],Ce(o,function(s){try{(s.rm||s.remove).call(s)}catch(a){ze(n,2,73,"Unloading:"+et(a))}})}function r(n){n&&Bu(t,n)}return{run:e,add:r}}var sde=D(()=>{Dt();ip()});var ade,Pb,zEt,Sg,cde=D(()=>{"use strict";ks();Dt();Tb();Un();ip();tm();Ao();EG();wG();sde();Pb="getPlugin",zEt=(ade={},ade[dg]={isVal:rm,v:{}},ade),Sg=function(){function t(){var e=this,r,n,o,s,a;u(),vr(t,e,function(d){d[ug]=function(p,f,m,h){l(p,f,h),r=!0},d[kl]=function(p,f){var m,h=d[Oi];if(!h||p&&h!==p[Oi]())return;var g,v=!1,b=p||kP(null,h,o&&o[Pb]?o[Pb]():o),_=f||(m={reason:0},m[ep]=!1,m);function x(){v||(v=!0,s.run(b,f),a.run(b[$c]()),g===!0&&b[ts](_),u())}return!d[mb]||d[mb](b,_,x)!==!0?x():g=!0,g},d[WS]=function(p,f){var m=d[Oi];if(!m||p&&m!==p[Oi]())return;var h,g=!1,v=p||T3(null,m,o&&o[Pb]?o[Pb]():o),b=f||{reason:0};function _(){g||(g=!0,l(v.getCfg(),v.core(),v[Rl]()))}return!d._doUpdate||d._doUpdate(v,b,_)!==!0?_():h=!0,h},fg(d,"_addUnloadCb",function(){return s},"add"),fg(d,"_addHook",function(){return a},"add"),nn(d,"_unloadHooks",{g:function(){return a}})}),e[$c]=function(d){return c(d)[$c]()},e[Gc]=function(){return r},e.setInitialized=function(d){r=d},e[hb]=function(d){o=d},e[ts]=function(d,p){p?p[ts](d):o&&wt(o[Kc])&&o[Kc](d,null)},e._getTelCtx=c;function c(d){d===void 0&&(d=null);var p=d;if(!p){var f=n||tc(null,{},e[Oi]);o&&o[Pb]?p=f[Xf](null,o[Pb]):p=f[Xf](null,o)}return p}function l(d,p,f){hi(d,zEt,np(p)),!f&&p&&(f=p[HH]()[Rl]());var m=o;o&&o[Pb]&&(m=o[Pb]()),e[Oi]=p,n=tc(f,d,p,m)}function u(){r=!1,e[Oi]=null,n=null,o=null,a=kG(),s=c1()}}return t.__ieDyn=1,t}()});function $Et(t,e,r){var n={id:e,fn:r};Bu(t,n);var o={remove:function(){Ce(t,function(s,a){if(s.id===n.id)return t[Yf](a,1),-1})}};return o}function WEt(t,e,r){for(var n=!1,o=t[bt],s=0;s<o;++s){var a=t[s];if(a)try{if(a.fn[ub](null,[e])===!1){n=!0;break}}catch(c){ze(r,2,64,"Telemetry initializer failed: "+Yn(c),{exception:et(c)},!0)}}return!n}var f7e,m7e=D(()=>{Vc();ks();Dt();Un();cde();ip();tm();Ao();f7e=function(t){jc(e,t);function e(){var r=t.call(this)||this;r.identifier="TelemetryInitializerPlugin",r.priority=199;var n,o;s(),vr(e,r,function(a,c){a.addTelemetryInitializer=function(l){return $Et(o,n++,l)},a[Kc]=function(l,u){WEt(o,l,u?u[$c]():a[$c]())&&a[ts](l,u)},a[mb]=function(){s()}});function s(){n=0,o=[]}return r}return e.__ieDyn=1,e}(Sg)});function QEt(t,e){return new b3(e)}function XEt(t,e,r){var n,o=[],s=[],a={};return Ce(r,function(c){(Pe(c)||Pe(c[ug]))&&Ai(y7e);var l=c[JS],u=c[Qf];c&&l&&(Pe(a[l])?a[l]=u:ec(t,"Two extensions have same priority #"+l+" - "+a[l]+", "+u)),!l||l<e?o[Cr](c):s[Cr](c)}),n={},n[Oi]=o,n[bb]=s,n}function g7e(t,e){var r=!1;return Ce(e,function(n){if(n===t)return r=!0,-1}),r}function ude(t,e,r,n){r&&it(r,function(o,s){n&&es(s)&&es(e[o])&&ude(t,e[o],s,n),n&&es(s)&&es(e[o])?ude(t,e[o],s,n):t.set(e,o,s)})}function v7e(t,e){var r=null,n=-1;return Ce(t,function(o,s){if(o.w===e)return r=o,n=s,-1}),{i:n,l:r}}function JEt(t,e){var r=v7e(t,e).l;return r||(r={w:e,rm:function(){var n=v7e(t,e);n.i!==-1&&t[Yf](n.i,1)}},t[Cr](r)),r}function ZEt(t,e,r){Ce(e,function(n){var o=Do(t,n.w,r);delete n.w,n.rm=function(){o.rm()}})}var Ab,y7e,KEt,h7e,YEt,lde,Ig,b7e=D(()=>{"use strict";Vc();ks();mP();Dt();Tb();Un();Oue();Fue();Wue();SP();gue();ip();tm();Ao();Kue();SG();EG();nde();m7e();wG();sde();y7e="Plugins must provide initialize method",KEt="_notificationManager",h7e="SDK is still unloading...",YEt="SDK is not initialized",lde=Xa((Ab={cookieCfg:{}},Ab[XS]={rdOnly:!0,ref:!0,v:[]},Ab[bb]={rdOnly:!0,ref:!0,v:[]},Ab[dg]={ref:!0,v:{}},Ab[ZH]=Pl,Ab.loggingLevelConsole=0,Ab.diagnosticLogInterval=Pl,Ab));Ig=function(){function t(){var e,r,n,o,s,a,c,l,u,d,p,f,m,h,g,v,b,_,x,S,I,w,k,M,H,F,ue,Z;vr(t,this,function(V){B(),V._getDbgPlgTargets=function(){return[k]},V[Gc]=function(){return r},V[ug]=function(G,pe,me,De){m&&Ai(h7e),V[Gc]()&&Ai("Core cannot be initialized more than once"),e=hi(G,lde,me||V[Rn],!1),G=e.cfg,ut(e[Vu](function(Nt){I=Nt.cfg.instrumentationKey;var un=Nt.ref(Nt.cfg,dg);it(un,function(Bn){Nt.ref(un,Bn)}),Pe(I)&&Ai("Please provide instrumentation key")})),s=De,Ie(),Xe(),V[Rn]=me;var Ee=G[XS];if(d=[],d[Cr].apply(d,AH(AH([],pe,!1),Ee,!1)),p=G[bb],$(null),(!f||f[bt]===0)&&Ai("No "+bb+" available"),p&&p[bt]>1){var vt=V[db]("TeeChannelController");(!vt||!vt.plugin)&&ze(n,1,28,"TeeChannel required")}ZEt(G,w,n),w=null,r=!0,V.releaseQueue(),V[Kle]()},V.getChannels=function(){var G=[];return f&&Ce(f,function(pe){G[Cr](pe)}),Wf(G)},V.track=function(G){Ji(V[vP](),function(){return"AppInsightsCore:track"},function(){G===null&&(_e(G),Ai("Invalid telemetry item")),!G[xa]&&Pe(G[xa])&&(_e(G),Ai("telemetry name required")),G.iKey=G.iKey||I,G[pb]=G[pb]||Al(new Date),G.ver=G.ver||"4.0",!m&&V[Gc]()?U()[ts](G):o[Cr](G)},function(){return{item:G}},!G.sync)},V[HH]=U,V[rP]=function(){return s||(s=new v3(e.cfg),V[KEt]=s),s},V[nP]=function(G){V[rP]()[nP](G)},V[iP]=function(G){s&&s[iP](G)},V.getCookieMgr=function(){return l||(l=bg(e.cfg,V[Rn])),l},V.setCookieMgr=function(G){l!==G&&(yg(l,!1),l=G)},V[vP]=function(){return!a&&!c&&ut(e[Vu](function(G){if(G.cfg.enablePerfMgr){var pe=G.cfg[ZH];wt(pe)&&(c=pe(V,V[rP]()))}})),a||c||Xue()},V.setPerfMgr=function(G){a=G},V.eventCnt=function(){return o[bt]},V.releaseQueue=function(){if(r&&o[bt]>0){var G=o;o=[],Ce(G,function(pe){U()[ts](pe)})}},V[Kle]=function(G){return g=G||null,Z=!1,F&&F[zS](),A(!0)};function A(G){if((!F||!F[fb])&&!Z){var pe=G||n&&n.queue[bt]>0;pe&&(ue||(ue=!0,ut(e[Vu](function(me){var De=me.cfg.diagnosticLogInterval;(!De||!(De>0))&&(De=1e4);var Ee=!1;F&&(Ee=F[fb],F[zS]()),F=Nle(Se,De),F.unref(),F[fb]=Ee}))),F[fb]=!0)}return F}V[Yle]=function(){Z=!0,F&&F[zS](),Se()},Dl(V,function(){return h},["addTelemetryInitializer"]),V[zc]=function(G,pe,me){var De;G===void 0&&(G=!0),r||Ai(YEt),m&&Ai(h7e);var Ee=(De={reason:50},De[ep]=G,De.flushComplete=!1,De),vt;G&&!pe&&(vt=Za(function(Bn){pe=Bn}));var Nt=kP(W(),V);Nt[W4](function(){_.run(V[Rn]),vG([l,s,n],G,function(){B(),pe&&pe(Ee)})},V);function un(Bn){Ee.flushComplete=Bn,m=!0,b.run(Nt,Ee),V[Yle](),Nt[ts](Ee)}return Se(),ee(G,un,6,me)||un(!1),vt},V[db]=ce,V.addPlugin=function(G,pe,me,De){if(!G){De&&De(!1),Tr(y7e);return}var Ee=ce(G[Qf]);if(Ee&&!pe){De&&De(!1),Tr("Plugin ["+G[Qf]+"] is already loaded!");return}var vt={reason:16};function Nt(bi){d[Cr](G),vt.added=[G],$(vt),De&&De(!0)}if(Ee){var un=[Ee.plugin],Bn={reason:2,isAsync:!!me};Y(un,Bn,function(bi){bi?(vt.removed=un,vt.reason|=32,Nt(!0)):De&&De(!1)})}else Nt(!1)},V.updateCfg=function(G,pe){pe===void 0&&(pe=!0);var me;if(V[Gc]()){me={reason:1,cfg:e.cfg,oldCfg:RH({},e.cfg),newConfig:RH({},G),merge:pe},G=me.newConfig;var De=e.cfg;G[XS]=De[XS],G[bb]=De[bb]}e._block(function(Ee){var vt=Ee.cfg;ude(Ee,vt,G,pe),pe||it(vt,function(Nt){Bc(G,Nt)||Ee.set(vt,Nt,Pl)}),Ee[Zd](vt,lde)},!0),e[GS](),me&&Ot(me)},V.evtNamespace=function(){return v},V.flush=ee,V.getTraceCtx=function(G){return S||(S=l7e()),S},V.setTraceCtx=function(G){S=G||null},V.addUnloadHook=ut,fg(V,"addUnloadCb",function(){return b},"add"),V.onCfgChange=function(G){var pe;return r?pe=Do(e.cfg,G,V[Rn]):pe=JEt(w,G),{rm:function(){pe.rm()}}},V.getWParam=function(){return ob()||e.cfg.enableWParam?0:-1};function P(){var G={};M=[];var pe=function(me){me&&Ce(me,function(De){if(De[Qf]&&De[$S]&&!G[De.identifier]){var Ee=De[Qf]+"="+De[$S];M[Cr](Ee),G[De.identifier]=De}})};pe(f),p&&Ce(p,function(me){pe(me)}),pe(d)}function B(){r=!1,e=hi({},lde,V[Rn]),e.cfg[GH]=1,nn(V,"config",{g:function(){return e.cfg},s:function(pe){V.updateCfg(pe,!1)}}),nn(V,"pluginVersionStringArr",{g:function(){return M||P(),M}}),nn(V,"pluginVersionString",{g:function(){return H||(M||P(),H=M.join(";")),H||Ht}}),nn(V,"logger",{g:function(){return n||(n=new Cb(e.cfg),e[Rn]=n),n},s:function(pe){e[Rn]=pe,n!==pe&&(yg(n,!1),n=pe)}}),V[Rn]=new Cb(e.cfg),k=[];var G=V.config[XS]||[];G.splice(0,G[bt]),Bu(G,k),h=new f7e,o=[],yg(s,!1),s=null,a=null,c=null,yg(l,!1),l=null,u=null,d=[],p=null,f=null,m=!1,g=null,v=Js("AIBaseCore",!0),b=c1(),S=null,I=null,_=kG(),w=[],H=null,M=null,Z=!1}function U(){var G=tc(W(),e.cfg,V);return G[W4](A),G}function $(G){var pe=XEt(V[Rn],K9e,d);u=null,H=null,M=null,f=(p||[])[0]||[],f=TG(Bu(f,pe[bb]));var me=Bu(TG(pe[Oi]),f);k=Wf(me);var De=V.config[XS]||[];De.splice(0,De[bt]),Bu(De,k);var Ee=U();f&&f[bt]>0&&rde(Ee[Xf](f),me),rde(Ee,me),G&&Ot(G)}function ce(G){var pe=null,me=null,De=[];return Ce(k,function(Ee){if(Ee[Qf]===G&&Ee!==h)return me=Ee,-1;Ee.getChannel&&De[Cr](Ee)}),!me&&De[bt]>0&&Ce(De,function(Ee){if(me=Ee.getChannel(G),!me)return-1}),me&&(pe={plugin:me,setEnabled:function(Ee){xg(me)[Z4]=!Ee},isEnabled:function(){var Ee=xg(me);return!Ee[kl]&&!Ee[Z4]},remove:function(Ee,vt){var Nt;Ee===void 0&&(Ee=!0);var un=[me],Bn=(Nt={reason:1},Nt[ep]=Ee,Nt);Y(un,Bn,function(bi){bi&&$({reason:32,removed:un}),vt&&vt(bi)})}}),pe}function W(){if(!u){var G=(k||[]).slice();$r(G,h)===-1&&G[Cr](h),u=Rb(TG(G),e.cfg,V)}return u}function Y(G,pe,me){if(G&&G[bt]>0){var De=Rb(G,e.cfg,V),Ee=kP(De,V);Ee[W4](function(){var vt=!1,Nt=[];Ce(d,function(Bn,bi){g7e(Bn,G)?vt=!0:Nt[Cr](Bn)}),d=Nt,H=null,M=null;var un=[];p&&(Ce(p,function(Bn,bi){var na=[];Ce(Bn,function(lp){g7e(lp,G)?vt=!0:na[Cr](lp)}),un[Cr](na)}),p=un),me&&me(vt),A()}),Ee[ts](pe)}else me(!1)}function Se(){if(n&&n.queue){var G=n.queue.slice(0);n.queue[bt]=0,Ce(G,function(pe){var me,De=(me={},me[xa]=g||"InternalMessageId: "+pe[oP],me.iKey=I,me[pb]=Al(new Date),me.baseType=e1.dataType,me.baseData={message:pe[Jf]},me);V.track(De)})}}function ee(G,pe,me,De){var Ee=1,vt=!1,Nt=null;De=De||5e3;function un(){Ee--,vt&&Ee===0&&(Nt&&Nt[zS](),Nt=null,pe&&pe(vt),pe=null)}if(f&&f[bt]>0){var Bn=U()[Xf](f);Bn.iterate(function(bi){if(bi.flush){Ee++;var na=!1;bi.flush(G,function(){na=!0,un()},me)||na||(G&&Nt==null?Nt=qc(function(){Nt=null,un()},De):un())}})}return vt=!0,un(),!0}function Ie(){!s&&V[rP](),ut(e[Vu](function(G){var pe=G.cfg.disableDbgExt;pe===!0&&x&&(s[iP](x),x=null),s&&!x&&pe!==!0&&(x=T9e(G.cfg),s[nP](x))}))}function Xe(){ut(e[Vu](function(G){var pe=G.cfg.enablePerfMgr;!pe&&c&&(c=null),pe&&o3(G.cfg,ZH,QEt)}))}function Ot(G){var pe=T3(W(),V);pe[W4](A),(!V._updateHook||V._updateHook(pe,G)!==!0)&&pe[ts](G)}function Tr(G){var pe=V[Rn];pe?(ze(pe,2,73,G),A()):Ai(G)}function _e(G){var pe=V[rP]();pe&&pe[_b]([G],2)}function ut(G){_.add(G)}})}return t.__ieDyn=1,t}()});var am,ewt,_7e,dde,l1,x7e=D(()=>{ks();mP();Dt();Un();Fue();ip();Ib();tm();am="",ewt="NoResponseBody",_7e="&"+ewt+"=true",dde="POST",l1=function(){function t(){var e=0,r,n,o,s,a,c,l,u,d,p,f,m,h;vr(t,this,function(g,v){var b=!0;Z(),g[ug]=function(V,A){o=A,n&&ze(o,1,28,"Sender is already initialized"),g.SetConfig(V),n=!0},g._getDbgPlgTargets=function(){return[n,s,c,r]},g.SetConfig=function(V){try{if(a=V.senderOnCompleteCallBack||{},c=!!V.disableCredentials,s=!!V.isOneDs,r=!!V.enableSendPromise,u=!!V.disableXhr,d=!!V.disableBeacon,p=!!V.disableBeaconSync,h=V.timeWrapper,m=!!V.addNoResponse,f=!!V.disableFetchKeepAlive,l={sendPOST:H},s||(b=!1),c){var A=ZS();A&&A.protocol&&A.protocol[Hc]()==="file:"&&(b=!1)}return!0}catch{}return!1},g.getSyncFetchPayload=function(){return e},g.getSenderInst=function(V,A){return V&&V[bt]?I(V,A):null},g.getFallbackInst=function(){return l},g[mb]=function(V,A){Z()};function _(V,A){w(A,200,{},V)}function x(V,A){ze(o,2,26,"Failed to send telemetry.",{message:V}),w(A,400,{})}function S(V){x("No endpoint url is provided for the batch",V)}function I(V,A){for(var P,B=0,U=null,$=0;U==null&&$<V[bt];)B=V[$],!u&&B===1?i3()?U=ue:bP()&&(U=H):B===2&&pg(A)&&(!A||!f)?U=F:B===3&&Yc()&&(A?!p:!d)&&(U=M),$++;return U?(P={_transport:B,_isSync:A},P[eue]=U,P):null}function w(V,A,P,B){try{V&&V(A,P,B)}catch{}}function k(V,A){var P=Ro(),B=V[sP];if(!B)return S(A),!0;B=V[sP]+(m?_7e:am);var U=V[gb],$=s?U:new Blob([U],{type:"text/plain;charset=UTF-8"}),ce=P.sendBeacon(B,$);return ce}function M(V,A,P){var B=V[gb];try{if(B)if(k(V,A))_(am,A);else{var U=a&&a.beaconOnRetry;U&&wt(U)?U(V,A,k):(l&&l[eue](V,A,!0),ze(o,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch($){s&&ec(o,"Failed to send telemetry using sendBeacon API. Ex:"+et($)),w(A,s?0:400,{},am)}}function H(V,A,P){var B,U,$,ce=V[KH]||{};!P&&r&&(B=Za(function(ee,Ie){U=ee,$=Ie})),s&&P&&V.disableXhrSync&&(P=!1);var W=V[sP];if(!W){S(A),U&&U(!1);return}var Y=Pue(dde,W,b,!0,P,V[QS]);Y[tue]("Content-type","application/json"),Ce(Zo(ce),function(ee){Y[tue](ee,ce[ee])}),Y.onreadystatechange=function(){s||(Se(Y),Y.readyState===4&&U&&U(!0))},Y.onload=function(){s&&Se(Y)};function Se(ee){var Ie=a&&a.xhrOnComplete,Xe=Ie&&wt(Ie);if(Xe)Ie(ee,A,V);else{var Ot=op(ee);w(A,ee[KS],gg(ee,s),Ot)}}return Y.onerror=function(ee){w(A,s?Y[KS]:400,gg(Y,s),s?am:mg(Y)),$&&$(ee)},Y.ontimeout=function(){w(A,s?Y[KS]:500,gg(Y,s),s?am:mg(Y)),U&&U(!1)},Y.send(V[gb]),B}function F(V,A,P){var B,U=V[sP],$=V[gb],ce=s?$:new Blob([$],{type:"application/json"}),W,Y,Se,ee=new Headers,Ie=$[bt],Xe=!1,Ot=!1,Tr=V[KH]||{},_e=(B={method:dde,body:ce},B[Mue]=!0,B);V.headers&&Zo(V.headers)[bt]>0&&(Ce(Zo(Tr),function(me){ee.append(me,Tr[me])}),_e[KH]=ee),b&&s&&(_e.credentials="include"),P&&(_e.keepalive=!0,e+=Ie,s?V._sendReason===2&&(Xe=!0,m&&(U+=_7e)):Xe=!0);var ut=new Request(U,_e);try{ut[Mue]=!0}catch{}if(!P&&r&&(W=Za(function(me,De){Y=me,Se=De})),!U){S(A),Y&&Y(!1);return}function G(me){w(A,s?0:400,{},s?am:me)}function pe(me,De,Ee){var vt=me[KS],Nt=a.fetchOnComplete;Nt&&wt(Nt)?Nt(me,A,Ee||am,De):w(A,vt,{},Ee||am)}try{yb(fetch(s?U:ut,s?_e:null),function(me){if(P&&(e-=Ie,Ie=0),!Ot)if(Ot=!0,me.rejected)G(me.reason&&me.reason[Jf]),Se&&Se(me.reason);else{var De=me.value;try{!s&&!De.ok?(G(De.statusText),Y&&Y(!1)):s&&!De.body?(pe(De,null,am),Y&&Y(!0)):yb(De.text(),function(Ee){pe(De,V,Ee.value),Y&&Y(!0)})}catch(Ee){G(et(Ee)),Se&&Se(Ee)}}})}catch(me){Ot||(G(et(me)),Se&&Se(me))}return Xe&&!Ot&&(Ot=!0,w(A,200,{}),Y&&Y(!0)),s&&!Ot&&V[QS]>0&&h&&h.set(function(){Ot||(Ot=!0,w(A,500,{}),Y&&Y(!0))},V[QS]),W}function ue(V,A,P){var B=Ni(),U=new XDomainRequest,$=V[gb];U.onload=function(){var ee=op(U),Ie=a&&a.xdrOnComplete;Ie&&wt(Ie)?Ie(U,A,V):w(A,200,{},ee)},U.onerror=function(){w(A,400,{},s?am:r1(U))},U.ontimeout=function(){w(A,500,{})},U.onprogress=function(){};var ce=B&&B.location&&B.location[zH]||"",W=V[sP];if(!W){S(A);return}if(!s&&W.lastIndexOf(ce,0)!==0){var Y="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";ze(o,2,40,". "+Y),x(Y,A);return}var Se=s?W:W[tp](/^(https?:)/,"");U.open(dde,Se),V[QS]&&(U[QS]=V[QS]),U.send($),s&&P?h&&h.set(function(){U.send($)},0):U.send($)}function Z(){e=0,n=!1,r=!1,o=null,s=null,a=null,c=null,l=null,u=!1,d=!1,p=!1,f=!1,m=!1,h=null}})}return t.__ieDyn=1,t}()});function E7e(t){return t&&t[tp]?t[tp](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Ht):t}function AG(t,e){var r;if(e){var n=Ht;mt(e)?(n=Ht,Ce(e,function(s){s=E7e(s),s&&(s[0]!=="."&&(s="."+s),n+=s)})):n=E7e(e),n&&(n[0]!=="."&&(n="."+n),t=(t||Ht)+n)}var o=iwt.exec(t||Ht)||[];return r={},r[Wc]=o[1],r.ns=(o[2]||Ht).replace(twt,".").replace(rwt,Ht)[Hu](".").sort().join("."),r}function pde(t,e,r){var n=[],o=w3.get(t,RG,{},!1),s=AG(e,r);return it(o,function(a,c){Ce(c,function(l){var u;(!s[Wc]||s[Wc]===l.evtName[Wc])&&(!s.ns||s.ns===s.ns)&&n[Cr]((u={},u[xa]=l.evtName[Wc]+(l.evtName.ns?"."+l.evtName.ns:Ht),u.handler=l[Y4],u))})}),n}function L7e(t,e,r){r===void 0&&(r=!0);var n=w3.get(t,RG,{},r),o=n[e];return o||(o=n[e]=[]),o}function O7e(t,e,r,n){t&&e&&e[Wc]&&(t[T7e]?t[T7e](e[Wc],r,n):t[C7e]&&t[C7e](k7e+e[Wc],r))}function owt(t,e,r,n){var o=!1;return t&&e&&e[Wc]&&r&&(t[I7e]?(t[I7e](e[Wc],r,n),o=!0):t[S7e]&&(t[S7e](k7e+e[Wc],r),o=!0)),o}function w7e(t,e,r,n){for(var o=e[bt];o--;){var s=e[o];s&&(!r.ns||r.ns===s.evtName.ns)&&(!n||n(s))&&(O7e(t,s.evtName,s[Y4],s.capture),e[Yf](o,1))}}function swt(t,e,r){if(e[Wc])w7e(t,L7e(t,e[Wc]),e,r);else{var n=w3.get(t,RG,{});it(n,function(o,s){w7e(t,s,e,r)}),Zo(n)[bt]===0&&w3.kill(t,RG)}}function Nl(t,e){var r;return e?(mt(e)?r=[t].concat(e):r=[t,e],r=AG("xx",r).ns[Hu](".")):r=t,r}function cm(t,e,r,n,o){var s;o===void 0&&(o=!1);var a=!1;if(t)try{var c=AG(e,n);if(a=owt(t,c,r,o),a&&w3.accept(t)){var l=(s={guid:nwt++,evtName:c},s[Y4]=r,s.capture=o,s);L7e(t,c.type)[Cr](l)}}catch{}return a}function Cg(t,e,r,n,o){if(o===void 0&&(o=!1),t)try{var s=AG(e,n),a=!1;swt(t,s,function(c){return s.ns&&!r||c[Y4]===r?(a=!0,!0):!1}),a||O7e(t,s,r,o)}catch{}}function fde(t,e,r,n){return n===void 0&&(n=!1),cm(t,e,r,null,n)}function mde(t,e,r,n){n===void 0&&(n=!1),Cg(t,e,r,null,n)}function DG(t,e,r){var n=!1,o=Ni();o&&(n=cm(o,t,e,r),n=cm(o.body,t,e,r)||n);var s=Di();return s&&(n=cm(s,t,e,r)||n),n}function NG(t,e,r){var n=Ni();n&&(Cg(n,t,e,r),Cg(n.body,t,e,r));var o=Di();o&&Cg(o,t,e,r)}function RP(t,e,r,n){var o=!1;return e&&t&&t[bt]>0&&Ce(t,function(s){s&&(!r||$r(r,s)===-1)&&(o=DG(s,e,n)||o)}),o}function LG(t,e,r,n){var o=!1;return e&&t&&mt(t)&&(o=RP(t,e,r,n),!o&&r&&r[bt]>0&&(o=RP(t,e,null,n))),o}function Db(t,e,r){t&&mt(t)&&Ce(t,function(n){n&&NG(n,e,r)})}function k3(t,e,r){return LG([A7e,P7e,PG],t,e,r)}function R3(t,e){Db([A7e,P7e,PG],t,e)}function PP(t,e,r){function n(a){var c=Di();t&&c&&c.visibilityState==="hidden"&&t(a)}var o=Nl(D7e,r),s=RP([PG],t,e,o);return(!e||$r(e,E3)===-1)&&(s=RP([E3],n,e,o)||s),!s&&e&&(s=PP(t,null,r)),s}function P3(t,e){var r=Nl(D7e,e);Db([PG],t,r),Db([E3],null,r)}function AP(t,e,r){function n(a){var c=Di();t&&c&&c.visibilityState==="visible"&&t(a)}var o=Nl(N7e,r),s=RP([R7e],t,e,o);return s=RP([E3],n,e,o)||s,!s&&e&&(s=AP(t,null,r)),s}function A3(t,e){var r=Nl(N7e,e);Db([R7e],t,r),Db([E3],null,r)}var k7e,S7e,I7e,C7e,T7e,RG,E3,PG,R7e,P7e,A7e,D7e,N7e,twt,rwt,nwt,w3,iwt,M7e=D(()=>{Dt();Un();SP();Ao();k7e="on",S7e="attachEvent",I7e="addEventListener",C7e="detachEvent",T7e="removeEventListener",RG="events",E3="visibilitychange",PG="pagehide",R7e="pageshow",P7e="unload",A7e="beforeunload",D7e=Js("aiEvtPageHide"),N7e=Js("aiEvtPageShow"),twt=/\.[\.]+/g,rwt=/[\.]+$/,nwt=1,w3=uG("events"),iwt=/^([^.]*)(?:\.(.+)|)/});var hde,F7e=D(()=>{jH();hde=Po({DISABLED:0,CRITICAL:1,WARNING:2,DEBUG:3})});var ln=D(()=>{s9e();a9e();b7e();cde();lG();Jue();Oue();tm();x7e();Dt();jH();M7e();Ib();Vc();Kue();SG();ip();EG();F7e();Wue();SP();wG();tde();Tb();mG();Bue()});var lm,U7e,gde,OG,MG=D(()=>{lm="",U7e="https://browser.events.data.microsoft.com/OneCollector/1.0/",gde="version",OG="properties"});var vde,yde,DP,um,bde,gi,u1,Tg,FG,UG,BG,qG,D3,jG=D(()=>{vde="initialize",yde="logger",DP="indexOf",um="timings",bde="pollInternalLogs",gi="value",u1="kind",Tg="length",FG="processTelemetryStart",UG="handleField",BG="rmSanitizer",qG="rmFieldSanitizer",D3="canHandle"});function Rs(t){return!(t===lm||Pe(t))}function VG(t){if(t){var e=Ja(t,"-");if(e>-1)return ib(t,e)}return lm}function H7e(){return _de===null&&(_de=!Vt(Uint8Array)&&!dwt()&&!xb()),_de}function HG(t){return!!(t&&ya(t)&&t>=1&&t<=4)}function GG(t,e,r){if(!e&&!Rs(e)||typeof t!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||mt(e))e={value:e};else if(n==="object"&&!q7e.call(e,"value"))e={value:r?JSON.stringify(e):e};else if(Pe(e[gi])||e[gi]===lm||!$t(e[gi])&&!ya(e[gi])&&!Wd(e[gi])&&!mt(e[gi]))return null;if(mt(e[gi])&&!Sde(e[gi]))return null;if(!Pe(e[u1])){if(mt(e[gi])||!N3(e[u1]))return null;e[gi]=e[gi].toString()}return e}function LP(t,e,r){var n=-1;if(!Vt(t))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),uwt(r))n===-1&&(n=0),n|=r;else{var o=lwt[dm(t)]||-1;n!==-1&&o!==-1?n|=o:o===6&&(n=o)}return n}function G7e(t,e,r){r===void 0&&(r=!0);var n;return t&&(n=t.get(e),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||lm}function z7e(t){t===void 0&&(t="D");var e=_3();return t==="B"?e="{"+e+"}":t==="P"?e="("+e+")":t==="N"&&(e=e.replace(/-/g,lm)),e}function d1(t,e,r,n,o){var s={},a=!1,c=0,l=arguments[Tg],u=arguments;for(Wd(u[0])&&(a=u[0],c++);c<l;c++){var t=u[c];it(t,function(p,f){a&&f&&Kn(f)?mt(f)?(s[p]=s[p]||[],Ce(f,function(m,h){m&&Kn(m)?s[p][h]=d1(!0,s[p][h],m):s[p][h]=m})):s[p]=d1(!0,s[p],f):s[p]=f})}return s}function N3(t){return t===0||t>0&&t<=13||t===32}function uwt(t){return t>=0&&t<=9}function dwt(){var t=Ro();if(!Vt(t)&&t.userAgent){var e=t.userAgent.toLowerCase();if((e[DP]("safari")>=0||e[DP]("firefox")>=0)&&e[DP]("chrome")<0)return!0}return!1}function Sde(t){return t[Tg]>0}function L3(t,e){var r=t;r[um]=r[um]||{},r[um][FG]=r[um][FG]||{},r[um][FG][e]=Qc()}function dm(t){var e=0;if(t!=null){var r=typeof t;r==="string"?e=1:r==="number"?e=2:r==="boolean"?e=3:r===tg&&(e=4,mt(t)?(e=4096,t[Tg]>0&&(e|=dm(t[0]))):q7e.call(t,"value")&&(e=8192|dm(t[gi])))}return e}function zG(){return!!yn("chrome")}function $7e(t,e,r,n,o,s){n===void 0&&(n=!1),o===void 0&&(o=!1);function a(l,u,d){try{l[u]=d}catch{}}var c=new XMLHttpRequest;return n&&a(c,awt,n),r&&a(c,B7e,r),c.open(t,e,!o),r&&a(c,B7e,r),!o&&s&&a(c,cwt,s),c}function Nb(t){return t>0}var Eg,xde,NP,q7e,awt,B7e,cwt,lwt,_de,j7e,V7e,Qc,$G=D(()=>{ln();Vc();Dt();MG();jG();xde="4.1.1",NP="1DS-Web-JS-"+xde,q7e=D4.hasOwnProperty,awt="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",B7e="withCredentials",cwt="timeout",lwt=(Eg={},Eg[0]=0,Eg[2]=6,Eg[1]=1,Eg[3]=7,Eg[4098]=6,Eg[4097]=1,Eg[4099]=7,Eg),_de=null,j7e=ob(),V7e=sb();Qc=ZR});function fwt(t){return t&&(!t.getProperty||!t.setProperty)&&Ai("Invalid property storage override passed."),!0}var pwt,W7e,K7e=D(()=>{Vc();ks();ln();Dt();MG();$G();jG();pwt=Xa({endpointUrl:U7e,propertyStorageOverride:{isVal:fwt}});W7e=function(t){jc(e,t);function e(){var r=t.call(this)||this;return vr(e,r,function(n,o){n[vde]=function(s,a,c,l){Ji(n,function(){return"AppInsightsCore.initialize"},function(){try{o[vde](hi(s,pwt,c||n[yde],!1).cfg,a,c,l)}catch(p){var u=n[yde],d=et(p);d[DP]("channels")!==-1&&(d+=`
 - Channels must be provided through config.channels only!`),ze(u,1,514,"SDK Initialization Failed - no telemetry will be sent: "+d)}},function(){return{config:s,extensions:a,logger:c,notificationManager:l}})},n.track=function(s){Ji(n,function(){return"AppInsightsCore.track"},function(){var a=s;if(a){a[um]=a[um]||{},a[um].trackStart=Qc(),HG(a.latency)||(a.latency=1);var c=a.ext=a.ext||{};c.sdk=c.sdk||{},c.sdk.ver=NP;var l=a.baseData=a.baseData||{};l[OG]=l[OG]||{};var u=l[OG];u[gde]=u[gde]||n.pluginVersionString||lm}o.track(a)},function(){return{item:s}},!s.sync)},n[bde]=function(s){return o[bde](s||"InternalLog")}}),r}return e.__ieDyn=1,e}(Ig)});var Y7e,Q7e,X7e,J7e,Z7e,eUe=D(()=>{ln();Y7e=Po({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,Pii_IPv6ScrubLastHextets:14,Pii_DropValue:15,CustomerContent_GenericContent:32}),Q7e=Po({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),X7e=Po({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),J7e=Po({Normal:1,Critical:2}),Z7e=Po({NONE:0,ERROR:1,WARNING:2,INFORMATION:3})});var tUe,rUe=D(()=>{ln();Dt();MG();$G();jG();tUe=function(){function t(e){var r=this,n={},o=[],s=[];e&&s.push(e);function a(d,p){var f,m=n[d];if(m&&(f=m[p]),!f&&f!==null){if($t(d)&&$t(p))if(s[Tg]>0){for(var h=0;h<s[Tg];h++)if(s[h][UG](d,p)){f={canHandle:!0,fieldHandler:s[h]};break}}else o[Tg]===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var h=0;h<o[Tg];h++)if(o[h][UG](d,p)){f={canHandle:!0,handler:o[h],fieldHandler:null};break}}m||(m=n[d]={}),m[p]=f}return f}r.clearCache=function(){n={}},r.addSanitizer=function(d){d&&(kH(o,d)||o.push(d),n={})},r.addFieldSanitizer=function(d){d&&(kH(s,d)||s.push(d),n={})},r[BG]=function(d){if(d){var p=$r(o,d);p!==-1&&(o.splice(p,1),n={}),Ce(o,function(f){f&&f[BG]&&f[BG](d)})}},r[qG]=function(d){if(d){var p=$r(s,d);p!==-1&&(s.splice(p,1),n={}),Ce(o,function(f){f&&f[qG]&&f[qG](d)})}},r.isEmpty=function(){return JR(o)+JR(s)===0},r[UG]=function(d,p){var f=a(d,p);return f?f[D3]:!1},r[gi]=function(d,p,f,m){var h=a(d,p);if(h&&h[D3]){if(!h||!h[D3])return null;if(h.handler)return h.handler[gi](d,p,f,m);if(!$t(p)||Pe(f)||f===lm)return null;var g=null,v=dm(f);if((v&8192)===8192){var b=v&-8193;if(g=f,!Rs(g[gi])||b!==1&&b!==2&&b!==3&&(b&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?g=l(d,p,f):v===4&&(g=l(d,p,m?JSON.stringify(f):f));if(g)return c(h,d,p,v,g,m)}return null},r.property=function(d,p,f,m){var h=a(d,p);if(!h||!h[D3]||!$t(p)||Pe(f)||!Rs(f[gi]))return null;var g=dm(f[gi]);return g===0?null:c(h,d,p,g,f,m)};function c(d,p,f,m,h,g){if(d.handler)return d.handler.property(p,f,h,g);if(!Pe(h[u1])){if((m&4096)===4096||!N3(h[u1]))return null;h[gi]=h[gi].toString()}return u(d.fieldHandler,p,f,m,h)}function l(d,p,f){return Rs(f)?{value:f}:null}function u(d,p,f,m,h){if(h&&d){var g=d.getSanitizer(p,f,m,h[u1],h.propertyType);if(g)if(m===4){var v={},b=h[gi];it(b,function(x,S){var I=p+"."+f;if(Rs(S)){var w=l(I,x,S);w=u(d,I,x,dm(S),w),w&&(v[x]=w[gi])}}),h[gi]=v}else{var _={path:p,name:f,type:m,prop:h,sanitizer:r};h=g.call(r,_)}}return h}}return t.getFieldType=dm,t}()});var nUe={};Pn(nUe,{AppInsightsCore:()=>W7e,BaseTelemetryPlugin:()=>Sg,DiagnosticLogger:()=>Cb,EventLatency:()=>Q7e,EventPersistence:()=>J7e,EventPropertyType:()=>X7e,EventsDiscardedReason:()=>Jd,FullVersionString:()=>NP,InternalAppInsightsCore:()=>Ig,LoggingSeverity:()=>hde,MinChannelPriorty:()=>$le,NotificationManager:()=>v3,PerfEvent:()=>o1,PerfManager:()=>b3,ProcessTelemetryContext:()=>ode,SenderPostManager:()=>l1,TraceLevel:()=>Z7e,Undefined:()=>$f,ValueKind:()=>Y7e,ValueSanitizer:()=>tUe,Version:()=>xde,_InternalLogMessage:()=>e1,__getRegisteredEvents:()=>pde,_appendHeader:()=>xP,_getAllResponseHeaders:()=>gg,_logInternalMessage:()=>wue,_throwInternal:()=>ze,_warnToConsole:()=>ec,addEventHandler:()=>DG,addEventListeners:()=>LG,addPageHideEventListener:()=>PP,addPageShowEventListener:()=>AP,addPageUnloadEventListener:()=>k3,areCookiesSupported:()=>TP,arrForEach:()=>Ce,arrIndexOf:()=>$r,arrMap:()=>Kf,arrReduce:()=>XR,attachEvent:()=>fde,blockDynamicConversion:()=>p3,convertAllHeadersToMap:()=>cG,cookieAvailable:()=>TP,createCookieMgr:()=>bg,createDynamicConfig:()=>hi,createEnumStyle:()=>Po,createGuid:()=>z7e,createProcessTelemetryContext:()=>tc,createTraceParent:()=>x3,createUniqueNamespace:()=>Js,createUnloadHandlerContainer:()=>c1,dateNow:()=>Li,detachEvent:()=>mde,disallowsSameSiteNone:()=>xG,doPerf:()=>Ji,dumpObj:()=>et,eventOff:()=>Cg,eventOn:()=>cm,extend:()=>d1,findW3cTraceParent:()=>C3,forceDynamicConversion:()=>Lue,formatErrorMessageXdr:()=>r1,formatErrorMessageXhr:()=>mg,formatTraceParent:()=>I3,generateW3CId:()=>s1,getCommonSchemaMetaData:()=>LP,getConsole:()=>e3,getCookieValue:()=>G7e,getCrypto:()=>t3,getDocument:()=>Di,getDynamicConfigHandler:()=>d3,getExceptionName:()=>Yn,getFieldValueType:()=>dm,getGlobal:()=>ba,getGlobalInst:()=>yn,getHistory:()=>j4,getIEVersion:()=>n3,getISOString:()=>Al,getJSON:()=>Xs,getLocation:()=>ZS,getMsCrypto:()=>r3,getNavigator:()=>Ro,getPerformance:()=>ag,getResponseText:()=>op,getSetValue:()=>o3,getTenantId:()=>VG,getTime:()=>Qc,getWindow:()=>Ni,hasDocument:()=>ob,hasHistory:()=>SH,hasJSON:()=>em,hasNavigator:()=>QR,hasOwnProperty:()=>co,hasWindow:()=>sb,isArray:()=>mt,isArrayValid:()=>Sde,isBeaconsSupported:()=>Yc,isBoolean:()=>Wd,isChromium:()=>zG,isDate:()=>$R,isDocumentObjectAvailable:()=>j7e,isError:()=>Zy,isFetchSupported:()=>pg,isFunction:()=>wt,isGreaterThanZero:()=>Nb,isIE:()=>Sb,isLatency:()=>HG,isNotTruthy:()=>lH,isNullOrUndefined:()=>Pe,isNumber:()=>ya,isObject:()=>Kn,isReactNative:()=>xb,isSampledFlag:()=>S3,isString:()=>$t,isTruthy:()=>Mu,isTypeof:()=>aH,isUint8ArrayAvailable:()=>H7e,isUndefined:()=>Vt,isValidSpanId:()=>sm,isValidTraceId:()=>om,isValidTraceParent:()=>wP,isValueAssigned:()=>Rs,isValueKind:()=>N3,isWindowObjectAvailable:()=>V7e,isXhrSupported:()=>bP,mergeEvtNamespace:()=>Nl,newGuid:()=>_3,newId:()=>l3,normalizeJsName:()=>t1,objDefineAccessors:()=>xH,objForEachKey:()=>it,objFreeze:()=>Wf,objKeys:()=>Zo,objSeal:()=>fH,onConfigChange:()=>Do,openXhr:()=>$7e,optimizeObject:()=>zu,parseResponse:()=>n1,parseTraceParent:()=>a1,perfNow:()=>ZR,prependTransports:()=>hg,proxyAssign:()=>kue,proxyFunctionAs:()=>fg,proxyFunctions:()=>Dl,random32:()=>vg,randomValue:()=>c3,removeEventHandler:()=>NG,removeEventListeners:()=>Db,removePageHideEventListener:()=>P3,removePageShowEventListener:()=>A3,removePageUnloadEventListener:()=>R3,safeGetCookieMgr:()=>$ue,safeGetLogger:()=>np,sanitizeProperty:()=>GG,setEnableEnvMocks:()=>Sue,setProcessTelemetryTimings:()=>L3,setValue:()=>Gu,strContains:()=>lo,strEndsWith:()=>cb,strFunction:()=>qR,strObject:()=>tg,strPrototype:()=>$d,strStartsWith:()=>jS,strTrim:()=>Zr,strUndefined:()=>$f,throwError:()=>Ai,toISOString:()=>Al,useXDomainRequest:()=>i3});var p1=D(()=>{K7e();eUe();rUe();ln();$G()});var f1,WG,KG,Ide=D(()=>{f1="REAL_TIME",WG="NEAR_REAL_TIME",KG="BEST_EFFORT"});var sp,YG,iUe,Cde,oUe,sUe,aUe,Tde,Ede,QG,cUe,lUe,uUe,XG,wde,JG,ZG,ez,O3,kde,Rde,dUe,OP,Pde,tz,M3=D(()=>{sp="",YG="drop",iUe="send",Cde="requeue",oUe="rspFail",sUe="oth",aUe="no-cache, no-store",Tde="application/x-json-stream",Ede="cache-control",QG="content-type",cUe="kill-tokens",lUe="kill-duration",uUe="time-delta-millis",XG="client-version",wde="client-id",JG="time-delta-to-apply-millis",ZG="upload-time",ez="apikey",O3="AuthMsaDeviceTicket",kde="WebAuthToken",Rde="AuthXToken",dUe="NoResponseBody",OP="msfpc",Pde="trace",tz="user"});var F3,rz,nz,iz,U3,ur,pm,Wu,uo,fm,Ps,mm,m1,oz,Lb,sz,h1,az,cz,pUe,Ade,Dde,fUe,mUe,lz,Nde,Lde,hUe,gUe,Ode,Mde,vUe,uz,dz,Fde,g1,MP,Ude,Sa,Xc,B3,q3,FP,pz,j3,yUe,fz,mz,UP,Bde,V3,hz,gz,BP,vz,yz,bz,H3,bUe,_Ue,qde,jde,xUe,SUe,IUe,_z,G3,Ob,v1,qP=D(()=>{F3="allowRequestSending",rz="firstRequestSent",nz="shouldAddClockSkewHeaders",iz="getClockSkewHeaderValue",U3="setClockSkew",ur="length",pm="concat",Wu="iKey",uo="count",fm="events",Ps="push",mm="split",m1="splice",oz="toLowerCase",Lb="hdrs",sz="useHdrs",h1="initialize",az="setTimeoutOverride",cz="clearTimeoutOverride",pUe="payloadPreprocessor",Ade="overrideEndpointUrl",Dde="avoidOptions",fUe="disableEventTimings",mUe="stringifyObjects",lz="enableCompoundKey",Nde="disableXhrSync",Lde="disableFetchKeepAlive",hUe="addNoResponse",gUe="excludeCsMetaData",Ode="useSendBeacon",Mde="alwaysUseXhrOverride",vUe="unloadTransports",uz="serializeOfflineEvt",dz="getOfflineRequestDetails",Fde="createPayload",g1="headers",MP="_thePayload",Ude="urlString",Sa="batches",Xc="sendType",B3="addHeader",q3="canSendRequest",FP="sendQueuedRequests",pz="isCompletelyIdle",j3="setUnloading",yUe="isTenantKilled",fz="sendSynchronousBatch",mz="_transport",UP="getWParam",Bde="isBeacon",V3="timings",hz="isTeardown",gz="isSync",BP="data",vz="_sendReason",yz="setKillSwitchTenants",bz="_backOffTransmission",H3="identifier",bUe="disableOptimizeObj",_Ue="ignoreMc1Ms0CookieProcessing",qde="eventsLimitInMem",jde="autoFlushEventsLimit",xUe="disableAutoBatchFlushLimit",SUe="overrideInstrumentationKey",IUe="disableTelemetry",_z="baseData",G3="sendAttempt",Ob="latency",v1="sync"});function TUe(t){var e=(t.ext||{}).intweb;return e&&Rs(e[OP])?e[OP]:null}function CUe(t){for(var e=null,r=0;e===null&&r<t[ur];r++)e=TUe(t[r]);return e}var jP,Vde=D(()=>{p1();M3();qP();jP=function(){function t(e,r){var n=r?[][pm](r):[],o=this,s=CUe(n);o[Wu]=function(){return e},o.Msfpc=function(){return s||sp},o[uo]=function(){return n[ur]},o[fm]=function(){return n},o.addEvent=function(a){return a?(n[Ps](a),s||(s=TUe(a)),!0):!1},o[mm]=function(a,c){var l;if(a<n[ur]){var u=n[ur]-a;Pe(c)||(u=c<u?c:u),l=n[m1](a,u),s=CUe(n)}return new t(e,l)}}return t.create=function(e,r){return new t(e,r)},t}()});var EUe,wUe=D(()=>{ks();qP();EUe=function(){function t(){var e=!0,r=!0,n=!0,o="use-collector-delta",s=!1;vr(t,this,function(a){a[F3]=function(){return e},a[rz]=function(){n&&(n=!1,s||(e=!1))},a[nz]=function(){return r},a[iz]=function(){return o},a[U3]=function(c){s||(c?(o=c,r=!0,s=!0):r=!1,e=!0)}})}return t.__ieDyn=1,t}()});var mwt,kUe,RUe=D(()=>{ks();p1();qP();mwt=1e3,kUe=function(){function t(){var e={};function r(n){var o=[];return n&&Ce(n,function(s){o[Ps](Zr(s))}),o}vr(t,this,function(n){n[yz]=function(o,s){if(o&&s)try{var a=r(o[mm](","));if(s==="this-request-only")return a;for(var c=parseInt(s,10)*mwt,l=0;l<a[ur];++l)e[a[l]]=Li()+c}catch{return[]}return[]},n[yUe]=function(o){var s=e,a=Zr(o);return s[a]!==void 0&&s[a]>Li()?!0:(delete s[a],!1)}})}return t.__ieDyn=1,t}()});function AUe(t){return!(t>=300&&t<500&&t!=429||t==501||t==505)}function xz(t){var e=0,r=PUe*hwt,n=PUe*gwt,o=Math.floor(Math.random()*(n-r))+r;return e=Math.pow(2,t)*o,Math.min(e,vwt)}var hwt,gwt,PUe,vwt,Hde=D(()=>{hwt=.8,gwt=1.2,PUe=3e3,vwt=6e5});function Swt(t,e,r,n,o){if(o&&e){var s=t(o.value,o.kind,o.propertyType);if(s>-1){var a=e[DUe];a||(a=e[DUe]={f:{}});var c=a[Sz];if(c||(c=a[Sz]={}),r)for(var l=0;l<r.length;l++){var u=r[l];c[u]||(c[u]={f:{}});var d=c[u][Sz];d||(d=c[u][Sz]={}),c=d}c=c[n]={},mt(o.value)?c.a={t:s}:c.t=s}}}var ywt,bwt,NUe,LUe,_wt,DUe,Sz,xwt,OUe,MUe=D(()=>{ks();p1();Vde();M3();Dt();ywt=20,bwt=3984588,NUe=65e3,LUe=2e6,_wt=Math.min(LUe,NUe),DUe="metadata",Sz="f",xwt=/\./,OUe=function(){function t(e,r,n,o,s,a){var c="data",l="baseData",u="ext",d=!!o,p=!0,f=r,m={},h=!!a,g=s||LP;vr(t,this,function(v){v.createPayload=function(x,S,I,w,k,M){return{apiKeys:[],payloadBlob:sp,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:x,isTeardown:S,isSync:I,isBeacon:w,sendType:M,sendReason:k}},v.appendPayload=function(x,S,I){var w=x&&S&&!x.overflow;return w&&Ji(e,function(){return"Serializer:appendPayload"},function(){for(var k=S.events(),M=x.payloadBlob,H=x.numEvents,F=!1,ue=[],Z=[],V=x.isBeacon,A=V?NUe:bwt,P=V?_wt:LUe,B=0,U=0;B<k.length;){var $=k[B];if($){if(H>=I){x.overflow=S.split(B);break}var ce=v.getEventBlob($);if(ce&&ce.length<=P){var W=ce.length,Y=M.length;if(Y+W>A){x.overflow=S.split(B);break}M&&(M+=`
`),M+=ce,U++,U>ywt&&(Yd(M,0,1),U=0),F=!0,H++}else ce?ue.push($):Z.push($),k.splice(B,1),B--}B++}if(ue.length>0&&x.sizeExceed.push(jP.create(S.iKey(),ue)),Z.length>0&&x.failedEvts.push(jP.create(S.iKey(),Z)),F){x.batches.push(S),x.payloadBlob=M,x.numEvents=H;var Se=S.iKey();$r(x.apiKeys,Se)===-1&&x.apiKeys.push(Se)}},function(){return{payload:x,theBatch:{iKey:S.iKey(),evts:S.events()},max:I}}),w},v.getEventBlob=function(x){try{return Ji(e,function(){return"Serializer.getEventBlob"},function(){var S={};S.name=x.name,S.time=x.time,S.ver=x.ver,S.iKey="o:"+VG(x.iKey);var I={},w;h||(w=function(F,ue,Z){Swt(g,I,F,ue,Z)});var k=x[u];k&&(S[u]=I,it(k,function(F,ue){var Z=I[F]={};_(ue,Z,"ext."+F,!0,null,null,!0)}));var M=S[c]={};M.baseType=x.baseType;var H=M[l]={};return _(x.baseData,H,l,!1,[l],w,p),_(x.data,M,c,!1,[],w,p),JSON.stringify(S)},function(){return{item:x}})}catch{return null}};function b(x,S){var I=m[x];return I===void 0&&(x.length>=7&&(I=jS(x,"ext.metadata")||jS(x,"ext.web")),m[x]=I),I}function _(x,S,I,w,k,M,H){it(x,function(F,ue){var Z=null;if(ue||Rs(ue)){var V=I,A=F,P=k,B=S;if(d&&!w&&xwt.test(F)){var U=F.split("."),$=U.length;if($>1){P&&(P=P.slice());for(var ce=0;ce<$-1;ce++){var W=U[ce];B=B[W]=B[W]||{},V+="."+W,P&&P.push(W)}A=U[$-1]}}var Y=w&&b(V,A);if(!Y&&f&&f.handleField(V,A)?Z=f.value(V,A,ue,n):Z=GG(A,ue,n),Z){var Se=Z.value;if(B[A]=Se,M&&M(P,A,Z),H&&typeof Se=="object"&&!mt(Se)){var ee=P;ee&&(ee=ee.slice(),ee.push(A)),_(ue,Se,V+"."+A,w,ee,M,H)}}}})}})}return t.__ieDyn=1,t}()});function VP(t,e){return{set:function(r,n){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];return Dle([t,e],r,n,o)}}}var Gde=D(()=>{Dt()});function b1(t,e,r){$de[t]=e,r!==!1&&(Wde[e]=t)}function FUe(t,e){var r=!1;if(t&&e){var n=Zo(t);if(n&&n[ur]>0)for(var o=e[oz](),s=0;s<n[ur];s++){var a=n[s];if(a&&co(e,a)&&a[oz]()===o){r=!0;break}}}return r}function HP(t,e,r,n){e&&r&&r[ur]>0&&(n&&$de[e]?(t[Lb][$de[e]]=r,t[sz]=!0):t.url+="&"+e+"="+r)}function Ewt(t,e,r){for(var n=0;n<t[ur];n++)if(t[n].name===e){t[n].value=r;return}t[Ps]({name:e,value:r})}function wwt(t,e){for(var r=0;r<t[ur];r++)if(t[r].name===e){t[m1](r,1);return}}var y1,zde,Iwt,Cwt,Twt,$de,Wde,UUe,BUe=D(()=>{ks();p1();Dt();wUe();M3();RUe();Hde();MUe();Gde();qP();zde="sendAttempt",Iwt="&"+dUe+"=true",Cwt="?cors=true&"+QG[oz]()+"="+Tde,Twt=(y1={},y1[1]=Cde,y1[100]=Cde,y1[200]="sent",y1[8004]=YG,y1[8003]=YG,y1),$de={},Wde={};b1(O3,O3,!1);b1(XG,XG);b1(wde,"Client-Id");b1(ez,ez);b1(JG,JG);b1(ZG,ZG);b1(Rde,Rde);UUe=function(){function t(e,r,n,o){var s,a,c,l,u=!1,d,p,f,m,h,g,v,b,_,x,S,I,w,k,M,H,F,ue,Z,V,A,P,B,U,$,ce,W;vr(t,this,function(Y){Ot();var Se=!0;Y[h1]=function(te,oe,Ke){U||(h=oe,I=oe.getCookieMgr(),p=Ke,f=p.diagLog(),Bu(V,Do(te,function(xt){var Q,de=xt.cfg,be=xt.cfg.extensionConfig[Ke.identifier];$=VP(be[az],be[cz]),Rs(de.anonCookieName)?Ewt(v,"anoncknm",de.anonCookieName):wwt(v,"anoncknm"),A=be[pUe],P=be.payloadListener;var Re=be.httpXHROverride,K=be[Ade]?be[Ade]:de.endpointUrl;s=K+Cwt,k=Vt(be[Dde])?!0:!be[Dde],S=!be[fUe];var re=be.valueSanitizer,fe=be[mUe],Ae=!!de[lz];Vt(be[lz])||(Ae=!!be[lz]),M=be.xhrTimeout,H=!!be[Nde],F=!!be[Lde],Z=be[hUe]!==!1,ce=!!be[gUe],oe.getPlugin("LocalStorage")&&(F=!0),u=!xb(),x=new OUe(h,re,fe,Ae,LP,ce),Pe(be[Ode])||(u=!!be[Ode]);var at=Ie();W?W.SetConfig(at):(W=new l1,W[h1](at,f));var Ve=Re,Ar=be[Mde]?Re:null,Hr=be[Mde]?Re:null,po=[3,2];if(!Re){g=!1;var Zc=[];xb()?(Zc=[2,1],po=[2,1,3]):Zc=[1,2,3],Zc=hg(Zc,be.transports),Re=ee(Zc,!1),Re||ec(f,"No available transport to send events"),Ve=ee(Zc,!0)}Ar||(po=hg(po,be[vUe]),Ar=ee(po,!0)),ue=!g&&(u&&Yc()||!F&&pg(!0)),m=(Q={},Q[0]=Re,Q[1]=Ve||ee([1,2,3],!0),Q[2]=Ar||Ve||ee([1],!0),Q[3]=Hr||ee([2,3],!0)||Ve||ee([1],!0),Q)})),U=!0)},Y.addResponseHandler=function(te){return B[Ps](te),{rm:function(){var oe=B.indexOf(te);oe>=0&&B[m1](oe,1)}}},Y[uz]=function(te){try{if(x)return x.getEventBlob(te)}catch{}return sp},Y[dz]=function(){try{var te=x&&x[Fde](0,!1,!1,!1,1,0);return Bn(te,k)}catch{}return null};function ee(te,oe){try{return W&&W.getSenderInst(te,oe)}catch{}return null}Y._getDbgPlgTargets=function(){return[m[0],a,x,m]};function Ie(){try{var te={xdrOnComplete:Xe,fetchOnComplete:Tr,xhrOnComplete:_e,beaconOnRetry:G},oe={enableSendPromise:!1,isOneDs:!0,disableCredentials:!Se,disableXhr:!1,disableBeacon:!u,disableBeaconSync:!u,disableFetchKeepAlive:F,timeWrapper:$,addNoResponse:Z,senderOnCompleteCallBack:te};return oe}catch{}return null}function Xe(te,oe,Ke){var xt=op(te);ut(oe,200,{},xt),Ju(xt)}function Ot(){var te;s=null,a=new kUe,c=!1,l=new EUe,u=!1,d=0,p=null,f=null,m=null,h=null,g=!0,v=[],b={},_=[],x=null,S=!1,I=null,w=!1,k=!1,M=te,H=te,F=te,ue=te,Z=te,V=[],A=te,P=te,B=[],U=!1,$=VP(),ce=!1,W=null}function Tr(te,oe,Ke,xt){var Q=function(Re,K,re){ut(oe,Re,K,re),Ju(re)},de={},be=te[g1];be&&be.forEach(function(Re,K){de[K]=Re}),Q(te.status,de,Ke||sp)}function _e(te,oe,Ke){var xt=op(te);ut(oe,te.status,gg(te,!0),xt),Ju(xt)}function ut(te,oe,Ke,xt){try{te(oe,Ke,xt)}catch(Q){ze(f,2,518,et(Q))}}function G(te,oe,Ke){var xt=te,Q=200,de=xt[MP],be=te[Ude]+(Z?Iwt:sp);try{var Re=Ro();if(de){var K=!!h.getPlugin("LocalStorage"),re=[],fe=[];Ce(de[Sa],function(Ae){if(re&&Ae&&Ae[uo]()>0)for(var at=Ae[fm](),Ve=0;Ve<at[ur];Ve++)if(Re.sendBeacon(be,x.getEventBlob(at[Ve])))fe[Ps](Ae[Ve]);else{re[Ps](Ae[mm](Ve));break}else re[Ps](Ae[mm](0))}),fe[ur]>0&&(de.sentEvts=fe),K||Ea(re,8003,de[Xc],!0)}else Q=0}catch(Ae){ec(f,"Failed to send telemetry using sendBeacon API. Ex:"+et(Ae)),Q=0}finally{ut(oe,Q,{},sp)}}function pe(te){return te===2||te===3}function me(te){return w&&pe(te)&&(te=2),te}Y[B3]=function(te,oe){b[te]=oe},Y.removeHeader=function(te){delete b[te]},Y[q3]=function(){return De()&&l[F3]()},Y[FP]=function(te,oe){Vt(te)&&(te=0),w&&(te=me(te),oe=2),vt(_,te,0)&&un(Ee(),0,!1,te,oe||0)},Y[pz]=function(){return!c&&d===0&&_[ur]===0},Y[j3]=function(te){w=te},Y.addBatch=function(te){if(te&&te[uo]()>0){if(a.isTenantKilled(te[Wu]()))return!1;_[Ps](te)}return!0},Y.teardown=function(){_[ur]>0&&un(Ee(),0,!0,2,2),Ce(V,function(te){te&&te.rm&&te.rm()}),V=[]},Y.pause=function(){c=!0},Y.resume=function(){c=!1,Y[FP](0,4)},Y[fz]=function(te,oe,Ke){te&&te[uo]()>0&&(Pe(oe)&&(oe=1),w&&(oe=me(oe),Ke=2),un([te],0,!1,oe,Ke||0))};function De(){return!c&&d<r}function Ee(){var te=_;return _=[],te}function vt(te,oe,Ke){var xt=!1;return te&&te[ur]>0&&!c&&m[oe]&&x&&(xt=oe!==0||De()&&(Ke>0||l[F3]())),xt}function Nt(te){var oe={};return te&&Ce(te,function(Ke,xt){oe[xt]={iKey:Ke[Wu](),evts:Ke[fm]()}}),oe}function un(te,oe,Ke,xt,Q){if(!(!te||te[ur]===0)){if(c){Ea(te,1,xt);return}xt=me(xt);try{var de=te,be=xt!==0;Ji(h,function(){return"HttpManager:_sendBatches"},function(Re){Re&&(te=te.slice(0));for(var K=[],re=null,fe=Qc(),Ae=m[xt]||(be?m[1]:m[0]),at=Ae&&Ae[mz],Ve=ue&&(w||pe(xt)||at===3||Ae._isSync&&at===2);vt(te,xt,oe);){var Ar=te.shift();Ar&&Ar[uo]()>0&&(a.isTenantKilled(Ar[Wu]())?K[Ps](Ar):(re=re||x[Fde](oe,Ke,be,Ve,Q,xt),x.appendPayload(re,Ar,e)?re.overflow!==null&&(te=[re.overflow][pm](te),re.overflow=null,na(re,fe,Qc(),Q),fe=Qc(),re=null):(na(re,fe,Qc(),Q),fe=Qc(),te=[Ar][pm](te),re=null)))}re&&na(re,fe,Qc(),Q),te[ur]>0&&(_=te[pm](_)),Ea(K,8004,xt)},function(){return{batches:Nt(de),retryCount:oe,isTeardown:Ke,isSynchronous:be,sendReason:Q,useSendBeacon:pe(xt),sendType:xt}},!be)}catch(Re){ze(f,2,48,"Unexpected Exception sending batch: "+et(Re))}}}function Bn(te,oe){var Ke={url:s,hdrs:{},useHdrs:!1};oe?(Ke[Lb]=d1(Ke[Lb],b),Ke.useHdrs=Zo(Ke.hdrs)[ur]>0):it(b,function(Re,K){Wde[Re]?HP(Ke,Wde[Re],K,!1):(Ke[Lb][Re]=K,Ke[sz]=!0)}),HP(Ke,wde,"NO_AUTH",oe),HP(Ke,XG,NP,oe);var xt=sp;Ce(te.apiKeys,function(Re){xt[ur]>0&&(xt+=","),xt+=Re}),HP(Ke,ez,xt,oe),HP(Ke,ZG,Li().toString(),oe);var Q=U1(te);if(Rs(Q)&&(Ke.url+="&ext.intweb.msfpc="+Q),l[nz]()&&HP(Ke,JG,l[iz](),oe),h[UP]){var de=h[UP]();de>=0&&(Ke.url+="&w="+de)}for(var be=0;be<v[ur];be++)Ke.url+="&"+v[be].name+"="+v[be].value;return Ke}function bi(te,oe,Ke){te[oe]=te[oe]||{},te[oe][p.identifier]=Ke}function na(te,oe,Ke,xt){if(te&&te.payloadBlob&&te.payloadBlob[ur]>0){var Q=!!A,de=m[te.sendType];!pe(te[Xc])&&te[Bde]&&te.sendReason===2&&(de=m[2]||m[3]||de);var be=k;(te.isBeacon||de[mz]===3)&&(be=!1);var Re=Bn(te,be);be=be||Re[sz];var K=Qc();Ji(h,function(){return"HttpManager:_doPayloadSend"},function(){for(var re=0;re<te.batches[ur];re++)for(var fe=te[Sa][re],Ae=fe[fm](),at=0;at<Ae[ur];at++){var Ve=Ae[at];if(S){var Ar=Ve[V3]=Ve[V3]||{};bi(Ar,"sendEventStart",K),bi(Ar,"serializationStart",oe),bi(Ar,"serializationCompleted",Ke)}Ve[zde]>0?Ve[zde]++:Ve[zde]=1}Ea(te[Sa],1e3+(xt||0),te[Xc],!0);var Hr={data:te.payloadBlob,urlString:Re.url,headers:Re[Lb],_thePayload:te,_sendReason:xt,timeout:M,disableXhrSync:H,disableFetchKeepAlive:F};be&&(FUe(Hr[g1],Ede)||(Hr[g1][Ede]=aUe),FUe(Hr[g1],QG)||(Hr[g1][QG]=Tde));var po=null;de&&(po=function(Zc){l[rz]();var qg=function(jg,c_){s_(jg,c_,te,xt)},wa=te[hz]||te[gz];try{de.sendPOST(Zc,qg,wa),P&&P(Hr,Zc,wa,te[Bde])}catch(jg){ec(f,"Unexpected exception sending payload. Ex:"+et(jg)),ut(qg,0,{})}}),Ji(h,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(po)if(te[Xc]===0&&d++,Q&&!te.isBeacon&&de[mz]!==3){var Zc={data:Hr[BP],urlString:Hr[Ude],headers:d1({},Hr[g1]),timeout:Hr.timeout,disableXhrSync:Hr[Nde],disableFetchKeepAlive:Hr[Lde]},qg=!1;Ji(h,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{A(Zc,function(wa){qg=!0,!g&&!wa[MP]&&(wa[MP]=wa[MP]||Hr[MP],wa[vz]=wa[vz]||Hr[vz]),po(wa)},te.isSync||te[hz])}catch{qg||po(Hr)}})}else po(Hr)})},function(){return{thePayload:te,serializationStart:oe,serializationCompleted:Ke,sendReason:xt}},te[gz])}te.sizeExceed&&te.sizeExceed[ur]>0&&Ea(te.sizeExceed,8003,te[Xc]),te.failedEvts&&te.failedEvts[ur]>0&&Ea(te.failedEvts,8002,te[Xc])}function lp(te,oe){S&&Ce(te,function(Ke){var xt=Ke[V3]=Ke[V3]||{};bi(xt,"sendEventCompleted",oe)})}function s_(te,oe,Ke,xt){var Q=9e3,de=null,be=!1,Re=!1;try{var K=!0;if(typeof te!==$f){if(oe){l[U3](oe[uUe]);var re=oe[lUe]||oe["kill-duration-seconds"];Ce(a[yz](oe[cUe],re),function(Ae){Ce(Ke[Sa],function(at){if(at[Wu]()===Ae){de=de||[];var Ve=at[mm](0);Ke.numEvents-=Ve[uo](),de[Ps](Ve)}})})}if(te==200||te==204){Q=200;return}(!AUe(te)||Ke.numEvents<=0)&&(K=!1),Q=9e3+te%1e3}if(K){Q=100;var fe=Ke.retryCnt;Ke[Xc]===0&&(fe<n?(be=!0,up(function(){Ke[Xc]===0&&d--,un(Ke[Sa],fe+1,Ke[hz],w?2:Ke[Xc],5)},w,xz(fe))):(Re=!0,w&&(Q=8001)))}}finally{be||(l[U3](),Bg(Ke,Q,xt,Re)),Ea(de,8004,Ke[Xc])}}function Bg(te,oe,Ke,xt){try{xt&&p[bz]();var Q=te[Sa];oe===200&&(Q=te.sentEvts||te[Sa],!xt&&!te[gz]&&p._clearBackOff(),a_(Q)),Ea(Q,oe,te[Xc],!0)}finally{te[Xc]===0&&(d--,Ke!==5&&Y.sendQueuedRequests(te[Xc],Ke))}}function a_(te){if(S){var oe=Qc();Ce(te,function(Ke){Ke&&Ke[uo]()>0&&lp(Ke[fm](),oe)})}}function up(te,oe,Ke){oe?te():$.set(te,Ke)}function U1(te){for(var oe=0;oe<te.batches[ur];oe++){var Ke=te[Sa][oe].Msfpc();if(Ke)return encodeURIComponent(Ke)}return sp}function Ju(te){var oe=B;try{for(var Ke=0;Ke<oe[ur];Ke++)try{oe[Ke](te)}catch(Q){ze(f,1,519,"Response handler failed: "+Q)}if(te){var xt=JSON.parse(te);Rs(xt.webResult)&&Rs(xt.webResult[OP])&&I.set("MSFPC",xt.webResult[OP],365*86400)}}catch{}}function Ea(te,oe,Ke,xt){if(te&&te[ur]>0&&o){var Q=o[Rm(oe)];if(Q){var de=Ke!==0;Ji(h,function(){return"HttpManager:_sendBatchesNotification"},function(){up(function(){try{Q.call(o,te,oe,de,Ke)}catch(be){ze(f,1,74,"send request notification failed: "+be)}},xt||de,0)},function(){return{batches:Nt(te),reason:oe,isSync:de,sendSync:xt,sendType:Ke}},!de)}}}function Rm(te){var oe=Twt[te];return Rs(oe)||(oe=sUe,te>=9e3&&te<=9999?oe=oUe:te>=8e3&&te<=8999?oe=YG:te>=1e3&&te<=1999&&(oe=iUe)),oe}})}return t.__ieDyn=1,t}()});function Nwt(t){return t&&t.sendPOST}var kwt,qUe,Rwt,HUe,GUe,Pwt,jUe,Awt,Kde,_1,VUe,rs,Dwt,zUe,$Ue=D(()=>{Vc();ks();p1();mP();Dt();Ide();Vde();BUe();M3();Hde();Gde();qP();kwt=.25,qUe=500,Rwt=20,HUe=6,GUe=2,Pwt=4,jUe=2,Awt=1,Kde=1e4,_1="eventsDiscarded",VUe="",rs=void 0,Dwt=Xa({eventsLimitInMem:{isVal:Nb,v:Kde},immediateEventLimit:{isVal:Nb,v:500},autoFlushEventsLimit:{isVal:Nb,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:Nwt,v:rs},overrideInstrumentationKey:rs,overrideEndpointUrl:rs,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:rs,clearTimeoutOverride:rs,payloadPreprocessor:rs,payloadListener:rs,disableEventTimings:rs,valueSanitizer:rs,stringifyObjects:rs,enableCompoundKey:rs,disableOptimizeObj:!1,transports:rs,unloadTransports:rs,useSendBeacon:rs,disableFetchKeepAlive:rs,avoidOptions:!1,xhrTimeout:rs,disableXhrSync:rs,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:ya,v:HUe},maxUnloadEventRetryAttempts:{isVal:ya,v:GUe},addNoResponse:rs,excludeCsMetaData:rs});zUe=function(t){jc(e,t);function e(){var r=t.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="4.1.1";var n,o=!1,s=[],a,c=!1,l=0,u,d=0,p,f={},m=f1,h,g,v,b,_,x,S,I,w,k,M,H,F,ue,Z,V,A,P,B,U,$,ce;return vr(e,r,function(W,Y){De(),W._getDbgPlgTargets=function(){return[_,n]},W[h1]=function(K,re,fe){Ji(re,function(){return"PostChannel:initialize"},function(){Y[h1](K,re,fe),B=re.getNotifyMgr();try{Z=Nl(Js(W[H3]),re.evtNamespace&&re.evtNamespace()),W._addHook(Do(K,function(Ae){var at=Ae.cfg,Ve=tc(null,at,re);n=Ve.getExtCfg(W[H3],Dwt),V=VP(n[az],n[cz]),M=!n[bUe]&&zG(),A=n[_Ue],ee(re),p=n[qde],u=n.immediateEventLimit,S=n[jde],F=n.maxEventRetryAttempts,ue=n.maxUnloadEventRetryAttempts,P=n[xUe],Re(),$=n[SUe],ce=!!n[IUe],U&&Se();var Ar=at.disablePageUnloadEvents||[];U=k3(Ot,Ar,Z),U=PP(Ot,Ar,Z)||U,U=AP(Tr,at.disablePageShowEvents,Z)||U})),_[h1](K,W.core,W)}catch(Ae){throw W.setInitialized(!1),Ae}},function(){return{theConfig:K,core:re,extensions:fe}})},W.processTelemetry=function(K,re){L3(K,W[H3]),re=re||W._getTelCtx(re);var fe=K;!ce&&!o&&($&&(fe[Wu]=$),ut(fe,!0),H?Nt(2,2):me()),W.processNext(fe,re)},W.getOfflineSupport=function(){try{var K=_&&_[dz]();if(K)return{getUrl:function(){return K.url},serialize:Xe,batch:Ie,shouldProcess:function(re){return!ce},createPayload:function(re){return{urlString:K.url,headers:K[Lb],data:re}}}}catch{}return null},W._doTeardown=function(K,re){Nt(2,2),o=!0,_.teardown(),Se(),De()};function Se(){R3(null,Z),P3(null,Z),A3(null,Z)}function ee(K){var re=K[UP];K[UP]=function(){var fe=0;return A&&(fe=fe|2),fe|re.call(K)}}function Ie(K){var re=VUe;return K&&K[ur]&&Ce(K,function(fe){re&&(re+=`
`),re+=fe}),re}function Xe(K){var re=VUe;try{_e(K),re=_[uz](K)}catch{}return re}function Ot(K){var re=K||Ni().event;re.type!=="beforeunload"&&(H=!0,_[j3](H)),Nt(2,2)}function Tr(K){H=!1,_[j3](H)}function _e(K){K.ext&&K.ext[Pde]&&delete K.ext[Pde],K.ext&&K.ext[tz]&&K.ext[tz].id&&delete K.ext[tz].id,M&&(K.ext=zu(K.ext),K[_z]&&(K[_z]=zu(K[_z])),K[BP]&&(K[BP]=zu(K[BP])))}function ut(K,re){if(K[G3]||(K[G3]=0),K[Ob]||(K[Ob]=1),_e(K),K[v1]){if(v||c)K[Ob]=3,K[v1]=!1;else if(_){M&&(K=zu(K)),_[fz](jP.create(K[Wu],[K]),K[v1]===!0?1:K[v1],3);return}}var fe=K[Ob],Ae=d,at=p;fe===4&&(Ae=l,at=u);var Ve=!1;if(Ae<at)Ve=!na(K,re);else{var Ar=1,Hr=Rwt;fe===4&&(Ar=4,Hr=1),Ve=!0,lp(K[Wu],K[Ob],Ar,Hr)&&(Ve=!na(K,re))}Ve&&te(_1,[K],Jd.QueueFull)}W.setEventQueueLimits=function(K,re){n[qde]=p=Nb(K)?K:Kde,n[jde]=S=Nb(re)?re:0,Re();var fe=d>K;if(!fe&&I>0)for(var Ae=1;!fe&&Ae<=3;Ae++){var at=x[Ae];at&&at[Sa]&&Ce(at[Sa],function(Ve){Ve&&Ve[uo]()>=I&&(fe=!0)})}bi(!0,fe)},W.pause=function(){vt(),c=!0,_.pause()},W.resume=function(){c=!1,_.resume(),me()},W._loadTransmitProfiles=function(K){U1(),it(K,function(re,fe){var Ae=fe[ur];if(Ae>=2){var at=Ae>2?fe[2]:0;if(fe[m1](0,Ae-2),fe[1]<0&&(fe[0]=-1),fe[1]>0&&fe[0]>0){var Ve=fe[0]/fe[1];fe[0]=Math.ceil(Ve)*fe[1]}at>=0&&fe[1]>=0&&at>fe[1]&&(at=fe[1]),fe[Ps](at),f[re]=fe}})},W.flush=function(K,re,fe){K===void 0&&(K=!0);var Ae;if(!c)if(fe=fe||1,K)re||(Ae=Za(function(Ve){re=Ve})),a==null?(vt(),Bg(1,0,fe),a=Ee(function(){a=null,a_(re,fe)},0)):s[Ps](re);else{var at=vt();G(1,1,fe),re&&re(),at&&me()}return Ae},W.setMsaAuthTicket=function(K){_[B3](O3,K)},W.setAuthPluginHeader=function(K){_[B3](kde,K)},W.removeAuthPluginHeader=function(){_.removeHeader(kde)},W.hasEvents=pe,W._setTransmitProfile=function(K){m!==K&&f[K]!==void 0&&(vt(),m=K,me())},Dl(W,function(){return _},["addResponseHandler"]);function G(K,re,fe){var Ae=Bg(K,re,fe);return _[FP](re,fe),Ae}function pe(){return d>0}function me(){if(w>=0&&Bg(w,0,k)&&_[FP](0,k),l>0&&!g&&!c){var K=f[m][2];K>=0&&(g=Ee(function(){g=null,G(4,0,1),me()},K))}var re=f[m][1];!h&&!a&&re>=0&&!c&&(pe()?h=Ee(function(){h=null,G(b===0?3:1,0,1),b++,b%=2,me()},re):b=0)}W[bz]=function(){v<Pwt&&(v++,vt(),me())},W._clearBackOff=function(){v&&(v=0,vt(),me())};function De(){n=null,o=!1,s=[],a=null,c=!1,l=0,u=500,d=0,p=Kde,f={},m=f1,h=null,g=null,v=0,b=0,x={},S=0,U=!1,I=0,w=-1,k=null,M=!0,H=!1,F=HUe,ue=GUe,Z=null,$=null,ce=!1,V=VP(),_=new UUe(qUe,jUe,Awt,{requeue:Ea,send:Ke,sent:xt,drop:Q,rspFail:de,oth:be}),Ju(),un(),Re()}function Ee(K,re){re===0&&v&&(re=1);var fe=1e3;return v&&(fe=xz(v-1)),V.set(K,re*fe)}function vt(){return h!==null?(h.cancel(),h=null,b=0,!0):!1}function Nt(K,re){vt(),a&&(a.cancel(),a=null),c||G(1,K,re)}function un(){x[4]={batches:[],iKeyMap:{}},x[3]={batches:[],iKeyMap:{}},x[2]={batches:[],iKeyMap:{}},x[1]={batches:[],iKeyMap:{}}}function Bn(K,re,fe){var Ae=x[re];Ae||(re=1,Ae=x[re]);var at=Ae.iKeyMap[K];return!at&&fe&&(at=jP.create(K),Ae.batches[Ps](at),Ae.iKeyMap[K]=at),at}function bi(K,re){_[q3]()&&!v&&(S>0&&d>S&&(re=!0),re&&a==null&&W.flush(K,function(){},20))}function na(K,re){M&&(K=zu(K));var fe=K[Ob],Ae=Bn(K[Wu],fe,!0);return Ae.addEvent(K)?(fe!==4?(d++,re&&K[G3]===0&&bi(!K.sync,I>0&&Ae[uo]()>=I)):l++,!0):!1}function lp(K,re,fe,Ae){for(;fe<=re;){var at=Bn(K,re,!0);if(at&&at[uo]()>0){var Ve=at[mm](0,Ae),Ar=Ve[uo]();if(Ar>0)return fe===4?l-=Ar:d-=Ar,oe(_1,[Ve],Jd.QueueFull),!0}fe++}return s_(),!1}function s_(){for(var K=0,re=0,fe=function(at){var Ve=x[at];Ve&&Ve[Sa]&&Ce(Ve[Sa],function(Ar){at===4?K+=Ar[uo]():re+=Ar[uo]()})},Ae=1;Ae<=4;Ae++)fe(Ae);d=re,l=K}function Bg(K,re,fe){var Ae=!1,at=re===0;return!at||_[q3]()?Ji(W.core,function(){return"PostChannel._queueBatches"},function(){for(var Ve=[],Ar=4;Ar>=K;){var Hr=x[Ar];Hr&&Hr.batches&&Hr.batches[ur]>0&&(Ce(Hr[Sa],function(po){_.addBatch(po)?Ae=Ae||po&&po[uo]()>0:Ve=Ve[pm](po[fm]()),Ar===4?l-=po[uo]():d-=po[uo]()}),Hr[Sa]=[],Hr.iKeyMap={}),Ar--}Ve[ur]>0&&te(_1,Ve,Jd.KillSwitch),Ae&&w>=K&&(w=-1,k=0)},function(){return{latency:K,sendType:re,sendReason:fe}},!at):(w=w>=0?Math.min(w,K):K,k=Math.max(k,fe)),Ae}function a_(K,re){G(1,0,re),s_(),up(function(){K&&K(),s[ur]>0?a=Ee(function(){a=null,a_(s.shift(),re)},0):(a=null,me())})}function up(K){_[pz]()?K():a=Ee(function(){a=null,up(K)},kwt)}function U1(){vt(),Ju(),m=f1,me()}function Ju(){f={},f[f1]=[2,1,0],f[WG]=[6,3,0],f[KG]=[18,9,0]}function Ea(K,re){var fe=[],Ae=F;H&&(Ae=ue),Ce(K,function(at){at&&at[uo]()>0&&Ce(at[fm](),function(Ve){Ve&&(Ve[v1]&&(Ve[Ob]=4,Ve[v1]=!1),Ve[G3]<Ae?(L3(Ve,W[H3]),ut(Ve,!1)):fe[Ps](Ve))})}),fe[ur]>0&&te(_1,fe,Jd.NonRetryableStatus),H&&Nt(2,2)}function Rm(K,re){var fe=B||{},Ae=fe[K];if(Ae)try{Ae.apply(fe,re)}catch(at){ze(W.diagLog(),1,74,K+" notification failed: "+at)}}function te(K,re){for(var fe=[],Ae=2;Ae<arguments.length;Ae++)fe[Ae-2]=arguments[Ae];re&&re[ur]>0&&Rm(K,[re][pm](fe))}function oe(K,re){for(var fe=[],Ae=2;Ae<arguments.length;Ae++)fe[Ae-2]=arguments[Ae];re&&re[ur]>0&&Ce(re,function(at){at&&at[uo]()>0&&Rm(K,[at.events()][pm](fe))})}function Ke(K,re,fe){K&&K[ur]>0&&Rm("eventsSendRequest",[re>=1e3&&re<=1999?re-1e3:0,fe!==!0])}function xt(K,re){oe("eventsSent",K,re),me()}function Q(K,re){oe(_1,K,re>=8e3&&re<=8999?re-8e3:Jd.Unknown)}function de(K){oe(_1,K,Jd.NonRetryableStatus),me()}function be(K,re){oe(_1,K,Jd.Unknown),me()}function Re(){P?I=0:I=Math.max(qUe*(jUe+1),p/6)}}),r}return e.__ieDyn=1,e}(Sg)});var WUe={};Pn(WUe,{BE_PROFILE:()=>KG,NRT_PROFILE:()=>WG,PostChannel:()=>zUe,RT_PROFILE:()=>f1});var KUe=D(()=>{Ide();$Ue()});var QUe=R(hm=>{"use strict";var Lwt=hm&&hm.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Owt=hm&&hm.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),YUe=hm&&hm.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Lwt(e,t,r);return Owt(e,t),e};Object.defineProperty(hm,"__esModule",{value:!0});hm.oneDataSystemClientFactory=void 0;var Mwt=async(t,e,r)=>{let n=await Promise.resolve().then(()=>YUe((p1(),fo(nUe)))),o=await Promise.resolve().then(()=>YUe((KUe(),fo(WUe)))),s=new n.AppInsightsCore,a=new o.PostChannel,c={instrumentationKey:t,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[a]]};if(r){c.extensionConfig={};let d={alwaysUseXhrOverride:!0,httpXHROverride:r};c.extensionConfig[a.identifier]=d}let u=e.workspace.getConfiguration("telemetry").get("internalTesting");return s.initialize(c,[]),s.addTelemetryInitializer(d=>{d.ext=d.ext??{},d.ext.web=d.ext.web??{},d.ext.web.consentDetails='{"GPC_DataSharingOptIn":false}',u&&(d.ext.utc=d.ext.utc??{},d.ext.utc.flags=8462029)}),s},Fwt=async(t,e,r)=>{let n=await Mwt(t,e,r);return{logEvent:(a,c)=>{try{n?.track({name:a,baseData:{name:a,properties:c?.properties,measurements:c?.measurements}})}catch(l){throw new Error(`Failed to log event to app insights!
`+l.message)}},flush:async()=>{try{return new Promise((c,l)=>{if(!n){c();return}n.flush(!0,u=>{if(!u){l("Failed to flush app 1DS!");return}})})}catch(a){throw new Error(`Failed to flush 1DS!
`+a.message)}},dispose:async()=>new Promise(c=>{if(!n){c();return}n.unload(!1,()=>{c(),n=void 0},1e3)})}};hm.oneDataSystemClientFactory=Fwt});var XUe,GP,zP,z3,Mb,gm,ns,Iz,Ku=D(()=>{XUe="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",GP="sampleRate",zP="ProcessLegacy",z3="http.method",Mb="https://dc.services.visualstudio.com",gm="/v2/track",ns="not_specified",Iz="iKey"});var x1,Yde=D(()=>{ln();x1=Wle({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var wg,Gt,vm,Fb,kg,Rg,Cz,No,ap,Ub,Tz,Ez,wz,Qde,kz,Rz,S1,$P,Xde,$3,I1,Yu,Zs,Ia,C1,ym,T1,Pz,Az,Jde,E1,Bb,W3,K3,w1,WP,k1,Zde,is=D(()=>{wg="split",Gt="length",vm="toLowerCase",Fb="ingestionendpoint",kg="toString",Rg="push",Cz="removeItem",No="name",ap="message",Ub="count",Tz="preTriggerDate",Ez="disabled",wz="interval",Qde="daysOfMonth",kz="date",Rz="getUTCDate",S1="stringify",$P="pathname",Xde="correlationHeaderExcludePatterns",$3="extensionConfig",I1="exceptions",Yu="parsedStack",Zs="properties",Ia="measurements",C1="sizeInBytes",ym="typeName",T1="severityLevel",Pz="problemGroup",Az="isManual",Jde="CreateFromInterface",E1="assembly",Bb="fileName",W3="hasFullStack",K3="level",w1="method",WP="line",k1="duration",Zde="receivedResponse"});function Dz(t,e,r){var n=e[Gt],o=epe(t,e);if(o[Gt]!==n){for(var s=0,a=o;r[a]!==void 0;)s++,a=Yi(o,0,147)+tpe(s);o=a}return o}function epe(t,e){var r;return e&&(e=Zr(si(e)),e[Gt]>150&&(r=Yi(e,0,150),ze(t,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),r||e}function Cn(t,e,r){r===void 0&&(r=1024);var n;return e&&(r=r||1024,e=Zr(si(e)),e[Gt]>r&&(n=Yi(e,0,r),ze(t,2,61,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),n||e}function qb(t,e){return Oz(t,e,2048,66)}function KP(t,e){var r;return e&&e[Gt]>32768&&(r=Yi(e,0,32768),ze(t,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),r||e}function Nz(t,e){var r;if(e){var n=""+e;n[Gt]>32768&&(r=Yi(n,0,32768),ze(t,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return r||e}function Ca(t,e){if(e){var r={};it(e,function(n,o){if(Kn(o)&&em())try{o=Xs()[S1](o)}catch(s){ze(t,2,49,"custom property is not valid",{exception:s},!0)}o=Cn(t,o,8192),n=Dz(t,n,r),r[n]=o}),e=r}return e}function Ta(t,e){if(e){var r={};it(e,function(n,o){n=Dz(t,n,r),r[n]=o}),e=r}return e}function Lz(t,e){return e&&Oz(t,e,128,69)[kg]()}function Oz(t,e,r,n){var o;return e&&(e=Zr(si(e)),e[Gt]>r&&(o=Yi(e,0,r),ze(t,2,n,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0))),o||e}function tpe(t){var e="00"+t;return Yd(e,e[Gt]-3)}var Qu=D(()=>{ln();Dt();is()});function R1(t){var e=ZUe,r=Uwt,n=r[e];return JUe.createElement?r[e]||(n=r[e]=JUe.createElement("a")):n={host:rpe(t,!0)},n.href=t,e++,e>=r[Gt]&&(e=0),ZUe=e,n}function eBe(t){var e,r=R1(t);return r&&(e=r.href),e}function tBe(t){var e,r=R1(t);return r&&(e=r[$P]),e}function rBe(t,e){return t?t.toUpperCase()+" "+e:e}function rpe(t,e){var r=Y3(t,e)||"";if(r){var n=r.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Gt]>3&&$t(n[2])&&n[2][Gt]>0)return n[2]+(n[3]||"")}return r}function Y3(t,e){var r=null;if(t){var n=t.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Gt]>2&&$t(n[2])&&n[2][Gt]>0&&(r=n[2]||"",e&&n[Gt]>2)){var o=(n[1]||"")[vm](),s=n[3]||"";(o==="http"&&s===":80"||o==="https"&&s===":443")&&(s=""),r+=s}}return r}var JUe,ZUe,Uwt,npe=D(()=>{ln();is();JUe=Di()||{},ZUe=0,Uwt=[null,null,null,null,null]});function Q3(t){return $r(Bwt,t[vm]())!==-1}function nBe(t){ipe=t}function iBe(){return ipe}function oBe(t,e,r){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t[Xde]){for(var n=0;n<t.correlationHeaderExcludePatterns[Gt];n++)if(t[Xde][n].test(e))return!1}var o=R1(e).host[vm]();if(o&&(Ja(o,":443")!==-1||Ja(o,":80")!==-1)&&(o=(Y3(e,!0)||"")[vm]()),(!t||!t.enableCorsCorrelation)&&o&&o!==r)return!1;var s=t&&t.correlationHeaderDomains;if(s){var a;if(Ce(s,function(u){var d=new RegExp(u.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(o)}),!a)return!1}var c=t&&t.correlationHeaderExcludedDomains;if(!c||c[Gt]===0)return!0;for(var n=0;n<c[Gt];n++){var l=new RegExp(c[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(l.test(o))return!1}return o&&o[Gt]>0}function sBe(t){if(t){var e=ope(t,x1[1]);if(e&&e!==ipe)return e}}function ope(t,e){if(t)for(var r=t[wg](","),n=0;n<r[Gt];++n){var o=r[n][wg]("=");if(o[Gt]===2&&o[0]===e)return o[1]}}function aBe(t,e,r,n){var o,s=n,a=n;if(e&&e[Gt]>0){var c=R1(e);if(o=c.host,!s)if(c[$P]!=null){var l=c.pathname[Gt]===0?"/":c[$P];l.charAt(0)!=="/"&&(l="/"+l),a=c[$P],s=Cn(t,r?r+" "+l:l)}else s=Cn(t,e)}else o=n,s=n;return{target:o,name:s,data:a}}function cBe(){var t=ag();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return Li()}function lBe(t,e){var r=null;return t!==0&&e!==0&&!Pe(t)&&!Pe(e)&&(r=e-t),r}function uBe(t,e){var r=t||{};return{getName:function(){return r[No]},setName:function(n){e&&e.setName(n),r[No]=n},getTraceId:function(){return r.traceID},setTraceId:function(n){e&&e.setTraceId(n),om(n)&&(r.traceID=n)},getSpanId:function(){return r.parentID},setSpanId:function(n){e&&e.setSpanId(n),sm(n)&&(r.parentID=n)},getTraceFlags:function(){return r.traceFlags},setTraceFlags:function(n){e&&e.setTraceFlags(n),r.traceFlags=n}}}var Bwt,ipe,spe=D(()=>{ln();Dt();Ku();Yde();Qu();npe();is();Bwt=[Mb+gm,"https://breeze.aimon.applicationinsights.io"+gm,"https://dc-int.services.visualstudio.com"+gm],ipe="cid-v1:"});var YP,dBe,pBe,ape=D(()=>{ln();YP=Po({LocalStorage:0,SessionStorage:1}),dBe=Po({AI:0,AI_AND_W3C:1,W3C:2}),pBe=Po({Normal:1,Critical:2})});function cpe(){return QP()?Mz(YP.LocalStorage):null}function Mz(t){try{if(Pe(ba()))return null;var e=new Date()[kg](),r=yn(t===YP.LocalStorage?"localStorage":"sessionStorage"),n=fBe+e;r.setItem(n,e);var o=r.getItem(n)!==e;if(r[Cz](n),!o)return r}catch{}return null}function lpe(){return P1()?Mz(YP.SessionStorage):null}function mBe(){jb=!1,Vb=!1}function Fz(t){fBe=t||""}function hBe(){jb=QP(!0),Vb=P1(!0)}function QP(t){return(t||jb===void 0)&&(jb=!!Mz(YP.LocalStorage)),jb}function Uz(t,e){var r=cpe();if(r!==null)try{return r.getItem(e)}catch(n){jb=!1,ze(t,2,1,"Browser failed read of local storage. "+Yn(n),{exception:et(n)})}return null}function Bz(t,e,r){var n=cpe();if(n!==null)try{return n.setItem(e,r),!0}catch(o){jb=!1,ze(t,2,3,"Browser failed write to local storage. "+Yn(o),{exception:et(o)})}return!1}function gBe(t,e){var r=cpe();if(r!==null)try{return r[Cz](e),!0}catch(n){jb=!1,ze(t,2,5,"Browser failed removal of local storage item. "+Yn(n),{exception:et(n)})}return!1}function P1(t){return(t||Vb===void 0)&&(Vb=!!Mz(YP.SessionStorage)),Vb}function vBe(){var t=[];return P1()&&it(yn("sessionStorage"),function(e){t[Rg](e)}),t}function qz(t,e){var r=lpe();if(r!==null)try{return r.getItem(e)}catch(n){Vb=!1,ze(t,2,2,"Browser failed read of session storage. "+Yn(n),{exception:et(n)})}return null}function jz(t,e,r){var n=lpe();if(n!==null)try{return n.setItem(e,r),!0}catch(o){Vb=!1,ze(t,2,4,"Browser failed write to session storage. "+Yn(o),{exception:et(o)})}return!1}function yBe(t,e){var r=lpe();if(r!==null)try{return r[Cz](e),!0}catch(n){Vb=!1,ze(t,2,6,"Browser failed removal of session storage item. "+Yn(n),{exception:et(n)})}return!1}var jb,Vb,fBe,upe=D(()=>{ln();ape();is();jb=void 0,Vb=void 0,fBe=""});var qwt,bBe,_Be=D(()=>{ln();Dt();upe();is();qwt="appInsightsThrottle",bBe=function(){function t(e,r){var n=this,o,s,a,c,l,u,d,p=!1,f=!1;h(),n._getDbgPlgTargets=function(){return[d]},n.getConfig=function(){return a},n.canThrottle=function(A){var P=ue(A),B=g(A);return _(B,o,P)},n.isTriggered=function(A){return Z(A)},n.isReady=function(){return p},n.flush=function(A){try{var P=V(A);if(P&&P[Gt]>0){var B=P.slice(0);return d[A]=[],Ce(B,function(U){m(U.msgID,U[ap],U.severity,!1)}),!0}}catch{}return!1},n.flushAll=function(){try{if(d){var A=!0;return it(d,function(P){var B=n.flush(parseInt(P));A=A&&B}),A}}catch{}return!1},n.onReadyState=function(A,P){return P===void 0&&(P=!0),p=Pe(A)?!0:A,p&&P?n.flushAll():null},n.sendMessage=function(A,P,B){return m(A,P,B,!0)};function m(A,P,B,U){if(p){var $=F(A);if(!$)return;var ce=g(A),W=ue(A),Y=_(ce,o,W),Se=!1,ee=0,Ie=Z(A);try{Y&&!Ie?(ee=Math.min(ce.limit.maxSendNumber,W[Ub]+1),W[Ub]=0,Se=!0,l[A]=!0,W[Tz]=new Date):(l[A]=Y,W[Ub]+=1);var Xe=x(A);k(s,Xe,W);for(var Ot=0;Ot<ee;Ot++)H(A,s,P,B)}catch{}return{isThrottled:Se,throttleNum:ee}}else if(U){var Tr=V(A);Tr[Rg]({msgID:A,message:P,severity:B})}return null}function h(){s=np(e),l={},c={},d={},a={},v(109),u=rm(r)?r:"",e.addUnloadHook(Do(e.config,function(A){var P=A.cfg;o=QP();var B=P.throttleMgrCfg||{};it(B,function(U,$){v(parseInt(U),$)})}))}function g(A){return a[A]||a[109]}function v(A,P){var B,U;try{var $=P||{},ce={};ce[Ez]=!!$[Ez];var W=$[wz]||{};f=W?.daysOfMonth&&W?.daysOfMonth[Gt]>0,ce[wz]=b(W);var Y={samplingRate:((B=$.limit)===null||B===void 0?void 0:B.samplingRate)||100,maxSendNumber:((U=$.limit)===null||U===void 0?void 0:U.maxSendNumber)||1};ce.limit=Y,a[A]=ce}catch{}}function b(A){A=A||{};var P=A?.monthInterval,B=A?.dayInterval;return Pe(P)&&Pe(B)&&(A.monthInterval=3,f||(A[Qde]=[28],f=!0)),A={monthInterval:A?.monthInterval,dayInterval:A?.dayInterval,daysOfMonth:A?.daysOfMonth},A}function _(A,P,B){if(A&&!A[Ez]&&P&&rm(B)){var U=w(),$=B[kz],ce=A[wz],W=1;if(ce?.monthInterval){var Y=(U.getUTCFullYear()-$.getUTCFullYear())*12+U.getUTCMonth()-$.getUTCMonth();W=M(ce.monthInterval,0,Y)}var Se=1;if(f)Se=$r(ce[Qde],U[Rz]());else if(ce?.dayInterval){var ee=Math.floor((U.getTime()-$.getTime())/864e5);Se=M(ce.dayInterval,0,ee)}return W>=0&&Se>=0}return!1}function x(A,P){var B=rm(P)?P:"";return A?qwt+B+"-"+A:null}function S(A){try{if(A){var P=new Date;return A.getUTCFullYear()===P.getUTCFullYear()&&A.getUTCMonth()===P.getUTCMonth()&&A[Rz]()===P[Rz]()}}catch{}return!1}function I(A,P,B){try{var U={date:w(),count:0};if(A){var $=JSON.parse(A),ce={date:w($[kz])||U[kz],count:$[Ub]||U[Ub],preTriggerDate:$.preTriggerDate?w($[Tz]):void 0};return ce}else return k(P,B,U),U}catch{}return null}function w(A){try{if(A){var P=new Date(A);if(!isNaN(P.getDate()))return P}else return new Date}catch{}return null}function k(A,P,B){try{return Bz(A,P,Zr(JSON[S1](B)))}catch{}return!1}function M(A,P,B){return A<=0?1:B>=P&&(B-P)%A==0?Math.floor((B-P)/A)+1:-1}function H(A,P,B,U){ze(P,U||1,A,B)}function F(A){try{var P=g(A);return c3(1e6)<=P.limit.samplingRate}catch{}return!1}function ue(A){try{var P=c[A];if(!P){var B=x(A,u);P=I(Uz(s,B),s,B),c[A]=P}return c[A]}catch{}return null}function Z(A){var P=l[A];if(Pe(P)){P=!1;var B=ue(A);B&&(P=S(B[Tz])),l[A]=P}return l[A]}function V(A){return d=d||{},Pe(d[A])&&(d[A]=[]),d[A]}}return t}()});function X3(t){if(!t)return{};var e=t[wg](jwt),r=XR(e,function(o,s){var a=s[wg](Vwt);if(a[Gt]===2){var c=a[0][vm](),l=a[1];o[c]=l}return o},{});if(Zo(r)[Gt]>0){if(r.endpointsuffix){var n=r.location?r.location+".":"";r[Fb]=r[Fb]||"https://"+n+"dc."+r.endpointsuffix}r[Fb]=r[Fb]||Mb,cb(r[Fb],"/")&&(r[Fb]=r[Fb].slice(0,-1))}return r}var jwt,Vwt,xBe,SBe=D(()=>{ln();Ku();is();jwt=";",Vwt="=";xBe={parse:X3}});var Vz,IBe=D(()=>{ln();Ku();is();Qu();Vz=function(){function t(e,r,n){var o=this,s=this;s.ver=1,s.sampleRate=100,s.tags={},s[No]=Cn(e,n)||ns,s.data=r,s.time=Al(new Date),s.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1}}return t}()});var bm,CBe=D(()=>{Ku();is();Qu();bm=function(){function t(e,r,n,o){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var s=this;s.ver=2,s[No]=Cn(e,r)||ns,s[Zs]=Ca(e,n),s[Ia]=Ta(e,o)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}()});function mpe(t,e){var r=t;return r&&!$t(r)&&(JSON&&JSON[S1]?(r=JSON[S1](t),e&&(!r||r==="{}")&&(wt(t[kg])?r=t[kg]():r=""+t)):r=""+t+" - (Missing JSON.stringify)"),r||""}function RBe(t,e){var r=t;return t&&(r&&!$t(r)&&(r=t[fpe]||t[kBe]||r),r&&!$t(r)&&(r=mpe(r,!0)),t.filename&&(r=r+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&Ja(r||"",e)===-1&&(r=e+": "+r),r||""}function Gwt(t){try{if(Kn(t))return"hasFullStack"in t&&"typeName"in t}catch{}return!1}function zwt(t){try{if(Kn(t))return"ver"in t&&"exceptions"in t&&"properties"in t}catch{}return!1}function EBe(t){return t&&t.src&&$t(t.src)&&t.obj&&mt(t.obj)}function A1(t){var e=t||"";$t(e)||($t(e[Jc])?e=e[Jc]:e=""+e);var r=e[wg](`
`);return{src:e,obj:r}}function $wt(t){for(var e=[],r=t[wg](`
`),n=0;n<r[Gt];n++){var o=r[n];r[n+1]&&(o+="@"+r[n+1],n++),e[Rg](o)}return{src:t,obj:e}}function PBe(t){var e=null;if(t)try{if(t[Jc])e=A1(t[Jc]);else if(t[XP]&&t[XP][Jc])e=A1(t[XP][Jc]);else if(t.exception&&t.exception[Jc])e=A1(t.exception[Jc]);else if(EBe(t))e=t;else if(EBe(t[ppe]))e=t[ppe];else if(Ni()&&Ni().opera&&t[fpe])e=$wt(t[ap]);else if(t.reason&&t.reason[Jc])e=A1(t.reason[Jc]);else if($t(t))e=A1(t);else{var r=t[fpe]||t[kBe]||"";$t(t[TBe])&&(r&&(r+=`
`),r+=" from "+t[TBe]),r&&(e=A1(r))}}catch(n){e=A1(n)}return e||{src:"",obj:null}}function Wwt(t){var e="";return t&&(t.obj?Ce(t.obj,function(r){e+=r+`
`}):e=t.src||""),e}function Kwt(t){var e,r=t.obj;if(r&&r[Gt]>0){e=[];var n=0,o=0;Ce(r,function(h){var g=h[kg]();if(hpe.regex.test(g)){var v=new hpe(g,n++);o+=v[C1],e[Rg](v)}});var s=32*1024;if(o>s)for(var a=0,c=e[Gt]-1,l=0,u=a,d=c;a<c;){var p=e[a][C1],f=e[c][C1];if(l+=p+f,l>s){var m=d-u+1;e.splice(u,m);break}u=a,d=c,a++,c--}}return e}function Hz(t){var e="";if(t&&(e=t.typeName||t[No]||"",!e))try{var r=/function (.{1,200})\(/,n=r.exec(t.constructor[kg]());e=n&&n[Gt]>1?n[1]:""}catch{}return e}function dpe(t){if(t)try{if(!$t(t)){var e=Hz(t),r=mpe(t,!1);return(!r||r==="{}")&&(t[XP]&&(t=t[XP],e=Hz(t)),r=mpe(t,!0)),Ja(r,e)!==0&&e!=="String"?e+":"+r:r}}catch{}return""+(t||"")}var Hwt,XP,Jc,ppe,TBe,fpe,kBe,Hb,wBe,hpe,ABe=D(()=>{Vc();ln();Dt();Ku();is();Qu();Hwt="<no_method>",XP="error",Jc="stack",ppe="stackDetails",TBe="errorSrc",fpe="message",kBe="description";Hb=function(){function t(e,r,n,o,s,a){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var c=this;c.ver=2,zwt(r)?(c[I1]=r[I1]||[],c[Zs]=r[Zs],c[Ia]=r[Ia],r[T1]&&(c[T1]=r[T1]),r.id&&(c.id=r.id,r[Zs].id=r.id),r[Pz]&&(c[Pz]=r[Pz]),Pe(r[Az])||(c[Az]=r[Az])):(n||(n={}),a&&(n.id=a),c[I1]=[new wBe(e,r,n)],c[Zs]=Ca(e,n),c[Ia]=Ta(e,o),s&&(c[T1]=s),a&&(c.id=a))}return t.CreateAutoException=function(e,r,n,o,s,a,c,l){var u,d=Hz(s||a||e);return u={},u[ap]=RBe(e,d),u.url=r,u.lineNumber=n,u.columnNumber=o,u.error=dpe(s||a||e),u.evt=dpe(a||e),u[ym]=d,u.stackDetails=PBe(c||s||a),u.errorSrc=l,u},t.CreateFromInterface=function(e,r,n,o){var s=r[I1]&&Kf(r[I1],function(c){return wBe[Jde](e,c)}),a=new t(e,ju(ju({},r),{exceptions:s}),n,o);return a},t.prototype.toInterface=function(){var e,r=this,n=r.exceptions,o=r.properties,s=r.measurements,a=r.severityLevel,c=r.problemGroup,l=r.id,u=r.isManual,d=n instanceof Array&&Kf(n,function(p){return p.toInterface()})||void 0;return e={ver:"4.0"},e[I1]=d,e.severityLevel=a,e.properties=o,e.measurements=s,e.problemGroup=c,e.id=l,e.isManual=u,e},t.CreateSimpleException=function(e,r,n,o,s,a){var c;return{exceptions:[(c={},c[W3]=!0,c.message=e,c.stack=s,c.typeName=r,c)]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t.formatError=dpe,t}(),wBe=function(){function t(e,r,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var o=this;if(Gwt(r))o[ym]=r[ym],o[ap]=r[ap],o[Jc]=r[Jc],o[Yu]=r[Yu]||[],o[W3]=r[W3];else{var s=r,a=s&&s.evt;Zy(s)||(s=s[XP]||a||s),o[ym]=Cn(e,Hz(s))||ns,o[ap]=KP(e,RBe(r||s,o[ym]))||ns;var c=r[ppe]||PBe(r);o[Yu]=Kwt(c),mt(o[Yu])&&Kf(o[Yu],function(l){l[E1]=Cn(e,l[E1]),l[Bb]=Cn(e,l[Bb])}),o[Jc]=Nz(e,Wwt(c)),o.hasFullStack=mt(o.parsedStack)&&o.parsedStack[Gt]>0,n&&(n[ym]=n[ym]||o[ym])}}return t.prototype.toInterface=function(){var e,r=this,n=r[Yu]instanceof Array&&Kf(r[Yu],function(s){return s.toInterface()}),o=(e={id:r.id,outerId:r.outerId,typeName:r[ym],message:r[ap],hasFullStack:r[W3],stack:r[Jc]},e[Yu]=n||void 0,e);return o},t.CreateFromInterface=function(e,r){var n=r[Yu]instanceof Array&&Kf(r[Yu],function(s){return hpe[Jde](s)})||r[Yu],o=new t(e,ju(ju({},r),{parsedStack:n}));return o},t}(),hpe=function(){function t(e,r){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[C1]=0,typeof e=="string"){var o=e;n[K3]=r,n[w1]=Hwt,n[E1]=Zr(o),n[Bb]="",n[WP]=0;var s=o.match(t.regex);s&&s[Gt]>=5&&(n[w1]=Zr(s[2])||n[w1],n[Bb]=Zr(s[4]),n[WP]=parseInt(s[5])||0)}else n[K3]=e[K3],n[w1]=e[w1],n[E1]=e[E1],n[Bb]=e[Bb],n[WP]=e[WP],n[C1]=0;n.sizeInBytes+=n.method[Gt],n.sizeInBytes+=n.fileName[Gt],n.sizeInBytes+=n.assembly[Gt],n[C1]+=t.baseSize,n.sizeInBytes+=n.level.toString()[Gt],n.sizeInBytes+=n.line.toString()[Gt]}return t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){var e=this;return{level:e[K3],method:e[w1],assembly:e[E1],fileName:e[Bb],line:e[WP]}},t.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}()});var DBe,NBe=D(()=>{DBe=function(){function t(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return t}()});var _m,LBe=D(()=>{Ku();is();NBe();Qu();_m=function(){function t(e,r,n,o,s,a,c,l,u){this.aiDataContract={ver:1,metrics:1,properties:0};var d=this;d.ver=2;var p=new DBe;p[Ub]=o>0?o:void 0,p.max=isNaN(a)||a===null?void 0:a,p.min=isNaN(s)||s===null?void 0:s,p[No]=Cn(e,r)||ns,p.value=n,p.stdDev=isNaN(c)||c===null?void 0:c,d.metrics=[p],d[Zs]=Ca(e,l),d[Ia]=Ta(e,u)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}()});function OBe(t,e){return e===void 0&&(e=!1),t==null?e:t.toString()[vm]()==="true"}function JP(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=J3+t%1e3,r=J3+Math.floor(t/1e3)%60,n=J3+Math.floor(t/(1e3*60))%60,o=J3+Math.floor(t/(1e3*60*60))%24,s=Math.floor(t/(1e3*60*60*24));return e=e[Gt]===1?"00"+e:e[Gt]===2?"0"+e:e,r=r[Gt]<2?"0"+r:r,n=n[Gt]<2?"0"+n:n,o=o[Gt]<2?"0"+o:o,(s>0?s+".":J3)+o+":"+n+":"+r+"."+e}function MBe(t,e){var r=null;return Ce(t,function(n){if(n.identifier===e)return r=n,-1}),r}function FBe(t,e,r,n,o){return!o&&$t(t)&&(t==="Script error."||t==="Script error")}var J3,Gz=D(()=>{ln();is();J3=""});var Gb,UBe=D(()=>{Ku();Gz();is();Qu();Gb=function(){function t(e,r,n,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=Lz(e,c),l.url=qb(e,n),l[No]=Cn(e,r)||ns,isNaN(o)||(l[k1]=JP(o)),l[Zs]=Ca(e,s),l[Ia]=Ta(e,a)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}()});var zb,BBe=D(()=>{Gz();spe();is();Qu();zb=function(){function t(e,r,n,o,s,a,c,l,u,d,p,f){u===void 0&&(u="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=r,m[k1]=JP(s),m.success=a,m.resultCode=c+"",m.type=Cn(e,u);var h=aBe(e,n,l,o);m.data=qb(e,o)||h.data,m.target=Cn(e,h.target),d&&(m.target="".concat(m.target," | ").concat(d)),m[No]=Cn(e,h[No]),m[Zs]=Ca(e,p),m[Ia]=Ta(e,f)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}()});var $b,qBe=D(()=>{Ku();is();Qu();$b=function(){function t(e,r,n,o,s){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var a=this;a.ver=2,r=r||ns,a[ap]=KP(e,r),a[Zs]=Ca(e,o),a[Ia]=Ta(e,s),n&&(a[T1]=n)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}()});var Wb,jBe=D(()=>{Ku();is();Qu();Wb=function(){function t(e,r,n,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=qb(e,n),l[No]=Cn(e,r)||ns,l[Zs]=Ca(e,s),l[Ia]=Ta(e,a),c&&(l.domProcessing=c.domProcessing,l[k1]=c[k1],l.networkConnect=c.networkConnect,l.perfTotal=c.perfTotal,l[Zde]=c[Zde],l.sentRequest=c.sentRequest)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}()});var xm,VBe=D(()=>{xm=function(){function t(e,r){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=r}return t}()});var zz,HBe=D(()=>{ln();zz=Po({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});var GBe,zBe=D(()=>{ln();is();GBe=function(){function t(){}return t.getConfig=function(e,r,n,o){o===void 0&&(o=!1);var s;return n&&e[$3]&&e[$3][n]&&!Pe(e[$3][n][r])?s=e[$3][n][r]:s=e[r],Pe(s)?o:s},t}()});function Yb(t){var e="ai."+t+".";return function(r){return e+r}}var Z3,os,$z,ZP,gpe,Kb,D1,eM,eA,vpe=D(()=>{Vc();ln();Z3=Yb("application"),os=Yb("device"),$z=Yb("location"),ZP=Yb("operation"),gpe=Yb("session"),Kb=Yb("user"),D1=Yb("cloud"),eM=Yb("internal"),eA=function(t){jc(e,t);function e(){return t.call(this)||this}return e}(Rue({applicationVersion:Z3("ver"),applicationBuild:Z3("build"),applicationTypeId:Z3("typeId"),applicationId:Z3("applicationId"),applicationLayer:Z3("layer"),deviceId:os("id"),deviceIp:os("ip"),deviceLanguage:os("language"),deviceLocale:os("locale"),deviceModel:os("model"),deviceFriendlyName:os("friendlyName"),deviceNetwork:os("network"),deviceNetworkName:os("networkName"),deviceOEMName:os("oemName"),deviceOS:os("os"),deviceOSVersion:os("osVersion"),deviceRoleInstance:os("roleInstance"),deviceRoleName:os("roleName"),deviceScreenResolution:os("screenResolution"),deviceType:os("type"),deviceMachineName:os("machineName"),deviceVMName:os("vmName"),deviceBrowser:os("browser"),deviceBrowserVersion:os("browserVersion"),locationIp:$z("ip"),locationCountry:$z("country"),locationProvince:$z("province"),locationCity:$z("city"),operationId:ZP("id"),operationName:ZP("name"),operationParentId:ZP("parentId"),operationRootId:ZP("rootId"),operationSyntheticSource:ZP("syntheticSource"),operationCorrelationVector:ZP("correlationVector"),sessionId:gpe("id"),sessionIsFirst:gpe("isFirst"),sessionIsNew:gpe("isNew"),userAccountAcquisitionDate:Kb("accountAcquisitionDate"),userAccountId:Kb("accountId"),userAgent:Kb("userAgent"),userId:Kb("id"),userStoreRegion:Kb("storeRegion"),userAuthUserId:Kb("authUserId"),userAnonymousUserAcquisitionDate:Kb("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Kb("authUserAcquisitionDate"),cloudName:D1("name"),cloudRole:D1("role"),cloudRoleVer:D1("roleVer"),cloudRoleInstance:D1("roleInstance"),cloudEnvironment:D1("environment"),cloudLocation:D1("location"),cloudDeploymentUnit:D1("deploymentUnit"),internalNodeName:eM("nodeName"),internalSdkVersion:eM("sdkVersion"),internalAgentVersion:eM("agentVersion"),internalSnippet:eM("snippet"),internalSdkSrc:eM("sdkSrc")}))});function ype(t,e,r,n,o,s){var a;r=Cn(n,r)||ns,(Pe(t)||Pe(e)||Pe(r))&&Ai("Input doesn't contain all required fields");var c="";t[Iz]&&(c=t[Iz],delete t[Iz]);var l=(a={},a[No]=r,a.time=Al(new Date),a.iKey=c,a.ext=s||{},a.tags=[],a.data={},a.baseType=e,a.baseData=t,a);return Pe(o)||it(o,function(u,d){l.data[u]=d}),l}var $Be,WBe=D(()=>{ln();Ku();Qu();is();$Be=function(){function t(){}return t.create=ype,t}()});var KBe,Lo,YBe=D(()=>{vpe();KBe={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},Lo=new eA});function QBe(t){var e=null;if(wt(Event))e=new Event(t);else{var r=Di();r&&r.createEvent&&(e=r.createEvent("Event"),e.initEvent(t,!0,!0))}return e}var XBe=D(()=>{ln()});function JBe(t,e){Cg(t,null,null,e)}function Wz(t){var e=Di(),r=Ro(),n=!1,o=[],s=1;r&&!Pe(r.onLine)&&!r.onLine&&(s=2);var a=0,c=f(),l=Nl(Js("OfflineListener"),t);try{if(d(Ni())&&(n=!0),e){var u=e.body||e;u.ononline&&d(u)&&(n=!0)}}catch{n=!1}function d(x){var S=!1;return x&&(S=cm(x,"online",g,l),S&&cm(x,"offline",v,l)),S}function p(){return c}function f(){return!(a===2||s===2)}function m(){var x=f();c!==x&&(c=x,Ce(o,function(S){var I={isOnline:c,rState:s,uState:a};try{S(I)}catch{}}))}function h(x){a=x,m()}function g(){s=1,m()}function v(){s=2,m()}function b(){var x=Ni();if(x&&n){if(JBe(x,l),e){var S=e.body||e;Vt(S.ononline)||JBe(S,l)}n=!1}}function _(x){return o[Rg](x),{rm:function(){var S=o.indexOf(x);if(S>-1)return o.splice(S,1)}}}return{isOnline:p,isListening:function(){return n},unload:b,addListener:_,setOnlineState:h}}var ZBe=D(()=>{ln();is()});var eqe={};Pn(eqe,{AnalyticsPluginIdentifier:()=>Qwt,BreezeChannelIdentifier:()=>bpe,ConfigurationManager:()=>GBe,ConnectionStringParser:()=>xBe,ContextTagKeys:()=>eA,CtxTagKeys:()=>Lo,DEFAULT_BREEZE_ENDPOINT:()=>Mb,DEFAULT_BREEZE_PATH:()=>gm,Data:()=>xm,DisabledPropertyName:()=>XUe,DistributedTracingModes:()=>dBe,Envelope:()=>Vz,Event:()=>bm,EventPersistence:()=>pBe,Exception:()=>Hb,Extensions:()=>KBe,HttpMethod:()=>z3,Metric:()=>_m,PageView:()=>Gb,PageViewPerformance:()=>Wb,ProcessLegacy:()=>zP,PropertiesPluginIdentifier:()=>Ywt,RemoteDependencyData:()=>zb,RequestHeaders:()=>x1,SampleRate:()=>GP,SeverityLevel:()=>zz,TelemetryItemCreator:()=>$Be,ThrottleMgr:()=>bBe,Trace:()=>$b,correlationIdCanIncludeCorrelationHeader:()=>oBe,correlationIdGetCorrelationContext:()=>sBe,correlationIdGetCorrelationContextValue:()=>ope,correlationIdGetPrefix:()=>iBe,correlationIdSetPrefix:()=>nBe,createDistributedTraceContextFromTrace:()=>uBe,createDomEvent:()=>QBe,createOfflineListener:()=>Wz,createTelemetryItem:()=>ype,createTraceParent:()=>x3,dataSanitizeException:()=>Nz,dataSanitizeId:()=>Lz,dataSanitizeInput:()=>Oz,dataSanitizeKey:()=>epe,dataSanitizeKeyAndAddUniqueness:()=>Dz,dataSanitizeMeasurements:()=>Ta,dataSanitizeMessage:()=>KP,dataSanitizeProperties:()=>Ca,dataSanitizeString:()=>Cn,dataSanitizeUrl:()=>qb,dateTimeUtilsDuration:()=>lBe,dateTimeUtilsNow:()=>cBe,dsPadNumber:()=>tpe,findW3cTraceParent:()=>C3,formatTraceParent:()=>I3,getExtensionByName:()=>MBe,isBeaconApiSupported:()=>Yc,isCrossOriginError:()=>FBe,isInternalApplicationInsightsEndpoint:()=>Q3,isSampledFlag:()=>S3,isValidSpanId:()=>sm,isValidTraceId:()=>om,isValidTraceParent:()=>wP,msToTimeSpan:()=>JP,parseConnectionString:()=>X3,parseTraceParent:()=>a1,strNotSpecified:()=>ns,stringToBoolOrDefault:()=>OBe,urlGetAbsoluteUrl:()=>eBe,urlGetCompleteUrl:()=>rBe,urlGetPathName:()=>tBe,urlParseFullHost:()=>Y3,urlParseHost:()=>rpe,urlParseUrl:()=>R1,utlCanUseLocalStorage:()=>QP,utlCanUseSessionStorage:()=>P1,utlDisableStorage:()=>mBe,utlEnableStorage:()=>hBe,utlGetLocalStorage:()=>Uz,utlGetSessionStorage:()=>qz,utlGetSessionStorageKeys:()=>vBe,utlRemoveSessionStorage:()=>yBe,utlRemoveStorage:()=>gBe,utlSetLocalStorage:()=>Bz,utlSetSessionStorage:()=>jz,utlSetStoragePrefix:()=>Fz});var Ywt,bpe,Qwt,Pg=D(()=>{spe();_Be();SBe();Yde();Ku();IBe();CBe();ABe();LBe();UBe();BBe();qBe();jBe();VBe();HBe();zBe();vpe();Qu();WBe();YBe();ape();Gz();ln();XBe();upe();npe();ZBe();Ywt="AppInsightsPropertiesPlugin",bpe="AppInsightsChannelPlugin",Qwt="ApplicationInsightsAnalytics"});var Qb,tqe=D(()=>{Qb="duration"});var Oo,Kz,ea,Sm,N1,or,Xb,Jb,Xu,Zb,Ag,tA,Dg,Ng,Yz,Lg,tM,e_,rM,rA,L1,nM,Qz,Og,nA,iA,ta,Xz,oA,Jz,_pe,Zz,e$,xpe,t$,Spe,Mg,Ipe,Cpe,Tpe,Epe,iM,wpe,kpe,Rpe,sA,t_,r$,oM,n$,rqe,i$,o$,aA,Ppe,s$,nqe,r_=D(()=>{Oo="tags",Kz="deviceType",ea="data",Sm="name",N1="traceID",or="length",Xb="stringify",Jb="measurements",Xu="dataType",Zb="envelopeType",Ag="toString",tA="_get",Dg="enqueue",Ng="count",Yz="eventsLimitInMem",Lg="push",tM="emitLineDelimitedJson",e_="clear",rM="createNew",rA="markAsSent",L1="clearSent",nM="bufferOverride",Qz="BUFFER_KEY",Og="SENT_BUFFER_KEY",nA="MAX_BUFFER_SIZE",iA="triggerSend",ta="diagLog",Xz="initialize",oA="_sender",Jz="customHeaders",_pe="maxBatchSizeInBytes",Zz="onunloadDisableBeacon",e$="isBeaconApiDisabled",xpe="alwaysUseXhrOverride",t$="disableXhr",Spe="enableSessionStorageBuffer",Mg="_buffer",Ipe="onunloadDisableFetch",Cpe="disableSendBeaconSplit",Tpe="instrumentationKey",Epe="enableSendPromise",iM="getSenderInst",wpe="unloadTransports",kpe="convertUndefined",Rpe="maxBatchInterval",sA="serialize",t_="_onError",r$="_onPartialSuccess",oM="_onSuccess",n$="itemsAccepted",rqe="itemsReceived",i$="oriPayload",o$="baseType",aA="sampleRate",Ppe="eventsSendRequest",s$="getSamplingScore",nqe="getHashCodeScore"});function Mo(t,e,r){return Gu(t,e,r,Mu)}function Xwt(t,e,r){var n=r[Oo]=r[Oo]||{},o=e.ext=e.ext||{},s=e[Oo]=e[Oo]||[],a=o.user;a&&(Mo(n,Lo.userAuthUserId,a.authId),Mo(n,Lo.userId,a.id||a.localId));var c=o.app;c&&Mo(n,Lo.sessionId,c.sesId);var l=o.device;l&&(Mo(n,Lo.deviceId,l.id||l.localId),Mo(n,Lo[Kz],l.deviceClass),Mo(n,Lo.deviceIp,l.ip),Mo(n,Lo.deviceModel,l.model),Mo(n,Lo[Kz],l[Kz]));var u=e.ext.web;if(u){Mo(n,Lo.deviceLanguage,u.browserLang),Mo(n,Lo.deviceBrowserVersion,u.browserVer),Mo(n,Lo.deviceBrowser,u.browser);var d=r[ea]=r[ea]||{},p=d[vi]=d[vi]||{},f=p[As]=p[As]||{};Mo(f,"domain",u.domain),Mo(f,"isManual",u.isManual?iqe:null),Mo(f,"screenRes",u.screenRes),Mo(f,"userConsent",u.userConsent?iqe:null)}var m=o.os;m&&Mo(n,Lo.deviceOS,m[Sm]);var h=o.trace;h&&(Mo(n,Lo.operationParentId,h.parentID),Mo(n,Lo.operationName,Cn(t,h[Sm])),Mo(n,Lo.operationId,h[N1]));for(var g={},v=s[or]-1;v>=0;v--){var b=s[v];it(b,function(x,S){g[x]=S}),s.splice(v,1)}it(s,function(x,S){g[x]=S});var _=ju(ju({},n),g);_[Lo.internalSdkVersion]||(_[Lo.internalSdkVersion]=Cn(t,"javascript:".concat(Jwt.Version),64)),r[Oo]=zu(_)}function n_(t,e,r){Pe(t)||it(t,function(n,o){ya(o)?r[n]=o:$t(o)?e[n]=o:em()&&(e[n]=Xs()[Xb](o))})}function O1(t,e){Pe(t)||it(t,function(r,n){t[r]=n||e})}function M1(t,e,r,n){var o=new Vz(t,n,e);Mo(o,"sampleRate",r[GP]),(r[vi]||{}).startTime&&(o.time=Al(r[vi].startTime)),o.iKey=r.iKey;var s=r.iKey.replace(/-/g,"");return o[Sm]=o[Sm].replace("{0}",s),Xwt(t,r,o),r[Oo]=r[Oo]||[],zu(o)}function F1(t,e){Pe(e[vi])&&ze(t,1,46,"telemetryItem.baseData cannot be null.")}function oqe(t,e,r){F1(t,e);var n=e[vi][Jb]||{},o=e[vi][As]||{};n_(e[ea],o,n),Pe(r)||O1(o,r);var s=e[vi];if(Pe(s))return ec(t,"Invalid input for dependency data"),null;var a=s[As]&&s[As][z3]?s[As][z3]:"GET",c=new zb(t,s.id,s.target,s[Sm],s[Qb],s.success,s.responseCode,a,s.type,s.correlationContext,o,n),l=new xm(zb[Xu],c);return M1(t,zb[Zb],e,l)}function Dpe(t,e,r){F1(t,e);var n={},o={};e[Ape]!==bm[Xu]&&(n.baseTypeSource=e[Ape]),e[Ape]===bm[Xu]?(n=e[vi][As]||{},o=e[vi][Jb]||{}):e[vi]&&n_(e[vi],n,o),n_(e[ea],n,o),Pe(r)||O1(n,r);var s=e[vi][Sm],a=new bm(t,s,n,o),c=new xm(bm[Xu],a);return M1(t,bm[Zb],e,c)}function sqe(t,e,r){F1(t,e);var n=e[vi][Jb]||{},o=e[vi][As]||{};n_(e[ea],o,n),Pe(r)||O1(o,r);var s=e[vi],a=Hb.CreateFromInterface(t,s,o,n),c=new xm(Hb[Xu],a);return M1(t,Hb[Zb],e,c)}function aqe(t,e,r){F1(t,e);var n=e[vi],o=n[As]||{},s=n[Jb]||{};n_(e[ea],o,s),Pe(r)||O1(o,r);var a=new _m(t,n[Sm],n.average,n.sampleCount,n.min,n.max,n.stdDev,o,s),c=new xm(_m[Xu],a);return M1(t,_m[Zb],e,c)}function cqe(t,e,r){F1(t,e);var n,o=e[vi];!Pe(o)&&!Pe(o[As])&&!Pe(o[As][Qb])?(n=o[As][Qb],delete o[As][Qb]):!Pe(e[ea])&&!Pe(e[ea][Qb])&&(n=e[ea][Qb],delete e[ea][Qb]);var s=e[vi],a;((e.ext||{}).trace||{})[N1]&&(a=e.ext.trace[N1]);var c=s.id||a,l=s[Sm],u=s.uri,d=s[As]||{},p=s[Jb]||{};if(Pe(s.refUri)||(d.refUri=s.refUri),Pe(s.pageType)||(d.pageType=s.pageType),Pe(s.isLoggedIn)||(d.isLoggedIn=s.isLoggedIn[Ag]()),!Pe(s[As])){var f=s[As];it(f,function(g,v){d[g]=v})}n_(e[ea],d,p),Pe(r)||O1(d,r);var m=new Gb(t,l,u,n,d,p,c),h=new xm(Gb[Xu],m);return M1(t,Gb[Zb],e,h)}function lqe(t,e,r){F1(t,e);var n=e[vi],o=n[Sm],s=n.uri||n.url,a=n[As]||{},c=n[Jb]||{};n_(e[ea],a,c),Pe(r)||O1(a,r);var l=new Wb(t,o,s,void 0,a,c,n),u=new xm(Wb[Xu],l);return M1(t,Wb[Zb],e,u)}function uqe(t,e,r){F1(t,e);var n=e[vi].message,o=e[vi].severityLevel,s=e[vi][As]||{},a=e[vi][Jb]||{};n_(e[ea],s,a),Pe(r)||O1(s,r);var c=new $b(t,n,o,s,a),l=new xm($b[Xu],c);return M1(t,$b[Zb],e,l)}var Ape,vi,As,iqe,Jwt,dqe=D(()=>{Vc();Pg();ln();tqe();r_();Ape="baseType",vi="baseData",As="properties",iqe="true";Jwt={Version:"3.1.1"}});var pqe,a$,Npe,fqe=D(()=>{Vc();ks();Pg();ln();r_();pqe=function(){function t(e,r){var n=[],o=!1;this[tA]=function(){return n},this._set=function(s){return n=s,n},vr(t,this,function(s){s[Dg]=function(a){if(s[Ng]()>=r[Yz]){o||(ze(e,2,105,"Maximum in-memory buffer size reached: "+s[Ng](),!0),o=!0);return}n[Lg](a)},s[Ng]=function(){return n[or]},s.size=function(){for(var a=n[or],c=0;c<n[or];c++)a+=n[c][or];return r[tM]||(a+=2),a},s[e_]=function(){n=[],o=!1},s.getItems=function(){return n.slice(0)},s.batchPayloads=function(a){if(a&&a[or]>0){var c=r[tM]?a.join(`
`):"["+a.join(",")+"]";return c}return null},s[rM]=function(a,c,l){var u=n.slice(0);a=a||e,c=c||{};var d=l?new Npe(a,c):new a$(a,c);return Ce(u,function(p){d[Dg](p)}),d}})}return t.__ieDyn=1,t}(),a$=function(t){jc(e,t);function e(r,n){var o=t.call(this,r,n)||this;return vr(e,o,function(s,a){s[rA]=function(c){a[e_]()},s[L1]=function(c){}}),o}return e.__ieDyn=1,e}(pqe),Npe=function(t){jc(e,t);function e(r,n){var o=t.call(this,r,n)||this,s=!1,a=n?.namePrefix,c=n[nM]||{getItem:qz,setItem:jz},l=c.getItem,u=c.setItem;return vr(e,o,function(d,p){var f=v(e[Qz]),m=v(e[Og]),h=d._set(f.concat(m));h[or]>e[nA]&&(h[or]=e[nA]),b(e[Og],[]),b(e[Qz],h),d[Dg]=function(_){if(d[Ng]()>=e[nA]){s||(ze(r,2,67,"Maximum buffer size reached: "+d[Ng](),!0),s=!0);return}p[Dg](_),b(e.BUFFER_KEY,d[tA]())},d[e_]=function(){p[e_](),b(e.BUFFER_KEY,d[tA]()),b(e[Og],[]),s=!1},d[rA]=function(_){b(e[Qz],d._set(g(_,d[tA]())));var x=v(e[Og]);x instanceof Array&&_ instanceof Array&&(x=x.concat(_),x[or]>e[nA]&&(ze(r,1,67,"Sent buffer reached its maximum size: "+x[or],!0),x[or]=e[nA]),b(e[Og],x))},d[L1]=function(_){var x=v(e[Og]);x=g(_,x),b(e[Og],x)},d[rM]=function(_,x,S){S=!!S;var I=d[tA]().slice(0),w=v(e[Og]).slice(0);_=_||r,x=x||{},d[e_]();var k=S?new e(_,x):new a$(_,x);return Ce(I,function(M){k[Dg](M)}),S&&k[rA](w),k};function g(_,x){var S=[];return Ce(x,function(I){!wt(I)&&$r(_,I)===-1&&S[Lg](I)}),S}function v(_){var x=_;try{x=a?a+"_"+x:x;var S=l(r,x);if(S){var I=Xs().parse(S);if($t(I)&&(I=Xs().parse(I)),I&&mt(I))return I}}catch(w){ze(r,1,42," storage key: "+x+", "+Yn(w),{exception:et(w)})}return[]}function b(_,x){var S=_;try{S=a?a+"_"+S:S;var I=JSON[Xb](x);u(r,S,I)}catch(w){u(r,S,JSON[Xb]([])),ze(r,2,41," storage key: "+S+", "+Yn(w)+". Buffer cleared",{exception:et(w)})}}}),o}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(pqe)});var mqe,hqe=D(()=>{ks();ln();r_();mqe=function(){function t(e){vr(t,this,function(r){r[sA]=function(a){var c=n(a,"root");try{return Xs()[Xb](c)}catch(l){ze(e,1,48,l&&wt(l[Ag])?l[Ag]():"Error serializing object",null,!0)}};function n(a,c){var l="__aiCircularRefCheck",u={};if(!a)return ze(e,1,48,"cannot serialize object because it is null or undefined",{name:c},!0),u;if(a[l])return ze(e,2,50,"Circular reference detected while serializing object",{name:c},!0),u;if(!a.aiDataContract){if(c==="measurements")u=s(a,"number",c);else if(c==="properties")u=s(a,"string",c);else if(c==="tags")u=s(a,"string",c);else if(mt(a))u=o(a,c);else{ze(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:c},!0);try{Xs()[Xb](a),u=a}catch(d){ze(e,1,48,d&&wt(d[Ag])?d[Ag]():"Error serializing object",null,!0)}}return u}return a[l]=!0,it(a.aiDataContract,function(d,p){var f=wt(p)?p()&1:p&1,m=wt(p)?p()&4:p&4,h=p&2,g=a[d]!==void 0,v=Kn(a[d])&&a[d]!==null;if(f&&!g&&!h)ze(e,1,24,"Missing required field specification. The field is required but not present on source",{field:d,name:c});else if(!m){var b=void 0;v?h?b=o(a[d],d):b=n(a[d],d):b=a[d],b!==void 0&&(u[d]=b)}}),delete a[l],u}function o(a,c){var l;if(a)if(!mt(a))ze(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:c},!0);else{l=[];for(var u=0;u<a[or];u++){var d=a[u],p=n(d,c+"["+u+"]");l[Lg](p)}}return l}function s(a,c,l){var u;return a&&(u={},it(a,function(d,p){if(c==="string")p===void 0?u[d]="undefined":p===null?u[d]="null":p[Ag]?u[d]=p[Ag]():u[d]="invalid field: toString() is not defined.";else if(c==="number")if(p===void 0)u[d]="undefined";else if(p===null)u[d]="null";else{var f=parseFloat(p);u[d]=f}else u[d]="invalid field: "+l+" is of unknown type.",ze(e,1,u[d],null,!0)})),u}})}return t.__ieDyn=1,t}()});var Zwt,gqe,vqe=D(()=>{r_();Zwt=8,gqe=function(){function t(){}return t.prototype.getHashCodeScore=function(e){var r=this.getHashCode(e)/t.INT_MAX_VALUE;return r*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[or]<Zwt;)e=e.concat(e);for(var r=5381,n=0;n<e[or];++n)r=(r<<5)+r+e.charCodeAt(n),r=r&r;return Math.abs(r)},t.INT_MAX_VALUE=2147483647,t}()});var yqe,bqe=D(()=>{Pg();r_();vqe();yqe=function(){function t(){var e=this,r=new gqe,n=new eA;e[s$]=function(o){var s=0;return o[Oo]&&o[Oo][n.userId]?s=r.getHashCodeScore(o[Oo][n.userId]):o.ext&&o.ext.user&&o.ext.user.id?s=r[nqe](o.ext.user.id):o[Oo]&&o[Oo][n.operationId]?s=r.getHashCodeScore(o[Oo][n.operationId]):o.ext&&o.ext.telemetryTrace&&o.ext.telemetryTrace[N1]?s=r.getHashCodeScore(o.ext.telemetryTrace[N1]):s=Math.random()*100,s}}return t}()});var _qe,xqe=D(()=>{Pg();ln();r_();bqe();_qe=function(){function t(e,r){this.INT_MAX_VALUE=2147483647;var n=r||np(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[aA]=e,this.samplingScoreGenerator=new yqe}return t.prototype.isSampledIn=function(e){var r=this[aA],n=!1;return r==null||r>=100||e.baseType===_m[Xu]?!0:(n=this.samplingScoreGenerator[s$](e)<r,n)},t}()});function Iqe(t){try{return t.responseText}catch{}return null}function tkt(t){return t&&t.sendPOST}function rkt(t){return!isNaN(t)&&t>0&&t<=100}var yi,Fg,Im,Sqe,ekt,Cqe,nkt,sM,Tqe=D(()=>{Vc();ks();Pg();ln();Dt();dqe();fqe();hqe();xqe();r_();Im=void 0,Sqe="",ekt=65e3;Cqe=Xa((yi={endpointUrl:CP(Mu,Mb+gm)},yi[tM]=$u(),yi[Rpe]=15e3,yi[_pe]=102400,yi.disableTelemetry=$u(),yi[Spe]=$u(!0),yi.isRetryDisabled=$u(),yi[e$]=$u(!0),yi[Cpe]=$u(!0),yi[t$]=$u(),yi[Ipe]=$u(),yi[Zz]=$u(),yi[Tpe]=Im,yi.namePrefix=Im,yi.samplingPercentage=CP(rkt,100),yi[Jz]=Im,yi[kpe]=Im,yi[Yz]=1e4,yi[nM]=!1,yi.httpXHROverride={isVal:tkt,v:Im},yi[xpe]=$u(),yi.transports=Im,yi.retryCodes=Im,yi));nkt=(Fg={},Fg[bm.dataType]=Dpe,Fg[$b.dataType]=uqe,Fg[Gb.dataType]=cqe,Fg[Wb.dataType]=lqe,Fg[Hb.dataType]=sqe,Fg[_m.dataType]=aqe,Fg[zb.dataType]=oqe,Fg),sM=function(t){jc(e,t);function e(){var r=t.call(this)||this;r.priority=1001,r.identifier=bpe;var n,o,s,a,c,l,u,d,p=0,f,m,h,g,v,b,_,x,S,I,w,k,M,H,F,ue,Z,V,A,P,B,U,$,ce,W,Y,Se;return vr(e,r,function(ee,Ie){xt(),ee.pause=function(){Ea(),a=!0},ee.resume=function(){a&&(a=!1,o=null,bi(),Ju())},ee.flush=function(Q,de,be){if(Q===void 0&&(Q=!0),!a){Ea();try{return ee[iA](Q,null,be||1)}catch(Re){ze(ee[ta](),1,22,"flush failed, telemetry will not be collected: "+Yn(Re),{exception:et(Re)})}}},ee.onunloadFlush=function(){if(!a)if(_||P)try{return ee[iA](!0,s_,2)}catch(Q){ze(ee[ta](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Yn(Q),{exception:et(Q)})}else ee.flush(!1)},ee.addHeader=function(Q,de){d[Q]=de},ee[Xz]=function(Q,de,be,Re){ee.isInitialized()&&ze(ee[ta](),1,28,"Sender is already initialized"),Ie[Xz](Q,de,be,Re);var K=ee.identifier;l=new mqe(de.logger),n=0,o=null,s=0,ee[oA]=null,u=0;var re=ee[ta]();h=Nl(Js("Sender"),de.evtNamespace&&de.evtNamespace()),m=Wz(h),ee._addHook(Do(Q,function(fe){var Ae=fe.cfg;Ae.storagePrefix&&Fz(Ae.storagePrefix);var at=tc(null,Ae,de),Ve=at.getExtCfg(K,Cqe);nn(ee,"_senderConfig",{g:function(){return Ve}}),v!==Ve.endpointUrl&&(g=v=Ve.endpointUrl),I&&I!==Ve[Jz]&&Ce(I,function(Ds){delete d[Ds.header]}),b=Ve[_pe],_=(Ve[Zz]===!1||Ve[e$]===!1)&&Yc(),x=Ve[Zz]===!1&&Yc(),S=Ve[e$]===!1&&Yc(),P=Ve[xpe],B=!!Ve[t$],Se=Ve.retryCodes;var Ar=Ve[nM],Hr=!!Ve[Spe]&&(!!Ar||P1()),po=Ve.namePrefix,Zc=Hr!==ue||Hr&&V!==po||Hr&&Z!==Ar;if(ee[Mg]){if(Zc)try{ee._buffer=ee._buffer[rM](re,Ve,Hr)}catch(Ds){ze(ee[ta](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+Yn(Ds),{exception:et(Ds)})}bi()}else ee[Mg]=Hr?new Npe(re,Ve):new a$(re,Ve);V=po,ue=Hr,Z=Ar,U=!Ve[Ipe]&&pg(!0),W=!!Ve[Cpe],ee._sample=new _qe(Ve.samplingPercentage,re),k=Ve[Tpe],Ke(k,Ae)||ze(re,1,100,"Invalid Instrumentation key "+k),I=Ve[Jz],!Q3(g)&&I&&I[or]>0?Ce(I,function(Ds){r.addHeader(Ds.header,Ds.value)}):I=null,A=Ve[Epe];var qg=Ot();Y?Y.SetConfig(qg):(Y=new l1,Y[Xz](qg,re));var wa=Ve.httpXHROverride,jg=null,c_=null,rje=hg([3,1,2],Ve.transports);jg=Y&&Y[iM](rje,!1);var I$=Y&&Y.getFallbackInst();$=function(Ds,l_){return Nt(I$,Ds,l_)},ce=function(Ds,l_){return Nt(I$,Ds,l_,!1)},jg=P?wa:jg||wa||I$,ee[oA]=function(Ds,l_){return Nt(jg,Ds,l_)},U&&(f=a_);var C$=hg([3,1],Ve[wpe]);U||(C$=C$.filter(function(Ds){return Ds!==2})),c_=Y&&Y[iM](C$,!0),c_=P?wa:c_||wa,(P||Ve[wpe]||!f)&&c_&&(f=function(Ds,l_){return Nt(c_,Ds,l_)}),f||(f=$),w=Ve.disableTelemetry,M=Ve[kpe]||Im,H=Ve.isRetryDisabled,F=Ve[Rpe]}))},ee.processTelemetry=function(Q,de){de=ee._getTelCtx(de);var be=de[ta]();try{var Re=ut(Q,be);if(!Re)return;var K=G(Q,be);if(!K)return;var re=l[sA](K),fe=ee[Mg];bi(re),fe[Dg](re),Ju()}catch(Ae){ze(be,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Yn(Ae),{exception:et(Ae)})}ee.processNext(Q,de)},ee.isCompletelyIdle=function(){return!a&&p===0&&ee._buffer[Ng]()===0},ee._xhrReadyStateChange=function(Q,de,be){return Tr(Q,de,be)},ee[iA]=function(Q,de,be){Q===void 0&&(Q=!0);var Re;if(!a)try{var K=ee[Mg];if(w)K[e_]();else{if(K[Ng]()>0){var re=K.getItems();oe(be||0,Q),de?Re=de.call(ee,re,Q):Re=ee[oA](re,Q)}s=+new Date}Ea()}catch(Ae){var fe=n3();(!fe||fe>9)&&ze(ee[ta](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+Yn(Ae),{exception:et(Ae)})}return Re},ee.getOfflineSupport=function(){var Q;return Q={getUrl:function(){return g},createPayload:De},Q[sA]=pe,Q.batch=me,Q.shouldProcess=function(de){return!!ut(de)},Q},ee._doTeardown=function(Q,de){ee.onunloadFlush(),yg(m,!1),xt()},ee[t_]=function(Q,de,be){ze(ee[ta](),2,26,"Failed to send telemetry.",{message:de}),ee._buffer&&ee._buffer[L1](Q)},ee[r$]=function(Q,de){for(var be=[],Re=[],K=de.errors.reverse(),re=0,fe=K;re<fe.length;re++){var Ae=fe[re],at=Q.splice(Ae.index,1)[0];Rm(Ae.statusCode)?Re[Lg](at):be[Lg](at)}Q[or]>0&&ee[oM](Q,de[n$]),be[or]>0&&ee[t_](be,mg(null,["partial success",de[n$],"of",de.itemsReceived].join(" "))),Re[or]>0&&(up(Re),ze(ee[ta](),2,40,"Partial success. Delivered: "+Q[or]+", Failed: "+be[or]+". Will retry to send "+Re[or]+" our of "+de[rqe]+" items"))},ee[oM]=function(Q,de){ee._buffer&&ee._buffer[L1](Q)},ee._xdrOnLoad=function(Q,de){return Xe(Q,de)};function Xe(Q,de){var be=Iqe(Q);if(Q&&(be+""=="200"||be===""))n=0,ee[oM](de,0);else{var Re=n1(be);Re&&Re.itemsReceived&&Re.itemsReceived>Re[n$]&&!H?ee[r$](de,Re):ee[t_](de,r1(Q))}}function Ot(){var Q;try{var de={xdrOnComplete:function(Re,K,re){var fe=_e(re);if(fe)return Xe(Re,fe)},fetchOnComplete:function(Re,K,re,fe){var Ae=_e(fe);if(Ae)return na(Re.status,Ae,Re.url,Ae[or],Re.statusText,re||"")},xhrOnComplete:function(Re,K,re){var fe=_e(re);if(fe)return Tr(Re,fe,fe[or])},beaconOnRetry:function(Re,K,re){return Bg(Re,K,re)}},be=(Q={},Q[Epe]=A,Q.isOneDs=!1,Q.disableCredentials=!1,Q[t$]=B,Q.disableBeacon=!S,Q.disableBeaconSync=!x,Q.senderOnCompleteCallBack=de,Q);return be}catch{}return null}function Tr(Q,de,be){Q.readyState===4&&na(Q.status,de,Q.responseURL,be,mg(Q),Iqe(Q)||Q.response)}function _e(Q){try{if(Q){var de=Q,be=de[i$];return be&&be[or]?be:null}}catch{}return null}function ut(Q,de){if(w)return!1;if(!Q)return de&&ze(de,1,7,"Cannot send empty telemetry"),!1;if(Q.baseData&&!Q[o$])return de&&ze(de,1,70,"Cannot send telemetry without baseData and baseType"),!1;if(Q[o$]||(Q[o$]="EventData"),!ee[oA])return de&&ze(de,1,28,"Sender was not initialized"),!1;if(Ee(Q))Q[GP]=ee._sample[aA];else return de&&ze(de,2,33,"Telemetry item was sampled out and not sent",{SampleRate:ee._sample[aA]}),!1;return!0}function G(Q,de){var be=Q.iKey||k,Re=e.constructEnvelope(Q,be,de,M);if(!Re){ze(de,1,47,"Unable to create an AppInsights envelope");return}var K=!1;if(Q[Oo]&&Q[Oo][zP]&&(Ce(Q[Oo][zP],function(re){try{re&&re(Re)===!1&&(K=!0,ec(de,"Telemetry processor check returns false"))}catch(fe){ze(de,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Yn(fe),{exception:et(fe)},!0)}}),delete Q[Oo][zP]),!K)return Re}function pe(Q){var de=Sqe,be=ee[ta]();try{var Re=ut(Q,be),K=null;Re&&(K=G(Q,be)),K&&(de=l[sA](K))}catch{}return de}function me(Q){var de=Sqe;return Q&&Q[or]&&(de="["+Q.join(",")+"]"),de}function De(Q){var de,be=Bn();return de={urlString:g},de[ea]=Q,de.headers=be,de}function Ee(Q){return ee._sample.isSampledIn(Q)}function vt(Q,de,be,Re){de===200&&Q?ee._onSuccess(Q,Q[or]):Re&&ee[t_](Q,Re)}function Nt(Q,de,be,Re){Re===void 0&&(Re=!0);var K=function(Ae,at,Ve){return vt(de,Ae,at,Ve)},re=un(de),fe=Q&&Q.sendPOST;return fe&&re?(Re&&ee._buffer[rA](de),fe(re,K,!be)):null}function un(Q){var de;if(mt(Q)&&Q[or]>0){var be=ee[Mg].batchPayloads(Q),Re=Bn(),K=(de={},de[ea]=be,de.urlString=g,de.headers=Re,de.disableXhrSync=B,de.disableFetchKeepAlive=!U,de[i$]=Q,de);return K}return null}function Bn(){try{var Q=d||{};return Q3(g)&&(Q[x1[6]]=x1[7]),Q}catch{}return null}function bi(Q){var de=Q?Q[or]:0;return ee[Mg].size()+de>b?((!m||m.isOnline())&&ee[iA](!0,null,10),!0):!1}function na(Q,de,be,Re,K,re){var fe=null;if(ee._appId||(fe=n1(re),fe&&fe.appId&&(ee._appId=fe.appId)),(Q<200||Q>=300)&&Q!==0){if((Q===301||Q===307||Q===308)&&!lp(be)){ee[t_](de,K);return}!H&&Rm(Q)?(up(de),ze(ee[ta](),2,40,". Response code "+Q+". Will retry to send "+de[or]+" items.")):ee[t_](de,K)}else if(m&&!m.isOnline()){if(!H){var Ae=10;up(de,Ae),ze(ee[ta](),2,40,". Offline - Response Code: ".concat(Q,". Offline status: ").concat(!m.isOnline(),". Will retry to send ").concat(de.length," items."))}}else lp(be),Q===206?(fe||(fe=n1(re)),fe&&!H?ee[r$](de,fe):ee[t_](de,K)):(n=0,ee[oM](de,Re))}function lp(Q){return u>=10?!1:!Pe(Q)&&Q!==""&&Q!==g?(g=Q,++u,!0):!1}function s_(Q,de){if(f)f(Q,!1);else{var be=Y&&Y[iM]([3],!0);return Nt(be,Q,de)}}function Bg(Q,de,be){var Re=Q,K=Re&&Re[i$];if(W)ce&&ce(K,!0),ze(ee[ta](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var re=[],fe=0;fe<K[or];fe++){var Ae=K[fe],at=[Ae],Ve=un(at);be(Ve,de)?ee._onSuccess(at,at[or]):re[Lg](Ae)}re[or]>0&&(ce&&ce(re,!0),ze(ee[ta](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function a_(Q,de){var be=null;if(mt(Q)){for(var Re=Q[or],K=0;K<Q[or];K++)Re+=Q[K][or];var re=Y.getSyncFetchPayload();re+Re<=ekt?be=2:Yc()?be=3:(be=1,ze(ee[ta](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."));var fe=Y&&Y[iM]([be],!0);return Nt(fe,Q,de)}return null}function up(Q,de){if(de===void 0&&(de=1),!(!Q||Q[or]===0)){var be=ee[Mg];be[L1](Q),n++;for(var Re=0,K=Q;Re<K.length;Re++){var re=K[Re];be[Dg](re)}U1(de),Ju()}}function U1(Q){var de=10,be;if(n<=1)be=de;else{var Re=(Math.pow(2,n)-1)/2,K=Math.floor(Math.random()*Re*de)+1;K=Q*K,be=Math.max(Math.min(K,3600),de)}var re=Li()+be*1e3;o=re}function Ju(){if(!c&&!a){var Q=o?Math.max(0,o-Li()):0,de=Math.max(F,Q);c=qc(function(){c=null,ee[iA](!0,null,1)},de)}}function Ea(){c&&c.cancel(),c=null,o=null}function Rm(Q){return Pe(Se)?Q===401||Q===408||Q===429||Q===500||Q===502||Q===503||Q===504:Se[or]&&Se.indexOf(Q)>-1}function te(){var Q="getNotifyMgr";return ee.core[Q]?ee.core[Q]():ee.core._notificationManager}function oe(Q,de){var be=te();if(be&&be[Ppe])try{be[Ppe](Q,de)}catch(Re){ze(ee[ta](),1,74,"send request notification failed: "+Yn(Re),{exception:et(Re)})}}function Ke(Q,de){var be=de.disableInstrumentationKeyValidation,Re=Pe(be)?!1:be;if(Re)return!0;var K="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",re=new RegExp(K);return re.test(Q)}function xt(){ee[oA]=null,ee[Mg]=null,ee._appId=null,ee._sample=null,d={},m=null,n=0,o=null,s=null,a=!1,c=null,l=null,u=0,p=0,f=null,h=null,g=null,v=null,b=0,_=!1,I=null,w=!1,k=null,M=Im,H=!1,ue=null,V=Im,B=!1,U=!1,W=!1,$=null,ce=null,Y=null,nn(ee,"_senderConfig",{g:function(){return aG({},Cqe)}})}}),r}return e.constructEnvelope=function(r,n,o,s){var a;n!==r.iKey&&!Pe(n)?a=ju(ju({},r),{iKey:n}):a=r;var c=nkt[a.baseType]||Dpe;return c(o,a,s)},e}(Sg)});var Lpe=D(()=>{Tqe()});var c$,l$,u$,aM,Eqe=D(()=>{c$="instrumentationKey",l$="connectionString",u$="endpointUrl",aM="userOverrideEndpointUrl"});var wqe={};Pn(wqe,{AppInsightsCore:()=>Ig,ApplicationInsights:()=>skt,Sender:()=>sM,SeverityLevel:()=>zz,arrForEach:()=>Ce,isNullOrUndefined:()=>Pe,proxyFunctions:()=>Dl,throwError:()=>Ai});function okt(t){return t&&t>0}var ikt,skt,kqe=D(()=>{ks();Lpe();Pg();ln();Dt();Eqe();ln();Pg();Lpe();ikt={diagnosticLogInterval:CP(okt,1e4)};skt=function(){function t(e){var r=new Ig,n;(Pe(e)||Pe(e[c$])&&Pe(e[l$]))&&Ai("Invalid input configuration"),vr(t,this,function(s){nn(s,"config",{g:function(){return n}}),a(),s.initialize=a,s.track=o,Dl(s,r,["flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb","onCfgChange"]);function a(){var c=hi(e||{},ikt);n=c.cfg,r.addUnloadHook(Do(c,function(){if(n[l$]){var l=X3(n[l$]),u=l.ingestionendpoint;n[u$]=n[aM]?n[aM]:u+gm,n[c$]=l.instrumentationkey||n[c$]}n[u$]=n[aM]?n[aM]:n[u$]})),r.initialize(n,[new sM])}});function o(s){s&&(s.baseData=s.baseData||{},s.baseType=s.baseType||"EventData"),r.track(s)}}return t.__ieDyn=1,t}()});var Rqe=R(Cm=>{"use strict";var akt=Cm&&Cm.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ckt=Cm&&Cm.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),lkt=Cm&&Cm.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&akt(e,t,r);return ckt(e,t),e};Object.defineProperty(Cm,"__esModule",{value:!0});Cm.appInsightsClientFactory=void 0;var ukt=(Pg(),fo(eqe)),dkt=$ce(),pkt=async(t,e,r)=>{let n;try{let s=await Promise.resolve().then(()=>lkt((kqe(),fo(wqe)))),a={};if(e){let c={alwaysUseXhrOverride:!0,httpXHROverride:e};a[ukt.BreezeChannelIdentifier]=c}n=new s.ApplicationInsights({instrumentationKey:t,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0,extensionConfig:a})}catch(s){return Promise.reject(s)}return{logEvent:(s,a)=>{let c={...a?.properties,...a?.measurements};r?.length&&dkt.TelemetryUtil.applyReplacements(c,r),n?.track({name:s,data:c,baseType:"EventData",baseData:{name:s,properties:a?.properties,measurements:a?.measurements}})},flush:async()=>{n?.flush(!1)},dispose:async()=>new Promise(a=>{n?.unload(!0,()=>{a(),n=void 0},1e3)})}};Cm.appInsightsClientFactory=pkt});var Nqe=R(Ug=>{"use strict";var fkt=Ug&&Ug.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mkt=Ug&&Ug.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Fpe=Ug&&Ug.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fkt(e,t,r);return mkt(e,t),e};Object.defineProperty(Ug,"__esModule",{value:!0});var Ope=Fpe(require("os")),Pqe=Fpe(require("vscode")),hkt=Fpe(require("https")),gkt=K6e(),vkt=Y6e(),Aqe=$ce(),ykt=QUe(),bkt=Rqe();function Dqe(){return{sendPOST:(e,r)=>{let n={method:"POST",headers:{...e.headers,"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)}};try{let o=hkt.request(e.urlString,n,s=>{s.on("data",function(a){r(s.statusCode??200,s.headers,a.toString())}),s.on("error",function(){r(0,{})})});o.write(e.data,s=>{s&&r(0,{})}),o.end()}catch{r(0,{})}}}}var Mpe=class extends gkt.BaseTelemetryReporter{constructor(e,r){let n=a=>(0,bkt.appInsightsClientFactory)(a,Dqe(),r);Aqe.TelemetryUtil.shouldUseOneDataSystemSDK(e)&&(n=a=>(0,ykt.oneDataSystemClientFactory)(a,Pqe,Dqe()));let o={release:Ope.release(),platform:Ope.platform(),architecture:Ope.arch()},s=new vkt.BaseTelemetrySender(e,n);if(e&&e.indexOf("AIF-")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(s,Pqe,{additionalCommonProperties:Aqe.TelemetryUtil.getAdditionalCommonProperties(o)})}};Ug.default=Mpe});var Ukt={};Pn(Ukt,{activate:()=>Mkt,createExtensionContext:()=>tje});module.exports=fo(Ukt);var Zqe=q(Ct()),eje=q(require("path")),kA=require("vscode");var Zu;(o=>{o.serviceIds=new Map,o.DI_TARGET="$di$target",o.DI_DEPENDENCIES="$di$dependencies";function n(s){return s[o.DI_DEPENDENCIES]||[]}o.getServiceDependencies=n})(Zu||={});var j=ne("instantiationService");function bje(t,e,r){e[Zu.DI_TARGET]===e?e[Zu.DI_DEPENDENCIES].push({id:t,index:r}):(e[Zu.DI_DEPENDENCIES]=[{id:t,index:r}],e[Zu.DI_TARGET]=e)}function ne(t){if(Zu.serviceIds.has(t))return Zu.serviceIds.get(t);let e=function(r,n,o){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");bje(e,r,o)};return e.toString=()=>t,Zu.serviceIds.set(t,e),e}var E$=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?mM.isErrorNoTelemetry(e)?new mM(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(r=>{r(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},xje=new E$;function Vg(t){ed(t)||xje.onUnexpectedError(t)}var w$="Canceled";function ed(t){return t instanceof dn?!0:t instanceof Error&&t.name===w$&&t.message===w$}var dn=class extends Error{constructor(){super(w$),this.name=this.message}};function pn(t){return t?new Error(`Illegal argument: ${t}`):new Error("Illegal argument")}function efe(t){return t?new Error(`Illegal state: ${t}`):new Error("Illegal state")}function hM(t){return t?t.message?t.message:t.stack?t.stack.split(`
`)[0]:String(t):"Error"}var mM=class t extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof t)return e;let r=new t;return r.message=e.message,r.stack=e.stack,r}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},yr=class t extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,t.prototype)}};function k$(t,e){let r=this,n=!1,o;return function(){if(n)return o;if(n=!0,e)try{o=t.apply(r,arguments)}finally{e()}else o=t.apply(r,arguments);return o}}function gM(t,e){let r=R$(t,e);if(r!==-1)return t[r]}function R$(t,e,r=t.length-1){for(let n=r;n>=0;n--){let o=t[n];if(e(o))return n}return-1}function P$(t,e){let r=td(t,e);return r===-1?void 0:t[r]}function td(t,e,r=0,n=t.length){let o=r,s=n;for(;o<s;){let a=Math.floor((o+s)/2);e(t[a])?o=a+1:s=a}return o-1}function B1(t,e,r=0,n=t.length){let o=r,s=n;for(;o<s;){let a=Math.floor((o+s)/2);e(t[a])?s=a:o=a+1}return o}var tfe=class t{constructor(e){this._array=e;this._findLastMonotonousLastIdx=0}static{this.assertInvariants=!1}findLastMonotonous(e){if(t.assertInvariants){if(this._prevFindLastPredicate){for(let n of this._array)if(this._prevFindLastPredicate(n)&&!e(n))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let r=td(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=r+1,r===-1?void 0:this._array[r]}};function Pm(t,e){for(let r of t){let n=e(r);if(n!==void 0)return n}}function Am(t,e,r=(n,o)=>n===o){if(t===e)return!0;if(!t||!e||t.length!==e.length)return!1;for(let n=0,o=t.length;n<o;n++)if(!r(t[n],e[n]))return!1;return!0}function nfe(t,e){let r=0,n=t-1;for(;r<=n;){let o=(r+n)/2|0,s=e(o);if(s<0)r=o+1;else if(s>0)n=o-1;else return o}return-(r+1)}function*ife(t,e){let r,n;for(let o of t)n!==void 0&&e(n,o)?r.push(o):(r&&(yield r),r=[o]),n=o;r&&(yield r)}function Dr(t){return t.filter(e=>!!e)}function vM(t,e=r=>r){let r=new Set;return t.filter(n=>{let o=e(n);return r.has(o)?!1:(r.add(o),!0)})}function ofe(t){let e=new Set;return r=>{let n=t(r);return e.has(n)?!1:(e.add(n),!0)}}function sfe(t,e){let r=typeof e=="number"?t:0;typeof e=="number"?r=t:(r=0,e=t);let n=[];if(r<=e)for(let o=r;o<e;o++)n.push(o);else for(let o=r;o>e;o--)n.push(o);return n}function afe(t,e){let r;if(typeof e=="number"){let n=e;r=()=>{let o=Math.sin(n++)*179426549;return o-Math.floor(o)}}else r=Math.random;for(let n=t.length-1;n>0;n-=1){let o=Math.floor(r()*(n+1)),s=t[n];t[n]=t[o],t[o]=s}}var cfe;(c=>{function t(l){return l<0}c.isLessThan=t;function e(l){return l<=0}c.isLessThanOrEqual=e;function r(l){return l>0}c.isGreaterThan=r;function n(l){return l===0}c.isNeitherLessOrGreaterThan=n,c.greaterThan=1,c.lessThan=-1,c.neitherLessOrGreaterThan=0})(cfe||={});function q1(t,e){return(r,n)=>e(t(r),t(n))}var j1=(t,e)=>t-e;var rfe=class t{constructor(e){this.iterate=e}static{this.empty=new t(e=>{})}forEach(e){this.iterate(r=>(e(r),!0))}toArray(){let e=[];return this.iterate(r=>(e.push(r),!0)),e}filter(e){return new t(r=>this.iterate(n=>e(n)?r(n):!0))}map(e){return new t(r=>this.iterate(n=>r(e(n))))}some(e){let r=!1;return this.iterate(n=>(r=e(n),!r)),r}findFirst(e){let r;return this.iterate(n=>e(n)?(r=n,!1):!0),r}findLast(e){let r;return this.iterate(n=>(e(n)&&(r=n),!0)),r}findLastMaxBy(e){let r,n=!0;return this.iterate(o=>((n||cfe.isGreaterThan(e(o,r)))&&(n=!1,r=o),!0)),r}};function ufe(t,e){let r=Object.create(null);for(let n of t){let o=e(n),s=r[o];s||(s=r[o]=[]),s.push(n)}return r}var Ije,lfe=class{constructor(e,r){this.toKey=r;this._map=new Map;this[Ije]="SetWithKey";for(let n of e)this.add(n)}static{Ije=Symbol.toStringTag}get size(){return this._map.size}add(e){let r=this.toKey(e);return this._map.set(r,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(let e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(let e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,r){this._map.forEach(n=>e.call(r,n,n,this))}[Symbol.iterator](){return this.values()}};var D$=class{constructor(e,r){this.uri=e;this.value=r}};function Cje(t){return Array.isArray(t)}var Tje,Nr=class t{constructor(e,r){this[Tje]="ResourceMap";if(e instanceof t)this.map=new Map(e.map),this.toKey=r??t.defaultToKey;else if(Cje(e)){this.map=new Map,this.toKey=r??t.defaultToKey;for(let[n,o]of e)this.set(n,o)}else this.map=new Map,this.toKey=e??t.defaultToKey}static{this.defaultToKey=e=>e.toString()}set(e,r){return this.map.set(this.toKey(e),new D$(e,r)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,r){typeof r<"u"&&(e=e.bind(r));for(let[n,o]of this.map)e(o.value,o.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(Tje=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}},Eje,yM=class{constructor(e,r){this[Eje]="ResourceSet";!e||typeof e=="function"?this._map=new Nr(e):(this._map=new Nr(r),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,r){this._map.forEach((n,o)=>e.call(r,o,o,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(Eje=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var wje,N$=class{constructor(){this[wje]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,r=0){let n=this._map.get(e);if(n)return r!==0&&this.touch(n,r),n.value}set(e,r,n=0){let o=this._map.get(e);if(o)o.value=r,n!==0&&this.touch(o,n);else{switch(o={key:e,value:r,next:void 0,previous:void 0},n){case 0:this.addItemLast(o);break;case 1:this.addItemFirst(o);break;case 2:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let r=this._map.get(e);if(r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){let n=this._state,o=this._head;for(;o;){if(r?e.bind(r)(o.value,o.key,this):e(o.value,o.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.key,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}values(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.value,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}entries(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:[n.key,n.value],done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}[(wje=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._tail,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.previous,n--;this._tail=r,this._size=n,r&&(r.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==1&&r!==2)){if(r===1){if(e===this._head)return;let n=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(n.previous=o,o.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===2){if(e===this._tail)return;let n=e.next,o=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=o,o.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(let[r,n]of e)this.set(r,n)}},L$=class extends N${constructor(e,r=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=2){return super.get(e,r)}peek(e){return super.get(e,0)}set(e,r){return super.set(e,r,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},Hg=class extends L${constructor(e,r=1){super(e,r)}trim(e){this.trimOld(e)}set(e,r){return super.set(e,r),this.checkTrim(),this}};var bM=class{constructor(){this.map=new Map}add(e,r){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(r)}delete(e,r){let n=this.map.get(e);n&&(n.delete(r),n.size===0&&this.map.delete(e))}forEach(e,r){let n=this.map.get(e);n&&n.forEach(r)}get(e){let r=this.map.get(e);return r||new Set}};var _i;(x=>{function t(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}x.is=t;let e=Object.freeze([]);function r(){return e}x.empty=r;function*n(S){yield S}x.single=n;function o(S){return t(S)?S:n(S)}x.wrap=o;function s(S){return S||e}x.from=s;function*a(S){for(let I=S.length-1;I>=0;I--)yield S[I]}x.reverse=a;function c(S){return!S||S[Symbol.iterator]().next().done===!0}x.isEmpty=c;function l(S){return S[Symbol.iterator]().next().value}x.first=l;function u(S,I){let w=0;for(let k of S)if(I(k,w++))return!0;return!1}x.some=u;function d(S,I){for(let w of S)if(I(w))return w}x.find=d;function*p(S,I){for(let w of S)I(w)&&(yield w)}x.filter=p;function*f(S,I){let w=0;for(let k of S)yield I(k,w++)}x.map=f;function*m(S,I){let w=0;for(let k of S)yield*I(k,w++)}x.flatMap=m;function*h(...S){for(let I of S)yield*I}x.concat=h;function g(S,I,w){let k=w;for(let M of S)k=I(k,M);return k}x.reduce=g;function*v(S,I,w=S.length){for(I<0&&(I+=S.length),w<0?w+=S.length:w>S.length&&(w=S.length);I<w;I++)yield S[I]}x.slice=v;function b(S,I=Number.POSITIVE_INFINITY){let w=[];if(I===0)return[w,S];let k=S[Symbol.iterator]();for(let M=0;M<I;M++){let H=k.next();if(H.done)return[w,x.empty()];w.push(H.value)}return[w,{[Symbol.iterator](){return k}}]}x.consume=b;async function _(S){let I=[];for await(let w of S)I.push(w);return Promise.resolve(I)}x.asyncToArray=_})(_i||={});var kje=!1,V1=null,dfe=class t{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(e){let r=this.livingDisposables.get(e);return r||(r={parent:null,source:null,isSingleton:!1,value:e,idx:t.idx++},this.livingDisposables.set(e,r)),r}trackDisposable(e){let r=this.getDisposableData(e);r.source||(r.source=new Error().stack)}setParent(e,r){let n=this.getDisposableData(e);n.parent=r}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,r){let n=r.get(e);if(n)return n;let o=e.parent?this.getRootParent(this.getDisposableData(e.parent),r):e;return r.set(e,o),o}getTrackedDisposables(){let e=new Map;return[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n)}computeLeakingDisposables(e=10,r){let n;if(r)n=r;else{let l=new Map,u=[...this.livingDisposables.values()].filter(p=>p.source!==null&&!this.getRootParent(p,l).isSingleton);if(u.length===0)return;let d=new Set(u.map(p=>p.value));if(n=u.filter(p=>!(p.parent&&d.has(p.parent))),n.length===0)throw new Error("There are cyclic diposable chains!")}if(!n)return;function o(l){function u(p,f){for(;p.length>0&&f.some(m=>typeof m=="string"?m===p[0]:p[0].match(m));)p.shift()}let d=l.source.split(`
`).map(p=>p.trim().replace("at ","")).filter(p=>p!=="");return u(d,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),d.reverse()}let s=new bM;for(let l of n){let u=o(l);for(let d=0;d<=u.length;d++)s.add(u.slice(0,d).join(`
`),l)}n.sort(q1(l=>l.idx,j1));let a="",c=0;for(let l of n.slice(0,e)){c++;let u=o(l),d=[];for(let p=0;p<u.length;p++){let f=u[p];f=`(shared with ${s.get(u.slice(0,p+1).join(`
`)).size}/${n.length} leaks) at ${f}`;let h=s.get(u.slice(0,p).join(`
`)),g=ufe([...h].map(v=>o(v)[p]),v=>v);delete g[u[p]];for(let[v,b]of Object.entries(g))d.unshift(`    - stacktraces of ${b.length} other leaks continue with ${v}`);d.unshift(f)}a+=`


==================== Leaking disposable ${c}/${n.length}: ${l.value.constructor.name} ====================
${d.join(`
`)}
============================================================

`}return n.length>e&&(a+=`


... and ${n.length-e} more leaking disposables

`),{leaks:n,details:a}}};function Rje(t){V1=t}if(kje){let t="__is_disposable_tracked__";Rje(new class{trackDisposable(e){let r=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[t]||console.log(r)},3e3)}setParent(e,r){if(e&&e!==Oe.None)try{e[t]=!0}catch{}}markAsDisposed(e){if(e&&e!==Oe.None)try{e[t]=!0}catch{}}markAsSingleton(e){}})}function u_(t){return V1?.trackDisposable(t),t}function d_(t){V1?.markAsDisposed(t)}function AA(t,e){V1?.setParent(t,e)}function Pje(t,e){if(V1)for(let r of t)V1.setParent(r,e)}function G1(t){return typeof t=="object"&&t!==null&&typeof t.dispose=="function"&&t.dispose.length===0}function zg(t){if(_i.is(t)){let e=[];for(let r of t)if(r)try{r.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}else if(t)return t.dispose(),t}function z1(...t){let e=Zi(()=>zg(t));return Pje(t,e),e}function Zi(t){let e=u_({dispose:k$(()=>{d_(e),t()})});return e}var ht=class t{constructor(){this._toDispose=new Set;this._isDisposed=!1;u_(this)}static{this.DISABLE_DISPOSED_WARNING=!1}dispose(){this._isDisposed||(d_(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{zg(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return AA(e,this),this._isDisposed?t.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),AA(e,null))}},Oe=class{constructor(){this._store=new ht;u_(this),AA(this._store,this)}static{this.None=Object.freeze({dispose(){}})}dispose(){d_(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Gg=class{constructor(){this._isDisposed=!1;u_(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&AA(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,d_(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&AA(e,null),e}};var H1=class{constructor(){this._store=new Map;this._isDisposed=!1;u_(this)}dispose(){d_(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{zg(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,r,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,r)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let r=this._store.get(e);return this._store.delete(e),r}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var Qn=class t{static{this.Undefined=new t(void 0)}constructor(e){this.element=e,this.next=t.Undefined,this.prev=t.Undefined}},DA=class{constructor(){this._first=Qn.Undefined;this._last=Qn.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===Qn.Undefined}clear(){let e=this._first;for(;e!==Qn.Undefined;){let r=e.next;e.prev=Qn.Undefined,e.next=Qn.Undefined,e=r}this._first=Qn.Undefined,this._last=Qn.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,r){let n=new Qn(e);if(this._first===Qn.Undefined)this._first=n,this._last=n;else if(r){let s=this._last;this._last=n,n.prev=s,s.next=n}else{let s=this._first;this._first=n,n.next=s,s.prev=n}this._size+=1;let o=!1;return()=>{o||(o=!0,this._remove(n))}}shift(){if(this._first!==Qn.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Qn.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Qn.Undefined&&e.next!==Qn.Undefined){let r=e.prev;r.next=e.next,e.next.prev=r}else e.prev===Qn.Undefined&&e.next===Qn.Undefined?(this._first=Qn.Undefined,this._last=Qn.Undefined):e.next===Qn.Undefined?(this._last=this._last.prev,this._last.next=Qn.Undefined):e.prev===Qn.Undefined&&(this._first=this._first.next,this._first.prev=Qn.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Qn.Undefined;)yield e.element,e=e.next}};var Aje=globalThis.performance&&typeof globalThis.performance.now=="function",Fo=class t{static create(e){return new t(e)}constructor(e){this._now=Aje&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var Dje=!1,pfe=!1,Nje=!1,Ol;(A=>{A.None=()=>Oe.None;function e(P){if(Nje){let{onDidAddListener:B}=P,U=NA.create(),$=0;P.onDidAddListener=()=>{++$===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),U.print()),B?.()}}}function r(P,B){return m(P,()=>{},0,void 0,!0,void 0,B)}A.defer=r;function n(P){return(B,U=null,$)=>{let ce=!1,W;return W=P(Y=>{if(!ce)return W?W.dispose():ce=!0,B.call(U,Y)},null,$),ce&&W.dispose(),W}}A.once=n;function o(P,B){return A.once(A.filter(P,B))}A.onceIf=o;function s(P,B,U){return p(($,ce=null,W)=>P(Y=>$.call(ce,B(Y)),null,W),U)}A.map=s;function a(P,B,U){return p(($,ce=null,W)=>P(Y=>{B(Y),$.call(ce,Y)},null,W),U)}A.forEach=a;function c(P,B,U){return p(($,ce=null,W)=>P(Y=>B(Y)&&$.call(ce,Y),null,W),U)}A.filter=c;function l(P){return P}A.signal=l;function u(...P){return(B,U=null,$)=>{let ce=z1(...P.map(W=>W(Y=>B.call(U,Y))));return f(ce,$)}}A.any=u;function d(P,B,U,$){let ce=U;return s(P,W=>(ce=B(ce,W),ce),$)}A.reduce=d;function p(P,B){let U,$={onWillAddFirstListener(){U=P(ce.fire,ce)},onDidRemoveLastListener(){U?.dispose()}};B||e($);let ce=new Yt($);return B?.add(ce),ce.event}function f(P,B){return B instanceof Array?B.push(P):B&&B.add(P),P}function m(P,B,U=100,$=!1,ce=!1,W,Y){let Se,ee,Ie,Xe=0,Ot,Tr={leakWarningThreshold:W,onWillAddFirstListener(){Se=P(ut=>{Xe++,ee=B(ee,ut),$&&!Ie&&(_e.fire(ee),ee=void 0),Ot=()=>{let G=ee;ee=void 0,Ie=void 0,(!$||Xe>1)&&_e.fire(G),Xe=0},typeof U=="number"?(clearTimeout(Ie),Ie=setTimeout(Ot,U)):Ie===void 0&&(Ie=0,queueMicrotask(Ot))})},onWillRemoveListener(){ce&&Xe>0&&Ot?.()},onDidRemoveLastListener(){Ot=void 0,Se.dispose()}};Y||e(Tr);let _e=new Yt(Tr);return Y?.add(_e),_e.event}A.debounce=m;function h(P,B=0,U){return A.debounce(P,($,ce)=>$?($.push(ce),$):[ce],B,void 0,!0,void 0,U)}A.accumulate=h;function g(P,B=($,ce)=>$===ce,U){let $=!0,ce;return c(P,W=>{let Y=$||!B(W,ce);return $=!1,ce=W,Y},U)}A.latch=g;function v(P,B,U){return[A.filter(P,B,U),A.filter(P,$=>!B($),U)]}A.split=v;function b(P,B=!1,U=[],$){let ce=U.slice(),W=P(ee=>{ce?ce.push(ee):Se.fire(ee)});$&&$.add(W);let Y=()=>{ce?.forEach(ee=>Se.fire(ee)),ce=null},Se=new Yt({onWillAddFirstListener(){W||(W=P(ee=>Se.fire(ee)),$&&$.add(W))},onDidAddFirstListener(){ce&&(B?setTimeout(Y):Y())},onDidRemoveLastListener(){W&&W.dispose(),W=null}});return $&&$.add(Se),Se.event}A.buffer=b;function _(P,B){return($,ce,W)=>{let Y=B(new S);return P(function(Se){let ee=Y.evaluate(Se);ee!==x&&$.call(ce,ee)},void 0,W)}}A.chain=_;let x=Symbol("HaltChainable");class S{constructor(){this.steps=[]}map(B){return this.steps.push(B),this}forEach(B){return this.steps.push(U=>(B(U),U)),this}filter(B){return this.steps.push(U=>B(U)?U:x),this}reduce(B,U){let $=U;return this.steps.push(ce=>($=B($,ce),$)),this}latch(B=(U,$)=>U===$){let U=!0,$;return this.steps.push(ce=>{let W=U||!B(ce,$);return U=!1,$=ce,W?ce:x}),this}evaluate(B){for(let U of this.steps)if(B=U(B),B===x)break;return B}}function I(P,B,U=$=>$){let $=(...Se)=>Y.fire(U(...Se)),ce=()=>P.on(B,$),W=()=>P.removeListener(B,$),Y=new Yt({onWillAddFirstListener:ce,onDidRemoveLastListener:W});return Y.event}A.fromNodeEventEmitter=I;function w(P,B,U=$=>$){let $=(...Se)=>Y.fire(U(...Se)),ce=()=>P.addEventListener(B,$),W=()=>P.removeEventListener(B,$),Y=new Yt({onWillAddFirstListener:ce,onDidRemoveLastListener:W});return Y.event}A.fromDOMEventEmitter=w;function k(P){return new Promise(B=>n(P)(B))}A.toPromise=k;function M(P){let B=new Yt;return P.then(U=>{B.fire(U)},()=>{B.fire(void 0)}).finally(()=>{B.dispose()}),B.event}A.fromPromise=M;function H(P,B){return P(U=>B.fire(U))}A.forward=H;function F(P,B,U){return B(U),P($=>B($))}A.runAndSubscribe=F;class ue{constructor(B,U){this._observable=B;this._counter=0;this._hasChanged=!1;let $={onWillAddFirstListener:()=>{B.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{B.removeObserver(this)}};U||e($),this.emitter=new Yt($),U&&U.add(this.emitter)}beginUpdate(B){this._counter++}handlePossibleChange(B){}handleChange(B,U){this._hasChanged=!0}endUpdate(B){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Z(P,B){return new ue(P,B).emitter.event}A.fromObservable=Z;function V(P){return(B,U,$)=>{let ce=0,W=!1,Y={beginUpdate(){ce++},endUpdate(){ce--,ce===0&&(P.reportChanges(),W&&(W=!1,B.call(U)))},handlePossibleChange(){},handleChange(){W=!0}};P.addObserver(Y),P.reportChanges();let Se={dispose(){P.removeObserver(Y)}};return $ instanceof ht?$.add(Se):Array.isArray($)&&$.push(Se),Se}}A.fromObservableLight=V})(Ol||={});var O$=class t{constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${t._idPool++}`,t.all.add(this)}static{this.all=new Set}static{this._idPool=0}start(e){this._stopWatch=new Fo,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},ffe=-1;var M$=class t{constructor(e,r,n=(t._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=r;this.name=n;this._warnCountdown=0}static{this._idPool=1}dispose(){this._stacks?.clear()}check(e,r){let n=this.threshold;if(n<=0||r<n)return;this._stacks||(this._stacks=new Map);let o=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,o+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[s,a]=this.getMostFrequentStack(),c=`[${this.name}] potential listener LEAK detected, having ${r} listeners already. MOST frequent listener (${a}):`;console.warn(c),console.warn(s);let l=new F$(c,s);this._errorHandler(l)}return()=>{let s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,r=0;for(let[n,o]of this._stacks)(!e||r<o)&&(e=[n,o],r=o);return e}},NA=class t{constructor(e){this.value=e}static create(){let e=new Error;return new t(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},F$=class extends Error{constructor(e,r){super(e),this.name="ListenerLeakError",this.stack=r}},U$=class extends Error{constructor(e,r){super(e),this.name="ListenerRefusalError",this.stack=r}},Lje=0,$1=class{constructor(e){this.value=e;this.id=Lje++}},Oje=2,Mje=(t,e)=>{if(t instanceof $1)e(t);else for(let r=0;r<t.length;r++){let n=t[r];n&&e(n)}},_M;if(Dje){let t=[];setInterval(()=>{t.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(t.join(`
`)),t.length=0)},3e3),_M=new FinalizationRegistry(e=>{typeof e=="string"&&t.push(e)})}var Yt=class{constructor(e){this._size=0;this._options=e,this._leakageMon=ffe>0||this._options?.leakWarningThreshold?new M$(e?.onListenerError??Vg,this._options?.leakWarningThreshold??ffe):void 0,this._perfMon=this._options?._profName?new O$(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(pfe){let e=this._listeners;queueMicrotask(()=>{Mje(e,r=>r.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,r,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let u=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],d=new U$(`${l}. HINT: Stack shows most frequent listener (${u[1]}-times)`,u[0]);return(this._options?.onListenerError||Vg)(d),Oe.None}if(this._disposed)return Oe.None;r&&(e=e.bind(r));let o=new $1(e),s,a;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(o.stack=NA.create(),s=this._leakageMon.check(o.stack,this._size+1)),pfe&&(o.stack=a??NA.create()),this._listeners?this._listeners instanceof $1?(this._deliveryQueue??=new B$,this._listeners=[this._listeners,o]):this._listeners.push(o):(this._options?.onWillAddFirstListener?.(this),this._listeners=o,this._options?.onDidAddFirstListener?.(this)),this._size++;let c=Zi(()=>{_M?.unregister(c),s?.(),this._removeListener(o)});if(n instanceof ht?n.add(c):Array.isArray(n)&&n.push(c),_M){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),u=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);_M.register(c,u?.[2]??l,c)}return c},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let r=this._listeners,n=r.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[n]=void 0;let o=this._deliveryQueue.current===this;if(this._size*Oje<=r.length){let s=0;for(let a=0;a<r.length;a++)r[a]?r[s++]=r[a]:o&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=s}}_deliver(e,r){if(!e)return;let n=this._options?.onListenerError||Vg;if(!n){e.value(r);return}try{e.value(r)}catch(o){n(o)}}_deliverQueue(e){let r=e.current._listeners;for(;e.i<e.end;)this._deliver(r[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof $1)this._deliver(this._listeners,e);else{let r=this._deliveryQueue;r.enqueue(this,e,this._listeners.length),this._deliverQueue(r)}this._perfMon?.stop()}hasListeners(){return this._size>0}};var B$=class{constructor(){this.i=-1;this.end=0}enqueue(e,r,n){this.i=0,this.end=n,this.current=e,this.value=r}reset(){this.i=this.end,this.current=void 0,this.value=void 0}};var mfe=Object.freeze(function(t,e){let r=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(r)}}}),Wt;(n=>{function t(o){return o===n.None||o===n.Cancelled||o instanceof W1?!0:!o||typeof o!="object"?!1:typeof o.isCancellationRequested=="boolean"&&typeof o.onCancellationRequested=="function"}n.isCancellationToken=t,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ol.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:mfe})})(Wt||={});var W1=class{constructor(){this._isCancelled=!1;this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?mfe:(this._emitter||(this._emitter=new Yt),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Uo=class{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new W1),this._token}cancel(){this._token?this._token instanceof W1&&this._token.cancel():this._token=Wt.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof W1&&this._token.dispose():this._token=Wt.None}};function hfe(t){let e=new Uo;return t.add({dispose(){e.cancel()}}),e.token}function q$(){return globalThis._VSCODE_NLS_MESSAGES}function LA(){return globalThis._VSCODE_NLS_LANGUAGE}var Fje=LA()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function gfe(t,e){let r;return e.length===0?r=t:r=t.replace(/\{(\d+)\}/g,(n,o)=>{let s=o[0],a=e[s],c=n;return typeof a=="string"?c=a:(typeof a=="number"||typeof a=="boolean"||a===void 0||a===null)&&(c=String(a)),c}),Fje&&(r="\uFF3B"+r.replace(/[aouei]/g,"$&$&")+"\uFF3D"),r}function OA(t,e,...r){return gfe(typeof t=="number"?Uje(t,e):e,r)}function Uje(t,e){let r=q$()?.[t];if(typeof r!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${t} !!!`)}return r}var K1="en",CM=!1,TM=!1,MA=!1,qje=!1,yfe=!1,j$=!1,jje=!1,Vje=!1,Hje=!1,Gje=!1,xM,SM=K1,vfe=K1,zje,Dm,Nm=globalThis,el;typeof Nm.vscode<"u"&&typeof Nm.vscode.process<"u"?el=Nm.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(el=process);var bfe=typeof el?.versions?.electron=="string",$je=bfe&&el?.type==="renderer";if(typeof el=="object"){CM=el.platform==="win32",TM=el.platform==="darwin",MA=el.platform==="linux",qje=MA&&!!el.env.SNAP&&!!el.env.SNAP_REVISION,jje=bfe,Hje=!!el.env.CI||!!el.env.BUILD_ARTIFACTSTAGINGDIRECTORY,xM=K1,SM=K1;let t=el.env.VSCODE_NLS_CONFIG;if(t)try{let e=JSON.parse(t);xM=e.userLocale,vfe=e.osLocale,SM=e.resolvedLanguage||K1,zje=e.languagePack?.translationsConfigFile}catch{}yfe=!0}else typeof navigator=="object"&&!$je?(Dm=navigator.userAgent,CM=Dm.indexOf("Windows")>=0,TM=Dm.indexOf("Macintosh")>=0,Vje=(Dm.indexOf("Macintosh")>=0||Dm.indexOf("iPad")>=0||Dm.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,MA=Dm.indexOf("Linux")>=0,Gje=Dm?.indexOf("Mobi")>=0,j$=!0,SM=LA()||K1,xM=navigator.language.toLowerCase(),vfe=xM):console.error("Unable to resolve platform.");var IM=0;TM?IM=1:CM?IM=3:MA&&(IM=2);var pp=CM,_fe=TM,xfe=MA;var Sfe=yfe;var Ife=j$,Wje=j$&&typeof Nm.importScripts=="function",Cfe=Wje?Nm.origin:void 0;var Tfe=IM,dp=Dm,$g=SM,Kje;(n=>{function t(){return $g}n.value=t;function e(){return $g.length===2?$g==="en":$g.length>=3?$g[0]==="e"&&$g[1]==="n"&&$g[2]==="-":!1}n.isDefaultVariant=e;function r(){return $g==="en"}n.isDefault=r})(Kje||={});var Yje=typeof Nm.postMessage=="function"&&!Nm.importScripts,Efe=(()=>{if(Yje){let t=[];Nm.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,o=t.length;n<o;n++){let s=t[n];if(s.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),s.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),Nm.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();var Qje=!!(dp&&dp.indexOf("Chrome")>=0),gRt=!!(dp&&dp.indexOf("Firefox")>=0),vRt=!!(!Qje&&dp&&dp.indexOf("Safari")>=0),yRt=!!(dp&&dp.indexOf("Edg/")>=0),bRt=!!(dp&&dp.indexOf("Android")>=0);var p_,V$=globalThis.vscode;if(typeof V$<"u"&&typeof V$.process<"u"){let t=V$.process;p_={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?p_={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:p_={get platform(){return pp?"win32":_fe?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var FA=p_.cwd,wfe=p_.env,kfe=p_.platform,SRt=p_.arch;var Zje=65,eVe=97,tVe=90,rVe=122,Yg=46,ss=47,ic=92,Wg=58,nVe=63,EM=class extends Error{constructor(e,r,n){let o;typeof r=="string"&&r.indexOf("not ")===0?(o="must not be",r=r.replace(/^not /,"")):o="must be";let s=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${s} ${o} of type ${r}`;a+=`. Received type ${typeof n}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function iVe(t,e){if(t===null||typeof t!="object")throw new EM(e,"Object",t)}function Fi(t,e){if(typeof t!="string")throw new EM(e,"string",t)}var oc=kfe==="win32";function sr(t){return t===ss||t===ic}function H$(t){return t===ss}function Kg(t){return t>=Zje&&t<=tVe||t>=eVe&&t<=rVe}function wM(t,e,r,n){let o="",s=0,a=-1,c=0,l=0;for(let u=0;u<=t.length;++u){if(u<t.length)l=t.charCodeAt(u);else{if(n(l))break;l=ss}if(n(l)){if(!(a===u-1||c===1))if(c===2){if(o.length<2||s!==2||o.charCodeAt(o.length-1)!==Yg||o.charCodeAt(o.length-2)!==Yg){if(o.length>2){let d=o.lastIndexOf(r);d===-1?(o="",s=0):(o=o.slice(0,d),s=o.length-1-o.lastIndexOf(r)),a=u,c=0;continue}else if(o.length!==0){o="",s=0,a=u,c=0;continue}}e&&(o+=o.length>0?`${r}..`:"..",s=2)}else o.length>0?o+=`${r}${t.slice(a+1,u)}`:o=t.slice(a+1,u),s=u-a-1;a=u,c=0}else l===Yg&&c!==-1?++c:c=-1}return o}function oVe(t){return t?`${t[0]==="."?"":"."}${t}`:""}function Rfe(t,e){iVe(e,"pathObject");let r=e.dir||e.root,n=e.base||`${e.name||""}${oVe(e.ext)}`;return r?r===e.root?`${r}${n}`:`${r}${t}${n}`:n}var Ui={resolve(...t){let e="",r="",n=!1;for(let o=t.length-1;o>=-1;o--){let s;if(o>=0){if(s=t[o],Fi(s,`paths[${o}]`),s.length===0)continue}else e.length===0?s=FA():(s=wfe[`=${e}`]||FA(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===ic)&&(s=`${e}\\`));let a=s.length,c=0,l="",u=!1,d=s.charCodeAt(0);if(a===1)sr(d)&&(c=1,u=!0);else if(sr(d))if(u=!0,sr(s.charCodeAt(1))){let p=2,f=p;for(;p<a&&!sr(s.charCodeAt(p));)p++;if(p<a&&p!==f){let m=s.slice(f,p);for(f=p;p<a&&sr(s.charCodeAt(p));)p++;if(p<a&&p!==f){for(f=p;p<a&&!sr(s.charCodeAt(p));)p++;(p===a||p!==f)&&(l=`\\\\${m}\\${s.slice(f,p)}`,c=p)}}}else c=1;else Kg(d)&&s.charCodeAt(1)===Wg&&(l=s.slice(0,2),c=2,a>2&&sr(s.charCodeAt(2))&&(u=!0,c=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(r=`${s.slice(c)}\\${r}`,n=u,u&&e.length>0)break}return r=wM(r,!n,"\\",sr),n?`${e}\\${r}`:`${e}${r}`||"."},normalize(t){Fi(t,"path");let e=t.length;if(e===0)return".";let r=0,n,o=!1,s=t.charCodeAt(0);if(e===1)return H$(s)?"\\":t;if(sr(s))if(o=!0,sr(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!sr(t.charCodeAt(c));)c++;if(c<e&&c!==l){let u=t.slice(l,c);for(l=c;c<e&&sr(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!sr(t.charCodeAt(c));)c++;if(c===e)return`\\\\${u}\\${t.slice(l)}\\`;c!==l&&(n=`\\\\${u}\\${t.slice(l,c)}`,r=c)}}}else r=1;else Kg(s)&&t.charCodeAt(1)===Wg&&(n=t.slice(0,2),r=2,e>2&&sr(t.charCodeAt(2))&&(o=!0,r=3));let a=r<e?wM(t.slice(r),!o,"\\",sr):"";return a.length===0&&!o&&(a="."),a.length>0&&sr(t.charCodeAt(e-1))&&(a+="\\"),n===void 0?o?`\\${a}`:a:o?`${n}\\${a}`:`${n}${a}`},isAbsolute(t){Fi(t,"path");let e=t.length;if(e===0)return!1;let r=t.charCodeAt(0);return sr(r)||e>2&&Kg(r)&&t.charCodeAt(1)===Wg&&sr(t.charCodeAt(2))},join(...t){if(t.length===0)return".";let e,r;for(let s=0;s<t.length;++s){let a=t[s];Fi(a,"path"),a.length>0&&(e===void 0?e=r=a:e+=`\\${a}`)}if(e===void 0)return".";let n=!0,o=0;if(typeof r=="string"&&sr(r.charCodeAt(0))){++o;let s=r.length;s>1&&sr(r.charCodeAt(1))&&(++o,s>2&&(sr(r.charCodeAt(2))?++o:n=!1))}if(n){for(;o<e.length&&sr(e.charCodeAt(o));)o++;o>=2&&(e=`\\${e.slice(o)}`)}return Ui.normalize(e)},relative(t,e){if(Fi(t,"from"),Fi(e,"to"),t===e)return"";let r=Ui.resolve(t),n=Ui.resolve(e);if(r===n||(t=r.toLowerCase(),e=n.toLowerCase(),t===e))return"";let o=0;for(;o<t.length&&t.charCodeAt(o)===ic;)o++;let s=t.length;for(;s-1>o&&t.charCodeAt(s-1)===ic;)s--;let a=s-o,c=0;for(;c<e.length&&e.charCodeAt(c)===ic;)c++;let l=e.length;for(;l-1>c&&e.charCodeAt(l-1)===ic;)l--;let u=l-c,d=a<u?a:u,p=-1,f=0;for(;f<d;f++){let h=t.charCodeAt(o+f);if(h!==e.charCodeAt(c+f))break;h===ic&&(p=f)}if(f!==d){if(p===-1)return n}else{if(u>d){if(e.charCodeAt(c+f)===ic)return n.slice(c+f+1);if(f===2)return n.slice(c+f)}a>d&&(t.charCodeAt(o+f)===ic?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=o+p+1;f<=s;++f)(f===s||t.charCodeAt(f)===ic)&&(m+=m.length===0?"..":"\\..");return c+=p,m.length>0?`${m}${n.slice(c,l)}`:(n.charCodeAt(c)===ic&&++c,n.slice(c,l))},toNamespacedPath(t){if(typeof t!="string"||t.length===0)return t;let e=Ui.resolve(t);if(e.length<=2)return t;if(e.charCodeAt(0)===ic){if(e.charCodeAt(1)===ic){let r=e.charCodeAt(2);if(r!==nVe&&r!==Yg)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Kg(e.charCodeAt(0))&&e.charCodeAt(1)===Wg&&e.charCodeAt(2)===ic)return`\\\\?\\${e}`;return t},dirname(t){Fi(t,"path");let e=t.length;if(e===0)return".";let r=-1,n=0,o=t.charCodeAt(0);if(e===1)return sr(o)?t:".";if(sr(o)){if(r=n=1,sr(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!sr(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&sr(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!sr(t.charCodeAt(c));)c++;if(c===e)return t;c!==l&&(r=n=c+1)}}}}else Kg(o)&&t.charCodeAt(1)===Wg&&(r=e>2&&sr(t.charCodeAt(2))?3:2,n=r);let s=-1,a=!0;for(let c=e-1;c>=n;--c)if(sr(t.charCodeAt(c))){if(!a){s=c;break}}else a=!1;if(s===-1){if(r===-1)return".";s=r}return t.slice(0,s)},basename(t,e){e!==void 0&&Fi(e,"suffix"),Fi(t,"path");let r=0,n=-1,o=!0,s;if(t.length>=2&&Kg(t.charCodeAt(0))&&t.charCodeAt(1)===Wg&&(r=2),e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=r;--s){let l=t.charCodeAt(s);if(sr(l)){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=r;--s)if(sr(t.charCodeAt(s))){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){Fi(t,"path");let e=0,r=-1,n=0,o=-1,s=!0,a=0;t.length>=2&&t.charCodeAt(1)===Wg&&Kg(t.charCodeAt(0))&&(e=n=2);for(let c=t.length-1;c>=e;--c){let l=t.charCodeAt(c);if(sr(l)){if(!s){n=c+1;break}continue}o===-1&&(s=!1,o=c+1),l===Yg?r===-1?r=c:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||o===-1||a===0||a===1&&r===o-1&&r===n+1?"":t.slice(r,o)},format:Rfe.bind(null,"\\"),parse(t){Fi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.length,n=0,o=t.charCodeAt(0);if(r===1)return sr(o)?(e.root=e.dir=t,e):(e.base=e.name=t,e);if(sr(o)){if(n=1,sr(t.charCodeAt(1))){let p=2,f=p;for(;p<r&&!sr(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&sr(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&!sr(t.charCodeAt(p));)p++;p===r?n=p:p!==f&&(n=p+1)}}}}else if(Kg(o)&&t.charCodeAt(1)===Wg){if(r<=2)return e.root=e.dir=t,e;if(n=2,sr(t.charCodeAt(2))){if(r===3)return e.root=e.dir=t,e;n=3}}n>0&&(e.root=t.slice(0,n));let s=-1,a=n,c=-1,l=!0,u=t.length-1,d=0;for(;u>=n;--u){if(o=t.charCodeAt(u),sr(o)){if(!l){a=u+1;break}continue}c===-1&&(l=!1,c=u+1),o===Yg?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return c!==-1&&(s===-1||d===0||d===1&&s===c-1&&s===a+1?e.base=e.name=t.slice(a,c):(e.name=t.slice(a,s),e.base=t.slice(a,c),e.ext=t.slice(s,c))),a>0&&a!==n?e.dir=t.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},sVe=(()=>{if(oc){let t=/\\/g;return()=>{let e=FA().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>FA()})(),Lr={resolve(...t){let e="",r=!1;for(let n=t.length-1;n>=-1&&!r;n--){let o=n>=0?t[n]:sVe();Fi(o,`paths[${n}]`),o.length!==0&&(e=`${o}/${e}`,r=o.charCodeAt(0)===ss)}return e=wM(e,!r,"/",H$),r?`/${e}`:e.length>0?e:"."},normalize(t){if(Fi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===ss,r=t.charCodeAt(t.length-1)===ss;return t=wM(t,!e,"/",H$),t.length===0?e?"/":r?"./":".":(r&&(t+="/"),e?`/${t}`:t)},isAbsolute(t){return Fi(t,"path"),t.length>0&&t.charCodeAt(0)===ss},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){let n=t[r];Fi(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":Lr.normalize(e)},relative(t,e){if(Fi(t,"from"),Fi(e,"to"),t===e||(t=Lr.resolve(t),e=Lr.resolve(e),t===e))return"";let r=1,n=t.length,o=n-r,s=1,a=e.length-s,c=o<a?o:a,l=-1,u=0;for(;u<c;u++){let p=t.charCodeAt(r+u);if(p!==e.charCodeAt(s+u))break;p===ss&&(l=u)}if(u===c)if(a>c){if(e.charCodeAt(s+u)===ss)return e.slice(s+u+1);if(u===0)return e.slice(s+u)}else o>c&&(t.charCodeAt(r+u)===ss?l=u:u===0&&(l=0));let d="";for(u=r+l+1;u<=n;++u)(u===n||t.charCodeAt(u)===ss)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+l)}`},toNamespacedPath(t){return t},dirname(t){if(Fi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===ss,r=-1,n=!0;for(let o=t.length-1;o>=1;--o)if(t.charCodeAt(o)===ss){if(!n){r=o;break}}else n=!1;return r===-1?e?"/":".":e&&r===1?"//":t.slice(0,r)},basename(t,e){e!==void 0&&Fi(e,"ext"),Fi(t,"path");let r=0,n=-1,o=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=0;--s){let l=t.charCodeAt(s);if(l===ss){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===ss){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){Fi(t,"path");let e=-1,r=0,n=-1,o=!0,s=0;for(let a=t.length-1;a>=0;--a){let c=t.charCodeAt(a);if(c===ss){if(!o){r=a+1;break}continue}n===-1&&(o=!1,n=a+1),c===Yg?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},format:Rfe.bind(null,"/"),parse(t){Fi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.charCodeAt(0)===ss,n;r?(e.root="/",n=1):n=0;let o=-1,s=0,a=-1,c=!0,l=t.length-1,u=0;for(;l>=n;--l){let d=t.charCodeAt(l);if(d===ss){if(!c){s=l+1;break}continue}a===-1&&(c=!1,a=l+1),d===Yg?o===-1?o=l:u!==1&&(u=1):o!==-1&&(u=-1)}if(a!==-1){let d=s===0&&r?1:s;o===-1||u===0||u===1&&o===a-1&&o===s+1?e.base=e.name=t.slice(d,a):(e.name=t.slice(d,o),e.base=t.slice(d,a),e.ext=t.slice(o,a))}return s>0?e.dir=t.slice(0,s-1):r&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Lr.win32=Ui.win32=Ui;Lr.posix=Ui.posix=Lr;var G$=oc?Ui.normalize:Lr.normalize,aVe=oc?Ui.isAbsolute:Lr.isAbsolute,z$=oc?Ui.join:Lr.join,Pfe=oc?Ui.resolve:Lr.resolve,Afe=oc?Ui.relative:Lr.relative,kM=oc?Ui.dirname:Lr.dirname,RM=oc?Ui.basename:Lr.basename,IRt=oc?Ui.extname:Lr.extname,CRt=oc?Ui.format:Lr.format,TRt=oc?Ui.parse:Lr.parse,ERt=oc?Ui.toNamespacedPath:Lr.toNamespacedPath,Y1=oc?Ui.sep:Lr.sep,wRt=oc?Ui.delimiter:Lr.delimiter;function Dfe(t){return t}var AM=class{constructor(e,r){this.lastCache=void 0;this.lastArgKey=void 0;typeof e=="function"?(this._fn=e,this._computeKey=Dfe):(this._fn=r,this._computeKey=e.getCacheKey)}get(e){let r=this._computeKey(e);return this.lastArgKey!==r&&(this.lastArgKey=r,this.lastCache=this._fn(e)),this.lastCache}},f_=class{constructor(e,r){this._map=new Map;this._map2=new Map;typeof e=="function"?(this._fn=e,this._computeKey=Dfe):(this._fn=r,this._computeKey=e.getCacheKey)}get cachedValues(){return this._map}get(e){let r=this._computeKey(e);if(this._map2.has(r))return this._map2.get(r);let n=this._fn(e);return this._map.set(e,n),this._map2.set(r,n),n}};var qn=class{constructor(e){this.executor=e;this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function m_(t){return t<0?0:t>4294967295?4294967295:t|0}function Q1(t){return!t||typeof t!="string"?!0:t.trim().length===0}function g_(t){return t.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function X1(t,e){let r=0,n=t.indexOf(e);for(;n!==-1;)r++,n=t.indexOf(e,n+e.length);return r}function rd(t){return t.split(/\r\n|\r|\n/)}function Ufe(t){for(let e=0,r=t.length;e<r;e++){let n=t.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function DM(t,e,r){let n=[],o=0;for(let s of t.matchAll(e)){if(n.push(t.slice(o,s.index)),s.index===void 0)throw new Error("match.index should be defined");o=s.index+s[0].length,n.push(r(s[0],...s.slice(1),s.index,t,s.groups))}return n.push(t.slice(o)),Promise.all(n).then(s=>s.join(""))}function Bfe(t,e){return t<e?-1:t>e?1:0}function cVe(t,e,r=0,n=t.length,o=0,s=e.length){for(;r<n&&o<s;r++,o++){let l=t.charCodeAt(r),u=e.charCodeAt(o);if(l<u)return-1;if(l>u)return 1}let a=n-r,c=s-o;return a<c?-1:a>c?1:0}function qfe(t,e,r=0,n=t.length,o=0,s=e.length){for(;r<n&&o<s;r++,o++){let l=t.charCodeAt(r),u=e.charCodeAt(o);if(l===u)continue;if(l>=128||u>=128)return cVe(t.toLowerCase(),e.toLowerCase(),r,n,o,s);Nfe(l)&&(l-=32),Nfe(u)&&(u-=32);let d=l-u;if(d!==0)return d}let a=n-r,c=s-o;return a<c?-1:a>c?1:0}function Nfe(t){return t>=97&&t<=122}function NM(t,e){return t.length===e.length&&qfe(t,e)===0}function $$(t,e){let r=e.length;return e.length>t.length?!1:qfe(t,e,0,r)===0}function LM(t,e){let r=Math.min(t.length,e.length),n;for(n=0;n<r;n++)if(t.charCodeAt(n)!==e.charCodeAt(n))return n;return r}function jfe(t,e){let r=Math.min(t.length,e.length),n,o=t.length-1,s=e.length-1;for(n=0;n<r;n++)if(t.charCodeAt(o-n)!==e.charCodeAt(s-n))return n;return r}var lVe=/^[\t\n\r\x20-\x7E]*$/;function W$(t){return lVe.test(t)}var FRt=String.fromCharCode(65279);var Lfe=class t{static{this._INSTANCE=null}static getInstance(){return t._INSTANCE||(t._INSTANCE=new t),t._INSTANCE}constructor(){this._data=uVe()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let r=this._data,n=r.length/3,o=1;for(;o<=n;)if(e<r[3*o])o=2*o;else if(e>r[3*o+1])o=2*o+1;else return r[3*o+2];return 0}};function uVe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var Ofe=class t{constructor(e){this.confusableDictionary=e}static{this.ambiguousCharacterData=new qn(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new AM({getCacheKey:JSON.stringify},e=>{function r(d){let p=new Map;for(let f=0;f<d.length;f+=2)p.set(d[f],d[f+1]);return p}function n(d,p){let f=new Map(d);for(let[m,h]of p)f.set(m,h);return f}function o(d,p){if(!d)return p;let f=new Map;for(let[m,h]of d)p.has(m)&&f.set(m,h);return f}let s=this.ambiguousCharacterData.value,a=e.filter(d=>!d.startsWith("_")&&d in s);a.length===0&&(a=["_default"]);let c;for(let d of a){let p=r(s[d]);c=o(c,p)}let l=r(s._common),u=n(l,c);return new t(u)})}static getInstance(e){return t.cache.get(Array.from(e))}static{this._locales=new qn(()=>Object.keys(t.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return t._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}},Mfe=class t{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){return this._data||(this._data=new Set(t.getRawData())),this._data}static isInvisibleCharacter(e){return t.getData().has(e)}static containsInvisibleCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&t.isInvisibleCharacter(n))return!0}return!1}static get codePoints(){return t.getData()}};function UA(t){return typeof t=="string"}function OM(t){return Array.isArray(t)&&t.every(e=>UA(e))}function BA(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function J1(t){return typeof t=="number"&&!isNaN(t)}function pVe(t){return typeof t>"u"}function Z1(t){return!K$(t)}function K$(t){return pVe(t)||t===null}function nd(t,e){if(!t)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Qg(t){return t===47||t===92}function eI(t){return t.replace(/[\\/]/g,Lr.sep)}function Vfe(t){return t.indexOf("/")===-1&&(t=eI(t)),/^[a-zA-Z]:(\/|$)/.test(t)&&(t="/"+t),t}function Y$(t,e=Lr.sep){if(!t)return"";let r=t.length,n=t.charCodeAt(0);if(Qg(n)){if(Qg(t.charCodeAt(1))&&!Qg(t.charCodeAt(2))){let s=3,a=s;for(;s<r&&!Qg(t.charCodeAt(s));s++);if(a!==s&&!Qg(t.charCodeAt(s+1))){for(s+=1;s<r;s++)if(Qg(t.charCodeAt(s)))return t.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(mVe(n)&&t.charCodeAt(1)===58)return Qg(t.charCodeAt(2))?t.slice(0,2)+e:t.slice(0,2);let o=t.indexOf("://");if(o!==-1){for(o+=3;o<r;o++)if(Qg(t.charCodeAt(o)))return t.slice(0,o+1)}return""}function Q$(t,e,r,n=Y1){if(t===e)return!0;if(!t||!e||e.length>t.length)return!1;if(r){if(!$$(t,e))return!1;if(e.length===t.length)return!0;let s=e.length;return e.charAt(e.length-1)===n&&s--,t.charAt(s)===n}return e.charAt(e.length-1)!==n&&(e+=n),t.indexOf(e)===0}function mVe(t){return t>=65&&t<=90||t>=97&&t<=122}var gVe=/^\w[\w\d+.-]*$/,vVe=/^\//,yVe=/^\/\//;function bVe(t,e){if(!t.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!gVe.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!vVe.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(yVe.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function _Ve(t,e){return!t&&!e?"file":t}function xVe(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==id&&(e=id+e):e=id;break}return e}var An="",id="/",SVe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,He=class t{static isUri(e){return e instanceof t?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,r,n,o,s,a=!1){typeof e=="object"?(this.scheme=e.scheme||An,this.authority=e.authority||An,this.path=e.path||An,this.query=e.query||An,this.fragment=e.fragment||An):(this.scheme=_Ve(e,a),this.authority=r||An,this.path=xVe(this.scheme,n||An),this.query=o||An,this.fragment=s||An,bVe(this,a))}get fsPath(){return qA(this,!1)}with(e){if(!e)return this;let{scheme:r,authority:n,path:o,query:s,fragment:a}=e;return r===void 0?r=this.scheme:r===null&&(r=An),n===void 0?n=this.authority:n===null&&(n=An),o===void 0?o=this.path:o===null&&(o=An),s===void 0?s=this.query:s===null&&(s=An),a===void 0?a=this.fragment:a===null&&(a=An),r===this.scheme&&n===this.authority&&o===this.path&&s===this.query&&a===this.fragment?this:new Xg(r,n,o,s,a)}static parse(e,r=!1){let n=SVe.exec(e);return n?new Xg(n[2]||An,MM(n[4]||An),MM(n[5]||An),MM(n[7]||An),MM(n[9]||An),r):new Xg(An,An,An,An,An)}static file(e){let r=An;if(pp&&(e=e.replace(/\\/g,id)),e[0]===id&&e[1]===id){let n=e.indexOf(id,2);n===-1?(r=e.substring(2),e=id):(r=e.substring(2,n),e=e.substring(n)||id)}return new Xg("file",r,e,An,An)}static from(e,r){return new Xg(e.scheme,e.authority,e.path,e.query,e.fragment,r)}static joinPath(e,...r){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return pp&&e.scheme==="file"?n=t.file(Ui.join(qA(e,!0),...r)).path:n=Lr.join(e.path,...r),e.with({path:n})}toString(e=!1){return X$(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof t)return e;{let r=new Xg(e);return r._formatted=e.external??null,r._fsPath=e._sep===zfe?e.fsPath??null:null,r}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};function jA(t){return!t||typeof t!="object"?!1:typeof t.scheme=="string"&&(typeof t.authority=="string"||typeof t.authority>"u")&&(typeof t.path=="string"||typeof t.path>"u")&&(typeof t.query=="string"||typeof t.query>"u")&&(typeof t.fragment=="string"||typeof t.fragment>"u")}var zfe=pp?1:void 0,Xg=class extends He{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=qA(this,!1)),this._fsPath}toString(r=!1){return r?X$(this,!0):(this._formatted||(this._formatted=X$(this,!1)),this._formatted)}toJSON(){let r={$mid:1};return this._fsPath&&(r.fsPath=this._fsPath,r._sep=zfe),this._formatted&&(r.external=this._formatted),this.path&&(r.path=this.path),this.scheme&&(r.scheme=this.scheme),this.authority&&(r.authority=this.authority),this.query&&(r.query=this.query),this.fragment&&(r.fragment=this.fragment),r}},$fe={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function Hfe(t,e,r){let n,o=-1;for(let s=0;s<t.length;s++){let a=t.charCodeAt(s);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||r&&a===91||r&&a===93||r&&a===58)o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n!==void 0&&(n+=t.charAt(s));else{n===void 0&&(n=t.substr(0,s));let c=$fe[a];c!==void 0?(o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n+=c):o===-1&&(o=s)}}return o!==-1&&(n+=encodeURIComponent(t.substring(o))),n!==void 0?n:t}function IVe(t){let e;for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n===35||n===63?(e===void 0&&(e=t.substr(0,r)),e+=$fe[n]):e!==void 0&&(e+=t[r])}return e!==void 0?e:t}function qA(t,e){let r;return t.authority&&t.path.length>1&&t.scheme==="file"?r=`//${t.authority}${t.path}`:t.path.charCodeAt(0)===47&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&t.path.charCodeAt(2)===58?e?r=t.path.substr(1):r=t.path[1].toLowerCase()+t.path.substr(2):r=t.path,pp&&(r=r.replace(/\//g,"\\")),r}function X$(t,e){let r=e?IVe:Hfe,n="",{scheme:o,authority:s,path:a,query:c,fragment:l}=t;if(o&&(n+=o,n+=":"),(s||o==="file")&&(n+=id,n+=id),s){let u=s.indexOf("@");if(u!==-1){let d=s.substr(0,u);s=s.substr(u+1),u=d.lastIndexOf(":"),u===-1?n+=r(d,!1,!1):(n+=r(d.substr(0,u),!1,!1),n+=":",n+=r(d.substr(u+1),!1,!0)),n+="@"}s=s.toLowerCase(),u=s.lastIndexOf(":"),u===-1?n+=r(s,!1,!0):(n+=r(s.substr(0,u),!1,!0),n+=s.substr(u))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let u=a.charCodeAt(1);u>=65&&u<=90&&(a=`/${String.fromCharCode(u+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let u=a.charCodeAt(0);u>=65&&u<=90&&(a=`${String.fromCharCode(u+32)}:${a.substr(2)}`)}n+=r(a,!0,!1)}return c&&(n+="?",n+=r(c,!1,!1)),l&&(n+="#",n+=e?l:Hfe(l,!1,!1)),n}function Wfe(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+Wfe(t.substr(3)):t}}var Gfe=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function MM(t){return t.match(Gfe)?t.replace(Gfe,e=>Wfe(e)):t}var Tn;(Ie=>(Ie.inMemory="inmemory",Ie.vscode="vscode",Ie.internal="private",Ie.walkThrough="walkThrough",Ie.walkThroughSnippet="walkThroughSnippet",Ie.http="http",Ie.https="https",Ie.file="file",Ie.mailto="mailto",Ie.untitled="untitled",Ie.data="data",Ie.command="command",Ie.vscodeRemote="vscode-remote",Ie.vscodeRemoteResource="vscode-remote-resource",Ie.vscodeManagedRemoteResource="vscode-managed-remote-resource",Ie.vscodeUserData="vscode-userdata",Ie.vscodeCustomEditor="vscode-custom-editor",Ie.vscodeNotebookCell="vscode-notebook-cell",Ie.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Ie.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",Ie.vscodeNotebookCellOutput="vscode-notebook-cell-output",Ie.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",Ie.vscodeNotebookMetadata="vscode-notebook-metadata",Ie.vscodeInteractiveInput="vscode-interactive-input",Ie.vscodeSettings="vscode-settings",Ie.vscodeWorkspaceTrust="vscode-workspace-trust",Ie.vscodeTerminal="vscode-terminal",Ie.vscodeChatCodeBlock="vscode-chat-code-block",Ie.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",Ie.vscodeChatSesssion="vscode-chat-editor",Ie.webviewPanel="webview-panel",Ie.vscodeWebview="vscode-webview",Ie.extension="extension",Ie.vscodeFileResource="vscode-file",Ie.tmp="tmp",Ie.vsls="vsls",Ie.vscodeSourceControl="vscode-scm",Ie.commentsInput="comment",Ie.codeSetting="code-setting",Ie.outputChannel="output"))(Tn||={});var CVe="tkn",J$=class{constructor(){this._hosts=Object.create(null);this._ports=Object.create(null);this._connectionTokens=Object.create(null);this._preferredWebSchema="http";this._delegate=null;this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,r){this._serverRootPath=EVe(e,r)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return Lr.join(this._serverRootPath,Tn.vscodeRemoteResource)}set(e,r,n){this._hosts[e]=r,this._ports[e]=n}setConnectionToken(e,r){this._connectionTokens[e]=r}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(c){return Vg(c),e}let r=e.authority,n=this._hosts[r];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let o=this._ports[r],s=this._connectionTokens[r],a=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(a+=`&${CVe}=${encodeURIComponent(s)}`),He.from({scheme:Ife?this._preferredWebSchema:Tn.vscodeRemoteResource,authority:`${n}:${o}`,path:this._remoteResourcesPath,query:a})}},TVe=new J$;function EVe(t,e){return Lr.join(e??"/",`${t.quality??"oss"}-${t.commit??"dev"}`)}var wVe="vscode-app",Z$=class t{static{this.FALLBACK_AUTHORITY=wVe}asBrowserUri(e){let r=this.toUri(e);return this.uriToBrowserUri(r)}uriToBrowserUri(e){return e.scheme===Tn.vscodeRemote?TVe.rewrite(e):e.scheme===Tn.file&&(Sfe||Cfe===`${Tn.vscodeFileResource}://${t.FALLBACK_AUTHORITY}`)?e.with({scheme:Tn.vscodeFileResource,authority:e.authority||t.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let r=this.toUri(e);return this.uriToFileUri(r)}uriToFileUri(e){return e.scheme===Tn.vscodeFileResource?e.with({scheme:Tn.file,authority:e.authority!==t.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,r){if(He.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n))return He.joinPath(He.parse(n,!0),e);let o=z$(n,e);return He.file(o)}return He.parse(r.toUrl(e))}},JRt=new Z$,kVe;(s=>{let t=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(t.get("3"));let r="vscode-coi";function n(a){let c;typeof a=="string"?c=new URL(a).searchParams:a instanceof URL?c=a.searchParams:He.isUri(a)&&(c=new URL(a.toString(!0)).searchParams);let l=c?.get(r);if(l)return t.get(l)}s.getHeadersFromQuery=n;function o(a,c,l){if(!globalThis.crossOriginIsolated)return;let u=c&&l?"3":l?"2":"1";a instanceof URLSearchParams?a.set(r,u):a[r]=u}s.addSearchParam=o})(kVe||={});function Lm(t){return qA(t,!0)}var VA=class{constructor(e){this._ignorePathCasing=e}compare(e,r,n=!1){return e===r?0:Bfe(this.getComparisonKey(e,n),this.getComparisonKey(r,n))}isEqual(e,r,n=!1){return e===r?!0:!e||!r?!1:this.getComparisonKey(e,n)===this.getComparisonKey(r,n)}getComparisonKey(e,r=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:r?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,r,n=!1){if(e.scheme===r.scheme){if(e.scheme===Tn.file)return Q$(Lm(e),Lm(r),this._ignorePathCasing(e))&&e.query===r.query&&(n||e.fragment===r.fragment);if(Kfe(e.authority,r.authority))return Q$(e.path,r.path,this._ignorePathCasing(e),"/")&&e.query===r.query&&(n||e.fragment===r.fragment)}return!1}joinPath(e,...r){return He.joinPath(e,...r)}basenameOrAuthority(e){return Ml(e)||e.authority}basename(e){return Lr.basename(e.path)}extname(e){return Lr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let r;return e.scheme===Tn.file?r=He.file(kM(Lm(e))).path:(r=Lr.dirname(e.path),e.authority&&r.length&&r.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),r="/")),e.with({path:r})}normalizePath(e){if(!e.path.length)return e;let r;return e.scheme===Tn.file?r=He.file(G$(Lm(e))).path:r=Lr.normalize(e.path),e.with({path:r})}relativePath(e,r){if(e.scheme!==r.scheme||!Kfe(e.authority,r.authority))return;if(e.scheme===Tn.file){let s=Afe(Lm(e),Lm(r));return pp?eI(s):s}let n=e.path||"/",o=r.path||"/";if(this._ignorePathCasing(e)){let s=0;for(let a=Math.min(n.length,o.length);s<a&&!(n.charCodeAt(s)!==o.charCodeAt(s)&&n.charAt(s).toLowerCase()!==o.charAt(s).toLowerCase());s++);n=o.substr(0,s)+n.substr(s)}return Lr.relative(n,o)}resolvePath(e,r){if(e.scheme===Tn.file){let n=He.file(Pfe(Lm(e),r));return e.with({authority:n.authority,path:n.path})}return r=Vfe(r),e.with({path:Lr.resolve(e.path,r)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,r){return e===r||e!==void 0&&r!==void 0&&NM(e,r)}hasTrailingPathSeparator(e,r=Y1){if(e.scheme===Tn.file){let n=Lm(e);return n.length>Y$(n).length&&n[n.length-1]===r}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,r=Y1){return Yfe(e,r)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,r=Y1){let n=!1;if(e.scheme===Tn.file){let o=Lm(e);n=o!==void 0&&o.length===Y$(o).length&&o[o.length-1]===r}else{r="/";let o=e.path;n=o.length===1&&o.charCodeAt(o.length-1)===47}return!n&&!Yfe(e,r)?e.with({path:e.path+"/"}):e}},Wr=new VA(()=>!1),oPt=new VA(t=>t.scheme===Tn.file?!xfe:!0),sPt=new VA(t=>!0),od=Wr.isEqual.bind(Wr),aPt=Wr.isEqualOrParent.bind(Wr),cPt=Wr.getComparisonKey.bind(Wr),lPt=Wr.basenameOrAuthority.bind(Wr),Ml=Wr.basename.bind(Wr),tl=Wr.extname.bind(Wr),uPt=Wr.dirname.bind(Wr),Qfe=Wr.joinPath.bind(Wr),dPt=Wr.normalizePath.bind(Wr),pPt=Wr.relativePath.bind(Wr),fPt=Wr.resolvePath.bind(Wr),mPt=Wr.isAbsolutePath.bind(Wr),Kfe=Wr.isEqualAuthority.bind(Wr),Yfe=Wr.hasTrailingPathSeparator.bind(Wr),hPt=Wr.removeTrailingPathSeparator.bind(Wr),gPt=Wr.addTrailingPathSeparator.bind(Wr);var RVe;(s=>{s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function o(a){let c=new Map;a.path.substring(a.path.indexOf(";")+1,a.path.lastIndexOf(";")).split(";").forEach(d=>{let[p,f]=d.split(":");p&&f&&c.set(p,f)});let u=a.path.substring(0,a.path.indexOf(";"));return u&&c.set(s.META_DATA_MIME,u),c}s.parseMetaData=o})(RVe||={});var Jfe=Symbol("MicrotaskDelay");function nW(t){let e=new Uo,r=t(e.token),n=new Promise((o,s)=>{let a=e.token.onCancellationRequested(()=>{a.dispose(),s(new dn)});Promise.resolve(r).then(c=>{a.dispose(),e.dispose(),o(c)},c=>{a.dispose(),e.dispose(),s(c)})});return new class{cancel(){e.cancel(),e.dispose()}then(o,s){return n.then(o,s)}catch(o){return this.then(void 0,o)}finally(o){return n.finally(o)}}}function ka(t,e,r){return new Promise((n,o)=>{let s=e.onCancellationRequested(()=>{s.dispose(),n(r)});t.then(n,o).finally(()=>s.dispose())})}function Zfe(t,e){return new Promise((r,n)=>{let o=e.onCancellationRequested(()=>{o.dispose(),n(new dn)});t.then(r,n).finally(()=>o.dispose())})}function v_(t,e,r){let n,o=setTimeout(()=>{n?.(void 0),r?.()},e);return Promise.race([t.finally(()=>clearTimeout(o)),new Promise(s=>n=s)])}var eW=class{constructor(){this.isDisposed=!1;this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let r=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(r,r).then(n)})}return new Promise((r,n)=>{this.queuedPromise.then(r,n)})}return this.activePromise=e(),new Promise((r,n)=>{this.activePromise.then(o=>{this.activePromise=null,r(o)},o=>{this.activePromise=null,n(o)})})}dispose(){this.isDisposed=!0}};var PVe=(t,e)=>{let r=!0,n=setTimeout(()=>{r=!1,e()},t);return{isTriggered:()=>r,dispose:()=>{clearTimeout(n),r=!1}}},AVe=t=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,t())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},tW=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,r=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((o,s)=>{this.doResolve=o,this.doReject=s}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let o=this.task;return this.task=null,o()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=r===Jfe?AVe(n):PVe(r,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new dn),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},Jg=class{constructor(e){this.delayer=new tW(e),this.throttler=new eW}trigger(e,r){return this.delayer.trigger(()=>this.throttler.queue(e),r)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}},UM=class{constructor(){this._isOpen=!1,this._promise=new Promise((e,r)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}};function Fl(t,e){return e?new Promise((r,n)=>{let o=setTimeout(()=>{s.dispose(),r()},t),s=e.onCancellationRequested(()=>{clearTimeout(o),s.dispose(),n(new dn)})}):nW(r=>Fl(t,r))}var fp=class{constructor(e){this._size=0;this._isDisposed=!1;this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new Yt}whenIdle(){return this.size>0?Ol.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((r,n)=>{this.outstandingPromises.push({factory:e,c:r,e:n}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let r=e.factory();r.then(e.c,e.e),r.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}};var BM=class{constructor(e,r){this._isDisposed=!1;this._token=-1,typeof e=="function"&&typeof r=="number"&&this.setIfNotSet(e,r)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,r){if(this._isDisposed)throw new yr("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},r)}setIfNotSet(e,r){if(this._isDisposed)throw new yr("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},r))}};var DVe,FM;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?FM=(t,e)=>{Efe(()=>{if(r)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let r=!1;return{dispose(){r||(r=!0)}}}:FM=(t,e,r)=>{let n=t.requestIdleCallback(e,typeof r=="number"?{timeout:r}:void 0),o=!1;return{dispose(){o||(o=!0,t.cancelIdleCallback(n))}}},DVe=t=>FM(globalThis,t)})();var rW=class{constructor(e,r){this._didRun=!1;this._executor=()=>{try{this._value=r()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=FM(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},qM=class extends rW{constructor(e){super(globalThis,e)}};var Om=class{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,r)=>{this.completeCallback=e,this.errorCallback=r})}complete(e){return new Promise(r=>{this.completeCallback(e),this.outcome={outcome:0,value:e},r()})}error(e){return new Promise(r=>{this.errorCallback(e),this.outcome={outcome:1,value:e},r()})}cancel(){return this.error(new dn)}},NVe;(r=>{async function t(n){let o,s=await Promise.all(n.map(a=>a.then(c=>c,c=>{o||(o=c)})));if(typeof o<"u")throw o;return s}r.settled=t;function e(n){return new Promise(async(o,s)=>{try{await n(o,s)}catch(a){s(a)}})}r.withAsyncBody=e})(NVe||={});var Xn=class t{static fromArray(e){return new t(r=>{r.emitMany(e)})}static fromPromise(e){return new t(async r=>{r.emitMany(await e)})}static fromPromises(e){return new t(async r=>{await Promise.all(e.map(async n=>r.emitOne(await n)))})}static merge(e){return new t(async r=>{await Promise.all(e.map(async n=>{for await(let o of n)r.emitOne(o)}))})}static{this.EMPTY=t.fromArray([])}constructor(e,r){this._state=0,this._results=[],this._error=null,this._onReturn=r,this._onStateChanged=new Yt,queueMicrotask(async()=>{let n={emitOne:o=>this.emitOne(o),emitMany:o=>this.emitMany(o),reject:o=>this.reject(o)};try{await Promise.resolve(e(n)),this.resolve()}catch(o){this.reject(o)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await Ol.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,r){return new t(async n=>{for await(let o of e)n.emitOne(r(o))})}map(e){return t.map(this,e)}static filter(e,r){return new t(async n=>{for await(let o of e)r(o)&&n.emitOne(o)})}filter(e){return t.filter(this,e)}static coalesce(e){return t.filter(e,r=>!!r)}coalesce(){return t.coalesce(this)}static async toPromise(e){let r=[];for await(let n of e)r.push(n);return r}toPromise(){return t.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var Zg=class{constructor(e){this._deferred=new Om;this._asyncIterable=new Xn(o=>{if(r){o.reject(r);return}return n&&o.emitMany(n),this._errorFn=s=>o.reject(s),this._emitFn=s=>o.emitOne(s),this._deferred.p},e);let r,n;this._emitFn=o=>{n||(n=[]),n.push(o)},this._errorFn=o=>{r||(r=o)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}};var ye=class{constructor(e,r=[],n=!1){this.ctor=e,this.staticArguments=r,this.supportsDelayedInstantiation=n}};var iW=class{constructor(e,r){this.key=e;this.data=r;this.incoming=new Map;this.outgoing=new Map}},HA=class{constructor(e){this._hashFn=e;this._nodes=new Map}roots(){let e=[];for(let r of this._nodes.values())r.outgoing.size===0&&e.push(r);return e}insertEdge(e,r){let n=this.lookupOrInsertNode(e),o=this.lookupOrInsertNode(r);n.outgoing.set(o.key,o),o.incoming.set(n.key,n)}removeNode(e){let r=this._hashFn(e);this._nodes.delete(r);for(let n of this._nodes.values())n.outgoing.delete(r),n.incoming.delete(r)}lookupOrInsertNode(e){let r=this._hashFn(e),n=this._nodes.get(r);return n||(n=new iW(r,e),this._nodes.set(r,n)),n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){let e=[];for(let[r,n]of this._nodes)e.push(`${r}
	(-> incoming)[${[...n.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...n.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(let[e,r]of this._nodes){let n=new Set([e]),o=this._findCycle(r,n);if(o)return o}}_findCycle(e,r){for(let[n,o]of e.outgoing){if(r.has(n))return[...r,n].join(" -> ");r.add(n);let s=this._findCycle(o,r);if(s)return s;r.delete(n)}}};var y_=class{constructor(...e){this._entries=new Map;for(let[r,n]of e)this.set(r,n)}set(e,r){let n=this._entries.get(e);return this._entries.set(e,r),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var LVe=!1,jM=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},VM=class t{constructor(e=new y_,r=!1,n,o=LVe){this._services=e;this._strict=r;this._parent=n;this._enableTracing=o;this._isDisposed=!1;this._servicesToMaybeDispose=new Set;this._children=new Set;this._activeInstantiations=new Set;this._services.set(j,this),this._globalGraph=o?n?._globalGraph??new HA(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,zg(this._children),this._children.clear();for(let e of this._servicesToMaybeDispose)G1(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,r){this._throwIfDisposed();let n=this,o=new class extends t{dispose(){n._children.delete(o),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(o),r?.add(o),o}invokeFunction(e,...r){this._throwIfDisposed();let n=GA.traceInvocation(this._enableTracing,e),o=!1;try{return e({get:a=>{if(o)throw efe("service accessor is only valid during the invocation of its target method");let c=this._getOrCreateServiceInstance(a,n);if(!c)throw new Error(`[invokeFunction] unknown service '${a}'`);return c}},...r)}finally{o=!0,n.stop()}}createInstance(e,...r){this._throwIfDisposed();let n,o;return e instanceof ye?(n=GA.traceCreation(this._enableTracing,e.ctor),o=this._createInstance(e.ctor,e.staticArguments.concat(r),n)):(n=GA.traceCreation(this._enableTracing,e),o=this._createInstance(e,r,n)),n.stop(),o}_createInstance(e,r=[],n){let o=Zu.getServiceDependencies(e).sort((c,l)=>c.index-l.index),s=[];for(let c of o){let l=this._getOrCreateServiceInstance(c.id,n);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${c.id}.`,!1),s.push(l)}let a=o.length>0?o[0].index:r.length;if(r.length!==a){console.trace(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${r.length} static arguments`);let c=a-r.length;c>0?r=r.concat(new Array(c)):r=r.slice(0,a)}return Reflect.construct(e,r.concat(s))}_setCreatedServiceInstance(e,r){if(this._services.get(e)instanceof ye)this._services.set(e,r);else if(this._parent)this._parent._setCreatedServiceInstance(e,r);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){let r=this._services.get(e);return!r&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):r}_getOrCreateServiceInstance(e,r){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));let n=this._getServiceInstanceOrDescriptor(e);return n instanceof ye?this._safeCreateAndCacheServiceInstance(e,n,r.branch(e,!0)):(r.branch(e,!1),n)}_safeCreateAndCacheServiceInstance(e,r,n){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,r,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,r,n){let o=new HA(l=>l.id.toString()),s=0,a=[{id:e,desc:r,_trace:n}],c=new Set;for(;a.length;){let l=a.pop();if(!c.has(String(l.id))){if(c.add(String(l.id)),o.lookupOrInsertNode(l),s++>1e3)throw new jM(o);for(let u of Zu.getServiceDependencies(l.desc.ctor)){let d=this._getServiceInstanceOrDescriptor(u.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(u.id)),d instanceof ye){let p={id:u.id,desc:d,_trace:l._trace.branch(u.id,!0)};o.insertEdge(l,p),a.push(p)}}}}for(;;){let l=o.roots();if(l.length===0){if(!o.isEmpty())throw new jM(o);break}for(let{data:u}of l){if(this._getServiceInstanceOrDescriptor(u.id)instanceof ye){let p=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,p)}o.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,r,n=[],o,s){if(this._services.get(e)instanceof ye)return this._createServiceInstance(e,r,n,o,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,r,n,o,s);throw new Error(`illegalState - creating UNKNOWN service instance ${r.name}`)}_createServiceInstance(e,r,n=[],o,s,a){if(o){let c=new t(void 0,this._strict,this,this._enableTracing);c._globalGraphImplicitDependency=String(e);let l=new Map,u=new qM(()=>{let d=c._createInstance(r,n,s);for(let[p,f]of l){let m=d[p];if(typeof m=="function")for(let h of f)h.disposable=m.apply(d,h.listener)}return l.clear(),a.add(d),d});return new Proxy(Object.create(null),{get(d,p){if(!u.isInitialized&&typeof p=="string"&&(p.startsWith("onDid")||p.startsWith("onWill"))){let h=l.get(p);return h||(h=new DA,l.set(p,h)),(v,b,_)=>{if(u.isInitialized)return u.value[p](v,b,_);{let x={listener:[v,b,_],disposable:void 0},S=h.push(x);return Zi(()=>{S(),x.disposable?.dispose()})}}}if(p in d)return d[p];let f=u.value,m=f[p];return typeof m!="function"||(m=m.bind(f),d[p]=m),m},set(d,p,f){return u.value[p]=f,!0},getPrototypeOf(d){return r.prototype}})}else{let c=this._createInstance(r,n,s);return a.add(c),c}}_throwIfStrict(e,r){if(r&&console.warn(e),this._strict)throw new Error(e)}};var GA=class t{constructor(e,r){this.type=e;this.name=r;this._start=Date.now();this._dep=[]}static{this.all=new Set}static{this._None=new class extends t{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,r){return e?new t(2,r.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):t._None}static traceCreation(e,r){return e?new t(1,r.name):t._None}static{this._totals=0}branch(e,r){let n=new t(3,e.toString());return this._dep.push([e,r,n]),n}stop(){let e=Date.now()-this._start;t._totals+=e;let r=!1;function n(s,a){let c=[],l=new Array(s+1).join("	");for(let[u,d,p]of a._dep)if(d&&p){r=!0,c.push(`${l}CREATES -> ${u}`);let f=n(s+1,p);f&&c.push(f)}else c.push(`${l}uses -> ${u}`);return c.join(`
`)}let o=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${n(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${t._totals.toFixed(2)}ms)`];(e>2||r)&&t.all.add(o.join(`
`))}};var Rt=ne("IServicesAccessor"),HM=class{constructor(e,r){this._isSealed=!1;let n=Array.isArray(e)?new y_(...e):e??new y_;n.set(Rt,this);let o=r?r._pair.insta.createChild(n):new VM(n,!0);this._pair={services:n,insta:o}}dispose(){this._pair.insta.dispose()}get(e){return this._pair.insta.invokeFunction(r=>r.get(e))}safeGet(e){try{return this.get(e)}catch{return}}define(e,r){if(this._isSealed)throw new Error("This accessor is sealed and cannot be modified anymore.");this._pair.services.set(e,r)}seal(){this._isSealed=!0}toString(){return""}};var sc=require("../package.json"),GM=sc.buildType!=="dev",Ra=sc.isPreRelease||!GM,nAt=sc.engines.vscode;var zA=class{constructor(e,r){this.name=e;this.version=r}format(){return`${this.name}/${this.version}`}},gt=ne("IEnvService");var $A=class t{constructor(e,r){this.offset=e;this.timestamp=r}adjust(e){return new t(this.offset+e,this.timestamp)}},tI=ne("heatmapService");var zM=`

**Note:** Some files were excluded from the context due to content exclusion rules. Click [here](https://docs.github.com/en/copilot/managing-github-copilot-in-your-organization/configuring-content-exclusions-for-github-copilot) to learn more.`,Te=ne("IIgnoreService"),eme=class t{static{this.Instance=new t}dispose(){}get isEnabled(){return!1}get isRegexExclusionsEnabled(){return!1}async init(){}async isCopilotIgnored(e){return!1}async asMinimatchPattern(){}};async function oW(t,e){let r=[];for(let n of e)await t.isCopilotIgnored(n)||r.push(n);return r}var Lt=ne("IExperimentationService"),$M=class{constructor(){this.initializePromise=Promise.resolve();this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,r){}getTreatmentVariableAsync(e,r){return Promise.resolve(void 0)}};var tme=require("vscode");var ev=ne("IScopeSelector");var WA=class{static{this.version=1}#t;constructor(e){this.#t=e}async selectScope(e,r){if(e??=tme.window.activeTextEditor,!!e)return this.#t.get(ev).selectEnclosingScope(e,r)}};var ac=ne("ICopilotTokenStore"),WM=class extends Oe{constructor(){super(...arguments);this._onDidStoreUpdate=this._register(new Yt);this.onDidStoreUpdate=this._onDidStoreUpdate.event}get copilotToken(){return this._copilotToken}set copilotToken(r){let n=this._copilotToken?.token;this._copilotToken=r,n!==r?.token&&this._onDidStoreUpdate.fire()}};var OVe=Object.prototype.hasOwnProperty;function rme(t,e){return sW(t,e,new Set)}function sW(t,e,r){if(K$(t))return t;let n=e(t);if(typeof n<"u")return n;if(Array.isArray(t)){let o=[];for(let s of t)o.push(sW(s,e,r));return o}if(BA(t)){if(r.has(t))throw new Error("Cannot clone recursive data-structure");r.add(t);let o={};for(let s in t)OVe.call(t,s)&&(o[s]=sW(t[s],e,r));return r.delete(t),o}return t}function KA(t,e){if(t===e)return!0;if(t==null||e===null||e===void 0||typeof t!=typeof e||typeof t!="object"||Array.isArray(t)!==Array.isArray(e))return!1;let r,n;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(!KA(t[r],e[r]))return!1}else{let o=[];for(n in t)o.push(n);o.sort();let s=[];for(n in e)s.push(n);if(s.sort(),!KA(o,s))return!1;for(r=0;r<o.length;r++)if(!KA(t[o[r]],e[o[r]]))return!1}return!0}function KM(t,e="Unreachable"){throw new Error(e)}function rI(t,e="unexpected state"){if(!t)throw new yr(`Assertion Failed: ${e}`)}function tv(t){if(!t()){debugger;t(),Vg(new yr("Assertion Failed"))}}function aW(t,e){let r=0;for(;r<t.length-1;){let n=t[r],o=t[r+1];if(!e(n,o))return!1;r++}return!0}var as=class{constructor(e,r,n){this.owner=e;this.debugNameSource=r;this.referenceFn=n}getDebugName(e){return sme(e,this)}},nme=new Map,cW=new WeakMap;function sme(t,e){let r=cW.get(t);if(r)return r;let n=FVe(t,e);if(n){let o=nme.get(n)??0;o++,nme.set(n,o);let s=o===1?n:`${n}#${o}`;return cW.set(t,s),s}}function FVe(t,e){let r=cW.get(t);if(r)return r;let n=e.owner?BVe(e.owner)+".":"",o,s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(o=s(),o!==void 0)return n+o}else return n+s;let a=e.referenceFn;if(a!==void 0&&(o=YM(a),o!==void 0))return n+o;if(e.owner!==void 0){let c=UVe(e.owner,t);if(c!==void 0)return n+c}}function UVe(t,e){for(let r in t)if(t[r]===e)return r}var ime=new Map,ome=new WeakMap;function BVe(t){let e=ome.get(t);if(e)return e;let r=qVe(t),n=ime.get(r)??0;n++,ime.set(r,n);let o=n===1?r:`${r}#${n}`;return ome.set(t,o),o}function qVe(t){let e=t.constructor;return e?e.name:"Object"}function YM(t){let e=t.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}var ame;function cme(t){ame=t}function cc(){return ame}var QM=class{constructor(){this.indentation=0;this.changedObservablesSets=new WeakMap}textToConsoleArgs(e){return jVe([nI(GVe("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[nI(" "),sd(QA(e.oldValue,70),{color:"red",strikeThrough:!0}),nI(" "),sd(QA(e.newValue,60),{color:"green"})]:[nI(" (unchanged)")]:[nI(" "),sd(QA(e.newValue,60),{color:"green"}),nI(" (initial)")]}handleObservableChanged(e,r){console.log(...this.textToConsoleArgs([YA("observable value changed"),sd(e.debugName,{color:"BlueViolet"}),...this.formatInfo(r)]))}formatChanges(e){if(e.size!==0)return sd(" (changed deps: "+[...e].map(r=>r.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let r=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,o)=>(this.changedObservablesSets.get(e).add(n),r.apply(e,[n,o]))}handleDerivedRecomputed(e,r){let n=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([YA("derived recomputed"),sd(e.debugName,{color:"BlueViolet"}),...this.formatInfo(r),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear()}handleFromEventObservableTriggered(e,r){console.log(...this.textToConsoleArgs([YA("observable from event triggered"),sd(e.debugName,{color:"BlueViolet"}),...this.formatInfo(r),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let r=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(n,o)=>(this.changedObservablesSets.get(e).add(n),r.apply(e,[n,o]))}handleAutorunTriggered(e){let r=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([YA("autorun"),sd(e.debugName,{color:"BlueViolet"}),this.formatChanges(r),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),r.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let r=e.getDebugName();r===void 0&&(r=""),console.log(...this.textToConsoleArgs([YA("transaction"),sd(r,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function jVe(t){let e=new Array,r=[],n="";function o(a){if("length"in a)for(let c of a)c&&o(c);else"text"in a?(n+=`%c${a.text}`,e.push(a.style),a.data&&r.push(...a.data)):"data"in a&&r.push(...a.data)}o(t);let s=[n,...e];return s.push(...r),s}function nI(t){return sd(t,{color:"black"})}function YA(t){return sd(zVe(`${t}: `,10),{color:"black",bold:!0})}function sd(t,e={color:"black"}){function r(o){return Object.entries(o).reduce((s,[a,c])=>`${s}${a}:${c};`,"")}let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:t,style:r(n)}}function QA(t,e){switch(typeof t){case"number":return""+t;case"string":return t.length+2<=e?`"${t}"`:`"${t.substr(0,e-7)}"+...`;case"boolean":return t?"true":"false";case"undefined":return"undefined";case"object":return t===null?"null":Array.isArray(t)?VVe(t,e):HVe(t,e);case"symbol":return t.toString();case"function":return`[[Function${t.name?" "+t.name:""}]]`;default:return""+t}}function VVe(t,e){let r="[ ",n=!0;for(let o of t){if(n||(r+=", "),r.length-5>e){r+="...";break}n=!1,r+=`${QA(o,e-r.length)}`}return r+=" ]",r}function HVe(t,e){let r="{ ",n=!0;for(let[o,s]of Object.entries(t)){if(n||(r+=", "),r.length-5>e){r+="...";break}n=!1,r+=`${o}: ${QA(s,e-r.length)}`}return r+=" }",r}function GVe(t,e){let r="";for(let n=1;n<=e;n++)r+=t;return r}function zVe(t,e){for(;t.length<e;)t+=" ";return t}function Ul(t){return new XA(new as(void 0,void 0,t),t,void 0,void 0)}function lW(t,e){return new XA(new as(t.owner,t.debugName,t.debugReferenceFn??e),e,void 0,void 0)}function b_(t){let e=new ht,r=lW({owner:void 0,debugName:void 0,debugReferenceFn:t},n=>{e.clear(),t(n,e)});return Zi(()=>{r.dispose(),e.dispose()})}var XA=class{constructor(e,r,n,o){this._debugNameData=e;this._runFn=r;this.createChangeSummary=n;this._handleChange=o;this.state=2;this.updateCount=0;this.disposed=!1;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this.changeSummary=this.createChangeSummary?.(),cc()?.handleAutorunCreated(this),this._runIfNeeded(),u_(this)}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),d_(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let r=this.disposed;try{if(!r){cc()?.handleAutorunTriggered(this);let n=this.changeSummary;this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}}finally{r||cc()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,tv(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,r){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:r,didChange:o=>o===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let r=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),r}};(e=>e.Observer=XA)(Ul||={});var ad=(t,e)=>t===e;var lme;function ume(t){lme=t}var dme;function pme(t){dme=t}var uW;function fme(t){uW=t}var XM=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,r){let n=r===void 0?void 0:e,o=r===void 0?e:r;return uW({owner:n,debugName:()=>{let s=YM(o);if(s!==void 0)return s;let c=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(o.toString());if(c)return`${this.debugName}.${c[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:o},s=>o(this.read(s),s))}flatten(){return uW({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,r){return e.add(lme(this,r)),this}keepObserved(e){return e.add(dme(this)),this}get debugValue(){return this.get()}},Mm=class extends XM{constructor(){super(...arguments);this.observers=new Set}addObserver(r){let n=this.observers.size;this.observers.add(r),n===0&&this.onFirstObserverAdded()}removeObserver(r){this.observers.delete(r)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function __(t,e){let r=new JA(t,e);try{t(r)}finally{r.finish()}}function dW(t,e,r){t?e(t):__(e,r)}var JA=class{constructor(e,r){this._fn=e;this._getDebugName=r;this.updatingObservers=[];cc()?.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():YM(this._fn)}updateObserver(e,r){this.updatingObservers.push({observer:e,observable:r}),e.beginUpdate(r)}finish(){let e=this.updatingObservers;for(let r=0;r<e.length;r++){let{observer:n,observable:o}=e[r];n.endUpdate(o)}this.updatingObservers=null,cc()?.handleEndTransaction()}};function ZM(t,e){let r;return typeof t=="string"?r=new as(void 0,t,void 0):r=new as(t,void 0,void 0),new JM(r,e,ad)}var JM=class extends Mm{constructor(r,n,o){super();this._debugNameData=r;this._equalityComparator=o;this._value=n}get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(r,n,o){if(o===void 0&&this._equalityComparator(this._value,r))return;let s;n||(n=s=new JA(()=>{},()=>`Setting ${this.debugName}`));try{let a=this._value;this._setValue(r),cc()?.handleObservableChanged(this,{oldValue:a,newValue:r,change:o,didChange:!0,hadValue:!0});for(let c of this.observers)n.updateObserver(c,this),c.handleChange(this,o)}finally{s&&s.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(r){this._value=r}};function cd(t,e){return e!==void 0?new iI(new as(t,void 0,e),e,void 0,void 0,void 0,ad):new iI(new as(void 0,void 0,t),t,void 0,void 0,void 0,ad)}function eF(t,e){return new iI(new as(t.owner,t.debugName,t.debugReferenceFn),e,void 0,void 0,t.onLastObserverRemoved,t.equalsFn??ad)}fme(eF);var iI=class extends Mm{constructor(r,n,o,s,a=void 0,c){super();this._debugNameData=r;this._computeFn=n;this.createChangeSummary=o;this._handleChange=s;this._handleLastObserverRemoved=a;this._equalityComparator=c;this.state=0;this.value=void 0;this.updateCount=0;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this.changeSummary=void 0;this.changeSummary=this.createChangeSummary?.(),cc()?.handleDerivedCreated(this)}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let r of this.dependencies)r.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let r=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),r}else{do{if(this.state===1){for(let r of this.dependencies)if(r.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let r=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=r;let n=this.state!==0,o=this.value;this.state=3;let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let c of this.dependenciesToBeRemoved)c.removeObserver(this);this.dependenciesToBeRemoved.clear()}let a=n&&!this._equalityComparator(o,this.value);if(cc()?.handleDerivedRecomputed(this,{oldValue:o,newValue:this.value,change:void 0,didChange:a,hadValue:n}),a)for(let c of this.observers)c.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(r){this.updateCount++;let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let o of this.observers)o.handlePossibleChange(this);if(n)for(let o of this.observers)o.beginUpdate(this)}endUpdate(r){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let o of n)o.endUpdate(this)}tv(()=>this.updateCount>=0)}handlePossibleChange(r){if(this.state===3&&this.dependencies.has(r)&&!this.dependenciesToBeRemoved.has(r)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(r,n){if(this.dependencies.has(r)&&!this.dependenciesToBeRemoved.has(r)){let o=this._handleChange?this._handleChange({changedObservable:r,change:n,didChange:a=>a===r},this.changeSummary):!0,s=this.state===3;if(o&&(this.state===1||s)&&(this.state=2,s))for(let a of this.observers)a.handlePossibleChange(this)}}readObservable(r){r.addObserver(this);let n=r.get();return this.dependencies.add(r),this.dependenciesToBeRemoved.delete(r),n}addObserver(r){let n=!this.observers.has(r)&&this.updateCount>0;super.addObserver(r),n&&r.beginUpdate(this)}removeObserver(r){let n=this.observers.has(r)&&this.updateCount>0;super.removeObserver(r),n&&r.endUpdate(this)}};function cs(...t){let e,r,n;return t.length===3?[e,r,n]=t:[r,n]=t,new mp(new as(e,void 0,n),r,n,()=>mp.globalTransaction,ad)}function mme(t,e,r){return new mp(new as(t.owner,t.debugName,t.debugReferenceFn??r),e,r,()=>mp.globalTransaction,t.equalsFn??ad)}var mp=class extends Mm{constructor(r,n,o,s,a){super();this._debugNameData=r;this.event=n;this._getValue=o;this._getTransaction=s;this._equalityComparator=a;this.hasValue=!1;this.handleEvent=r=>{let n=this._getValue(r),o=this.value,s=!this.hasValue||!this._equalityComparator(o,n),a=!1;s&&(this.value=n,this.hasValue&&(a=!0,dW(this._getTransaction(),c=>{cc()?.handleFromEventObservableTriggered(this,{oldValue:o,newValue:n,change:void 0,didChange:s,hadValue:this.hasValue});for(let l of this.observers)c.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let c=this.getDebugName();return"Event fired"+(c?`: ${c}`:"")})),this.hasValue=!0),a||cc()?.handleFromEventObservableTriggered(this,{oldValue:o,newValue:n,change:void 0,didChange:s,hadValue:this.hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let r=this.getDebugName();return"From Event"+(r?`: ${r}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(r=>{r.Observer=mp;function e(n,o){let s=!1;mp.globalTransaction===void 0&&(mp.globalTransaction=n,s=!0);try{o()}finally{s&&(mp.globalTransaction=void 0)}}r.batchEventsGlobally=e})(cs||={});function pW(t){return typeof t=="string"?new tF(t):new tF(void 0,t)}var tF=class extends Mm{constructor(r,n){super();this._debugName=r;this._owner=n}get debugName(){return new as(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(r,n){if(!r){__(o=>{this.trigger(o,n)},()=>`Trigger signal ${this.debugName}`);return}for(let o of this.observers)r.updateObserver(o,this),o.handleChange(this,n)}get(){}};function hme(t){let e=new rF(!1,void 0);return t.addObserver(e),Zi(()=>{t.removeObserver(e)})}pme(hme);function gme(t,e){let r=new rF(!0,e);return t.addObserver(r),e?e(t.get()):t.reportChanges(),Zi(()=>{t.removeObserver(r)})}ume(gme);var rF=class{constructor(e,r){this._forceRecompute=e;this._handleValue=r;this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,r){}};function vme(t,e,r,n){let o=new nF(r,n);return eF({debugReferenceFn:r,owner:t,onLastObserverRemoved:()=>{o.dispose(),o=new nF(r)}},a=>(o.setItems(e.read(a)),o.getItems()))}var nF=class{constructor(e,r){this._map=e;this._keySelector=r;this._cache=new Map;this._items=[]}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){let r=[],n=new Set(this._cache.keys());for(let o of e){let s=this._keySelector?this._keySelector(o):o,a=this._cache.get(s);if(a)n.delete(s);else{let c=new ht;a={out:this._map(o,c),store:c},this._cache.set(s,a)}r.push(a.out)}for(let o of n)this._cache.get(o).store.dispose(),this._cache.delete(o);this._items=r}getItems(){return this._items}};var hp="github.copilot",he=ne("IConfigurationService"),yme=(t,e)=>mme({debugName:()=>`Configuration Key "${e.id}"`},r=>t.onDidChangeConfiguration(n=>{n.affectsConfiguration(e.fullyQualifiedId)&&r(n)}),()=>t.getConfig(e)),oF=class{getConfigMixedWithDefaults(e){let r=this.getConfig(e);return r===void 0?e.defaultValue:BA(r)&&BA(e.defaultValue)?{...e.defaultValue,...r}:r}};var iF;function $Ve(){if(!iF){iF=new Map;let t=sc.contributes.configuration.properties;for(let e of Object.keys(t))typeof t[e].default<"u"&&iF.set(e,t[e].default)}return iF}function bme(t,e){let r=`${hp}.${t}`,n=$Ve().get(r);if(typeof n<"u"&&!KA(e,n))throw new Error(`The default value for setting ${t} is different in package.json and in code`);let o=t.indexOf("."),s=t.substring(0,o);if(s!=="editor"&&s!=="chat"&&s!=="advanced"&&s!=="notebook"&&s!=="renameSuggestions")throw new Error(`Unexpected setting section ${s} in setting ${t}`);let a=t.substring(o+1);return{id:t,fullyQualifiedId:r,firstPart:s,secondPart:a,defaultValue:e}}function Mt(t,e){return{...bme(t,e),configType:0}}function Pa(t,e){return{...bme(t,e),configType:1}}var le;(oe=>(oe.DebugOverrideCAPIUrl=Mt("advanced.debug.overrideCAPIUrl","https://api.githubcopilot.com"),oe.DebugOverrideChatEngine=Mt("advanced.debug.overrideChatEngine",void 0),oe.DebugOverrideEmbeddingsModel=Mt("advanced.debug.overrideEmbeddingsModel",void 0),oe.DebugOverrideChatMaxTokenNum=Mt("advanced.debug.overrideChatMaxTokenNum",0),oe.DebugReportFeedback=Mt("advanced.debug.reportFeedback",!1),oe.DebugUseNodeFetcher=Mt("advanced.debug.useNodeFetcher",!1),oe.DebugUseElectronFetcher=Mt("advanced.debug.useElectronFetcher",!0),oe.EnableImplicitContext=Mt("chat.experimental.githubAgents.enableImplicitContext",!1),oe.ConversationVariablesEnablements=Mt("advanced.variables",{"*":Ra}),oe.ShowRequestLog=Mt("advanced.showLog",!1),oe.InternalLoggingEnabled=Mt("advanced.internalLogging",void 0),oe.KerberosServicePrincipal=Mt("advanced.kerberosServicePrincipal",void 0),oe.ExplainIntentRefer=Mt("advanced.explain.refer",!0),oe.InlineChatEndpoint=Pa("advanced.inlineChatEndpoint",void 0),oe.FixInlineChatEndpoint=Pa("advanced.fix.inlineChatEndpoint",void 0),oe.FixUseWorkspaceChunksFromSelection=Pa("advanced.fix.useWorkspaceChunksFromSelection",!1),oe.FixUseWorkspaceChunksFromDiagnostics=Pa("advanced.fix.useWorkspaceChunksFromDiagnostics",!1),oe.usePythonCookbookLineTooLong=Pa("advanced.fix.usePythonCookbookLineTooLong",!1),oe.CodeMapperChatEndpoint=Pa("advanced.codeMapper.chatEndpoint",void 0),oe.ProjectLabelsExpanded=Pa("advanced.projectLabels.expanded",!1),oe.ProjectLabelsChat=Pa("advanced.projectLabels.chat",!1),oe.ProjectLabelsInline=Pa("advanced.projectLabels.inline",!1),oe.WorkspaceCodeSearchEnabled=Mt("advanced.workspace.codeSearchEnabled",void 0),oe.WorkspaceRerankStrategy=Mt("advanced.workspace.rerankStrategy",void 0),oe.WorkspaceUseChunksEndpoint=Mt("advanced.workspace.useChunksEndpoint",!1),oe.WorkspaceCodeSearchReturnRawChunks=Mt("advanced.workspace.codeSearchReturnRawChunks",void 0),oe.WorkspaceUseFilesVariable=Mt("advanced.workspace.useFilesVariable",!1),oe.WorkspacePreInitEmbeddings=Pa("advanced.workspace.preInitEmbeddings",!1),oe.FeedbackOnChange=Mt("advanced.feedback.onChange",!1),oe.ReviewContextMenu=Mt("advanced.review.contextMenu",Ra),oe.ReviewSCMViewlet=Mt("advanced.review.scmViewlet",Ra),oe.ReviewIntent=Mt("advanced.review.intent",!1),oe.EditIntentAutoApply=Mt("advanced.edit.autoApply",!1),oe.NotebookAdditionalCodeGenerationRuleEnabled=Mt("advanced.notebook.additionalCodeGenerationRule",!1),oe.NotebookSummaryExperimentEnabled=Mt("advanced.notebook.summaryExperimentEnabled",!1),oe.NotebookVariableFilteringEnabled=Mt("advanced.notebook.variableFilteringEnabled",!1),oe.TerminalToDebuggerEnabled=Mt("chat.debugTerminalCommands",!1),oe.TerminalToDebuggerPatterns=Mt("chat.debugTerminalCommandPatterns",[]),oe.AuthProvider=Mt("advanced.authProvider","github"),oe.ShowCodeMatches=Pa("advanced.showCodeMatches",!1),oe.FollowUpsEnabled=Pa("chat.followUps.enabled",!0),oe.InlineEditsEnabled=Mt("advanced.inlineEdits.enabled",!1),oe.WorkspaceRecordingEnabled=Mt("advanced.localWorkspaceRecording.enabled",!1),oe.PanelEditingEnabled=Mt("advanced.edit.intent.enabled",!1),oe.TemporalContextEnabled=Pa("chat.experimental.temporalContext.enabled",!1),oe.TemporalContextMaxAge=Pa("chat.experimental.temporalContext.maxAge",300),oe.TemporalContextPreferSameLang=Pa("chat.experimental.temporalContext.preferSameLang",!1),oe.CodeGenerationInstructions=Mt("chat.experimental.codeGeneration.instructions",[]),oe.CodeFeedbackInstructions=Mt("chat.experimental.codeFeedback.instructions",[]),oe.DeprecatedCustomUserInstructions=Mt("chat.customUserInstructions",[]),oe.TestGenerationInstructions=Mt("chat.experimental.testGeneration.instructions",[]),oe.GenerateTestsCodeLens=Mt("chat.experimental.generateTests.codeLens",!1),oe.UseInstructionFiles=Mt("chat.experimental.codeGeneration.useInstructionFiles",!1),oe.StartDebuggingIntent=Mt("chat.experimental.startDebugging.enabled",!0),oe.SetupTests=Mt("chat.experimental.setupTests.enabled",!0),oe.InlineChatCompletionsTrigger=Mt("chat.experimental.inlineChatCompletionTrigger.enabled",!1),oe.InlineChatHint=Mt("chat.experimental.inlineChatHint.enabled",!1),oe.SemanticSearchEnabled=Mt("chat.search.semanticTextResults",!1),oe.FixTestFailure=Mt("chat.fixTestFailure.enabled",!0),oe.RunCommandEnabled=Mt("chat.runCommand.enabled",!0),oe.UseProjectTemplates=Mt("chat.useProjectTemplates",!0),oe.ExplainScopeSelection=Mt("chat.scopeSelection",!1),oe.EnableCodeActions=Mt("editor.enableCodeActions",!0),oe.LocaleOverride=Mt("chat.localeOverride","auto"),oe.TerminalChatLocation=Mt("chat.terminalChatLocation","chatView"),oe.NotebookIterativeImproving=Mt("notebook.iterativeImproving",!1),oe.AutomaticRenameSuggestions=Mt("renameSuggestions.triggerAutomatically",!0)))(le||={});var ie=ne("ILogService"),aF=(a=>(a[a.Off=0]="Off",a[a.Trace=1]="Trace",a[a.Debug=2]="Debug",a[a.Info=3]="Info",a[a.Warning=4]="Warning",a[a.Error=5]="Error",a))(aF||{});var oI=class{constructor(e,r,n){this.public=new sF(r,n,e,!1),this.internal=new sF(r,n,e,!0)}};oI=E([y(1,ac),y(2,he)],oI);var sF=class{constructor(e,r,n,o){this._tokenStore=e;this._configService=r;this._logTargets=n;this._isInternalOnlyLogger=o}get shouldLog(){if(this._isInternalOnlyLogger){let e=this._configService.getConfig(le.InternalLoggingEnabled),r=!!this._tokenStore.copilotToken?.isVscodeTeamMember;return e===void 0?r:e===!1?!1:!!this._tokenStore.copilotToken?.isInternal}return!0}_logIt(e,r){this.shouldLog&&(this._isInternalOnlyLogger&&(r=`[\u{1F92B}] ${r}`),this._logTargets.map(n=>n.logIt(e,r)))}trace(e){this._logIt(1,e)}debug(e){this._logIt(2,e)}info(e){this._logIt(3,e)}warn(e){this._logIt(4,e)}error(e,r){let n=e instanceof Error?e.stack??"Empty error":e;this._logIt(5,n+(r?`: ${r}`:""))}};var cF=ne("ITelemetryUserConfig"),sI=class{constructor(e,r,n){this._tokenStore=n;this.trackingId=e,this.optedIn=r??!1,this.setupUpdateOnToken()}setupUpdateOnToken(){this._tokenStore.onDidStoreUpdate(()=>{let e=this._tokenStore.copilotToken;if(!e)return;let r=e.getTokenValue("rt")==="1",n=e.getTokenValue("tid");n!==void 0&&(this.trackingId=n,this.organizationsList=e.organizationList.toString(),this.optedIn=r)})}};sI=E([y(2,ac)],sI);var ge=ne("ITelemetryService"),aI=class{constructor(e){this.value=e;this.isTrustedTelemetryValue=!0}};var cI=class{constructor(e){this.telemetryService=e;e.sendGHTelemetryEvent("extension.activate")}dispose(){this.telemetryService.sendGHTelemetryEvent("extension.deactivate")}};cI=E([y(0,ge)],cI);var WVe=[mo(cI)];function mo(t){return{create(e){return e.get(j).createInstance(t)}}}var rv=class extends Oe{constructor(r,n,o){super();this.allActivationBlockers=[];for(let s of r){let a;try{if(a=o.invokeFunction(s.create),G1(a)&&this._register(a),a?.activationBlocker){let c=Fo.create(),l=a.id||"UNKNOWN";this.allActivationBlockers.push(a.activationBlocker.finally(()=>{n.public.info(`activationBlocker from '${l}' took for ${Math.round(c.elapsed())}ms`)}))}}catch(c){n.public.error(c,`Error while loading contribution: ${c}`)}}}async waitForActivationBlockers(){await Promise.allSettled(this.allActivationBlockers)}};rv=E([y(1,ie),y(2,j)],rv);var _me=WVe;var fW=class extends Oe{constructor(){super(...arguments);this._contextDescriptors=[]}getContextResolverDescriptors(){return this._contextDescriptors}register(r){this._contextDescriptors.push(r)}},jn=new fW;var Ghe=q(Ct()),x2=q(Ue());var hI=q(Ehe()),m2=require("path");var f2=class{constructor(e,r){this.prev=null;this.next=null;this.key=e,this.value=r}},Bl=class{constructor(e=10){if(e<1)throw new Error("Cache size must be at least 1");this._capacity=e,this._cache=new Map,this._head=new f2("",null),this._tail=new f2("",null),this._head.next=this._tail,this._tail.prev=this._head}_addNode(e){e.prev=this._head,e.next=this._head.next,this._head.next.prev=e,this._head.next=e}_removeNode(e){let r=e.prev,n=e.next;r.next=n,n.prev=r}_moveToHead(e){this._removeNode(e),this._addNode(e)}_popTail(){let e=this._tail.prev;return this._removeNode(e),e}clear(){this._cache.clear(),this._head.next=this._tail,this._tail.prev=this._head}deleteKey(e){let r=this._cache.get(e);if(r)return this._removeNode(r),this._cache.delete(e),r.value}get(e){let r=this._cache.get(e);if(r)return this._moveToHead(r),r.value}keys(){let e=[],r=this._head.next;for(;r!==this._tail;)e.push(r.key),r=r.next;return e}getValues(){let e=[],r=this._head.next;for(;r!==this._tail;)e.push(r.value),r=r.next;return e}put(e,r){let n=this._cache.get(e);if(n)n.value=r,this._moveToHead(n);else if(n=new f2(e,r),this._cache.set(e,n),this._addNode(n),this._cache.size>this._capacity){let o=this._popTail();return this._cache.delete(o.key),[o.key,o.value]}}},LF=class{constructor(e){this.actual=new Bl(e)}dispose(){this.clear()}clear(){let e=this.actual.getValues();for(let r of e)r.dispose();this.actual.clear()}deleteKey(e){let r=this.actual.deleteKey(e);r&&r.dispose()}get(e){return this.actual.get(e)}keys(){return this.actual.keys()}getValues(){return this.actual.getValues()}put(e,r){let n=this.actual.put(e,r);n&&n[1].dispose()}};var khe=require("fs");function whe(t,e){let r=0,n=0,o;do o=t.readUInt8(e+n),r|=(o&127)<<n*7,n++;while(o&128);return{value:r,consumed:n}}var Rhe=t=>{let e=(0,khe.readFileSync)(t),r=new Map;for(let n=0;n<e.length;){let o=whe(e,n);n+=o.consumed,r.set(e.subarray(n,n+o.value),r.size),n+=o.value}return r};var _r=ne("ITokenizerProvider"),Phe=3,YHe=3,QHe=1,OF=class{constructor(){let e=(0,m2.basename)(__dirname)==="dist"?Rhe:r=>r;this._cl100kTokenizer=new MF((0,m2.join)(__dirname,"./cl100k_base.tiktoken"),"cl100k_base",e),this._o200kTokenizer=new MF((0,m2.join)(__dirname,"./o200k_base.tiktoken"),"o200k_base",e)}get cl100kTokenizer(){return this._cl100kTokenizer}acquireTokenizer(e){let r=e.family;return r==="gpt-4o"||r==="gpt-4o-mini"||r.startsWith("o1")?this._o200kTokenizer:this._cl100kTokenizer}},MF=class{constructor(e,r,n){this._tokenFilePath=e;this._encoderName=r;this._parser=n;this._cache=new Bl(5e3);this.baseTokensPerMessage=YHe;this.baseTokensPerName=QHe}tokenize(e){return this._tokenizer||(this._tokenizer=this.initTokenizer()),this._tokenizer.encode(e)}tokenLength(e){if(!e)return 0;let r=this._cache.get(e);return r||(r=this.tokenize(e).length,this._cache.put(e,r)),r}countMessageTokens(e){return this.baseTokensPerMessage+this.countObjectTokens(e)}countObjectTokens(e){let r=0;for(let[n,o]of Object.entries(e))o&&(typeof o=="string"?r+=this.tokenLength(o):o&&(r+=this.countObjectTokens(o)),n==="name"&&o!==void 0&&(r+=this.baseTokensPerName));return r}initTokenizer(){return(0,hI.createTokenizer)(this._parser(this._tokenFilePath),(0,hI.getSpecialTokensByEncoder)(this._encoderName),(0,hI.getRegexByEncoder)(this._encoderName),64e3)}};var FF=class t{static getIfVisualizationTestIsRunning(){if(h2.instance)return new t}decorateAndRegister(e,r){let n=!1;return e.render=async function(...o){let s=await Object.getPrototypeOf(e).render.apply(this,...o);return n||(n=!0,new ZW(e,r),h2.instance?.reload()),s},e}},ZW=class{constructor(e,r){this._renderer=e;h2.instance?.addData(`Prompt ${r}`,()=>this.getData())}getData(){class e{constructor(l,u,d){this.label=l;this.children=u;this.range=d;if(!d){let p=u.map(f=>f.range).filter(f=>!!f);if(p.length>0){d=[Number.MAX_SAFE_INTEGER,0];for(let f of p)d[0]=Math.min(d[0],f[0]),d[1]=Math.max(d[1],f[1]);this.range=d}}}toObj(){return{label:this.label,codicon:this.label==="Text"||this.label==="LineBreak"?"text-size":"symbol-class",range:this.range,children:this.children.map(l=>l.toObj())}}}let r=this._renderer,n="";function o(c){if(c.kind===0){let l=["SystemMessage","UserMessage","AssistantMessage"],u=c._obj.constructor.name;l.some(p=>u.indexOf(p)!==-1)&&(n+=`
======== ${u} ========
`);let d=c._children.map(p=>o(p)).filter(p=>p.label!=="LineBreak");return new e(u,d,void 0)}else if(c.kind===1){let l=n.length;return n=n+c.text,new e("Text",[],[l,n.length])}else if(c.kind===2){let l=n.length;return n=n+`
`,new e("LineBreak",[],[l,n.length])}throw new Error}return{root:o(r._root).toObj(),source:n,$fileExtension:"ast.w"}}},h2=class t{constructor(){this.g=globalThis;this._data=[];this.g.$$debugValueEditor_properties=[]}static{this._instance=void 0}static get instance(){return this._instance}static startRun(){this._instance=new t}addData(e,r){let n="debugValueProperty###"+e;globalThis[n]=r,this._data=[...this._data,{label:e,expression:`globalThis[${JSON.stringify(n)}]()`}],this.g.$$debugValueEditor_properties=this._data}reload(){this.g.$$debugValueEditor_refresh?.("{}")}};var y2=q(Ct());var Ye=q(require("vscode")),xr=Ye.Position,Be=Ye.Range,_p=Ye.Selection;var Ahe=Ye.CancellationTokenSource;var Nn=Ye.TextEdit,S_=Ye.WorkspaceEdit,nr=Ye.Uri,vo=Ye.MarkdownString;var gI=Ye.DiagnosticSeverity,nl=Ye.ExtensionMode,fn=Ye.Location;var ai=Ye.ChatResponseMarkdownPart,ud=Ye.ChatResponseFileTreePart,UF=Ye.ChatResponseAnchorPart,xi=Ye.ChatResponseProgressPart,Dhe=Ye.ChatResponseProgressPart2,BF=Ye.ChatResponseReferencePart,qF=Ye.ChatResponseReferencePart2,Nhe=Ye.ChatResponseCodeCitationPart,I_=Ye.ChatResponseCommandButtonPart,Lhe=Ye.ChatResponseWarningPart,jF=Ye.ChatResponseMovePart,Ohe=Ye.ChatResponseMarkdownWithVulnerabilitiesPart,Mhe=Ye.ChatResponseCodeblockUriPart,Da=Ye.ChatResponseTextEditPart,C_=Ye.ChatResponseConfirmationPart,Fhe=Ye.ChatResponseDetectedParticipantPart;var Uhe=Ye.ChatRequestTurn,Bhe=Ye.ChatResponseTurn,qhe=Ye.NewSymbolName,jhe=Ye.NewSymbolNameTag,g2=Ye.NewSymbolNameTriggerKind;var v2=Ye.ChatRequestEditorData,Vhe=Ye.ChatRequestNotebookData;var FDt={t:Ye.l10n.t};var eK=q(Ue()),Bo=q(Ue());var ql=class{toString(){return Object.getPrototypeOf(this).constructor.name}},xp=class{constructor(e,r){this.request=e;this.sessionId=r;this.status="in-progress";this.contextParts=[];this.references=[]}addReferences(e){this.references=VF([...this.references,...e])}},Sp=class{constructor(e=[]){this.turns=e}getLatestTurn(){return this.turns[this.turns.length-1]}addTurn(e){this.turns.forEach(r=>r.chatMessages=[]),this.turns.push(e)}};function VF(t){let e=new Nr,r=[],n=(s,a)=>{if(s.contains(a))return s;if(a.contains(s))return a;let[c,l]=s.start.line<a.start.line?[s,a]:[a,s];if(c.end.line>=l.start.line-1)return new Be(c.start,l.end)};return t.forEach(s=>{let a=s.anchor;if("variableName"in a)r.push(s);else if(!b2(a))e.set(a,s);else{let c=e.get(a.uri);if(!c)e.set(a.uri,[s]);else if(!(c instanceof eK.PromptReference)){let l=[],u=a.range;c.forEach(p=>{if("variableName"in p.anchor||!b2(p.anchor))return;let f=n(u,p.anchor.range);f?u=f:l.push(p.anchor)});let d={uri:a.uri,range:u};e.set(a.uri,[...l,d].sort((p,f)=>p.range.start.line-f.range.start.line||p.range.end.line-f.range.end.line).map(p=>new eK.PromptReference(p)))}}}),[...Array.from(e.keys()).sort((s,a)=>s.fsPath.localeCompare(a.fsPath)).map(s=>{let a=e.get(s);return a||[]}).flat(),...r]}function b2(t){return typeof t=="object"&&t!==null&&"uri"in t&&"range"in t}function HF(t,e=!0){switch(t){case"snippy":return e?y2.t({message:"Sorry, the response matched public code so it was blocked. Please rephrase your prompt. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):y2.t("Sorry, the response matched public code so it was blocked. Please rephrase your prompt.");default:return e?y2.t({message:"Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):y2.t("Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again.")}}var st=(n=>(n[n.InlineChat=1]="InlineChat",n[n.PanelChat=2]="PanelChat",n[n.Other=3]="Other",n))(st||{});(r=>{function t(n){switch(n){case 1:return"conversationInline";case 2:return"conversationPanel";default:return"none"}}r.toString=t;function e(n){switch(n){case 1:return"inline";case 2:return"panel";default:return"none"}}r.toStringShorter=e})(st||={});var St=class t{constructor(e,r){this.start=e;this.endExclusive=r;if(e>r)throw new yr(`Invalid range: ${this.toString()}`)}static addRange(e,r){let n=0;for(;n<r.length&&r[n].endExclusive<e.start;)n++;let o=n;for(;o<r.length&&r[o].start<=e.endExclusive;)o++;if(n===o)r.splice(n,0,e);else{let s=Math.min(e.start,r[n].start),a=Math.max(e.endExclusive,r[o-1].endExclusive);r.splice(n,o-n,new t(s,a))}}static tryCreate(e,r){if(!(e>r))return new t(e,r)}static ofLength(e){return new t(0,e)}static ofStartAndLength(e,r){return new t(e,e+r)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new t(this.start+e,this.endExclusive+e)}deltaStart(e){return new t(this.start+e,this.endExclusive)}deltaEnd(e){return new t(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new t(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(r<=n)return new t(r,n)}intersects(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<n}intersectsOrTouches(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new yr(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new yr(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let r=[];for(let n=this.start;n<this.endExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.start;r<this.endExclusive;r++)e(r)}};var dd=class t{static{this.chatRequestScheme="ccreq"}static buildUri(e){return e.kind==="latest"?`${t.chatRequestScheme}:latestrequest.copilotmd`:`${t.chatRequestScheme}:${e.id}.copilotmd`}static parseUri(e){if(e===t.buildUri({kind:"latest"}))return{kind:"latest"};{let r=e.match(/ccreq:([^\s]+)\.copilotmd/);if(r)return{kind:"request",id:r[1]}}}static findAllUris(e){let r=/(ccreq:[^\s]+\.copilotmd)/g;return[...e.matchAll(r)].map(n=>{let o=n[1];return{uri:o,range:new St(n.index,n.index+o.length)}})}};var il=ne("IRequestLogger");var GF=class extends Oe{get promptRendererTracing(){return!1}logChatRequest(e,r,n){return new tK(this,e,r,n)}},tK=class{constructor(e,r,n,o){this._logbook=e;this._debugName=r;this._chatEndpoint=n;this._chatParams=o;this._timeToFirstToken=void 0;this._time=new Date}markTimeToFirstToken(e){this._timeToFirstToken=e}resolve(e,r){e.type==="success"?this._logbook.addEntry({type:"ChatMLSuccess",debugName:this._debugName,chatEndpoint:this._chatEndpoint,chatParams:this._chatParams,startTime:this._time,endTime:new Date,timeToFirstToken:this._timeToFirstToken,result:e,deltas:r}):this._logbook.addEntry({type:"ChatMLFailure",debugName:this._debugName,chatEndpoint:this._chatEndpoint,chatParams:this._chatParams,startTime:this._time,endTime:new Date,timeToFirstToken:this._timeToFirstToken,result:e})}resolveWithCancelation(){this._logbook.addEntry({type:"ChatMLCancelation",debugName:this._debugName,chatEndpoint:this._chatEndpoint,chatParams:this._chatParams,startTime:this._time,endTime:new Date})}};var us=class{constructor(e,r,n){this.intent=e;this.location=r;this.endpoint=n}async buildPrompt(e,r,n){return await(await this.createRenderer(e,this.endpoint,r,n)).render(r,n)}},Me=class extends x2.PromptRenderer{constructor(r,n,o,s={validate:!0},a,c,l){let u=a.acquireTokenizer(r);super(r,n,o,u);this.endpoint=r;this.options=s;this._instantiationService=c;this._requestLogger=l;l.promptRendererTracing&&(this.ctorName=n.name||"<anonymous>",this.tracer=new x2.HTMLTracer)}static create(r,n,o,s,a={validate:!0}){return r.invokeFunction(c=>{let l=c.get(_r),u=new Me(n,o,s,a,l,r,c.get(il)),d=FF.getIfVisualizationTestIsRunning();return d&&(u=d.decorateAndRegister(u,o.name)),u})}createElement(r,...n){return this._instantiationService.createInstance(r.ctor,r.props,...n)}async render(r,n){let o=await super.render(r,n);this.tracer&&this._requestLogger.addPromptTrace(this.ctorName,this.endpoint,o,this.tracer.toHTML());let s=o.messages[o.messages.length-1];if(this.options.validate&&s&&s.role!=="user"&&s.role!=="function")throw new Error(Ghe.t("Sorry, this message is too long. Please try a shorter question."));return{...o,references:VF(o.references)}}async countTokens(r){return(await super.render(void 0,r)).tokenCount}};Me=E([y(4,_r),y(5,j),y(6,il)],Me);async function yo(t,e,r,n,o,s,a){let c=Me.create(t,e,r,n,a),{messages:l,tokenCount:u,references:d}=await c.render(o,s),p=c.getAllMeta();return{messages:l,tokenCount:u,metadatas:p,references:VF(d)}}var _2=class extends x2.PromptRenderer{constructor(r,n,o,s){let a={countMessageTokens(c){throw new Error("Tools may only return text, not messages.")},tokenLength(c,l){return Promise.resolve(o?.countTokens(c,l)??Promise.resolve(1))}};super({modelMaxPromptTokens:o?.tokenBudget??Number.MAX_SAFE_INTEGER},r,n,a);this.instantiationService=s}createElement(r,...n){return this.instantiationService.createInstance(r.ctor,r.props,...n)}};_2=E([y(3,j)],_2);async function zhe(t,e,r,n,o){return await t.createInstance(_2,e,r,n).renderElementJSON(o)}var WF=q(Ue());var Khe=require("util");var mr=ne("IFileSystemService");async function $he(t,e,r){let n=e.textDocuments.find(s=>s.uri.toString()===r.toString());if(n)return n.getText();let o=await t.readFile(r);return new TextDecoder().decode(o)}var Whe=new class{constructor(){this._cache=null}enable(){this._cache=new Bl(10)}async readJSON(t,e){if(!this._cache)return this._readJSON(t,e);let r=this._cache.get(e.toString());if(r!==void 0)return r;let n=await this._readJSON(t,e);return this._cache.put(e.toString(),n),n}async _readJSON(t,e){let r=await t.readFile(e);return JSON.parse(r.toString())}};var qe=ne("IWorkspaceService"),zF=class{getWorkspaceFolder(e){return this.getWorkspaceFolders().find(r=>r.scheme===e.scheme&&r.authority===e.authority&&e.fsPath.startsWith(r.fsPath))}};function vI(t,e){let r=t.getWorkspaceFolder(e);return r?Lr.relative(r.path,e.path):e.path}var $F=ne("IPromptWorkspaceLabels");var yI=class{constructor(e,r,n,o){this._experimentationService=e;this._configurationService=r;this._telemetryService=n;this._instantiationService=o;this.strategy=0;this.basicWorkspaceLabels=this._instantiationService.createInstance(bI),this.expandedWorkspaceLabels=this._instantiationService.createInstance(S2)}get workspaceLabels(){return this.strategy===0?this.basicWorkspaceLabels:this.expandedWorkspaceLabels}get labels(){return[...new Set(this.workspaceLabels.labels)].sort()}async collectContext(){let e=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsExpanded,this._experimentationService);this.strategy=e?1:0,await this.workspaceLabels.collectContext();let r=[...new Set(this.labels)].sort();this._telemetryService.sendMSFTTelemetryEvent("projectLabels",{labels:r.join(",").replaceAll("@"," ")},{count:r.length})}};yI=E([y(0,Lt),y(1,he),y(2,ge),y(3,j)],yI);var bI=class{constructor(e,r,n){this._workspaceService=e;this._fileSystemService=r;this._ignoreService=n;this.indicators=new Map;this.contentIndicators=new Map;this._labels=[];this.initIndicators()}get labels(){if(this._labels.includes("javascript")&&this._labels.includes("typescript")){let e=this._labels.indexOf("javascript");this._labels.splice(e,1)}return this._labels}async collectContext(){let e=this._workspaceService.getWorkspaceFolders();if(e)for(let r=0;r<e.length;r++)await this.addContextForFolders(e[r])}async addContextForFolders(e){for(let[r,n]of this.indicators.entries())await this.addLabelIfApplicable(e,r,n)}async addLabelIfApplicable(e,r,n){let o=nr.joinPath(e,r);if(!await this._ignoreService.isCopilotIgnored(o))try{await this._fileSystemService.stat(o),n.forEach(a=>this._labels.push(a));let s=this.contentIndicators.get(r);if(s){let a=await this._fileSystemService.readFile(o);try{s(new Khe.TextDecoder().decode(a)).forEach(l=>this._labels.push(l))}catch{}}}catch{}}initIndicators(){this.addIndicator("package.json","javascript","npm"),this.addIndicator("tsconfig.json","typescript"),this.addIndicator("pom.xml","java","maven"),this.addIndicator("build.gradle","java","gradle"),this.addIndicator("requirements.txt","python","pip"),this.addIndicator("Pipfile","python","pip"),this.addIndicator("Cargo.toml","rust","cargo"),this.addIndicator("go.mod","go","go.mod"),this.addIndicator("pubspec.yaml","dart","pub"),this.addIndicator("build.sbt","scala","sbt"),this.addIndicator("build.boot","clojure","boot"),this.addIndicator("project.clj","clojure","lein"),this.addIndicator("mix.exs","elixir","mix"),this.addIndicator("composer.json","php","composer"),this.addIndicator("Gemfile","ruby","bundler"),this.addIndicator("build.xml","java","ant"),this.addIndicator("build.gradle.kts","java","gradle"),this.addIndicator("yarn.lock","yarn"),this.addIndicator("CMakeLists.txt","c++","cmake"),this.addIndicator("vcpkg.json","c++"),this.addIndicator("Makefile","c++","makefile"),this.addContentIndicator("CMakeLists.txt",this.collectCMakeListsTxtIndicators),this.addContentIndicator("package.json",this.collectPackageJsonIndicators)}addIndicator(e,...r){this.indicators.set(e,r)}addContentIndicator(e,r){this.contentIndicators.set(e,r)}collectCMakeListsTxtIndicators(e){function r(a,c,l){try{let u=Array.from(a.matchAll(c));if(u&&u[0]&&u[0][1]){let d=parseInt(u[0][1]);if(l.includes(d))return d}}catch{}}let n=[],o=r(e,/set\s*\(\s*CMAKE_CXX_STANDARD\s*(\d+)/gmi,[98,11,14,17,20,23,26]);o&&n.push(`C++${o}`);let s=r(e,/set\s*\(\s*CMAKE_C_STANDARD\s*(\d+)/gmi,[90,99,11,17,23]);return s&&n.push(`C${s}`),n}collectPackageJsonIndicators(e){let r=[],n=JSON.parse(e),o=n.dependencies,s=n.devDependencies;o&&(o["@angular/core"]&&r.push("angular"),o.react&&r.push("react"),o.vue&&r.push("vue")),s&&s.typescript&&r.push("typescript");let a=n.engines;return a&&(a.node&&r.push("node"),a.vscode&&r.push("vscode extension")),r}};bI=E([y(0,qe),y(1,mr),y(2,Te)],bI);var S2=class extends bI{constructor(r,n,o){super(r,n,o);this.popularPackages=["numpy","pandas","scipy","scikit-learn","matplotlib","tensorflow","keras","torch","seaborn","plotly","dash","jupyter","notebook","ipython","openai","pyspark","airflow","nltk","sympy","spacy","langchain","Flask","Django","fastapi","pydantic","requests","beautifulsoup4","gunicorn","uvicorn","httpx","Jinja2","aiohttp","pytest","tox","nox","selenium","playwright","coverage","hypothesis","Sphinx","celery","asyncio","boto3","google-cloud-storage","azure-storage-blob","docker","kubernetes","azure","google","ansible","cryptography","paramiko","PyJWT","xlrd","xlrd-2024","openpyxl","pywin32","pywin","psycopg2","mysqlclient","SQLite4","Werkzeug","pymongo","redis","PyMySQL","Pillow","SQLAlchemy","lxml","html5lib","Markdown","pytz","Click","attrs","PyYAML","configparser","loguru","structlog","pygame","discord"];this.addContentIndicator("package.json",this.collectPackageJsonIndicatorsExpanded),this.addContentIndicator("requirements.txt",this.collectPythonRequirementsIndicators),this.addContentIndicator("pyproject.toml",this.collectPythonTomlIndicators)}collectPackageJsonIndicatorsExpanded(r){let n=[],o=d=>{let[p,f]=d.split(".");return`${p.replace(/[^0-9]/g,"")}.${f.replace(/[^0-9]/g,"")}`},s=(d,p)=>{d&&p.forEach(({dependency:f,prefix:m})=>{if(d[f]){let h=o(d[f]);n.push(`${m||f}@${h}`)}})},a;try{a=JSON.parse(r)}catch{return n}let c=[a.dependencies,a.devDependencies,a.peerDependencies,a.optionalDependencies],l=[{dependency:"react"},{dependency:"vue"},{dependency:"@angular/core"},{dependency:"svelte"},{dependency:"solid-js"},{dependency:"alpinejs"},{dependency:"redux"},{dependency:"mobx"},{dependency:"vuex"},{dependency:"ngrx"},{dependency:"antd"},{dependency:"bootstrap"},{dependency:"bulma"},{dependency:"@mui/material"},{dependency:"semantic-ui-react"},{dependency:"next"},{dependency:"gatsby"},{dependency:"remix"},{dependency:"astro"},{dependency:"sveltekit"},{dependency:"nuxt"},{dependency:"jest"},{dependency:"mocha"},{dependency:"cypress"},{dependency:"@testing-library/react"},{dependency:"@playwright/test"},{dependency:"vitest"},{dependency:"@storybook/react"},{dependency:"tailwindcss"},{dependency:"sass"},{dependency:"styled-components"},{dependency:"css-modules"},{dependency:"postcss"},{dependency:"@emotion/react"},{dependency:"vite"},{dependency:"webpack"},{dependency:"parcel"},{dependency:"rollup"},{dependency:"snowpack"},{dependency:"esbuild"},{dependency:"@swc/core"},{dependency:"socket.io"},{dependency:"d3"},{dependency:"graphql"},{dependency:"lodash"},{dependency:"moment"},{dependency:"rxjs"},{dependency:"underscore"},{dependency:"gulp"},{dependency:"backbone"},{dependency:"ember-source"},{dependency:"handlebars"},{dependency:"jquery"},{dependency:"knockout"},{dependency:"aws-sdk"},{dependency:"cloudinary"},{dependency:"firebase"},{dependency:"@azure/storage-blob"},{dependency:"@google-cloud/storage"},{dependency:"@aws-lambda"},{dependency:"@azure/functions"},{dependency:"@google-cloud/functions"},{dependency:"firebase-functions"},{dependency:"@azure/cosmos"},{dependency:"@google-cloud/firestore"},{dependency:"mongoose"},{dependency:"dockerode"},{dependency:"kubernetes-client"},{dependency:"@elastic/elasticsearch"},{dependency:"@sentry/node"},{dependency:"log4js"},{dependency:"winston"},{dependency:"bcrypt"},{dependency:"helmet"},{dependency:"jsonwebtoken"},{dependency:"passport"},{dependency:"@azure/identity"},{dependency:"@azure/keyvault-certificates"},{dependency:"@azure/keyvault-keys"},{dependency:"@azure/keyvault-secrets"},{dependency:"@azure/service-bus"},{dependency:"@azure/event-hubs"},{dependency:"@azure/data-tables"},{dependency:"@azure/monitor-query"},{dependency:"@azure/app-configuration"},{dependency:"babel"},{dependency:"eslint"},{dependency:"parcel"},{dependency:"prettier"},{dependency:"rollup"},{dependency:"typescript"},{dependency:"webpack"},{dependency:"vite"}],u=[{dependency:"node"},{dependency:"vscode",prefix:"vscode extension"}];return c.forEach(d=>s(d,l)),s(a.engines,u),n}collectPythonRequirementsIndicators(r){let n=[];return r.split(`
`).forEach(s=>{let[a,c]=s.split("==");this.popularPackages.includes(a)&&n.push(`${a}-${c||"latest"}`)}),n}collectPythonTomlIndicators(r){let n=[],o=r.split(`
`),s=!1;return o.forEach(a=>{if(a=a.trim(),a==="[tool.poetry.dependencies]")s=!0;else if(a.startsWith("[")&&a.endsWith("]"))s=!1;else if(s&&a){let[c,l]=a.split("=").map(u=>u.trim().replace(/"|'/g,""));this.popularPackages.includes(c)&&n.push(`${c}-${l||"latest"}`)}}),n}};S2=E([y(0,qe),y(1,mr),y(2,Te)],S2);var Yhe=q(Ue()),ia=class extends Yhe.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};var qi=class extends WF.PromptElement{constructor(r,n){super(r);this.workspaceLabels=n}async render(r,n){await this.workspaceLabels.collectContext();let o=this.workspaceLabels.labels;if(o.length!==0)return this.props.embeddedInsideUserMessage?vscpp(ia,{priority:this.props.priority},"<projectLabels>",this._render(o),"</projectLabels>"):vscpp(WF.UserMessage,{priority:this.props.priority},this._render(o))}_render(r){return vscpp(vscppf,null,"I am working on a project of the following nature:",vscpp("br",null),r.reduce((n,o)=>`${n}
- ${o}`,"").trim())}};qi=E([y(1,$F)],qi);var I2=class{constructor(e){this._instantiationService=e;this.kind="project-labels"}async resolveContext(e){let{messages:r}=await yo(this._instantiationService,e.endpoint,qi,{});if(r.length>0)return{kind:this.kind,userMessages:r.map(n=>n.content)}}};I2=E([y(0,j)],I2);jn.register(new ye(I2));var jt=q(require("vscode"));var Qhe="https://aka.ms/microsoft/vscode-copilot-release",en=ne("IDomainService");var Vl=ne("IGithubRepositoryService"),KF=ne("IOctoKitService"),Xhe=1682102,dv=class{constructor(e,r){this._domainService=e;this._fetcherService=r}async getCurrentAuthedUserWithToken(e){return this._makeGHAPIRequest("user","GET",e)}async getTeamMembershipWithToken(e,r,n){return this._makeGHAPIRequest(`teams/${e}/memberships/${n}`,"GET",r)}async _makeGHAPIRequest(e,r,n,o){let s=await this._fetcherService.fetch(`${this._domainService.dotComAPIURL}/${e}`,{method:r,headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${n}`},body:o?JSON.stringify(o):void 0});if(s.ok)try{return await s.json()}catch{return}}};var C2=class extends dv{async getCurrentAuthedUserWithToken(e){return{avatar_url:"",login:"NullUser",name:"Null User"}}async getTeamMembershipWithToken(e,r,n){}async _makeGHAPIRequest(e,r,n,o){}};var Kr=ne("IFetcherService"),pv=class{constructor(e,r,n,o,s,a){this.status=e;this.statusText=r;this.headers=n;this.getText=o;this.getJson=s;this.getBody=a;this.ok=this.status>=200&&this.status<300}async text(){return this.getText()}async json(){return this.getJson()}async body(){return this.getBody()}};var ir=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let t;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?t=crypto.getRandomValues.bind(crypto):t=function(n){for(let o=0;o<n.length;o++)n[o]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),r=[];for(let n=0;n<256;n++)r.push(n.toString(16).padStart(2,"0"));return function(){t(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let o=0,s="";return s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s}}();var ci=class t{static{this.keysExemptedFromSanitization=["VSCode.ABExp.Features","abexp.assignmentcontext"]}constructor(e,r,n){this.properties=e,this.measurements=r,this.issuedTime=n}static createAndMarkAsIssued(e,r){return new t(e||{},r||{},Date.now())}extendedBy(e,r){let n={...this.properties,...e},o={...this.measurements,...r},s=new t(n,o,this.issuedTime);return s.displayedTime=this.displayedTime,s}markAsDisplayed(){this.displayedTime===void 0&&(this.displayedTime=Date.now())}extendWithEditorAgnosticFields(e){this.properties.editor_version=e.getEditorInfo().format(),this.properties.editor_plugin_version=e.getEditorPluginInfo().format(),this.properties.client_machineid=e.machineId,this.properties.client_sessionid=e.sessionId,this.properties.copilot_version=`copilot/${e.getVersion()}`,this.properties.common_extname=e.getEditorPluginInfo().name,this.properties.common_extversion=e.getEditorPluginInfo().version,this.properties.common_vscodeversion=e.getEditorInfo().format()}extendWithConfigProperties(e,r,n){let o=e.dumpConfig();o["copilot.build"]=r.getBuild(),o["copilot.buildType"]=r.getBuildType(),n.trackingId&&(o["copilot.trackingId"]=n.trackingId),n.organizationsList&&(o.organizations_list=n.organizationsList),this.properties={...this.properties,...o}}extendWithRequestId(e){let r={completionId:e.completionId,created:e.created.toString(),headerRequestId:e.headerRequestId,serverExperiments:e.serverExperiments,deploymentId:e.deploymentId};this.properties={...this.properties,...r}}static{this.keysToRemoveFromStandardTelemetryHack=["gitRepoHost","gitRepoName","gitRepoOwner","gitRepoUrl","gitRepoPath","repo","request_option_nwo","userKind"]}static maybeRemoveRepoInfoFromPropertiesHack(e,r){if(e)return r;let n={};for(let o in r)t.keysToRemoveFromStandardTelemetryHack.includes(o)||(n[o]=r[o]);return n}sanitizeKeys(){this.properties=t.sanitizeKeys(this.properties),this.measurements=t.sanitizeKeys(this.measurements)}static sanitizeKeys(e){e=e||{};let r={};for(let n in e){let o=t.keysExemptedFromSanitization.includes(n)?n:n.replace(/\./g,"_");r[o]=e[n]}return r}updateTimeSinceIssuedAndDisplayed(){let e=Date.now()-this.issuedTime;if(this.measurements.timeSinceIssuedMs=e,this.displayedTime!==void 0){let r=Date.now()-this.displayedTime;this.measurements.timeSinceDisplayedMs=r}}makeReadyForSending(e,r,n){this.extendWithConfigProperties(e,r,n),this.extendWithEditorAgnosticFields(r),this.sanitizeKeys(),this.updateTimeSinceIssuedAndDisplayed();for(let o in this.properties)this.properties[o]===void 0&&delete this.properties[o];XHe(r,this.properties)}};function Jhe(t){if(!t)return;let e={};for(let r in t){let n=t[r];n&&(n.value?e[r]=n.value:e[r]=n)}return e}function XHe(t,e){e.unique_id=ir(),e.common_extname=t.getEditorPluginInfo().name,e.common_extversion=t.getEditorPluginInfo().version,e.common_vscodeversion=t.getEditorInfo().format()}var T_=class{constructor(e){this._info=e;this.tokenMap=this.parseToken(e.token)}parseToken(e){let r=new Map,o=e?.split(":")[0]?.split(";");for(let s of o){let[a,c]=s.split("=");r.set(a,c)}return r}get token(){return this._info.token}get sku(){return this._info.sku}get organizationList(){return this._info.organization_list||[]}get enterpriseList(){return this._info.enterprise_list||[]}get endpoints(){return this._info.endpoints||{api:"https://api.githubcopilot.com",telemetry:"https://copilot-telemetry.githubusercontent.com"}}get isInternal(){let e=["4535c7beffc844b46bb1ed4aa04d759a","a5db0bcaae94032fe715fb34a5e4bce2","7184f66dfcee98cb5f08a1cb936d5225","1cb18ac6eedd49b43d74a1c5beb0b955"];for(let r of this.organizationList)if(e.includes(r))return!0;return!1}get isVscodeTeamMember(){return this._info.isVscodeTeamMember}get username(){return this._info.username}isTelemetryEnabled(){return this._isTelemetryEnabled===void 0&&(this._isTelemetryEnabled=this._info.telemetry==="enabled"),this._isTelemetryEnabled}isPublicSuggestionsEnabled(){return this._isPublicSuggestionsEnabled===void 0&&(this._isPublicSuggestionsEnabled=this._info.public_suggestions==="enabled"),this._isPublicSuggestionsEnabled}isChatEnabled(){return this._info.chat_enabled??!1}isCopilotIgnoreEnabled(){return this._info.copilotignore_enabled??!1}getTokenValue(e){return this.tokenMap.get(e)}};var w_=ne("ICopilotTokenManager");function fv(){return Math.floor(Date.now()/1e3)}var xI=class extends Oe{constructor(r,n,o,s,a,c){super();this._baseOctokitservice=r;this._logService=n;this._telemetryService=o;this._domainService=s;this._fetcherService=a;this._envService=c;this._refreshDelayer=this._register(new Jg(1e3));this._isDisposed=!1;this._copilotTokenRefreshEmitter=this._register(new Yt);this.onDidCopilotTokenRefresh=this._copilotTokenRefreshEmitter.event;this._register(Zi(()=>this._isDisposed=!0))}get copilotToken(){return this._copilotToken}set copilotToken(r){r!==this._copilotToken&&(this._copilotToken=r,this._copilotTokenRefreshEmitter.fire(),r&&this._refreshToken(r.refresh_in))}resetCopilotToken(r){r!==void 0&&this._telemetryService.sendGHTelemetryEvent("auth.reset_token_"+r),this._logService.public.debug(`Resetting copilot token on HTTP error ${r||"unknown"}`),this.copilotToken=void 0}async authFromGitHubToken(r){this._telemetryService.sendGHTelemetryEvent("auth.new_login");let n=await this.fetchCopilotToken(r);if(!n)return this._logService.public.warn("Failed to get copilot token"),this._telemetryService.sendGHTelemetryErrorEvent("auth.request_failed"),{kind:"failure",reason:"FailedToGetToken"};let o=await n.json();if(!o)return this._logService.public.warn("Failed to get copilot token"),this._telemetryService.sendGHTelemetryErrorEvent("auth.request_read_failed"),{kind:"failure",reason:"FailedToGetToken"};if(n.status===401)return this._logService.public.warn("Failed to get copilot token due to 401 status"),this._telemetryService.sendGHTelemetryErrorEvent("auth.unknown_401"),{kind:"failure",reason:"HTTP401"};if(n.status===403&&o.message?.startsWith("API rate limit exceeded"))return this._logService.public.warn("Failed to get copilot token due to exceeding API rate limit"),this._telemetryService.sendGHTelemetryErrorEvent("auth.rate_limited"),{kind:"failure",reason:"RateLimited"};if(!n.ok||!o.token){this._logService.public.warn(`Invalid copilot token: missing token: ${n.status} ${n.statusText}`);let p=ci.createAndMarkAsIssued({status:n.status.toString(),status_text:n.statusText});return this._telemetryService.sendGHTelemetryErrorEvent("auth.invalid_token",p.properties,p.measurements),{kind:"failure",reason:"NotAuthorized",...o.error_details}}let s=o.expires_at;o.expires_at=fv()+o.refresh_in+60;let c=(await this._baseOctokitservice.getCurrentAuthedUserWithToken(r))?.login??"unknown",l=await this._baseOctokitservice.getTeamMembershipWithToken(Xhe,r,c),u={...o,username:c,isVscodeTeamMember:!!l},d=ci.createAndMarkAsIssued({},{adjusted_expires_at:o.expires_at,expires_at:s,current_time:fv()});return this._telemetryService.sendGHTelemetryEvent("auth.new_token",d.properties,d.measurements),{kind:"success",...u}}async _refreshToken(r){if(this._isDisposed)return;let n=fv();try{await this._refreshDelayer.trigger(async()=>{if(this._isDisposed)return;let o,s="";try{await this.getCopilotToken(!0),o="success"}catch(c){o="failure",s=c.toString()}let a=ci.createAndMarkAsIssued({result:o},{time_taken:fv()-n});s&&(a.properties.reason=s),this._telemetryService.sendGHTelemetryEvent("auth.token_refresh",a.properties,a.measurements)},r*1e3)}catch(o){if(o instanceof dn)return;throw o}}async fetchCopilotToken(r){let n=this._domainService.tokenURL;return await this._fetcherService.fetch(n,{headers:{Authorization:`token ${r}`,...this._envService.getEditorVersionHeaders()}})}},_I=class extends xI{constructor(r,n,o,s,a,c){super(new C2(s,a),n,o,s,a,c);this._completionsToken=r;this.copilotToken={token:r,expires_at:0,refresh_in:0,username:"fixedTokenManager",isVscodeTeamMember:!1}}set completionsToken(r){this._completionsToken=r,this.copilotToken={token:r,expires_at:0,refresh_in:0,username:"fixedTokenManager",isVscodeTeamMember:!1}}get completionsToken(){return this._completionsToken}async getCopilotToken(){return new T_(this.copilotToken)}async checkCopilotToken(){return{status:"OK"}}};_I=E([y(1,ie),y(2,ge),y(3,en),y(4,Kr),y(5,gt)],_I);var E_=class extends xI{constructor(r,n,o,s,a,c,l){super(new C2(s,a),n,o,s,a,c);this.githubToken=r;this.configurationService=l}async getCopilotToken(r){if(!this.copilotToken||this.copilotToken.expires_at<fv()||r){let n=await this.authFromGitHubToken(this.githubToken);if(n.kind==="failure")throw Error(`Failed to get copilot token: ${n.reason.toString()} ${n.message??""}`);this.copilotToken={...n}}return new T_(this.copilotToken)}async checkCopilotToken(){if(!this.copilotToken||this.copilotToken.expires_at<fv()){let n=await this.authFromGitHubToken(this.githubToken);if(n.kind==="failure")return n;this.copilotToken={...n}}return{status:"OK"}}};E_=E([y(1,ie),y(2,ge),y(3,en),y(4,Kr),y(5,gt),y(6,he)],E_);var rK=["user:email"],Zhe=["read:user"],YF=["read:user","user:email","repo","workflow"],Tt=ne("IAuthenticationService"),SI=class extends Oe{constructor(r,n,o){super();this._logService=r;this._tokenStore=n;this._tokenManager=o;this._onDidAuthenticationChange=this._register(new Yt);this.onDidAuthenticationChange=this._onDidAuthenticationChange.event;this._onDidAccessTokenChange=this._register(new Yt);this.onDidAccessTokenChange=this._onDidAccessTokenChange.event;this._register(o.onDidCopilotTokenRefresh(()=>{this._logService.internal.debug("Handling CopilotToken refresh."),this._handleAuthChangeEvent()}))}get anyGitHubSession(){return this._anyGitHubSession}get permissiveGitHubSession(){return this._permissiveGitHubSession}get copilotToken(){return this._tokenStore.copilotToken}async getCopilotToken(r){try{await this.getAnyGitHubSession({silent:!0});let n=await this._tokenManager.getCopilotToken(r);return this._tokenStore.copilotToken=n,this._copilotTokenError=void 0,n}catch(n){this._tokenStore.copilotToken=void 0;let o=this._copilotTokenError;throw this._copilotTokenError=n,o&&n&&o.message!==n.message&&this._onDidAuthenticationChange.fire(),n}}resetCopilotToken(r){this._tokenStore.copilotToken=void 0,this._tokenManager.resetCopilotToken(r)}async _handleAuthChangeEvent(){let r=this._anyGitHubSession,n=this._permissiveGitHubSession,o=this._tokenStore.copilotToken,s=this._copilotTokenError,a=await Promise.allSettled([this.getAnyGitHubSession({silent:!0}),this.getPermissiveGitHubSession({silent:!0})]);for(let c of a)c.status==="rejected"&&this._logService.public.error(`Error getting a session: ${c.reason}`);if(r?.accessToken!==this._anyGitHubSession?.accessToken||n?.accessToken!==this._permissiveGitHubSession?.accessToken){this._onDidAccessTokenChange.fire(),this._logService.internal.debug("Auth state changed, minting a new CopilotToken...");try{await this.getCopilotToken(!0)}catch{}this._logService.internal.debug("Minted a new CopilotToken.");return}try{await this.getCopilotToken()}catch{}(o?.token!==this._tokenStore.copilotToken?.token||s?.message!==this._copilotTokenError?.message)&&(this._logService.internal.debug("CopilotToken state changed, firing event."),this._onDidAuthenticationChange.fire()),this._logService.internal.debug("Finished handling auth change event.")}};SI=E([y(0,ie),y(1,ac),y(2,w_)],SI);var QF=ne("IChatAgentService"),ege="default",tge="editor",rge="workspace",nge="vscode",II="terminal",nK="github.copilot.";function CI(t){return`${nK}${t}`}function ige(t){return t.replace(/^github\.copilot\./,"")}var dc=ne("ConversationOptions");var XF=ne("IDevContainerConfigurationService");function T2(t){return t.capabilities.type==="chat"}function oge(t){return t.capabilities.type==="embeddings"}var xe=ne("IEndpointProvider");var Bm=ne("IWorkbenchService");var oa=ne("IEmbeddingsComputer"),JHe=.72;function oK(t,e,r,n){let o=t==="text-embedding-ada-002"?JHe:0;return r.map(([s,a])=>{let c=0;for(let l=0;l<a.length;l++)c+=a[l]*e[l];return{score:c,item:s}}).filter(s=>s.score>o).sort((s,a)=>a.score-s.score).slice(0,n).map(s=>s.item)}function mv(t,e){let r=t.reduce((s,a,c)=>s+a*e[c],0),n=Math.sqrt(t.reduce((s,a)=>s+a*a,0)),o=Math.sqrt(e.reduce((s,a)=>s+a*a,0));return r/(n*o)}var Bt=ne("IVSCodeExtensionContext");function ZHe(t){switch(t.model){case"text-embedding-3-small":return"text-3-small";default:return"text-ada-002"}}var TI=class{constructor(e,r,n,o,s){this.cacheType=e;this.cacheKey=r;this.cacheVersion=n;this.fileSystemService=o;this.extensionContext=s;this.cacheVersionKey=`${r}-version`}get cacheStorageUri(){return this.cacheType===2?this.extensionContext.storageUri:this.extensionContext.globalStorageUri}get cacheVersionMementoStorage(){return this.cacheType===2?this.extensionContext.workspaceState:this.extensionContext.globalState}async updateCache(e){if(!this.cacheStorageUri||e===void 0||!this.fileSystemService.isWritableFileSystem(this.cacheStorageUri.scheme))return;try{await this.fileSystemService.stat(this.cacheStorageUri)}catch(n){n.code==="ENOENT"&&await this.fileSystemService.createDirectory(this.cacheStorageUri)}await this.cacheVersionMementoStorage.update(this.cacheVersionKey,this.cacheVersion);let r=He.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`);try{await this.fileSystemService.writeFile(r,Buffer.from(JSON.stringify(e)))}catch{e!==void 0&&console.error(`Failed to write embeddings cache to ${r}`)}}async getCache(){if(!(!this.cacheStorageUri||this.cacheVersionMementoStorage.get(this.cacheVersionKey)!==this.cacheVersion))try{let r=await Whe.readJSON(this.fileSystemService,He.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`));return this.isEmbeddingCacheEntriesType(r)?this.constructExposedCache(r):r}catch{return}}async clearCache(){if(!this.cacheStorageUri)return;this.cacheVersionMementoStorage.get(this.cacheKey)&&await this.cacheVersionMementoStorage.update(this.cacheKey,void 0);let r=He.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`);try{await this.fileSystemService.stat(this.cacheStorageUri),await this.fileSystemService.delete(r,{useTrash:!1})}catch(n){if(n.code==="ENOENT")throw new Error(`Cache file ${r} does not exist`)}}isEmbeddingCacheEntriesType(e){return e.core!==void 0&&e.extensions!==void 0}constructExposedCache(e){let r={...e.core};for(let n in e.extensions){let o=e.extensions[n];for(let s in o)r[s]=o[s]}return r}};TI=E([y(3,mr),y(4,Bt)],TI);var pd=class{constructor(e,r,n,o){this.cacheKey=r;this.cacheVersion=n;this._embeddingsCache=o.createInstance(TI,e,r,n)}async getCache(){let e=await this._embeddingsCache.getCache();if(e===void 0)throw new Error(`Failed to get cache for ${this.cacheKey}, version ${this.cacheVersion}`);return e}clearCache(){return this._embeddingsCache.clearCache()}};pd=E([y(3,j)],pd);var Hl=class{constructor(e,r,n,o,s,a,c){this.cacheVersion=n;this.remoteCacheType=o;this.endpointProvider=s;this.fetcherService=a;this.embeddingsCache=c.createInstance(TI,e,r,n),this.remoteCacheVersionKey=`${r}-version-remote`}async clearCache(){await this.embeddingsCache.clearCache()}async getRemoteContainer(){let e=await this.endpointProvider.getEmbeddingsEndpoint("text3small");return ZHe(e)}async getRemoteCacheURL(){if(!this._remoteCacheURL){let e=await this.getRemoteContainer();this._remoteCacheURL=Hl.calculateRemoteCDNURL(e,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheURL}async getRemoteCacheLatestUpdateURL(){if(!this._remoteCacheLatestUpdateURL){let e=await this.getRemoteContainer();this._remoteCacheLatestUpdateURL=Hl.calculateRemoteCDNLatestURL(e,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheLatestUpdateURL}async fetchRemoteCache(){if(this._remoteCacheEntries)return this._remoteCacheEntries;let e=await this.getRemoteCacheURL();try{let r=await this.getRemoteCacheURL(),n=await this.fetcherService.fetch(r,{method:"GET"});if(n.ok)return this._remoteCacheEntries=await n.json(),this._remoteCacheEntries;console.error(`Failed to fetch remote embeddings cache from ${r}`),console.error(`Response status: ${n.status}, status text: ${n.statusText}`);return}catch(r){console.error(`Failed to fetch remote embeddings cache from ${e}`),console.error(r);return}}async fetchRemoteCacheLatest(){let e=await this.getRemoteCacheLatestUpdateURL();try{let r=await this.fetcherService.fetch(e,{method:"GET"});if(r.ok)return r.text();console.error(`Failed to fetch remote embeddings cache from ${e}`),console.error(`Response status: ${r.status}, status text: ${r.statusText}`);return}catch(r){console.error(`Failed to fetch remote embeddings cache from ${e}`),console.error(r);return}}async getCache(){let e=await this.fetchRemoteCacheLatest(),r=await this.embeddingsCache.getCache();if(r&&e===this.embeddingsCache.cacheVersionMementoStorage.get(this.remoteCacheVersionKey))return r;let n=await this.fetchRemoteCache();return n===void 0?r:(await this.embeddingsCache.clearCache(),await this.embeddingsCache.cacheVersionMementoStorage.update(this.remoteCacheVersionKey,e),await this.embeddingsCache.updateCache(n),n)}static calculateRemoteCDNURL(e,r,n){return`https://embeddings.vscode-cdn.net/${e}/v${n}/${r}/core.json`}static calculateRemoteCDNLatestURL(e,r,n){return`https://embeddings.vscode-cdn.net/${e}/v${n}/${r}/latest.txt`}};Hl=E([y(4,xe),y(5,Kr),y(6,j)],Hl);var fd=class extends Hl{constructor(r,n,o,s,a,c,l,u){super(r,n,o,s,a,c,u);this.workbenchService=l}async getBaseExtensionCDNURL(){if(!this._baseExtensionCDNURL){let r=await this.getRemoteContainer();this._baseExtensionCDNURL=fd.calculateBaseRemoteExtensionCDNURL(r,this.remoteCacheType,this.cacheVersion)}return this._baseExtensionCDNURL}constructExposedCache(){if(!this._remoteExtensionCache)return;let r={...this._remoteExtensionCache.core};for(let n in this._remoteExtensionCache.extensions){let o=this._remoteExtensionCache.extensions[n];for(let s in o)r[s]=o[s]}return r}async fetchRemoteExtensionCache(r){let o=`${await this.getBaseExtensionCDNURL()}/${r}.json`;try{let s=await this.fetcherService.fetch(o,{method:"GET"});if(s.ok)return await s.json();if(s.status===404)return{};console.error(`Failed to fetch remote embeddings cache from ${o}`),console.error(`Response status: ${s.status}, status text: ${s.statusText}`);return}catch(s){console.error(`Failed to fetch remote embeddings cache from ${o}`),console.error(s);return}}async getCache(){let r=await super.getCache();if(r===void 0)return;let n={core:{},extensions:{}};r&&fd.isEmbeddingsCacheEntriesWithExtensions(r)?n=r:n={core:r,extensions:{}};let o=fd.getInstalledExtensionIds(this.workbenchService),s=!1;for(let c in n.extensions)o.includes(c)||(delete n.extensions[c],s=!0);let a=o.filter(c=>!(c in n.extensions)||n.extensions[c]===void 0);for(let c of a){let l=await this.fetchRemoteExtensionCache(c);l&&(n.extensions[c]=l)}return this._remoteExtensionCache=n,(a.length>0||s)&&(await this.embeddingsCache.clearCache(),await this.embeddingsCache.updateCache(n)),this.constructExposedCache()}static isEmbeddingsCacheEntriesWithExtensions(r){return"core"in r&&"extensions"in r}static getInstalledExtensionIds(r){return r.getAllExtensions().filter(n=>!n.id.startsWith("vscode")).map(n=>n.id)}static calculateBaseRemoteExtensionCDNURL(r,n,o){return`https://embeddings.vscode-cdn.net/${r}/v${o}/${n}`}};fd=E([y(4,xe),y(5,Kr),y(6,Bm),y(7,j)],fd);var JF=class{constructor(e,r,n,o,s){this.cacheKey=r;this._embeddingsCache=n;this.embeddingsComputer=o;this.logService=s;this._isIndexLoaded=!1;this._items=new Map}get isIndexLoaded(){return this._isIndexLoaded}set isIndexLoaded(e){this._isIndexLoaded=e}async rebuildCache(){return await this._embeddingsCache.clearCache(),this._items.clear(),this.calculateEmbeddings()}nClosestValues(e,r){let n=Array.from(this._items.values()).map(o=>{if(!o.embedding)return{item:o,similarity:0};let s=mv(e,o.embedding);return{item:o,similarity:s}});return n=n.filter(o=>o.similarity>0),n.sort((o,s)=>s.similarity-o.similarity),n.slice(0,r).map(o=>o.item)}hasItem(e){return this._items.has(e)}getItem(e){return this._items.get(e)}async calculateEmbeddings(){return this._calculationPromise?this._calculationPromise:(this._calculationPromise=this._calculateEmbeddings(),this._calculationPromise.then(()=>this._calculationPromise=void 0))}async _calculateEmbeddings(){let e=Date.now(),r=await this.getLatestItems(),n=await this._embeddingsCache.getCache(),o=new Map;for(let s of r){let a=s,c=this._items.get(s.key),l=s.key;c?.embedding?a=c:n&&n[l]&&(a={...s,...n[l]}),o.set(l,a)}this._items=o,this.logService.internal.debug(`Embeddings for ${this.cacheKey} calculated in ${Date.now()-e}ms`),this.isIndexLoaded=!0}};function qm(t){let e=t.split(".");return`${e[0]}.${e[1]}`}function sK(t){let e=`Setting Id: ${t.key}
`;if(e+=`Type: ${t.type}
`,e+=`Description: ${t.description??t.markdownDescription??""}
`,t.enum){e+=`Possible values:
`;for(let r=0;r<t.enum.length;r++)e+=` - ${t.enum[r]} - ${t.enumDescriptions?.[r]??""}
`}return e+=`
`,e}var ZF=class extends JF{constructor(r,n,o,s,a,c,l,u){super(r,n,s,o,l);this._endpointProvider=a;this.relatedInformationConfig=c;this._logService=l;this.telemetryService=u;this.isIndexLoaded=!1}async provideRelatedInformation(r,n){let o=Date.now();if(!this.isIndexLoaded)return this.calculateEmbeddings(),this._logService.internal.debug(`Related Information: Index not loaded yet triggering background calculation, returning ${Date.now()-o}ms`),[];if(n.isCancellationRequested)return this._logService.internal.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`),[];let s=Date.now(),a=await this._endpointProvider.getEmbeddingsEndpoint("text3small"),c=await this.embeddingsComputer.computeEmbeddings(a,[r],{dimensions:512},n);if(this._logService.internal.debug(`Related Information: Remote similarly request took ${Date.now()-s}ms`),n.isCancellationRequested||!c||!c.embeddings[0])return this._logService.internal.debug(`Related Information: Request cancelled or no embeddings computed, returning ${Date.now()-o}ms`),[];let l=[];for(let d of this._items.values()){if(n.isCancellationRequested){this._logService.internal.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`);break}if(d.embedding){let p=mv(c.embeddings[0],d.embedding);p>this.relatedInformationConfig.threshold&&l.push(this.toRelatedInformation(d,p))}}return this.logService.internal.debug(`Related Information: Successfully Calculated, returning ${Date.now()-o}ms`),this.relatedInformationConfig.type===4&&this.telemetryService.sendInternalMSFTTelemetryEvent("relatedInformationSettings",{query:r}),l.sort((d,p)=>p.weight-d.weight).slice(0,this.relatedInformationConfig.maxResults)}},E2=class extends ZF{constructor(r,n,o,s,a,c){super("CommandIdIndex","commandEmbeddings",n,r,o,{type:2,threshold:0,maxResults:100},s,a);this.workbenchService=c}async getLatestItems(){let r=await this.workbenchService.getAllCommands();return r.push({label:"Extensions: Search the marketplace for extensions",command:"workbench.extensions.search",keybinding:"Not set"}),r.push({label:"Extensions: Install extension from marketplace",command:"workbench.extensions.installExtension",keybinding:"Not set"}),r.map(n=>({key:n.command,label:n.label.replace("View: Toggle","View: Toggle or Show or Hide"),originalLabel:n.label,keybinding:n.keybinding??"Not set"}))}getEmbeddingQueryString(r){return`${r.label} - ${r.key}`}toRelatedInformation(r,n){return{type:2,weight:n,command:r.key}}};E2=E([y(1,oa),y(2,xe),y(3,ie),y(4,ge),y(5,Bm)],E2);var w2=class extends ZF{constructor(r,n,o,s,a,c){super("SettingsIndex","settingEmbeddings",n,r,o,{type:4,threshold:0,maxResults:100},s,a);this.workbenchService=c}async getLatestItems(){let r=await this.workbenchService.getAllSettings(),n=[];for(let o of Object.keys(r)){let s=r[o];s.deprecationMessage||s.markdownDeprecationMessage||n.push({...s,key:o})}return n}getEmbeddingQueryString(r){return sK(r)}toRelatedInformation(r,n){return{type:4,weight:n,setting:r.key}}};w2=E([y(1,oa),y(2,xe),y(3,ie),y(4,ge),y(5,Bm)],w2);var md=ne("ICombinedEmbeddingIndex"),EI=class{constructor(e=!0,r,n){let o=e?r.createInstance(fd,1,"settingEmbeddings",qm(n.getEditorInfo().version),"settings"):r.createInstance(pd,1,"settingEmbeddings",qm(n.getEditorInfo().version)),s=e?r.createInstance(fd,1,"commandEmbeddings",qm(n.getEditorInfo().version),"commands"):r.createInstance(pd,1,"commandEmbeddings",qm(n.getEditorInfo().version));this.settingsIndex=r.createInstance(w2,o),this.commandIdIndex=r.createInstance(E2,s)}async loadIndexes(){await Promise.all([this.commandIdIndex.isIndexLoaded?Promise.resolve():this.commandIdIndex.calculateEmbeddings(),this.settingsIndex.isIndexLoaded?Promise.resolve():this.settingsIndex.calculateEmbeddings()])}async nClosestValues(e,r){return await this.loadIndexes(),{commands:this.commandIdIndex.nClosestValues(e,r),settings:this.settingsIndex.nClosestValues(e,r)}}hasSetting(e){return this.settingsIndex.hasItem(e)}hasCommand(e){return this.commandIdIndex.hasItem(e)}getSetting(e){return this.settingsIndex.getItem(e)}getCommand(e){return this.commandIdIndex.getItem(e)}};EI=E([y(1,j),y(2,gt)],EI);var e5=ne("IGitCommitMessageService");var Hye=q(require("path")),_t=q(require("vscode"));var qo=ne("IReviewService");var Ft=ne("ITabsAndEditorsService");var ol=class t{constructor(e){this._push=e}static spy(e,r){return new t(n=>{r(n),e.push(n)})}markdown(e){this._push(new ai(e))}anchor(e,r){this._push(new UF(e,r))}button(e){this._push(new I_(e))}filetree(e,r){this._push(new ud(e,r))}progress(e,r){typeof r>"u"?this._push(new xi(e)):this._push(new Dhe(e,r))}reference(e,r){this._push(new BF(e,r))}reference2(e,r,n){this._push(new qF(e,r,n))}codeCitation(e,r,n){this._push(new Nhe(e,r,n))}push(e){this._push(e)}textEdit(e,r){this._push(new Da(e,r))}markdownWithVulnerabilities(e,r){this._push(new Ohe(e,r))}codeblockUri(e){try{this._push(new Mhe(e))}catch{}}detectedParticipant(e,r){this._push(new Fhe(e,r))}confirmation(e,r,n,o){this._push(new C_(e,r,n,o))}warning(e){this._push(new Lhe(e))}};var aK="github.copilot-dynamic.platform",wI={workspace:{explain:"explain",edit:"edit",review:"review",tests:"tests",fix:"fix",new:"new",newNotebook:"newNotebook",semanticSearch:"semanticSearch",fixTestFailure:"fixTestFailure",setupTests:"setupTests"},vscode:{search:"search",runCommand:"runCommand",startDebugging:"startDebugging"},terminal:{explain:"terminalExplain"},editor:{doc:"doc",fix:"fix",explain:"explain",review:"review",tests:"tests",fixTestFailure:"fixTestFailure"}};function t5(t){if(Object.keys(wI).includes(t))return{agent:t};for(let[e,r]of Object.entries(wI))if(Object.values(r).includes(t))return{agent:e,command:t}}var jm="GitHub.copilot-chat";var vve=q(require("path"));var Ut=class t{constructor(e,r){this.lineNumber=e,this.column=r}with(e=this.lineNumber,r=this.column){return e===this.lineNumber&&r===this.column?this:new t(e,r)}delta(e=0,r=0){return this.with(this.lineNumber+e,this.column+r)}equals(e){return t.equals(this,e)}static equals(e,r){return!e&&!r?!0:!!e&&!!r&&e.lineNumber===r.lineNumber&&e.column===r.column}isBefore(e){return t.isBefore(this,e)}static isBefore(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<r.column}isBeforeOrEqual(e){return t.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<=r.column}static compare(e,r){let n=e.lineNumber|0,o=r.lineNumber|0;if(n===o){let s=e.column|0,a=r.column|0;return s-a}return n-o}clone(){return new t(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new t(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var je=class t{constructor(e,r,n,o){e>n||e===n&&r>o?(this.startLineNumber=n,this.startColumn=o,this.endLineNumber=e,this.endColumn=r):(this.startLineNumber=e,this.startColumn=r,this.endLineNumber=n,this.endColumn=o)}isEmpty(){return t.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return t.containsPosition(this,e)}static containsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<e.startColumn||r.lineNumber===e.endLineNumber&&r.column>e.endColumn)}static strictContainsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<=e.startColumn||r.lineNumber===e.endLineNumber&&r.column>=e.endColumn)}containsRange(e){return t.containsRange(this,e)}static containsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>e.endColumn)}strictContainsRange(e){return t.strictContainsRange(this,e)}static strictContainsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<=e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>=e.endColumn)}plusRange(e){return t.plusRange(this,e)}static plusRange(e,r){let n,o,s,a;return r.startLineNumber<e.startLineNumber?(n=r.startLineNumber,o=r.startColumn):r.startLineNumber===e.startLineNumber?(n=r.startLineNumber,o=Math.min(r.startColumn,e.startColumn)):(n=e.startLineNumber,o=e.startColumn),r.endLineNumber>e.endLineNumber?(s=r.endLineNumber,a=r.endColumn):r.endLineNumber===e.endLineNumber?(s=r.endLineNumber,a=Math.max(r.endColumn,e.endColumn)):(s=e.endLineNumber,a=e.endColumn),new t(n,o,s,a)}intersectRanges(e){return t.intersectRanges(this,e)}static intersectRanges(e,r){let n=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn,c=r.startLineNumber,l=r.startColumn,u=r.endLineNumber,d=r.endColumn;return n<c?(n=c,o=l):n===c&&(o=Math.max(o,l)),s>u?(s=u,a=d):s===u&&(a=Math.min(a,d)),n>s||n===s&&o>a?null:new t(n,o,s,a)}equalsRange(e){return t.equalsRange(this,e)}static equalsRange(e,r){return!e&&!r?!0:!!e&&!!r&&e.startLineNumber===r.startLineNumber&&e.startColumn===r.startColumn&&e.endLineNumber===r.endLineNumber&&e.endColumn===r.endColumn}getEndPosition(){return t.getEndPosition(this)}static getEndPosition(e){return new Ut(e.endLineNumber,e.endColumn)}getStartPosition(){return t.getStartPosition(this)}static getStartPosition(e){return new Ut(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,r){return new t(this.startLineNumber,this.startColumn,e,r)}setStartPosition(e,r){return new t(e,r,this.endLineNumber,this.endColumn)}collapseToStart(){return t.collapseToStart(this)}static collapseToStart(e){return new t(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return t.collapseToEnd(this)}static collapseToEnd(e){return new t(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new t(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,r=e){return new t(e.lineNumber,e.column,r.lineNumber,r.column)}static lift(e){return e?new t(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<e.startColumn)}static areIntersecting(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<=r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,r){if(e&&r){let s=e.startLineNumber|0,a=r.startLineNumber|0;if(s===a){let c=e.startColumn|0,l=r.startColumn|0;if(c===l){let u=e.endLineNumber|0,d=r.endLineNumber|0;if(u===d){let p=e.endColumn|0,f=r.endColumn|0;return p-f}return u-d}return c-l}return s-a}return(e?1:0)-(r?1:0)}static compareRangesUsingEnds(e,r){return e.endLineNumber===r.endLineNumber?e.endColumn===r.endColumn?e.startLineNumber===r.startLineNumber?e.startColumn-r.startColumn:e.startLineNumber-r.startLineNumber:e.endColumn-r.endColumn:e.endLineNumber-r.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};function sl(t,e,r){if(t===0)return{text:e,range:r};let n=typeof t=="number"?{0:e.slice(0,t),index:t}:e.match(t);if(!n)return{text:e,range:r};let o=n[0],s=X1(o,`
`);return{text:e.slice(o.length),range:{startLineNumber:r.startLineNumber+s,startColumn:s>0?o.length-(o.lastIndexOf(`
`)+1):r.startColumn+o.length,endColumn:r.endColumn,endLineNumber:r.endLineNumber}}}function Gl(t,e,r){if(t===0)return{text:e,range:r};let n=typeof t=="number"?{0:e.slice(-t),index:e.length-t}:e.match(t);if(!n)return{text:e,range:r};let o=n[0],s=X1(o,`
`),a=r.endLineNumber-s;return{text:e.slice(0,n.index),range:{startColumn:r.startColumn,startLineNumber:r.startLineNumber,endLineNumber:a,endColumn:s>0?(a===r.startLineNumber?r.startColumn:0)+n.index-(e.lastIndexOf(`
`,n.index-1)+1):Math.max(0,r.endColumn-o.length)}}}function cge(t){let e=t.lastIndexOf(`
`);return e===-1?{lineNumber:0,column:t.length}:{lineNumber:X1(t.slice(0,e),`
`)+1,column:t.length-(e+1)}}function lge(t,e,r,n){let o=r?eGe(r,t,e):{text:t,range:e};return n?tGe(n,o.text,o.range):o}function eGe(t,e,r){let n=je.lift(r),o=Ut.lift(t);if(o.equals(n.getStartPosition()))return{text:e,range:r};if(o.isBefore(n.getStartPosition()))return{text:e,range:r};let s=0;if(o.lineNumber===n.getStartPosition().lineNumber)s=o.column-n.getStartPosition().column;else{let a=e.split(`
`);for(let[c,l]of a.entries())if(n.getStartPosition().lineNumber+c===o.lineNumber){s+=o.column;break}else s+=l.length+1}return{text:e.substring(s),range:{startLineNumber:o.lineNumber,startColumn:o.column,endColumn:r.endColumn,endLineNumber:r.endLineNumber}}}function tGe(t,e,r){let n=je.lift(r),o=Ut.lift(t);if(o.equals(n.getEndPosition()))return{text:e,range:r};if(n.getEndPosition().isBefore(o))return{text:e,range:r};let s="";if(o.lineNumber===n.getStartPosition().lineNumber)s=e.substring(0,o.column-n.getStartPosition().column);else{let a=e.split(`
`),c=[];for(let[l,u]of a.entries())if(n.getStartPosition().lineNumber+l===o.lineNumber){c.push(u.substring(0,o.column));break}else c.push(u+`
`);s=c.join("")}return{text:s,range:{startLineNumber:r.startLineNumber,startColumn:r.startColumn,endColumn:o.column,endLineNumber:o.lineNumber}}}function hv(t,e=0,r=0){let n=t.row+e,o=t.column+r;return{lineNumber:n<0?0:n,column:o<0?0:o}}function bo(t){return{startLineNumber:t.range.startPosition.row,startColumn:t.range.startPosition.column,endLineNumber:t.range.endPosition.row,endColumn:t.range.endPosition.column}}var k_=/\s+$/;function uge(t){return t.replace(k_,"")}function zl(t,e){return{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:e.lineNumber,endColumn:e.column}}function dge(t,e,r){if(t===0)return{text:e,sources:r};let n=typeof t=="number"?{0:e.slice(-t),index:e.length-t}:e.match(t);if(!n)return{text:e,sources:r};let o=n.index;return{text:e.slice(0,o),sources:r.filter(s=>s.start<o).map(s=>({start:s.start,end:Math.min(s.end,o),range:Gl(Math.max(0,s.end-o),e.slice(0,s.end),s.range).range}))}}var r5=class{constructor(e,r){this.tokenizer=r.acquireTokenizer(e)}canSpiralChunk(e,r,n,o){let s=Math.max(e.startLineNumber-r,0),a=e.endLineNumber-r;if(n.length<s)return!1;let c=n.slice(s,a);return this.tokenizer.tokenLength(c.map(u=>u.text).join(`
`))<=o}processLinesIntoChunkUsingSprial(e,r,n,o,s,a,c=0,l=!1,u){let d=o-c-(l?0:c),p=0,f=e.split(`
`),m=[];for(let B=0;B<f.length;B++){let U=f[B],$=p;if(p+=U.length+1,a&&U.length===0)continue;let ce=U.slice(0,o*4);m.push({text:ce,lineNumber:B+r,originalStart:$,originalEnd:$+ce.length,tokens:this.tokenizer.tokenLength(ce)})}if(u&&u.endLineNumber<r)return;let h=u?Math.max(u.startLineNumber-r,0):0,g=Math.min(u?u.endLineNumber+1-r:m.length,m.length),v=this.tokenizer.tokenLength(m.map(B=>B.text).slice(h,g).join(`
`)),b=()=>{if(h<=0)return;let B=m[h-1];return{index:h-1,line:B,isBefore:!0}},_=()=>{if(g>=m.length-1)return;let B=m[g+1];return{index:g+1,line:B,isBefore:!1}},x=!0,S=()=>{let B;if(x){if(B=b(),!B)return _()}else if(B=_(),!B)return b();return g===m.length?x=!0:h<=0?x=!1:x=!x,B},I=S();if(I&&I.line.tokens+v<d)for(h=I.isBefore?I.index:h,g=I.isBefore?g:I.index,I=S();I;){let B=I.isBefore?I.index:h,U=I.isBefore?g:I.index,$=m.map(W=>W.text).slice(B,U).join(`
`);if(this.tokenizer.tokenLength($)>d)break;h=B,g=U,I=S()}let w=m.slice(h,g),k=w[w.length-1];if(w.length===0)return;for(;w.length;){let B=w[w.length-1],U=B.text.trimEnd();if(U==="")w.pop();else if(U!==B.text){B.text=U,B.originalEnd=U.length;break}else break}if(w.length===0)return;let M=[];n.sort((B,U)=>B.start-U.start);let H=0,F=0,ue=0,Z=w[0]?.originalStart||0,V=(B,U)=>{if(F===B){F=U;return}for(;H<n.length&&n[H].start<F;){let $=n[H++];if($.end<Z)continue;let ce=Math.max(0,$.end-F),W=Math.max(0,Z-$.start),Y=Gl(ce,e.slice($.start,$.end),$.range),Se=sl(W,Y.text,Y.range);M.push({start:$.start+W-ue,end:$.end-ce-ue,range:Se.range})}F=U,Z=B},A="";for(let B=0;B<w.length;B++){let U=w[B];V(U.originalStart,U.originalEnd),A+=U.text,ue=U.originalEnd-A.length,B<w.length-1&&(A+=`
`,e[U.originalEnd]===`
`&&V(U.originalEnd,U.originalEnd+1))}return V(1/0,1/0),{text:A,range:{startLineNumber:w[0].lineNumber,startColumn:0,endLineNumber:k.lineNumber,endColumn:k.text.length},sources:M}}};var rGe=!1,R2=(t,e)=>{let r=bo(t);return{sources:[{start:0,end:t.text.length,range:r}],text:t.text,range:r}},Cp=class{constructor(e,r){this.tokenizer=r.acquireTokenizer(e),this.spiralChunker=rGe?new r5(e,r):void 0}genericWholeFileChunking(e,{maxTokenLength:r=n5,removeEmptyLines:n=!0,rangeLimit:o=void 0,rangeLimitStrategy:s=void 0}){e=e.replace(/\r\n/g,`
`);let a=e,c=cge(e),l={startLineNumber:0,startColumn:0,endLineNumber:c.lineNumber,endColumn:c.column};if(o&&s!==1){let d=A2(je.lift(o),e,je.lift(l));a=d.newTextRange.text,l=d.newTextRange.range}let u=this._processLinesIntoChunks(a,l.startLineNumber,[{start:l.startLineNumber,end:e.length,range:l}],r,!0,n);return o&&s===1&&pge(u,je.lift(o)),u.filter(d=>!n||d.text.length&&/[\w\d]{2}/.test(d.text))}genericChunking({lineRangeText:e,maxTokenLength:r=n5,removeEmptyLines:n=!0,extraLineRangeSeparator:o="",numTokensInEllipsis:s=0,removeChunksOutsideOfRange:a=void 0}){if(r<0)throw Error("Cannot chunk text, not enough chunk room");if(e.length===0)return[];let c=this.tokenizer.tokenLength(o),l=[],u,d=!1;for(let p=0;p<e.length;p++){let f=e[p];if(u){let h=r-this.tokenizer.tokenLength(u.text)-c;if(h>0&&f.text.length<2e4&&this.tokenizer.tokenLength(f.text)<=h){let g=o||(d?`
`:""),v=u.text.length+g.length,b=u.text+g+f.text,_={startLineNumber:u.range.startLineNumber,startColumn:u.range.startColumn,endColumn:f.range.endColumn,endLineNumber:f.range.endLineNumber},x=f.sources.map(S=>({start:S.start+v,end:S.end+v,range:S.range}));for(let S of u.sources)x.push(S);d=!1,u={sources:x,text:b,range:_};continue}(!a||je.lift(a).intersectRanges(u.range))&&l.push(u),u=void 0}if(a&&a.endLineNumber<f.range.startLineNumber)break;let m=this._processLinesIntoChunks(f.text,f.range.startLineNumber,f.sources,r,!1,n,s,p===0,a?je.areIntersecting(a,f.range):void 0,a);u=m.pop(),d=!0,a&&pge(m,a),l.push(...m)}return u&&(!a||je.lift(a).intersectRanges(u.range))&&l.push(u),l.filter(p=>!n||p.text.length&&/[^\s]/.test(p.text)).map(p=>{let{text:f,sources:m}=dge(k_,p.text,p.sources);return{range:p.range,text:f,sources:m}})}_processLinesIntoChunks(e,r,n,o,s,a,c=0,l=!1,u=!1,d){let p=0,f=0,m=e.split(`
`),h=[];for(let v=0;v<m.length;v++){let b=m[v],_=f;if(f+=b.length+1,a&&b.length===0)continue;let x=b.slice(0,o*4);h.push({text:x,lineNumber:v+r,originalStart:_,originalEnd:_+x.length,tokens:this.tokenizer.tokenLength(x)})}let g=[];if(this.spiralChunker&&u&&d&&this.spiralChunker.canSpiralChunk(d,r,h,o)){let v=this.spiralChunker.processLinesIntoChunkUsingSprial(e,r,n,o,s,a,c,l,d);if(v)return g.push(v),g}for(;p<h.length;){let v=o-c-(l?0:c),b=p+1,_="";for(let V=h[p].tokens;b<h.length;b++){let A=V+h[b].tokens;if(A>v){_=h.slice(p,b+1).map(B=>B.text).join(`
`);let P=this.tokenizer.tokenLength(_);for(;P<=v&&b<h.length-1;)b++,_+=`
`+h[b].text,P=this.tokenizer.tokenLength(_);break}V=A}let x=h.slice(p,b),S=b;if(s){let{chunks:V,usedFromRemaining:A}=this._dedentAndAddLinesToChunk(x,h.slice(b),v);x=V,p=S+A}else for(p=S;p<h.length&&h[p].text.length===0;)p++;if(x.length===0)continue;for(;x.length;){let V=x[x.length-1],A=V.text.trimEnd();if(A==="")x.pop();else if(A!==V.text){V.text=A,V.originalEnd=A.length;break}else break}if(x.length===0)continue;let I=[];n.sort((V,A)=>V.start-A.start);let w=0,k=0,M=0,H=x[0]?.originalStart||0,F=(V,A)=>{if(k===V){k=A;return}for(;w<n.length&&n[w].start<k;){let P=n[w++];if(P.end<H)continue;let B=Math.max(0,P.end-k),U=Math.max(0,H-P.start),$=Gl(B,e.slice(P.start,P.end),P.range),ce=sl(U,$.text,$.range);I.push({start:P.start+U-M,end:P.end-B-M,range:ce.range})}k=A,H=V},ue="";for(let V=0;V<x.length;V++){let A=x[V];F(A.originalStart,A.originalEnd),ue+=A.text,M=A.originalEnd-ue.length,V<x.length-1&&(ue+=`
`,e[A.originalEnd]===`
`&&F(A.originalEnd,A.originalEnd+1))}F(1/0,1/0);let Z=x[x.length-1];g.push({text:ue,range:{startLineNumber:x[0].lineNumber,startColumn:0,endLineNumber:Z.lineNumber,endColumn:Z.text.length},sources:I})}return g}_dedentAndAddLinesToChunk(e,r,n){let o=P2(e.map(d=>d.text)),s=o.shortestLeadingCommonWhitespace;if(!s)return{chunks:e,usedFromRemaining:0};let a=e;for(let d=0;d<a.length;d++)a[d].originalStart+=s.length,a[d].text=o.trimmedLines[d]||"";let c=0,l=this.tokenizer.tokenLength(a.map(d=>d.text).join(`
`)),u=r[c];for(l+=u?.tokens||0;u&&l<n&&(u.text.length===0||u.text.startsWith(s));)a.push({...u,text:u.text.slice(s.length),originalStart:u.originalEnd+s.length}),c++,u=r[c],l+=u?.tokens||0;return{chunks:a,usedFromRemaining:c}}};Cp=E([y(1,_r)],Cp);function P2(t){let e=t.map(s=>{if(!s)return;let a=s.match(/^\s+/),c=a?a[0]:"",l=s.substring(c?.length);return[c,l]}),r=Dr(e),n=nGe(r)??"",o=n.length;return{trimmedLines:e.map(s=>s?s[0].substring(o)+s[1]:void 0),shortestLeadingCommonWhitespace:n}}function nGe(t){let e;for(let r of t){if(e===void 0){e=r[0];continue}e=iGe(e,r[0])}return e??""}function iGe(t,e){let r=LM(t,e);return t.substring(0,r)}var n5=250;function A2(t,e,r){let n=r.getStartPosition().isBefore(t.getStartPosition()),o=t.getEndPosition().isBefore(r.getEndPosition());return{newTextRange:lge(e,r,t.getStartPosition(),t.getEndPosition()),trimmedLeft:n,trimmedRight:o}}function pge(t,e){if(t.length>0&&e.startLineNumber>t[0].range.startLineNumber)for(;t.length>0&&je.lift(t[0].range).getEndPosition().isBefore(e.getStartPosition());)t.shift();if(t.length>0&&e.endLineNumber<t[t.length-1].range.endLineNumber)for(;t.length>0;){let r=je.lift(t[t.length-1].range).getStartPosition();if(e.getEndPosition().isBefore(r))t.pop();else break}}var gK={};Pn(gK,{arrayReplaceAt:()=>hK,assign:()=>PI,escapeHtml:()=>Vm,escapeRE:()=>jGe,fromCodePoint:()=>L2,has:()=>PGe,isMdAsciiPunct:()=>A_,isPunctChar:()=>P_,isSpace:()=>Er,isString:()=>m5,isValidEntityCode:()=>h5,isWhiteSpace:()=>R_,lib:()=>VGe,normalizeReference:()=>D_,unescapeAll:()=>yv,unescapeMd:()=>OGe});var c5={};Pn(c5,{decode:()=>D2,encode:()=>s5,format:()=>kI,parse:()=>N2});var fge={};function oGe(t){let e=fge[t];if(e)return e;e=fge[t]=[];for(let r=0;r<128;r++){let n=String.fromCharCode(r);e.push(n)}for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);e[n]="%"+("0"+n.toString(16).toUpperCase()).slice(-2)}return e}function i5(t,e){typeof e!="string"&&(e=i5.defaultChars);let r=oGe(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(n){let o="";for(let s=0,a=n.length;s<a;s+=3){let c=parseInt(n.slice(s+1,s+3),16);if(c<128){o+=r[c];continue}if((c&224)===192&&s+3<a){let l=parseInt(n.slice(s+4,s+6),16);if((l&192)===128){let u=c<<6&1984|l&63;u<128?o+="\uFFFD\uFFFD":o+=String.fromCharCode(u),s+=3;continue}}if((c&240)===224&&s+6<a){let l=parseInt(n.slice(s+4,s+6),16),u=parseInt(n.slice(s+7,s+9),16);if((l&192)===128&&(u&192)===128){let d=c<<12&61440|l<<6&4032|u&63;d<2048||d>=55296&&d<=57343?o+="\uFFFD\uFFFD\uFFFD":o+=String.fromCharCode(d),s+=6;continue}}if((c&248)===240&&s+9<a){let l=parseInt(n.slice(s+4,s+6),16),u=parseInt(n.slice(s+7,s+9),16),d=parseInt(n.slice(s+10,s+12),16);if((l&192)===128&&(u&192)===128&&(d&192)===128){let p=c<<18&1835008|l<<12&258048|u<<6&4032|d&63;p<65536||p>1114111?o+="\uFFFD\uFFFD\uFFFD\uFFFD":(p-=65536,o+=String.fromCharCode(55296+(p>>10),56320+(p&1023))),s+=9;continue}}o+="\uFFFD"}return o})}i5.defaultChars=";/?:@&=+$,#";i5.componentChars="";var D2=i5;var mge={};function sGe(t){let e=mge[t];if(e)return e;e=mge[t]=[];for(let r=0;r<128;r++){let n=String.fromCharCode(r);/^[0-9a-z]$/i.test(n)?e.push(n):e.push("%"+("0"+r.toString(16).toUpperCase()).slice(-2))}for(let r=0;r<t.length;r++)e[t.charCodeAt(r)]=t[r];return e}function o5(t,e,r){typeof e!="string"&&(r=e,e=o5.defaultChars),typeof r>"u"&&(r=!0);let n=sGe(e),o="";for(let s=0,a=t.length;s<a;s++){let c=t.charCodeAt(s);if(r&&c===37&&s+2<a&&/^[0-9a-f]{2}$/i.test(t.slice(s+1,s+3))){o+=t.slice(s,s+3),s+=2;continue}if(c<128){o+=n[c];continue}if(c>=55296&&c<=57343){if(c>=55296&&c<=56319&&s+1<a){let l=t.charCodeAt(s+1);if(l>=56320&&l<=57343){o+=encodeURIComponent(t[s]+t[s+1]),s++;continue}}o+="%EF%BF%BD";continue}o+=encodeURIComponent(t[s])}return o}o5.defaultChars=";/?:@&=+$,-_.!~*'()#";o5.componentChars="-_.!~*'()";var s5=o5;function kI(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&t.hostname.indexOf(":")!==-1?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function a5(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var aGe=/^([a-z0-9.+-]+:)/i,cGe=/:[0-9]*$/,lGe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,uGe=["<",">",'"',"`"," ","\r",`
`,"	"],dGe=["{","}","|","\\","^","`"].concat(uGe),pGe=["'"].concat(dGe),hge=["%","/","?",";","#"].concat(pGe),gge=["/","?","#"],fGe=255,vge=/^[+a-z0-9A-Z_-]{0,63}$/,mGe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,yge={javascript:!0,"javascript:":!0},bge={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function hGe(t,e){if(t&&t instanceof a5)return t;let r=new a5;return r.parse(t,e),r}a5.prototype.parse=function(t,e){let r,n,o,s=t;if(s=s.trim(),!e&&t.split("#").length===1){let u=lGe.exec(s);if(u)return this.pathname=u[1],u[2]&&(this.search=u[2]),this}let a=aGe.exec(s);if(a&&(a=a[0],r=a.toLowerCase(),this.protocol=a,s=s.substr(a.length)),(e||a||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(o=s.substr(0,2)==="//",o&&!(a&&yge[a])&&(s=s.substr(2),this.slashes=!0)),!yge[a]&&(o||a&&!bge[a])){let u=-1;for(let h=0;h<gge.length;h++)n=s.indexOf(gge[h]),n!==-1&&(u===-1||n<u)&&(u=n);let d,p;u===-1?p=s.lastIndexOf("@"):p=s.lastIndexOf("@",u),p!==-1&&(d=s.slice(0,p),s=s.slice(p+1),this.auth=d),u=-1;for(let h=0;h<hge.length;h++)n=s.indexOf(hge[h]),n!==-1&&(u===-1||n<u)&&(u=n);u===-1&&(u=s.length),s[u-1]===":"&&u--;let f=s.slice(0,u);s=s.slice(u),this.parseHost(f),this.hostname=this.hostname||"";let m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){let h=this.hostname.split(/\./);for(let g=0,v=h.length;g<v;g++){let b=h[g];if(b&&!b.match(vge)){let _="";for(let x=0,S=b.length;x<S;x++)b.charCodeAt(x)>127?_+="x":_+=b[x];if(!_.match(vge)){let x=h.slice(0,g),S=h.slice(g+1),I=b.match(mGe);I&&(x.push(I[1]),S.unshift(I[2])),S.length&&(s=S.join(".")+s),this.hostname=x.join(".");break}}}}this.hostname.length>fGe&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}let c=s.indexOf("#");c!==-1&&(this.hash=s.substr(c),s=s.slice(0,c));let l=s.indexOf("?");return l!==-1&&(this.search=s.substr(l),s=s.slice(0,l)),s&&(this.pathname=s),bge[r]&&this.hostname&&!this.pathname&&(this.pathname=""),this};a5.prototype.parseHost=function(t){let e=cGe.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var N2=hGe;var cK={};Pn(cK,{Any:()=>l5,Cc:()=>u5,Cf:()=>_ge,P:()=>RI,Z:()=>d5});var l5=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/;var u5=/[\0-\x1F\x7F-\x9F]/;var _ge=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/;var RI=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/;var d5=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/;var xge=new Uint16Array('\u1D41<\xD5\u0131\u028A\u049D\u057B\u05D0\u0675\u06DE\u07A2\u07D6\u080F\u0A4A\u0A91\u0DA1\u0E6D\u0F09\u0F26\u10CA\u1228\u12E1\u1415\u149D\u14C3\u14DF\u1525\0\0\0\0\0\0\u156B\u16CD\u198D\u1C12\u1DDD\u1F7E\u2060\u21B0\u228D\u23C0\u23FB\u2442\u2824\u2912\u2D08\u2E48\u2FCE\u3016\u32BA\u3639\u37AC\u38FE\u3A28\u3A71\u3AE0\u3B2E\u0800EMabcfglmnoprstu\\bfms\x7F\x84\x8B\x90\x95\x98\xA6\xB3\xB9\xC8\xCFlig\u803B\xC6\u40C6P\u803B&\u4026cute\u803B\xC1\u40C1reve;\u4102\u0100iyx}rc\u803B\xC2\u40C2;\u4410r;\uC000\u{1D504}rave\u803B\xC0\u40C0pha;\u4391acr;\u4100d;\u6A53\u0100gp\x9D\xA1on;\u4104f;\uC000\u{1D538}plyFunction;\u6061ing\u803B\xC5\u40C5\u0100cs\xBE\xC3r;\uC000\u{1D49C}ign;\u6254ilde\u803B\xC3\u40C3ml\u803B\xC4\u40C4\u0400aceforsu\xE5\xFB\xFE\u0117\u011C\u0122\u0127\u012A\u0100cr\xEA\xF2kslash;\u6216\u0176\xF6\xF8;\u6AE7ed;\u6306y;\u4411\u0180crt\u0105\u010B\u0114ause;\u6235noullis;\u612Ca;\u4392r;\uC000\u{1D505}pf;\uC000\u{1D539}eve;\u42D8c\xF2\u0113mpeq;\u624E\u0700HOacdefhilorsu\u014D\u0151\u0156\u0180\u019E\u01A2\u01B5\u01B7\u01BA\u01DC\u0215\u0273\u0278\u027Ecy;\u4427PY\u803B\xA9\u40A9\u0180cpy\u015D\u0162\u017Aute;\u4106\u0100;i\u0167\u0168\u62D2talDifferentialD;\u6145leys;\u612D\u0200aeio\u0189\u018E\u0194\u0198ron;\u410Cdil\u803B\xC7\u40C7rc;\u4108nint;\u6230ot;\u410A\u0100dn\u01A7\u01ADilla;\u40B8terDot;\u40B7\xF2\u017Fi;\u43A7rcle\u0200DMPT\u01C7\u01CB\u01D1\u01D6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01E2\u01F8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020FoubleQuote;\u601Duote;\u6019\u0200lnpu\u021E\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6A74\u0180git\u022F\u0236\u023Aruent;\u6261nt;\u622FourIntegral;\u622E\u0100fr\u024C\u024E;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6A2Fcr;\uC000\u{1D49E}p\u0100;C\u0284\u0285\u62D3ap;\u624D\u0580DJSZacefios\u02A0\u02AC\u02B0\u02B4\u02B8\u02CB\u02D7\u02E1\u02E6\u0333\u048D\u0100;o\u0179\u02A5trahd;\u6911cy;\u4402cy;\u4405cy;\u440F\u0180grs\u02BF\u02C4\u02C7ger;\u6021r;\u61A1hv;\u6AE4\u0100ay\u02D0\u02D5ron;\u410E;\u4414l\u0100;t\u02DD\u02DE\u6207a;\u4394r;\uC000\u{1D507}\u0100af\u02EB\u0327\u0100cm\u02F0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031Ccute;\u40B4o\u0174\u030B\u030D;\u42D9bleAcute;\u42DDrave;\u4060ilde;\u42DCond;\u62C4ferentialD;\u6146\u0470\u033D\0\0\0\u0342\u0354\0\u0405f;\uC000\u{1D53B}\u0180;DE\u0348\u0349\u034D\u40A8ot;\u60DCqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03CF\u03E2\u03F8ontourIntegra\xEC\u0239o\u0274\u0379\0\0\u037B\xBB\u0349nArrow;\u61D3\u0100eo\u0387\u03A4ft\u0180ART\u0390\u0396\u03A1rrow;\u61D0ightArrow;\u61D4e\xE5\u02CAng\u0100LR\u03AB\u03C4eft\u0100AR\u03B3\u03B9rrow;\u67F8ightArrow;\u67FAightArrow;\u67F9ight\u0100AT\u03D8\u03DErrow;\u61D2ee;\u62A8p\u0241\u03E9\0\0\u03EFrrow;\u61D1ownArrow;\u61D5erticalBar;\u6225n\u0300ABLRTa\u0412\u042A\u0430\u045E\u047F\u037Crrow\u0180;BU\u041D\u041E\u0422\u6193ar;\u6913pArrow;\u61F5reve;\u4311eft\u02D2\u043A\0\u0446\0\u0450ightVector;\u6950eeVector;\u695Eector\u0100;B\u0459\u045A\u61BDar;\u6956ight\u01D4\u0467\0\u0471eeVector;\u695Fector\u0100;B\u047A\u047B\u61C1ar;\u6957ee\u0100;A\u0486\u0487\u62A4rrow;\u61A7\u0100ct\u0492\u0497r;\uC000\u{1D49F}rok;\u4110\u0800NTacdfglmopqstux\u04BD\u04C0\u04C4\u04CB\u04DE\u04E2\u04E7\u04EE\u04F5\u0521\u052F\u0536\u0552\u055D\u0560\u0565G;\u414AH\u803B\xD0\u40D0cute\u803B\xC9\u40C9\u0180aiy\u04D2\u04D7\u04DCron;\u411Arc\u803B\xCA\u40CA;\u442Dot;\u4116r;\uC000\u{1D508}rave\u803B\xC8\u40C8ement;\u6208\u0100ap\u04FA\u04FEcr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65FBerySmallSquare;\u65AB\u0100gp\u0526\u052Aon;\u4118f;\uC000\u{1D53C}silon;\u4395u\u0100ai\u053C\u0549l\u0100;T\u0542\u0543\u6A75ilde;\u6242librium;\u61CC\u0100ci\u0557\u055Ar;\u6130m;\u6A73a;\u4397ml\u803B\xCB\u40CB\u0100ip\u056A\u056Fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058D\u05B2\u05CCy;\u4424r;\uC000\u{1D509}lled\u0253\u0597\0\0\u05A3mallSquare;\u65FCerySmallSquare;\u65AA\u0370\u05BA\0\u05BF\0\0\u05C4f;\uC000\u{1D53D}All;\u6200riertrf;\u6131c\xF2\u05CB\u0600JTabcdfgorst\u05E8\u05EC\u05EF\u05FA\u0600\u0612\u0616\u061B\u061D\u0623\u066C\u0672cy;\u4403\u803B>\u403Emma\u0100;d\u05F7\u05F8\u4393;\u43DCreve;\u411E\u0180eiy\u0607\u060C\u0610dil;\u4122rc;\u411C;\u4413ot;\u4120r;\uC000\u{1D50A};\u62D9pf;\uC000\u{1D53E}eater\u0300EFGLST\u0635\u0644\u064E\u0656\u065B\u0666qual\u0100;L\u063E\u063F\u6265ess;\u62DBullEqual;\u6267reater;\u6AA2ess;\u6277lantEqual;\u6A7Eilde;\u6273cr;\uC000\u{1D4A2};\u626B\u0400Aacfiosu\u0685\u068B\u0696\u069B\u069E\u06AA\u06BE\u06CARDcy;\u442A\u0100ct\u0690\u0694ek;\u42C7;\u405Eirc;\u4124r;\u610ClbertSpace;\u610B\u01F0\u06AF\0\u06B2f;\u610DizontalLine;\u6500\u0100ct\u06C3\u06C5\xF2\u06A9rok;\u4126mp\u0144\u06D0\u06D8ownHum\xF0\u012Fqual;\u624F\u0700EJOacdfgmnostu\u06FA\u06FE\u0703\u0707\u070E\u071A\u071E\u0721\u0728\u0744\u0778\u078B\u078F\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803B\xCD\u40CD\u0100iy\u0713\u0718rc\u803B\xCE\u40CE;\u4418ot;\u4130r;\u6111rave\u803B\xCC\u40CC\u0180;ap\u0720\u072F\u073F\u0100cg\u0734\u0737r;\u412AinaryI;\u6148lie\xF3\u03DD\u01F4\u0749\0\u0762\u0100;e\u074D\u074E\u622C\u0100gr\u0753\u0758ral;\u622Bsection;\u62C2isible\u0100CT\u076C\u0772omma;\u6063imes;\u6062\u0180gpt\u077F\u0783\u0788on;\u412Ef;\uC000\u{1D540}a;\u4399cr;\u6110ilde;\u4128\u01EB\u079A\0\u079Ecy;\u4406l\u803B\xCF\u40CF\u0280cfosu\u07AC\u07B7\u07BC\u07C2\u07D0\u0100iy\u07B1\u07B5rc;\u4134;\u4419r;\uC000\u{1D50D}pf;\uC000\u{1D541}\u01E3\u07C7\0\u07CCr;\uC000\u{1D4A5}rcy;\u4408kcy;\u4404\u0380HJacfos\u07E4\u07E8\u07EC\u07F1\u07FD\u0802\u0808cy;\u4425cy;\u440Cppa;\u439A\u0100ey\u07F6\u07FBdil;\u4136;\u441Ar;\uC000\u{1D50E}pf;\uC000\u{1D542}cr;\uC000\u{1D4A6}\u0580JTaceflmost\u0825\u0829\u082C\u0850\u0863\u09B3\u09B8\u09C7\u09CD\u0A37\u0A47cy;\u4409\u803B<\u403C\u0280cmnpr\u0837\u083C\u0841\u0844\u084Dute;\u4139bda;\u439Bg;\u67EAlacetrf;\u6112r;\u619E\u0180aey\u0857\u085C\u0861ron;\u413Ddil;\u413B;\u441B\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087E\u08A9\u08B1\u08E0\u08E6\u08FC\u092F\u095B\u0390\u096A\u0100nr\u0883\u088FgleBracket;\u67E8row\u0180;BR\u0899\u089A\u089E\u6190ar;\u61E4ightArrow;\u61C6eiling;\u6308o\u01F5\u08B7\0\u08C3bleBracket;\u67E6n\u01D4\u08C8\0\u08D2eeVector;\u6961ector\u0100;B\u08DB\u08DC\u61C3ar;\u6959loor;\u630Aight\u0100AV\u08EF\u08F5rrow;\u6194ector;\u694E\u0100er\u0901\u0917e\u0180;AV\u0909\u090A\u0910\u62A3rrow;\u61A4ector;\u695Aiangle\u0180;BE\u0924\u0925\u0929\u62B2ar;\u69CFqual;\u62B4p\u0180DTV\u0937\u0942\u094CownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61BFar;\u6958ector\u0100;B\u0965\u0966\u61BCar;\u6952ight\xE1\u039Cs\u0300EFGLST\u097E\u098B\u0995\u099D\u09A2\u09ADqualGreater;\u62DAullEqual;\u6266reater;\u6276ess;\u6AA1lantEqual;\u6A7Dilde;\u6272r;\uC000\u{1D50F}\u0100;e\u09BD\u09BE\u62D8ftarrow;\u61DAidot;\u413F\u0180npw\u09D4\u0A16\u0A1Bg\u0200LRlr\u09DE\u09F7\u0A02\u0A10eft\u0100AR\u09E6\u09ECrrow;\u67F5ightArrow;\u67F7ightArrow;\u67F6eft\u0100ar\u03B3\u0A0Aight\xE1\u03BFight\xE1\u03CAf;\uC000\u{1D543}er\u0100LR\u0A22\u0A2CeftArrow;\u6199ightArrow;\u6198\u0180cht\u0A3E\u0A40\u0A42\xF2\u084C;\u61B0rok;\u4141;\u626A\u0400acefiosu\u0A5A\u0A5D\u0A60\u0A77\u0A7C\u0A85\u0A8B\u0A8Ep;\u6905y;\u441C\u0100dl\u0A65\u0A6FiumSpace;\u605Flintrf;\u6133r;\uC000\u{1D510}nusPlus;\u6213pf;\uC000\u{1D544}c\xF2\u0A76;\u439C\u0480Jacefostu\u0AA3\u0AA7\u0AAD\u0AC0\u0B14\u0B19\u0D91\u0D97\u0D9Ecy;\u440Acute;\u4143\u0180aey\u0AB4\u0AB9\u0ABEron;\u4147dil;\u4145;\u441D\u0180gsw\u0AC7\u0AF0\u0B0Eative\u0180MTV\u0AD3\u0ADF\u0AE8ediumSpace;\u600Bhi\u0100cn\u0AE6\u0AD8\xEB\u0AD9eryThi\xEE\u0AD9ted\u0100GL\u0AF8\u0B06reaterGreate\xF2\u0673essLes\xF3\u0A48Line;\u400Ar;\uC000\u{1D511}\u0200Bnpt\u0B22\u0B28\u0B37\u0B3Areak;\u6060BreakingSpace;\u40A0f;\u6115\u0680;CDEGHLNPRSTV\u0B55\u0B56\u0B6A\u0B7C\u0BA1\u0BEB\u0C04\u0C5E\u0C84\u0CA6\u0CD8\u0D61\u0D85\u6AEC\u0100ou\u0B5B\u0B64ngruent;\u6262pCap;\u626DoubleVerticalBar;\u6226\u0180lqx\u0B83\u0B8A\u0B9Bement;\u6209ual\u0100;T\u0B92\u0B93\u6260ilde;\uC000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0BB6\u0BB7\u0BBD\u0BC9\u0BD3\u0BD8\u0BE5\u626Fqual;\u6271ullEqual;\uC000\u2267\u0338reater;\uC000\u226B\u0338ess;\u6279lantEqual;\uC000\u2A7E\u0338ilde;\u6275ump\u0144\u0BF2\u0BFDownHump;\uC000\u224E\u0338qual;\uC000\u224F\u0338e\u0100fs\u0C0A\u0C27tTriangle\u0180;BE\u0C1A\u0C1B\u0C21\u62EAar;\uC000\u29CF\u0338qual;\u62ECs\u0300;EGLST\u0C35\u0C36\u0C3C\u0C44\u0C4B\u0C58\u626Equal;\u6270reater;\u6278ess;\uC000\u226A\u0338lantEqual;\uC000\u2A7D\u0338ilde;\u6274ested\u0100GL\u0C68\u0C79reaterGreater;\uC000\u2AA2\u0338essLess;\uC000\u2AA1\u0338recedes\u0180;ES\u0C92\u0C93\u0C9B\u6280qual;\uC000\u2AAF\u0338lantEqual;\u62E0\u0100ei\u0CAB\u0CB9verseElement;\u620CghtTriangle\u0180;BE\u0CCB\u0CCC\u0CD2\u62EBar;\uC000\u29D0\u0338qual;\u62ED\u0100qu\u0CDD\u0D0CuareSu\u0100bp\u0CE8\u0CF9set\u0100;E\u0CF0\u0CF3\uC000\u228F\u0338qual;\u62E2erset\u0100;E\u0D03\u0D06\uC000\u2290\u0338qual;\u62E3\u0180bcp\u0D13\u0D24\u0D4Eset\u0100;E\u0D1B\u0D1E\uC000\u2282\u20D2qual;\u6288ceeds\u0200;EST\u0D32\u0D33\u0D3B\u0D46\u6281qual;\uC000\u2AB0\u0338lantEqual;\u62E1ilde;\uC000\u227F\u0338erset\u0100;E\u0D58\u0D5B\uC000\u2283\u20D2qual;\u6289ilde\u0200;EFT\u0D6E\u0D6F\u0D75\u0D7F\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uC000\u{1D4A9}ilde\u803B\xD1\u40D1;\u439D\u0700Eacdfgmoprstuv\u0DBD\u0DC2\u0DC9\u0DD5\u0DDB\u0DE0\u0DE7\u0DFC\u0E02\u0E20\u0E22\u0E32\u0E3F\u0E44lig;\u4152cute\u803B\xD3\u40D3\u0100iy\u0DCE\u0DD3rc\u803B\xD4\u40D4;\u441Eblac;\u4150r;\uC000\u{1D512}rave\u803B\xD2\u40D2\u0180aei\u0DEE\u0DF2\u0DF6cr;\u414Cga;\u43A9cron;\u439Fpf;\uC000\u{1D546}enCurly\u0100DQ\u0E0E\u0E1AoubleQuote;\u601Cuote;\u6018;\u6A54\u0100cl\u0E27\u0E2Cr;\uC000\u{1D4AA}ash\u803B\xD8\u40D8i\u016C\u0E37\u0E3Cde\u803B\xD5\u40D5es;\u6A37ml\u803B\xD6\u40D6er\u0100BP\u0E4B\u0E60\u0100ar\u0E50\u0E53r;\u603Eac\u0100ek\u0E5A\u0E5C;\u63DEet;\u63B4arenthesis;\u63DC\u0480acfhilors\u0E7F\u0E87\u0E8A\u0E8F\u0E92\u0E94\u0E9D\u0EB0\u0EFCrtialD;\u6202y;\u441Fr;\uC000\u{1D513}i;\u43A6;\u43A0usMinus;\u40B1\u0100ip\u0EA2\u0EADncareplan\xE5\u069Df;\u6119\u0200;eio\u0EB9\u0EBA\u0EE0\u0EE4\u6ABBcedes\u0200;EST\u0EC8\u0EC9\u0ECF\u0EDA\u627Aqual;\u6AAFlantEqual;\u627Cilde;\u627Eme;\u6033\u0100dp\u0EE9\u0EEEuct;\u620Fortion\u0100;a\u0225\u0EF9l;\u621D\u0100ci\u0F01\u0F06r;\uC000\u{1D4AB};\u43A8\u0200Ufos\u0F11\u0F16\u0F1B\u0F1FOT\u803B"\u4022r;\uC000\u{1D514}pf;\u611Acr;\uC000\u{1D4AC}\u0600BEacefhiorsu\u0F3E\u0F43\u0F47\u0F60\u0F73\u0FA7\u0FAA\u0FAD\u1096\u10A9\u10B4\u10BEarr;\u6910G\u803B\xAE\u40AE\u0180cnr\u0F4E\u0F53\u0F56ute;\u4154g;\u67EBr\u0100;t\u0F5C\u0F5D\u61A0l;\u6916\u0180aey\u0F67\u0F6C\u0F71ron;\u4158dil;\u4156;\u4420\u0100;v\u0F78\u0F79\u611Cerse\u0100EU\u0F82\u0F99\u0100lq\u0F87\u0F8Eement;\u620Builibrium;\u61CBpEquilibrium;\u696Fr\xBB\u0F79o;\u43A1ght\u0400ACDFTUVa\u0FC1\u0FEB\u0FF3\u1022\u1028\u105B\u1087\u03D8\u0100nr\u0FC6\u0FD2gleBracket;\u67E9row\u0180;BL\u0FDC\u0FDD\u0FE1\u6192ar;\u61E5eftArrow;\u61C4eiling;\u6309o\u01F5\u0FF9\0\u1005bleBracket;\u67E7n\u01D4\u100A\0\u1014eeVector;\u695Dector\u0100;B\u101D\u101E\u61C2ar;\u6955loor;\u630B\u0100er\u102D\u1043e\u0180;AV\u1035\u1036\u103C\u62A2rrow;\u61A6ector;\u695Biangle\u0180;BE\u1050\u1051\u1055\u62B3ar;\u69D0qual;\u62B5p\u0180DTV\u1063\u106E\u1078ownVector;\u694FeeVector;\u695Cector\u0100;B\u1082\u1083\u61BEar;\u6954ector\u0100;B\u1091\u1092\u61C0ar;\u6953\u0100pu\u109B\u109Ef;\u611DndImplies;\u6970ightarrow;\u61DB\u0100ch\u10B9\u10BCr;\u611B;\u61B1leDelayed;\u69F4\u0680HOacfhimoqstu\u10E4\u10F1\u10F7\u10FD\u1119\u111E\u1151\u1156\u1161\u1167\u11B5\u11BB\u11BF\u0100Cc\u10E9\u10EEHcy;\u4429y;\u4428FTcy;\u442Ccute;\u415A\u0280;aeiy\u1108\u1109\u110E\u1113\u1117\u6ABCron;\u4160dil;\u415Erc;\u415C;\u4421r;\uC000\u{1D516}ort\u0200DLRU\u112A\u1134\u113E\u1149ownArrow\xBB\u041EeftArrow\xBB\u089AightArrow\xBB\u0FDDpArrow;\u6191gma;\u43A3allCircle;\u6218pf;\uC000\u{1D54A}\u0272\u116D\0\0\u1170t;\u621Aare\u0200;ISU\u117B\u117C\u1189\u11AF\u65A1ntersection;\u6293u\u0100bp\u118F\u119Eset\u0100;E\u1197\u1198\u628Fqual;\u6291erset\u0100;E\u11A8\u11A9\u6290qual;\u6292nion;\u6294cr;\uC000\u{1D4AE}ar;\u62C6\u0200bcmp\u11C8\u11DB\u1209\u120B\u0100;s\u11CD\u11CE\u62D0et\u0100;E\u11CD\u11D5qual;\u6286\u0100ch\u11E0\u1205eeds\u0200;EST\u11ED\u11EE\u11F4\u11FF\u627Bqual;\u6AB0lantEqual;\u627Dilde;\u627FTh\xE1\u0F8C;\u6211\u0180;es\u1212\u1213\u1223\u62D1rset\u0100;E\u121C\u121D\u6283qual;\u6287et\xBB\u1213\u0580HRSacfhiors\u123E\u1244\u1249\u1255\u125E\u1271\u1276\u129F\u12C2\u12C8\u12D1ORN\u803B\xDE\u40DEADE;\u6122\u0100Hc\u124E\u1252cy;\u440By;\u4426\u0100bu\u125A\u125C;\u4009;\u43A4\u0180aey\u1265\u126A\u126Fron;\u4164dil;\u4162;\u4422r;\uC000\u{1D517}\u0100ei\u127B\u1289\u01F2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128E\u1298kSpace;\uC000\u205F\u200ASpace;\u6009lde\u0200;EFT\u12AB\u12AC\u12B2\u12BC\u623Cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uC000\u{1D54B}ipleDot;\u60DB\u0100ct\u12D6\u12DBr;\uC000\u{1D4AF}rok;\u4166\u0AE1\u12F7\u130E\u131A\u1326\0\u132C\u1331\0\0\0\0\0\u1338\u133D\u1377\u1385\0\u13FF\u1404\u140A\u1410\u0100cr\u12FB\u1301ute\u803B\xDA\u40DAr\u0100;o\u1307\u1308\u619Fcir;\u6949r\u01E3\u1313\0\u1316y;\u440Eve;\u416C\u0100iy\u131E\u1323rc\u803B\xDB\u40DB;\u4423blac;\u4170r;\uC000\u{1D518}rave\u803B\xD9\u40D9acr;\u416A\u0100di\u1341\u1369er\u0100BP\u1348\u135D\u0100ar\u134D\u1350r;\u405Fac\u0100ek\u1357\u1359;\u63DFet;\u63B5arenthesis;\u63DDon\u0100;P\u1370\u1371\u62C3lus;\u628E\u0100gp\u137B\u137Fon;\u4172f;\uC000\u{1D54C}\u0400ADETadps\u1395\u13AE\u13B8\u13C4\u03E8\u13D2\u13D7\u13F3rrow\u0180;BD\u1150\u13A0\u13A4ar;\u6912ownArrow;\u61C5ownArrow;\u6195quilibrium;\u696Eee\u0100;A\u13CB\u13CC\u62A5rrow;\u61A5own\xE1\u03F3er\u0100LR\u13DE\u13E8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13F9\u13FA\u43D2on;\u43A5ing;\u416Ecr;\uC000\u{1D4B0}ilde;\u4168ml\u803B\xDC\u40DC\u0480Dbcdefosv\u1427\u142C\u1430\u1433\u143E\u1485\u148A\u1490\u1496ash;\u62ABar;\u6AEBy;\u4412ash\u0100;l\u143B\u143C\u62A9;\u6AE6\u0100er\u1443\u1445;\u62C1\u0180bty\u144C\u1450\u147Aar;\u6016\u0100;i\u144F\u1455cal\u0200BLST\u1461\u1465\u146A\u1474ar;\u6223ine;\u407Ceparator;\u6758ilde;\u6240ThinSpace;\u600Ar;\uC000\u{1D519}pf;\uC000\u{1D54D}cr;\uC000\u{1D4B1}dash;\u62AA\u0280cefos\u14A7\u14AC\u14B1\u14B6\u14BCirc;\u4174dge;\u62C0r;\uC000\u{1D51A}pf;\uC000\u{1D54E}cr;\uC000\u{1D4B2}\u0200fios\u14CB\u14D0\u14D2\u14D8r;\uC000\u{1D51B};\u439Epf;\uC000\u{1D54F}cr;\uC000\u{1D4B3}\u0480AIUacfosu\u14F1\u14F5\u14F9\u14FD\u1504\u150F\u1514\u151A\u1520cy;\u442Fcy;\u4407cy;\u442Ecute\u803B\xDD\u40DD\u0100iy\u1509\u150Drc;\u4176;\u442Br;\uC000\u{1D51C}pf;\uC000\u{1D550}cr;\uC000\u{1D4B4}ml;\u4178\u0400Hacdefos\u1535\u1539\u153F\u154B\u154F\u155D\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417D;\u4417ot;\u417B\u01F2\u1554\0\u155BoWidt\xE8\u0AD9a;\u4396r;\u6128pf;\u6124cr;\uC000\u{1D4B5}\u0BE1\u1583\u158A\u1590\0\u15B0\u15B6\u15BF\0\0\0\0\u15C6\u15DB\u15EB\u165F\u166D\0\u1695\u169B\u16B2\u16B9\0\u16BEcute\u803B\xE1\u40E1reve;\u4103\u0300;Ediuy\u159C\u159D\u15A1\u15A3\u15A8\u15AD\u623E;\uC000\u223E\u0333;\u623Frc\u803B\xE2\u40E2te\u80BB\xB4\u0306;\u4430lig\u803B\xE6\u40E6\u0100;r\xB2\u15BA;\uC000\u{1D51E}rave\u803B\xE0\u40E0\u0100ep\u15CA\u15D6\u0100fp\u15CF\u15D4sym;\u6135\xE8\u15D3ha;\u43B1\u0100ap\u15DFc\u0100cl\u15E4\u15E7r;\u4101g;\u6A3F\u0264\u15F0\0\0\u160A\u0280;adsv\u15FA\u15FB\u15FF\u1601\u1607\u6227nd;\u6A55;\u6A5Clope;\u6A58;\u6A5A\u0380;elmrsz\u1618\u1619\u161B\u161E\u163F\u164F\u1659\u6220;\u69A4e\xBB\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163A\u163C\u163E;\u69A8;\u69A9;\u69AA;\u69AB;\u69AC;\u69AD;\u69AE;\u69AFt\u0100;v\u1645\u1646\u621Fb\u0100;d\u164C\u164D\u62BE;\u699D\u0100pt\u1654\u1657h;\u6222\xBB\xB9arr;\u637C\u0100gp\u1663\u1667on;\u4105f;\uC000\u{1D552}\u0380;Eaeiop\u12C1\u167B\u167D\u1682\u1684\u1687\u168A;\u6A70cir;\u6A6F;\u624Ad;\u624Bs;\u4027rox\u0100;e\u12C1\u1692\xF1\u1683ing\u803B\xE5\u40E5\u0180cty\u16A1\u16A6\u16A8r;\uC000\u{1D4B6};\u402Amp\u0100;e\u12C1\u16AF\xF1\u0288ilde\u803B\xE3\u40E3ml\u803B\xE4\u40E4\u0100ci\u16C2\u16C8onin\xF4\u0272nt;\u6A11\u0800Nabcdefiklnoprsu\u16ED\u16F1\u1730\u173C\u1743\u1748\u1778\u177D\u17E0\u17E6\u1839\u1850\u170D\u193D\u1948\u1970ot;\u6AED\u0100cr\u16F6\u171Ek\u0200ceps\u1700\u1705\u170D\u1713ong;\u624Cpsilon;\u43F6rime;\u6035im\u0100;e\u171A\u171B\u623Dq;\u62CD\u0176\u1722\u1726ee;\u62BDed\u0100;g\u172C\u172D\u6305e\xBB\u172Drk\u0100;t\u135C\u1737brk;\u63B6\u0100oy\u1701\u1741;\u4431quo;\u601E\u0280cmprt\u1753\u175B\u1761\u1764\u1768aus\u0100;e\u010A\u0109ptyv;\u69B0s\xE9\u170Cno\xF5\u0113\u0180ahw\u176F\u1771\u1773;\u43B2;\u6136een;\u626Cr;\uC000\u{1D51F}g\u0380costuvw\u178D\u179D\u17B3\u17C1\u17D5\u17DB\u17DE\u0180aiu\u1794\u1796\u179A\xF0\u0760rc;\u65EFp\xBB\u1371\u0180dpt\u17A4\u17A8\u17ADot;\u6A00lus;\u6A01imes;\u6A02\u0271\u17B9\0\0\u17BEcup;\u6A06ar;\u6605riangle\u0100du\u17CD\u17D2own;\u65BDp;\u65B3plus;\u6A04e\xE5\u1444\xE5\u14ADarow;\u690D\u0180ako\u17ED\u1826\u1835\u0100cn\u17F2\u1823k\u0180lst\u17FA\u05AB\u1802ozenge;\u69EBriangle\u0200;dlr\u1812\u1813\u1818\u181D\u65B4own;\u65BEeft;\u65C2ight;\u65B8k;\u6423\u01B1\u182B\0\u1833\u01B2\u182F\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183E\u184D\u0100;q\u1843\u1846\uC000=\u20E5uiv;\uC000\u2261\u20E5t;\u6310\u0200ptwx\u1859\u185E\u1867\u186Cf;\uC000\u{1D553}\u0100;t\u13CB\u1863om\xBB\u13CCtie;\u62C8\u0600DHUVbdhmptuv\u1885\u1896\u18AA\u18BB\u18D7\u18DB\u18EC\u18FF\u1905\u190A\u1910\u1921\u0200LRlr\u188E\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18A1\u18A2\u18A4\u18A6\u18A8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18B3\u18B5\u18B7\u18B9;\u655D;\u655A;\u655C;\u6559\u0380;HLRhlr\u18CA\u18CB\u18CD\u18CF\u18D1\u18D3\u18D5\u6551;\u656C;\u6563;\u6560;\u656B;\u6562;\u655Fox;\u69C9\u0200LRlr\u18E4\u18E6\u18E8\u18EA;\u6555;\u6552;\u6510;\u650C\u0280;DUdu\u06BD\u18F7\u18F9\u18FB\u18FD;\u6565;\u6568;\u652C;\u6534inus;\u629Flus;\u629Eimes;\u62A0\u0200LRlr\u1919\u191B\u191D\u191F;\u655B;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193B\u6502;\u656A;\u6561;\u655E;\u653C;\u6524;\u651C\u0100ev\u0123\u1942bar\u803B\xA6\u40A6\u0200ceio\u1951\u1956\u195A\u1960r;\uC000\u{1D4B7}mi;\u604Fm\u0100;e\u171A\u171Cl\u0180;bh\u1968\u1969\u196B\u405C;\u69C5sub;\u67C8\u016C\u1974\u197El\u0100;e\u1979\u197A\u6022t\xBB\u197Ap\u0180;Ee\u012F\u1985\u1987;\u6AAE\u0100;q\u06DC\u06DB\u0CE1\u19A7\0\u19E8\u1A11\u1A15\u1A32\0\u1A37\u1A50\0\0\u1AB4\0\0\u1AC1\0\0\u1B21\u1B2E\u1B4D\u1B52\0\u1BFD\0\u1C0C\u0180cpr\u19AD\u19B2\u19DDute;\u4107\u0300;abcds\u19BF\u19C0\u19C4\u19CA\u19D5\u19D9\u6229nd;\u6A44rcup;\u6A49\u0100au\u19CF\u19D2p;\u6A4Bp;\u6A47ot;\u6A40;\uC000\u2229\uFE00\u0100eo\u19E2\u19E5t;\u6041\xEE\u0693\u0200aeiu\u19F0\u19FB\u1A01\u1A05\u01F0\u19F5\0\u19F8s;\u6A4Don;\u410Ddil\u803B\xE7\u40E7rc;\u4109ps\u0100;s\u1A0C\u1A0D\u6A4Cm;\u6A50ot;\u410B\u0180dmn\u1A1B\u1A20\u1A26il\u80BB\xB8\u01ADptyv;\u69B2t\u8100\xA2;e\u1A2D\u1A2E\u40A2r\xE4\u01B2r;\uC000\u{1D520}\u0180cei\u1A3D\u1A40\u1A4Dy;\u4447ck\u0100;m\u1A47\u1A48\u6713ark\xBB\u1A48;\u43C7r\u0380;Ecefms\u1A5F\u1A60\u1A62\u1A6B\u1AA4\u1AAA\u1AAE\u65CB;\u69C3\u0180;el\u1A69\u1A6A\u1A6D\u42C6q;\u6257e\u0261\u1A74\0\0\u1A88rrow\u0100lr\u1A7C\u1A81eft;\u61BAight;\u61BB\u0280RSacd\u1A92\u1A94\u1A96\u1A9A\u1A9F\xBB\u0F47;\u64C8st;\u629Birc;\u629Aash;\u629Dnint;\u6A10id;\u6AEFcir;\u69C2ubs\u0100;u\u1ABB\u1ABC\u6663it\xBB\u1ABC\u02EC\u1AC7\u1AD4\u1AFA\0\u1B0Aon\u0100;e\u1ACD\u1ACE\u403A\u0100;q\xC7\xC6\u026D\u1AD9\0\0\u1AE2a\u0100;t\u1ADE\u1ADF\u402C;\u4040\u0180;fl\u1AE8\u1AE9\u1AEB\u6201\xEE\u1160e\u0100mx\u1AF1\u1AF6ent\xBB\u1AE9e\xF3\u024D\u01E7\u1AFE\0\u1B07\u0100;d\u12BB\u1B02ot;\u6A6Dn\xF4\u0246\u0180fry\u1B10\u1B14\u1B17;\uC000\u{1D554}o\xE4\u0254\u8100\xA9;s\u0155\u1B1Dr;\u6117\u0100ao\u1B25\u1B29rr;\u61B5ss;\u6717\u0100cu\u1B32\u1B37r;\uC000\u{1D4B8}\u0100bp\u1B3C\u1B44\u0100;e\u1B41\u1B42\u6ACF;\u6AD1\u0100;e\u1B49\u1B4A\u6AD0;\u6AD2dot;\u62EF\u0380delprvw\u1B60\u1B6C\u1B77\u1B82\u1BAC\u1BD4\u1BF9arr\u0100lr\u1B68\u1B6A;\u6938;\u6935\u0270\u1B72\0\0\u1B75r;\u62DEc;\u62DFarr\u0100;p\u1B7F\u1B80\u61B6;\u693D\u0300;bcdos\u1B8F\u1B90\u1B96\u1BA1\u1BA5\u1BA8\u622Arcap;\u6A48\u0100au\u1B9B\u1B9Ep;\u6A46p;\u6A4Aot;\u628Dr;\u6A45;\uC000\u222A\uFE00\u0200alrv\u1BB5\u1BBF\u1BDE\u1BE3rr\u0100;m\u1BBC\u1BBD\u61B7;\u693Cy\u0180evw\u1BC7\u1BD4\u1BD8q\u0270\u1BCE\0\0\u1BD2re\xE3\u1B73u\xE3\u1B75ee;\u62CEedge;\u62CFen\u803B\xA4\u40A4earrow\u0100lr\u1BEE\u1BF3eft\xBB\u1B80ight\xBB\u1BBDe\xE4\u1BDD\u0100ci\u1C01\u1C07onin\xF4\u01F7nt;\u6231lcty;\u632D\u0980AHabcdefhijlorstuwz\u1C38\u1C3B\u1C3F\u1C5D\u1C69\u1C75\u1C8A\u1C9E\u1CAC\u1CB7\u1CFB\u1CFF\u1D0D\u1D7B\u1D91\u1DAB\u1DBB\u1DC6\u1DCDr\xF2\u0381ar;\u6965\u0200glrs\u1C48\u1C4D\u1C52\u1C54ger;\u6020eth;\u6138\xF2\u1133h\u0100;v\u1C5A\u1C5B\u6010\xBB\u090A\u016B\u1C61\u1C67arow;\u690Fa\xE3\u0315\u0100ay\u1C6E\u1C73ron;\u410F;\u4434\u0180;ao\u0332\u1C7C\u1C84\u0100gr\u02BF\u1C81r;\u61CAtseq;\u6A77\u0180glm\u1C91\u1C94\u1C98\u803B\xB0\u40B0ta;\u43B4ptyv;\u69B1\u0100ir\u1CA3\u1CA8sht;\u697F;\uC000\u{1D521}ar\u0100lr\u1CB3\u1CB5\xBB\u08DC\xBB\u101E\u0280aegsv\u1CC2\u0378\u1CD6\u1CDC\u1CE0m\u0180;os\u0326\u1CCA\u1CD4nd\u0100;s\u0326\u1CD1uit;\u6666amma;\u43DDin;\u62F2\u0180;io\u1CE7\u1CE8\u1CF8\u40F7de\u8100\xF7;o\u1CE7\u1CF0ntimes;\u62C7n\xF8\u1CF7cy;\u4452c\u026F\u1D06\0\0\u1D0Arn;\u631Eop;\u630D\u0280lptuw\u1D18\u1D1D\u1D22\u1D49\u1D55lar;\u4024f;\uC000\u{1D555}\u0280;emps\u030B\u1D2D\u1D37\u1D3D\u1D42q\u0100;d\u0352\u1D33ot;\u6251inus;\u6238lus;\u6214quare;\u62A1blebarwedg\xE5\xFAn\u0180adh\u112E\u1D5D\u1D67ownarrow\xF3\u1C83arpoon\u0100lr\u1D72\u1D76ef\xF4\u1CB4igh\xF4\u1CB6\u0162\u1D7F\u1D85karo\xF7\u0F42\u026F\u1D8A\0\0\u1D8Ern;\u631Fop;\u630C\u0180cot\u1D98\u1DA3\u1DA6\u0100ry\u1D9D\u1DA1;\uC000\u{1D4B9};\u4455l;\u69F6rok;\u4111\u0100dr\u1DB0\u1DB4ot;\u62F1i\u0100;f\u1DBA\u1816\u65BF\u0100ah\u1DC0\u1DC3r\xF2\u0429a\xF2\u0FA6angle;\u69A6\u0100ci\u1DD2\u1DD5y;\u445Fgrarr;\u67FF\u0900Dacdefglmnopqrstux\u1E01\u1E09\u1E19\u1E38\u0578\u1E3C\u1E49\u1E61\u1E7E\u1EA5\u1EAF\u1EBD\u1EE1\u1F2A\u1F37\u1F44\u1F4E\u1F5A\u0100Do\u1E06\u1D34o\xF4\u1C89\u0100cs\u1E0E\u1E14ute\u803B\xE9\u40E9ter;\u6A6E\u0200aioy\u1E22\u1E27\u1E31\u1E36ron;\u411Br\u0100;c\u1E2D\u1E2E\u6256\u803B\xEA\u40EAlon;\u6255;\u444Dot;\u4117\u0100Dr\u1E41\u1E45ot;\u6252;\uC000\u{1D522}\u0180;rs\u1E50\u1E51\u1E57\u6A9Aave\u803B\xE8\u40E8\u0100;d\u1E5C\u1E5D\u6A96ot;\u6A98\u0200;ils\u1E6A\u1E6B\u1E72\u1E74\u6A99nters;\u63E7;\u6113\u0100;d\u1E79\u1E7A\u6A95ot;\u6A97\u0180aps\u1E85\u1E89\u1E97cr;\u4113ty\u0180;sv\u1E92\u1E93\u1E95\u6205et\xBB\u1E93p\u01001;\u1E9D\u1EA4\u0133\u1EA1\u1EA3;\u6004;\u6005\u6003\u0100gs\u1EAA\u1EAC;\u414Bp;\u6002\u0100gp\u1EB4\u1EB8on;\u4119f;\uC000\u{1D556}\u0180als\u1EC4\u1ECE\u1ED2r\u0100;s\u1ECA\u1ECB\u62D5l;\u69E3us;\u6A71i\u0180;lv\u1EDA\u1EDB\u1EDF\u43B5on\xBB\u1EDB;\u43F5\u0200csuv\u1EEA\u1EF3\u1F0B\u1F23\u0100io\u1EEF\u1E31rc\xBB\u1E2E\u0269\u1EF9\0\0\u1EFB\xED\u0548ant\u0100gl\u1F02\u1F06tr\xBB\u1E5Dess\xBB\u1E7A\u0180aei\u1F12\u1F16\u1F1Als;\u403Dst;\u625Fv\u0100;D\u0235\u1F20D;\u6A78parsl;\u69E5\u0100Da\u1F2F\u1F33ot;\u6253rr;\u6971\u0180cdi\u1F3E\u1F41\u1EF8r;\u612Fo\xF4\u0352\u0100ah\u1F49\u1F4B;\u43B7\u803B\xF0\u40F0\u0100mr\u1F53\u1F57l\u803B\xEB\u40EBo;\u60AC\u0180cip\u1F61\u1F64\u1F67l;\u4021s\xF4\u056E\u0100eo\u1F6C\u1F74ctatio\xEE\u0559nential\xE5\u0579\u09E1\u1F92\0\u1F9E\0\u1FA1\u1FA7\0\0\u1FC6\u1FCC\0\u1FD3\0\u1FE6\u1FEA\u2000\0\u2008\u205Allingdotse\xF1\u1E44y;\u4444male;\u6640\u0180ilr\u1FAD\u1FB3\u1FC1lig;\u8000\uFB03\u0269\u1FB9\0\0\u1FBDg;\u8000\uFB00ig;\u8000\uFB04;\uC000\u{1D523}lig;\u8000\uFB01lig;\uC000fj\u0180alt\u1FD9\u1FDC\u1FE1t;\u666Dig;\u8000\uFB02ns;\u65B1of;\u4192\u01F0\u1FEE\0\u1FF3f;\uC000\u{1D557}\u0100ak\u05BF\u1FF7\u0100;v\u1FFC\u1FFD\u62D4;\u6AD9artint;\u6A0D\u0100ao\u200C\u2055\u0100cs\u2011\u2052\u03B1\u201A\u2030\u2038\u2045\u2048\0\u2050\u03B2\u2022\u2025\u2027\u202A\u202C\0\u202E\u803B\xBD\u40BD;\u6153\u803B\xBC\u40BC;\u6155;\u6159;\u615B\u01B3\u2034\0\u2036;\u6154;\u6156\u02B4\u203E\u2041\0\0\u2043\u803B\xBE\u40BE;\u6157;\u615C5;\u6158\u01B6\u204C\0\u204E;\u615A;\u615D8;\u615El;\u6044wn;\u6322cr;\uC000\u{1D4BB}\u0880Eabcdefgijlnorstv\u2082\u2089\u209F\u20A5\u20B0\u20B4\u20F0\u20F5\u20FA\u20FF\u2103\u2112\u2138\u0317\u213E\u2152\u219E\u0100;l\u064D\u2087;\u6A8C\u0180cmp\u2090\u2095\u209Dute;\u41F5ma\u0100;d\u209C\u1CDA\u43B3;\u6A86reve;\u411F\u0100iy\u20AA\u20AErc;\u411D;\u4433ot;\u4121\u0200;lqs\u063E\u0642\u20BD\u20C9\u0180;qs\u063E\u064C\u20C4lan\xF4\u0665\u0200;cdl\u0665\u20D2\u20D5\u20E5c;\u6AA9ot\u0100;o\u20DC\u20DD\u6A80\u0100;l\u20E2\u20E3\u6A82;\u6A84\u0100;e\u20EA\u20ED\uC000\u22DB\uFE00s;\u6A94r;\uC000\u{1D524}\u0100;g\u0673\u061Bmel;\u6137cy;\u4453\u0200;Eaj\u065A\u210C\u210E\u2110;\u6A92;\u6AA5;\u6AA4\u0200Eaes\u211B\u211D\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6A8Arox\xBB\u2124\u0100;q\u212E\u212F\u6A88\u0100;q\u212E\u211Bim;\u62E7pf;\uC000\u{1D558}\u0100ci\u2143\u2146r;\u610Am\u0180;el\u066B\u214E\u2150;\u6A8E;\u6A90\u8300>;cdlqr\u05EE\u2160\u216A\u216E\u2173\u2179\u0100ci\u2165\u2167;\u6AA7r;\u6A7Aot;\u62D7Par;\u6995uest;\u6A7C\u0280adels\u2184\u216A\u2190\u0656\u219B\u01F0\u2189\0\u218Epro\xF8\u209Er;\u6978q\u0100lq\u063F\u2196les\xF3\u2088i\xED\u066B\u0100en\u21A3\u21ADrtneqq;\uC000\u2269\uFE00\xC5\u21AA\u0500Aabcefkosy\u21C4\u21C7\u21F1\u21F5\u21FA\u2218\u221D\u222F\u2268\u227Dr\xF2\u03A0\u0200ilmr\u21D0\u21D4\u21D7\u21DBrs\xF0\u1484f\xBB\u2024il\xF4\u06A9\u0100dr\u21E0\u21E4cy;\u444A\u0180;cw\u08F4\u21EB\u21EFir;\u6948;\u61ADar;\u610Firc;\u4125\u0180alr\u2201\u220E\u2213rts\u0100;u\u2209\u220A\u6665it\xBB\u220Alip;\u6026con;\u62B9r;\uC000\u{1D525}s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223A\u223E\u2243\u225E\u2263rr;\u61FFtht;\u623Bk\u0100lr\u2249\u2253eftarrow;\u61A9ightarrow;\u61AAf;\uC000\u{1D559}bar;\u6015\u0180clt\u226F\u2274\u2278r;\uC000\u{1D4BD}as\xE8\u21F4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xBB\u1C5B\u0AE1\u22A3\0\u22AA\0\u22B8\u22C5\u22CE\0\u22D5\u22F3\0\0\u22F8\u2322\u2367\u2362\u237F\0\u2386\u23AA\u23B4cute\u803B\xED\u40ED\u0180;iy\u0771\u22B0\u22B5rc\u803B\xEE\u40EE;\u4438\u0100cx\u22BC\u22BFy;\u4435cl\u803B\xA1\u40A1\u0100fr\u039F\u22C9;\uC000\u{1D526}rave\u803B\xEC\u40EC\u0200;ino\u073E\u22DD\u22E9\u22EE\u0100in\u22E2\u22E6nt;\u6A0Ct;\u622Dfin;\u69DCta;\u6129lig;\u4133\u0180aop\u22FE\u231A\u231D\u0180cgt\u2305\u2308\u2317r;\u412B\u0180elp\u071F\u230F\u2313in\xE5\u078Ear\xF4\u0720h;\u4131f;\u62B7ed;\u41B5\u0280;cfot\u04F4\u232C\u2331\u233D\u2341are;\u6105in\u0100;t\u2338\u2339\u621Eie;\u69DDdo\xF4\u2319\u0280;celp\u0757\u234C\u2350\u235B\u2361al;\u62BA\u0100gr\u2355\u2359er\xF3\u1563\xE3\u234Darhk;\u6A17rod;\u6A3C\u0200cgpt\u236F\u2372\u2376\u237By;\u4451on;\u412Ff;\uC000\u{1D55A}a;\u43B9uest\u803B\xBF\u40BF\u0100ci\u238A\u238Fr;\uC000\u{1D4BE}n\u0280;Edsv\u04F4\u239B\u239D\u23A1\u04F3;\u62F9ot;\u62F5\u0100;v\u23A6\u23A7\u62F4;\u62F3\u0100;i\u0777\u23AElde;\u4129\u01EB\u23B8\0\u23BCcy;\u4456l\u803B\xEF\u40EF\u0300cfmosu\u23CC\u23D7\u23DC\u23E1\u23E7\u23F5\u0100iy\u23D1\u23D5rc;\u4135;\u4439r;\uC000\u{1D527}ath;\u4237pf;\uC000\u{1D55B}\u01E3\u23EC\0\u23F1r;\uC000\u{1D4BF}rcy;\u4458kcy;\u4454\u0400acfghjos\u240B\u2416\u2422\u2427\u242D\u2431\u2435\u243Bppa\u0100;v\u2413\u2414\u43BA;\u43F0\u0100ey\u241B\u2420dil;\u4137;\u443Ar;\uC000\u{1D528}reen;\u4138cy;\u4445cy;\u445Cpf;\uC000\u{1D55C}cr;\uC000\u{1D4C0}\u0B80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248D\u2491\u250E\u253D\u255A\u2580\u264E\u265E\u2665\u2679\u267D\u269A\u26B2\u26D8\u275D\u2768\u278B\u27C0\u2801\u2812\u0180art\u2477\u247A\u247Cr\xF2\u09C6\xF2\u0395ail;\u691Barr;\u690E\u0100;g\u0994\u248B;\u6A8Bar;\u6962\u0963\u24A5\0\u24AA\0\u24B1\0\0\0\0\0\u24B5\u24BA\0\u24C6\u24C8\u24CD\0\u24F9ute;\u413Amptyv;\u69B4ra\xEE\u084Cbda;\u43BBg\u0180;dl\u088E\u24C1\u24C3;\u6991\xE5\u088E;\u6A85uo\u803B\xAB\u40ABr\u0400;bfhlpst\u0899\u24DE\u24E6\u24E9\u24EB\u24EE\u24F1\u24F5\u0100;f\u089D\u24E3s;\u691Fs;\u691D\xEB\u2252p;\u61ABl;\u6939im;\u6973l;\u61A2\u0180;ae\u24FF\u2500\u2504\u6AABil;\u6919\u0100;s\u2509\u250A\u6AAD;\uC000\u2AAD\uFE00\u0180abr\u2515\u2519\u251Drr;\u690Crk;\u6772\u0100ak\u2522\u252Cc\u0100ek\u2528\u252A;\u407B;\u405B\u0100es\u2531\u2533;\u698Bl\u0100du\u2539\u253B;\u698F;\u698D\u0200aeuy\u2546\u254B\u2556\u2558ron;\u413E\u0100di\u2550\u2554il;\u413C\xEC\u08B0\xE2\u2529;\u443B\u0200cqrs\u2563\u2566\u256D\u257Da;\u6936uo\u0100;r\u0E19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694Bh;\u61B2\u0280;fgqs\u258B\u258C\u0989\u25F3\u25FF\u6264t\u0280ahlrt\u2598\u25A4\u25B7\u25C2\u25E8rrow\u0100;t\u0899\u25A1a\xE9\u24F6arpoon\u0100du\u25AF\u25B4own\xBB\u045Ap\xBB\u0966eftarrows;\u61C7ight\u0180ahs\u25CD\u25D6\u25DErrow\u0100;s\u08F4\u08A7arpoon\xF3\u0F98quigarro\xF7\u21F0hreetimes;\u62CB\u0180;qs\u258B\u0993\u25FAlan\xF4\u09AC\u0280;cdgs\u09AC\u260A\u260D\u261D\u2628c;\u6AA8ot\u0100;o\u2614\u2615\u6A7F\u0100;r\u261A\u261B\u6A81;\u6A83\u0100;e\u2622\u2625\uC000\u22DA\uFE00s;\u6A93\u0280adegs\u2633\u2639\u263D\u2649\u264Bppro\xF8\u24C6ot;\u62D6q\u0100gq\u2643\u2645\xF4\u0989gt\xF2\u248C\xF4\u099Bi\xED\u09B2\u0180ilr\u2655\u08E1\u265Asht;\u697C;\uC000\u{1D529}\u0100;E\u099C\u2663;\u6A91\u0161\u2669\u2676r\u0100du\u25B2\u266E\u0100;l\u0965\u2673;\u696Alk;\u6584cy;\u4459\u0280;acht\u0A48\u2688\u268B\u2691\u2696r\xF2\u25C1orne\xF2\u1D08ard;\u696Bri;\u65FA\u0100io\u269F\u26A4dot;\u4140ust\u0100;a\u26AC\u26AD\u63B0che\xBB\u26AD\u0200Eaes\u26BB\u26BD\u26C9\u26D4;\u6268p\u0100;p\u26C3\u26C4\u6A89rox\xBB\u26C4\u0100;q\u26CE\u26CF\u6A87\u0100;q\u26CE\u26BBim;\u62E6\u0400abnoptwz\u26E9\u26F4\u26F7\u271A\u272F\u2741\u2747\u2750\u0100nr\u26EE\u26F1g;\u67ECr;\u61FDr\xEB\u08C1g\u0180lmr\u26FF\u270D\u2714eft\u0100ar\u09E6\u2707ight\xE1\u09F2apsto;\u67FCight\xE1\u09FDparrow\u0100lr\u2725\u2729ef\xF4\u24EDight;\u61AC\u0180afl\u2736\u2739\u273Dr;\u6985;\uC000\u{1D55D}us;\u6A2Dimes;\u6A34\u0161\u274B\u274Fst;\u6217\xE1\u134E\u0180;ef\u2757\u2758\u1800\u65CAnge\xBB\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277C\u2785\u2787r\xF2\u08A8orne\xF2\u1D8Car\u0100;d\u0F98\u2783;\u696D;\u600Eri;\u62BF\u0300achiqt\u2798\u279D\u0A40\u27A2\u27AE\u27BBquo;\u6039r;\uC000\u{1D4C1}m\u0180;eg\u09B2\u27AA\u27AC;\u6A8D;\u6A8F\u0100bu\u252A\u27B3o\u0100;r\u0E1F\u27B9;\u601Arok;\u4142\u8400<;cdhilqr\u082B\u27D2\u2639\u27DC\u27E0\u27E5\u27EA\u27F0\u0100ci\u27D7\u27D9;\u6AA6r;\u6A79re\xE5\u25F2mes;\u62C9arr;\u6976uest;\u6A7B\u0100Pi\u27F5\u27F9ar;\u6996\u0180;ef\u2800\u092D\u181B\u65C3r\u0100du\u2807\u280Dshar;\u694Ahar;\u6966\u0100en\u2817\u2821rtneqq;\uC000\u2268\uFE00\xC5\u281E\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288E\u2893\u28A0\u28A5\u28A8\u28DA\u28E2\u28E4\u0A83\u28F3\u2902Dot;\u623A\u0200clpr\u284E\u2852\u2863\u287Dr\u803B\xAF\u40AF\u0100et\u2857\u2859;\u6642\u0100;e\u285E\u285F\u6720se\xBB\u285F\u0100;s\u103B\u2868to\u0200;dlu\u103B\u2873\u2877\u287Bow\xEE\u048Cef\xF4\u090F\xF0\u13D1ker;\u65AE\u0100oy\u2887\u288Cmma;\u6A29;\u443Cash;\u6014asuredangle\xBB\u1626r;\uC000\u{1D52A}o;\u6127\u0180cdn\u28AF\u28B4\u28C9ro\u803B\xB5\u40B5\u0200;acd\u1464\u28BD\u28C0\u28C4s\xF4\u16A7ir;\u6AF0ot\u80BB\xB7\u01B5us\u0180;bd\u28D2\u1903\u28D3\u6212\u0100;u\u1D3C\u28D8;\u6A2A\u0163\u28DE\u28E1p;\u6ADB\xF2\u2212\xF0\u0A81\u0100dp\u28E9\u28EEels;\u62A7f;\uC000\u{1D55E}\u0100ct\u28F8\u28FDr;\uC000\u{1D4C2}pos\xBB\u159D\u0180;lm\u2909\u290A\u290D\u43BCtimap;\u62B8\u0C00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297E\u2989\u2998\u29DA\u29E9\u2A15\u2A1A\u2A58\u2A5D\u2A83\u2A95\u2AA4\u2AA8\u2B04\u2B07\u2B44\u2B7F\u2BAE\u2C34\u2C67\u2C7C\u2CE9\u0100gt\u2947\u294B;\uC000\u22D9\u0338\u0100;v\u2950\u0BCF\uC000\u226B\u20D2\u0180elt\u295A\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61CDightarrow;\u61CE;\uC000\u22D8\u0338\u0100;v\u297B\u0C47\uC000\u226A\u20D2ightarrow;\u61CF\u0100Dd\u298E\u2993ash;\u62AFash;\u62AE\u0280bcnpt\u29A3\u29A7\u29AC\u29B1\u29CCla\xBB\u02DEute;\u4144g;\uC000\u2220\u20D2\u0280;Eiop\u0D84\u29BC\u29C0\u29C5\u29C8;\uC000\u2A70\u0338d;\uC000\u224B\u0338s;\u4149ro\xF8\u0D84ur\u0100;a\u29D3\u29D4\u666El\u0100;s\u29D3\u0B38\u01F3\u29DF\0\u29E3p\u80BB\xA0\u0B37mp\u0100;e\u0BF9\u0C00\u0280aeouy\u29F4\u29FE\u2A03\u2A10\u2A13\u01F0\u29F9\0\u29FB;\u6A43on;\u4148dil;\u4146ng\u0100;d\u0D7E\u2A0Aot;\uC000\u2A6D\u0338p;\u6A42;\u443Dash;\u6013\u0380;Aadqsx\u0B92\u2A29\u2A2D\u2A3B\u2A41\u2A45\u2A50rr;\u61D7r\u0100hr\u2A33\u2A36k;\u6924\u0100;o\u13F2\u13F0ot;\uC000\u2250\u0338ui\xF6\u0B63\u0100ei\u2A4A\u2A4Ear;\u6928\xED\u0B98ist\u0100;s\u0BA0\u0B9Fr;\uC000\u{1D52B}\u0200Eest\u0BC5\u2A66\u2A79\u2A7C\u0180;qs\u0BBC\u2A6D\u0BE1\u0180;qs\u0BBC\u0BC5\u2A74lan\xF4\u0BE2i\xED\u0BEA\u0100;r\u0BB6\u2A81\xBB\u0BB7\u0180Aap\u2A8A\u2A8D\u2A91r\xF2\u2971rr;\u61AEar;\u6AF2\u0180;sv\u0F8D\u2A9C\u0F8C\u0100;d\u2AA1\u2AA2\u62FC;\u62FAcy;\u445A\u0380AEadest\u2AB7\u2ABA\u2ABE\u2AC2\u2AC5\u2AF6\u2AF9r\xF2\u2966;\uC000\u2266\u0338rr;\u619Ar;\u6025\u0200;fqs\u0C3B\u2ACE\u2AE3\u2AEFt\u0100ar\u2AD4\u2AD9rro\xF7\u2AC1ightarro\xF7\u2A90\u0180;qs\u0C3B\u2ABA\u2AEAlan\xF4\u0C55\u0100;s\u0C55\u2AF4\xBB\u0C36i\xED\u0C5D\u0100;r\u0C35\u2AFEi\u0100;e\u0C1A\u0C25i\xE4\u0D90\u0100pt\u2B0C\u2B11f;\uC000\u{1D55F}\u8180\xAC;in\u2B19\u2B1A\u2B36\u40ACn\u0200;Edv\u0B89\u2B24\u2B28\u2B2E;\uC000\u22F9\u0338ot;\uC000\u22F5\u0338\u01E1\u0B89\u2B33\u2B35;\u62F7;\u62F6i\u0100;v\u0CB8\u2B3C\u01E1\u0CB8\u2B41\u2B43;\u62FE;\u62FD\u0180aor\u2B4B\u2B63\u2B69r\u0200;ast\u0B7B\u2B55\u2B5A\u2B5Flle\xEC\u0B7Bl;\uC000\u2AFD\u20E5;\uC000\u2202\u0338lint;\u6A14\u0180;ce\u0C92\u2B70\u2B73u\xE5\u0CA5\u0100;c\u0C98\u2B78\u0100;e\u0C92\u2B7D\xF1\u0C98\u0200Aait\u2B88\u2B8B\u2B9D\u2BA7r\xF2\u2988rr\u0180;cw\u2B94\u2B95\u2B99\u619B;\uC000\u2933\u0338;\uC000\u219D\u0338ghtarrow\xBB\u2B95ri\u0100;e\u0CCB\u0CD6\u0380chimpqu\u2BBD\u2BCD\u2BD9\u2B04\u0B78\u2BE4\u2BEF\u0200;cer\u0D32\u2BC6\u0D37\u2BC9u\xE5\u0D45;\uC000\u{1D4C3}ort\u026D\u2B05\0\0\u2BD6ar\xE1\u2B56m\u0100;e\u0D6E\u2BDF\u0100;q\u0D74\u0D73su\u0100bp\u2BEB\u2BED\xE5\u0CF8\xE5\u0D0B\u0180bcp\u2BF6\u2C11\u2C19\u0200;Ees\u2BFF\u2C00\u0D22\u2C04\u6284;\uC000\u2AC5\u0338et\u0100;e\u0D1B\u2C0Bq\u0100;q\u0D23\u2C00c\u0100;e\u0D32\u2C17\xF1\u0D38\u0200;Ees\u2C22\u2C23\u0D5F\u2C27\u6285;\uC000\u2AC6\u0338et\u0100;e\u0D58\u2C2Eq\u0100;q\u0D60\u2C23\u0200gilr\u2C3D\u2C3F\u2C45\u2C47\xEC\u0BD7lde\u803B\xF1\u40F1\xE7\u0C43iangle\u0100lr\u2C52\u2C5Ceft\u0100;e\u0C1A\u2C5A\xF1\u0C26ight\u0100;e\u0CCB\u2C65\xF1\u0CD7\u0100;m\u2C6C\u2C6D\u43BD\u0180;es\u2C74\u2C75\u2C79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2C8F\u2C94\u2C99\u2C9E\u2CA3\u2CB0\u2CB6\u2CD3\u2CE3ash;\u62ADarr;\u6904p;\uC000\u224D\u20D2ash;\u62AC\u0100et\u2CA8\u2CAC;\uC000\u2265\u20D2;\uC000>\u20D2nfin;\u69DE\u0180Aet\u2CBD\u2CC1\u2CC5rr;\u6902;\uC000\u2264\u20D2\u0100;r\u2CCA\u2CCD\uC000<\u20D2ie;\uC000\u22B4\u20D2\u0100At\u2CD8\u2CDCrr;\u6903rie;\uC000\u22B5\u20D2im;\uC000\u223C\u20D2\u0180Aan\u2CF0\u2CF4\u2D02rr;\u61D6r\u0100hr\u2CFA\u2CFDk;\u6923\u0100;o\u13E7\u13E5ear;\u6927\u1253\u1A95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2D2D\0\u2D38\u2D48\u2D60\u2D65\u2D72\u2D84\u1B07\0\0\u2D8D\u2DAB\0\u2DC8\u2DCE\0\u2DDC\u2E19\u2E2B\u2E3E\u2E43\u0100cs\u2D31\u1A97ute\u803B\xF3\u40F3\u0100iy\u2D3C\u2D45r\u0100;c\u1A9E\u2D42\u803B\xF4\u40F4;\u443E\u0280abios\u1AA0\u2D52\u2D57\u01C8\u2D5Alac;\u4151v;\u6A38old;\u69BClig;\u4153\u0100cr\u2D69\u2D6Dir;\u69BF;\uC000\u{1D52C}\u036F\u2D79\0\0\u2D7C\0\u2D82n;\u42DBave\u803B\xF2\u40F2;\u69C1\u0100bm\u2D88\u0DF4ar;\u69B5\u0200acit\u2D95\u2D98\u2DA5\u2DA8r\xF2\u1A80\u0100ir\u2D9D\u2DA0r;\u69BEoss;\u69BBn\xE5\u0E52;\u69C0\u0180aei\u2DB1\u2DB5\u2DB9cr;\u414Dga;\u43C9\u0180cdn\u2DC0\u2DC5\u01CDron;\u43BF;\u69B6pf;\uC000\u{1D560}\u0180ael\u2DD4\u2DD7\u01D2r;\u69B7rp;\u69B9\u0380;adiosv\u2DEA\u2DEB\u2DEE\u2E08\u2E0D\u2E10\u2E16\u6228r\xF2\u1A86\u0200;efm\u2DF7\u2DF8\u2E02\u2E05\u6A5Dr\u0100;o\u2DFE\u2DFF\u6134f\xBB\u2DFF\u803B\xAA\u40AA\u803B\xBA\u40BAgof;\u62B6r;\u6A56lope;\u6A57;\u6A5B\u0180clo\u2E1F\u2E21\u2E27\xF2\u2E01ash\u803B\xF8\u40F8l;\u6298i\u016C\u2E2F\u2E34de\u803B\xF5\u40F5es\u0100;a\u01DB\u2E3As;\u6A36ml\u803B\xF6\u40F6bar;\u633D\u0AE1\u2E5E\0\u2E7D\0\u2E80\u2E9D\0\u2EA2\u2EB9\0\0\u2ECB\u0E9C\0\u2F13\0\0\u2F2B\u2FBC\0\u2FC8r\u0200;ast\u0403\u2E67\u2E72\u0E85\u8100\xB6;l\u2E6D\u2E6E\u40B6le\xEC\u0403\u0269\u2E78\0\0\u2E7Bm;\u6AF3;\u6AFDy;\u443Fr\u0280cimpt\u2E8B\u2E8F\u2E93\u1865\u2E97nt;\u4025od;\u402Eil;\u6030enk;\u6031r;\uC000\u{1D52D}\u0180imo\u2EA8\u2EB0\u2EB4\u0100;v\u2EAD\u2EAE\u43C6;\u43D5ma\xF4\u0A76ne;\u660E\u0180;tv\u2EBF\u2EC0\u2EC8\u43C0chfork\xBB\u1FFD;\u43D6\u0100au\u2ECF\u2EDFn\u0100ck\u2ED5\u2EDDk\u0100;h\u21F4\u2EDB;\u610E\xF6\u21F4s\u0480;abcdemst\u2EF3\u2EF4\u1908\u2EF9\u2EFD\u2F04\u2F06\u2F0A\u2F0E\u402Bcir;\u6A23ir;\u6A22\u0100ou\u1D40\u2F02;\u6A25;\u6A72n\u80BB\xB1\u0E9Dim;\u6A26wo;\u6A27\u0180ipu\u2F19\u2F20\u2F25ntint;\u6A15f;\uC000\u{1D561}nd\u803B\xA3\u40A3\u0500;Eaceinosu\u0EC8\u2F3F\u2F41\u2F44\u2F47\u2F81\u2F89\u2F92\u2F7E\u2FB6;\u6AB3p;\u6AB7u\xE5\u0ED9\u0100;c\u0ECE\u2F4C\u0300;acens\u0EC8\u2F59\u2F5F\u2F66\u2F68\u2F7Eppro\xF8\u2F43urlye\xF1\u0ED9\xF1\u0ECE\u0180aes\u2F6F\u2F76\u2F7Approx;\u6AB9qq;\u6AB5im;\u62E8i\xED\u0EDFme\u0100;s\u2F88\u0EAE\u6032\u0180Eas\u2F78\u2F90\u2F7A\xF0\u2F75\u0180dfp\u0EEC\u2F99\u2FAF\u0180als\u2FA0\u2FA5\u2FAAlar;\u632Eine;\u6312urf;\u6313\u0100;t\u0EFB\u2FB4\xEF\u0EFBrel;\u62B0\u0100ci\u2FC0\u2FC5r;\uC000\u{1D4C5};\u43C8ncsp;\u6008\u0300fiopsu\u2FDA\u22E2\u2FDF\u2FE5\u2FEB\u2FF1r;\uC000\u{1D52E}pf;\uC000\u{1D562}rime;\u6057cr;\uC000\u{1D4C6}\u0180aeo\u2FF8\u3009\u3013t\u0100ei\u2FFE\u3005rnion\xF3\u06B0nt;\u6A16st\u0100;e\u3010\u3011\u403F\xF1\u1F19\xF4\u0F14\u0A80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30E0\u310E\u312B\u3147\u3162\u3172\u318E\u3206\u3215\u3224\u3229\u3258\u326E\u3272\u3290\u32B0\u32B7\u0180art\u3047\u304A\u304Cr\xF2\u10B3\xF2\u03DDail;\u691Car\xF2\u1C65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307F\u308F\u3094\u30CC\u0100eu\u306D\u3071;\uC000\u223D\u0331te;\u4155i\xE3\u116Emptyv;\u69B3g\u0200;del\u0FD1\u3089\u308B\u308D;\u6992;\u69A5\xE5\u0FD1uo\u803B\xBB\u40BBr\u0580;abcfhlpstw\u0FDC\u30AC\u30AF\u30B7\u30B9\u30BC\u30BE\u30C0\u30C3\u30C7\u30CAp;\u6975\u0100;f\u0FE0\u30B4s;\u6920;\u6933s;\u691E\xEB\u225D\xF0\u272El;\u6945im;\u6974l;\u61A3;\u619D\u0100ai\u30D1\u30D5il;\u691Ao\u0100;n\u30DB\u30DC\u6236al\xF3\u0F1E\u0180abr\u30E7\u30EA\u30EEr\xF2\u17E5rk;\u6773\u0100ak\u30F3\u30FDc\u0100ek\u30F9\u30FB;\u407D;\u405D\u0100es\u3102\u3104;\u698Cl\u0100du\u310A\u310C;\u698E;\u6990\u0200aeuy\u3117\u311C\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xEC\u0FF2\xE2\u30FA;\u4440\u0200clqs\u3134\u3137\u313D\u3144a;\u6937dhar;\u6969uo\u0100;r\u020E\u020Dh;\u61B3\u0180acg\u314E\u315F\u0F44l\u0200;ips\u0F78\u3158\u315B\u109Cn\xE5\u10BBar\xF4\u0FA9t;\u65AD\u0180ilr\u3169\u1023\u316Esht;\u697D;\uC000\u{1D52F}\u0100ao\u3177\u3186r\u0100du\u317D\u317F\xBB\u047B\u0100;l\u1091\u3184;\u696C\u0100;v\u318B\u318C\u43C1;\u43F1\u0180gns\u3195\u31F9\u31FCht\u0300ahlrst\u31A4\u31B0\u31C2\u31D8\u31E4\u31EErrow\u0100;t\u0FDC\u31ADa\xE9\u30C8arpoon\u0100du\u31BB\u31BFow\xEE\u317Ep\xBB\u1092eft\u0100ah\u31CA\u31D0rrow\xF3\u0FEAarpoon\xF3\u0551ightarrows;\u61C9quigarro\xF7\u30CBhreetimes;\u62CCg;\u42DAingdotse\xF1\u1F32\u0180ahm\u320D\u3210\u3213r\xF2\u0FEAa\xF2\u0551;\u600Foust\u0100;a\u321E\u321F\u63B1che\xBB\u321Fmid;\u6AEE\u0200abpt\u3232\u323D\u3240\u3252\u0100nr\u3237\u323Ag;\u67EDr;\u61FEr\xEB\u1003\u0180afl\u3247\u324A\u324Er;\u6986;\uC000\u{1D563}us;\u6A2Eimes;\u6A35\u0100ap\u325D\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6A12ar\xF2\u31E3\u0200achq\u327B\u3280\u10BC\u3285quo;\u603Ar;\uC000\u{1D4C7}\u0100bu\u30FB\u328Ao\u0100;r\u0214\u0213\u0180hir\u3297\u329B\u32A0re\xE5\u31F8mes;\u62CAi\u0200;efl\u32AA\u1059\u1821\u32AB\u65B9tri;\u69CEluhar;\u6968;\u611E\u0D61\u32D5\u32DB\u32DF\u332C\u3338\u3371\0\u337A\u33A4\0\0\u33EC\u33F0\0\u3428\u3448\u345A\u34AD\u34B1\u34CA\u34F1\0\u3616\0\0\u3633cute;\u415Bqu\xEF\u27BA\u0500;Eaceinpsy\u11ED\u32F3\u32F5\u32FF\u3302\u330B\u330F\u331F\u3326\u3329;\u6AB4\u01F0\u32FA\0\u32FC;\u6AB8on;\u4161u\xE5\u11FE\u0100;d\u11F3\u3307il;\u415Frc;\u415D\u0180Eas\u3316\u3318\u331B;\u6AB6p;\u6ABAim;\u62E9olint;\u6A13i\xED\u1204;\u4441ot\u0180;be\u3334\u1D47\u3335\u62C5;\u6A66\u0380Aacmstx\u3346\u334A\u3357\u335B\u335E\u3363\u336Drr;\u61D8r\u0100hr\u3350\u3352\xEB\u2228\u0100;o\u0A36\u0A34t\u803B\xA7\u40A7i;\u403Bwar;\u6929m\u0100in\u3369\xF0nu\xF3\xF1t;\u6736r\u0100;o\u3376\u2055\uC000\u{1D530}\u0200acoy\u3382\u3386\u3391\u33A0rp;\u666F\u0100hy\u338B\u338Fcy;\u4449;\u4448rt\u026D\u3399\0\0\u339Ci\xE4\u1464ara\xEC\u2E6F\u803B\xAD\u40AD\u0100gm\u33A8\u33B4ma\u0180;fv\u33B1\u33B2\u33B2\u43C3;\u43C2\u0400;deglnpr\u12AB\u33C5\u33C9\u33CE\u33D6\u33DE\u33E1\u33E6ot;\u6A6A\u0100;q\u12B1\u12B0\u0100;E\u33D3\u33D4\u6A9E;\u6AA0\u0100;E\u33DB\u33DC\u6A9D;\u6A9Fe;\u6246lus;\u6A24arr;\u6972ar\xF2\u113D\u0200aeit\u33F8\u3408\u340F\u3417\u0100ls\u33FD\u3404lsetm\xE9\u336Ahp;\u6A33parsl;\u69E4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341C\u341D\u6AAA\u0100;s\u3422\u3423\u6AAC;\uC000\u2AAC\uFE00\u0180flp\u342E\u3433\u3442tcy;\u444C\u0100;b\u3438\u3439\u402F\u0100;a\u343E\u343F\u69C4r;\u633Ff;\uC000\u{1D564}a\u0100dr\u344D\u0402es\u0100;u\u3454\u3455\u6660it\xBB\u3455\u0180csu\u3460\u3479\u349F\u0100au\u3465\u346Fp\u0100;s\u1188\u346B;\uC000\u2293\uFE00p\u0100;s\u11B4\u3475;\uC000\u2294\uFE00u\u0100bp\u347F\u348F\u0180;es\u1197\u119C\u3486et\u0100;e\u1197\u348D\xF1\u119D\u0180;es\u11A8\u11AD\u3496et\u0100;e\u11A8\u349D\xF1\u11AE\u0180;af\u117B\u34A6\u05B0r\u0165\u34AB\u05B1\xBB\u117Car\xF2\u1148\u0200cemt\u34B9\u34BE\u34C2\u34C5r;\uC000\u{1D4C8}tm\xEE\xF1i\xEC\u3415ar\xE6\u11BE\u0100ar\u34CE\u34D5r\u0100;f\u34D4\u17BF\u6606\u0100an\u34DA\u34EDight\u0100ep\u34E3\u34EApsilo\xEE\u1EE0h\xE9\u2EAFs\xBB\u2852\u0280bcmnp\u34FB\u355E\u1209\u358B\u358E\u0480;Edemnprs\u350E\u350F\u3511\u3515\u351E\u3523\u352C\u3531\u3536\u6282;\u6AC5ot;\u6ABD\u0100;d\u11DA\u351Aot;\u6AC3ult;\u6AC1\u0100Ee\u3528\u352A;\u6ACB;\u628Alus;\u6ABFarr;\u6979\u0180eiu\u353D\u3552\u3555t\u0180;en\u350E\u3545\u354Bq\u0100;q\u11DA\u350Feq\u0100;q\u352B\u3528m;\u6AC7\u0100bp\u355A\u355C;\u6AD5;\u6AD3c\u0300;acens\u11ED\u356C\u3572\u3579\u357B\u3326ppro\xF8\u32FAurlye\xF1\u11FE\xF1\u11F3\u0180aes\u3582\u3588\u331Bppro\xF8\u331Aq\xF1\u3317g;\u666A\u0680123;Edehlmnps\u35A9\u35AC\u35AF\u121C\u35B2\u35B4\u35C0\u35C9\u35D5\u35DA\u35DF\u35E8\u35ED\u803B\xB9\u40B9\u803B\xB2\u40B2\u803B\xB3\u40B3;\u6AC6\u0100os\u35B9\u35BCt;\u6ABEub;\u6AD8\u0100;d\u1222\u35C5ot;\u6AC4s\u0100ou\u35CF\u35D2l;\u67C9b;\u6AD7arr;\u697Bult;\u6AC2\u0100Ee\u35E4\u35E6;\u6ACC;\u628Blus;\u6AC0\u0180eiu\u35F4\u3609\u360Ct\u0180;en\u121C\u35FC\u3602q\u0100;q\u1222\u35B2eq\u0100;q\u35E7\u35E4m;\u6AC8\u0100bp\u3611\u3613;\u6AD4;\u6AD6\u0180Aan\u361C\u3620\u362Drr;\u61D9r\u0100hr\u3626\u3628\xEB\u222E\u0100;o\u0A2B\u0A29war;\u692Alig\u803B\xDF\u40DF\u0BE1\u3651\u365D\u3660\u12CE\u3673\u3679\0\u367E\u36C2\0\0\0\0\0\u36DB\u3703\0\u3709\u376C\0\0\0\u3787\u0272\u3656\0\0\u365Bget;\u6316;\u43C4r\xEB\u0E5F\u0180aey\u3666\u366B\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uC000\u{1D531}\u0200eiko\u3686\u369D\u36B5\u36BC\u01F2\u368B\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369B\u43B8ym;\u43D1\u0100cn\u36A2\u36B2k\u0100as\u36A8\u36AEppro\xF8\u12C1im\xBB\u12ACs\xF0\u129E\u0100as\u36BA\u36AE\xF0\u12C1rn\u803B\xFE\u40FE\u01EC\u031F\u36C6\u22E7es\u8180\xD7;bd\u36CF\u36D0\u36D8\u40D7\u0100;a\u190F\u36D5r;\u6A31;\u6A30\u0180eps\u36E1\u36E3\u3700\xE1\u2A4D\u0200;bcf\u0486\u36EC\u36F0\u36F4ot;\u6336ir;\u6AF1\u0100;o\u36F9\u36FC\uC000\u{1D565}rk;\u6ADA\xE1\u3362rime;\u6034\u0180aip\u370F\u3712\u3764d\xE5\u1248\u0380adempst\u3721\u374D\u3740\u3751\u3757\u375C\u375Fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65B5own\xBB\u1DBBeft\u0100;e\u2800\u373E\xF1\u092E;\u625Cight\u0100;e\u32AA\u374B\xF1\u105Aot;\u65ECinus;\u6A3Alus;\u6A39b;\u69CDime;\u6A3Bezium;\u63E2\u0180cht\u3772\u377D\u3781\u0100ry\u3777\u377B;\uC000\u{1D4C9};\u4446cy;\u445Brok;\u4167\u0100io\u378B\u378Ex\xF4\u1777head\u0100lr\u3797\u37A0eftarro\xF7\u084Fightarrow\xBB\u0F5D\u0900AHabcdfghlmoprstuw\u37D0\u37D3\u37D7\u37E4\u37F0\u37FC\u380E\u381C\u3823\u3834\u3851\u385D\u386B\u38A9\u38CC\u38D2\u38EA\u38F6r\xF2\u03EDar;\u6963\u0100cr\u37DC\u37E2ute\u803B\xFA\u40FA\xF2\u1150r\u01E3\u37EA\0\u37EDy;\u445Eve;\u416D\u0100iy\u37F5\u37FArc\u803B\xFB\u40FB;\u4443\u0180abh\u3803\u3806\u380Br\xF2\u13ADlac;\u4171a\xF2\u13C3\u0100ir\u3813\u3818sht;\u697E;\uC000\u{1D532}rave\u803B\xF9\u40F9\u0161\u3827\u3831r\u0100lr\u382C\u382E\xBB\u0957\xBB\u1083lk;\u6580\u0100ct\u3839\u384D\u026F\u383F\0\0\u384Arn\u0100;e\u3845\u3846\u631Cr\xBB\u3846op;\u630Fri;\u65F8\u0100al\u3856\u385Acr;\u416B\u80BB\xA8\u0349\u0100gp\u3862\u3866on;\u4173f;\uC000\u{1D566}\u0300adhlsu\u114B\u3878\u387D\u1372\u3891\u38A0own\xE1\u13B3arpoon\u0100lr\u3888\u388Cef\xF4\u382Digh\xF4\u382Fi\u0180;hl\u3899\u389A\u389C\u43C5\xBB\u13FAon\xBB\u389Aparrows;\u61C8\u0180cit\u38B0\u38C4\u38C8\u026F\u38B6\0\0\u38C1rn\u0100;e\u38BC\u38BD\u631Dr\xBB\u38BDop;\u630Eng;\u416Fri;\u65F9cr;\uC000\u{1D4CA}\u0180dir\u38D9\u38DD\u38E2ot;\u62F0lde;\u4169i\u0100;f\u3730\u38E8\xBB\u1813\u0100am\u38EF\u38F2r\xF2\u38A8l\u803B\xFC\u40FCangle;\u69A7\u0780ABDacdeflnoprsz\u391C\u391F\u3929\u392D\u39B5\u39B8\u39BD\u39DF\u39E4\u39E8\u39F3\u39F9\u39FD\u3A01\u3A20r\xF2\u03F7ar\u0100;v\u3926\u3927\u6AE8;\u6AE9as\xE8\u03E1\u0100nr\u3932\u3937grt;\u699C\u0380eknprst\u34E3\u3946\u394B\u3952\u395D\u3964\u3996app\xE1\u2415othin\xE7\u1E96\u0180hir\u34EB\u2EC8\u3959op\xF4\u2FB5\u0100;h\u13B7\u3962\xEF\u318D\u0100iu\u3969\u396Dgm\xE1\u33B3\u0100bp\u3972\u3984setneq\u0100;q\u397D\u3980\uC000\u228A\uFE00;\uC000\u2ACB\uFE00setneq\u0100;q\u398F\u3992\uC000\u228B\uFE00;\uC000\u2ACC\uFE00\u0100hr\u399B\u399Fet\xE1\u369Ciangle\u0100lr\u39AA\u39AFeft\xBB\u0925ight\xBB\u1051y;\u4432ash\xBB\u1036\u0180elr\u39C4\u39D2\u39D7\u0180;be\u2DEA\u39CB\u39CFar;\u62BBq;\u625Alip;\u62EE\u0100bt\u39DC\u1468a\xF2\u1469r;\uC000\u{1D533}tr\xE9\u39AEsu\u0100bp\u39EF\u39F1\xBB\u0D1C\xBB\u0D59pf;\uC000\u{1D567}ro\xF0\u0EFBtr\xE9\u39B4\u0100cu\u3A06\u3A0Br;\uC000\u{1D4CB}\u0100bp\u3A10\u3A18n\u0100Ee\u3980\u3A16\xBB\u397En\u0100Ee\u3992\u3A1E\xBB\u3990igzag;\u699A\u0380cefoprs\u3A36\u3A3B\u3A56\u3A5B\u3A54\u3A61\u3A6Airc;\u4175\u0100di\u3A40\u3A51\u0100bg\u3A45\u3A49ar;\u6A5Fe\u0100;q\u15FA\u3A4F;\u6259erp;\u6118r;\uC000\u{1D534}pf;\uC000\u{1D568}\u0100;e\u1479\u3A66at\xE8\u1479cr;\uC000\u{1D4CC}\u0AE3\u178E\u3A87\0\u3A8B\0\u3A90\u3A9B\0\0\u3A9D\u3AA8\u3AAB\u3AAF\0\0\u3AC3\u3ACE\0\u3AD8\u17DC\u17DFtr\xE9\u17D1r;\uC000\u{1D535}\u0100Aa\u3A94\u3A97r\xF2\u03C3r\xF2\u09F6;\u43BE\u0100Aa\u3AA1\u3AA4r\xF2\u03B8r\xF2\u09EBa\xF0\u2713is;\u62FB\u0180dpt\u17A4\u3AB5\u3ABE\u0100fl\u3ABA\u17A9;\uC000\u{1D569}im\xE5\u17B2\u0100Aa\u3AC7\u3ACAr\xF2\u03CEr\xF2\u0A01\u0100cq\u3AD2\u17B8r;\uC000\u{1D4CD}\u0100pt\u17D6\u3ADCr\xE9\u17D4\u0400acefiosu\u3AF0\u3AFD\u3B08\u3B0C\u3B11\u3B15\u3B1B\u3B21c\u0100uy\u3AF6\u3AFBte\u803B\xFD\u40FD;\u444F\u0100iy\u3B02\u3B06rc;\u4177;\u444Bn\u803B\xA5\u40A5r;\uC000\u{1D536}cy;\u4457pf;\uC000\u{1D56A}cr;\uC000\u{1D4CE}\u0100cm\u3B26\u3B29y;\u444El\u803B\xFF\u40FF\u0500acdefhiosw\u3B42\u3B48\u3B54\u3B58\u3B64\u3B69\u3B6D\u3B74\u3B7A\u3B80cute;\u417A\u0100ay\u3B4D\u3B52ron;\u417E;\u4437ot;\u417C\u0100et\u3B5D\u3B61tr\xE6\u155Fa;\u43B6r;\uC000\u{1D537}cy;\u4436grarr;\u61DDpf;\uC000\u{1D56B}cr;\uC000\u{1D4CF}\u0100jn\u3B85\u3B87;\u600Dj;\u600C'.split("").map(t=>t.charCodeAt(0)));var Sge=new Uint16Array("\u0200aglq	\x1B\u026D\0\0p;\u4026os;\u4027t;\u403Et;\u403Cuot;\u4022".split("").map(t=>t.charCodeAt(0)));var lK,gGe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),uK=(lK=String.fromCodePoint)!==null&&lK!==void 0?lK:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function dK(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=gGe.get(t))!==null&&e!==void 0?e:t}var ps;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(ps||(ps={}));var vGe=32,gv;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(gv||(gv={}));function pK(t){return t>=ps.ZERO&&t<=ps.NINE}function yGe(t){return t>=ps.UPPER_A&&t<=ps.UPPER_F||t>=ps.LOWER_A&&t<=ps.LOWER_F}function bGe(t){return t>=ps.UPPER_A&&t<=ps.UPPER_Z||t>=ps.LOWER_A&&t<=ps.LOWER_Z||pK(t)}function _Ge(t){return t===ps.EQUALS||bGe(t)}var ds;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(ds||(ds={}));var Tp;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(Tp||(Tp={}));var p5=class{constructor(e,r,n){this.decodeTree=e,this.emitCodePoint=r,this.errors=n,this.state=ds.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Tp.Strict}startEntity(e){this.decodeMode=e,this.state=ds.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,r){switch(this.state){case ds.EntityStart:return e.charCodeAt(r)===ps.NUM?(this.state=ds.NumericStart,this.consumed+=1,this.stateNumericStart(e,r+1)):(this.state=ds.NamedEntity,this.stateNamedEntity(e,r));case ds.NumericStart:return this.stateNumericStart(e,r);case ds.NumericDecimal:return this.stateNumericDecimal(e,r);case ds.NumericHex:return this.stateNumericHex(e,r);case ds.NamedEntity:return this.stateNamedEntity(e,r)}}stateNumericStart(e,r){return r>=e.length?-1:(e.charCodeAt(r)|vGe)===ps.LOWER_X?(this.state=ds.NumericHex,this.consumed+=1,this.stateNumericHex(e,r+1)):(this.state=ds.NumericDecimal,this.stateNumericDecimal(e,r))}addToNumericResult(e,r,n,o){if(r!==n){let s=n-r;this.result=this.result*Math.pow(o,s)+parseInt(e.substr(r,s),o),this.consumed+=s}}stateNumericHex(e,r){let n=r;for(;r<e.length;){let o=e.charCodeAt(r);if(pK(o)||yGe(o))r+=1;else return this.addToNumericResult(e,n,r,16),this.emitNumericEntity(o,3)}return this.addToNumericResult(e,n,r,16),-1}stateNumericDecimal(e,r){let n=r;for(;r<e.length;){let o=e.charCodeAt(r);if(pK(o))r+=1;else return this.addToNumericResult(e,n,r,10),this.emitNumericEntity(o,2)}return this.addToNumericResult(e,n,r,10),-1}emitNumericEntity(e,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===ps.SEMI)this.consumed+=1;else if(this.decodeMode===Tp.Strict)return 0;return this.emitCodePoint(dK(this.result),this.consumed),this.errors&&(e!==ps.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,r){let{decodeTree:n}=this,o=n[this.treeIndex],s=(o&gv.VALUE_LENGTH)>>14;for(;r<e.length;r++,this.excess++){let a=e.charCodeAt(r);if(this.treeIndex=xGe(n,o,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===Tp.Attribute&&(s===0||_Ge(a))?0:this.emitNotTerminatedNamedEntity();if(o=n[this.treeIndex],s=(o&gv.VALUE_LENGTH)>>14,s!==0){if(a===ps.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Tp.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;let{result:r,decodeTree:n}=this,o=(n[r]&gv.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,o,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,r,n){let{decodeTree:o}=this;return this.emitCodePoint(r===1?o[e]&~gv.VALUE_LENGTH:o[e+1],n),r===3&&this.emitCodePoint(o[e+2],n),n}end(){var e;switch(this.state){case ds.NamedEntity:return this.result!==0&&(this.decodeMode!==Tp.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case ds.NumericDecimal:return this.emitNumericEntity(0,2);case ds.NumericHex:return this.emitNumericEntity(0,3);case ds.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case ds.EntityStart:return 0}}};function Ige(t){let e="",r=new p5(t,n=>e+=uK(n));return function(o,s){let a=0,c=0;for(;(c=o.indexOf("&",c))>=0;){e+=o.slice(a,c),r.startEntity(s);let u=r.write(o,c+1);if(u<0){a=c+r.end();break}a=c+u,c=u===0?a+1:a}let l=e+o.slice(a);return e="",l}}function xGe(t,e,r,n){let o=(e&gv.BRANCH_LENGTH)>>7,s=e&gv.JUMP_TABLE;if(o===0)return s!==0&&n===s?r:-1;if(s){let l=n-s;return l<0||l>=o?-1:t[r+l]-1}let a=r,c=a+o-1;for(;a<=c;){let l=a+c>>>1,u=t[l];if(u<n)a=l+1;else if(u>n)c=l-1;else return t[l+o]}return-1}var SGe=Ige(xge),F4t=Ige(Sge);function vv(t,e=Tp.Legacy){return SGe(t,e)}function f5(t){for(let e=1;e<t.length;e++)t[e][0]+=t[e-1][0]+1;return t}var IGe=new Map(f5([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(f5([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(f5([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(f5([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var CGe=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),TGe=String.prototype.codePointAt!=null?(t,e)=>t.codePointAt(e):(t,e)=>(t.charCodeAt(e)&64512)===55296?(t.charCodeAt(e)-55296)*1024+t.charCodeAt(e+1)-56320+65536:t.charCodeAt(e);function fK(t,e){return function(n){let o,s=0,a="";for(;o=t.exec(n);)s!==o.index&&(a+=n.substring(s,o.index)),a+=e.get(o[0].charCodeAt(0)),s=o.index+1;return a+n.substring(s)}}var Cge=fK(/[&<>'"]/g,CGe),Tge=fK(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),Ege=fK(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var wge;(function(t){t[t.XML=0]="XML",t[t.HTML=1]="HTML"})(wge||(wge={}));var kge;(function(t){t[t.UTF8=0]="UTF8",t[t.ASCII=1]="ASCII",t[t.Extensive=2]="Extensive",t[t.Attribute=3]="Attribute",t[t.Text=4]="Text"})(kge||(kge={}));function kGe(t){return Object.prototype.toString.call(t)}function m5(t){return kGe(t)==="[object String]"}var RGe=Object.prototype.hasOwnProperty;function PGe(t,e){return RGe.call(t,e)}function PI(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){if(r){if(typeof r!="object")throw new TypeError(r+"must be object");Object.keys(r).forEach(function(n){t[n]=r[n]})}}),t}function hK(t,e,r){return[].concat(t.slice(0,e),r,t.slice(e+1))}function h5(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function L2(t){if(t>65535){t-=65536;let e=55296+(t>>10),r=56320+(t&1023);return String.fromCharCode(e,r)}return String.fromCharCode(t)}var Age=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,AGe=/&([a-z#][a-z0-9]{1,31});/gi,DGe=new RegExp(Age.source+"|"+AGe.source,"gi"),NGe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function LGe(t,e){if(e.charCodeAt(0)===35&&NGe.test(e)){let n=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return h5(n)?L2(n):t}let r=vv(t);return r!==t?r:t}function OGe(t){return t.indexOf("\\")<0?t:t.replace(Age,"$1")}function yv(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(DGe,function(e,r,n){return r||LGe(e,n)})}var MGe=/[&<>"]/,FGe=/[&<>"]/g,UGe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function BGe(t){return UGe[t]}function Vm(t){return MGe.test(t)?t.replace(FGe,BGe):t}var qGe=/[.?*+^$[\]\\(){}|-]/g;function jGe(t){return t.replace(qGe,"\\$&")}function Er(t){switch(t){case 9:case 32:return!0}return!1}function R_(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function P_(t){return RI.test(t)}function A_(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function D_(t){return t=t.trim().replace(/\s+/g," "),"\u1E9E".toLowerCase()==="\u1E7E"&&(t=t.replace(/ẞ/g,"\xDF")),t.toLowerCase().toUpperCase()}var VGe={mdurl:c5,ucmicro:cK};var _K={};Pn(_K,{parseLinkDestination:()=>yK,parseLinkLabel:()=>vK,parseLinkTitle:()=>bK});function vK(t,e,r){let n,o,s,a,c=t.posMax,l=t.pos;for(t.pos=e+1,n=1;t.pos<c;){if(s=t.src.charCodeAt(t.pos),s===93&&(n--,n===0)){o=!0;break}if(a=t.pos,t.md.inline.skipToken(t),s===91){if(a===t.pos-1)n++;else if(r)return t.pos=l,-1}}let u=-1;return o&&(u=t.pos),t.pos=l,u}function yK(t,e,r){let n,o=e,s={ok:!1,pos:0,lines:0,str:""};if(t.charCodeAt(o)===60){for(o++;o<r;){if(n=t.charCodeAt(o),n===10||n===60)return s;if(n===62)return s.pos=o+1,s.str=yv(t.slice(e+1,o)),s.ok=!0,s;if(n===92&&o+1<r){o+=2;continue}o++}return s}let a=0;for(;o<r&&(n=t.charCodeAt(o),!(n===32||n<32||n===127));){if(n===92&&o+1<r){if(t.charCodeAt(o+1)===32)break;o+=2;continue}if(n===40&&(a++,a>32))return s;if(n===41){if(a===0)break;a--}o++}return e===o||a!==0||(s.str=yv(t.slice(e,o)),s.pos=o,s.ok=!0),s}function bK(t,e,r){let n,o,s=0,a=e,c={ok:!1,pos:0,lines:0,str:""};if(a>=r||(o=t.charCodeAt(a),o!==34&&o!==39&&o!==40))return c;for(a++,o===40&&(o=41);a<r;){if(n=t.charCodeAt(a),n===o)return c.pos=a+1,c.lines=s,c.str=yv(t.slice(e+1,a)),c.ok=!0,c;if(n===40&&o===41)return c;n===10?s++:n===92&&a+1<r&&(a++,t.charCodeAt(a)===10&&s++),a++}return c}var Ep={};Ep.code_inline=function(t,e,r,n,o){let s=t[e];return"<code"+o.renderAttrs(s)+">"+Vm(s.content)+"</code>"};Ep.code_block=function(t,e,r,n,o){let s=t[e];return"<pre"+o.renderAttrs(s)+"><code>"+Vm(t[e].content)+`</code></pre>
`};Ep.fence=function(t,e,r,n,o){let s=t[e],a=s.info?yv(s.info).trim():"",c="",l="";if(a){let d=a.split(/(\s+)/g);c=d[0],l=d.slice(2).join("")}let u;if(r.highlight?u=r.highlight(s.content,c,l)||Vm(s.content):u=Vm(s.content),u.indexOf("<pre")===0)return u+`
`;if(a){let d=s.attrIndex("class"),p=s.attrs?s.attrs.slice():[];d<0?p.push(["class",r.langPrefix+c]):(p[d]=p[d].slice(),p[d][1]+=" "+r.langPrefix+c);let f={attrs:p};return`<pre><code${o.renderAttrs(f)}>${u}</code></pre>
`}return`<pre><code${o.renderAttrs(s)}>${u}</code></pre>
`};Ep.image=function(t,e,r,n,o){let s=t[e];return s.attrs[s.attrIndex("alt")][1]=o.renderInlineAsText(s.children,r,n),o.renderToken(t,e,r)};Ep.hardbreak=function(t,e,r){return r.xhtmlOut?`<br />
`:`<br>
`};Ep.softbreak=function(t,e,r){return r.breaks?r.xhtmlOut?`<br />
`:`<br>
`:`
`};Ep.text=function(t,e){return Vm(t[e].content)};Ep.html_block=function(t,e){return t[e].content};Ep.html_inline=function(t,e){return t[e].content};function AI(){this.rules=PI({},Ep)}AI.prototype.renderAttrs=function(e){let r,n,o;if(!e.attrs)return"";for(o="",r=0,n=e.attrs.length;r<n;r++)o+=" "+Vm(e.attrs[r][0])+'="'+Vm(e.attrs[r][1])+'"';return o};AI.prototype.renderToken=function(e,r,n){let o=e[r],s="";if(o.hidden)return"";o.block&&o.nesting!==-1&&r&&e[r-1].hidden&&(s+=`
`),s+=(o.nesting===-1?"</":"<")+o.tag,s+=this.renderAttrs(o),o.nesting===0&&n.xhtmlOut&&(s+=" /");let a=!1;if(o.block&&(a=!0,o.nesting===1&&r+1<e.length)){let c=e[r+1];(c.type==="inline"||c.hidden||c.nesting===-1&&c.tag===o.tag)&&(a=!1)}return s+=a?`>
`:">",s};AI.prototype.renderInline=function(t,e,r){let n="",o=this.rules;for(let s=0,a=t.length;s<a;s++){let c=t[s].type;typeof o[c]<"u"?n+=o[c](t,s,e,r,this):n+=this.renderToken(t,s,e)}return n};AI.prototype.renderInlineAsText=function(t,e,r){let n="";for(let o=0,s=t.length;o<s;o++)switch(t[o].type){case"text":n+=t[o].content;break;case"image":n+=this.renderInlineAsText(t[o].children,e,r);break;case"html_inline":case"html_block":n+=t[o].content;break;case"softbreak":case"hardbreak":n+=`
`;break;default:}return n};AI.prototype.render=function(t,e,r){let n="",o=this.rules;for(let s=0,a=t.length;s<a;s++){let c=t[s].type;c==="inline"?n+=this.renderInline(t[s].children,e,r):typeof o[c]<"u"?n+=o[c](t,s,e,r,this):n+=this.renderToken(t,s,e,r)}return n};var Dge=AI;function hd(){this.__rules__=[],this.__cache__=null}hd.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1};hd.prototype.__compile__=function(){let t=this,e=[""];t.__rules__.forEach(function(r){r.enabled&&r.alt.forEach(function(n){e.indexOf(n)<0&&e.push(n)})}),t.__cache__={},e.forEach(function(r){t.__cache__[r]=[],t.__rules__.forEach(function(n){n.enabled&&(r&&n.alt.indexOf(r)<0||t.__cache__[r].push(n.fn))})})};hd.prototype.at=function(t,e,r){let n=this.__find__(t),o=r||{};if(n===-1)throw new Error("Parser rule not found: "+t);this.__rules__[n].fn=e,this.__rules__[n].alt=o.alt||[],this.__cache__=null};hd.prototype.before=function(t,e,r,n){let o=this.__find__(t),s=n||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:r,alt:s.alt||[]}),this.__cache__=null};hd.prototype.after=function(t,e,r,n){let o=this.__find__(t),s=n||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:r,alt:s.alt||[]}),this.__cache__=null};hd.prototype.push=function(t,e,r){let n=r||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:n.alt||[]}),this.__cache__=null};hd.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);let r=[];return t.forEach(function(n){let o=this.__find__(n);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[o].enabled=!0,r.push(n)},this),this.__cache__=null,r};hd.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(r){r.enabled=!1}),this.enable(t,e)};hd.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);let r=[];return t.forEach(function(n){let o=this.__find__(n);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[o].enabled=!1,r.push(n)},this),this.__cache__=null,r};hd.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};var N_=hd;function DI(t,e,r){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=r,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}DI.prototype.attrIndex=function(e){if(!this.attrs)return-1;let r=this.attrs;for(let n=0,o=r.length;n<o;n++)if(r[n][0]===e)return n;return-1};DI.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};DI.prototype.attrSet=function(e,r){let n=this.attrIndex(e),o=[e,r];n<0?this.attrPush(o):this.attrs[n]=o};DI.prototype.attrGet=function(e){let r=this.attrIndex(e),n=null;return r>=0&&(n=this.attrs[r][1]),n};DI.prototype.attrJoin=function(e,r){let n=this.attrIndex(e);n<0?this.attrPush([e,r]):this.attrs[n][1]=this.attrs[n][1]+" "+r};var Hm=DI;function Nge(t,e,r){this.src=t,this.env=r,this.tokens=[],this.inlineMode=!1,this.md=e}Nge.prototype.Token=Hm;var Lge=Nge;var HGe=/\r\n?|\n/g,GGe=/\0/g;function xK(t){let e;e=t.src.replace(HGe,`
`),e=e.replace(GGe,"\uFFFD"),t.src=e}function SK(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}function IK(t){let e=t.tokens;for(let r=0,n=e.length;r<n;r++){let o=e[r];o.type==="inline"&&t.md.inline.parse(o.content,t.md,t.env,o.children)}}function zGe(t){return/^<a[>\s]/i.test(t)}function $Ge(t){return/^<\/a\s*>/i.test(t)}function CK(t){let e=t.tokens;if(t.md.options.linkify)for(let r=0,n=e.length;r<n;r++){if(e[r].type!=="inline"||!t.md.linkify.pretest(e[r].content))continue;let o=e[r].children,s=0;for(let a=o.length-1;a>=0;a--){let c=o[a];if(c.type==="link_close"){for(a--;o[a].level!==c.level&&o[a].type!=="link_open";)a--;continue}if(c.type==="html_inline"&&(zGe(c.content)&&s>0&&s--,$Ge(c.content)&&s++),!(s>0)&&c.type==="text"&&t.md.linkify.test(c.content)){let l=c.content,u=t.md.linkify.match(l),d=[],p=c.level,f=0;u.length>0&&u[0].index===0&&a>0&&o[a-1].type==="text_special"&&(u=u.slice(1));for(let m=0;m<u.length;m++){let h=u[m].url,g=t.md.normalizeLink(h);if(!t.md.validateLink(g))continue;let v=u[m].text;u[m].schema?u[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=t.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=t.md.normalizeLinkText(v):v=t.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");let b=u[m].index;if(b>f){let I=new t.Token("text","",0);I.content=l.slice(f,b),I.level=p,d.push(I)}let _=new t.Token("link_open","a",1);_.attrs=[["href",g]],_.level=p++,_.markup="linkify",_.info="auto",d.push(_);let x=new t.Token("text","",0);x.content=v,x.level=p,d.push(x);let S=new t.Token("link_close","a",-1);S.level=--p,S.markup="linkify",S.info="auto",d.push(S),f=u[m].lastIndex}if(f<l.length){let m=new t.Token("text","",0);m.content=l.slice(f),m.level=p,d.push(m)}e[r].children=o=hK(o,a,d)}}}}var Oge=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,WGe=/\((c|tm|r)\)/i,KGe=/\((c|tm|r)\)/ig,YGe={c:"\xA9",r:"\xAE",tm:"\u2122"};function QGe(t,e){return YGe[e.toLowerCase()]}function XGe(t){let e=0;for(let r=t.length-1;r>=0;r--){let n=t[r];n.type==="text"&&!e&&(n.content=n.content.replace(KGe,QGe)),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function JGe(t){let e=0;for(let r=t.length-1;r>=0;r--){let n=t[r];n.type==="text"&&!e&&Oge.test(n.content)&&(n.content=n.content.replace(/\+-/g,"\xB1").replace(/\.{2,}/g,"\u2026").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1\u2014").replace(/(^|\s)--(?=\s|$)/mg,"$1\u2013").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1\u2013")),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function TK(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)t.tokens[e].type==="inline"&&(WGe.test(t.tokens[e].content)&&XGe(t.tokens[e].children),Oge.test(t.tokens[e].content)&&JGe(t.tokens[e].children))}var ZGe=/['"]/,Mge=/['"]/g,Fge="\u2019";function g5(t,e,r){return t.slice(0,e)+r+t.slice(e+1)}function eze(t,e){let r,n=[];for(let o=0;o<t.length;o++){let s=t[o],a=t[o].level;for(r=n.length-1;r>=0&&!(n[r].level<=a);r--);if(n.length=r+1,s.type!=="text")continue;let c=s.content,l=0,u=c.length;e:for(;l<u;){Mge.lastIndex=l;let d=Mge.exec(c);if(!d)break;let p=!0,f=!0;l=d.index+1;let m=d[0]==="'",h=32;if(d.index-1>=0)h=c.charCodeAt(d.index-1);else for(r=o-1;r>=0&&!(t[r].type==="softbreak"||t[r].type==="hardbreak");r--)if(t[r].content){h=t[r].content.charCodeAt(t[r].content.length-1);break}let g=32;if(l<u)g=c.charCodeAt(l);else for(r=o+1;r<t.length&&!(t[r].type==="softbreak"||t[r].type==="hardbreak");r++)if(t[r].content){g=t[r].content.charCodeAt(0);break}let v=A_(h)||P_(String.fromCharCode(h)),b=A_(g)||P_(String.fromCharCode(g)),_=R_(h),x=R_(g);if(x?p=!1:b&&(_||v||(p=!1)),_?f=!1:v&&(x||b||(f=!1)),g===34&&d[0]==='"'&&h>=48&&h<=57&&(f=p=!1),p&&f&&(p=v,f=b),!p&&!f){m&&(s.content=g5(s.content,d.index,Fge));continue}if(f)for(r=n.length-1;r>=0;r--){let S=n[r];if(n[r].level<a)break;if(S.single===m&&n[r].level===a){S=n[r];let I,w;m?(I=e.md.options.quotes[2],w=e.md.options.quotes[3]):(I=e.md.options.quotes[0],w=e.md.options.quotes[1]),s.content=g5(s.content,d.index,w),t[S.token].content=g5(t[S.token].content,S.pos,I),l+=w.length-1,S.token===o&&(l+=I.length-1),c=s.content,u=c.length,n.length=r;continue e}}p?n.push({token:o,pos:d.index,single:m,level:a}):f&&m&&(s.content=g5(s.content,d.index,Fge))}}}function EK(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)t.tokens[e].type!=="inline"||!ZGe.test(t.tokens[e].content)||eze(t.tokens[e].children,t)}function wK(t){let e,r,n=t.tokens,o=n.length;for(let s=0;s<o;s++){if(n[s].type!=="inline")continue;let a=n[s].children,c=a.length;for(e=0;e<c;e++)a[e].type==="text_special"&&(a[e].type="text");for(e=r=0;e<c;e++)a[e].type==="text"&&e+1<c&&a[e+1].type==="text"?a[e+1].content=a[e].content+a[e+1].content:(e!==r&&(a[r]=a[e]),r++);e!==r&&(a.length=r)}}var kK=[["normalize",xK],["block",SK],["inline",IK],["linkify",CK],["replacements",TK],["smartquotes",EK],["text_join",wK]];function RK(){this.ruler=new N_;for(let t=0;t<kK.length;t++)this.ruler.push(kK[t][0],kK[t][1])}RK.prototype.process=function(t){let e=this.ruler.getRules("");for(let r=0,n=e.length;r<n;r++)e[r](t)};RK.prototype.State=Lge;var Uge=RK;function wp(t,e,r,n){this.src=t,this.md=e,this.env=r,this.tokens=n,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;let o=this.src;for(let s=0,a=0,c=0,l=0,u=o.length,d=!1;a<u;a++){let p=o.charCodeAt(a);if(!d)if(Er(p)){c++,p===9?l+=4-l%4:l++;continue}else d=!0;(p===10||a===u-1)&&(p!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(c),this.sCount.push(l),this.bsCount.push(0),d=!1,c=0,l=0,s=a+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}wp.prototype.push=function(t,e,r){let n=new Hm(t,e,r);return n.block=!0,r<0&&this.level--,n.level=this.level,r>0&&this.level++,this.tokens.push(n),n};wp.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};wp.prototype.skipEmptyLines=function(e){for(let r=this.lineMax;e<r&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};wp.prototype.skipSpaces=function(e){for(let r=this.src.length;e<r;e++){let n=this.src.charCodeAt(e);if(!Er(n))break}return e};wp.prototype.skipSpacesBack=function(e,r){if(e<=r)return e;for(;e>r;)if(!Er(this.src.charCodeAt(--e)))return e+1;return e};wp.prototype.skipChars=function(e,r){for(let n=this.src.length;e<n&&this.src.charCodeAt(e)===r;e++);return e};wp.prototype.skipCharsBack=function(e,r,n){if(e<=n)return e;for(;e>n;)if(r!==this.src.charCodeAt(--e))return e+1;return e};wp.prototype.getLines=function(e,r,n,o){if(e>=r)return"";let s=new Array(r-e);for(let a=0,c=e;c<r;c++,a++){let l=0,u=this.bMarks[c],d=u,p;for(c+1<r||o?p=this.eMarks[c]+1:p=this.eMarks[c];d<p&&l<n;){let f=this.src.charCodeAt(d);if(Er(f))f===9?l+=4-(l+this.bsCount[c])%4:l++;else if(d-u<this.tShift[c])l++;else break;d++}l>n?s[a]=new Array(l-n+1).join(" ")+this.src.slice(d,p):s[a]=this.src.slice(d,p)}return s.join("")};wp.prototype.Token=Hm;var Bge=wp;function PK(t,e){let r=t.bMarks[e]+t.tShift[e],n=t.eMarks[e];return t.src.slice(r,n)}function qge(t){let e=[],r=t.length,n=0,o=t.charCodeAt(n),s=!1,a=0,c="";for(;n<r;)o===124&&(s?(c+=t.substring(a,n-1),a=n):(e.push(c+t.substring(a,n)),c="",a=n+1)),s=o===92,n++,o=t.charCodeAt(n);return e.push(c+t.substring(a)),e}function AK(t,e,r,n){if(e+2>r)return!1;let o=e+1;if(t.sCount[o]<t.blkIndent||t.sCount[o]-t.blkIndent>=4)return!1;let s=t.bMarks[o]+t.tShift[o];if(s>=t.eMarks[o])return!1;let a=t.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58||s>=t.eMarks[o])return!1;let c=t.src.charCodeAt(s++);if(c!==124&&c!==45&&c!==58&&!Er(c)||a===45&&Er(c))return!1;for(;s<t.eMarks[o];){let x=t.src.charCodeAt(s);if(x!==124&&x!==45&&x!==58&&!Er(x))return!1;s++}let l=PK(t,e+1),u=l.split("|"),d=[];for(let x=0;x<u.length;x++){let S=u[x].trim();if(!S){if(x===0||x===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(S))return!1;S.charCodeAt(S.length-1)===58?d.push(S.charCodeAt(0)===58?"center":"right"):S.charCodeAt(0)===58?d.push("left"):d.push("")}if(l=PK(t,e).trim(),l.indexOf("|")===-1||t.sCount[e]-t.blkIndent>=4)return!1;u=qge(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop();let p=u.length;if(p===0||p!==d.length)return!1;if(n)return!0;let f=t.parentType;t.parentType="table";let m=t.md.block.ruler.getRules("blockquote"),h=t.push("table_open","table",1),g=[e,0];h.map=g;let v=t.push("thead_open","thead",1);v.map=[e,e+1];let b=t.push("tr_open","tr",1);b.map=[e,e+1];for(let x=0;x<u.length;x++){let S=t.push("th_open","th",1);d[x]&&(S.attrs=[["style","text-align:"+d[x]]]);let I=t.push("inline","",0);I.content=u[x].trim(),I.children=[],t.push("th_close","th",-1)}t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let _;for(o=e+2;o<r&&!(t.sCount[o]<t.blkIndent);o++){let x=!1;for(let I=0,w=m.length;I<w;I++)if(m[I](t,o,r,!0)){x=!0;break}if(x||(l=PK(t,o).trim(),!l)||t.sCount[o]-t.blkIndent>=4)break;if(u=qge(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop(),o===e+2){let I=t.push("tbody_open","tbody",1);I.map=_=[e+2,0]}let S=t.push("tr_open","tr",1);S.map=[o,o+1];for(let I=0;I<p;I++){let w=t.push("td_open","td",1);d[I]&&(w.attrs=[["style","text-align:"+d[I]]]);let k=t.push("inline","",0);k.content=u[I]?u[I].trim():"",k.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return _&&(t.push("tbody_close","tbody",-1),_[1]=o),t.push("table_close","table",-1),g[1]=o,t.parentType=f,t.line=o,!0}function DK(t,e,r){if(t.sCount[e]-t.blkIndent<4)return!1;let n=e+1,o=n;for(;n<r;){if(t.isEmpty(n)){n++;continue}if(t.sCount[n]-t.blkIndent>=4){n++,o=n;continue}break}t.line=o;let s=t.push("code_block","code",0);return s.content=t.getLines(e,o,4+t.blkIndent,!1)+`
`,s.map=[e,t.line],!0}function NK(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||o+3>s)return!1;let a=t.src.charCodeAt(o);if(a!==126&&a!==96)return!1;let c=o;o=t.skipChars(o,a);let l=o-c;if(l<3)return!1;let u=t.src.slice(c,o),d=t.src.slice(o,s);if(a===96&&d.indexOf(String.fromCharCode(a))>=0)return!1;if(n)return!0;let p=e,f=!1;for(;p++,!(p>=r||(o=c=t.bMarks[p]+t.tShift[p],s=t.eMarks[p],o<s&&t.sCount[p]<t.blkIndent));)if(t.src.charCodeAt(o)===a&&!(t.sCount[p]-t.blkIndent>=4)&&(o=t.skipChars(o,a),!(o-c<l)&&(o=t.skipSpaces(o),!(o<s)))){f=!0;break}l=t.sCount[e],t.line=p+(f?1:0);let m=t.push("fence","code",0);return m.info=d,m.content=t.getLines(e+1,p,l,!0),m.markup=u,m.map=[e,t.line],!0}function LK(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e],a=t.lineMax;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(o)!==62)return!1;if(n)return!0;let c=[],l=[],u=[],d=[],p=t.md.block.ruler.getRules("blockquote"),f=t.parentType;t.parentType="blockquote";let m=!1,h;for(h=e;h<r;h++){let x=t.sCount[h]<t.blkIndent;if(o=t.bMarks[h]+t.tShift[h],s=t.eMarks[h],o>=s)break;if(t.src.charCodeAt(o++)===62&&!x){let I=t.sCount[h]+1,w,k;t.src.charCodeAt(o)===32?(o++,I++,k=!1,w=!0):t.src.charCodeAt(o)===9?(w=!0,(t.bsCount[h]+I)%4===3?(o++,I++,k=!1):k=!0):w=!1;let M=I;for(c.push(t.bMarks[h]),t.bMarks[h]=o;o<s;){let H=t.src.charCodeAt(o);if(Er(H))H===9?M+=4-(M+t.bsCount[h]+(k?1:0))%4:M++;else break;o++}m=o>=s,l.push(t.bsCount[h]),t.bsCount[h]=t.sCount[h]+1+(w?1:0),u.push(t.sCount[h]),t.sCount[h]=M-I,d.push(t.tShift[h]),t.tShift[h]=o-t.bMarks[h];continue}if(m)break;let S=!1;for(let I=0,w=p.length;I<w;I++)if(p[I](t,h,r,!0)){S=!0;break}if(S){t.lineMax=h,t.blkIndent!==0&&(c.push(t.bMarks[h]),l.push(t.bsCount[h]),d.push(t.tShift[h]),u.push(t.sCount[h]),t.sCount[h]-=t.blkIndent);break}c.push(t.bMarks[h]),l.push(t.bsCount[h]),d.push(t.tShift[h]),u.push(t.sCount[h]),t.sCount[h]=-1}let g=t.blkIndent;t.blkIndent=0;let v=t.push("blockquote_open","blockquote",1);v.markup=">";let b=[e,0];v.map=b,t.md.block.tokenize(t,e,h);let _=t.push("blockquote_close","blockquote",-1);_.markup=">",t.lineMax=a,t.parentType=f,b[1]=t.line;for(let x=0;x<d.length;x++)t.bMarks[x+e]=c[x],t.tShift[x+e]=d[x],t.sCount[x+e]=u[x],t.bsCount[x+e]=l[x];return t.blkIndent=g,!0}function OK(t,e,r,n){let o=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.bMarks[e]+t.tShift[e],a=t.src.charCodeAt(s++);if(a!==42&&a!==45&&a!==95)return!1;let c=1;for(;s<o;){let u=t.src.charCodeAt(s++);if(u!==a&&!Er(u))return!1;u===a&&c++}if(c<3)return!1;if(n)return!0;t.line=e+1;let l=t.push("hr","hr",0);return l.map=[e,t.line],l.markup=Array(c+1).join(String.fromCharCode(a)),!0}function jge(t,e){let r=t.eMarks[e],n=t.bMarks[e]+t.tShift[e],o=t.src.charCodeAt(n++);if(o!==42&&o!==45&&o!==43)return-1;if(n<r){let s=t.src.charCodeAt(n);if(!Er(s))return-1}return n}function Vge(t,e){let r=t.bMarks[e]+t.tShift[e],n=t.eMarks[e],o=r;if(o+1>=n)return-1;let s=t.src.charCodeAt(o++);if(s<48||s>57)return-1;for(;;){if(o>=n)return-1;if(s=t.src.charCodeAt(o++),s>=48&&s<=57){if(o-r>=10)return-1;continue}if(s===41||s===46)break;return-1}return o<n&&(s=t.src.charCodeAt(o),!Er(s))?-1:o}function tze(t,e){let r=t.level+2;for(let n=e+2,o=t.tokens.length-2;n<o;n++)t.tokens[n].level===r&&t.tokens[n].type==="paragraph_open"&&(t.tokens[n+2].hidden=!0,t.tokens[n].hidden=!0,n+=2)}function MK(t,e,r,n){let o,s,a,c,l=e,u=!0;if(t.sCount[l]-t.blkIndent>=4||t.listIndent>=0&&t.sCount[l]-t.listIndent>=4&&t.sCount[l]<t.blkIndent)return!1;let d=!1;n&&t.parentType==="paragraph"&&t.sCount[l]>=t.blkIndent&&(d=!0);let p,f,m;if((m=Vge(t,l))>=0){if(p=!0,a=t.bMarks[l]+t.tShift[l],f=Number(t.src.slice(a,m-1)),d&&f!==1)return!1}else if((m=jge(t,l))>=0)p=!1;else return!1;if(d&&t.skipSpaces(m)>=t.eMarks[l])return!1;if(n)return!0;let h=t.src.charCodeAt(m-1),g=t.tokens.length;p?(c=t.push("ordered_list_open","ol",1),f!==1&&(c.attrs=[["start",f]])):c=t.push("bullet_list_open","ul",1);let v=[l,0];c.map=v,c.markup=String.fromCharCode(h);let b=!1,_=t.md.block.ruler.getRules("list"),x=t.parentType;for(t.parentType="list";l<r;){s=m,o=t.eMarks[l];let S=t.sCount[l]+m-(t.bMarks[l]+t.tShift[l]),I=S;for(;s<o;){let P=t.src.charCodeAt(s);if(P===9)I+=4-(I+t.bsCount[l])%4;else if(P===32)I++;else break;s++}let w=s,k;w>=o?k=1:k=I-S,k>4&&(k=1);let M=S+k;c=t.push("list_item_open","li",1),c.markup=String.fromCharCode(h);let H=[l,0];c.map=H,p&&(c.info=t.src.slice(a,m-1));let F=t.tight,ue=t.tShift[l],Z=t.sCount[l],V=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=M,t.tight=!0,t.tShift[l]=w-t.bMarks[l],t.sCount[l]=I,w>=o&&t.isEmpty(l+1)?t.line=Math.min(t.line+2,r):t.md.block.tokenize(t,l,r,!0),(!t.tight||b)&&(u=!1),b=t.line-l>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=V,t.tShift[l]=ue,t.sCount[l]=Z,t.tight=F,c=t.push("list_item_close","li",-1),c.markup=String.fromCharCode(h),l=t.line,H[1]=l,l>=r||t.sCount[l]<t.blkIndent||t.sCount[l]-t.blkIndent>=4)break;let A=!1;for(let P=0,B=_.length;P<B;P++)if(_[P](t,l,r,!0)){A=!0;break}if(A)break;if(p){if(m=Vge(t,l),m<0)break;a=t.bMarks[l]+t.tShift[l]}else if(m=jge(t,l),m<0)break;if(h!==t.src.charCodeAt(m-1))break}return p?c=t.push("ordered_list_close","ol",-1):c=t.push("bullet_list_close","ul",-1),c.markup=String.fromCharCode(h),v[1]=l,t.line=l,t.parentType=x,u&&tze(t,g),!0}function FK(t,e,r,n){let o=0,s=t.bMarks[e]+t.tShift[e],a=t.eMarks[e],c=e+1;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(s)!==91)return!1;for(;++s<a;)if(t.src.charCodeAt(s)===93&&t.src.charCodeAt(s-1)!==92){if(s+1===a||t.src.charCodeAt(s+1)!==58)return!1;break}let l=t.lineMax,u=t.md.block.ruler.getRules("reference"),d=t.parentType;for(t.parentType="reference";c<l&&!t.isEmpty(c);c++){if(t.sCount[c]-t.blkIndent>3||t.sCount[c]<0)continue;let I=!1;for(let w=0,k=u.length;w<k;w++)if(u[w](t,c,l,!0)){I=!0;break}if(I)break}let p=t.getLines(e,c,t.blkIndent,!1).trim();a=p.length;let f=-1;for(s=1;s<a;s++){let I=p.charCodeAt(s);if(I===91)return!1;if(I===93){f=s;break}else I===10?o++:I===92&&(s++,s<a&&p.charCodeAt(s)===10&&o++)}if(f<0||p.charCodeAt(f+1)!==58)return!1;for(s=f+2;s<a;s++){let I=p.charCodeAt(s);if(I===10)o++;else if(!Er(I))break}let m=t.md.helpers.parseLinkDestination(p,s,a);if(!m.ok)return!1;let h=t.md.normalizeLink(m.str);if(!t.md.validateLink(h))return!1;s=m.pos,o+=m.lines;let g=s,v=o,b=s;for(;s<a;s++){let I=p.charCodeAt(s);if(I===10)o++;else if(!Er(I))break}let _=t.md.helpers.parseLinkTitle(p,s,a),x;for(s<a&&b!==s&&_.ok?(x=_.str,s=_.pos,o+=_.lines):(x="",s=g,o=v);s<a;){let I=p.charCodeAt(s);if(!Er(I))break;s++}if(s<a&&p.charCodeAt(s)!==10&&x)for(x="",s=g,o=v;s<a;){let I=p.charCodeAt(s);if(!Er(I))break;s++}if(s<a&&p.charCodeAt(s)!==10)return!1;let S=D_(p.slice(1,f));return S?(n||(typeof t.env.references>"u"&&(t.env.references={}),typeof t.env.references[S]>"u"&&(t.env.references[S]={title:x,href:h}),t.parentType=d,t.line=e+o+1),!0):!1}var Hge=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"];var rze="[a-zA-Z_:][a-zA-Z0-9:._-]*",nze="[^\"'=<>`\\x00-\\x20]+",ize="'[^']*'",oze='"[^"]*"',sze="(?:"+nze+"|"+ize+"|"+oze+")",aze="(?:\\s+"+rze+"(?:\\s*=\\s*"+sze+")?)",Gge="<[A-Za-z][A-Za-z0-9\\-]*"+aze+"*\\s*\\/?>",zge="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",cze="<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->",lze="<[?][\\s\\S]*?[?]>",uze="<![A-Z]+\\s+[^>]*>",dze="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",$ge=new RegExp("^(?:"+Gge+"|"+zge+"|"+cze+"|"+lze+"|"+uze+"|"+dze+")"),Wge=new RegExp("^(?:"+Gge+"|"+zge+")");var NI=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Hge.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(Wge.source+"\\s*$"),/^$/,!1]];function UK(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||!t.md.options.html||t.src.charCodeAt(o)!==60)return!1;let a=t.src.slice(o,s),c=0;for(;c<NI.length&&!NI[c][0].test(a);c++);if(c===NI.length)return!1;if(n)return NI[c][2];let l=e+1;if(!NI[c][1].test(a)){for(;l<r&&!(t.sCount[l]<t.blkIndent);l++)if(o=t.bMarks[l]+t.tShift[l],s=t.eMarks[l],a=t.src.slice(o,s),NI[c][1].test(a)){a.length!==0&&l++;break}}t.line=l;let u=t.push("html_block","",0);return u.map=[e,l],u.content=t.getLines(e,l,t.blkIndent,!0),!0}function BK(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let a=t.src.charCodeAt(o);if(a!==35||o>=s)return!1;let c=1;for(a=t.src.charCodeAt(++o);a===35&&o<s&&c<=6;)c++,a=t.src.charCodeAt(++o);if(c>6||o<s&&!Er(a))return!1;if(n)return!0;s=t.skipSpacesBack(s,o);let l=t.skipCharsBack(s,35,o);l>o&&Er(t.src.charCodeAt(l-1))&&(s=l),t.line=e+1;let u=t.push("heading_open","h"+String(c),1);u.markup="########".slice(0,c),u.map=[e,t.line];let d=t.push("inline","",0);d.content=t.src.slice(o,s).trim(),d.map=[e,t.line],d.children=[];let p=t.push("heading_close","h"+String(c),-1);return p.markup="########".slice(0,c),!0}function qK(t,e,r){let n=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;let o=t.parentType;t.parentType="paragraph";let s=0,a,c=e+1;for(;c<r&&!t.isEmpty(c);c++){if(t.sCount[c]-t.blkIndent>3)continue;if(t.sCount[c]>=t.blkIndent){let m=t.bMarks[c]+t.tShift[c],h=t.eMarks[c];if(m<h&&(a=t.src.charCodeAt(m),(a===45||a===61)&&(m=t.skipChars(m,a),m=t.skipSpaces(m),m>=h))){s=a===61?1:2;break}}if(t.sCount[c]<0)continue;let f=!1;for(let m=0,h=n.length;m<h;m++)if(n[m](t,c,r,!0)){f=!0;break}if(f)break}if(!s)return!1;let l=t.getLines(e,c,t.blkIndent,!1).trim();t.line=c+1;let u=t.push("heading_open","h"+String(s),1);u.markup=String.fromCharCode(a),u.map=[e,t.line];let d=t.push("inline","",0);d.content=l,d.map=[e,t.line-1],d.children=[];let p=t.push("heading_close","h"+String(s),-1);return p.markup=String.fromCharCode(a),t.parentType=o,!0}function jK(t,e,r){let n=t.md.block.ruler.getRules("paragraph"),o=t.parentType,s=e+1;for(t.parentType="paragraph";s<r&&!t.isEmpty(s);s++){if(t.sCount[s]-t.blkIndent>3||t.sCount[s]<0)continue;let u=!1;for(let d=0,p=n.length;d<p;d++)if(n[d](t,s,r,!0)){u=!0;break}if(u)break}let a=t.getLines(e,s,t.blkIndent,!1).trim();t.line=s;let c=t.push("paragraph_open","p",1);c.map=[e,t.line];let l=t.push("inline","",0);return l.content=a,l.map=[e,t.line],l.children=[],t.push("paragraph_close","p",-1),t.parentType=o,!0}var v5=[["table",AK,["paragraph","reference"]],["code",DK],["fence",NK,["paragraph","reference","blockquote","list"]],["blockquote",LK,["paragraph","reference","blockquote","list"]],["hr",OK,["paragraph","reference","blockquote","list"]],["list",MK,["paragraph","reference","blockquote"]],["reference",FK],["html_block",UK,["paragraph","reference","blockquote"]],["heading",BK,["paragraph","reference","blockquote"]],["lheading",qK],["paragraph",jK]];function y5(){this.ruler=new N_;for(let t=0;t<v5.length;t++)this.ruler.push(v5[t][0],v5[t][1],{alt:(v5[t][2]||[]).slice()})}y5.prototype.tokenize=function(t,e,r){let n=this.ruler.getRules(""),o=n.length,s=t.md.options.maxNesting,a=e,c=!1;for(;a<r&&(t.line=a=t.skipEmptyLines(a),!(a>=r||t.sCount[a]<t.blkIndent));){if(t.level>=s){t.line=r;break}let l=t.line,u=!1;for(let d=0;d<o;d++)if(u=n[d](t,a,r,!1),u){if(l>=t.line)throw new Error("block rule didn't increment state.line");break}if(!u)throw new Error("none of the block rules matched");t.tight=!c,t.isEmpty(t.line-1)&&(c=!0),a=t.line,a<r&&t.isEmpty(a)&&(c=!0,a++,t.line=a)}};y5.prototype.parse=function(t,e,r,n){if(!t)return;let o=new this.State(t,e,r,n);this.tokenize(o,o.line,o.lineMax)};y5.prototype.State=Bge;var Kge=y5;function O2(t,e,r,n){this.src=t,this.env=r,this.md=e,this.tokens=n,this.tokens_meta=Array(n.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}O2.prototype.pushPending=function(){let t=new Hm("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t};O2.prototype.push=function(t,e,r){this.pending&&this.pushPending();let n=new Hm(t,e,r),o=null;return r<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),n.level=this.level,r>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(n),this.tokens_meta.push(o),n};O2.prototype.scanDelims=function(t,e){let r,n,o=!0,s=!0,a=this.posMax,c=this.src.charCodeAt(t),l=t>0?this.src.charCodeAt(t-1):32,u=t;for(;u<a&&this.src.charCodeAt(u)===c;)u++;let d=u-t,p=u<a?this.src.charCodeAt(u):32,f=A_(l)||P_(String.fromCharCode(l)),m=A_(p)||P_(String.fromCharCode(p)),h=R_(l),g=R_(p);return g?o=!1:m&&(h||f||(o=!1)),h?s=!1:f&&(g||m||(s=!1)),e?(r=o,n=s):(r=o&&(!s||f),n=s&&(!o||m)),{can_open:r,can_close:n,length:d}};O2.prototype.Token=Hm;var Yge=O2;function pze(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function VK(t,e){let r=t.pos;for(;r<t.posMax&&!pze(t.src.charCodeAt(r));)r++;return r===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,r)),t.pos=r,!0)}var fze=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function HK(t,e){if(!t.md.options.linkify||t.linkLevel>0)return!1;let r=t.pos,n=t.posMax;if(r+3>n||t.src.charCodeAt(r)!==58||t.src.charCodeAt(r+1)!==47||t.src.charCodeAt(r+2)!==47)return!1;let o=t.pending.match(fze);if(!o)return!1;let s=o[1],a=t.md.linkify.matchAtStart(t.src.slice(r-s.length));if(!a)return!1;let c=a.url;if(c.length<=s.length)return!1;c=c.replace(/\*+$/,"");let l=t.md.normalizeLink(c);if(!t.md.validateLink(l))return!1;if(!e){t.pending=t.pending.slice(0,-s.length);let u=t.push("link_open","a",1);u.attrs=[["href",l]],u.markup="linkify",u.info="auto";let d=t.push("text","",0);d.content=t.md.normalizeLinkText(c);let p=t.push("link_close","a",-1);p.markup="linkify",p.info="auto"}return t.pos+=c.length-s.length,!0}function GK(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==10)return!1;let n=t.pending.length-1,o=t.posMax;if(!e)if(n>=0&&t.pending.charCodeAt(n)===32)if(n>=1&&t.pending.charCodeAt(n-1)===32){let s=n-1;for(;s>=1&&t.pending.charCodeAt(s-1)===32;)s--;t.pending=t.pending.slice(0,s),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(r++;r<o&&Er(t.src.charCodeAt(r));)r++;return t.pos=r,!0}var zK=[];for(let t=0;t<256;t++)zK.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){zK[t.charCodeAt(0)]=1});function $K(t,e){let r=t.pos,n=t.posMax;if(t.src.charCodeAt(r)!==92||(r++,r>=n))return!1;let o=t.src.charCodeAt(r);if(o===10){for(e||t.push("hardbreak","br",0),r++;r<n&&(o=t.src.charCodeAt(r),!!Er(o));)r++;return t.pos=r,!0}let s=t.src[r];if(o>=55296&&o<=56319&&r+1<n){let c=t.src.charCodeAt(r+1);c>=56320&&c<=57343&&(s+=t.src[r+1],r++)}let a="\\"+s;if(!e){let c=t.push("text_special","",0);o<256&&zK[o]!==0?c.content=s:c.content=a,c.markup=a,c.info="escape"}return t.pos=r+1,!0}function WK(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==96)return!1;let o=r;r++;let s=t.posMax;for(;r<s&&t.src.charCodeAt(r)===96;)r++;let a=t.src.slice(o,r),c=a.length;if(t.backticksScanned&&(t.backticks[c]||0)<=o)return e||(t.pending+=a),t.pos+=c,!0;let l=r,u;for(;(u=t.src.indexOf("`",l))!==-1;){for(l=u+1;l<s&&t.src.charCodeAt(l)===96;)l++;let d=l-u;if(d===c){if(!e){let p=t.push("code_inline","code",0);p.markup=a,p.content=t.src.slice(r,u).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=l,!0}t.backticks[d]=u}return t.backticksScanned=!0,e||(t.pending+=a),t.pos+=c,!0}function mze(t,e){let r=t.pos,n=t.src.charCodeAt(r);if(e||n!==126)return!1;let o=t.scanDelims(t.pos,!0),s=o.length,a=String.fromCharCode(n);if(s<2)return!1;let c;s%2&&(c=t.push("text","",0),c.content=a,s--);for(let l=0;l<s;l+=2)c=t.push("text","",0),c.content=a+a,t.delimiters.push({marker:n,length:0,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return t.pos+=o.length,!0}function Qge(t,e){let r,n=[],o=e.length;for(let s=0;s<o;s++){let a=e[s];if(a.marker!==126||a.end===-1)continue;let c=e[a.end];r=t.tokens[a.token],r.type="s_open",r.tag="s",r.nesting=1,r.markup="~~",r.content="",r=t.tokens[c.token],r.type="s_close",r.tag="s",r.nesting=-1,r.markup="~~",r.content="",t.tokens[c.token-1].type==="text"&&t.tokens[c.token-1].content==="~"&&n.push(c.token-1)}for(;n.length;){let s=n.pop(),a=s+1;for(;a<t.tokens.length&&t.tokens[a].type==="s_close";)a++;a--,s!==a&&(r=t.tokens[a],t.tokens[a]=t.tokens[s],t.tokens[s]=r)}}function hze(t){let e=t.tokens_meta,r=t.tokens_meta.length;Qge(t,t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&Qge(t,e[n].delimiters)}var KK={tokenize:mze,postProcess:hze};function gze(t,e){let r=t.pos,n=t.src.charCodeAt(r);if(e||n!==95&&n!==42)return!1;let o=t.scanDelims(t.pos,n===42);for(let s=0;s<o.length;s++){let a=t.push("text","",0);a.content=String.fromCharCode(n),t.delimiters.push({marker:n,length:o.length,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close})}return t.pos+=o.length,!0}function Xge(t,e){let r=e.length;for(let n=r-1;n>=0;n--){let o=e[n];if(o.marker!==95&&o.marker!==42||o.end===-1)continue;let s=e[o.end],a=n>0&&e[n-1].end===o.end+1&&e[n-1].marker===o.marker&&e[n-1].token===o.token-1&&e[o.end+1].token===s.token+1,c=String.fromCharCode(o.marker),l=t.tokens[o.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?c+c:c,l.content="";let u=t.tokens[s.token];u.type=a?"strong_close":"em_close",u.tag=a?"strong":"em",u.nesting=-1,u.markup=a?c+c:c,u.content="",a&&(t.tokens[e[n-1].token].content="",t.tokens[e[o.end+1].token].content="",n--)}}function vze(t){let e=t.tokens_meta,r=t.tokens_meta.length;Xge(t,t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&Xge(t,e[n].delimiters)}var YK={tokenize:gze,postProcess:vze};function QK(t,e){let r,n,o,s,a="",c="",l=t.pos,u=!0;if(t.src.charCodeAt(t.pos)!==91)return!1;let d=t.pos,p=t.posMax,f=t.pos+1,m=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(m<0)return!1;let h=m+1;if(h<p&&t.src.charCodeAt(h)===40){for(u=!1,h++;h<p&&(r=t.src.charCodeAt(h),!(!Er(r)&&r!==10));h++);if(h>=p)return!1;if(l=h,o=t.md.helpers.parseLinkDestination(t.src,h,t.posMax),o.ok){for(a=t.md.normalizeLink(o.str),t.md.validateLink(a)?h=o.pos:a="",l=h;h<p&&(r=t.src.charCodeAt(h),!(!Er(r)&&r!==10));h++);if(o=t.md.helpers.parseLinkTitle(t.src,h,t.posMax),h<p&&l!==h&&o.ok)for(c=o.str,h=o.pos;h<p&&(r=t.src.charCodeAt(h),!(!Er(r)&&r!==10));h++);}(h>=p||t.src.charCodeAt(h)!==41)&&(u=!0),h++}if(u){if(typeof t.env.references>"u")return!1;if(h<p&&t.src.charCodeAt(h)===91?(l=h+1,h=t.md.helpers.parseLinkLabel(t,h),h>=0?n=t.src.slice(l,h++):h=m+1):h=m+1,n||(n=t.src.slice(f,m)),s=t.env.references[D_(n)],!s)return t.pos=d,!1;a=s.href,c=s.title}if(!e){t.pos=f,t.posMax=m;let g=t.push("link_open","a",1),v=[["href",a]];g.attrs=v,c&&v.push(["title",c]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=h,t.posMax=p,!0}function XK(t,e){let r,n,o,s,a,c,l,u,d="",p=t.pos,f=t.posMax;if(t.src.charCodeAt(t.pos)!==33||t.src.charCodeAt(t.pos+1)!==91)return!1;let m=t.pos+2,h=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(h<0)return!1;if(s=h+1,s<f&&t.src.charCodeAt(s)===40){for(s++;s<f&&(r=t.src.charCodeAt(s),!(!Er(r)&&r!==10));s++);if(s>=f)return!1;for(u=s,c=t.md.helpers.parseLinkDestination(t.src,s,t.posMax),c.ok&&(d=t.md.normalizeLink(c.str),t.md.validateLink(d)?s=c.pos:d=""),u=s;s<f&&(r=t.src.charCodeAt(s),!(!Er(r)&&r!==10));s++);if(c=t.md.helpers.parseLinkTitle(t.src,s,t.posMax),s<f&&u!==s&&c.ok)for(l=c.str,s=c.pos;s<f&&(r=t.src.charCodeAt(s),!(!Er(r)&&r!==10));s++);else l="";if(s>=f||t.src.charCodeAt(s)!==41)return t.pos=p,!1;s++}else{if(typeof t.env.references>"u")return!1;if(s<f&&t.src.charCodeAt(s)===91?(u=s+1,s=t.md.helpers.parseLinkLabel(t,s),s>=0?o=t.src.slice(u,s++):s=h+1):s=h+1,o||(o=t.src.slice(m,h)),a=t.env.references[D_(o)],!a)return t.pos=p,!1;d=a.href,l=a.title}if(!e){n=t.src.slice(m,h);let g=[];t.md.inline.parse(n,t.md,t.env,g);let v=t.push("image","img",0),b=[["src",d],["alt",""]];v.attrs=b,v.children=g,v.content=n,l&&b.push(["title",l])}return t.pos=s,t.posMax=f,!0}var yze=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,bze=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function JK(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==60)return!1;let n=t.pos,o=t.posMax;for(;;){if(++r>=o)return!1;let a=t.src.charCodeAt(r);if(a===60)return!1;if(a===62)break}let s=t.src.slice(n+1,r);if(bze.test(s)){let a=t.md.normalizeLink(s);if(!t.md.validateLink(a))return!1;if(!e){let c=t.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let l=t.push("text","",0);l.content=t.md.normalizeLinkText(s);let u=t.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return t.pos+=s.length+2,!0}if(yze.test(s)){let a=t.md.normalizeLink("mailto:"+s);if(!t.md.validateLink(a))return!1;if(!e){let c=t.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let l=t.push("text","",0);l.content=t.md.normalizeLinkText(s);let u=t.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return t.pos+=s.length+2,!0}return!1}function _ze(t){return/^<a[>\s]/i.test(t)}function xze(t){return/^<\/a\s*>/i.test(t)}function Sze(t){let e=t|32;return e>=97&&e<=122}function ZK(t,e){if(!t.md.options.html)return!1;let r=t.posMax,n=t.pos;if(t.src.charCodeAt(n)!==60||n+2>=r)return!1;let o=t.src.charCodeAt(n+1);if(o!==33&&o!==63&&o!==47&&!Sze(o))return!1;let s=t.src.slice(n).match($ge);if(!s)return!1;if(!e){let a=t.push("html_inline","",0);a.content=s[0],_ze(a.content)&&t.linkLevel++,xze(a.content)&&t.linkLevel--}return t.pos+=s[0].length,!0}var Ize=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,Cze=/^&([a-z][a-z0-9]{1,31});/i;function eY(t,e){let r=t.pos,n=t.posMax;if(t.src.charCodeAt(r)!==38||r+1>=n)return!1;if(t.src.charCodeAt(r+1)===35){let s=t.src.slice(r).match(Ize);if(s){if(!e){let a=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),c=t.push("text_special","",0);c.content=h5(a)?L2(a):L2(65533),c.markup=s[0],c.info="entity"}return t.pos+=s[0].length,!0}}else{let s=t.src.slice(r).match(Cze);if(s){let a=vv(s[0]);if(a!==s[0]){if(!e){let c=t.push("text_special","",0);c.content=a,c.markup=s[0],c.info="entity"}return t.pos+=s[0].length,!0}}}return!1}function Jge(t){let e={},r=t.length;if(!r)return;let n=0,o=-2,s=[];for(let a=0;a<r;a++){let c=t[a];if(s.push(0),(t[n].marker!==c.marker||o!==c.token-1)&&(n=a),o=c.token,c.length=c.length||0,!c.close)continue;e.hasOwnProperty(c.marker)||(e[c.marker]=[-1,-1,-1,-1,-1,-1]);let l=e[c.marker][(c.open?3:0)+c.length%3],u=n-s[n]-1,d=u;for(;u>l;u-=s[u]+1){let p=t[u];if(p.marker===c.marker&&p.open&&p.end<0){let f=!1;if((p.close||c.open)&&(p.length+c.length)%3===0&&(p.length%3!==0||c.length%3!==0)&&(f=!0),!f){let m=u>0&&!t[u-1].open?s[u-1]+1:0;s[a]=a-u+m,s[u]=m,c.open=!1,p.end=a,p.close=!1,d=-1,o=-2;break}}}d!==-1&&(e[c.marker][(c.open?3:0)+(c.length||0)%3]=d)}}function tY(t){let e=t.tokens_meta,r=t.tokens_meta.length;Jge(t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&Jge(e[n].delimiters)}function rY(t){let e,r,n=0,o=t.tokens,s=t.tokens.length;for(e=r=0;e<s;e++)o[e].nesting<0&&n--,o[e].level=n,o[e].nesting>0&&n++,o[e].type==="text"&&e+1<s&&o[e+1].type==="text"?o[e+1].content=o[e].content+o[e+1].content:(e!==r&&(o[r]=o[e]),r++);e!==r&&(o.length=r)}var nY=[["text",VK],["linkify",HK],["newline",GK],["escape",$K],["backticks",WK],["strikethrough",KK.tokenize],["emphasis",YK.tokenize],["link",QK],["image",XK],["autolink",JK],["html_inline",ZK],["entity",eY]],iY=[["balance_pairs",tY],["strikethrough",KK.postProcess],["emphasis",YK.postProcess],["fragments_join",rY]];function M2(){this.ruler=new N_;for(let t=0;t<nY.length;t++)this.ruler.push(nY[t][0],nY[t][1]);this.ruler2=new N_;for(let t=0;t<iY.length;t++)this.ruler2.push(iY[t][0],iY[t][1])}M2.prototype.skipToken=function(t){let e=t.pos,r=this.ruler.getRules(""),n=r.length,o=t.md.options.maxNesting,s=t.cache;if(typeof s[e]<"u"){t.pos=s[e];return}let a=!1;if(t.level<o){for(let c=0;c<n;c++)if(t.level++,a=r[c](t,!0),t.level--,a){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;a||t.pos++,s[e]=t.pos};M2.prototype.tokenize=function(t){let e=this.ruler.getRules(""),r=e.length,n=t.posMax,o=t.md.options.maxNesting;for(;t.pos<n;){let s=t.pos,a=!1;if(t.level<o){for(let c=0;c<r;c++)if(a=e[c](t,!1),a){if(s>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(t.pos>=n)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};M2.prototype.parse=function(t,e,r,n){let o=new this.State(t,e,r,n);this.tokenize(o);let s=this.ruler2.getRules(""),a=s.length;for(let c=0;c<a;c++)s[c](o)};M2.prototype.State=Yge;var Zge=M2;function eve(t){let e={};t=t||{},e.src_Any=l5.source,e.src_Cc=u5.source,e.src_Z=d5.source,e.src_P=RI.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");let r="[><\uFF5C]";return e.src_pseudo_letter="(?:(?!"+r+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+r+"|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+r+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+r+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function oY(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){r&&Object.keys(r).forEach(function(n){t[n]=r[n]})}),t}function _5(t){return Object.prototype.toString.call(t)}function Tze(t){return _5(t)==="[object String]"}function Eze(t){return _5(t)==="[object Object]"}function wze(t){return _5(t)==="[object RegExp]"}function tve(t){return _5(t)==="[object Function]"}function kze(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var nve={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function Rze(t){return Object.keys(t||{}).reduce(function(e,r){return e||nve.hasOwnProperty(r)},!1)}var Pze={"http:":{validate:function(t,e,r){let n=t.slice(e);return r.re.http||(r.re.http=new RegExp("^\\/\\/"+r.re.src_auth+r.re.src_host_port_strict+r.re.src_path,"i")),r.re.http.test(n)?n.match(r.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,r){let n=t.slice(e);return r.re.no_http||(r.re.no_http=new RegExp("^"+r.re.src_auth+"(?:localhost|(?:(?:"+r.re.src_domain+")\\.)+"+r.re.src_domain_root+")"+r.re.src_port+r.re.src_host_terminator+r.re.src_path,"i")),r.re.no_http.test(n)?e>=3&&t[e-3]===":"||e>=3&&t[e-3]==="/"?0:n.match(r.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,r){let n=t.slice(e);return r.re.mailto||(r.re.mailto=new RegExp("^"+r.re.src_email_name+"@"+r.re.src_host_strict,"i")),r.re.mailto.test(n)?n.match(r.re.mailto)[0].length:0}}},Aze="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",Dze="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|\u0440\u0444".split("|");function Nze(t){t.__index__=-1,t.__text_cache__=""}function Lze(t){return function(e,r){let n=e.slice(r);return t.test(n)?n.match(t)[0].length:0}}function rve(){return function(t,e){e.normalize(t)}}function b5(t){let e=t.re=eve(t.__opts__),r=t.__tlds__.slice();t.onCompile(),t.__tlds_replaced__||r.push(Aze),r.push(e.src_xn),e.src_tlds=r.join("|");function n(c){return c.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(n(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(n(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(n(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(n(e.tpl_host_fuzzy_test),"i");let o=[];t.__compiled__={};function s(c,l){throw new Error('(LinkifyIt) Invalid schema "'+c+'": '+l)}Object.keys(t.__schemas__).forEach(function(c){let l=t.__schemas__[c];if(l===null)return;let u={validate:null,link:null};if(t.__compiled__[c]=u,Eze(l)){wze(l.validate)?u.validate=Lze(l.validate):tve(l.validate)?u.validate=l.validate:s(c,l),tve(l.normalize)?u.normalize=l.normalize:l.normalize?s(c,l):u.normalize=rve();return}if(Tze(l)){o.push(c);return}s(c,l)}),o.forEach(function(c){t.__compiled__[t.__schemas__[c]]&&(t.__compiled__[c].validate=t.__compiled__[t.__schemas__[c]].validate,t.__compiled__[c].normalize=t.__compiled__[t.__schemas__[c]].normalize)}),t.__compiled__[""]={validate:null,normalize:rve()};let a=Object.keys(t.__compiled__).filter(function(c){return c.length>0&&t.__compiled__[c]}).map(kze).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),Nze(t)}function Oze(t,e){let r=t.__index__,n=t.__last_index__,o=t.__text_cache__.slice(r,n);this.schema=t.__schema__.toLowerCase(),this.index=r+e,this.lastIndex=n+e,this.raw=o,this.text=o,this.url=o}function sY(t,e){let r=new Oze(t,e);return t.__compiled__[r.schema].normalize(r,t),r}function al(t,e){if(!(this instanceof al))return new al(t,e);e||Rze(t)&&(e=t,t={}),this.__opts__=oY({},nve,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=oY({},Pze,t),this.__compiled__={},this.__tlds__=Dze,this.__tlds_replaced__=!1,this.re={},b5(this)}al.prototype.add=function(e,r){return this.__schemas__[e]=r,b5(this),this};al.prototype.set=function(e){return this.__opts__=oY(this.__opts__,e),this};al.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let r,n,o,s,a,c,l,u,d;if(this.re.schema_test.test(e)){for(l=this.re.schema_search,l.lastIndex=0;(r=l.exec(e))!==null;)if(s=this.testSchemaAt(e,r[2],l.lastIndex),s){this.__schema__=r[2],this.__index__=r.index+r[1].length,this.__last_index__=r.index+r[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(u=e.search(this.re.host_fuzzy_test),u>=0&&(this.__index__<0||u<this.__index__)&&(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=n.index+n[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(d=e.indexOf("@"),d>=0&&(o=e.match(this.re.email_fuzzy))!==null&&(a=o.index+o[1].length,c=o.index+o[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&c>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=c))),this.__index__>=0};al.prototype.pretest=function(e){return this.re.pretest.test(e)};al.prototype.testSchemaAt=function(e,r,n){return this.__compiled__[r.toLowerCase()]?this.__compiled__[r.toLowerCase()].validate(e,n,this):0};al.prototype.match=function(e){let r=[],n=0;this.__index__>=0&&this.__text_cache__===e&&(r.push(sY(this,n)),n=this.__last_index__);let o=n?e.slice(n):e;for(;this.test(o);)r.push(sY(this,n)),o=o.slice(this.__last_index__),n+=this.__last_index__;return r.length?r:null};al.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;let r=this.re.schema_at_start.exec(e);if(!r)return null;let n=this.testSchemaAt(e,r[2],r[0].length);return n?(this.__schema__=r[2],this.__index__=r.index+r[1].length,this.__last_index__=r.index+r[0].length+n,sY(this,0)):null};al.prototype.tlds=function(e,r){return e=Array.isArray(e)?e:[e],r?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(n,o,s){return n!==s[o-1]}).reverse(),b5(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,b5(this),this)};al.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};al.prototype.onCompile=function(){};var ive=al;var sve="-",Mze=/^xn--/,Fze=/[^\0-\x7F]/,Uze=/[\x2E\u3002\uFF0E\uFF61]/g,Bze={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},aY=35,kp=Math.floor,cY=String.fromCharCode;function bv(t){throw new RangeError(Bze[t])}function qze(t,e){let r=[],n=t.length;for(;n--;)r[n]=e(t[n]);return r}function ave(t,e){let r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(Uze,".");let o=t.split("."),s=qze(o,e).join(".");return n+s}function cve(t){let e=[],r=0,n=t.length;for(;r<n;){let o=t.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){let s=t.charCodeAt(r++);(s&64512)==56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),r--)}else e.push(o)}return e}var jze=t=>String.fromCodePoint(...t),Vze=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:36},ove=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},lve=function(t,e,r){let n=0;for(t=r?kp(t/700):t>>1,t+=kp(t/e);t>aY*26>>1;n+=36)t=kp(t/aY);return kp(n+(aY+1)*t/(t+38))},uve=function(t){let e=[],r=t.length,n=0,o=128,s=72,a=t.lastIndexOf(sve);a<0&&(a=0);for(let c=0;c<a;++c)t.charCodeAt(c)>=128&&bv("not-basic"),e.push(t.charCodeAt(c));for(let c=a>0?a+1:0;c<r;){let l=n;for(let d=1,p=36;;p+=36){c>=r&&bv("invalid-input");let f=Vze(t.charCodeAt(c++));f>=36&&bv("invalid-input"),f>kp((2147483647-n)/d)&&bv("overflow"),n+=f*d;let m=p<=s?1:p>=s+26?26:p-s;if(f<m)break;let h=36-m;d>kp(2147483647/h)&&bv("overflow"),d*=h}let u=e.length+1;s=lve(n-l,u,l==0),kp(n/u)>2147483647-o&&bv("overflow"),o+=kp(n/u),n%=u,e.splice(n++,0,o)}return String.fromCodePoint(...e)},dve=function(t){let e=[];t=cve(t);let r=t.length,n=128,o=0,s=72;for(let l of t)l<128&&e.push(cY(l));let a=e.length,c=a;for(a&&e.push(sve);c<r;){let l=2147483647;for(let d of t)d>=n&&d<l&&(l=d);let u=c+1;l-n>kp((2147483647-o)/u)&&bv("overflow"),o+=(l-n)*u,n=l;for(let d of t)if(d<n&&++o>2147483647&&bv("overflow"),d===n){let p=o;for(let f=36;;f+=36){let m=f<=s?1:f>=s+26?26:f-s;if(p<m)break;let h=p-m,g=36-m;e.push(cY(ove(m+h%g,0))),p=kp(h/g)}e.push(cY(ove(p,0))),s=lve(o,u,c===a),o=0,++c}++o,++n}return e.join("")},Hze=function(t){return ave(t,function(e){return Mze.test(e)?uve(e.slice(4).toLowerCase()):e})},Gze=function(t){return ave(t,function(e){return Fze.test(e)?"xn--"+dve(e):e})},zze={version:"2.3.1",ucs2:{decode:cve,encode:jze},decode:uve,encode:dve,toASCII:Gze,toUnicode:Hze};var lY=zze;var pve={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}};var fve={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}};var mve={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}};var $ze={default:pve,zero:fve,commonmark:mve},Wze=/^(vbscript|javascript|file|data):/,Kze=/^data:image\/(gif|png|jpeg|webp);/;function Yze(t){let e=t.trim().toLowerCase();return Wze.test(e)?Kze.test(e):!0}var hve=["http:","https:","mailto:"];function Qze(t){let e=N2(t,!0);if(e.hostname&&(!e.protocol||hve.indexOf(e.protocol)>=0))try{e.hostname=lY.toASCII(e.hostname)}catch{}return s5(kI(e))}function Xze(t){let e=N2(t,!0);if(e.hostname&&(!e.protocol||hve.indexOf(e.protocol)>=0))try{e.hostname=lY.toUnicode(e.hostname)}catch{}return D2(kI(e),D2.defaultChars+"%")}function $l(t,e){if(!(this instanceof $l))return new $l(t,e);e||m5(t)||(e=t||{},t="default"),this.inline=new Zge,this.block=new Kge,this.core=new Uge,this.renderer=new Dge,this.linkify=new ive,this.validateLink=Yze,this.normalizeLink=Qze,this.normalizeLinkText=Xze,this.utils=gK,this.helpers=PI({},_K),this.options={},this.configure(t),e&&this.set(e)}$l.prototype.set=function(t){return PI(this.options,t),this};$l.prototype.configure=function(t){let e=this;if(m5(t)){let r=t;if(t=$ze[r],!t)throw new Error('Wrong `markdown-it` preset "'+r+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(r){t.components[r].rules&&e[r].ruler.enableOnly(t.components[r].rules),t.components[r].rules2&&e[r].ruler2.enableOnly(t.components[r].rules2)}),this};$l.prototype.enable=function(t,e){let r=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(o){r=r.concat(this[o].ruler.enable(t,!0))},this),r=r.concat(this.inline.ruler2.enable(t,!0));let n=t.filter(function(o){return r.indexOf(o)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+n);return this};$l.prototype.disable=function(t,e){let r=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(o){r=r.concat(this[o].ruler.disable(t,!0))},this),r=r.concat(this.inline.ruler2.disable(t,!0));let n=t.filter(function(o){return r.indexOf(o)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+n);return this};$l.prototype.use=function(t){let e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this};$l.prototype.parse=function(t,e){if(typeof t!="string")throw new Error("Input data should be a String");let r=new this.core.State(t,this,e);return this.core.process(r),r.tokens};$l.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};$l.prototype.parseInline=function(t,e){let r=new this.core.State(t,this,e);return r.inlineMode=!0,this.core.process(r),r.tokens};$l.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};var uY=$l;var Jze=Object.freeze({abap:{lineComment:{start:"'"}},bat:{lineComment:{start:"REM"},aliases:["Batch","bat"],extensions:[".bat",".cmd"]},bibtex:{lineComment:{start:"%"},aliases:["BibTeX","bibtex"],extensions:[".bib"]},blade:{lineComment:{start:"#"}},c:{lineComment:{start:"//"},aliases:["C","c"],extensions:[".c",".i"]},clojure:{lineComment:{start:";"},aliases:["Clojure","clojure"],extensions:[".clj",".cljs",".cljc",".cljx",".clojure",".edn"]},coffeescript:{lineComment:{start:"//"},aliases:["CoffeeScript","coffeescript","coffee"],extensions:[".coffee",".cson",".iced"]},cpp:{lineComment:{start:"//"},aliases:["C++","Cpp","cpp"],extensions:[".cpp",".cc",".cxx",".c++",".hpp",".hh",".hxx",".h++",".h",".ii",".ino",".inl",".ipp",".ixx",".tpp",".txx",".hpp.in",".h.in"]},csharp:{lineComment:{start:"//"},aliases:["C#","csharp"],extensions:[".cs",".csx",".cake"]},css:{lineComment:{start:"/*",end:"*/"},aliases:["CSS","css"],extensions:[".css"]},dart:{lineComment:{start:"//"},aliases:["Dart"],extensions:[".dart"]},dockerfile:{lineComment:{start:"#"},aliases:["Docker","Dockerfile","Containerfile"],extensions:[".dockerfile",".containerfile"]},elixir:{lineComment:{start:"#"}},erb:{lineComment:{start:"<%#",end:"%>"}},erlang:{lineComment:{start:"%"}},fsharp:{lineComment:{start:"//"},aliases:["F#","FSharp","fsharp"],extensions:[".fs",".fsi",".fsx",".fsscript"]},go:{lineComment:{start:"//"},aliases:["Go"],extensions:[".go"]},groovy:{lineComment:{start:"//"},aliases:["Groovy","groovy"],extensions:[".groovy",".gvy",".gradle",".jenkinsfile",".nf"]},haml:{lineComment:{start:"-#"}},handlebars:{lineComment:{start:"{{!",end:"}}"},extensions:[".hbs",".handlebars"]},haskell:{lineComment:{start:"--"}},html:{lineComment:{start:"<!--",end:"-->"},aliases:["HTML","htm","html","xhtml"],extensions:[".html",".htm",".shtml",".xhtml",".xht",".mdoc",".jsp",".asp",".aspx",".jshtm",".volt",".ejs",".rhtml"]},ini:{lineComment:{start:";"}},java:{lineComment:{start:"//"},extensions:[".java",".class"]},javascript:{lineComment:{start:"//"},aliases:["JavaScript","javascript","js"],extensions:[".js",".es6",".mjs",".cjs",".pac"]},javascriptreact:{lineComment:{start:"//"},aliases:["JavaScript JSX","JavaScript React","jsx"],extensions:[".jsx"]},json:{extensions:[".json"],lineComment:{start:"//"}},jsonc:{lineComment:{start:"//"}},jsx:{lineComment:{start:"//"}},julia:{lineComment:{start:"#"},aliases:["Julia","julia"],extensions:[".jl"]},kotlin:{lineComment:{start:"//"}},latex:{lineComment:{start:"%"},aliases:["LaTeX","latex"],extensions:[".tex",".ltx",".ctx"]},less:{lineComment:{start:"//"},aliases:["Less","less"],extensions:[".less"]},lua:{lineComment:{start:"--"},aliases:["Lua","lua"],extensions:[".lua"]},makefile:{lineComment:{start:"#"},aliases:["Makefile","makefile"],extensions:[".mak",".mk"]},markdown:{lineComment:{start:"//"},aliases:["Markdown","markdown"],extensions:[".md",".mkd",".mdwn",".mdown",".markdown",".markdn",".mdtxt",".mdtext",".workbook"]},"objective-c":{lineComment:{start:"//"},aliases:["Objective-C"],extensions:[".m"]},"objective-cpp":{lineComment:{start:"//"},aliases:["Objective-C++"],extensions:[".mm"]},perl:{lineComment:{start:"#"},aliases:["Perl","perl"],extensions:[".pl",".pm",".pod",".t",".PL",".psgi"]},php:{lineComment:{start:"//"},aliases:["PHP","php"],extensions:[".php",".php4",".php5",".phtml",".ctp"]},powershell:{lineComment:{start:"#"},aliases:["PowerShell","powershell","ps","ps1"],extensions:[".ps1",".psm1",".psd1",".pssc",".psrc"]},pug:{lineComment:{start:"//"}},python:{lineComment:{start:"#"},aliases:["Python","py"],extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi",".pyi",".ipy",".pyt"]},ql:{lineComment:{start:"//"}},r:{lineComment:{start:"#"},aliases:["R","r"],extensions:[".r",".rhistory",".rprofile",".rt"]},razor:{lineComment:{start:"<!--",end:"-->"},aliases:["Razor","razor"],extensions:[".cshtml",".razor"]},ruby:{lineComment:{start:"#"},aliases:["Ruby","rb"],extensions:[".rb",".rbx",".rjs",".gemspec",".rake",".ru",".erb",".podspec",".rbi"]},rust:{lineComment:{start:"//"},aliases:["Rust","rust"],extensions:[".rs"]},sass:{lineComment:{start:"//"}},scala:{lineComment:{start:"//"}},scss:{lineComment:{start:"//"},aliases:["SCSS","scss"],extensions:[".scss"]},shellscript:{lineComment:{start:"#"},aliases:["Shell Script","shellscript","bash","fish","sh","zsh","ksh","csh"],extensions:[".sh",".bash",".bashrc",".bash_aliases",".bash_profile",".bash_login",".ebuild",".profile",".bash_logout",".xprofile",".xsession",".xsessionrc",".Xsession",".zsh",".zshrc",".zprofile",".zlogin",".zlogout",".zshenv",".zsh-theme",".fish",".ksh",".csh",".cshrc",".tcshrc",".yashrc",".yash_profile"]},slim:{lineComment:{start:"/"}},solidity:{lineComment:{start:"//"}},sql:{lineComment:{start:"--"},aliases:["SQL"],extensions:[".sql",".dsql"]},stylus:{lineComment:{start:"//"}},svelte:{lineComment:{start:"<!--",end:"-->"}},swift:{lineComment:{start:"//"},aliases:["Swift","swift"],extensions:[".swift"]},terraform:{lineComment:{start:"#"}},tex:{lineComment:{start:"%"},aliases:["TeX","tex"],extensions:[".sty",".cls",".bbx",".cbx"]},typescript:{lineComment:{start:"//"},aliases:["TypeScript","ts","typescript"],extensions:[".ts",".cts",".mts"]},typescriptreact:{lineComment:{start:"//"},aliases:["TypeScript JSX","TypeScript React","tsx"],extensions:[".tsx"]},vb:{lineComment:{start:"'"},aliases:["Visual Basic","vb"],extensions:[".vb",".brs",".vbs",".bas",".vba"]},verilog:{lineComment:{start:"//"}},"vue-html":{lineComment:{start:"<!--",end:"-->"}},vue:{lineComment:{start:"//"},extensions:[".vue"]},xml:{lineComment:{start:"<!--",end:"-->"},aliases:["XML","xml"],extensions:[".xml",".xsd",".ascx",".atom",".axml",".axaml",".bpmn",".cpt",".csl",".csproj",".csproj.user",".dita",".ditamap",".dtd",".ent",".mod",".dtml",".fsproj",".fxml",".iml",".isml",".jmx",".launch",".menu",".mxml",".nuspec",".opml",".owl",".proj",".props",".pt",".publishsettings",".pubxml",".pubxml.user",".rbxlx",".rbxmx",".rdf",".rng",".rss",".shproj",".storyboard",".svg",".targets",".tld",".tmx",".vbproj",".vbproj.user",".vcxproj",".vcxproj.filters",".wsdl",".wxi",".wxl",".wxs",".xaml",".xbl",".xib",".xlf",".xliff",".xpdl",".xul",".xoml"]},xsl:{lineComment:{start:"<!--",end:"-->"},aliases:["XSL","xsl"],extensions:[".xsl",".xslt"]},yaml:{lineComment:{start:"#"}}}),L_=new Map(Object.entries(Jze).map(([t,e])=>[t,{languageId:t,...e}]));function mn(t){return dY(typeof t=="string"?t:typeof t>"u"?"plaintext":t.languageId)}function dY(t){return L_.get(t.toLowerCase())??{languageId:t,lineComment:{start:"//"}}}function Ns(t){let e=tl(t).toLowerCase();for(let r of L_.values())if(r.extensions?.includes(e))return r;return mn("plaintext")}function Si(t,e,r=!0,n){let o=e.matchAll(/^\s*(```+)/gm),s=Math.max(3,...Array.from(o,l=>l[1].length+1)),a="`".repeat(s),c="";if(n){let l=mn(t),{start:u,end:d}=l.lineComment;c=d?`${u} filepath: ${n} ${d}
`:`${u} filepath: ${n}
`}return`${a}${x5(t)}
${c}${r?e.trim():e}
${a}`}function x5(t){switch(t.trim().toLowerCase()){case"typescriptreact":return"tsx";case"javascriptreact":return"jsx";default:return t}}function S5(t){let e=tl(t).toLowerCase(),r=Object.keys(L_).find(n=>L_.get(n)?.extensions?.includes(e))||e.replace(/^\./,"");return x5(r)}function Ls(t){let e=[],n=new uY().parse(t,{});for(let o of gve(n))o.map&&o.type==="fence"&&e.push({startMarkup:o.markup,code:o.content.replace(/\n$/,""),language:o.info.trim(),startLine:o.map[0],endLine:o.map[1]});return e}function*gve(t){for(let e of t)e.children&&(yield*gve(e.children)),yield e}var OI=q(Ue()),fY=q(require("path"));var F2=q(Ue()),pY=q(require("path"));var I5=q(Ue());var _v=class extends I5.PromptElement{constructor(r,n,o,s,a){super(r);this._contextService=n;this._telemetryService=o;this._logService=s;this._ignoreService=a}_handleFoulPrompt(){let r=new Error("BAD PROMPT");if(this._logService.internal.error(r),this._contextService.extensionMode!==nl.Production)throw r;this._telemetryService.sendMSFTTelemetryErrorEvent("prompt.invalidreference",{stack:r.stack})}};_v=E([y(1,Bt),y(2,ge),y(3,ie),y(4,Te)],_v);var nt=class extends _v{async render(){if(this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1)return this._handleFoulPrompt();let r=Si(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0,this.props.includeFilepath?this.props.uri.path:void 0);return vscpp(I5.TextChunk,null,this.props.references&&vscpp("references",{value:this.props.references}),r)}};var O_=class extends _v{get insertLineBreakBefore(){return!1}async render(){if(await this._ignoreService.isCopilotIgnored(this.props.value))return this._handleFoulPrompt();let r;return this.props.mode===1?r=this.props.value.path:r=Ml(this.props.value),vscpp(vscppf,null,r)}};var LI=class extends F2.PromptElement{constructor(r,n,o){super(r);this._ignoreService=n;this._tabsAndEditorsService=o}async render(r,n){let o=this._tabsAndEditorsService.activeTextEditor;if(!o)return;let s=o.visibleRanges,a=o.document;if(await this._ignoreService.isCopilotIgnored(a.uri))return vscpp("ignoredFiles",{value:[a.uri]});if(a.getText().trim().length===0)return vscpp(vscppf,null,vscpp(F2.UserMessage,{priority:this.props.priority},vscpp("references",{value:[new Bo.PromptReference(a.uri)]}),"The active ",a.languageId," file ",pY.basename(a.uri.path)," is empty."));if(s.length!==0)return vscpp(vscppf,null,vscpp(F2.UserMessage,{priority:this.props.priority},s.map(l=>vscpp(vscppf,null,"Excerpt from active file ",pY.basename(a.uri.path),", lines ",l.start.line+1," to ",l.end.line+1,":",vscpp("br",null),vscpp(nt,{code:a.getText(l),languageId:a.languageId,uri:a.uri,references:[new Bo.PromptReference({uri:a.uri,range:l})]}),vscpp("br",null),vscpp("br",null)))))}};LI=E([y(1,Te),y(2,Ft)],LI);var bn=class extends OI.PromptElement{constructor(r,n,o,s,a){super(r);this.ignoreService=n;this.logger=o;this._tabsAndEditorsService=s;this._tokenizerProvider=a}static{this.variableInfo={name:"selection",fullName:"Selection",icon:"selection",description:"The current selection in the active editor",defaultEnablement:!0,registerTool:!0}}async prepare(r){if(!this.props.document)return{isIgnored:!1,exceedsTokenBudget:!1};let n=await this.ignoreService.isCopilotIgnored(this.props.document.uri),o=!1,s=bn.getCurrentSelection(this._tabsAndEditorsService);return s&&this._tokenizerProvider.acquireTokenizer(r.endpoint).tokenLength(s?.selectedText)*1.1>r.tokenBudget&&(o=!0),{isIgnored:n,exceedsTokenBudget:o}}render(r,n){let o=bn.getCurrentSelection(this._tabsAndEditorsService);if(!o)return vscpp(LI,null);let s=[new Bo.PromptReference(new fn(o.activeDocument.uri,o.range))],a=[o.activeDocument.uri];return r.isIgnored?vscpp("ignoredFiles",{value:a}):r.exceedsTokenBudget?(this.logger.internal.info(`Dropped current selection (${n.tokenBudget} / ${n.endpoint.modelMaxPromptTokens} tokens)`),vscpp(vscppf,null,vscpp(OI.AssistantMessage,{priority:this.props.priority,name:"selection-too-large"},"Your active selection (",o.fileName&&vscpp(vscppf,null,o.selectedText.split(`
`).length," lines from ",fY.basename(o.fileName)),") exceeded my maximum context size and was dropped. Please reduce the selection to the most relevant part."))):vscpp(vscppf,null,vscpp(OI.UserMessage,{priority:this.props.priority},"Active selection:",vscpp("br",null),vscpp("br",null),vscpp("br",null),o.fileName&&vscpp(vscppf,null,"From the file: ",fY.basename(o.fileName),vscpp("br",null)),vscpp(nt,{code:o.selectedText,languageId:o.languageId,uri:o.activeDocument.uri,references:s}),vscpp("br",null),vscpp("br",null)))}static getCurrentSelection(r,n=!1){let o=r.activeTextEditor,s=o?.document;if(s){let a=o.selection;if(a&&(!a.isEmpty||a.isEmpty&&n)){let c=s.languageId,l=s.getText(a);return{languageId:c,selectedText:l,activeDocument:s,range:a,fileName:s.fileName}}}}};bn=E([y(1,Te),y(2,ie),y(3,Ft),y(4,_r)],bn);var xv=class{constructor(e){this._instantiationService=e;this.kind="current-selection";this.variableInfo=bn.variableInfo}async resolveContext(e){let{messages:r,references:n}=await yo(this._instantiationService,e.endpoint,bn,{});if(r.length>0&&n.length>0)return{kind:this.kind,userMessages:r.map(o=>o.content),references:n}}static formatSelection(e){let r=e.fileName?`From the file: ${vve.basename(e.fileName)}
`:"",{trimmedLines:n}=P2(e.selectedText.split(/\r?\n/g));return`

${r}${Si(e.languageId,Dr(n).join(`
`))}

`}};xv=E([y(0,j)],xv);jn.register(new ye(xv));var a0e=q(Ct()),eC=q(Ue());var pc=class{get lines(){return this._lineStartOffsets.length}constructor(e){this._lineStartOffsets=[0];let r=0;for(;;){let n=e.indexOf(`
`,r);if(n===-1)break;this._lineStartOffsets.push(n+1),r=n+1}}lineLength(e){return this._lineStartOffsets[e]-this._lineStartOffsets[e-1]-1}offsetToPosition(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);let n=e-this._lineStartOffsets[r-1];return new Ut(r,n+1)}startOffsetOfLineContaining(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);return this._lineStartOffsets[r-1]}positionToOffset(e){return e.lineNumber>=this._lineStartOffsets.length?this._lineStartOffsets[this._lineStartOffsets.length-1]+e.column-1:this._lineStartOffsets[e.lineNumber-1]+e.column-1}};var Or=class t{constructor(e){this.edits=e;let r=-1;for(let n of e){if(!(n.replaceRange.start>=r))throw new Error(`Edits must be disjoint and sorted. Found ${n} after ${r}`);r=n.replaceRange.endExclusive}}static{this.empty=new t([])}static fromJson(e){return new t(e.map(Ii.fromJson))}static from(e){let r=e.map(o=>new Ii(St.ofStartAndLength(o.rangeOffset,o.rangeLength),o.text));return r.reverse(),new t(r)}static single(e,r){return new t([new Ii(e,r)])}static async fromDiff(e,r,n){let o=await n.computeDiff(e,r,{maxComputationTimeMs:5e3,computeMoves:!1,ignoreTrimWhitespace:!1}),s=new pc(e),a=new pc(r),c=[];for(let l of o.changes)for(let u of l.innerChanges??[]){let d=a.positionToOffset(u.modifiedRange.getStartPosition()),p=a.positionToOffset(u.modifiedRange.getEndPosition()),f=r.substring(d,p),m=s.positionToOffset(u.originalRange.getStartPosition()),h=s.positionToOffset(u.originalRange.getEndPosition()),g=new St(m,h);c.push(new Ii(g,f))}return new t(c)}normalize(){let e=[],r;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(r&&r.replaceRange.endExclusive===n.replaceRange.start?r=new Ii(r.replaceRange.join(n.replaceRange),r.newText+n.newText):(r&&e.push(r),r=n));return r&&e.push(r),new t(e)}normalizeEOL(e){return new t(this.edits.map(r=>r.normalizeEOL(e)))}isNoop(e){return this.edits.every(r=>r.isNoop(e))}toString(){return`[${this.edits.map(r=>r.toString()).join(", ")}]`}apply(e){let r=[],n=0;for(let o of this.edits)r.push(e.substring(n,o.replaceRange.start)),r.push(o.newText),n=o.replaceRange.endExclusive;return r.push(e.substring(n)),r.join("")}compose(e){return Zze(this,e)}inverse(e){let r=[],n=0;for(let o of this.edits)r.push(new Ii(St.ofStartAndLength(o.replaceRange.start+n,o.newText.length),e.substring(o.replaceRange.start,o.replaceRange.endExclusive))),n+=o.newText.length-o.replaceRange.length;return new t(r)}getNewTextRanges(){let e=[],r=0;for(let n of this.edits)e.push(St.ofStartAndLength(n.replaceRange.start+r,n.newText.length)),r+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let r=[],n=0,o=0,s=0;for(;o<this.edits.length||n<e.edits.length;){let a=e.edits[n],c=this.edits[o];if(c)a?c.replaceRange.intersects(a.replaceRange)?o++:c.replaceRange.start<a.replaceRange.start?(r.push(new Ii(c.replaceRange.delta(s),c.newText)),o++):(n++,s+=a.newText.length-a.replaceRange.length):(r.push(new Ii(c.replaceRange.delta(s),c.newText)),o++);else break}return new t(r)}removeCommonSuffixPrefix(e){let r=[];for(let n of this.edits){let o=n.removeCommonSuffixPrefix(e);o.isEmpty||r.push(o)}return new t(r)}applyToOffset(e){let r=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+r;r+=n.newText.length-n.replaceRange.length}else break;return e+r}applyToOffsetRange(e){return new St(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let r=0;for(let n of this.edits){let o=n.newText.length;if(n.replaceRange.start<=e-r){if(e-r<n.replaceRange.start+o)return n.replaceRange.start;r+=o-n.replaceRange.length}else break}return e-r}},Ii=class t{constructor(e,r){this.replaceRange=e;this.newText=r}static delete(e){return new t(e,"")}static fromJson(e){return new t(St.ofStartAndLength(e.pos,e.len),e.txt)}toString(){return`${this.replaceRange} -> "${this.newText}"`}removeCommonSuffixPrefix(e){let r=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),n=LM(r,this.newText),o=Math.min(r.length-n,this.newText.length-n,jfe(r,this.newText)),s=new St(this.replaceRange.start+n,this.replaceRange.endExclusive-o),a=this.newText.substring(n,this.newText.length-o);return new t(s,a)}normalizeEOL(e){let r=this.newText.replace(/\r\n|\n/g,e);return new t(this.replaceRange,r)}isNoop(e){return this.newText===e.substring(this.replaceRange.start,this.replaceRange.endExclusive)}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function Zze(t,e){if(t=t.normalize(),e=e.normalize(),t.isEmpty)return e;if(e.isEmpty)return t;let r=[...t.edits],n=[],o=0;for(let s of e.edits){for(;;){let u=r[0];if(!u||u.replaceRange.start+o+u.newText.length>=s.replaceRange.start)break;r.shift(),n.push(u),o+=u.newText.length-u.replaceRange.length}let a=o,c,l;for(;;){let u=r[0];if(!u||u.replaceRange.start+o>s.replaceRange.endExclusive)break;c||(c=u),l=u,r.shift(),o+=u.newText.length-u.replaceRange.length}if(!c)n.push(new Ii(s.replaceRange.delta(-o),s.newText));else{let u="",d=s.replaceRange.start-(c.replaceRange.start+a);d>0&&(u=c.newText.slice(0,d));let p=l.replaceRange.endExclusive+o-s.replaceRange.endExclusive;if(p>0){let h=new Ii(St.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-p));r.unshift(h),o-=h.newText.length-h.replaceRange.length}let f=u+s.newText,m=new St(Math.min(c.replaceRange.start,s.replaceRange.start-a),s.replaceRange.endExclusive-o);n.push(new Ii(m,f))}}for(;;){let s=r.shift();if(!s)break;n.push(s)}return new Or(n).normalize()}var dt=ne("IParserService");function C5(t){return{startPosition:{row:t.start.line,column:t.start.character},endPosition:{row:t.end.line,column:t.end.character}}}function T5(t){return new Be(t.startPosition.row,t.startPosition.column,t.endPosition.row,t.endPosition.column)}function _o(t,e){return{startIndex:e.offsetAt(t.start),endIndex:e.offsetAt(t.end)}}function Os(t,e){return new Be(t.positionAt(e.startIndex),t.positionAt(e.endIndex))}var k5=q(Ue());var jo=ne("ILanguageFeaturesService");function Gm(t){return typeof t=="object"&&t!==null&&"targetUri"in t}var En={doesContain:(t,e)=>t.startIndex<=e.startIndex&&e.endIndex<=t.endIndex,ofSyntaxNode:t=>({startIndex:t.startIndex,endIndex:t.endIndex}),compare:(t,e)=>t.startIndex-e.startIndex||e.endIndex-t.endIndex,isEqual:(t,e)=>En.compare(t,e)===0,doIntersect:(t,e)=>{let r=Math.max(t.startIndex,e.startIndex),n=Math.min(t.endIndex,e.endIndex);return r<n},len:t=>t.endIndex-t.startIndex,intersectionSize:(t,e)=>{let r=Math.max(t.startIndex,e.startIndex),n=Math.min(t.endIndex,e.endIndex);return Math.max(n-r,0)},isTreeSitterOffsetRange(t){return typeof t.startIndex=="number"&&typeof t.endIndex=="number"}},gd={isEqual(t,e){return t.row===e.row&&t.column===e.column},isBefore(t,e){return t.row<e.row||t.row===e.row&&t.column<e.column},isAfter(t,e){return gd.isBefore(e,t)},isBeforeOrEqual(t,e){let r=gd.isBefore(t,e),n=gd.isEqual(t,e);return!!(r||n)},equals(t,e){return t.column===e.column&&t.row===e.row},isAfterOrEqual(t,e){return gd.isBeforeOrEqual(e,t)},ofPoint:t=>({row:t.row,column:t.column})},Sv={doesContain:(t,e)=>gd.isBeforeOrEqual(t.startPosition,e.startPosition)&&gd.isAfterOrEqual(t.endPosition,e.endPosition),equals:(t,e)=>gd.equals(t.startPosition,e.startPosition)&&gd.equals(t.endPosition,e.endPosition),ofSyntaxNode:t=>({startPosition:t.startPosition,endPosition:t.endPosition})},Iv={ofSyntaxNode:t=>({type:t.type,startIndex:t.startIndex,endIndex:t.endIndex})},fc={ofSyntaxNode:t=>({range:Sv.ofSyntaxNode(t),startIndex:t.startIndex,text:t.text,endIndex:t.endIndex})},Rp=class{constructor(e,r,n,o){this.startIndex=e;this.endIndex=r;this.kind=n;this.children=o;if(e>r)throw new yr("startIndex must be less than endIndex");let s=e;for(let a of o){if(a.startIndex<s)throw new yr("Invalid child startIndex");if(a.endIndex>r)throw new yr("Invalid child endIndex");s=Math.max(a.endIndex,s)}}toString(){let e=[];function r(n,o=""){e.push(`${o}${n.kind} [${n.startIndex}, ${n.endIndex}]`),n.children.forEach(s=>r(s,o+"    "))}return r(this),e.join(`
`)}};function _ve(t,e){let r=t.getText().split(/\r|\n|\r\n/g),n=e||{tabSize:4},o={getLineCount:()=>r.length,getLineContent:s=>r[s-1],getOptions:()=>n};try{let s=t$e(o,t.languageId),[a]=xve(t,s,void 0);return a.adjust(t,Sve(t.languageId)),a.toOverlayNode(t,!0)}catch{return new E5(1,t.lineCount,[]).toOverlayNode(t,!0)}}function xve(t,e,r){if(typeof r<"u"&&r>=e.length)throw new Error(`Invalid region index ${r}`);let n=typeof r>"u"?1:e.getStartLineNumber(r),o=typeof r>"u"?t.lineCount:e.getEndLineNumber(r),s=[],a=null;for(r=typeof r>"u"?0:r+1;r<e.length;){let c=e.getStartLineNumber(r),l=e.getEndLineNumber(r);if(c>o||l>o)break;let u=a;if([a,r]=xve(t,e,r),u&&a.startLineNumber<=u.endLineNumber)throw new yr("Invalid Folding Ranges: overlapping children");if(a.startLineNumber<n)throw new yr("Invalid Folding Ranges: child starts before parent");s.push(a)}return[new E5(n,o,s),r]}var E5=class{constructor(e,r,n){this.startLineNumber=e;this.endLineNumber=r;this.children=n;if(e>r)throw new yr("Invalid Folding Ranges: startLineNumber > endLineNumber")}adjust(e,r){r?this._adjustOffside():this._adjustRegular(e,e.lineCount)}_adjustOffside(){this.startLineNumber++;for(let e of this.children)e._adjustOffside()}_adjustRegular(e,r){if(this.endLineNumber<r){let n=e.lineAt(this.endLineNumber).text.trim(),o=/^[\}\]\)];?$/.test(n),s=/^<\/\w/.test(n);(o||s)&&this.endLineNumber++}for(let n=this.children.length-1;n>=0;n--){let o=this.children[n],s=n+1<this.children.length?this.children[n+1].startLineNumber-1:r;o._adjustRegular(e,s)}}toOverlayNode(e,r){let n=[],o=r&&this.startLineNumber===1?1:this.startLineNumber+1;for(let s of this.children){for(let a=o;a<s.startLineNumber;a++){let c=yve(e,a);c&&n.push(c)}n.push(s.toOverlayNode(e,!1)),o=s.endLineNumber+1}for(let s=o;s<this.endLineNumber;s++){let a=yve(e,s);a&&n.push(a)}return e$e(e,this.startLineNumber,this.endLineNumber,n)}};function yve(t,e){let r=t.lineAt(e-1);if(r.isEmptyOrWhitespace)return null;let n=t.offsetAt(r.range.start),o=t.offsetAt(r.range.end);return new Rp(n,o,"LINE",[])}function e$e(t,e,r,n){let o=t.offsetAt(new xr(e-1,0)),s=t.offsetAt(new xr(r-1,t.lineAt(r-1).text.length));return new Rp(o,s,"FOLD",n)}function t$e(t,e){return r$e(t,Sve(e))}function Sve(t){return["clojure","coffeescript","fsharp","latex","markdown","pug","python","sql","yaml"].includes(t)}function r$e(t,e){let r=t.getOptions().tabSize,n=new mY,o=[],s=t.getLineCount()+1;o.push({indent:-1,endAbove:s,line:s});for(let a=t.getLineCount();a>0;a--){let c=t.getLineContent(a),l=i$e(c,r),u=o[o.length-1];if(l===-1){e&&(u.endAbove=a);continue}if(u.indent>l){do o.pop(),u=o[o.length-1];while(u.indent>l);let d=u.endAbove-1;d-a>=1&&n.insertFirst(a,d,l)}u.indent===l?u.endAbove=a:o.push({indent:l,endAbove:a,line:a})}return n.toIndentRanges()}var n$e=65535,M_=16777215,bve=4278190080,mY=class{constructor(){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0}insertFirst(e,r,n){if(e>M_||r>M_)return;let o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=r,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}toIndentRanges(){let e=new Uint32Array(this._length),r=new Uint32Array(this._length);for(let n=this._length-1,o=0;n>=0;n--,o++)e[o]=this._startIndexes[n],r[o]=this._endIndexes[n];return new hY(e,r)}};function i$e(t,e){let r=0,n=0,o=t.length;for(;n<o;){let s=t.charCodeAt(n);if(s===32)r++;else if(s===9)r=r-r%e+e;else break;n++}return n===o?-1:r}var hY=class{constructor(e,r){this._startIndexes=e,this._endIndexes=r,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],r=(n,o)=>{let s=e[e.length-1];return this.getStartLineNumber(s)<=n&&this.getEndLineNumber(s)>=o};for(let n=0,o=this._startIndexes.length;n<o;n++){let s=this._startIndexes[n],a=this._endIndexes[n];if(s>M_||a>M_)throw new Error("startLineNumber or endLineNumber must not exceed "+M_);for(;e.length>0&&!r(s,a);)e.pop();let c=e.length>0?e[e.length-1]:-1;e.push(n),this._startIndexes[n]=s+((c&255)<<24),this._endIndexes[n]=a+((c&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&M_}getEndLineNumber(e){return this._endIndexes[e]&M_}getParentIndex(e){this.ensureParentIndices();let r=((this._startIndexes[e]&bve)>>>24)+((this._endIndexes[e]&bve)>>>16);return r===n$e?-1:r}contains(e,r){return this.getStartLineNumber(e)<=r&&this.getEndLineNumber(e)>=r}findIndex(e){let r=0,n=this._startIndexes.length;if(n===0)return-1;for(;r<n;){let o=Math.floor((r+n)/2);e<this.getStartLineNumber(o)?n=o:r=o+1}return r-1}findRange(e){let r=this.findIndex(e);if(r>=0){if(this.getEndLineNumber(r)>=e)return r;for(r=this.getParentIndex(r);r!==-1;){if(this.contains(r,e))return r;r=this.getParentIndex(r)}}return-1}};var w5=class extends Error{constructor(e){super(`Unrecognized language: ${e}`)}},Ive={python:"python",javascript:"javascript",javascriptreact:"javascript",jsx:"javascript",typescript:"typescript",typescriptreact:"tsx",tsx:"tsx",go:"go",ruby:"ruby",csharp:"csharp",cpp:"cpp",java:"java",rust:"rust"};function cl(t){if(t in Ive)return Ive[t]}async function Cve(t,e,r,n){let o=t.get(dt),s=t.get(ie),a=t.get(ge),c=t.get(jo),l=o.getTreeSitterAST(e);if(!l)return[];let u=_o(r,e),d=await mc(s,a,e,n,()=>l.getCallExpressions(u),[]);async function p(v){let b=e.positionAt(v.startIndex);try{let _=await c.getImplementations(e.uri,b);return _.length?_:await c.getDefinitions(e.uri,b)}catch{return[]}}let f=await mc(s,a,e,n*3,()=>Promise.all(d.map(p)),[]),m=[];for(let v=0;v<f.length;v++){let b=d[v],_=f[v];for(let x of _){let{uri:S,range:I}=Gm(x)?{uri:x.targetUri,range:x.targetRange}:x,w=await t.get(qe).openTextDocument(S),k=o.getTreeSitterAST(w);if(k){let H=(await k.getFunctionDefinitions()).find(F=>F.identifier===b.identifier);if(H){let F=_o(I,w);m.push({uri:S,range:I,version:w.version,identifier:b.identifier,startIndex:F.startIndex,endIndex:F.endIndex,text:H.text})}}}}if(m.length!==0)return m;let h=await mc(s,a,e,n,()=>l.getFunctionDefinitions(),[]),g=[];for(let v of h)for(let b of d)v.identifier===b.identifier&&g.push(v);return g.sort((v,b)=>v.startIndex-b.startIndex)}async function Tve(t,e,r,n){let o=t.get(ie),s=t.get(ge),a=t.get(dt),c=a.getTreeSitterAST(e);if(!c)return[];let l=t.get(jo),u=_o(r,e),d=await mc(o,s,e,n,()=>c.getClassReferences(u),[]),p=await mc(o,s,e,n*3,async()=>await Promise.all(d.map(async g=>{try{let v=e.positionAt(g.startIndex),b=await l.getImplementations(e.uri,v);return b.length?b:await l.getDefinitions(e.uri,v)}catch{return[]}})),[]),f=[];for(let g=0;g<p.length;g++){let v=d[g],b=p[g];for(let _ of b){let{uri:x,range:S}=Gm(_)?{uri:_.targetUri,range:_.targetRange}:_,I=await t.get(qe).openTextDocument(x),w=a.getTreeSitterAST(I);if(w){let k=(await w.getClassDeclarations()).find(M=>M.identifier===v.identifier);if(k){let M=_o(S,I);f.push({uri:x,range:S,version:I.version,identifier:v.identifier,startIndex:M.startIndex,endIndex:M.endIndex,text:k.text})}}}}if(f.length!==0)return f;let m=await mc(o,s,e,n,()=>c.getClassDeclarations(),[]),h=[];for(let g of m)for(let v of d)g.identifier===v.identifier&&h.push(g);return h.sort((g,v)=>g.startIndex-v.startIndex)}async function Eve(t,e,r,n){let o=t.get(ie),s=t.get(ge),c=t.get(dt).getTreeSitterAST(e);if(!c)return[];let l=_o(r,e),u=await mc(o,s,e,n,()=>c.getTypeReferences(l),[]),d=await mc(o,s,e,n,()=>c.getTypeDeclarations(),[]),p=[];for(let f of d)for(let m of u)f.identifier===m.identifier&&p.push(f);return p.sort((f,m)=>f.startIndex-m.startIndex)}function o$e(t,e){return e===0?t.then(r=>({type:"success",value:r})):new Promise((r,n)=>{let o=setTimeout(()=>r({type:"timeout"}),e);t.then(s=>{clearTimeout(o),r({type:"success",value:s})}).catch(s=>{clearTimeout(o),n(s)})})}async function mc(t,e,r,n,o,s){try{let a=await o$e(wve(r,o,s),n);return a.type==="success"?a.value:(t.public.warn(`Computing async parser based result took longer than ${n}ms`),s)}catch(a){return a instanceof w5||(t.public.error(a,"Failed to compute async parser based result"),e.sendGHTelemetryException(a,"Failed to compute async parser based result")),s}}async function wve(t,e,r,n=0){let o=t.version,s=await e();return t.version!==o?n<3?wve(t,e,r,n+1):r:s}var Pp=class t{static forDocument(e,r){return this.forUri(e,r.uri)}static forUri(e,r){return`${this.forLanguage(e)}: ${r.path}`}static forLanguage(e){return`${e.lineComment.start} FILEPATH`}static testLine(e,r){let n=t.forLanguage(e);return r.trimStart().startsWith(n)}};var vd=class{static begin(e,r){return typeof r>"u"?`${e.lineComment.start} BEGIN:`:`${e.lineComment.start} BEGIN: ${r}`}static end(e,r){return typeof r>"u"?`${e.lineComment.start} END:`:`${e.lineComment.start} END: ${r}`}};function kve(t){return/(^|\n)```[\s\S]+\n```/m.test(t)}function Rve(t){return t.split("```",1)[0].match(/^.+/)?.[0]??""}async function Ap(t,e,r){let o=await t.getTreeSitterAST(e)?.getStructure();return o||_ve(e,r)}var zm=class extends ql{constructor(r,n){super();this.wholeRange=r;this.contextInfo=n}};(e=>{function t(r){return r instanceof e}e.is=t})(zm||={});var Dp=class{constructor(e){this.charLimit=e;this._totalChars=0}get totalChars(){return this._totalChars}addLine(e){this._totalChars+=e.length+1}lineWouldFit(e){return this._totalChars+e.length+1<this.charLimit}},sa=class t{constructor(e,r,n,o){this.tracker=e;this.document=r;this.language=n;this.kindOrUniqueStr=o;this.lines=[];this.firstLineIndex=this.document.lineCount;this.lastLineIndex=-1;this.isComplete=!1;this.nonTrimWhitespaceCharCount=0;this._startMarker=vd.begin(n,o),this._endMarker=vd.end(n,o),this.lines=[],this.firstLineIndex=r.lineCount,this.lastLineIndex=-1}get startMarker(){return this._startMarker}get endMarker(){return this._endMarker}get lineCount(){return this.lines.length}get isVerySmallOrEmpty(){return this.nonTrimWhitespaceCharCount<10}get hasContent(){return this.lines.length===0||this.nonTrimWhitespaceCharCount===0?!1:this.lines.length>0}clone(){let e=new t(this.tracker,this.document,this.language,this.kindOrUniqueStr);return e._startMarker=this.startMarker,e._endMarker=this.endMarker,e.lines.push(...this.lines),e.firstLineIndex=this.firstLineIndex,e.lastLineIndex=this.lastLineIndex,e.nonTrimWhitespaceCharCount=this.nonTrimWhitespaceCharCount,e}clear(){this.lines.length=0,this.firstLineIndex=this.document.lineCount,this.lastLineIndex=-1,this.nonTrimWhitespaceCharCount=0}generatePrompt(e){if(!this.hasContent)return[];let r=[];return r.push("```"+this.language.languageId),r.push(Pp.forDocument(this.language,this.document)),e&&r.push(`${this.startMarker}`),r.push(...this.lines),e&&r.push(`${this.endMarker}`),r.push("```"),r}prependLine(e){let n=this.document.lineAt(e).text;return this.tracker.lineWouldFit(n)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.unshift(n),this.tracker.addLine(n),this.nonTrimWhitespaceCharCount+=n.trim().length,!0):!1}appendLine(e){let n=this.document.lineAt(e).text;return this.tracker.lineWouldFit(n)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.push(n),this.tracker.addLine(n),this.nonTrimWhitespaceCharCount+=n.trim().length,!0):!1}trim(e){let r=e?Math.min(this.lastLineIndex,e.start.line):this.lastLineIndex;for(;this.firstLineIndex<r&&this.lines.length>0&&this.lines[0].trim().length===0;)this.firstLineIndex++,this.lines.shift();let n=e?Math.max(this.firstLineIndex,e.end.line):this.firstLineIndex;for(;n<this.lastLineIndex&&this.lines.length>0&&this.lines[this.lines.length-1].trim().length===0;)this.lastLineIndex--,this.lines.pop()}removeFirstNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let r=this.lines.splice(0,e),n=0;for(let o of r)n+=o.trim().length;return this.firstLineIndex+=e,this.nonTrimWhitespaceCharCount-=n,{lines:r,nonTrimWhitespaceCharCount:n}}removeLastNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let r=this.lines.splice(this.lines.length-e,e),n=0;for(let o of r)n+=o.trim().length;return this.lastLineIndex-=e,this.nonTrimWhitespaceCharCount-=n,{lines:r,nonTrimWhitespaceCharCount:n}}takeFromAbove(e,r){let{lines:n,nonTrimWhitespaceCharCount:o}=e.removeLastNLines(r);this.lines.unshift(...n),this.firstLineIndex-=n.length,this.nonTrimWhitespaceCharCount+=o}takeFromBelow(e,r){let{lines:n,nonTrimWhitespaceCharCount:o}=e.removeFirstNLines(r);this.lines.push(...n),this.lastLineIndex+=n.length,this.nonTrimWhitespaceCharCount+=o}mergeFromAbove(e){e.hasContent&&(this.lines.unshift(...e.lines),this.firstLineIndex=e.firstLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}mergeFromBelow(e){e.hasContent&&(this.lines.push(...e.lines),this.lastLineIndex=e.lastLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}toRange(){try{let e=this.lastLineIndex===-1?this.document.lineCount-1:this.lastLineIndex,r=new Be(this.firstLineIndex,0,e,this.document.lineAt(e).text.length);if(this.document.validateRange(r)===r)return r}catch{return}}toString(){return`{${this.firstLineIndex} -> ${this.lastLineIndex}}`}};var Cv=class extends k5.PromptElement{constructor(r,n,o,s){super(r);this._telemetryService=n;this._parserService=o;this._ignoreService=s}async prepare(r,n,o){if(await this._ignoreService.isCopilotIgnored(this.props.documentContext.document.uri))return{k:"ignored"};let s=this.props.nodeToDocument??await Tv(this._parserService,this._telemetryService,this.props.documentContext),a=s$e(this.props.endpointInfo,this.props.documentContext,s.range);return{k:"found",nodeToDocument:s,codeExcerptToDocument:a.range,metadata:new zm(this.props.documentContext.wholeRange,a)}}render(r,n){if(r.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let o=r.codeExcerptToDocument.generatePrompt(!1).join(`
`);return vscpp(k5.UserMessage,null,vscpp("meta",{value:r.metadata}),"I have the following code in the selection:",o!==""?vscpp("br",null):"",r.codeExcerptToDocument.generatePrompt(!1).join(`
`))}};Cv=E([y(1,ge),y(2,dt),y(3,Te)],Cv);async function Tv(t,e,r){let n=_o(r.selection,r.document),o=t.getTreeSitterAST(r.document);if(o===void 0)return{range:r.wholeRange};let s=Date.now(),a=await o.getNodeToDocument(n),c=Date.now()-s,l=_o(r.wholeRange,r.document);a$e(e,n,l,a,r.document.languageId,c);let u=Os(r.document,a.nodeToDocument);return{identifier:a.nodeIdentifier,range:u}}function s$e(t,e,r){let n=new Dp(t.modelMaxPromptTokens*4/3),o=new sa(n,e.document,e.language,"ed8c6549bwf9"),s=new sa(new Dp(0),e.document,e.language,"abpxx6d04wxr"),a=new sa(new Dp(0),e.document,e.language,"be15d9bcejpp");for(let c=r.start.line,l=r.end.line;c<=l&&!(c===l&&r.end.character===0||!o.appendLine(c));++c);return o.trim(e.selection),{language:e.language,above:s,range:o,below:a}}function a$e(t,e,r,n,o,s){t.sendMSFTTelemetryEvent("getNodeToDocument",{languageId:o,typeOfNodeToDocument:n.nodeToDocument.type,nodeToDocumentStart:n.nodeToDocument.startIndex.toString(),nodeToDocumentEnd:n.nodeToDocument.endIndex.toString(),selectionOffsetRangeStart:e.startIndex.toString(),selectionOffsetRangeEnd:e.endIndex.toString(),wholeRangeOffsetRangeStart:r.startIndex.toString(),wholeRangeOffsetRangeEnd:r.endIndex.toString()},{timeSpentMs:s})}var MI=class{constructor(e,r,n,o){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=o}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}},U2=class{constructor(e){this.lines=e}getElements(){let e=[];for(let r=0,n=this.lines.length;r<n;r++)e[r]=this.lines[r].trim();return e}getCharCount(){let e=0;for(let r of this.lines)e+=r.length;return e}},Ev=class{static Assert(e,r){if(!e)throw new Error(r)}},wv=class{static Copy(e,r,n,o,s){for(let a=0;a<s;a++)n[o+a]=e[r+a]}static Copy2(e,r,n,o,s){for(let a=0;a<s;a++)n[o+a]=e[r+a]}};var R5=class{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new MI(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},P5=class t{constructor(e,r){let[n,o]=t._getElements(e),[s,a]=t._getElements(r);this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=a,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _getElements(e){let r=e.getElements(),n=new Int32Array(r.length);for(let o=0,s=r.length;o<s;o++)n[o]=this._stringHash(r[o],0);return[r,n]}static _numberHash(e,r){return(r<<5)-r+e|0}static _stringHash(e,r){r=this._numberHash(149417,r);for(let n=0,o=e.length;n<o;n++)r=this._numberHash(e.charCodeAt(n),r);return r}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._originalStringElements[e]===this._modifiedStringElements[r]}ComputeDiff(){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1)}_ComputeDiff(e,r,n,o){return this.ComputeDiffRecursive(e,r,n,o)}ComputeDiffRecursive(e,r,n,o){for(;e<=r&&n<=o&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&o>=n&&this.ElementsAreEqual(r,o);)r--,o--;if(e>r||n>o){let d;return n<=o?(Ev.Assert(e===r+1,"originalStart should only be one more than originalEnd"),d=[new MI(e,0,n,o-n+1)]):e<=r?(Ev.Assert(n===o+1,"modifiedStart should only be one more than modifiedEnd"),d=[new MI(e,r-e+1,n,0)]):(Ev.Assert(e===r+1,"originalStart should only be one more than originalEnd"),Ev.Assert(n===o+1,"modifiedStart should only be one more than modifiedEnd"),d=[]),d}let s=[0],a=[0],c=this.ComputeRecursionPoint(e,r,n,o,s,a),l=s[0],u=a[0];if(c!==null)return c;{let d=this.ComputeDiffRecursive(e,l,n,u),p=this.ComputeDiffRecursive(l+1,r,u+1,o);return this.ConcatenateChanges(d,p)}}WALKTRACE(e,r,n,o,s,a,c,l,u,d,p,f,m,h,g,v,b){let _=null,x=null,S=new R5,I=r,w=n,k=m[0]-v[0]-o,M=-1073741824,H=this.m_forwardHistory.length-1;do{let F=k+e;F===I||F<w&&u[F-1]<u[F+1]?(p=u[F+1],h=p-k-o,p<M&&S.MarkNextChange(),M=p,S.AddModifiedElement(p+1,h),k=F+1-e):(p=u[F-1]+1,h=p-k-o,p<M&&S.MarkNextChange(),M=p-1,S.AddOriginalElement(p,h+1),k=F-1-e),H>=0&&(u=this.m_forwardHistory[H],e=u[0],I=1,w=u.length-1)}while(--H>=-1);_=S.getReverseChanges(),S=new R5,I=a,w=c,k=m[0]-v[0]-l,M=1073741824,H=b?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let F=k+s;F===I||F<w&&d[F-1]>=d[F+1]?(p=d[F+1]-1,h=p-k-l,p>M&&S.MarkNextChange(),M=p+1,S.AddOriginalElement(p+1,h+1),k=F+1-s):(p=d[F-1],h=p-k-l,p>M&&S.MarkNextChange(),M=p,S.AddModifiedElement(p+1,h+1),k=F-1-s),H>=0&&(d=this.m_reverseHistory[H],s=d[0],I=1,w=d.length-1)}while(--H>=-1);return x=S.getChanges(),this.ConcatenateChanges(_,x)}ComputeRecursionPoint(e,r,n,o,s,a){let c=0,l=0,u=0,d=0,p=0,f=0;e--,n--,s[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let m=r-e+(o-n),h=m+1,g=new Int32Array(h),v=new Int32Array(h),b=o-n,_=r-e,x=e-n,S=r-o,w=(_-b)%2===0;g[b]=e,v[_]=r;for(let k=1;k<=m/2+1;k++){let M=0,H=0;u=this.ClipDiagonalBound(b-k,k,b,h),d=this.ClipDiagonalBound(b+k,k,b,h);for(let F=u;F<=d;F+=2){F===u||F<d&&g[F-1]<g[F+1]?c=g[F+1]:c=g[F-1]+1,l=c-(F-b)-x;let ue=c;for(;c<r&&l<o&&this.ElementsAreEqual(c+1,l+1);)c++,l++;if(g[F]=c,c+l>M+H&&(M=c,H=l),!w&&Math.abs(F-_)<=k-1&&c>=v[F])return s[0]=c,a[0]=l,ue<=v[F]&&1447>0&&k<=1448?this.WALKTRACE(b,u,d,x,_,p,f,S,g,v,c,r,s,l,o,a,w):null}p=this.ClipDiagonalBound(_-k,k,_,h),f=this.ClipDiagonalBound(_+k,k,_,h);for(let F=p;F<=f;F+=2){F===p||F<f&&v[F-1]>=v[F+1]?c=v[F+1]-1:c=v[F-1],l=c-(F-_)-S;let ue=c;for(;c>e&&l>n&&this.ElementsAreEqual(c,l);)c--,l--;if(v[F]=c,w&&Math.abs(F-b)<=k&&c<=g[F])return s[0]=c,a[0]=l,ue>=g[F]&&1447>0&&k<=1448?this.WALKTRACE(b,u,d,x,_,p,f,S,g,v,c,r,s,l,o,a,w):null}if(k<=1447){let F=new Int32Array(d-u+2);F[0]=b-u+1,wv.Copy2(g,u,F,1,d-u+1),this.m_forwardHistory.push(F),F=new Int32Array(f-p+2),F[0]=_-p+1,wv.Copy2(v,p,F,1,f-p+1),this.m_reverseHistory.push(F)}}return this.WALKTRACE(b,u,d,x,_,p,f,S,g,v,c,r,s,l,o,a,w)}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){let o=new Array(e.length+r.length-1);return wv.Copy(e,0,o,0,e.length-1),o[e.length-1]=n[0],wv.Copy(r,1,o,e.length,r.length-1),o}else{let o=new Array(e.length+r.length);return wv.Copy(e,0,o,0,e.length),wv.Copy(r,0,o,e.length,r.length),o}}ChangesOverlap(e,r,n){if(Ev.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),Ev.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){let o=e.originalStart,s=e.originalLength,a=e.modifiedStart,c=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(s=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(c=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new MI(o,s,a,c),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,o){if(e>=0&&e<o)return e;let s=n,a=o-n-1,c=r%2===0;if(e<0){let l=s%2===0;return c===l?0:1}else{let l=a%2===0;return c===l?o-1:o-2}}};var gY=class{constructor(){this.spacesDiff=0;this.looksLikeAlignment=!1}};function c$e(t,e,r,n,o){o.spacesDiff=0,o.looksLikeAlignment=!1;let s;for(s=0;s<e&&s<n;s++){let f=t.charCodeAt(s),m=r.charCodeAt(s);if(f!==m)break}let a=0,c=0;for(let f=s;f<e;f++)t.charCodeAt(f)===32?a++:c++;let l=0,u=0;for(let f=s;f<n;f++)r.charCodeAt(f)===32?l++:u++;if(a>0&&c>0||l>0&&u>0)return;let d=Math.abs(c-u),p=Math.abs(a-l);if(d===0){o.spacesDiff=p,p>0&&0<=l-1&&l-1<t.length&&l<r.length&&r.charCodeAt(l)!==32&&t.charCodeAt(l-1)===32&&t.charCodeAt(t.length-1)===44&&(o.looksLikeAlignment=!0);return}if(p%d===0){o.spacesDiff=p/d;return}}function Ave(t){return{...$m(t,4,!1)}}function $m(t,e,r){let n=Math.min(vY(t)?t.length:t.lineCount,1e4),o=0,s=0,a="",c=0,l=[2,4,6,8,3,5,7],u=8,d=[0,0,0,0,0,0,0,0,0],p=new gY;for(let h=0;h<n;h++){let g=vY(t)?t[h]:t.lineAt(h).text,v=g.length,b=!1,_=0,x=0,S=0;for(let w=0,k=v;w<k;w++){let M=g.charCodeAt(w);if(M===9)S++;else if(M===32)x++;else{b=!0,_=w;break}}if(!b||(S>0?o++:x>1&&s++,c$e(a,c,g,_,p),p.looksLikeAlignment&&!(r&&e===p.spacesDiff)))continue;let I=p.spacesDiff;I<=u&&d[I]++,a=g,c=_}let f=r;o!==s&&(f=o<s);let m=e;if(f){let h=f?0:.1*n;l.forEach(g=>{let v=d[g];v>h&&(h=v,m=g)}),m===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(m=2)}return{insertSpaces:f,tabSize:m}}function l$e(t,e){let r=0,n=0,o=t.length;for(;n<o;){let s=t.charCodeAt(n);if(s===32)r++;else if(s===9)r=r-r%e+e;else break;n++}return n===o?~r:r}function A5(t,e){let r=l$e(t,e);return r<0?Math.floor(~r/e):Math.floor(r/e)}function u$e(t,e){return t+e-t%e}function d$e(t,e,r){let n=0;for(let s=0;s<t.length;s++)t.charAt(s)==="	"?n=u$e(n,e):n++;let o="";if(!r){let s=Math.floor(n/e);n=n%e;for(let a=0;a<s;a++)o+="	"}for(let s=0;s<n;s++)o+=" ";return o}function yY(t,e,r){let n=Ufe(t);return n===-1&&(n=t.length),d$e(t.substring(0,n),e,r)+t.substring(n)}var ms=class t{constructor(e,r,n,o="",s=`
`){this.firstLineIndex=e;this.endLineIndex=r;this.lines=n;this.prefix=o;this.suffix=s}toTextEdit(){let e=this.lines.length>0?this.prefix+this.lines.join(`
`)+this.suffix:"";return Nn.replace(new Be(this.firstLineIndex,0,this.endLineIndex,0),e)}apply(e){let r=e.slice(0,this.firstLineIndex),n=e.slice(this.endLineIndex);return r.concat(this.lines,n)}static insert(e,r){return new t(e,e,r)}static replace(e,r,n,o=!1){return o?new t(e,r,n,"",""):new t(e,r,n)}},Rv;(r=>{function t(n){return n.length===0?[]:n.split(/\r\n|\r|\n/g)}r.fromString=t;function e(n){if(n.lineCount===0)return[];let o=[];for(let s=0;s<n.lineCount;s++)o.push(n.lineAt(s).text);return o}r.fromDocument=e})(Rv||={});function vY(t){return Array.isArray(t)&&typeof t[0]=="string"}var B2=class t{constructor(e,r){this.text=e;this.languageId=r}static fromDocumentContext(e){return new t(e.document.getText(),e.language.languageId)}};function _Y(t,e,r,n,o,s){let a=Rv.fromString(r);if(a.length===e.range.lines.length&&e.range.lines.every((p,f)=>p===a[f]))return[];let c=[],l=!1;for(let p of a){let f=D5(e,p);f===null?c.push(p):(f.type==="fakestart"||f.type==="fakend")&&(l=!0)}let u;if(n===4)u=new ms(e.range.lastLineIndex,e.range.lastLineIndex,a);else{let p=m$e(e,a,o),f=x$e(t,e,c,o);if(!p)u=f;else if(!f)u=p;else{let m=Dve(p);Dve(f)<m?u=f:u=p}u||(u=f$e(t,e,n,o,l,c))}s&&(u=p$e(s,u,o));let d=[u];return s&&(d=h$e(s,d)),d.map(p=>p.toTextEdit())}function p$e(t,e,r){let n=t.text.split(/\r\n|\r|\n/g),o=n.slice(0,e.firstLineIndex),s=n.slice(e.endLineIndex),a=e.lines.slice(0),[,c]=Lve(o,a);c>0&&a.splice(0,c),c>0&&(a=FI(a,{whichLine:"bottomMost",lines:o.slice(o.length-c)},r).slice(0));let[l]=Lve(a,s);return l>0&&a.splice(a.length-l,l),new ms(e.firstLineIndex,e.endLineIndex,a)}function f$e(t,e,r,n,o,s){return o?(t.public.trace("(case 6) Appending to selected code"),Ove(e.range,s,n)):r===3?(t.public.trace("(case 7) Appending to selected code"),Ove(e.range,s,n)):r===1?(t.public.trace("(case 8) Prepending to selected code"),T$e(e.range,FI(s,e.range.lines.filter(a=>a.trim()!=="").length>0?{whichLine:"topMost",lines:e.range.lines}:{whichLine:"bottomMost",lines:e.above.lines},n))):(t.public.trace("(Default) Replacing selected code"),Np(e.range,s,n))}function Dve(t){let e=t.endLineIndex-t.firstLineIndex,r=t.lines.length;return e+r}function m$e(t,e,r){let n=null,o=[];for(let s of e){let a=D5(t,s);if(a===null){o.push(s);continue}if(n){if(a.type==="end"&&a.endMarker===n)return Np(n,o,r);if(a.type==="end"&&n===t.above&&a.endMarker===t.range){let c=t.range.clone();return c.mergeFromAbove(t.above.clone()),Np(c,o,r)}if(a.type==="end"&&n===t.above&&a.endMarker===t.below){let c=t.range.clone();return c.mergeFromAbove(t.above.clone()),c.mergeFromBelow(t.below.clone()),Np(c,o,r)}}else a.type==="start"&&(n=a.startMarker,o=[])}if(o.length>0&&n)return Np(n,o,r)}function h$e(t,e){let r=[],n=t.text.split(/\r\n|\r|\n/g),o=g$e(n,c=>kv(c,t.languageId)),s=[];for(let c of e){if(c.endLineIndex<=o+1)return e;let l=!1,u=[],d=c.lines;for(let p of d)kv(p,t.languageId)?(s.push(q2(p)),l=!0):l&&p.length===0||(u.push(p),l=!1);if(!l&&u.length>0){if(c.firstLineIndex<o+1)return e;r.push(new ms(c.firstLineIndex,c.endLineIndex,u))}}if(s.length===0)return e;let a=o+1;return r.unshift(new ms(a,a,s)),r}function g$e(t,e){for(let r=t.length-1;r>=0;r--)if(e(t[r]))return r;return-1}function q2(t){return t.replace(/^\s+/g,"")}function kv(t,e){switch(e){case"java":return!!t.match(/^\s*import\s/);case"typescript":case"javascript":return!!t.match(/^\s*import[\s{*]|^\s*[var|const|let].*=\s*require\(/);case"php":return!!t.match(/^\s*use/);case"rust":return!!t.match(/^\s*use\s+[\w:{}, ]+\s*(as\s+\w+)?;/);case"python":return!!t.match(/^\s*from\s+[\w.]+\s+import\s+[\w, *]+$/)||!!t.match(/^\s*import\s+[\w, ]+$/);default:return!1}}var v$e=/^(\t+)/,bY=new Map;function y$e(t){return bY.has(t)||bY.set(t,new RegExp(`^(( {${t}})+)`)),bY.get(t)}function xY(t,e,r){let n=e?y$e(r):v$e,o=t.match(n);return o?[o[0],o[0].length/(e?r:1)]:["",0]}function b$e(t){let{insertSpaces:e,tabSize:r}=$m(t,4,!1),n=Number.MAX_VALUE;for(let o of t){if(/^\s*$/.test(o))continue;let[,s]=xY(o,e,r);n=Math.min(n,s)}return{insertSpaces:e,tabSize:r,minIndentLevel:n}}function Nve(t,e){if(e===0)return"";if(t===" ")switch(e){case 2:return"  ";case 4:return"    ";case 8:return"        ";case 12:return"            "}if(t==="	")switch(e){case 1:return"	";case 2:return"		";case 3:return"			"}return new Array(e).fill(t).join("")}function _$e(t,e){let r=t.lines,n;if(t.whichLine==="topMost")n=r.find(o=>o!=="");else for(let o=r.length-1;o>=0;--o)if(r[o]!==""){n=r[o];break}return n===void 0?0:xY(n,e.insertSpaces,e.tabSize)[1]}function FI(t,e,r){if(r===void 0)return t;let n=_$e(e,r),o=b$e(t),s=r.insertSpaces?Nve(" ",r.tabSize):"	";return t.map(a=>{if(a==="")return"";{let[c,l]=xY(a,o.insertSpaces,o.tabSize),u=a.substring(c.length);return Nve(s,n+(l-o.minIndentLevel))+u}})}function D5(t,e){switch(e){case t.above.startMarker:return{type:"start",startMarker:t.above};case t.above.endMarker:return{type:"end",endMarker:t.above};case t.range.startMarker:return{type:"start",startMarker:t.range};case t.range.endMarker:return{type:"end",endMarker:t.range};case t.below.startMarker:return{type:"start",startMarker:t.below};case t.below.endMarker:return{type:"end",endMarker:t.below}}return e.trimStart().startsWith(vd.begin(t.language))?{type:"fakestart"}:e.trimStart().startsWith(vd.end(t.language))?{type:"fakend"}:null}function x$e(t,e,r,n){let o=(f,m,h)=>{let g=0;for(let x of f)for(let S=x.originalStart;S<x.originalStart+x.originalLength;S++){let I=m.lines[S];g+=I.length}let v=m.getCharCount(),b=h.getCharCount(),_=v-g;return{equalCharCount:_,originalCharCount:v,modifiedCharCount:b,originalCharRatio:v>0?_/v:0,modifiedCharRatio:b>0?_/b:0}},s=f=>{let m=new U2(f.lines),h=new U2(r),v=new P5(m,h).ComputeDiff();return o(v,m,h)},a=e.range.clone();a.mergeFromAbove(e.above.clone()),a.mergeFromBelow(e.below.clone());let c=s(a),l=s(e.range),u={diffToEntireScore:c,diffToRangeScore:l};if(t.internal.debug(`Diff metrics: ${JSON.stringify(u,null,"	")}`),c.originalCharCount>30&&c.originalCharRatio>.7)return t.public.trace("(case 1) Replacing entire code"),Np(a,r,n);if(l.originalCharCount>20&&l.originalCharRatio>.7)return t.public.trace("(case 2) Replacing selected code"),Np(e.range,r,n);let d=Math.min(c.originalCharRatio,c.modifiedCharRatio),p=Math.min(l.originalCharRatio,l.modifiedCharRatio);if(d>.2&&d>p)return t.public.trace("(case 3) Replacing entire code"),Np(a,r,n);if(p>.2)return t.public.trace("(case 4) Replacing selected code"),Np(e.range,r,n);if(!e.range.hasContent)return t.public.trace("(case 5) Replacing empty selected code"),Np(e.range,r,n,{whichLine:"bottomMost",lines:e.above.lines})}function Np(t,e,r,n){let s=FI(e,n??{whichLine:"topMost",lines:t.lines},r).slice(0),a=t.lines.slice(0),c=t.firstLineIndex,l=t.lastLineIndex;if(a.length===1&&a[0]==="")return new ms(l,l,s);let u=S$e(a,s);if(c+=u,a.splice(0,u),s.splice(0,u),a.length===0)return new ms(l+1,l+1,s);let d=I$e(a,s);return l-=d,a.splice(a.length-d,d),s.splice(s.length-d,d),a.length===0?new ms(c,c,s):new ms(c,l+1,s)}function S$e(t,e){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++)if(t[n]!==e[n])return n;return r}function I$e(t,e){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++)if(t[t.length-1-n]!==e[e.length-1-n])return n;return r}function Lve(t,e){let r=t.filter(c=>!/^\s*$/.test(c)),n=e.filter(c=>!/^\s*$/.test(c)),o=C$e(r,n);if(o===0)return[0,0];let s=0;for(let c=0;c<o;c++)for(s++;/^\s*$/.test(t[t.length-s]);)s++;let a=0;for(let c=0;c<o;c++)for(a++;/^\s*$/.test(e[a]);)a++;return[s,a]}function C$e(t,e){for(let r=Math.min(t.length,e.length);r>0;r--){let n=t.length-r,o=!0;for(let s=0;s<r;s++)if(t[n+s]!==e[s]){o=!1;break}if(o)return r}return 0}function T$e(t,e){return new ms(t.firstLineIndex,t.firstLineIndex,e)}function Ove(t,e,r){let n=FI(e,{whichLine:"bottomMost",lines:t.lines},r),o=t.lastLineIndex+1;return new ms(o,o,n)}function UI(t,e){return{headerRequestId:t.headers.get("x-request-id")||"",completionId:e&&e.id?e.id:"",created:e&&e.created?e.created:0,serverExperiments:t.headers.get("X-Copilot-Experiment")||"",deploymentId:t.headers.get("azureml-model-deployment")||""}}function Mve(t){let e=t.headers.get("openai-processing-ms");return e?parseInt(e,10):0}function Fve(t){if(typeof t!="object"||t===null||!("details"in t))return!1;let{details:e}=t;return typeof e=="object"&&e!==null&&"type"in e&&"description"in e&&typeof e.type=="string"&&typeof e.description=="string"}function Uve(t){if(typeof t!="object"||t===null||!("citations"in t))return!1;let{citations:e}=t;return typeof e=="object"&&e!==null&&"url"in e&&"license"in e&&typeof e.url=="string"&&typeof e.license=="string"}function Bve(t){return typeof t=="object"&&!!t&&"title"in t&&"excerpt"in t&&"url"in t}async function*SY(t,e,r){let n="",o=E$e(e);o.reverse();for await(let s of t){n+=s;let a,c=0,l="";for(;(a=n.indexOf(e,c))!==-1;)l+=n.slice(c,a)+r,c=a+e.length;c!==0&&(n=n.slice(c));for(let u of o)if(n.endsWith(u)){let d=n.length-u.length;l+=n.slice(0,d),n=n.slice(d);break}l.length>0&&(yield l)}n.length>0&&(yield n)}function E$e(t){let e=[];for(let r=0;r<=t.length;r++)e.push(t.substring(0,r));return e}var BI;(n=>{function t(){return o=>o}n.identity=t;function e(){return o=>Xn.EMPTY}n.discard=e;function r(...o){return s=>o.reduce((a,c)=>c(a),s)}n.chain=r})(BI||={});function qve(t,e){return(async()=>{for await(let r of t)e(r)})()}var N5=class{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,r){e=m_(e);let n=this.values,o=this.prefixSum,s=r.length;return s===0?!1:(this.values=new Uint32Array(n.length+s),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e),e+s),this.values.set(r,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(o.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,r){return e=m_(e),r=m_(r),this.values[e]===r?!1:(this.values[e]=r,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,r){e=m_(e),r=m_(r);let n=this.values,o=this.prefixSum;if(e>=n.length)return!1;let s=n.length-e;return r>=s&&(r=s),r===0?!1:(this.values=new Uint32Array(n.length-r),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e+r),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(o.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=m_(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let r=this.prefixSumValidIndex[0]+1;r===0&&(this.prefixSum[0]=this.values[0],r++),e>=this.values.length&&(e=this.values.length-1);for(let n=r;n<=e;n++)this.prefixSum[n]=this.prefixSum[n-1]+this.values[n];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let r=0,n=this.values.length-1,o=0,s=0,a=0;for(;r<=n;)if(o=r+(n-r)/2|0,s=this.prefixSum[o],a=s-this.values[o],e<a)n=o-1;else if(e>=s)r=o+1;else break;return new IY(o,e-a)}};var IY=class{constructor(e,r){this.index=e;this.remainder=r;this._prefixSumIndexOfResultBrand=void 0;this.index=e,this.remainder=r}};var Lp=class{constructor(e){this._lines=rd(e),this._eol=e.charAt(this._lines[0].length)==="\r"?`\r
`:`
`;let r=new Uint32Array(this._lines.length);for(let n=0;n<this._lines.length;n++)r[n]=this._lines[n].length+this._eol.length;this._lineStarts=new N5(r)}_getText(){return this._lines.join(this._eol)}applyOffsetEdits(e){let{edits:r}=e;for(let n=r.length-1;n>=0;n--){let o=r[n],s=this.toRange(o.replaceRange);this._acceptDeleteRange(s),this._acceptInsertText(s.start,o.newText)}}_acceptDeleteRange(e){if(e.start.line===e.end.line){if(e.start.character===e.end.character)return;this._setLineText(e.start.line,this._lines[e.start.line].substring(0,e.start.character)+this._lines[e.start.line].substring(e.end.character));return}this._setLineText(e.start.line,this._lines[e.start.line].substring(0,e.start.character)+this._lines[e.end.line].substring(e.end.character)),this._lines.splice(e.start.line+1,e.end.line-e.start.line),this._lineStarts.removeValues(e.start.line+1,e.end.line-e.start.line)}_acceptInsertText(e,r){if(r.length===0)return;let n=rd(r);if(n.length===1){this._setLineText(e.line,this._lines[e.line].substring(0,e.character)+n[0]+this._lines[e.line].substring(e.character));return}n[n.length-1]+=this._lines[e.line].substring(e.character),this._setLineText(e.line,this._lines[e.line].substring(0,e.character)+n[0]);let o=new Uint32Array(n.length-1);for(let s=1;s<n.length;s++)this._lines.splice(e.line+1+s-1,0,n[s]),o[s-1]=n[s].length+this._eol.length;this._lineStarts.insertValues(e.line+1,o)}_setLineText(e,r){this._lines[e]=r,this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}getLineCount(){return this._lines.length}getOffset(e){return e=this.validatePosition(e),this._lineStarts.getPrefixSum(e.line-1)+e.character}getPosition(e){e=Math.floor(e),e=Math.max(0,e);let r=this._lineStarts.getIndexOf(e),n=this._lines[r.index].length;return new xr(r.index,Math.min(r.remainder,n))}toRange(e){return new Be(this.getPosition(e.start),this.getPosition(e.endExclusive))}toOffsetRange(e){return new St(this.getOffset(e.start),this.getOffset(e.end))}toOffsetEdit(e){let r=e.map(n=>new Nn(this.validateRange(n.range),n.newText));return new Or(r.map(n=>new Ii(this.toOffsetRange(n.range),n.newText)))}toTextEdits(e){return e.edits.map(r=>new Nn(this.toRange(r.replaceRange),r.newText))}validatePosition(e){if(!(e instanceof xr))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:r,character:n}=e,o=!1;if(r<0)r=0,n=0,o=!0;else if(r>=this._lines.length)r=this._lines.length-1,n=this._lines[r].length,o=!0;else{let s=this._lines[r].length;n<0?(n=0,o=!0):n>s&&(n=s,o=!0)}return o?new xr(r,n):e}validateRange(e){return new Be(this.validatePosition(e.start),this.validatePosition(e.end))}};function jve(t){let r=t.split(/\r?\n/).map(w$e),n=r.filter(s=>s===1).length,o=r.filter(s=>s===2).length;return n>o}function w$e(t){if(t.length===0)return 0;let e=0,r=0;if(["==","!=","===","!==",">=","<=","&&","||",">>",">>>","<<","<<<","+=","-=","*=","/=","%=","<<=","<<<=",">>=",">>>=","++","--","=>","->","...","??","??="].some(o=>t.includes(o))||t.match(/^\s/)||t.match(/^[;{}()\[\]`~?]/))return 1;t.charAt(0).match(/[A-Z]/)&&(e+=1),t[t.length-1]==="."&&(e+=1),W$(t)||(e+=1);{W$(t.charAt(0))&&!t.charAt(0).match(/[A-Z]/)&&(r+=1),t.match(/^\s/)&&(r+=1);let s=[";","{","}","(",")","[","]","`","~","#","$","%","^","&","*","_","=","+","\\","|","<",">"].map(a=>t.includes(a)?1:0).filter(a=>a).length;r+=s}return e>r?2:r>e?1:0}var jI=class{constructor(e,r,n,o,s=!0,a=V2.noop){this.myDocument=e;this.initialSelection=r;this.adjustedSelection=n;this.editStrategy=o;this.collectImports=s;this.lineFilter=a;this.replyIndentationTracker=null}async processStream(e){let r=Xn.filter(e,this.lineFilter);this.collectImports&&(r=CY(r,this.myDocument,this.adjustedSelection));let n=this.myDocument.firstSentLineIndex;for await(let o of this.findInitialAnchor(r))o instanceof O5?n=this.handleFirstReplyLine(o.anchor,o.line):n=this.handleSubsequentReplyLine(n,o.value);return this.myDocument.didReplaceEdits&&n<=this.adjustedSelection.end.line&&this.myDocument.deleteLines(n,this.adjustedSelection.end.line),new j2(this.myDocument.didNoopEdits,this.myDocument.didEdits,this.myDocument.additionalImports)}handleFirstReplyLine(e,r){if(e){this.replyIndentationTracker=new VI(this.myDocument,e.lineIndex,r);let s=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);return this.myDocument.getLine(e.lineIndex).sentInCodeBlock===2?this.myDocument.replaceLines(this.adjustedSelection.start.line,e.lineIndex,s):this.myDocument.replaceLine(e.lineIndex,s)}let n=this.adjustedSelection.start.line;this.replyIndentationTracker=new VI(this.myDocument,n,r);let o=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);if(this.initialSelection.isEmpty){let s=this.myDocument.getLine(n).content;if(/^\s*$/.test(s)||o.adjustedContent.startsWith(s))return this.myDocument.replaceLine(n,o,!0)}return this.editStrategy===1?this.myDocument.insertLineBefore(n,o):this.editStrategy===3||this.editStrategy===4?this.myDocument.insertLineAfter(n,o):this.myDocument.replaceLine(n,o)}handleSubsequentReplyLine(e,r){let n=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);if(n.trimmedContent!==""||this.myDocument.didReplaceEdits){let s=this.matchReplyLine(n,e);if(s)return this.myDocument.replaceLines(e,s.lineIndex,n)}if(e>=this.myDocument.getLineCount())return this.myDocument.appendLineAtEndOfDocument(n);let o=this.myDocument.getLine(e);return!o.isSent||o.content===""||n.trimmedContent===""?this.myDocument.insertLineBefore(e,n):o.indentLevel<n.adjustedIndentLevel?this.myDocument.insertLineBefore(e,n):o.indentLevel===n.adjustedIndentLevel&&!this.myDocument.didReplaceEdits?this.myDocument.insertLineBefore(e,n):this.myDocument.replaceLine(e,n)}matchReplyLine(e,r){let n=e.trimmedContent.length<=3;for(let o=r;o<this.myDocument.getLineCount();o++){let s=this.myDocument.getLine(o);if(s.isSent){if(s.normalizedContent===e.adjustedContent)return new q5(o);if(s.trimmedContent.length>0&&s.indentLevel<e.adjustedIndentLevel||n&&s.trimmedContent.length>0)return null}}return null}findInitialAnchor(e){return new Xn(async r=>{let n=[],o=0,s=!1;for await(let a of e)if(s)r.emitOne(a);else if(n.push(a),o+=a.value.trim().length,o>10){let c=this.searchForEqualSentLines(n);s=!0,r.emitOne(new O5(n[0].value,c)),r.emitMany(n.slice(1))}})}searchForEqualSentLines(e){let r=e.map(n=>n.value.trim());for(let n=this.myDocument.firstSentLineIndex,o=this.myDocument.getLineCount()-e.length;n<=o;n++){if(!this.myDocument.getLine(n).isSent)continue;let s=!0;for(let a=0;a<r.length;a++){let c=this.myDocument.getLine(n+a);if(!c.isSent||c.trimmedContent!==r[a]){s=!1;break}}if(s)return new q5(n)}return null}},Dv=class{constructor(e,r,n=V2.noop){this._myDocument=e;this._cursorPosition=r;this._lineFilter=n;this.replyIndentationTracker=null}async processStream(e){let r=Xn.filter(e,this._lineFilter);r=CY(r,this._myDocument,new Be(this._cursorPosition,this._cursorPosition));let n=0;for await(let o of r)this.replyIndentationTracker?n=this.handleSubsequentReplyLine(n,o.value):n=this.handleFirstReplyLine(o.value);return new j2(this._myDocument.didNoopEdits,this._myDocument.didEdits,this._myDocument.additionalImports)}handleFirstReplyLine(e){let r=this._cursorPosition.line,n=this._myDocument.getLine(r).content,o=/^\s*$/.test(n)||e.trimStart().startsWith(n.trimStart()),s=o||this._myDocument.getLineCount()<=r+1?r:r+1;this.replyIndentationTracker=new VI(this._myDocument,s,e);let a=this.replyIndentationTracker.reindent(e,this._myDocument.indentStyle);return o?this._myDocument.replaceLine(r,a,!0):this._myDocument.insertLineAfter(r,a)}handleSubsequentReplyLine(e,r){let n=this.replyIndentationTracker.reindent(r,this._myDocument.indentStyle);return this._myDocument.insertLineBefore(e,n)}},L5=class{constructor(e,r,n=V2.noop){this._myDocument=e;this._selection=r;this._lineFilter=n;this.replyIndentationTracker=null}async processStream(e){let r=Xn.filter(e,this._lineFilter);r=CY(r,this._myDocument,this._selection);let n=0,o,s="";this._selection.end.line>this._selection.start.line&&this._selection.end.character===0?o=this._selection.end.line-this._selection.start.line:(o=this._selection.end.line-this._selection.start.line+1,s=this._myDocument.getLine(this._selection.end.line).content.substring(this._selection.end.character));for await(let a of r)if(this.replyIndentationTracker){let c=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);o>0?(n=this._myDocument.replaceLine(n,c),o--):n=this._myDocument.insertLineAfter(n-1,c)}else{let c=this._selection.start.line;this.replyIndentationTracker=new VI(this._myDocument,c,a.value);let l=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);n=this._myDocument.replaceLine(c,l),o--}return this._myDocument.didEdits&&o>0&&this._myDocument.deleteLines(n,n+o-1),this._myDocument.didEdits&&s.length>0&&this._myDocument.replaceLine(n-1,this._myDocument.getLine(n-1).content+s),new j2(this._myDocument.didNoopEdits,this._myDocument.didEdits,this._myDocument.additionalImports)}},j2=class{constructor(e,r,n){this.didNoopEdits=e;this.didEdits=r;this.additionalImports=n}},VI=class{constructor(e,r,n){let o=0;for(let a=r;a>=0;a--){let c=e.getLine(a);if(c.content.length>0){o=c.indentLevel,a!==r&&(c.content.endsWith("{")||e.languageId==="python"&&c.content.endsWith(":"))&&(o+=1);break}}this._replyIndentStyle=qI.guessIndentStyleFromLine(n);let s=A5(n,this._replyIndentStyle?.tabSize??4);this.indentDelta=s-o}reindent(e,r){if(e==="")return new B5("",0,"",0);this._replyIndentStyle||(this._replyIndentStyle=qI.guessIndentStyleFromLine(e));let n=0,o=0,s=c=>(n=c,o=Math.max(n-this.indentDelta,0),o),a=qI.reindentLine(e,this._replyIndentStyle??{insertSpaces:!0,tabSize:4},r,s);return new B5(e,n,a,o)}},O5=class{constructor(e,r){this.line=e;this.anchor=r}},M5=class{constructor(e,r){this.lineIndex=e;this.sentInCodeBlock=r}},F5=class{constructor(e,r){this.startLineIndex=e;this.endLineIndex=r}},U5=class{constructor(e,r,n,o,s,a,c){this.outputStream=e;this.uri=r;this.languageId=a;this._originalLines=[];this.lines=[];this._didNoopEdits=!1;this._didEdits=!1;this._didReplaceEdits=!1;this._additionalImports=[];this.indentStyle=qI.getDocumentIndentStyle(n,c),this._originalLines=n.split(/\r\n|\r|\n/g);for(let l=0;l<this._originalLines.length;l++)this.lines[l]=new Pv(this._originalLines[l],this.indentStyle);this.firstSentLineIndex=Number.MAX_SAFE_INTEGER;for(let l of o)this.lines[l.lineIndex].markSent(l.sentInCodeBlock),this.firstSentLineIndex=Math.min(this.firstSentLineIndex,l.lineIndex);this.firstSentLineIndex=Math.min(this.firstSentLineIndex,s.startLineIndex)}get didNoopEdits(){return this._didNoopEdits}get didEdits(){return this._didEdits}get didReplaceEdits(){return this._didReplaceEdits}get additionalImports(){return this._additionalImports}getText(){return this.lines.map(e=>e.content).join(`
`)}getLineCount(){return this.lines.length}getLine(e){if(e<0||e>=this.lines.length)throw new Error("Invalid index");return this.lines[e]}addAdditionalImport(e){this._additionalImports.push(e)}replaceLine(e,r,n=!1){let o=typeof r=="string"?r:r.adjustedContent;return this.lines[e].content===o?(this._didNoopEdits=!0,e+1):(this.lines[e]=new Pv(o,this.indentStyle),this.outputStream.textEdit(this.uri,[new Nn(new Be(e,0,e,1073741824),o)]),this._didEdits=!0,this._didReplaceEdits=this._didReplaceEdits||!n,e+1)}replaceLines(e,r,n){if(e>r)throw new Error("Invalid range");return e===r?this.replaceLine(e,n):(this.lines.splice(e,r-e+1,new Pv(n.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new Nn(new Be(e,0,r,1073741824),n.adjustedContent)]),this._didEdits=!0,this._didReplaceEdits=!0,e+1)}appendLineAtEndOfDocument(e){return this.lines.push(new Pv(e.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new Nn(new Be(this.lines.length-1,1073741824,this.lines.length-1,1073741824),`
`+e.adjustedContent)]),this._didEdits=!0,this.lines.length}insertLineAfter(e,r){return this.lines.splice(e+1,0,new Pv(r.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new Nn(new Be(e,1073741824,e,1073741824),`
`+r.adjustedContent)]),this._didEdits=!0,e+2}insertLineBefore(e,r){return e===this.lines.length?this.insertLineAfter(e-1,r):(this.lines.splice(e,0,new Pv(r.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new Nn(new Be(e,0,e,0),r.adjustedContent+`
`)]),this._didEdits=!0,e+1)}deleteLines(e,r){return this.lines.splice(e,r-e+1),this.outputStream.textEdit(this.uri,[new Nn(new Be(e,0,r+1,0),"")]),this._didEdits=!0,this._didReplaceEdits=!0,e+1}},B5=class{constructor(e,r,n,o){this.originalContent=e;this.originalIndentLevel=r;this.adjustedContent=n;this.adjustedIndentLevel=o;this.trimmedContent=this.originalContent.trim()}},q5=class{constructor(e){this.lineIndex=e}};var Pv=class{constructor(e,r){this.content=e;this._indentStyle=r;this._sentInCodeBlock=0;this._trimmedContent=null;this._normalizedContent=null;this._indentLevel=-1}get isSent(){return this._sentInCodeBlock!==0}get sentInCodeBlock(){return this._sentInCodeBlock}get trimmedContent(){return this._trimmedContent===null&&(this._trimmedContent=this.content.trim()),this._trimmedContent}get normalizedContent(){return this._normalizedContent===null&&(this._normalizedContent=yY(this.content,this._indentStyle.tabSize,this._indentStyle.insertSpaces)),this._normalizedContent}get indentLevel(){return this._indentLevel===-1&&(this._indentLevel=A5(this.content,this._indentStyle.tabSize)),this._indentLevel}markSent(e){this._sentInCodeBlock=e}},qI=class t{static getDocumentIndentStyle(e,r){return r||$m(Rv.fromString(e),4,!1)}static guessIndentStyleFromLine(e){let r=t._getLeadingWhitespace(e);if(!(r===""||r===" "))return $m([e],4,!1)}static reindentLine(e,r,n,o=s=>s){let s=A5(e,r.tabSize),a=o(s);for(;s>0;)e=this._outdent(e,r),s--;for(;s<a;)e="	"+e,s++;return yY(e,n.tabSize,n.insertSpaces)}static _outdent(e,r){let n=0;for(;n<e.length;){let o=e.charCodeAt(n);if(o===9){n++;break}if(o!==32||n===r.tabSize)break;n++}return e.substring(n)}static _getLeadingWhitespace(e){for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n!==32&&n!==9)return e.substring(0,r)}return e}},V2=class{static combine(...e){return r=>e.every(n=>n?n(r):!0)}static{this.noop=()=>!0}static createCodeBlockFilter(){let e;(a=>(a[a.BeforeCodeBlock=0]="BeforeCodeBlock",a[a.InCodeBlock=1]="InCodeBlock",a[a.AfterCodeBlock=2]="AfterCodeBlock"))(e||={});let r=0;return n=>r===0?(/^```/.test(n.value)&&(r=1),!1):r===1?/^```/.test(n.value)?(r=2,!1):!0:!1}},j5=class{constructor(e){this.value=e;this.__lineOfTextBrand=void 0}};var Av=class{constructor(e,r){this.value=e;this.kind=r}},ji=class t{static createCodeBlockClassifier(){return t.attemptToRecoverFromMissingCodeBlock(t.createFencedBlockClassifier("```"))}static attemptToRecoverFromMissingCodeBlock(e){return r=>new Xn(async n=>{let o=[],s=!0;for await(let a of e(r))if(!s)n.emitOne(a);else if(a.kind===0)o.push(a);else{s=!1;for(let c of o)n.emitOne(c);o.length=0,n.emitOne(a)}if(s){let a=o.map(c=>c.value).join("");jve(a)?n.emitOne(new Av(a,1)):n.emitOne(new Av(a,0))}})}static createAlwaysInsideCodeBlockClassifier(){return e=>Xn.map(e,r=>new Av(r,1))}static createFencedBlockClassifier(e){return r=>new Xn(async n=>{let o=new Wm(r[Symbol.asyncIterator]()),s=0;for(;!o.endOfStream;)if(await o.peek(e.length)!==e)for(;!o.endOfStream;){let c=o.readImmediateExcept(`
`);if(c.length>0&&n.emitOne(new Av(c,s)),await o.peek(1)===`
`){o.readImmediate(1),n.emitOne(new Av(`
`,s));break}}else{let c=await o.readLineIncludingLF();s=s===1?0:1,n.emitOne(new Av(c,2))}})}},Wm=class{constructor(e){this._source=e;this._buffer="";this._atEnd=!1}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:r}=await this._source.next();r?this._atEnd=!0:this._buffer+=e}async waitForLength(e){for(;this._buffer.length<e&&!this._atEnd;)await this.extendBuffer()}async peek(e){return await this.waitForLength(e),this._buffer.substring(0,e)}async read(e){await this.waitForLength(e);let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}async readUntil(e){let r="";for(;!this.endOfStream;){let n=this.readImmediateExcept(e);if(r+=n,await this.peek(1)===e)break}return r}async readLineIncludingLF(){let e=await this.readUntil(`
`);return e+=await this.read(1),e}async readLine(){let e=await this.readUntil(`
`);return await this.read(1),e}readImmediateExcept(e){let r=this._buffer.indexOf(e);return this.readImmediate(r===-1?this._buffer.length:r)}readImmediate(e){let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}},V5=class{},H5=class t{constructor(e){this._source=e;this._buffer=[];this._atEnd=!1}static{this.EOS=new V5}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:r}=await this._source.next();r?this._atEnd=!0:this._buffer.push(e)}async peek(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?t.EOS:this._buffer[0]}async read(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?t.EOS:this._buffer.shift()}async readWhile(e,r){do{let n=await this.peek();if(n instanceof V5||!e(n))break;await this.read(),await r(n)}while(!0)}async consumeToEnd(){for(;!this.endOfStream;)await this.read()}};function Vve(t){return new Xn(async e=>{let r="";for await(let n of t){r+=n;do{let o=r.indexOf(`
`);if(o===-1)break;let s=r.substring(0,o);r=r.substring(o+1),e.emitOne(new j5(s))}while(!0)}r.length>0&&e.emitOne(new j5(r))})}function k$e(t,e){let r=e.start.character===0?e.start.line:e.start.line+1,n=t.getLine(e.end.line).content.length===e.end.character?e.end.line:e.end.line-1;for(let o=r;o<=n;o++)if(kv(t.getLine(o).content,t.languageId))return!0;return!1}function CY(t,e,r){if(k$e(e,r))return t;let n=!1,o=!1;return t.filter(s=>kv(s.value,e.languageId)?(e.addAdditionalImport(q2(s.value)),n=!0,!1):s.value.trim().length===0&&n?o:(o=!0,!0))}var G5=class{constructor(e,r,n,o,s,a,c,l,u){this.sessionId=e;this.conversation=r;this.previousConversation=n;this.request=o;this.stream=s;this.token=a;this.documentContext=c;this.agentName=l;this.chatTelemetry=u;this.turn=r.getLatestTurn(),this.location=this.request.location2 instanceof v2?1:2,this.uiKind=this.location===1?"conversationInline":"conversationPanel"}checkCancellation(){return this.token.isCancellationRequested?(this.turn.status="cancelled",!0):!1}},H2=class extends Error{constructor(e){super(typeof e=="string"?e:e.message),this.errorDetails=typeof e=="string"?{message:e}:e}};var z5=class{};var Ms=class extends ql{constructor(r){super();this.replyInterpreter=r}},HI=class extends ql{constructor(r){super();this.followUps=r}},$5=class{async processResponse(e,r,n,o){for await(let s of r)n.markdown(s.delta.text)}};function Gve(t,e){let r=new Lp(t),n=e.map(o=>{let s=r.toOffsetRange(o.range);return{startOffset:s.start,endOffset:s.endExclusive,text:o.newText}});TY(n,(o,s)=>o.startOffset-s.startOffset||o.endOffset-s.endOffset);for(let o=n.length-1;o>=0;o--){let s=n[o];t=t.substring(0,s.startOffset)+s.text+t.substring(s.endOffset)}return t}function TY(t,e){if(t.length<=1)return t;let r=t.length/2|0,n=t.slice(0,r),o=t.slice(r);TY(n,e),TY(o,e);let s=0,a=0,c=0;for(;s<n.length&&a<o.length;)e(n[s],o[a])<=0?t[c++]=n[s++]:t[c++]=o[a++];for(;s<n.length;)t[c++]=n[s++];for(;a<o.length;)t[c++]=o[a++];return t}var hs={Mute:BI.discard(),Emit:BI.identity()};var W5=class{constructor(e,r,n,o,s){this._outputStream=e;this._leadingMarkdownStreamPipe=r;this._earlyStopping=n;this._responseStream=new Zg;this._lastLength=0;this._leftFirstCodeBlock=!1;let a=o(this._responseStream.asyncIterable);this._streamingPromise=this._process(a,s)}async _process(e,r){let n=new Zg,o=this._leadingMarkdownStreamPipe(n.asyncIterable);qve(o,d=>this._outputStream.markdown(d));let s=new Zg,a=Vve(s.asyncIterable),c=r.processStream(a),l=e.filter(d=>d.kind!==2),u=new H5(l[Symbol.asyncIterator]());return await u.readWhile(d=>d.kind===0,d=>n.emitOne(d.value)),n.resolve(),await u.readWhile(d=>d.kind===1,d=>s.emitOne(d.value)),this._leftFirstCodeBlock=!0,await u.consumeToEnd(),s.resolve(),c}update(e){if(this._earlyStopping===1&&this._leftFirstCodeBlock)return{shouldFinish:!0};let r=e.slice(this._lastLength);return this._lastLength=e.length,this._responseStream.emitOne(r),{shouldFinish:!1}}async finish(){return this._responseStream.resolve(),await this._streamingPromise}};var K5=class{constructor(e,r){this.kind=e;this.annotations=r}};function Y5(t,e,r){let n=e.getText(),o=G2.convertToLinkedTree(n,Wve(t,n)),s=e.offsetAt(r.start),a=e.offsetAt(r.end);return{adjusted:A$e(o,s,a),original:new St(s,a)}}function Wve(t,e){let r=R$e(t.startIndex,e),n=Math.max(r,P$e(t.endIndex,e)),o=t.children.map(s=>Wve(s,e));return r===t.startIndex&&n===t.endIndex&&Am(o,t.children)?t:new Rp(r,n,t.kind,o)}function R$e(t,e){for(;t<e.length;){let r=e.charCodeAt(t);if(r!==32&&r!==9&&r!==10&&r!==13)return t;t++}return t}function P$e(t,e){for(;t>0;){let r=e.charCodeAt(t-1);if(r!==32&&r!==9&&r!==10&&r!==13)return t;t--}return t}function A$e(t,e,r){return[e,r]=D$e(t,e,r),N$e(t,e,r)}function D$e(t,e,r){let n=t.text.substring(e,r);if(!/^\s*$/.test(n))return[e,r];let s=e,a=r,c=!0,l=!0;do{if(l&&a>=t.text.length&&(l=!1),l){let u=t.text.charCodeAt(a);if(u===13||u===10)l=!1;else{if(u!==32&&u!==9)return[a,a+1];a++}}if(c&&s===0&&(c=!1),c){let u=t.text.charCodeAt(s-1);if(u===13||u===10)c=!1;else{if(u!==32&&u!==9)return[s-1,s];s--}}}while(c||l);return[e,r]}function N$e(t,e,r){e>0&&e<r&&t.text.charCodeAt(e-1)!==10&&t.text.charCodeAt(e)===10&&e++,e=zve(t,e),r=$ve(t,r);let n=t.findLeaf2(e),o=t.findLeaf2(r),s=!1,a=l=>{l<e&&(e=zve(t,l),s=!0,n=t.findLeaf2(e))},c=l=>{l>r&&(r=$ve(t,l),s=!0,o=t.findLeaf2(r))};do{if(s=!1,n instanceof z2){let l=n.isFirstGapInParent?n.parent.lastGap:null,u=n.hasSelectedContent(e,r),d=l&&l.hasSelectedContent(e,r),p=u||d;p&&a(n.firstNonWhitespaceIndex),p&&l&&c(l.lastNonWhitespaceIndex+1)}if(o instanceof z2){let l=o.isLastGapInParent?o.parent.firstGap:null,u=o.hasSelectedContent(e,r),d=l&&l.hasSelectedContent(e,r),p=u||d;p&&o.lastNonWhitespaceIndex+1>r&&c(o.lastNonWhitespaceIndex+1),p&&l&&a(l.firstNonWhitespaceIndex)}n instanceof G2&&t.hasContentInRange(new St(e,r))&&n.startIndex<e&&a(n.startIndex),o instanceof G2&&t.hasContentInRange(new St(e,r))&&o.endIndex>r&&c(o.endIndex)}while(s);return new St(e,r)}function zve(t,e){for(;e>0;){let r=t.text.charCodeAt(e-1);if(r!==32&&r!==9)break;e--}return e}function $ve(t,e){if((e>0?t.text.charCodeAt(e-1):0)===10)return e;for(;e<t.text.length;){let n=t.text.charCodeAt(e);if(n!==32&&n!==9)break;e++}return e}function Kve(t){return t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")}var G2=class t{constructor(e,r,n,o,s,a,c){this._originalText=e;this.parent=r;this.startIndex=n;this.endIndex=o;this.kind=s;this.children=a;this.myIndex=c}static convertToLinkedTree(e,r){let n=new t(e,null,r.startIndex,r.endIndex,r.kind,[],0);return t._convertChildrenToLinkedTree(e,r,n),n}static _convertChildrenToLinkedTree(e,r,n){for(let o=0;o<r.children.length;o++){let s=r.children[o],a=new t(e,n,s.startIndex,s.endIndex,s.kind,[],o);n.children.push(a),t._convertChildrenToLinkedTree(e,s,a)}}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}textAt(e){return e.substring(this._originalText)}hasContentInRange(e){let r=this.textAt(e);return!/^\s*$/s.test(r)}toString(){return`Node (${this.startIndex}-${this.endIndex}) ${Kve(this._originalText.substring(this.startIndex,this.endIndex))}`}gapBeforeChild(e){let r=e===0?this.startIndex:this.children[e-1].endIndex,n=e===this.children.length?this.endIndex:this.children[e].startIndex;return new z2(this._originalText,this,r,n,e)}childAt(e){return this.children[e]??null}get firstGap(){return this.children.length===0?null:this.gapBeforeChild(0)}get lastGap(){return this.children.length===0?null:this.gapBeforeChild(this.children.length)}findLeaf(e){if(this.children.length===0)return[this,0];let r=nfe(this.children.length,n=>{let o=this.children[n];return e>=o.startIndex&&e<=o.endIndex?0:e<o.startIndex?1:-1});return r<0?[this,r]:this.children[r].findLeaf(e)}findLeaf2(e){let[r,n]=this.findLeaf(e);return n<0?r.gapBeforeChild(~n):r}get nextLeaf(){let e=this;do{let r=e.nextSibling;if(r)return r.leftMostLeafChild;e=e.parent}while(e);return null}get leftMostLeafChild(){let e=this;for(;e.children.length>0;)e=e.children[0];return e}get prevSibling(){let e=this.parent,r=this.myIndex-1;return e&&r>=0?e.children[r]:null}get nextSibling(){let e=this.parent,r=this.myIndex+1;return e&&r<e.children.length?e.children[r]:null}},z2=class{constructor(e,r,n,o,s){this._originalText=e;this.parent=r;this.startIndex=n;this.endIndex=o;this.gapIndex=s;if(this.startIndex>this.endIndex)throw new yr("Invalid gap")}get range(){return new St(this.startIndex,this.endIndex)}get isFirstGapInParent(){return this.gapIndex===0}get isLastGapInParent(){return this.gapIndex===this.parent.children.length}toString(){return`NodeGap (${this.startIndex}-${this.endIndex}) ${Kve(this._originalText.substring(this.startIndex,this.endIndex))}`}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}hasSelectedContent(e,r){let n=this.range.intersect(new St(e,r)),o=n?this._originalText.substring(n.start,n.endExclusive):"";return!/^\s*$/s.test(o)}get firstNonWhitespaceIndex(){let e=this.startIndex;for(;e<this.endIndex;){let r=this._originalText.charCodeAt(e);if(r!==9&&r!==32&&r!==10)return e;e++}return this.endIndex}get lastNonWhitespaceIndex(){let e=this.endIndex-1;for(;e>=this.startIndex;){let r=this._originalText.charCodeAt(e);if(r!==9&&r!==32&&r!==10)return e;e--}return this.startIndex-1}get nextLeaf(){let e=this.parent.childAt(this.gapIndex);return e?e.leftMostLeafChild:this.parent.nextLeaf}};var Km=class t{constructor(e,r){this.lineCount=e;this.columnCount=r}static{this.zero=new t(0,0)}static lengthDiffNonNegative(e,r){return r.isLessThan(e)?t.zero:e.lineCount===r.lineCount?new t(0,r.columnCount-e.columnCount):new t(r.lineCount-e.lineCount,r.columnCount)}static betweenPositions(e,r){return e.lineNumber===r.lineNumber?new t(0,r.column-e.column):new t(r.lineNumber-e.lineNumber,r.column-1)}static ofRange(e){return t.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let r=0,n=0;for(let o of e)o===`
`?(r++,n=0):n++;return new t(r,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new t(this.lineCount,this.columnCount+e.columnCount):new t(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new je(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new je(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new je(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new Ut(e.lineNumber,e.column+this.columnCount):new Ut(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};var $2=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let r=0;r<e.length;r++)e.charAt(r)===`
`&&this.lineStartOffsetByLineIdx.push(r+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new St(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let r=td(this.lineStartOffsetByLineIdx,s=>s<=e),n=r+1,o=e-this.lineStartOffsetByLineIdx[r]+1;return new Ut(n,o)}getRange(e){return je.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Km.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Km(e,this.text.length-this.lineStartOffsetByLineIdx[e])}};var Q5=class{rangeToOffsetRange(e){return new St(this.getOffsetAtPosition(e.start),this.getOffsetAtPosition(e.end))}offsetRangeToRange(e){return new Be(this.getPositionAtOffset(e.start),this.getPositionAtOffset(e.endExclusive))}},X5=class extends Q5{constructor(r){super();this.document=r;this.uri=this.document.uri;this.languageId=this.document.languageId}getText(){return this.document.getText()}getTextInOffsetRange(r){return r.substring(this.document.getText())}getPositionAtOffset(r){return this.document.positionAt(r)}getOffsetAtPosition(r){return this.document.offsetAt(r)}},W2=class extends Q5{constructor(r){super();this.value=r;this._transformer=new $2(this.value)}getText(){return this.value}getTextInOffsetRange(r){return r.substring(this.value)}getPositionAtOffset(r){return L$e(this._transformer.getPosition(r))}getOffsetAtPosition(r){return this._transformer.getOffset(O$e(r))}};function L$e(t){return new xr(t.lineNumber-1,t.column-1)}function O$e(t){return new Ut(t.line+1,t.character+1)}function EY(t,e){let r=e(t);return{...r,range:[r.range.start,r.range.endExclusive],children:r.children?.map(n=>EY(n,e))}}function Yve(t,e){let r=B1(e,a=>a.endExclusive>=t.start),n=td(e,a=>a.start<=t.endExclusive)+1;if(r===n)return[t];let o=[],s=t.start;for(let a=r;a<n;a++){let c=e[a];c.start>s&&o.push(new St(s,c.start)),s=c.endExclusive}return s<t.endExclusive&&o.push(new St(s,t.endExclusive)),o}var zI=class{constructor(e,r){this.originalText=e;this.edits=r;this._positionOffsetTransformer=new qn(()=>new Lp(this.text));this._originalPositionOffsetTransformer=new qn(()=>new Lp(this.originalText));this._text=new qn(()=>this.edits.apply(this.originalText))}get positionOffsetTransformer(){return this._positionOffsetTransformer.value}get originalPositionOffsetTransformer(){return this._originalPositionOffsetTransformer.value}get text(){return this._text.value}get lineCount(){return this.positionOffsetTransformer.getLineCount()}get isOriginal(){return this.edits.isEmpty||this.edits.isNoop(this.originalText)}project(e){return this.edits.applyToOffset(e)}projectOffsetRange(e){return this.edits.applyToOffsetRange(e)}projectRange(e){let r=this.originalPositionOffsetTransformer.toOffsetRange(e),n=this.projectOffsetRange(r);return this.positionOffsetTransformer.toRange(n)}projectOffsetEdit(e){return e.tryRebase(this.edits)}projectBack(e){return this.edits.applyInverseToOffset(e)}projectBackOffsetEdit(e){return e.tryRebase(this.edits.inverse(this.originalText))}projectBackTextEdit(e){let r=this.positionOffsetTransformer.toOffsetEdit(e),n=this.projectBackOffsetEdit(r);return this.originalPositionOffsetTransformer.toTextEdits(n)}};var J5=class{constructor(e,r,n,o,s){this.parent=e;this.overlayNode=r;this.range=n;this.children=o;this._document=s}get kind(){return this.overlayNode.kind}get text(){return this._document.getTextInOffsetRange(this.range)}},K2=class extends zI{constructor(r,n){super(r.getText(),n);this.baseDocument=r}getLanguageId(){return this.baseDocument.languageId}};function e6(t,e,r){let n=[],o=[],s=[];for(let c=0;c<r.length;c++){let{document:l,overlayNodeRoot:u,selection:d}=r[c],p=l.getText(),f=d?l.rangeToOffsetRange(d):void 0,m=Qve(u,l),h=wY.fromNode(m,p),g=kY.fromNode(h,!!e.tryPreserveTypeChecking);f&&g.visitAll(k=>k.node.range.intersectsOrTouches(f)?(k.node.children.length===0&&k.markAsSurviving(),!0):!1),n.push(g),o.push(g.getTextFragment());let v=k=>f?k.range.endExclusive<f.start?f.start-k.range.endExclusive:k.range.start>f.endExclusive?3*(k.range.start-f.endExclusive):0:0,b=new f_(k=>f?k.children.length===0?k.range.intersectsOrTouches(f)?0:Number.MAX_SAFE_INTEGER:Math.min(...k.children.map(M=>b.get(M)))+1:0),_=new f_(k=>{let M=k.parent?_.get(k.parent):Number.MAX_SAFE_INTEGER,H=b.get(k);return Math.min(M,H)}),x=!!e.tryPreserveTypeChecking,S=k=>x&&k.node?.kind==="import_statement"?0:100*_.get(k)+k.depth+10*(v(k)/p.length),I=typeof e.costFnOverride=="object"?e.costFnOverride.createCostFn(l):e.costFnOverride;if(I!==void 0){let k=S;S=M=>{let H=k(M);return H===!1?!1:M.node?I(M.node,H,l):H}}let w=g.getDescendantsAndSelf();for(let k of w){if(!k.node.node)continue;let M=S(k.node);M!==!1&&s.push({idx:c,node:k,cost:M})}}s.sort(q1(c=>c.cost,j1));for(let{node:c,idx:l}of s){if(c.markAsSurviving(),n.reduce((d,p)=>d+p.getTextFragment().length,0)>t)break;o[l]=n[l].getTextFragment()}let a=[];for(let c=0;c<o.length;c++){let l=o[c],{document:u}=r[c],d=new K2(u,l.toTextEditFromOriginal(u.getText().length)),p=d,f=n[c];p.getVisualization=()=>({$fileExtension:"ast.w",source:{value:d.originalText,decorations:Yve(St.ofLength(d.originalText.length),d.edits.edits.map(m=>m.replaceRange)).map(m=>({range:[m.start,m.endExclusive],color:"lime"}))},root:EY(f,m=>({label:(m.node.node?.kind||"unknown")+` (${s.find(h=>h.node===m)?.cost})`,range:m.node.range,children:m.childNodes,isMarked:m._surviving}))}),a.push(d)}return a}function Qve(t,e,r=void 0){let n=new St(t.startIndex,t.endIndex),o=[],s=new J5(r,t,n,o,e);for(let a of t.children)o.push(Qve(a,e,s));return s}var wY=class t{constructor(e,r,n,o,s,a){this.node=e;this.range=r;this.children=n;this.depth=o;this.parent=s;this.document=a}static fromNode(e,r,n=0,o=null){let s=[],a=new t(e,e.range,s,n,o,r);if(e.children.length>0){let c=e.range.start;for(let u of e.children){let d=new St(c,u.range.start);d.isEmpty||s.push(new t(void 0,d,[],n,a,r)),s.push(t.fromNode(u,r,n+1,a)),c=u.range.endExclusive}let l=new St(c,e.range.endExclusive);l.isEmpty||s.push(new t(void 0,l,[],n,a,r))}return a}},kY=class t{constructor(e,r,n,o){this.node=e;this.parent=r;this.childNodes=n;this._tryPreserveTypeChecking=o;this._surviving=!1;this._textFragment=null}static fromNode(e,r){return t.fromNodeParent(e,null,r)}static fromNodeParent(e,r,n){let o=[],s=new t(e,r,o,n);for(let a of e.children){let c=t.fromNodeParent(a,s,n);o.push(c)}return s}visitAll(e){if(e(this))for(let r of this.childNodes)r.visitAll(e)}markAsSurviving(){this._surviving||(this._surviving=!0,this.parent&&this.parent.markAsSurviving(),this.invalidate())}invalidate(){this._textFragment&&(this._textFragment=null,this.parent&&this.parent.invalidate())}getTextFragment(){return this._textFragment||(this._textFragment=this._computeSummarization()),this._textFragment}_computeSummarization(){if(this.childNodes.length===0&&(this._surviving||!this.node.node))return new Nv(this.node.range,this.node.document);if(!this._surviving)return new $I("");let e=[];for(let r of this.childNodes){let n=r.getTextFragment();if(n.length===0){e.length>0&&e[e.length-1].length===0||e.push(n);continue}M$e(e,n)}for(let r=0;r<=e.length-3;r++){let n=e[r],o=e[r+1],s=e[r+2];if(o.length===0&&n instanceof Nv&&s instanceof Nv){let a=n.trimEnd(),c=s.trimStart();a.endsWith("{")&&c.startsWith("}")&&(e[r]=a,e[r+1]=new $I(this._tryPreserveTypeChecking?"/* ... */":"\u2026"),e[r+2]=c)}}return Z5.from(e)}getDescendantsAndSelf(){let e=[];return this._getDescendantsAndSelf(e),e}_getDescendantsAndSelf(e){e.push(this);for(let r of this.childNodes)r._getDescendantsAndSelf(e)}},Y2=class{toTextEditFromOriginal(e){let r=[],n=0,o="";function s(c){(n!==c||o.length>0)&&(r.push(new Ii(new St(n,c),o)),o="")}function a(c){if(c instanceof Z5)for(let l of c.fragments)a(l);else c instanceof $I?o+=c.text:c instanceof Nv&&(s(c.range.start),n=c.range.endExclusive)}return a(this),s(e),new Or(r)}},$I=class extends Y2{constructor(r){super();this.text=r}get length(){return this.text.length}},Nv=class t extends Y2{constructor(r,n){super();this.range=r;this.originalText=n}get length(){return this.range.length}get text(){return this.range.substring(this.originalText)}trimStart(){let r=this.text.trimStart();return r.length===this.length?this:new t(new St(this.range.endExclusive-r.length,this.range.endExclusive),this.originalText)}trimEnd(){let r=this.text.trimEnd();return r.length===this.length?this:new t(new St(this.range.start,this.range.start+r.length),this.originalText)}startsWith(r){return this.text.startsWith(r)}endsWith(r){return this.text.endsWith(r)}tryJoin(r){return this.range.endExclusive===r.range.start?new t(new St(this.range.start,r.range.endExclusive),this.originalText):null}},Z5=class t extends Y2{constructor(r){super();this.fragments=r;this.length=this.fragments.reduce((r,n)=>r+n.length,0)}static from(r){return r.length===0?new $I(""):r.length===1?r[0]:new t(r)}get text(){return this.fragments.map(r=>r.text).join("")}};function M$e(t,e){if(e.length===0)return;let r=t[t.length-1];if(r&&r instanceof Nv&&e instanceof Nv){let n=r.tryJoin(e);if(n){t[t.length-1]=n;return}}t.push(e)}var ll=class extends zI{constructor(r,n,o){super(r,n);this.languageId=o}};function RY(t,e,r){return e6(t,e,r.map(o=>({document:new X5(o.document),selection:o.selection,overlayNodeRoot:o.overlayNodeRoot}))).map(o=>new ll(o.originalText,o.edits,o.baseDocument.languageId))}function t6(t){return t*4}async function Xve(t,e,r,n,o,s){let a=await Ap(t,e,r),c=Y5(a,e,n),l=Lv(t6(o),e,n,a,s);return{document:l,adjustedSelection:l.projectOffsetRange(c.adjusted),selection:l.projectOffsetRange(c.original)}}var Op=class{constructor(e){this._parserService=e}summarizeDocument(e,r,n,o,s){return U_(this._parserService,e,r,n,o,s)}};Op=E([y(0,dt)],Op);async function U_(t,e,r,n,o,s){let a=await Ap(t,e,r);return Lv(t6(o),e,n,a,s)}function Lv(t,e,r,n,o={}){return RY(t,o,[{document:e,overlayNodeRoot:n,selection:r}])[0]}async function Jve(t,e,r,n){let o=[];return await Promise.all(e.map(async s=>{let a=await Ap(t,s.document,s.formattingOptions);o.push({document:s.document,selection:s.selection,overlayNodeRoot:a})})),RY(r,n??{},o)}var r6=class{constructor(e){this._derivedDocument=e;this._workingCopyOriginalDocument=new PY(this._derivedDocument.originalText)}get originalText(){return this._workingCopyOriginalDocument.text}get text(){return this._derivedDocument.text}get languageId(){return this._derivedDocument.languageId}get derivedDocumentTransformer(){return this._derivedDocument.positionOffsetTransformer}get originalDocumentTransformer(){return this._workingCopyOriginalDocument.transformer}get allReportedEdits(){return this._workingCopyOriginalDocument.appliedEdits}createDerivedDocumentChatResponseStream(e){return new ol(r=>{let n=this.applyAndTransformProgressItem(r);e.push(n)})}applyAndTransformProgressItem(e){if(!(e instanceof Da))return e;let r=this._workingCopyOriginalDocument,n=this._derivedDocument,o=n.edits,a=Zve(n.positionOffsetTransformer,e.edits).tryRebase(o.inverse(r.text)),c=o.tryRebase(a),l=new Da(e.uri,e0e(r.transformer,a));return this._workingCopyOriginalDocument.applyOffsetEdits(a),this._derivedDocument=new ll(this._workingCopyOriginalDocument.text,c,this._derivedDocument.languageId),l}rebaseEdits(e){let r=this._workingCopyOriginalDocument,n=this._derivedDocument,o=n.edits,a=Zve(n.positionOffsetTransformer,e).tryRebase(o.inverse(r.text));return e0e(r.transformer,a)}convertPostEditsOffsetToOriginalOffset(e){return this._derivedDocument.projectBack(e)}},PY=class{constructor(e){this._text=e;this._transformer=null;this._appliedEdits=new Or([]);this._eol=e.includes(`\r
`)?`\r
`:`
`}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new Lp(this._text)),this._transformer}get appliedEdits(){return this._appliedEdits}isNoop(e){return e.isNoop(this._text)}applyOffsetEdits(e){let r=e.normalizeEOL(this._eol),{edits:n}=r,o=this._text;for(let s=n.length-1;s>=0;s--){let a=n[s];o=o.substring(0,a.replaceRange.start)+a.newText+o.substring(a.replaceRange.endExclusive)}this._text=o,this._transformer&&this._transformer.applyOffsetEdits(r),this._appliedEdits=this._appliedEdits.compose(r)}},n6=class{constructor(e){this._text=e;this._transformer=null}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new Lp(this._text)),this._transformer}};function Zve(t,e){return t.toOffsetEdit(e)}function e0e(t,e){return t.toTextEdits(e)}async function Q2(t,e,r,n,o){let s=await Xve(t,e,r,n,o);return new AY(s.selection,s.adjustedSelection,s.document,e,r)}var AY=class{constructor(e,r,n,o,s){this._selection=e;this._adjustedSelection=r;this._projectedDocument=n;this._document=o;this._formattingOptions=s}get uri(){return this._document.uri}get languageId(){return this._document.languageId}splitAroundAdjustedSelection(){return new WI(this._projectedDocument,this.uri,this._formattingOptions,this._adjustedSelection)}splitAroundOriginalSelectionEnd(){return new WI(this._projectedDocument,this.uri,this._formattingOptions,new St(this._selection.endExclusive,this._selection.endExclusive))}},WI=class{constructor(e,r,n,o){this._projectedDocument=e;this._uri=r;this._formattingOptions=n;this._selection=this._projectedDocument.positionOffsetTransformer.toRange(o),this.codeAbove=this._projectedDocument.text.substring(0,o.start),this.codeSelected=this._projectedDocument.text.substring(o.start,o.endExclusive),this.codeBelow=this._projectedDocument.text.substring(o.endExclusive)}get hasCodeWithoutSelection(){return this.codeAbove.trim().length>0||this.codeBelow.trim().length>0}get hasContent(){return this.codeAbove.trim().length>0||this.codeSelected.trim().length>0||this.codeBelow.trim().length>0}get replaceSelectionStreaming(){return(e,r)=>new L5(r,this._selection,e)}get insertStreaming(){return(e,r)=>new Dv(r,this._selection.end,e)}get insertOrReplaceStreaming(){return(e,r)=>new jI(r,this._selection,this._selection,3,!0,e)}createReplyInterpreter(e,r,n,o,s){return new Ov(this._uri,this._projectedDocument,this._formattingOptions,e,r,n,o,s)}},Ov=class{constructor(e,r,n,o,s,a,c,l){this._uri=e;this._fileIndentInfo=n;this._leadingMarkdownStreaming=o;this._earlyStopping=s;this._streamingStrategyFactory=a;this._textPieceClassifier=c;this._lineFilter=l;this._lastText=void 0;this._initialDocumentSnapshot=new n6(r.originalText),this._workingCopySummarizedDoc=new r6(r)}async processResponse(e,r,n,o){let s=this._workingCopySummarizedDoc.createDerivedDocumentChatResponseStream(n),a=new U5(s,this._uri,this._workingCopySummarizedDoc.text,this._workingCopySummarizedDoc.text.split(`
`).map((p,f)=>new M5(f,4)),new F5(0,0),this._workingCopySummarizedDoc.languageId,this._fileIndentInfo),c=new W5(s,this._leadingMarkdownStreaming,this._earlyStopping,this._textPieceClassifier,this._streamingStrategyFactory(this._lineFilter,a));for await(let p of r){this._lastText=p.text;let{shouldFinish:f}=c.update(p.text);if(f)break}let{didEdits:l,didNoopEdits:u,additionalImports:d}=await c.finish();if(l){let p=this._generateAdditionalImportsEdits(d),f=this._workingCopySummarizedDoc.allReportedEdits.inverse(this._initialDocumentSnapshot.text),m=f.edits.reduce((v,b)=>v.join(b.replaceRange),f.edits[0].replaceRange),h=this._workingCopySummarizedDoc.originalDocumentTransformer.toRange(m),g={lastDocumentContent:this._workingCopySummarizedDoc.originalText,lastWholeRange:h};n.textEdit(this._uri,p),e.storeInInlineSession(g);return}if(d.length>0){n.textEdit(this._uri,this._generateAdditionalImportsEdits(d));return}if(u){e.addAnnotations([{label:"noop edits",message:"Edits were not applied because they were having no actual effects.",severity:"info"}]);return}if(!this._lastText)throw new Error("No text");s.markdown(this._lastText)}_generateAdditionalImportsEdits(e){if(e.length===0)return[];let r=this._workingCopySummarizedDoc.originalText.split(/\r\n|\r|\n/g),n=R$(r,a=>kv(a,this._workingCopySummarizedDoc.languageId));if(n===-1)return[new Nn(new Be(0,0,0,0),e.join(`
`)+`

`)];let o=new Set;for(let a=n;a>=0;a--){let c=r[a];if(c.trim()!=="")if(kv(c,this._workingCopySummarizedDoc.languageId))o.add(q2(c));else break}if(e=e.filter(a=>!o.has(a)),e.length===0)return[];let s=r[n].length;return[new Nn(new Be(n,s,n,s),`
`+e.join(`
`))]}};var gs=q(Ue());var yt=ne("IChatMLFetcher"),Mp=class{constructor(){this._stream=new Zg;this._seenAnnotationTypes=new Set}get stream(){return this._stream.asyncIterable}update(e,r){r.codeVulnAnnotations&&(!((e.match(/(^|\n)```/g)?.length??0)%2===1)||e.match(/(^|\n)```\w*\s*$/))&&(r.codeVulnAnnotations=void 0),r.codeVulnAnnotations&&(r.codeVulnAnnotations=r.codeVulnAnnotations.filter(n=>!this._seenAnnotationTypes.has(n.details.type)),r.codeVulnAnnotations.forEach(n=>this._seenAnnotationTypes.add(n.details.type))),this._stream.emitOne({text:e,delta:r})}resolve(){this._stream.resolve()}},i6=class{constructor(e){this.deltas=[];this.callback=async(r,n,o)=>{let s=e?await e(r,n,o):void 0;return this.deltas.push(o),s}}};var o6=ne("IToolsService");var NY=q(Ct()),Mv=q(Ue());var Fp=class extends Mv.PromptElement{constructor(r,n,o,s,a){super(r);this.workspaceService=n;this.ignoreService=o;this.instantiationService=s;this.logService=a}async render(r,n){let o="uri"in this.props.variableValue?this.props.variableValue.uri:this.props.variableValue;if(await this.ignoreService.isCopilotIgnored(o))return vscpp("ignoredFiles",{value:[o]});let s="range"in this.props.variableValue?this.props.variableValue.range:void 0,a;try{a=await this.workspaceService.openTextDocument(o)}catch(p){this.logService.public.error(p,`Error opening context for ${o}`);let f={status:{description:NY.t("This file could not be read: {0}",p.message),kind:Mv.ChatResponseReferencePartStatusKind.Omitted}};return this.props.omitReferences?void 0:vscpp(vscppf,null,vscpp("references",{value:[new Mv.PromptReference(this.props.variableName?{variableName:this.props.variableName,value:this.props.variableValue}:this.props.variableValue,void 0,f)]}))}if(s){let p=this.props.omitReferences?void 0:[new Mv.PromptReference(new fn(o,s))];return vscpp(vscppf,null,"# ",this.props.variableName.toUpperCase()," CONTEXT",vscpp("br",null),vscpp(nt,{includeFilepath:this.props.includeFilepath,languageId:a.languageId,uri:o,range:s,references:p,code:a.getText(s),variableName:this.props.variableName,isSummarized:!1}))}let l=await this.instantiationService.createInstance(Op).summarizeDocument(a,void 0,s,n.tokenBudget,{costFnOverride:LY}),u=l.isOriginal?void 0:{status:{description:NY.t("Part of this file was not sent to the model due to context window limitations. Try attaching specific selections from your file instead."),kind:2}},d=this.props.omitReferences?void 0:[new Mv.PromptReference(o,void 0,u)];return vscpp(vscppf,null,"# ",this.props.variableName.toUpperCase()," CONTEXT",vscpp("br",null),vscpp(nt,{includeFilepath:this.props.includeFilepath,languageId:a.languageId,uri:o,range:s,references:d,code:l.text,variableName:this.props.variableName}))}};Fp=E([y(1,qe),y(2,Te),y(3,j),y(4,ie)],Fp);var LY={createCostFn(t){let e=new f_(r=>{if(t.languageId==="typescript"){let n=r.parent?e.get(r.parent):1,o=r.text.trim();if(o.startsWith("private "))return n*1.1;if(o.startsWith("export ")||o.startsWith("public "))return n*.9}return 1});return(r,n)=>{if(!r)return n;if(r.kind==="import_statement")return 1e3;let o=e.get(r);return n*o}}};var ZI=q(Ue());var t0e=q(Ue());var s6=new class{constructor(){this._descriptors=[]}setIntents(t){this._descriptors=this._descriptors.concat(t)}getIntents(){return this._descriptors}};var hc=ne("IIntentService"),KI=class{constructor(e){this._instantiationService=e;this._intents=null}_getOrCreateIntents(){return this._intents||(this._intents=s6.getIntents().map(e=>this._instantiationService.createInstance(e))),this._intents}get unknownIntent(){let r=this._getOrCreateIntents().find(n=>n.id==="unknown");if(!r)throw new Error("Unknown intent not found");return r}getIntents(e){return this._getOrCreateIntents().filter(n=>n.locations.includes(e))}getIntent(e,r){return this.getIntents(r).find(n=>n.id===e)}getIntentByFunctionName(e,r){return this.getIntents(r).find(n=>n.intentDetectionInput.functionName===e)}};KI=E([y(0,j)],KI);var Wl=ne("ICommandService"),YI=class{constructor(e){this.intentService=e}getCommands(e){return this.intentService.getIntents(e).filter(r=>!r.commandInfo||!r.commandInfo.hiddenFromUser).map(r=>({commandId:r.id,intent:r,details:r.description,locations:r.locations}))}getCommand(e,r){return this.getCommands(r).find(n=>n.commandId===e)}};YI=E([y(0,hc)],YI);var Up=class extends t0e.PromptElement{constructor(r,n){super(r);this.commandService=n}getIntentDescription(r){let n=this.commandService.getCommand(r,this.props.location)?.intent;return!n||n.isListedCapability===!1?void 0:n.description}async prepare(){let r=new Set,n=Object.entries(wI).reduce((o,[s,a])=>{let c=this.getIntentDescription(s);if(c&&r.has(c))return o;c&&(r.has(c),o+=`
* ${c}`);for(let l of Object.values(a)){let u=this.getIntentDescription(l);u&&(o+=`
* ${u}`)}return o},"");return{modelName:this.props.endpoint.name,commandDescriptions:n}}render(r){return vscpp(vscppf,null,"You can answer general programming questions and perform the following tasks: ",r.commandDescriptions,vscpp("br",null),"You use the ",r.modelName," version of OpenAI's GPT models.")}};Up=E([y(1,Wl)],Up);var r0e=q(Ue()),hr=class extends r0e.PromptElement{render(){return vscpp(vscppf,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.")}};var n0e=q(Ue());var F$e=["auto","en","fr","it","de","es","ru","zh-CN","zh-TW","ja","ko","cs","pt-br","tr","pl"],kt=class extends n0e.PromptElement{constructor(r,n,o){super(r);this.configurationService=n;this.envService=o}render(){let r=this.configurationService.getConfig(le.LocaleOverride);if(!F$e.find(o=>r===o))return;let n=r!=="auto"?r:this.envService.language;if(n!=="en")return vscpp(vscppf,null,"Respond in the following locale: ",n)}};kt=E([y(1,he),y(2,gt)],kt);var i0e=q(Ue()),ct=class extends i0e.PromptElement{render(){return vscpp(vscppf,null,"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,vscpp("br",null),"Keep your answers short and impersonal.")}};var QI=q(Ue());var xo=class t{constructor(e){this._source=e;this._variables=null}_getVariables(){if(!this._variables){this._variables=[];for(let e=0;e<this._source.length;e++){let r=this._source[e];if(r.value){let n=r.name,o=this.uniqueFileName(n,this._source.slice(0,e));this._variables.push({reference:r,originalName:n,uniqueName:o,value:r.value,range:r.range})}}}return this._variables}reverse(){let e=this._source.slice(0);return e.reverse(),new t(e)}find(e){return this._getVariables().find(e)}filter(e){let r=[];for(let n of this._getVariables())e(n)&&r.push(n.reference);return new t(r)}*[Symbol.iterator](){yield*this._getVariables()}substituteVariablesWithReferences(e){let r=[];for(let n of this._getVariables())n.range&&r.push({start:n.range[0],end:n.range[1],newText:`[#${n.uniqueName}](#${n.uniqueName}-context)`});r.sort((n,o)=>o.end-n.end);for(let n of r)e=e.slice(0,n.start)+n.newText+e.slice(n.end);return e}hasVariables(){return this._getVariables().length>0}uniqueFileName(e,r){let n=r.filter(o=>o.name===e).length;return n===0?e:`${e}-${n}`}};var It=class extends QI.PromptElement{render(e,r){let n=this.props.history;if(this.props.inline&&n.length>0){let a=`The current code is a result of a previous interaction with you. Here are my previous messages: 
- ${n.map(c=>c.request.message).join(`
- `)}`;n=[new xp({message:a,type:"user"})]}let o=n.filter(a=>a.status==="success"||a.status==="in-progress"||a.status==="off-topic"||a.status==="filtered");if(o.length===0)return;let s=[];return o.forEach((a,c)=>{if(a.request.type==="user"){let l=a.promptVariables&&!this.props.omitPromptVariables?this.removeDuplicateVars(a.promptVariables,this.props.currentTurnVars,o.slice(c+1)):new xo([]);s.push(vscpp(Mr,{priority:900,chatVariables:l,query:a.request.message,omitReferences:!0}))}a.response?.type==="model"&&s.push(vscpp(QI.AssistantMessage,{name:a.response.name},a.response.message))}),vscpp(QI.PrioritizedList,{priority:this.props.priority,descending:!1},s)}removeDuplicateVars(e,r,n){return e.filter(o=>!(n.some(s=>s.promptVariables?.find(a=>o0e(o,a)))||r?.find(s=>o0e(o,s))))}};function o0e(t,e){return t.uniqueName!==e.uniqueName?!1:t.value instanceof nr&&e.value instanceof nr?t.value.toString()===e.value.toString():t.value instanceof fn&&e.value instanceof fn?JSON.stringify(t.value)===JSON.stringify(e.value):!1}var JI=q(Ue());var a6=ne("ICustomInstructionsService"),U$e=".github/copilot-instructions.md";function B$e(t){return typeof t=="object"&&t!==null?typeof t.file=="string"&&(t.language===void 0||typeof t.language=="string"):!1}function q$e(t){return typeof t=="object"&&t!==null?typeof t.text=="string"&&(t.language===void 0||typeof t.language=="string"):!1}var XI=class{constructor(e,r,n,o){this.configurationService=e;this.envService=r;this.workspaceService=n;this.fileSystemService=o;this._configKeyToSettingsUri=new Map,this._configKeyToSettingsUri.set(le.CodeGenerationInstructions,nr.from({scheme:this.envService.uriScheme,authority:"settings",path:`/${le.CodeGenerationInstructions.fullyQualifiedId}`})),this._configKeyToSettingsUri.set(le.TestGenerationInstructions,nr.from({scheme:this.envService.uriScheme,authority:"settings",path:`/${le.TestGenerationInstructions.fullyQualifiedId}`})),this._configKeyToSettingsUri.set(le.CodeFeedbackInstructions,nr.from({scheme:this.envService.uriScheme,authority:"settings",path:`/${le.CodeFeedbackInstructions.fullyQualifiedId}`}))}async fetchInstructions(e){let r=[];return e.includeCodeGenerationInstructions&&r.push(this._collectUserSettingsInstructions(le.CodeGenerationInstructions)),e.includeTestGenerationInstructions&&r.push(this._collectUserSettingsInstructions(le.TestGenerationInstructions)),e.includeCodeFeedbackInstructions&&r.push(this._collectUserSettingsInstructions(le.CodeFeedbackInstructions)),(await Promise.allSettled(r)).filter(s=>s.status==="fulfilled").map(s=>s.value).flat()}async _collectUserSettingsInstructions(e){let r=[],n=[];this.configurationService.getConfig(le.UseInstructionFiles)&&await this._collectInstructionsFromFile(U$e,void 0,r);let o=this.configurationService.inspectConfig(e);o&&await this.collectInstructionsFromSettings([o.workspaceFolderValue,o.workspaceValue,o.globalValue],n,r);let s=this.configurationService.getConfig(le.DeprecatedCustomUserInstructions);if(Array.isArray(s))for(let c of s)typeof c=="string"&&n.push({instruction:c});let a=this._configKeyToSettingsUri.get(e);return nd(a!==void 0,"reference should not be undefined"),n.length>0&&r.push({kind:1,content:n,reference:a}),r}async collectInstructionsFromSettings(e,r,n){let o=new Set,s=new Set;for(let a of e)if(Array.isArray(a))for(let c of a)B$e(c)&&!o.has(c.file)&&(o.add(c.file),await this._collectInstructionsFromFile(c.file,c.language,n)),q$e(c)&&!s.has(c.text)&&(s.add(c.text),r.push({instruction:c.text,languageId:c.language}))}async _collectInstructionsFromFile(e,r,n){let o=this.workspaceService.getWorkspaceFolders().map(async s=>{let a=nr.joinPath(s,e),c=await this.readInstructionsFromFile(a);if(!c)return;let l=[],u=c.split(/\r\n|\r|\n/);for(let d of u){let p=d.trim();p!==""&&l.push({instruction:p,languageId:r})}l.length>0&&n.push({kind:0,content:l,reference:a})});await Promise.all(o)}async readInstructionsFromFile(e){try{let r=await this.fileSystemService.readFile(e);return new TextDecoder().decode(r)}catch{return}}};XI=E([y(0,he),y(1,gt),y(2,qe),y(3,mr)],XI);var s0e=q(Ue()),Zt=class t extends s0e.PromptElement{static{this._regex=/^[a-zA-Z_][\w\.\-]*$/}render(){let{name:e}=this.props;if(!t._regex.test(e))throw new Error(`Invalid tag name: ${this.props.name}`);return vscpp(vscppf,null,"<",e,">"," ",vscpp("br",null),vscpp(vscppf,null,this.props.children," ",vscpp("br",null)),"</",e,">",vscpp("br",null))}};var cr=class extends JI.PromptElement{constructor(r,n){super(r);this.customInstructionsService=n}async render(r,n){let{includeCodeGenerationInstructions:o,includeTestGenerationInstructions:s,includeCodeFeedbackInstructions:a,customIntroduction:c}=this.props,l=await this.customInstructionsService.fetchInstructions({includeCodeGenerationInstructions:o??!0,includeTestGenerationInstructions:s??!1,includeCodeFeedbackInstructions:a??!1}),u=[];for(let d of l){let p=this.createInstructionElement(d);p&&u.push(p)}return u.length===0?void 0:vscpp(Zt,{name:"instructions"},c||vscpp(vscppf,null,"When generating code, please follow these user provided coding guidelines.")," You can ignore a guideline if it contradicts a system message.",vscpp("br",null),...u)}createInstructionElement(r){let n=[];for(let o of r.content)o.languageId?o.languageId===this.props.languageId&&n.push(`For ${o.languageId} code: ${o.instruction}`):n.push(o.instruction);if(n.length!==0)return vscpp(vscppf,null,vscpp("references",{value:[new c6(r,n)]}),n.map(o=>vscpp(Zt,{name:"customInstruction"},vscpp(JI.TextChunk,null,o))))}};cr=E([y(1,a6)],cr);var c6=class extends JI.PromptReference{constructor(r,n){super(r.reference);this.instructions=r;this.usedInstructions=n}};function OY(t){let e=0,r=0,n=0,o=0,s=0;for(let a of t)a instanceof c6&&(e+=a.usedInstructions.length,n+=a.usedInstructions.reduce((c,l)=>c+l.length,0),r+=Math.max(a.instructions.content.length-a.usedInstructions.length,0),a.instructions.kind===0?o++:s+=a.usedInstructions.length);return{codeGenInstructionsCount:e,codeGenInstructionsLength:n,codeGenInstructionsFilteredCount:r,codeGenInstructionFileCount:o,codeGenInstructionSettingsCount:s}}var Fv=class extends ZI.PromptElement{constructor(r,n,o,s){super(r);this.envService=n;this.experimentationService=o;this._configurationService=s}async render(r,n){let{query:o,history:s,chatVariables:a}=this.props.promptContext,c=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsChat,this.experimentationService),l=this.envService.OS,u=a.find(d=>d.originalName===bn.variableInfo.name);return vscpp(vscppf,null,vscpp(ZI.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp("br",null),vscpp(Up,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",l," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),vscpp(kt,null)),c&&vscpp(qi,{flexGrow:1,priority:600}),vscpp(It,{flexGrow:1,priority:700,history:s,currentTurnVars:a}),vscpp(ZI.UserMessage,{flexGrow:1,priority:750},vscpp(cr,{languageId:void 0})),!u&&vscpp(bn,{flexGrow:1,document:this.props.documentContext?.document,range:this.props.documentContext?.selection,priority:800}),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:a,query:o}))}};Fv=E([y(1,gt),y(2,Lt),y(3,he)],Fv);var Ci=class extends gs.PromptElement{render(e,r){let n=l6(this.props.chatVariables);if(n.length!==0)return this.props.embeddedInsideUserMessage?vscpp(ia,{priority:this.props.priority},"<attachment>",...n,"</attachment>"):vscpp(vscppf,null,...n.map(o=>MY(o,this.props.priority)))}},So=class extends gs.PromptElement{render(e,r){let n=this.props.chatVariables.substituteVariablesWithReferences(this.props.query);return vscpp(vscppf,null,n)}},Mr=class extends gs.PromptElement{render(e,r){let n=this.props.maintainOrder?this.props.chatVariables:this.props.chatVariables.reverse(),o=l6(n,this.props.includeFilepath,this.props.omitReferences);return vscpp(vscppf,null,...o.map(s=>MY(s,this.props.priority&&this.props.priority-1)),MY(vscpp(So,{chatVariables:n,query:this.props.query}),this.props.priority))}};function MY(t,e){return vscpp(gs.UserMessage,{priority:e},t)}function l6(t,e,r){let n=[];for(let{uniqueName:o,value:s}of t)s instanceof nr||s instanceof fn?n.push(vscpp(Fp,{includeFilepath:e,variableName:o,variableValue:s,omitReferences:r})):typeof s=="string"&&n.push(vscpp(gs.TextChunk,null,!r&&vscpp("references",{value:[new gs.PromptReference({variableName:o})]}),"# ",o.toUpperCase()," CONTEXT",vscpp("br",null),s));return n}var Kt=class extends gs.PromptElement{constructor(r,n,o,s,a,c){super(r);this.chatFetcher=n;this.instantiationService=o;this.toolsService=s;this.logService=a;this.endpointProvider=c}async render(r,n){let o=this.props.promptContext.tools;if(!o||!o.toolReferences.length)return;let s=[];for(let a of o.toolReferences){let c=this.toolsService.getTool(a.id);if(!c)throw new Error(`Unknown tool: "${a.id}"`);let l=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),u=await this.fetchToolArgs(c,l),d=c.supportedContentTypes.includes(gs.contentType)?[gs.contentType]:["text/plain"],p=await this.toolsService.invokeTool(c.id,{parameters:u,toolInvocationToken:o.toolInvocationToken,requestedContentTypes:d},Wt.None),f=a.range?this.props.promptContext.query.slice(a.range[0],a.range[1]):void 0;s.push({name:f,displayName:c.displayName??c.id,value:p})}return this.props.embeddedInsideUserMessage?vscpp(ia,{priority:this.props.priority},"<attachment>",this._renderChatToolResults(s),"</attachment>"):vscpp(gs.UserMessage,{priority:this.props.priority},this._renderChatToolResults(s))}_renderChatToolResults(r){return vscpp(vscppf,null,...r.map(n=>this.renderChatToolResult(n)),"These attachments may have useful context for the user's query. The user may refer to these attachments directly using a term that starts with #.",vscpp("br",null))}renderChatToolResult(r){let n=r.displayName&&` (${r.displayName})`,o=r.name&&` (${r.name})`;return vscpp(vscppf,null,vscpp(gs.TextChunk,null,"Attachment",n,o,":",vscpp("br",null),r.value[gs.contentType]?vscpp("elementJSON",{data:r.value[gs.contentType]}):r.value["text/plain"],vscpp("br",null),vscpp("br",null)))}async fetchToolArgs(r,n){let o={...this.props,promptContext:{...this.props.promptContext,tools:void 0}},{messages:s}=await Me.create(this.instantiationService,this.props.endpoint,Fv,o).render(),a,c=await this.chatFetcher.fetchOne("fetchToolArgs",s,async(l,u,d)=>{d.copilotFunctionCalls&&(a=d.copilotFunctionCalls[0])},Wt.None,2,n,void 0,{tools:[{type:"function",function:{name:r.id,description:r.modelDescription,parameters:r.parametersSchema}}],tool_choice:{type:"function",function:{name:r.id}}});if(!a)throw new Error(`Failed to compute args for tool: "${r.id}"`);if(c.type!=="success")throw new Error(`Fetching tool args failed: ${c.type} ${c.reason}`);this.logService.internal.trace(`Function Call: ${a.arguments}`);try{return JSON.parse(a.arguments)}catch(l){throw new Error("Invalid tool arguments: "+l.message)}}};Kt=E([y(1,yt),y(2,j),y(3,o6),y(4,ie),y(5,xe)],Kt);var Bp=class{constructor(e,r,n,o){this.endpointProvider=e;this.telemetryService=r;this.parserService=n;this.instaService=o;this.id=Bp.ID;this.description=a0e.t("Add documentation comment for this symbol");this.locations=[1];this.commandInfo={}}static{this.ID="doc"}get intentDetectionInput(){let e="generate_documentation_for_code";return{functionName:e,sampleQuestion:"Add jsdoc to this method",functionCallingBlurb:`If the active selection contains a symbol and the user's message is related to documenting code, adding docstrings, adding documentation, or adding comments, you should use the '${e}' function.`}}async invoke(e){let{documentContext:r,request:n}=e;if(!r)throw new Error("Open a file to add documentation.");let o=await Tv(this.parserService,this.telemetryService,r),s=await this.endpointProvider.getChatEndpoint(n);return this.instaService.createInstance(X2,s,r,this,o)}};Bp=E([y(0,xe),y(1,ge),y(2,dt),y(3,j)],Bp);var X2=class{constructor(e,r,n,o,s,a,c){this.endpoint=e;this.context=r;this.intent=n;this.nodeToDocument=o;this.parserService=s;this.telemetryService=a;this.instantiationService=c;this.location=1}async buildPrompt(e,r,n){let{query:o,history:s,chatVariables:a}=e,c=this.nodeToDocument??await Tv(this.parserService,this.telemetryService,this.context);return await Me.create(this.instantiationService,this.endpoint,FY,{userQuery:o,documentContext:this.context,nodeToDocument:c,endpointInfo:this.endpoint,history:s,chatVariables:a,promptContext:e}).render(r,n)}processResponse(e,r,n,o){let s=this.context.document,a=new ll(s.getText(),Or.empty,s.languageId),c=this.nodeToDocument?.range??this.context.selection,l;if(s.languageId==="python"){let u=s.getText(c).split(`
`).filter(p=>p!=="").map(p=>p.trim()),d=new Set(u);l=new Ov(this.context.document.uri,a,this.context.fileIndentInfo,hs.Mute,1,(p,f)=>new Dv(f,c.start,p),ji.createCodeBlockClassifier(),p=>!p.value.includes("FILEPATH")&&!d.has(p.value.trim()))}else l=new Ov(this.context.document.uri,a,this.context.fileIndentInfo,hs.Mute,1,(u,d)=>new jI(d,c,c,1,!1,u),ji.createCodeBlockClassifier(),u=>!u.value.includes("FILEPATH"));return l.processResponse(e,r,n,o)}};X2=E([y(4,dt),y(5,ge),y(6,j)],X2);var FY=class extends eC.PromptElement{render(e,r){let n=x5(this.props.documentContext.language.languageId),o=this.props.chatVariables.substituteVariablesWithReferences(this.props.userQuery),s=`${this.getQueryPrefix()} ${o}`.trim();return vscpp(vscppf,null,vscpp(eC.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You must follow user's requirements carefully.",vscpp("br",null),"You must follow Microsoft content policies.",vscpp("br",null),"You must avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, you should give a reminder that you are an AI programming assistant.",vscpp("br",null),"When user asks you to document something, you must answer in the form of a ",n," markdown code block.",vscpp("br",null)),vscpp(Kt,{priority:750,endpoint:this.props.endpointInfo,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{chatVariables:this.props.chatVariables}),vscpp(Cv,{documentContext:this.props.documentContext,nodeToDocument:this.props.nodeToDocument,endpointInfo:this.props.endpointInfo}),vscpp(It,{inline:!0,history:this.props.history,priority:700}),vscpp(eC.UserMessage,null,s))}getQueryPrefix(){let e=this.props.nodeToDocument?.identifier,r=e!==void 0&&e!=="",n=r?e:"the selection",o;switch(this.props.documentContext.language.languageId){case"typescript":case"typescriptreact":o=r?"a TSDoc comment":"TSDoc comment";break;case"javascript":case"javascriptreact":o=r?"a JSDoc comment":"JSDoc comment";break;case"python":o="docstring";break;default:o="documentation comment"}return`Please, given ${n}, generate ${o} only. Do not repeat given code, only reply with ${o} in a code block.`}};var l0e=q(Ct());var rC=q(Ue());var c0e=q(Ue()),Jn=class extends c0e.PromptElement{render(){return vscpp(vscppf,null,"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.")}};var d6=q(Ct()),q_=q(Ue());var u6=q(Ue());var Kl=class extends u6.PromptElement{constructor(r,n,o,s,a){super(r);this.ignoreService=n;this.extensionContext=o;this.tabsAndEditorsService=s;this.servicesAccessor=a}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){let r={implementations:[],activeDocument:void 0,isIgnored:!1},{document:n,range:o}=this.props;if(!n){let l=this.tabsAndEditorsService.activeTextEditor;if(!l)return r;n??=l.document,o??=l.selection}if(!o||o.isEmpty)return r;if(await this.ignoreService.isCopilotIgnored(n.uri))return{...r,isIgnored:!0};let s=this.extensionContext.extensionMode===nl.Test?0:this.props.timeoutMs===void 0?Kl.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,a=[{header:"Relevant function implementations",findImpls:Cve},{header:"Relevant class declarations",findImpls:Tve},{header:"Relevant type declarations",findImpls:Eve}],c=[];for(let{header:l,findImpls:u}of a){let d=await u(this.servicesAccessor,n,o,s);c.push([l,d])}return{implementations:c,activeDocument:n,isIgnored:!1}}render(r,n){if(!r.implementations.length||!r.activeDocument)return;let o=r.activeDocument.uri;if(r.isIgnored)return vscpp("ignoredFiles",{value:[o]});let s=[];for(let[a,c]of r.implementations){let{references:l,text:u,uris:d}=UY(r.activeDocument,c);if(u.length===0)continue;let p=vscpp(u6.UserMessage,{priority:this.props.priority},a,":",vscpp("br",null),vscpp("br",null),u.map((f,m)=>vscpp(vscppf,null,vscpp(nt,{code:f,languageId:r.activeDocument?.languageId,uri:d[m],references:[l[m]]}),vscpp("br",null))));s.push(p)}return vscpp(vscppf,null,...s)}};Kl=E([y(1,Te),y(2,Bt),y(3,Ft),y(4,Rt)],Kl);function UY(t,e){let r=[],n=new Set,o=[],s=[];for(let a of e){let c=a.uri??t.uri,l=a.range??Os(t,a),u=`${c.toString()}-${l.start.line}-${l.start.character}-${l.end.line}-${l.end.character}`;n.has(u)||(n.add(u),r.push(new Bo.PromptReference(new fn(c,l))),o.push(a.text),s.push(c))}return{references:r,text:o,uris:s}}var Fs=class extends q_.PromptElement{constructor(r,n,o,s){super(r);this.accessor=n;this._languageFeaturesService=o;this._workspaceService=s}static getSymbolAtCursor(r,n){let{selection:o,document:s}=n;if(!o||!s){let l=r.get(Ft).activeTextEditor;if(!l)return;({selection:o,document:s}=l)}if(!o.isEmpty)return;let a=s.getWordRangeAtPosition(o.active)??o;return{selectedText:s.getText(a),document:s,range:a}}static async getDefinitionAtRange(r,n,o,s){if(await r.get(Te).isCopilotIgnored(n.uri))return;let c=r.get(dt).getTreeSitterAST(n);if(c===void 0)return;let l=_o(o,n),u;s&&(u=await c.getNodeToExplain(l)),u??=await c.getNodeToDocument(l);let{startIndex:d,endIndex:p}="nodeToDocument"in u?u.nodeToDocument:u.nodeToExplain,f=Os(n,{startIndex:d,endIndex:p});return{identifier:u.nodeIdentifier,text:n.getText(f),range:f,uri:n.uri,startIndex:d,endIndex:p}}static async getSelectedScope(r,n){let o=r.get(Te);if(!n.document||await o.isCopilotIgnored(n.document.uri))return;let s=Fs.getSymbolAtCursor(r,n),a,c=s?await Fs.getDefinitionAtRange(r,s.document,s.range,!1):void 0;if(r.get(he).getConfig(le.ExplainScopeSelection)||s&&(c?.identifier!==s.selectedText||!s.selectedText)){let u=r.get(Ft).activeTextEditor;if(!u)return;let d=await r.get(ev).selectEnclosingScope(u,{reason:d6.t("Select an enclosing range to explain"),includeBlocks:!0});if(d){let p=u.document,f=p.getText(d);if(!f)return;a={codeAtCursor:f,document:p,range:d,definitions:[],references:[]}}}return{symbolAtCursorState:a,definition:c,symbolAtCursor:s}}async prepare(r,n,o){let s=await Fs.getSelectedScope(this.accessor,this.props).catch(()=>{});if(!s)return;let{symbolAtCursorState:a,definition:c,symbolAtCursor:l}=s;if(l){c?.identifier===l?.selectedText?a??={codeAtCursor:c.text,document:l.document,range:c.range,definitions:[],references:[]}:a??={codeAtCursor:l.document.lineAt(l.range.start).text,document:l.document,range:l.document.lineAt(l.range.start).range,definitions:[],references:[]},n.report(new xi(d6.t("Searching for relevant definitions...")));try{for(let u of await this._languageFeaturesService.getDefinitions(l.document.uri,l.range.start)){let{uri:d,range:p}=Gm(u)?{uri:u.targetUri,range:u.targetRange}:u;if(p.isEqual(l.range))continue;let f=await this._workspaceService.openTextDocument(d),m=await Fs.getDefinitionAtRange(this.accessor,f,p,!0);m&&a.definitions.push(m)}}catch{}n.report(new xi(d6.t("Searching for relevant references...")));try{let u=new Set;for(let d of await this._languageFeaturesService.getReferences(l.document.uri,l.range.start)){let{uri:p,range:f}=Gm(d)?{uri:d.targetUri,range:d.targetRange}:d;if(f.isEqual(l.range))continue;let m=`${p.toString()}-${f.start.line}-${f.start.character}-${f.end.line}-${f.end.character}`;if(u.has(m))continue;u.add(m);let h=await this._workspaceService.openTextDocument(p),g=await Fs.getDefinitionAtRange(this.accessor,h,f,!1);g&&a.references.push(g)}}catch{}return a}}render(r,n){if(!r)return;let o=[...r.definitions,...r.references];if(r.codeAtCursor){let{startIndex:a,endIndex:c}=_o(r.range,r.document);o.push({version:r.document.version,uri:r.document.uri,range:r.range,text:r.codeAtCursor,startIndex:a,endIndex:c})}let{references:s}=UY(r.document,o);return vscpp(vscppf,null,vscpp("references",{value:s}),vscpp(q_.UserMessage,null,"I have the following  code in the active editor:",vscpp("br",null),vscpp(nt,{uri:r.document.uri,languageId:r.document.languageId,code:r.codeAtCursor}),vscpp("br",null),!!r.definitions.length&&vscpp(vscppf,null,"Here are some relevant definitions for the symbols in my code:",vscpp("br",null)),!!r.definitions.length&&vscpp(q_.PrioritizedList,{priority:this.props.priority,descending:!0},r.definitions.map(a=>vscpp(nt,{uri:r.document.uri,languageId:r.document.languageId,code:a.text}))),!!r.references.length&&vscpp(vscppf,null,vscpp("br",null),"Here are some places where the the symbols in my code are referenced:",vscpp("br",null)),!!r.references.length&&vscpp(q_.PrioritizedList,{priority:this.props.priority-r.definitions.length,descending:!0},r.references.map(a=>vscpp(vscppf,null,!!a.uri&&vscpp(vscppf,null,"From the file ",RM(a.uri.toString()),":",vscpp("br",null)),vscpp(nt,{uri:r.document.uri,languageId:r.document.languageId,code:a.text}),vscpp("br",null))))))}};Fs=E([y(1,Rt),y(2,jo),y(3,qe)],Fs);var tC=class extends rC.PromptElement{constructor(r,n){super(r);this.languageService=n}async prepare(){let r=!1,{document:n,selection:o}=this.props;return n?.uri&&o&&(r=this.languageService.getDiagnostics(n.uri).filter(l=>!!l.range.intersection(o)).filter(l=>l.severity<=gI.Warning).length>0),{explainingDiagnostic:r}}render(r,n){let{query:o,history:s,chatVariables:a}=this.props.promptContext,c=a.find(l=>l.originalName===bn.variableInfo.name);return vscpp(vscppf,null,vscpp(rC.SystemMessage,{priority:1e3},"You are a world-class coding tutor. Your code explanations perfectly balance high-level concepts and granular details. Your approach ensures that students not only understand how to write code, but also grasp the underlying principles that guide effective programming.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code selection and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. If you are unsure about the code, concepts, or the user's question, ask clarifying questions.",vscpp("br",null),"3. If the user provided a specific question or error, answer it based on the selected code and additional provided context. Otherwise focus on explaining the selected code.",vscpp("br",null),"4. Provide suggestions if you see opportunities to improve code readability, performance, etc.",vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough without assuming extensive prior knowledge.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Identify 'gotchas' or less obvious parts of the code that might trip up someone new.",vscpp("br",null),"Provide clear and relevant examples aligned with any provided context."),vscpp(It,{inline:this.props.isInlineChat,priority:600,history:s}),vscpp(qi,{priority:700}),vscpp(rC.UserMessage,{priority:750},vscpp(cr,{languageId:void 0})),!c&&vscpp(bn,{document:this.props.document,range:this.props.selection,priority:900}),vscpp(Kl,{document:this.props.document,range:this.props.selection,priority:800}),!r.explainingDiagnostic&&vscpp(Fs,{document:this.props.document,selection:this.props.selection,priority:800}),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{priority:900,chatVariables:a,query:o}))}};tC=E([y(1,jo)],tC);var p6="Write an explanation for the active selection as paragraphs of text.",nC=class extends us{constructor(r,n,o,s,a){super(r,n,o);this.tabsAndEditorsService=s;this.instantiationService=a;this.defaultQuery="Write an explanation for the code above as paragraphs of text."}async buildPrompt(r,n,o){return r.query===""&&(r={...r,query:this.defaultQuery}),super.buildPrompt(r,n,o)}createRenderer(r,n,o,s){let a=this.tabsAndEditorsService.activeTextEditor;return Me.create(this.instantiationService,n,tC,{promptContext:r,document:a?.document,selection:a?.selection,isInlineChat:this.location===1,endpoint:n})}};nC=E([y(3,Ft),y(4,j)],nC);var BY=class extends nC{constructor(){super(...arguments);this.defaultQuery=p6}processResponse(r,n,o,s){return new $5().processResponse(r,n,o,s)}},iC=class{constructor(e,r){this.endpointProvider=e;this.instantiationService=r;this.id="explain";this.locations=[2,1];this.description=l0e.t("Explain how the code in your active editor works")}static{this.ID="explain"}get intentDetectionInput(){let e="explain_code_or_error";return{functionName:e,sampleQuestion:"Write an explanation for the code above as paragraphs of text.",functionCallingBlurb:`If the user's message asks for an explanation of code blocks or an error message, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return r===1?this.instantiationService.createInstance(BY,this,r,n):this.instantiationService.createInstance(nC,this,r,n)}};iC=E([y(0,xe),y(1,j)],iC);var aye=q(Ct());var IC=q(Ue());var mQ=q(Ct()),Qv=q(Ue());function f6(t,e,r){return Math.min(Math.max(t,e),r)}var qY;function jY(t,e,r){let n=t.replace(/\r\n/g,`
`);return qY=qY?.then(()=>r.getSemanticChunkTree(e,n))??r.getSemanticChunkTree(e,n),qY}function j$e(t){return t&&Array.isArray(t.text)&&(t.needsLeadingElipsis===void 0||typeof t.needsLeadingElipsis=="boolean")&&(t.needsTrailingElipsis===void 0||typeof t.needsTrailingElipsis=="boolean")}function V$e(t){return t&&typeof t.bodyIndent=="string"&&typeof t.fullRange=="object"&&t.body&&Array.isArray(t.body.content)&&(t.body.outline===void 0||j$e(t.body.outline))&&(t.suffix===void 0||typeof t.suffix=="string")&&(t.header===void 0||typeof t.header=="object"&&typeof t.header.original=="string"&&(t.header.outline===void 0||typeof t.header.outline=="string"))}var qp=class{constructor(e,r,n,o){this.lang=r;this._tokenizerProvider=n;this._parserService=o;this._naiveChunker=new Cp(e,this._tokenizerProvider);let s=qp.getFileChunkingOptions(r);this._inlineComment=s?.blockWrap??{start:"",end:""},this._elipsisPlaceholder=s?.elipsisPlaceholder??"...",this._lookForIndentInHeader=s?.lookForIndentInHeader??!0,this._numTokensInEllipsis=this._tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(this._elipsisPlaceholder)+1}static getFileChunkingOptions(e){return e!=="python"&&e!=="ruby"?{elipsisPlaceholder:"/*...*/",blockWrap:{start:"{",end:"}"},lookForIndentInHeader:!1}:{}}get _summaryPlaceHolder(){return this._inlineComment.start+this._elipsisPlaceholder+this._inlineComment.end}async parse(e,r,n){let o=await this.createChunkTree(e,r,n);return o?this.createSummaryFromSemanticChunkTree(o):[]}async createChunkTree(e,r,n){let o=typeof e=="string"?await this.provideQueryTree(e):e;if(!n.isCancellationRequested)return this.createChunkTreeFromQueryTree(o,r,n)}async createSummaryFromSemanticChunkTree(e){return this._doCreateSummaryFromSemanticChunkTree(e,!0)}async _doCreateSummaryFromSemanticChunkTree(e,r=!1){let n=[];if(e.body.content.length!==0&&n.push(this._makeChunksFromStructure(e.bodyIndent,e.body.content,e.fullRange,!r,e.header?.original,e.suffix)),e.body.outline&&e.body.outline.text.length!==0){let o=e.header?.outline??e.header?.original;n.push(this._makeChunksFromStructure(e.bodyIndent,e.body.outline.text,e.fullRange,!0,o,e.suffix,e.body.outline.needsLeadingElipsis,e.body.outline.needsTrailingElipsis).then(s=>(r&&s.length===1&&(s[0]={...s[0],isFullFile:!0}),s)))}return Promise.all(n).then(o=>o.flat())}async createChunkTreeFromQueryTree(e,r,n){let o=je.lift(r.limitToRange);if(o)for(let d of e.roots){let p=bo(d.info.mainBlock);if(o.containsRange(p)){let f=R2(e.syntaxTreeRoot,[]),m=this.chunkWholeText(f.text,f.range,r.maxTokenLength,0,void 0,o,r.rangeLimitStrategy,"");return{header:{original:"",outline:""},bodyIndent:"",body:{content:m.content.text},fullRange:bo(e.syntaxTreeRoot)}}}let s=this._parseBlocks(e.roots,"",r.maxTokenLength,r.maxHeaderLengthFactor,o??void 0,r.rangeLimitStrategy),a=s.content.flat(),c=s.outline??[],l=o&&e.roots.some(d=>je.containsRange(bo(d.info.mainBlock),o))?void 0:this.createOutlineSummaryBody(r.maxTokenLength,R2(e.syntaxTreeRoot,[]),c,"",o??void 0,r.rangeLimitStrategy);return{bodyIndent:"",fullRange:bo(e.syntaxTreeRoot),body:{content:a,outline:l}}}provideQueryTree(e){return jY(e,this.lang,this._parserService)}chunkWholeText(e,r,n,o=0,s=r,a,c,l="",u,d=[]){if(e.trim().length===0)return{content:{text:[],isFull:!0}};let p=[];try{let f={range:r,text:e},m=s,h=f.text;if(a&&c!==1){let g=je.lift(s),v=A2(a,e,g);f=v.newTextRange;let b=g.intersectRanges(a);if(!b)throw Error("Invalid Body Text Range");m=b,h=this._constructLimitedRange(v.trimmedRight,v.trimmedLeft,f.text,l)}if(p=this._naiveChunker.genericChunking({lineRangeText:[{range:f.range,text:h,sources:[{start:o,end:h.length,range:m}]}],maxTokenLength:n,numTokensInEllipsis:this._numTokensInEllipsis,removeChunksOutsideOfRange:a&&c===1?a:void 0}),a&&p.length>0&&c===1){u||(u=l+this.findNewIndentFromText(l,f.text));let g=p[0].range.startLineNumber>f.range.startLineNumber,v=p[p.length-1].range.endLineNumber<f.range.endLineNumber;g&&(p[0].text=this._constructLimitedRange(!1,!0,p[0].text,u)),v&&(p[p.length-1].text=this._constructLimitedRange(!0,!1,p[p.length-1].text,u))}}catch{return{content:{text:[],isFull:!1},outline:[]}}return{content:{text:p,isFull:!0}}}_parseBlocks(e,r,n,o,s,a){return this._parseSemanticStructure(e,r,n,o,(c,l,u,d)=>{let p=d+l.text;if(this._tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(p)<=u){let g=sl(/^\s*\n/g,p,l.range),v=sl(/(\n\s*$)/g,g.text,g.range);if(s&&a!==1){let b=A2(s,v.text,je.lift(v.range)),_=this._constructLimitedRange(b.trimmedRight,b.trimmedLeft,b.newTextRange.text,d);return{content:{text:[{sources:[{start:0,end:_.length,range:b.newTextRange.range}],range:b.newTextRange.range,text:_}],isFull:!0}}}else return{content:{text:[{sources:[{start:d.length,end:v.text.length,range:v.range}],range:v.range,text:v.text,keywords:[]}],isFull:!0}}}if(c.length===0)return this.chunkWholeText(p,l.range,u,s?0:d.length,void 0,s,a,d);let f=this._parseBlocks(c,d,u,o,s,a),m=f.content,h=f.outline;return{content:{text:m,isFull:!1},outline:h}},s,a)}_createOutlineBody(e,r){let n=e.text.split(`
`),o={lineNumber:e.range.startLineNumber,column:e.range.startColumn},s=[],a=o,c=p=>{let f=p.lineNumber-o.lineNumber,m=p.column;return o.lineNumber===p.lineNumber&&(m=p.column-o.column),{lineNumber:f,column:m}},l=p=>{let f=p.lineNumber-o.lineNumber,m=f>=n.length||p.column===n[f].length-1;return{newPosition:{lineNumber:p.lineNumber,column:p.column+1},isNewLine:m}},u=(p,f)=>{if(p.lineNumber>f.lineNumber||p.lineNumber===f.lineNumber&&p.column>f.column)return;let m=[],h=c(p),g=c(f),v=zl(p,f),b=n[h.lineNumber].substring(h.column);if(h.lineNumber===g.lineNumber){let S=b.substring(0,g.column-h.column),I=l(f);a=I.newPosition,I.isNewLine&&(S+=`
`),m.push(S)}else{let S=n[g.lineNumber].substring(0,g.column),I=l(f);a=I.newPosition,I.isNewLine&&(S+=`
`),m.push(b+`
`);for(let w=h.lineNumber+1;w<g.lineNumber;w++)m.push(n[w]+`
`);m.push(S)}let _=m.join(""),x=sl(/^\s+\n/,_,v);x.text.length>0&&s.push({sources:[{start:0,end:x.text.length,range:x.range}],text:x.text,range:v})},d=p=>{s.push({sources:p.sources,text:p.summary+`

`,range:p.range})};return r.sort((p,f)=>p.range.startLineNumber-f.range.startLineNumber||p.range.endLineNumber-f.range.endLineNumber),r.forEach(p=>{u(a,{lineNumber:p.range.startLineNumber,column:p.range.startColumn}),d(p),a=l({lineNumber:p.range.endLineNumber,column:p.range.endColumn}).newPosition}),u(a,{lineNumber:e.range.endLineNumber,column:e.range.endColumn}),s}createOutlineSummaryBody(e,r,n,o,s,a){let c=r;if(c.range.startColumn>=o.length){let f={startLineNumber:c.range.startLineNumber,startColumn:c.range.startColumn-o.length,endLineNumber:c.range.endLineNumber,endColumn:c.range.endColumn},m=o+c.text;c={text:m,range:f,sources:[{start:0,end:m.length,range:f}]}}let l=!1,u=!1;if(s&&a!==1){if(n.length===1&&je.lift(n[0].range).containsRange(s))return{text:[]};let f=A2(s,r.text,je.lift(r.range));u=f.trimmedLeft,l=f.trimmedRight,c={text:f.newTextRange.text,range:f.newTextRange.range,sources:[{start:0,end:f.newTextRange.text.length,range:f.newTextRange.range}]}}let d=this._createOutlineBody(c,n.map(f=>({sources:f.sources,summary:uge(f.summary),range:f.range,needsTrailingElipsis:l,needsLeadingElipsis:u,keyword:f.keyword}))),p=[];try{if(p=this._naiveChunker.genericChunking({lineRangeText:d,removeEmptyLines:!1,maxTokenLength:e,numTokensInEllipsis:this._numTokensInEllipsis,removeChunksOutsideOfRange:s&&a===1?s:void 0}),s&&p.length>0&&a===1){let f=p[0].range.startLineNumber<r.range.startLineNumber,m=p[p.length-1].range.endLineNumber>r.range.endLineNumber;f&&(p[0].text=this._constructLimitedRange(!1,!0,p[0].text,o)),m&&(p[p.length-1].text=this._constructLimitedRange(!0,!1,p[p.length-1].text,o))}}catch(f){return console.error(`caught error in naive chunker: ${f}`),{text:[]}}return{text:p,needsLeadingElipsis:u,needsTrailingElipsis:l}}async _makeChunksFromStructure(e,r,n,o,s,a,c,l){return Dr(await Promise.all(r.map(async(u,d)=>{let p;V$e(u)?p=await this._doCreateSummaryFromSemanticChunkTree(u):p=u;let f=s&&s.length>0?s:"";(c||o&&d!==0)&&(f+=`${e}${this._elipsisPlaceholder}
`);let m="";if((l||o&&d!==r.length-1)&&(m+=`
${e}${this._elipsisPlaceholder}`),a&&a.length>0&&(m+=a),Array.isArray(p))return Dr(p.map(g=>{if(g.text.trim().length!==0)return{range:g.range,text:f+g.text+m,sources:g.sources.map(v=>({start:v.start+f.length,end:v.end+f.length,range:v.range}))}}));if(p.text.trim().length===0)return;let h={startColumn:(d===0?n:p.range).startColumn,startLineNumber:(d===0?n:p.range).startLineNumber,endColumn:n.endColumn,endLineNumber:n.endLineNumber};return{sources:p.sources.map(g=>({start:g.start+f.length,end:g.end+f.length,range:g.range})),range:h,text:f+p.text+m}}))).flat()}findNewIndent(e,r,n){let s=(this._lookForIndentInHeader?r.text.substring(0,n.startIndex-r.startIndex):n.text).match(new RegExp(`\\n+(\\s*)${e}${this._lookForIndentInHeader?"$":""}`));return s&&s.length>1?s[1]:""}findNewIndentFromText(e,r){let n=r.match(new RegExp(`\\n+(\\s*)${e}${this._lookForIndentInHeader?"$":""}`));return n&&n.length>1?n[1]:""}_constructLimitedRange(e,r,n,o){return n.length===0?"":(r?`${o}${this._elipsisPlaceholder}
`:"")+n+(e?`
${o}${this._elipsisPlaceholder}`:"")}};qp=E([y(2,_r),y(3,dt)],qp);var Yl=class extends qp{_parseSemanticStructure(e,r,n,o,s,a,c){let l=[],u=p=>{let f=p.info,m=f.mainBlock,h=f.detailBlocks.comments,g=f.detailBlocks.body,v=bo(g),b=this._getInnerLineRangeText(g),_=g.startIndex-m.startIndex+b.prefix.length,x=this.findNewIndent(r,m,g),S="";for(let ce of h)S+=r+ce.text+`
`;let I=r+m.text.substring(0,_),w=S+I,k=bo(m),M=zl(hv((h.length>0?h[0]:m).range.startPosition,0,-r.length),{column:k.endColumn,lineNumber:k.endLineNumber});if(a&&c!==1&&!je.lift(M).intersectRanges(a))return;let H=o*n,F=w.replace(/(\n*)(\n\s*)$/g,`
`),ue=this._tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(F);if(ue>H&&(F=I.replace(/(\n*)(\n\s*)$/g,`
`),ue=this._tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(I),ue>H)){F="",ue=0;let ce=this.chunkWholeText(S+r+m.text,bo(m),n,S.length+r.length,void 0,a,c,r);return{bodyIndent:r,body:{content:ce.content.text.map(W=>({...W,keywords:[]}))},fullRange:M}}let Z=b.suffix+m.text.substring(g.endIndex-m.startIndex),V=this._tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(F+`
`+Z),A=n-V;M=zl({column:M.startColumn,lineNumber:M.startLineNumber},hv(m.range.endPosition));let P=Gl(k_,m.text.substring(0,g.startIndex-m.startIndex),{startColumn:k.startColumn,startLineNumber:k.startLineNumber,endLineNumber:v.startLineNumber,endColumn:v.startColumn}),B,U=S+r;if(l.push({summary:U+P.text+" "+this._summaryPlaceHolder,range:M,sources:[{start:U.length,end:U.length+P.text.length,range:P.range}],keyword:""}),a&&c===1&&!je.lift(M).intersectRanges(a))return;let $;if(a){let ce=!1,W=!1;for(let Y of p.children){let Se=bo(Y.info.mainBlock);if(a.containsRange(Se)){W=!0;break}if(a.intersectRanges(Se)!==null){if(ce===!0){W=!0;break}ce=!0}}W&&($={content:{text:this.chunkWholeText(b.body.text,b.body.range,n,0,void 0,a,c,r,r+x).content.text,isFull:!1}})}return $||($=s(p.children,b.body,A,r+x)),$.outline!==void 0&&(B=this.createOutlineSummaryBody(A,b.body,$.outline,r+x,a,c)),{header:{original:F},bodyIndent:r+x,body:{content:$.content.text,outline:B},fullRange:M,suffix:Z}},d=Dr(e.map(p=>u(p)));return{outline:l,content:d}}_getInnerLineRangeText(e){let r=bo(e),n=e.text,o=sl(/^\s*\{\s*/,n,r),s=Gl(/\s*\}\s*$/,o.text,o.range);return{prefix:n.slice(0,n.length-o.text.length),body:{sources:[{start:0,end:s.text.length,range:s.range}],text:s.text,range:s.range},suffix:o.text.slice(s.text.length)}}};var oC=class{constructor(e,r){this.naiveChunker=new Cp(e,r)}async parse(e,r,n){let o=r.rangeLimitStrategy,s=this._getLineRangeText(e,o!==1?r.limitToRange:void 0);return this.naiveChunker.genericChunking({lineRangeText:s,maxTokenLength:r.maxTokenLength,extraLineRangeSeparator:`

`,removeChunksOutsideOfRange:o===1?je.lift(r.limitToRange)??void 0:void 0})}_getLineRangeText(e,r){e=e.replace(/\r\n/g,`
`);let n=e.split(`
`),o=[],s={lineNumber:0,column:0},a=[],c=r?r.startLineNumber:0,l=r?r.startColumn:void 0,u=Math.min(r?r.endLineNumber+1:n.length,n.length),d=r?r.endColumn:void 0;for(let p=c;p<u;p++)if(p===0&&l?n[p]=n[p].substring(l):p===u-1&&d&&(n[p]=n[p].substring(0,d)),n[p].trim().length===0){if(o.length>0){let f=o.join(`
`),m=zl(s,{lineNumber:p-1,column:n[p-1].length});a.push({sources:[{start:0,end:f.length,range:m}],text:f,range:m}),o.length=0}s={lineNumber:p+1,column:0};continue}else o.push(n[p]);if(o.length>0){let p=o.join(`
`),f=zl(s,{lineNumber:n.length-1,column:n[n.length-1].length});a.push({sources:[{start:0,end:p.length,range:f}],text:p,range:f})}return a}};oC=E([y(1,_r)],oC);var m6=class extends qp{_parseSemanticStructure(e,r,n,o,s,a,c){let l=[],u=p=>{let f=p.info,m=f.mainBlock,h=f.detailBlocks.decorator,g=f.detailBlocks.docstring,v=f.detailBlocks.body,b={start:0,end:0,range:null};if(g)b.end=g.endIndex-m.startIndex,b.range={startLineNumber:m.range.startPosition.row,startColumn:m.range.startPosition.column,endLineNumber:g.range.endPosition.row,endColumn:g.range.endPosition.column};else if(v)b.end=v.startIndex-m.startIndex,b.range={startLineNumber:m.range.startPosition.row,startColumn:m.range.startPosition.column,endLineNumber:v.range.startPosition.row,endColumn:v.range.startPosition.column};else{let P=Gl(1,m.text,b.range);b.end=m.text.length,b.range=P.range}let _=this.findNewIndent(r,m,v),x=[],S="";h&&(S=r+h.text+`
`,x.push({start:r.length,end:h.text.length+r.length,range:bo(h)}));let I=Gl(k_,m.text.substring(0,b.end),b.range);x.push({start:S.length+r.length,end:S.length+r.length+I.text.length,range:I.range});let w=S+r+I.text+`
`,k=zl(hv(m.range.startPosition,0,-r.length),hv(m.range.endPosition));if(h&&(k=zl(hv(h.range.startPosition,0,-r.length),{column:k.endColumn,lineNumber:k.endLineNumber})),a&&c!==1&&!je.lift(k).intersectRanges(a))return;let M=o*n,H=w.replace(/\n+\s*$/g,`
`),F=this._tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(H);if(F>M&&(H=r+I.text.substring(0,v.startIndex-m.startIndex),F=this._tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(H),F>M)){H="",F=0;let P=sl(g?g.endIndex-v.startIndex:0,v.text,bo(v)),B=this.chunkWholeText(w+`
`+P.text,bo(m),n,w.length+1,P.range,a,c,r);return{fullRange:k,body:{content:B.content.text},bodyIndent:r}}if(k=zl({column:k.startColumn,lineNumber:k.startLineNumber},hv(m.range.endPosition)),l.push({summary:(g?w+_:w.slice(0,-1)+" ")+this._summaryPlaceHolder,sources:x,range:k,keyword:""}),a&&c===1&&!je.lift(k).intersectRanges(a))return;let ue=R2(v,[]),Z;if(a){let P=!1,B=!1;for(let U of p.children){let $=bo(U.info.mainBlock);if(a.containsRange($)){B=!0;break}if(a.intersectRanges($)!==null){if(P===!0){B=!0;break}P=!0}}if(B){let U=sl(g?g.endIndex-v.startIndex:0,v.text,bo(v));Z={content:{text:this.chunkWholeText(U.text,bo(m),n,0,U.range,a,c,r,r+_).content.text,isFull:!1}}}}Z||(Z=s(p.children,ue,n-F,r+_));let V=r+m.text.substring(0,v.startIndex-m.startIndex).replace(/\n+\s*$/g,`
`);Z.content.isFull&&(H=V);let A;return Z.outline!==void 0&&(A=this.createOutlineSummaryBody(n-F,ue,Z.outline,r+_,a,c)),{header:{original:H,outline:V},bodyIndent:r+_,body:{content:Z.content.text,outline:A},fullRange:k}},d=Dr(e.map(p=>u(p)));return{outline:l,content:d}}};var H$e=.6,aC=ne("ChunkingService"),u0e=(t,e)=>({file:t,text:e.text,sources:e.sources.map(r=>({start:r.start,end:r.end,range:je.lift(r.range)})),range:je.lift(e.range),isFullFile:e.isFullFile}),sC=class{constructor(e,r,n,o,s){this.instantiationService=e;this.logService=r;this.parserService=n;this.accessor=o;this.tokenizerProvider=s;this.naiveChunkers=new Map;this.semanticChunkers=new Map}async getQueryMatchTreeForResource(e,r){let n=Ns(e),o=cl(n.languageId);if(o)return await jY(r,o,this.parserService)}canSemanticallyChunk(e){return!!this.getSemanticChunker({family:"gpt-4"},e)}async chunkFileNaive(e,r,n,o,s){let a=o?.maxTokenLength??await d0e(this.accessor);if(s.isCancellationRequested)return[];let c;o&&o.limitToRange&&(o.includeExtraBodyOutsideRange===!0?c=1:o.includeExtraBodyOutsideRange===!1?c=0:c=1);let u=this.getNaiveChunker(e).genericWholeFileChunking(n,{maxTokenLength:a,rangeLimit:o?.limitToRange,rangeLimitStrategy:c}).map(d=>u0e(r,d));return o?.validateChunkLengths&&this.validateChunkLengths(u,a),u.filter(d=>d.text)}getNaiveChunker(e){let r=this.naiveChunkers.get(e.family);if(r)return r;let n=new Cp(e,this.tokenizerProvider);return this.naiveChunkers.set(e.family,n),n}async chunkFileSemantic(e,r,n,o,s){let a=o?.maxTokenLength??await d0e(this.accessor);if(s.isCancellationRequested)return[];let c;o&&o.limitToRange&&(o.includeExtraBodyOutsideRange===!0?c=1:o.includeExtraBodyOutsideRange===!1?c=0:c=1);let l=o?.maxHeaderLengthFactor??H$e,u=[];try{let d=await this.getSemanticChunker(e,r)?.parse(n,{maxTokenLength:a,maxHeaderLengthFactor:l,limitToRange:o?.limitToRange,rangeLimitStrategy:c},s);if(s.isCancellationRequested)return[];u.push(...Array.from(d??[],p=>u0e(r,p)))}catch(d){this.logService.public.error("Error parsing semantic chunks for the following file: "+r.fsPath),this.logService.public.error(d),u=[]}if(!u.length){let d=typeof n=="string"?n:n.syntaxTreeRoot.text;return this.chunkFileNaive(e,r,d,{maxTokenLength:a,validateChunkLengths:o?.validateChunkLengths,limitToRange:o?.limitToRange,includeExtraBodyOutsideRange:o?.includeExtraBodyOutsideRange},s)}return o?.validateChunkLengths&&this.validateChunkLengths(u,a),u.filter(d=>d.text)}validateChunkLengths(e,r){for(let n of e){let o=this.tokenizerProvider.acquireTokenizer({family:"gpt4"}).tokenLength(n.text);o>r*1.2&&console.warn("Produced chunk that is over length limit",{file:n.file+"",range:n.range,chunkTokenLength:o,maxLength:r})}}getSemanticChunker(e,r){let n=Ns(r),o=`${n.languageId}+${e.family}`,s=this.semanticChunkers.get(o);if(s)return s;let a;switch(n.languageId){case"typescript":a=this.instantiationService.createInstance(Yl,e,"typescript");break;case"typescriptreact":a=this.instantiationService.createInstance(Yl,e,"tsx");break;case"javascript":case"javascriptreact":a=this.instantiationService.createInstance(Yl,e,"javascript");break;case"python":a=this.instantiationService.createInstance(m6,e,"python");break;case"java":a=this.instantiationService.createInstance(Yl,e,"java");break;case"cpp":case"c":a=this.instantiationService.createInstance(Yl,e,"cpp");break;case"csharp":a=this.instantiationService.createInstance(Yl,e,"csharp");break;case"go":a=this.instantiationService.createInstance(Yl,e,"go");break;case"markdown":a=this.instantiationService.createInstance(oC,e);break;case"ruby":a=this.instantiationService.createInstance(Yl,e,"ruby");break;case"rust":a=this.instantiationService.createInstance(Yl,e,"rust");break}return a&&this.semanticChunkers.set(o,a),a}};sC=E([y(0,j),y(1,ie),y(2,dt),y(3,Rt),y(4,_r)],sC);async function d0e(t){return Z2(t,{valueFor4096:n5,maxMultiplier:4})}function cC(t){return new Be(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn)}async function Z2(t,e){let n=(await t.get(xe).getChatEndpoint("gpt-3.5-turbo")).modelMaxPromptTokens/4096;return f6(Math.round(e.valueFor4096*n),e.valueFor4096,e.valueFor4096*e.maxMultiplier)}async function p0e(t,e){let r=new Fo;try{let n=await t();return e(r.elapsed(),"success"),n}catch(n){throw e(r.elapsed(),ed(n)?"cancelled":"failed"),n}}async function Ym(t,e,r,n){return p0e(()=>(t.internal.debug(`${e} started`),r()),(o,s)=>{t.internal.debug(`${e} ${s}. Elapsed ${o}`),n?.(o,s)})}function Vo(t,e){return function(r,n,o){let s=o.value,a=0;return o.value=async function(...c){let l=a++,u=t(this);return Ym(u,`${n}#${l}`,()=>s.apply(this,c),e?.bind(this))},o}}function eD(t){return function(e,r,n){let o=n.value;return n.value=function(...s){return p0e(()=>o.apply(this,s),t.bind(this))},n}}var eye=q(Ct());var Uv=ne("ISimulationTestContext"),h6=class{constructor(){this.isInSimulationTests=!1}async writeFile(e,r,n){return""}};var H0e=q(Ct());var XY=q(D0e());function _6(t,e){return typeof e=="string"?XY.default.isMatch(t.fsPath,e,{dot:!0,windows:process.platform==="win32"}):XY.default.isMatch(t.fsPath,e.pattern,{dot:!0,windows:process.platform==="win32"})}function N0e(t,e){return e.exclude?.some(r=>_6(t,r))?!1:e.include?e.include.some(r=>_6(t,r)):!0}function L0e(t,e){let r=typeof t=="string"?t:t.baseUri.toString()+t.pattern,n=typeof e=="string"?e:e.baseUri.toString()+e.pattern;return r=r.replace(/\{.*\}/g,""),n=n.replace(/\{.*\}/g,""),`{${r},${n}}`}var Ho=ne("IGitService");function uC(t){if(!t)return;if(t.remoteFetchUrls?.length===1)return JY(t.remoteFetchUrls[0]);let e=t.remotes.findIndex(n=>n===t.upstreamRemote);if(e!==-1){let n=t.remoteFetchUrls?.[e];if(n){let o=JY(n);if(o)return o}}let r=t.remotes.findIndex(n=>n==="origin");if(r!==-1){let n=t.remoteFetchUrls?.[r];if(n){let o=JY(n);if(o)return o}}}function JY(t){t=t.replace(/^git@/,"").replace(/\.git$/,"");try{let e=He.parse(t);if(e.authority!=="github.com"&&e.scheme!=="github.com")return;let r=e.path.replace(/^\//,"").trim(),[n,o,s]=r.split("/");return n&&o?`${n}/${o}`:void 0}catch{return}}function O0e(t){if(t.includes("@")&&t.includes(":")){let e="https://"+t.substring(t.indexOf("@")+1).replace(":","/"),r=new URL(e);return r.username="",r.password="",r.search="",r.toString()}else{let e=new URL(t);return e.protocol="https",e.username="",e.password="",e.search="",e.toString()}}var x6=ne("codeSearchClient"),dC=ne("docsSearchClient");var pC=class extends Error{constructor(r,n){super(n);this.repo=r}},nD=class extends pC{constructor(){super(...arguments);this.name="ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG"}},ZY=class extends pC{constructor(){super(...arguments);this.name="ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE"}},iD=class extends pC{constructor(){super(...arguments);this.name="ERROR_TYPE_NOT_INDEXED"}},eQ=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_MAX_RETRIES_EXCEEDED"}},tQ=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_NO_ACCESS_TO_ENDPOINT"}};function M0e({error:t,message:e,repo:r}){switch(t){case"ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG":return new nD(r,e);case"ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE":return new ZY(r,e);case"ERROR_TYPE_NOT_INDEXED":return new iD(r,e);default:return new pC(r,e)}}function rQ({error:t,message:e}){switch(t){case"ERROR_TYPE_MAX_RETRIES_EXCEEDED":return new eQ(e);case"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT":return new tQ(e);default:return new Error(e)}}var j0e=q(B0e()),V0e=require("util");var fC=class{constructor(e,r){this.baseUri=e;this.pattern=r}get base(){throw new Error("Not implemented")}};var Hp=ne("ISearchService"),I6=class{async findFilesWithDefaultExcludes(e,r,n){return this._findFilesWithDefaultExcludesAndExcludes(e,void 0,r,n)}async findFilesWithExcludes(e,r,n,o){return this._findFilesWithDefaultExcludesAndExcludes(e,r,n,o)}async _findFilesWithDefaultExcludesAndExcludes(e,r,n,o){let s={maxResults:n,exclude:r,useDefaultExcludes:!0,useDefaultSearchExcludes:!0},a=await this.findFiles(e,s,o);return n===1?a[0]:a}};var AWe=1e5,DWe=1*1024*1024,NWe=new Set(["jpg","jpeg","jpe","png","gif","bmp","tif","tiff","tga","ico","webp","svg","eps","heif","heic","pdf","raw","mp4","m4v","mkv","webm","mov","avi","wmv","flv","mp3","wav","m4a","flac","ogg","wma","weba","aac","7z","bz2","gz","gz","rar","tar","xz","zip","vsix","db","bin","dat","hex","map","wasm","pyc","pdb","sym","git"]),LWe=["node_modules","out","dist",".git",".yarn",".npm",".venv","foo.asar",".vscode-test"],OWe=[".DS_Store","Thumbs.db","package-lock.json","yarn.lock"],MWe=[Tn.vscode,Tn.vscodeUserData,"output",Tn.inMemory,Tn.internal,"git"];function FWe(t,e){if(MWe.includes(e.scheme))return!1;let r=t.get(qe);if(![Tn.file,Tn.untitled].includes(e.scheme)&&!r.getWorkspaceFolders().some(s=>e.scheme===s.scheme))return!1;let n=tl(e).replace(/\./,"").toLowerCase();return!(NWe.has(n)||OWe.includes(Ml(e).toLowerCase())||e.fsPath.toLowerCase().split(/[/\\]/g).some(s=>LWe.includes(s)))}async function j_(t,e){let r=t.get(Te);return FWe(t,e)&&!await r.isCopilotIgnored(e)}async function q0e(t,e,r){let n=t.get(qe),o=t.get(Hp);if(await t.get(Te).init(),r?.isCancellationRequested)return[];let a=new Nr;for(let c of n.getWorkspaceFolders()??[]){if(a.size>=e)break;let l=await o.findFilesWithDefaultExcludes(new fC(c,"**/*"),e-a.size,r);if(r.isCancellationRequested)return[];for(let u of l){if(a.size>=e||r.isCancellationRequested)break;await j_(t,u)&&a.set(u)}}return a.keys()}var C6=class{constructor(e,r){this._uri=e;this._chunkingService=r;this._isDisposed=!1;this._disposedCts=new Uo}dispose(){this._isDisposed=!0,this._disposedCts.cancel(),this._disposedCts.dispose()}get uri(){return this._uri}async getQueryMatchTree(e){return this._queryMatchTree??=this.getText(this._disposedCts.token).then(r=>{if(!this._isDisposed)return this._chunkingService.getQueryMatchTreeForResource(this._uri,r)}),await ka(this._queryMatchTree,e)??void 0}async getBasicChunks(e,r,n){return this._basicChunks??=this.getText(this._disposedCts.token).then(o=>this._isDisposed?[]:this._chunkingService.chunkFileNaive(e,this._uri,o,{limitToRange:r},this._disposedCts.token)),await ka(this._basicChunks,n)??[]}async getSemanticChunks(e,r,n){return this._chunkingService.canSemanticallyChunk(this.uri)?await ka((async()=>{if(Ns(this.uri).languageId==="markdown"){let a=await this.getText(this._disposedCts.token);return this._isDisposed?void 0:r?this._chunkingService.chunkFileSemantic(e,this._uri,a,{limitToRange:r},this._disposedCts.token):(this._fullFileSemanticChunks??=this._chunkingService.chunkFileSemantic(e,this._uri,a,{},this._disposedCts.token),this._fullFileSemanticChunks)}let s=await this.getQueryMatchTree(this._disposedCts.token);return s?this._isDisposed?[]:r?this._chunkingService.chunkFileSemantic(e,this._uri,s,{limitToRange:r},this._disposedCts.token):(this._fullFileSemanticChunks??=this._chunkingService.chunkFileSemantic(e,this._uri,s,{},this._disposedCts.token),this._fullFileSemanticChunks):this.getBasicChunks(e,r,n)})(),n)??[]:this.getBasicChunks(e,r,n)}},sQ=class extends C6{constructor(r,n,o){super(r,n);this._fs=o}async getText(r){return this._text??=this._fs.readFile(this.uri).then(async n=>this._isDisposed||n.byteLength>=DWe||await(0,j0e.isBinaryFile)(Buffer.from(n))||this._isDisposed?"":new V0e.TextDecoder().decode(n),n=>""),await ka(this._text,r)??""}},T6=class extends C6{constructor(r,n){super(r.uri,n);this._textDocument=r}async getText(r){return this._textDocument.getText()}},vc=ne("workspaceFileIndex"),mC=class extends Oe{constructor(r,n,o,s,a){super();this._accessor=r;this._chunkingService=n;this._fileSystem=o;this._telemetryService=s;this._workspaceService=a;this._textDocumentFiles=new Nr;this._fsFiles=new Nr;this._onDidCreateFile=this._register(new Yt);this.onDidCreateFile=this._onDidCreateFile.event;this._onDidChangeFile=this._register(new Yt);this.onDidChangeFile=this._onDidChangeFile.event;this._onDidDeleteFile=this._register(new Yt);this.onDidDeleteFile=this._onDidDeleteFile.event;this._commonInit=new qn(async()=>{this.registerListeners(),await this._workspaceService.ensureWorkspaceIsFullyLoaded();for(let r of this._workspaceService.textDocuments)await j_(this._accessor,r.uri)&&this._textDocumentFiles.set(r.uri,new T6(r,this._chunkingService))})}get fileSystemFileCount(){return this._fsFiles.size}dispose(){super.dispose(),zg(this._fsFiles.values()),this._fsFiles.clear(),zg(this._textDocumentFiles.values()),this._textDocumentFiles.clear()}get(r){return this._textDocumentFiles.get(r)||this._fsFiles.get(r)}*values(){let r=new Nr;for(let[n,o]of this._textDocumentFiles.entries())yield o,r.set(n);for(let[n,o]of this._fsFiles.entries())r.has(n)||(r.set(n),yield o)}registerListeners(){let r=async o=>{if(!await j_(this._accessor,o.uri))return;let s=this._textDocumentFiles.get(o.uri),a=this._fsFiles.get(o.uri);s?.dispose(),this._textDocumentFiles.set(o.uri,new T6(o,this._chunkingService)),!s&&!a?this._onDidCreateFile.fire(o.uri):this._onDidChangeFile.fire(o.uri)};this._register(this._workspaceService.onDidOpenTextDocument(r)),this._register(this._workspaceService.onDidChangeTextDocument(o=>r(o.document))),this._register(this._workspaceService.onDidCloseTextDocument(o=>{let s=this._textDocumentFiles.get(o.uri);if(!s)return;this._textDocumentFiles.delete(o.uri),s.dispose(),this._fsFiles.get(o.uri)?this._onDidChangeFile.fire(o.uri):this._onDidDeleteFile.fire(o.uri)}));let n=this._register(this._fileSystem.createFileSystemWatcher("**/*"));this._register(n.onDidChange(async o=>{if(!await j_(this._accessor,o))return;let s=this._fsFiles.has(o);this.createOrUpdateFsEntry(o),s?this._onDidChangeFile.fire(o):this._onDidCreateFile.fire(o)})),this._register(n.onDidCreate(async o=>{await j_(this._accessor,o)&&(this._fsFiles.has(o)||(this.createOrUpdateFsEntry(o),this._onDidCreateFile.fire(o)))})),this._register(n.onDidDelete(o=>{let s=this._fsFiles.get(o);s&&(s.dispose(),this._fsFiles.delete(o),this._onDidDeleteFile.fire(o))}))}async preLoadWorkspaceFiles(r,n){switch(this._preloadWorkspaceFilesState?.type){case"full":return;case"partial":case"pending":if(this._preloadWorkspaceFilesState.count>=r)return;break}let o=(async()=>{await this._commonInit.value;let s=Array.from(await q0e(this._accessor,r,n));for(let a of s)this.createOrUpdateFsEntry(a);this._preloadWorkspaceFilesState?.type==="pending"&&this._preloadWorkspaceFilesState.p===o&&(n.isCancellationRequested?this._preloadWorkspaceFilesState=void 0:this._preloadWorkspaceFilesState=s.length<r?{type:"full"}:{type:"partial",count:r})})();return this._preloadWorkspaceFilesState={type:"pending",count:r,p:o},o}initialize(){return this._initialized??=(async()=>{switch(await this._commonInit.value,this._preloadWorkspaceFilesState?.type){case"full":break;case"partial":case"pending":default:{let r=Array.from(await q0e(this._accessor,AWe,Wt.None));for(let n of r)this.createOrUpdateFsEntry(n)}}this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkIndex.initialize",{},{totalFileCount:_i.reduce(this.values(),r=>r+1,0)})})(),this._initialized}createOrUpdateFsEntry(r){let n=this._fsFiles.get(r);n&&n.dispose();let o=new sQ(r,this._chunkingService,this._fileSystem);this._fsFiles.set(r,o)}};mC=E([y(0,Rt),y(1,aC),y(2,mr),y(3,ge),y(4,qe)],mC);async function E6(t,e,r,n,o){let s=t.get(vc),a=t.get(aC),c=new Nr;for(let u of r){let d=c.get(u.file);d?d.push(u):c.set(u.file,[u])}let l=await Promise.all(Array.from(c,async([u,d])=>{let p=s.get(u);if(p&&a.canSemanticallyChunk(u)){let f=new Set;if(n.shouldUseRangedChunks)for(let m of d){let h=m.range,g=await p.getSemanticChunks(e,h,o);if(o.isCancellationRequested)return[];g.length===0?f.add(m):g.forEach(v=>f.add(v))}else{let m=await p.getSemanticChunks(e,void 0,o);if(o.isCancellationRequested)return[];for(let h of d){let g=!1;for(let v of m)v.range.intersectRanges(h.range)&&(f.add(v),g=!0);g||f.add(h)}}return Array.from(f)}else return d}));return Array.from(new Set(l.flat()))}var jv=class extends Oe{constructor(r,n,o,s,a,c,l,u,d,p,f){super();this._logService=r;this._accessor=n;this._authenticationService=o;this._codeSearchClient=s;this._configurationService=a;this._experimentationService=c;this._ignoreService=l;this._telemetryService=u;this._workspaceChunkIndex=d;this._workspaceService=p;this._gitService=f;this.id="codesearch";this.timeout=5e3}async searchFileChunks(r,n,o,s,a){let c;try{c=await this.getSimilarFilesFromCodeSearch(n,o,a)}catch(u){if(this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.error",{errorMessage:u instanceof Error?u.message:u.toString()}),u instanceof nD)try{if(this._authenticationService.permissiveGitHubSession)return{chunks:[]};let d=await this._authenticationService.getPermissiveGitHubSession({forceNewSession:{detail:H0e.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:He.parse("https://aka.ms/copilotRepoScope")}});if(a.isCancellationRequested)return{chunks:[]};d&&(c=await this.getSimilarFilesFromCodeSearch(n,o,a))}catch{}throw u}if(!c||a.isCancellationRequested)return{chunks:[]};this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.success",{},{chunkCount:c.chunks.length});let l=await Ym(this._logService,"toSemanticChunks",()=>E6(this._accessor,r,c.chunks,{},a));return a.isCancellationRequested?{chunks:[]}:{chunks:s.include?l.filter(u=>N0e(u.file,s.include)):l,couldBeOutdated:c.couldBeOutdated}}async isAvailable(){let r;return r=this._configurationService.getConfig(le.WorkspaceCodeSearchEnabled),r===void 0&&(r=this._experimentationService.getTreatmentVariable("vscode","copilotchat.useCodeSearch")),!(r===!1||!this.getReposContext())}getShouldUseRawChunks(){let r;return r=this._configurationService.getConfig(le.WorkspaceCodeSearchReturnRawChunks),r===void 0&&(r=this._experimentationService.getTreatmentVariable("vscode","copilotchat.codeSearchRawChunks")),r??!1}async getSimilarFilesFromCodeSearch(r,n,o){let s=this.getReposContext();if(!s)return;let a=s;if(!a.size)throw new Error("No repos to search through");let c=await r.resolveQuery(o);if(o.isCancellationRequested)return;let l=this.getShouldUseRawChunks(),u=await this._codeSearchClient.search(c,{repo:Array.from(a.keys())},{rawChunks:l,limit:n},o);if(o.isCancellationRequested)return;let d=await this.processResults(a,u,o);if(!(!d||o.isCancellationRequested))return{chunks:d.chunks.flat().sort((p,f)=>f.score-p.score),couldBeOutdated:d.couldBeOutdated}}getReposContext(){let r=this._workspaceService.getWorkspaceFolders(),n=this._accessor.safeGet(Ho)?.repositories;if(!n)return;let o=new Map;for(let s=0;s<n.length;s++){let a=r[s],c=n[s],l=uC(c)?.toLowerCase();l&&a&&o.set(l,a)}if(o.size)return o}_isOutdatedResponse(r,n){return r.commitOID?this._gitService.getRepository(n)?.headCommitHash!==r.commitOID:!1}async processResults(r,n,o){let s=!1,a=[],c=n.errors.filter(l=>!(l instanceof iD));if(c.length){let l=!0;for(let u of r.keys()){let d=c.filter(p=>p.repo===u);if(d){this._logService.internal.debug(`[${u}] Errors when searching codesearch: ${d.map(hM)}`);continue}l=!1}if(l)throw c.length===1?c[0]:new AggregateError(c)}for(let l of n.results){let u=l.repoOwner.toLowerCase()+"/"+l.repoName.toLowerCase(),d=r.get(u);if(!d){this._logService.public.error("Could not find workspace folder for repo: "+u);continue}!s&&this._isOutdatedResponse(l,d)&&(s=!0);let p=this._workspaceChunkIndex.get(He.joinPath(d,l.path));if(p&&!await this._ignoreService.isCopilotIgnored(p.uri)){if(o.isCancellationRequested)return;a.push({file:p.uri,score:l.score,text:l.contents,sources:[],range:new je(l.range.start,0,l.range.end+1,0)})}}return{chunks:a,couldBeOutdated:s}}};E([Vo(r=>r._logService,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],jv.prototype,"searchFileChunks",1),E([Vo(r=>r._logService)],jv.prototype,"getSimilarFilesFromCodeSearch",1),jv=E([y(0,ie),y(1,Rt),y(2,Tt),y(3,x6),y(4,he),y(5,Lt),y(6,Te),y(7,ge),y(8,vc),y(9,qe),y(10,Ho)],jv);var w6=class t{constructor(e,r,n,o){this._uri=e,this._languageId=r,this._version=n,this._content=o,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}update(e,r){for(let n of e)if(t.isIncremental(n)){let o=z0e(n.range),s=this.offsetAt(o.start),a=this.offsetAt(o.end);this._content=this._content.substring(0,s)+n.text+this._content.substring(a,this._content.length);let c=Math.max(o.start.line,0),l=Math.max(o.end.line,0),u=this._lineOffsets,d=G0e(n.text,!1,s);if(l-c===d.length)for(let f=0,m=d.length;f<m;f++)u[f+c+1]=d[f];else d.length<1e4?u.splice(c+1,l-c,...d):this._lineOffsets=u=u.slice(0,c+1).concat(d,u.slice(l+1));let p=n.text.length-(a-s);if(p!==0)for(let f=c+1+d.length,m=u.length;f<m;f++)u[f]=u[f]+p}else if(t.isFull(n))this._content=n.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=r}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=G0e(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let r=this.getLineOffsets(),n=0,o=r.length;if(o===0)return{line:0,character:e};for(;n<o;){let a=Math.floor((n+o)/2);r[a]>e?o=a:n=a+1}let s=n-1;return{line:s,character:e-r[s]}}offsetAt(e){let r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;let n=r[e.line],o=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,o),n)}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let r=e;return r!=null&&typeof r.text=="string"&&r.range!==void 0&&(r.rangeLength===void 0||typeof r.rangeLength=="number")}static isFull(e){let r=e;return r!=null&&typeof r.text=="string"&&r.range===void 0&&r.rangeLength===void 0}},hC;(function(t){function e(o,s,a,c){return new w6(o,s,a,c)}t.create=e;function r(o,s,a){if(o instanceof w6)return o.update(s,a),o;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=r;function n(o,s){let a=o.getText(),c=cQ(s.map(UWe),(d,p)=>{let f=d.range.start.line-p.range.start.line;return f===0?d.range.start.character-p.range.start.character:f}),l=0,u=[];for(let d of c){let p=o.offsetAt(d.range.start);if(p<l)throw new Error("Overlapping edit");p>l&&u.push(a.substring(l,p)),d.newText.length&&u.push(d.newText),l=o.offsetAt(d.range.end)}return u.push(a.substr(l)),u.join("")}t.applyEdits=n})(hC||(hC={}));function cQ(t,e){if(t.length<=1)return t;let r=t.length/2|0,n=t.slice(0,r),o=t.slice(r);cQ(n,e),cQ(o,e);let s=0,a=0,c=0;for(;s<n.length&&a<o.length;)e(n[s],o[a])<=0?t[c++]=n[s++]:t[c++]=o[a++];for(;s<n.length;)t[c++]=n[s++];for(;a<o.length;)t[c++]=o[a++];return t}function G0e(t,e,r=0){let n=e?[r]:[];for(let o=0;o<t.length;o++){let s=t.charCodeAt(o);(s===13||s===10)&&(s===13&&o+1<t.length&&t.charCodeAt(o+1)===10&&o++,n.push(r+o+1))}return n}function z0e(t){let e=t.start,r=t.end;return e.line>r.line||e.line===r.line&&e.character>r.character?{start:r,end:e}:t}function UWe(t){let e=z0e(t.range);return e!==t.range?{newText:t.newText,range:e}:t}async function ul(t){if(!t)return;let e=await crypto.subtle.importKey("raw",new TextEncoder().encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),r=Math.floor(Date.now()/1e3).toString(),o=new TextEncoder().encode(r),s=await crypto.subtle.sign("HMAC",e,o),c=Array.from(new Uint8Array(s)).map(l=>l.toString(16).padStart(2,"0")).join("");return`${r}.${c}`}async function gC(t){let e=typeof t=="string"?new TextEncoder().encode(t):t,r=await crypto.subtle.digest("SHA-256",e),n=new Uint8Array(r),o="";for(let s of n)o+=s.toString(16).padStart(2,"0");return o}var Vv=class{},BWe=30*1e3;function $0e(t,e,r,n,o,s,a,c,l,u,d,p){let f=typeof s=="string"?{modelMaxPromptTokens:0,url:s,family:"",name:"",version:""}:s,m={Authorization:`Bearer ${a}`,"X-Request-Id":u,"X-GitHub-Api-Version":"2023-07-07","Openai-Organization":"github-copilot","Copilot-Integration-Id":e.isProduction()?"vscode-chat":"vscode-chat-dev","VScode-SessionId":e.sessionId,"VScode-MachineId":e.machineId,...e.getEditorVersionHeaders(),...f.getExtraHeaders?f.getExtraHeaders():{}};if(f.interceptBody&&f.interceptBody(d),l&&(m["OpenAI-Intent"]=l),!e.isProduction()&&f.url.includes(n.capiBaseURL)){if(!c)throw new Error("HMAC must be provided for non-production requests");m["Request-Hmac"]=c}let h={method:o,headers:m,json:d,timeout:BWe},g=t;if(p){let b=g.makeAbortController();p.onCancellationRequested(()=>{r.sendGHTelemetryEvent("networking.cancelRequest",{headerRequestId:u}),b.abort()}),h.signal=b.signal}return g.fetch(f.url,h).catch(b=>{if(b.code==="ECONNRESET"||b.code==="ETIMEDOUT"||b.code==="ERR_HTTP2_INVALID_SESSION"||b.code==="ERR_HTTP2_STREAM_CANCEL"||b.message==="ERR_HTTP2_GOAWAY_SESSION")return r.sendGHTelemetryEvent("networking.disconnectAll"),g.disconnectAll().then(()=>g.fetch(f.url,h));throw g.isAbortError(b)?new dn:b})}function Hv(t,e,r,n,o,s,a,c,l,u,d){return $0e(t,e,r,n,"POST",o,s,a,c,l,u,d)}function lQ(t,e,r,n,o,s,a,c,l,u,d){return $0e(t,e,r,n,"GET",o,s,a,c,l,u,d)}var W0e=ne("headerContributors"),k6=class{constructor(){this.contributors=[]}add(e){this.contributors.push(e)}remove(e){let r=this.contributors.indexOf(e);r!==-1&&this.contributors.splice(r,1)}contributeHeaders(e){for(let r of this.contributors)r.contributeHeaderValues(e)}size(){return this.contributors.length}};var vC=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Y0e=new Set,uQ=typeof process=="object"&&process?process:{},Q0e=(t,e,r,n)=>{typeof uQ.emitWarning=="function"?uQ.emitWarning(t,e,r,n):console.error(`[${r}] ${e}: ${t}`)},R6=globalThis.AbortController,K0e=globalThis.AbortSignal;if(typeof R6>"u"){K0e=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(n,o){this._onabort.push(o)}},R6=class{constructor(){e()}signal=new K0e;abort(n){if(!this.signal.aborted){this.signal.reason=n,this.signal.aborted=!0;for(let o of this.signal._onabort)o(n);this.signal.onabort?.(n)}}};let t=uQ.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=()=>{t&&(t=!1,Q0e("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}var qWe=t=>!Y0e.has(t),sHt=Symbol("type"),Gv=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),X0e=t=>Gv(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?yC:null:null,yC=class extends Array{constructor(e){super(e),this.fill(0)}},dQ=class t{heap;length;static#t=!1;static create(e){let r=X0e(e);if(!r)return[];t.#t=!0;let n=new t(e,r);return t.#t=!1,n}constructor(e,r){if(!t.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},P6=class t{#t;#i;#d;#r;#c;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#m;#s;#n;#e;#p;#h;#u;#l;#v;#f;#_;#x;#y;#S;#E;#g;static unsafeExposeInternals(e){return{starts:e.#x,ttls:e.#y,sizes:e.#_,keyMap:e.#s,keyList:e.#n,valList:e.#e,next:e.#p,prev:e.#h,get head(){return e.#u},get tail(){return e.#l},free:e.#v,isBackgroundFetch:r=>e.#o(r),backgroundFetch:(r,n,o,s)=>e.#D(r,n,o,s),moveToTail:r=>e.#R(r),indexes:r=>e.#I(r),rindexes:r=>e.#C(r),isStale:r=>e.#b(r)}}get max(){return this.#t}get maxSize(){return this.#i}get calculatedSize(){return this.#m}get size(){return this.#a}get fetchMethod(){return this.#c}get dispose(){return this.#d}get disposeAfter(){return this.#r}constructor(e){let{max:r=0,ttl:n,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:l,dispose:u,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,maxEntrySize:h=0,sizeCalculation:g,fetchMethod:v,noDeleteOnFetchRejection:b,noDeleteOnStaleGet:_,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:S,ignoreFetchAbort:I}=e;if(r!==0&&!Gv(r))throw new TypeError("max option must be a nonnegative integer");let w=r?X0e(r):Array;if(!w)throw new Error("invalid max value: "+r);if(this.#t=r,this.#i=m,this.maxEntrySize=h||this.#i,this.sizeCalculation=g,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#c=v,this.#E=!!v,this.#s=new Map,this.#n=new Array(r).fill(void 0),this.#e=new Array(r).fill(void 0),this.#p=new w(r),this.#h=new w(r),this.#u=0,this.#l=0,this.#v=dQ.create(r),this.#a=0,this.#m=0,typeof u=="function"&&(this.#d=u),typeof d=="function"?(this.#r=d,this.#f=[]):(this.#r=void 0,this.#f=void 0),this.#S=!!this.#d,this.#g=!!this.#r,this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!b,this.allowStaleOnFetchRejection=!!x,this.allowStaleOnFetchAbort=!!S,this.ignoreFetchAbort=!!I,this.maxEntrySize!==0){if(this.#i!==0&&!Gv(this.#i))throw new TypeError("maxSize must be a positive integer if specified");if(!Gv(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#U()}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!_,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=Gv(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=n||0,this.ttl){if(!Gv(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#N()}if(this.#t===0&&this.ttl===0&&this.#i===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#i){let k="LRU_CACHE_UNBOUNDED";qWe(k)&&(Y0e.add(k),Q0e("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",k,t))}}getRemainingTTL(e){return this.#s.has(e)?1/0:0}#N(){let e=new yC(this.#t),r=new yC(this.#t);this.#y=e,this.#x=r,this.#L=(s,a,c=vC.now())=>{if(r[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){let l=setTimeout(()=>{this.#b(s)&&this.delete(this.#n[s])},a+1);l.unref&&l.unref()}},this.#w=s=>{r[s]=e[s]!==0?vC.now():0},this.#T=(s,a)=>{if(e[a]){let c=e[a],l=r[a];if(!c||!l)return;s.ttl=c,s.start=l,s.now=n||o();let u=s.now-l;s.remainingTTL=c-u}};let n=0,o=()=>{let s=vC.now();if(this.ttlResolution>0){n=s;let a=setTimeout(()=>n=0,this.ttlResolution);a.unref&&a.unref()}return s};this.getRemainingTTL=s=>{let a=this.#s.get(s);if(a===void 0)return 0;let c=e[a],l=r[a];if(!c||!l)return 1/0;let u=(n||o())-l;return c-u},this.#b=s=>{let a=r[s],c=e[s];return!!c&&!!a&&(n||o())-a>c}}#w=()=>{};#T=()=>{};#L=()=>{};#b=()=>!1;#U(){let e=new yC(this.#t);this.#m=0,this.#_=e,this.#k=r=>{this.#m-=e[r],e[r]=0},this.#O=(r,n,o,s)=>{if(this.#o(n))return 0;if(!Gv(o))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(o=s(n,r),!Gv(o))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return o},this.#P=(r,n,o)=>{if(e[r]=n,this.#i){let s=this.#i-e[r];for(;this.#m>s;)this.#A(!0)}this.#m+=e[r],o&&(o.entrySize=n,o.totalCalculatedSize=this.#m)}}#k=e=>{};#P=(e,r,n)=>{};#O=(e,r,n,o)=>{if(n||o)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#I({allowStale:e=this.allowStale}={}){if(this.#a)for(let r=this.#l;!(!this.#M(r)||((e||!this.#b(r))&&(yield r),r===this.#u));)r=this.#h[r]}*#C({allowStale:e=this.allowStale}={}){if(this.#a)for(let r=this.#u;!(!this.#M(r)||((e||!this.#b(r))&&(yield r),r===this.#l));)r=this.#p[r]}#M(e){return e!==void 0&&this.#s.get(this.#n[e])===e}*entries(){for(let e of this.#I())this.#e[e]!==void 0&&this.#n[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#n[e],this.#e[e]])}*rentries(){for(let e of this.#C())this.#e[e]!==void 0&&this.#n[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#n[e],this.#e[e]])}*keys(){for(let e of this.#I()){let r=this.#n[e];r!==void 0&&!this.#o(this.#e[e])&&(yield r)}}*rkeys(){for(let e of this.#C()){let r=this.#n[e];r!==void 0&&!this.#o(this.#e[e])&&(yield r)}}*values(){for(let e of this.#I())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}*rvalues(){for(let e of this.#C())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,r={}){for(let n of this.#I()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;if(s!==void 0&&e(s,this.#n[n],this))return this.get(this.#n[n],r)}}forEach(e,r=this){for(let n of this.#I()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(r,s,this.#n[n],this)}}rforEach(e,r=this){for(let n of this.#C()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(r,s,this.#n[n],this)}}purgeStale(){let e=!1;for(let r of this.#C({allowStale:!0}))this.#b(r)&&(this.delete(this.#n[r]),e=!0);return e}info(e){let r=this.#s.get(e);if(r===void 0)return;let n=this.#e[r],o=this.#o(n)?n.__staleWhileFetching:n;if(o===void 0)return;let s={value:o};if(this.#y&&this.#x){let a=this.#y[r],c=this.#x[r];if(a&&c){let l=a-(vC.now()-c);s.ttl=l,s.start=Date.now()}}return this.#_&&(s.size=this.#_[r]),s}dump(){let e=[];for(let r of this.#I({allowStale:!0})){let n=this.#n[r],o=this.#e[r],s=this.#o(o)?o.__staleWhileFetching:o;if(s===void 0||n===void 0)continue;let a={value:s};if(this.#y&&this.#x){a.ttl=this.#y[r];let c=vC.now()-this.#x[r];a.start=Math.floor(Date.now()-c)}this.#_&&(a.size=this.#_[r]),e.unshift([n,a])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let o=Date.now()-n.start;n.start=vC.now()-o}this.set(r,n.value,n)}}set(e,r,n={}){if(r===void 0)return this.delete(e),this;let{ttl:o=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:l}=n,{noUpdateTTL:u=this.noUpdateTTL}=n,d=this.#O(e,r,n.size||0,c);if(this.maxEntrySize&&d>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),this.delete(e),this;let p=this.#a===0?void 0:this.#s.get(e);if(p===void 0)p=this.#a===0?this.#l:this.#v.length!==0?this.#v.pop():this.#a===this.#t?this.#A(!1):this.#a,this.#n[p]=e,this.#e[p]=r,this.#s.set(e,p),this.#p[this.#l]=p,this.#h[p]=this.#l,this.#l=p,this.#a++,this.#P(p,d,l),l&&(l.set="add"),u=!1;else{this.#R(p);let f=this.#e[p];if(r!==f){if(this.#E&&this.#o(f)){f.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:m}=f;m!==void 0&&!a&&(this.#S&&this.#d?.(m,e,"set"),this.#g&&this.#f?.push([m,e,"set"]))}else a||(this.#S&&this.#d?.(f,e,"set"),this.#g&&this.#f?.push([f,e,"set"]));if(this.#k(p),this.#P(p,d,l),this.#e[p]=r,l){l.set="replace";let m=f&&this.#o(f)?f.__staleWhileFetching:f;m!==void 0&&(l.oldValue=m)}}else l&&(l.set="update")}if(o!==0&&!this.#y&&this.#N(),this.#y&&(u||this.#L(p,o,s),l&&this.#T(l,p)),!a&&this.#g&&this.#f){let f=this.#f,m;for(;m=f?.shift();)this.#r?.(...m)}return this}pop(){try{for(;this.#a;){let e=this.#e[this.#u];if(this.#A(!0),this.#o(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#g&&this.#f){let e=this.#f,r;for(;r=e?.shift();)this.#r?.(...r)}}}#A(e){let r=this.#u,n=this.#n[r],o=this.#e[r];return this.#E&&this.#o(o)?o.__abortController.abort(new Error("evicted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,n,"evict"),this.#g&&this.#f?.push([o,n,"evict"])),this.#k(r),e&&(this.#n[r]=void 0,this.#e[r]=void 0,this.#v.push(r)),this.#a===1?(this.#u=this.#l=0,this.#v.length=0):this.#u=this.#p[r],this.#s.delete(n),this.#a--,r}has(e,r={}){let{updateAgeOnHas:n=this.updateAgeOnHas,status:o}=r,s=this.#s.get(e);if(s!==void 0){let a=this.#e[s];if(this.#o(a)&&a.__staleWhileFetching===void 0)return!1;if(this.#b(s))o&&(o.has="stale",this.#T(o,s));else return n&&this.#w(s),o&&(o.has="hit",this.#T(o,s)),!0}else o&&(o.has="miss");return!1}peek(e,r={}){let{allowStale:n=this.allowStale}=r,o=this.#s.get(e);if(o===void 0||!n&&this.#b(o))return;let s=this.#e[o];return this.#o(s)?s.__staleWhileFetching:s}#D(e,r,n,o){let s=r===void 0?void 0:this.#e[r];if(this.#o(s))return s;let a=new R6,{signal:c}=n;c?.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});let l={signal:a.signal,options:n,context:o},u=(g,v=!1)=>{let{aborted:b}=a.signal,_=n.ignoreFetchAbort&&g!==void 0;if(n.status&&(b&&!v?(n.status.fetchAborted=!0,n.status.fetchError=a.signal.reason,_&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),b&&!_&&!v)return p(a.signal.reason);let x=m;return this.#e[r]===m&&(g===void 0?x.__staleWhileFetching?this.#e[r]=x.__staleWhileFetching:this.delete(e):(n.status&&(n.status.fetchUpdated=!0),this.set(e,g,l.options))),g},d=g=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=g),p(g)),p=g=>{let{aborted:v}=a.signal,b=v&&n.allowStaleOnFetchAbort,_=b||n.allowStaleOnFetchRejection,x=_||n.noDeleteOnFetchRejection,S=m;if(this.#e[r]===m&&(!x||S.__staleWhileFetching===void 0?this.delete(e):b||(this.#e[r]=S.__staleWhileFetching)),_)return n.status&&S.__staleWhileFetching!==void 0&&(n.status.returnedStale=!0),S.__staleWhileFetching;if(S.__returned===S)throw g},f=(g,v)=>{let b=this.#c?.(e,s,l);b&&b instanceof Promise&&b.then(_=>g(_===void 0?void 0:_),v),a.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(g(void 0),n.allowStaleOnFetchAbort&&(g=_=>u(_,!0)))})};n.status&&(n.status.fetchDispatched=!0);let m=new Promise(f).then(u,d),h=Object.assign(m,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return r===void 0?(this.set(e,h,{...l.options,status:void 0}),r=this.#s.get(e)):this.#e[r]=h,h}#o(e){if(!this.#E)return!1;let r=e;return!!r&&r instanceof Promise&&r.hasOwnProperty("__staleWhileFetching")&&r.__abortController instanceof R6}async fetch(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:l=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:p=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:m=this.ignoreFetchAbort,allowStaleOnFetchAbort:h=this.allowStaleOnFetchAbort,context:g,forceRefresh:v=!1,status:b,signal:_}=r;if(!this.#E)return b&&(b.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:s,status:b});let x={allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:l,sizeCalculation:u,noUpdateTTL:d,noDeleteOnFetchRejection:p,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:h,ignoreFetchAbort:m,status:b,signal:_},S=this.#s.get(e);if(S===void 0){b&&(b.fetch="miss");let I=this.#D(e,S,x,g);return I.__returned=I}else{let I=this.#e[S];if(this.#o(I)){let F=n&&I.__staleWhileFetching!==void 0;return b&&(b.fetch="inflight",F&&(b.returnedStale=!0)),F?I.__staleWhileFetching:I.__returned=I}let w=this.#b(S);if(!v&&!w)return b&&(b.fetch="hit"),this.#R(S),o&&this.#w(S),b&&this.#T(b,S),I;let k=this.#D(e,S,x,g),H=k.__staleWhileFetching!==void 0&&n;return b&&(b.fetch=w?"stale":"refresh",H&&w&&(b.returnedStale=!0)),H?k.__staleWhileFetching:k.__returned=k}}get(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=r,c=this.#s.get(e);if(c!==void 0){let l=this.#e[c],u=this.#o(l);return a&&this.#T(a,c),this.#b(c)?(a&&(a.get="stale"),u?(a&&n&&l.__staleWhileFetching!==void 0&&(a.returnedStale=!0),n?l.__staleWhileFetching:void 0):(s||this.delete(e),a&&n&&(a.returnedStale=!0),n?l:void 0)):(a&&(a.get="hit"),u?l.__staleWhileFetching:(this.#R(c),o&&this.#w(c),l))}else a&&(a.get="miss")}#F(e,r){this.#h[r]=e,this.#p[e]=r}#R(e){e!==this.#l&&(e===this.#u?this.#u=this.#p[e]:this.#F(this.#h[e],this.#p[e]),this.#F(this.#l,e),this.#l=e)}delete(e){let r=!1;if(this.#a!==0){let n=this.#s.get(e);if(n!==void 0)if(r=!0,this.#a===1)this.clear();else{this.#k(n);let o=this.#e[n];if(this.#o(o)?o.__abortController.abort(new Error("deleted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,e,"delete"),this.#g&&this.#f?.push([o,e,"delete"])),this.#s.delete(e),this.#n[n]=void 0,this.#e[n]=void 0,n===this.#l)this.#l=this.#h[n];else if(n===this.#u)this.#u=this.#p[n];else{let s=this.#h[n];this.#p[s]=this.#p[n];let a=this.#p[n];this.#h[a]=this.#h[n]}this.#a--,this.#v.push(n)}}if(this.#g&&this.#f?.length){let n=this.#f,o;for(;o=n?.shift();)this.#r?.(...o)}return r}clear(){for(let e of this.#C({allowStale:!0})){let r=this.#e[e];if(this.#o(r))r.__abortController.abort(new Error("deleted"));else{let n=this.#n[e];this.#S&&this.#d?.(r,n,"delete"),this.#g&&this.#f?.push([r,n,"delete"])}}if(this.#s.clear(),this.#e.fill(void 0),this.#n.fill(void 0),this.#y&&this.#x&&(this.#y.fill(0),this.#x.fill(0)),this.#_&&this.#_.fill(0),this.#u=0,this.#l=0,this.#v.length=0,this.#m=0,this.#a=0,this.#g&&this.#f){let e=this.#f,r;for(;r=e?.shift();)this.#r?.(...r)}}};var bC=class extends Oe{constructor(r,n,o,s){super();this.path=r;this.version=n;this.options=o;this.fileSystem=s;this._cache=new P6(this.options),this._delayer=typeof o.autoWriteDelay=="number"?this._register(new Jg(o.autoWriteDelay)):void 0}dispose(){super.dispose(),this._delayer=void 0}async initialize(){if(!this.path)return;let r;try{r=await this.fileSystem.readFile(this.path)}catch{return}try{let n=new TextDecoder().decode(r),o=JSON.parse(n);o.version===this.version&&this._cache.load(o.data)}catch(n){console.error(`Failed to load LRU cache at ${this.path}`,n)}}async get(r){return this._cache.get(await this.toKey(r))}async set(r,n){this._cache.set(await this.toKey(r),n),this._delayer?.trigger(()=>this.save()).catch(o=>{if(!(o instanceof dn))throw o})}async save(){if(!this.path)return;let r=JSON.stringify({version:this.version,data:this._cache.dump()});await this.fileSystem.writeFile(this.path,new TextEncoder().encode(r))}async toKey(r){let o=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(s)).map(l=>l.toString(16).padStart(2,"0")).join("")}};bC=E([y(3,mr)],bC);var _C=class extends Oe{constructor(r,n,o,s,a,c,l){super();this._embeddingEndpoint=r;this._embeddingsComputer=c;this._logService=l;this._isDisposed=!1;this._embeddingsCache=new qn(async()=>{let u=a.storageUri,d=u?He.joinPath(u,`${n}-${r.endpoint.model}${r.dimensions??""}.json`):void 0,p=this._register(s.createInstance(bC,d,o,{max:5e3,autoWriteDelay:5e3}));return await p.initialize(),p})}dispose(){this._isDisposed=!0,super.dispose()}async computeEmbeddings(r,n){let o=this._embeddingEndpoint.endpoint.model,s=await this._embeddingsCache.value;if(this._isDisposed)return{model:o,embeddings:[]};let a=new Array(r.length),c=[];for(let[l,u]of r.entries()){let d=await s.get(u);d?a[l]=d:c.push({index:l,value:u})}if(c.length>0){let l=await this.computeEmbeddingsWithRetry(c.map(u=>u.value),n);for(let u=0;u<c.length;u++){if(this._isDisposed)return{model:o,embeddings:[]};let d=c[u],p=l.embeddings[u];if(typeof p>"u")throw new Error("Error computing embedding");a[d.index]=p,await s.set(d.value,p)}}return{model:o,embeddings:a}}async computeEmbeddingsWithRetry(r,n){let s=0,a;for(;s<3;)try{if(a=await this._embeddingsComputer.computeEmbeddings(this._embeddingEndpoint.endpoint,r,{parallelism:2,dimensions:this._embeddingEndpoint.dimensions},n),!a)throw new Error("Failed to compute embeddings");return a}catch(c){if(s++,s===3)throw c;if(n.isCancellationRequested)throw new Error("Cancelled computing embeddings");this._logService.public.warn(`Error computing embeddings. Retrying in ${s} seconds. Error: ${c}`),await new Promise(l=>setTimeout(l,1e3*s))}throw new Error("Failed to compute embeddings")}};_C=E([y(3,j),y(4,Bt),y(5,oa),y(6,ie)],_C);var jWe="1.0.9",VWe="workspaceEmbeddingsCache",HWe=500,Jm=class extends Oe{constructor(r,n,o,s,a,c,l,u){super();this.tokenizationEndpoint=r;this._logService=o;this._configurationService=s;this._endpointProvider=a;this._experimentationService=c;this._workspaceIndex=l;this._workspaceService=u;this.shouldSearchTimeout=!0;this._chunksEndpointEmbeddingComputer=this._register(n.createInstance(V_)),this._embeddingsComputer=new qn(async()=>{let d=this.getEmbeddingsEndpoint(),p=await this._endpointProvider.getEmbeddingsEndpoint(d.family);return this._register(n.createInstance(_C,{endpoint:p,dimensions:d.dimensions},VWe,jWe))}),this.tryPreInit()}static{this._MAX_EMBEDDINGS_COMPUTATION_TIME=1e4}static{this._MAX_CHUNK_LENGTH=2e3}get fileSystemFileCount(){return this._workspaceIndex.fileSystemFileCount}getEmbeddingsEndpoint(){switch(this._experimentationService.getTreatmentVariable("vscode","workspace.embeddingsEndpointFamily")){case"ada":return{family:"ada"};case"text3small":default:return{family:"text3small",dimensions:512}}}initialize(){return this._initializePromise??=this._workspaceIndex.initialize(),this._initializePromise}async triggerIndexing(r){let n=await this.getChunksToSearch(r);if(r.isCancellationRequested)return;let o=await this._embeddingsComputer.value;if(r.isCancellationRequested)return;let{embeddings:s}=await o.computeEmbeddings(n.map(a=>this.chunkToIndexString(a)),r);this._logService.internal.debug(`Indexed ${s.length} chunks`)}async searchAllChunks(r,n,o){if(this._chunksEndpointEmbeddingComputer.isAvailable()){let a=await this.searchAllChunksUsingEndpoint(r,n,o);if(a)return a;if(o.isCancellationRequested)return[]}let s=await this.getChunksToSearch(o);return o.isCancellationRequested?[]:this.rankChunks(r,s,n,o)}async searchAllChunksUsingEndpoint(r,n,o){return this._chunksEndpointEmbeddingComputer.searchChunks(r,n,o)}async rankChunks(r,n,o,s){if(!n.length)return[];let a=[r,...n.map(p=>this.chunkToIndexString(p))],c=await this.computeEmbeddings(a,s);if(s.isCancellationRequested||!c)return[];if(c.embeddings.length<1)throw new Error("Invalid response");let[l,...u]=c.embeddings,d=u.map((p,f)=>[n[f],p]);return oK(c.model,l,d,o)}async getChunksToSearch(r){let n=(await Promise.all(Array.from(this._workspaceIndex.values(),o=>o.getSemanticChunks(this.tokenizationEndpoint,void 0,r)))).flat();return r.isCancellationRequested?[]:n.filter(o=>o.text.length<Jm._MAX_CHUNK_LENGTH)}async computeEmbeddings(r,n){let o=await this._embeddingsComputer.value;if(n.isCancellationRequested)return;let s=this.shouldSearchTimeout?await v_(o.computeEmbeddings(r,n),Jm._MAX_EMBEDDINGS_COMPUTATION_TIME):await o.computeEmbeddings(r,n);if(!n.isCancellationRequested){if(!s)throw new Error("Timeout computing embeddings");return s}}chunkToIndexString(r){let n=vI(this._workspaceService,r.file);return this.toStringForEmbeddingsComputer(r,n)}async tryPreInit(){if(!this._configurationService.getExperimentBasedConfig(le.WorkspacePreInitEmbeddings,this._experimentationService))return!1;let n=new Uo;try{await v_((async()=>{let s=new Fo;if(this._logService.public.debug("Trying to preload workspace embeddings"),await this._workspaceIndex.preLoadWorkspaceFiles(HWe,n.token),n.token.isCancellationRequested){this._logService.public.debug("Preload indexing cancelled");return}this._logService.public.debug(`Preloaded ${this._workspaceIndex.fileSystemFileCount} files. Preload elapsed time: ${s.elapsed()}ms`),this._logService.public.debug(`Preloading trying to pre-compute embeddings for ${Array.from(this._workspaceIndex.values()).length} files`);let a=await this.getChunksToSearch(n.token);if(n.token.isCancellationRequested){this._logService.public.debug("Preload embedding compute cancelled");return}this._logService.public.debug(`Preloaded completed for ${a.length} chunks. Total preload time: ${s.elapsed()}ms`)})(),1e4,()=>(this._logService.public.debug("Preload timed out"),n.cancel()))}catch{}finally{n.dispose()}}toStringForEmbeddingsComputer(r,n){return`File: \`${n}\`
${Si(S5(r.file),r.text)}`}};Jm=E([y(1,j),y(2,ie),y(3,he),y(4,xe),y(5,Lt),y(6,vc),y(7,qe)],Jm);var V_=class extends Oe{constructor(r,n,o,s,a,c,l,u,d,p){super();this._authService=r;this._configurationService=n;this._domainService=o;this._envService=s;this._experimentationService=a;this._fetcherService=c;this._telemetryService=u;this._workspaceIndex=p;let f=d.storageUri,m=f?He.joinPath(f,V_.cacheFileName):void 0;this._cache=Zm.load(m,p,l).then(h=>this._register(h))}static{this.cacheFileName="workspace-chunks.json"}isAvailable(){return this._configurationService.getConfig(le.WorkspaceUseChunksEndpoint)||(this._experimentationService.getTreatmentVariable("vscode","workspace.useChunksEndpoint")??!1)}async searchChunks(r,n,o){let s=new fp(6),a;try{a=await Promise.all([s.queue(()=>this.computeChunksAndEmbeddings(He.parse("prompt:///query.txt"),r,o)),...Array.from(this._workspaceIndex.values(),u=>s.queue(()=>this.getChunksAndEmbeddings(u,o)))])}finally{s.dispose()}if(o.isCancellationRequested||a.length<=1)return;let c=a[0][0].embedding,l=a.slice(1).flat();return oK("text-embedding-3-small",c,l.map(u=>[u.chunk,u.embedding]),n)}async getChunksAndEmbeddings(r,n){let o=await this._cache,s=await o.get(r);if(n.isCancellationRequested)return[];if(s)return s;let a=await r.getText(n);if(n.isCancellationRequested)return[];let c=await this.computeChunksAndEmbeddings(r.uri,a,n);return o.update(r,c),c}async computeChunksAndEmbeddings(r,n,o){if(Q1(n))return[];let s=(await this._authService.getPermissiveGitHubSession({createIfNone:!0}))?.accessToken;if(!s||o.isCancellationRequested)return[];try{let a=this._domainService.chunksURL,c=await Hv(this._fetcherService,this._envService,this._telemetryService,this._domainService,a,s,await ul(process.env.HMAC_SECRET),"copilot-panel","",{content:n,path:r.fsPath,embed:!0},o);if(o.isCancellationRequested)return[];if(!c.ok)return console.log("Error chunking",r.toString(),c.status,c.statusText,await c.text()),[];let l=await c.json();if(o.isCancellationRequested||!l.chunks.length)return[];let u=hC.create(r.toString(),"",0,n);return l.chunks.map(d=>{let p=u.positionAt(d.range.start),f=u.positionAt(d.range.end),m=new je(p.line,p.character,f.line,f.character);return{chunk:{file:r,text:d.text,range:m,sources:[]},embedding:d.embedding?.embedding||[]}})}catch(a){console.log(a)}return[]}};V_=E([y(0,Tt),y(1,he),y(2,en),y(3,gt),y(4,Lt),y(5,Kr),y(6,mr),y(7,ge),y(8,Bt),y(9,vc)],V_);var Zm=class extends Oe{constructor(r,n,o){super();this.cachePath=r;this._workspaceIndex=n;this.fileSystem=o;this._cache=new Nr;this._writeDelayer=this._register(new Jg(5e3));let s=a=>this._cache.delete(a);this._register(this._workspaceIndex.onDidChangeFile(s)),this._register(this._workspaceIndex.onDidDeleteFile(s))}static{this.version="1.0.0"}static async load(r,n,o){let s=new Zm(r,n,o);if(r){await n.initialize();let a;try{a=await o.readFile(r)}catch{}if(a)try{let c=JSON.parse(new TextDecoder().decode(a));if(c.version===Zm.version)for(let[l,u]of Object.entries(c.entries)){let d=He.parse(l);n.get(d)&&s._cache.set(d,{hash:Promise.resolve(u.hash),entries:u.entries.map(p=>({embedding:p.embedding,chunk:{file:d,text:p.text,range:je.lift(p.range),sources:[]}}))})}}catch(c){console.error(c)}}return s}async get(r){let n=await this.getHash(r),o=this._cache.get(r.uri);if(!(!o||await o.hash!==n))return o.entries}update(r,n){this._cache.set(r.uri,{hash:this.getHash(r),entries:n}),this._writeDelayer.trigger(()=>this.save())}async getHash(r){let n=await r.getText(Wt.None);return await gC(n)}async save(){if(!this.cachePath)return;let r={};for(let[o,s]of this._cache)r[o.toString()]={hash:await s.hash,entries:s.entries.map(a=>({text:a.chunk.text,range:a.chunk.range.toJSON(),embedding:a.embedding}))};let n={version:Zm.version,entries:r};await this.fileSystem.writeFile(this.cachePath,new TextEncoder().encode(JSON.stringify(n)))}};Zm=E([y(1,vc),y(2,mr)],Zm);var eh=class extends Oe{constructor(r,n,o,s,a){super();this.instantiationService=n;this._logService=o;this._experimentationService=s;this._telemetryService=a;this.id="ada";this.timeout=5e3;this._state=0;this._disposeCts=this._register(new Uo);this._embeddingsIndex=this.instantiationService.createInstance(Jm,{family:"gpt-4"}),r&&(this._embeddingsIndex.shouldSearchTimeout=!1)}static{this.defaultFileCap=200}async searchFileChunks(r,n,o,s,a){let[c]=await Promise.all([n.resolveQuery(a),this.initialize()]);return a.isCancellationRequested?{chunks:[]}:this._state!==1&&this._state!==2?{chunks:[]}:(this._logService.internal.debug("Fetching related workspace chunks in repository..."),{chunks:await this._embeddingsIndex.searchAllChunks(c,o,a)})}async isAvailable(){return await this.initialize(),this._state===2}async initialize(){this._init??=(async()=>{if(await this._embeddingsIndex.initialize(),this._disposeCts.token.isCancellationRequested)return;let r=this._experimentationService.getTreatmentVariable("vscode","workspace.embeddingsCacheFileCap")??eh.defaultFileCap;if(this._disposeCts.token.isCancellationRequested)return;if(this._embeddingsIndex.fileSystemFileCount>r){this._state=3;return}this._state=1,this.triggerIndexing()})(),await this._init}triggerIndexing(){this._indexingPromise??=(async()=>{this._logService.internal.debug("Starting indexing");try{await this._embeddingsIndex.triggerIndexing(this._disposeCts.token),this._state=2,this._logService.internal.debug("Workspace Chunk Embeddings Index initialized.")}catch(r){this._logService.internal.warn(`Failed to index workspace: ${r}`),this._indexingPromise=void 0}})()}rankChunks(r,n,o,s){return this._embeddingsIndex.rankChunks(r,n,o,s)}};E([Vo(r=>r._logService,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("embeddingsChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],eh.prototype,"searchFileChunks",1),eh=E([y(1,j),y(2,ie),y(3,Lt),y(4,ge)],eh);var Z0e=q(require("path"));var J0e=require("worker_threads"),pQ=class{constructor(e,r){this.handlers=new Map;this.nextId=1;this.worker=new J0e.Worker(e,r),this.worker.on("message",({id:n,err:o,res:s})=>{let a=this.handlers.get(n);a&&(this.handlers.delete(n),o?a.reject(o):a.resolve(s))}),this.worker.on("error",n=>this.handleError(n)),this.worker.on("exit",n=>{n!==0&&this.handleError(new Error(`Worker thread exited with code ${n}.`))})}terminate(){this.worker.removeAllListeners(),this.worker.terminate(),this.handlers.clear()}handleError(e){for(let r of this.handlers.values())r.reject(e);this.handlers.clear()}remoteCall(e,r){let n=this.nextId++,o,s,a=new Promise((c,l)=>{o=c,s=l});return this.handlers.set(n,{resolve:o,reject:s}),this.worker.postMessage({id:n,fn:e,args:r}),a}},zv=class{constructor(e,r){this.worker=new pQ(e,r);let n={get:(o,s)=>(typeof s=="string"&&!o[s]&&(o[s]=(...a)=>{if(!this.worker)throw new Error("Worker was terminated!");return this.worker.remoteCall(s,a)}),o[s])};this.proxy=new Proxy(Object.create(null),n)}terminate(){this.worker.terminate()}};function sD(t,e){if(!t)return t;if(Array.isArray(t))return t.map(r=>sD(r,e));if(typeof t=="object"){let r=e(t);if(r)return r;let n={};for(let o in t)n[o]=sD(t[o],e);return n}return t}var GWe=Z0e.default.join(__dirname,"tfidfWorker.js"),$v=class extends Oe{constructor(r,n,o,s){super();this._logService=n;this._telemetryService=o;this._workspaceIndex=s;this.id="tfidf";this.timeout=500;this._isDisposed=!1;this._tfIdfWorker=new qn(()=>new zv(GWe,{name:"TfIdf Worker",workerData:{endpoint:r}}));let a=c=>{let l=this._workspaceIndex.get(c);l&&this.addOrUpdateTfidfEntries([l])};this._register(this._workspaceIndex.onDidCreateFile(a)),this._register(this._workspaceIndex.onDidChangeFile(a)),this._register(this._workspaceIndex.onDidDeleteFile(c=>{this._isDisposed||this._tfIdfWorker.value.proxy.delete(c)}))}dispose(){this._isDisposed=!0,super.dispose(),this._tfIdfWorker.rawValue?.terminate()}initialize(){return this._initializePromise??=this._initializeWorkspaceFiles(),this._initializePromise}async searchFileChunks(r,n,o,s){let[a,c]=await Promise.all([this.initialize(),r.resolveQueryAndKeywords(s)]);if(s.isCancellationRequested||this._isDisposed||!c)return{chunks:[]};let l=c.keywords.flatMap(d=>[d.keyword,...d.variations]),u=await Ym(this._logService,"search",()=>ka(this._tfIdfWorker.value.proxy.search([l.length?l.join(", "):c.rephrasedQuery],{maxResults:n,include:o.include,maxSpread:.75}),s),(d,p)=>{this._telemetryService.sendMSFTTelemetryEvent("tfIdfChunkSearch.perf.tfidfSearch",{status:s.isCancellationRequested?"cancelled":p},{execTime:d})});return{chunks:$We(u)}}async isAvailable(){return await this.initialize(),!0}async _initializeWorkspaceFiles(){await Ym(this._logService,"initialize workspaceIndex",()=>this._workspaceIndex.initialize()),!this._isDisposed&&await Ym(this._logService,"initialize tfidf",()=>this.addOrUpdateTfidfEntries(this._workspaceIndex.values()),(r,n)=>{this._telemetryService.sendMSFTTelemetryEvent("tfidfChunkSearch.perf.initializeTfidf",{status:n},{execTime:r,fileSystemFileCount:this._workspaceIndex.fileSystemFileCount})})}async addOrUpdateTfidfEntries(r){if(this._isDisposed)return;let n=new fp(20),o;try{o=await Promise.all(Array.from(r,s=>n.queue(async()=>({uri:s.uri,content:await s.getText(Wt.None)}))))}finally{n.dispose()}this._isDisposed||this._tfIdfWorker.value.proxy.addOrUpdate(zWe(o))}};E([Vo(r=>r._logService)],$v.prototype,"initialize",1),E([Vo(r=>r._logService,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("tfIdfChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],$v.prototype,"searchFileChunks",1),$v=E([y(1,ie),y(2,ge),y(3,vc)],$v);function zWe(t){return sD(t,e=>{if(He.isUri(e))return{$mid:"uri",...e};if(e instanceof je)return{startLineNumber:e.startLineNumber,startColumn:e.startColumn,endLineNumber:e.endLineNumber,endColumn:e.endColumn}})}function $We(t){return sD(t,e=>{if(e.$mid==="range")return new je(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);if(e.$mid==="uri")return He.revive(e)})}var H_=class extends Oe{constructor(r,n,o,s){super();this._logService=r;this.instantiationService=n;this._telemetryService=o;this._experimentationService=s;this.id="tfidf";this.timeout=500;this._tfidf=this._register(n.createInstance($v,{family:"gpt-4"}))}async _shouldUseRangedChunks(){return await this._experimentationService.getTreatmentVariableAsync("vscode","copilotchat.hasRangedSemanticChunksForTFIDF")??!1}async searchFileChunks(r,n,o,s,a){this._logService.internal.debug("Performing full workspace search for chunks...");let l=(await this._tfidf.searchFileChunks(n,o*2,s,a)).chunks;if(a.isCancellationRequested||!l.length)return{chunks:[]};let u=await this._shouldUseRangedChunks(),d=await Ym(this._logService,"toSemanticChunks",()=>this.instantiationService.invokeFunction(p=>E6(p,r,l,{shouldUseRangedChunks:u},a)));return a.isCancellationRequested||!d.length?{chunks:[]}:{chunks:d}}isAvailable(){return this._tfidf.isAvailable()}};E([Vo(r=>r._logService,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("tfIdfWithSemanticChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],H_.prototype,"_shouldUseRangedChunks",1),H_=E([y(0,ie),y(1,j),y(2,ge),y(3,Lt)],H_);var Kv=ne("IWorkspaceChunkSearch"),Wv=class extends Oe{constructor(r,n,o,s,a,c,l){super();this._chatFetcher=n;this._configurationService=o;this._ignoreService=s;this._logService=a;this._simulationTestContext=c;this._telemetryService=l;this._embeddingsChunkSearch=this._register(r.createInstance(eh,this._simulationTestContext.isInSimulationTests)),this._codeSearchChunkSearch=this._register(r.createInstance(jv)),this._tfIdfWithSemanticChunkSearch=this._register(r.createInstance(H_))}async searchFileChunks(r,n,o,s,a,c){let l=new Fo,u=await this.getStrategies();if(c.isCancellationRequested)return[];let d=u.map(x=>nW(async S=>{let I=await x.searchFileChunks(r,n,o,s,S);return{chunks:I.chunks.map(w=>({...w,strategy:x.id})),strategy:x.id,couldBeOutdated:I.couldBeOutdated}}));c.onCancellationRequested(()=>d.forEach(x=>x.cancel()));for(let x of d)x.then(S=>{for(let I=0;I<d.length;I++)S.strategy==="ada"||this.isUpToDateCodesearchResult(S)?d[I].cancel():v_(d[I].catch(()=>{}),u[I].timeout,()=>{d[I].cancel(),this._logService.internal.warn(`WorkspaceChunkSearch strategy ${u[I].id} timed out`)})},()=>{});let p=await ka(Promise.allSettled(d),c);if(c.isCancellationRequested||!p)return[];let f=[],m;for(let x=0;x<p.length;x++){let S=p[x],I=u[x];if(S.status==="fulfilled"){(!m||S.value.strategy==="ada"||this.isUpToDateCodesearchResult(S.value))&&(m=S.value.strategy),f.push(S.value);continue}this._logService.public.debug(`Strategy, ${I.id}, failed with the following error: ${hM(S.reason)}`)}this._logService.internal.debug(`'${m}' was the top working workspace chunk search strategy`),this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearchStrategy",{strategy:m??"none",allAttemptedStrategies:u.map(x=>x.id).join(","),allSuccessfulStrategies:p.filter(x=>x.status==="fulfilled").map(x=>x.value.strategy).join(",")},{execTime:l.elapsed()});let h=await this.filterIgnoredResults(f);if(this._simulationTestContext.isInSimulationTests&&!h.some(x=>x.chunks.length>0))throw new Error("No chunks returned");function g(x){return JSON.stringify(x.map(S=>({strategy:S.strategy,text:S.text})),null,2)}let v=async(x,S)=>{this._simulationTestContext.isInSimulationTests&&await this._simulationTestContext.writeFile(x+".txt",g(S),x)},b=h.flatMap(x=>x.chunks);if(v("workspace-chunk-search-pre-rerank",b),s.skipRerank)return b;let _=await this.rerankChunks(r,n,h,o,a,c);return v("workspace-chunk-search-post-rerank",_),_}async filterIgnoredResults(r){return Promise.all(r.map(async n=>({...n,chunks:Dr(await Promise.all(n.chunks.map(async o=>await this._ignoreService.isCopilotIgnored(o.file)?null:o)))})))}async rerankChunks(r,n,o,s,a,c){let l=o.find(p=>p.strategy==="ada");if(l)return l.chunks.slice(0,s);let u=o.flatMap(p=>p.chunks),d=o.find(p=>this.isUpToDateCodesearchResult(p));return d&&(u=d.chunks),u.length?(a?.report(new xi(eye.t("Filtering to most relevant information"))),this._configurationService.getConfig(le.WorkspaceRerankStrategy)==="model"?this.sortChunksUsingModel(r,n,u,s,c):this.rerankChunksUsingAda(n,o,s,c)):[]}async rerankChunksUsingAda(r,n,o,s){try{let a=await r.resolveQuery(s);if(!a||s.isCancellationRequested)return[];let c=n.flatMap(d=>d.chunks.map(p=>({...p,strategy:d.strategy}))).map((d,p)=>({...d,index:p})),l=await this._embeddingsChunkSearch.rankChunks(a,c,o,s),u=l.filter(d=>d.index<o).length;return this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearch.adaRerank",{allStrategies:n.filter(d=>d.chunks.length).map(d=>d.strategy).join(","),topChunkInitialIndices:l.map(d=>d.index).join(","),topChunkStrategies:l.map(d=>d.strategy).join(",")},{originalChunkCount:c.length,maxResultCount:o,originalTopInTopAfterRerank:u/o}),l}catch(a){return this._logService.public.error(a,"Failed to search chunk embeddings index"),n.flatMap(c=>c.chunks).slice(0,o)}}async sortChunksUsingModel(r,n,o,s,a){let c=await n.resolveQueryAndKeywords(a);if(!c||a.isCancellationRequested)return[];let l=[];for(let u=0;u<o.length;u+=s){let d=o.slice(u,u+s),p=[...l,...d];afe(p);let f=await this._chatFetcher.fetchOne("sortChunksUsingModel",[{role:"system",content:`
The user will provide you with question and a numbered list of code snippets.
You are to sort the code snippets by most to least helpful in answering the question.
If a code snippet is not related to the question in possible any way, you may opt not to include it in the list.
Return an ordered list of snippet numbers.
Only return snippet numbers.
Do not explain.
				`.trim()},{role:"user",content:`
Question: ${c.rephrasedQuery}

${p.map((h,g)=>`# Snippet ${g}
 ${Si("",h.text)}`).join(`

`)}
					`.trim()}],void 0,a,2,r);if(a.isCancellationRequested)return[];if(f.type!=="success"){console.warn("Model re-rank failed");continue}let m=new Set(Array.from(f.value.matchAll(/\d+/g),h=>parseInt(h[0])));l=Dr(Array.from(m).map(h=>p.at(h))).slice(0,s)}return l}async getStrategies(){let r=new Array;return await this._codeSearchChunkSearch.isAvailable()&&r.push(this._codeSearchChunkSearch),await this._embeddingsChunkSearch.isAvailable()&&r.push(this._embeddingsChunkSearch),r.push(this._tfIdfWithSemanticChunkSearch),this._logService.internal.debug(`Using ${r.map(n=>n.id).join(", ")} for chunk search`),r}isUpToDateCodesearchResult(r){return r.strategy==="codesearch"&&r.chunks.length>0&&r.couldBeOutdated===!1}};E([Vo(r=>r._logService,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],Wv.prototype,"searchFileChunks",1),E([Vo(r=>r._logService),eD(function(r,n){this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearch.perf.adaRerank",{status:n},{execTime:r})})],Wv.prototype,"rerankChunksUsingAda",1),Wv=E([y(0,j),y(1,yt),y(2,he),y(3,Te),y(4,ie),y(5,Uv),y(6,ge)],Wv);var xC=q(Ue());var iye=q(Ue());function tye(t){return t.reduce((r,n)=>r+n.value.length,0)+Math.max(0,t.length-1)}async function KWe(t,e=1/0,r){let n=rye(0,t,e),o=e-tye(n);for(;;){let s=!1,a=[];for(let c of n)if(c.type==="text")a.push(c);else if(c.type==="dir"){a.push({type:"text",value:c.value});let l=await c.getChildren();if(r?.isCancellationRequested)return"";let u=rye(c.level+1,l,o-1);u.length&&(s=!0,o-=tye(u)+1,a.push(...u))}if(n=a,!s)break}return n.map(s=>s.value).join(`
`)}function rye(t,e,r){let n="	".repeat(t),o=[],s=r;for(let a=0;a<e.length;++a){let c=e[a],l=n+c.name+(c.type===2?"/":"");if(l.length>s){let u=n+"...";for(;u.length>s&&o.length>0;)s+=o.pop().value.length+1;u.length<=s&&o.push({type:"text",value:u});break}c.type===2?o.push({type:"dir",level:t,value:l,getChildren:c.getChildren}):o.push({type:"text",value:l}),s-=l.length,a!==e.length-1&&(s-=1)}return o}async function nye(t,e,r,n){let o=t.get(mr),s=t.get(Te);async function a(l){let u;try{u=await o.readDirectory(l)}catch{return[]}return n?.isCancellationRequested?[]:(u.sort((d,p)=>d[0].localeCompare(p[0])),Promise.all(u.map(async d=>{let p=He.joinPath(l,d[0]);return await j_(t,p)?d:null})).then(d=>d.filter(p=>p!==null).map(p=>p[1]===2?{type:2,name:p[0],getChildren:()=>a(He.joinPath(l,p[0]))}:{type:1,name:p[0]})))}if(await s.init(),n?.isCancellationRequested)return"";let c=await a(e);return n?.isCancellationRequested?"":KWe(c,r,n)}var vs=class extends iye.PromptElement{constructor(r,n,o){super(r);this.accessor=n;this.workspaceService=o}async prepare(r,n,o){let s=this.workspaceService.getWorkspaceFolders().at(0);if(s)return nye(this.accessor,s,this.props.maxSize,o)}render(r,n){if(r)return vscpp(vscppf,null,"I am working in a workspace that has the following structure:",vscpp("br",null),vscpp("br",null),Si("",r))}};vs=E([y(1,Rt),y(2,qe)],vs);var fQ=class extends xC.PromptElement{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(It,{priority:500,history:this.props.history}),vscpp(xC.SystemMessage,{priority:1e3},"You are a coding assistant who help the user answer questions about code in their workspace by providing a list of relevant keywords they can search for to answer the question.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null),"Respond in Markdown. First under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"Then under a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what is refers to by looking at the rest of the question, the user's active selection, and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question by only changing ambiguous pronouns and words like 'this'.",vscpp("br",null),"5. Then after a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that user could try searching for to answer their question. These keywords could used as file name, symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"6. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"# Keywords",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders"),vscpp(bn,{flexGrow:1,priority:600,document:this.props.document,range:this.props.selection}),vscpp(xC.UserMessage,{priority:700},vscpp(vs,{maxSize:1e3})),vscpp(Mr,{flexGrow:2,priority:1e3,chatVariables:this.props.chatVariables,query:this.props.query}))}};async function oye(t,{query:e,history:r,chatVariables:n},o){let s=t.get(Ft).activeTextEditor;return Me.create(t.get(j),o,fQ,{chatVariables:n,query:e,history:r,document:s?.document,selection:s?.selection}).render()}var YWe=/^[\*\-]\s*(.+)/m;function sye(t,e){let r=e.match(/#+\s*Question\n(?<question>.+?)#+\s*Keywords\n(?<keywords>.+)/si);if(!r?.groups)return{rephrasedQuestion:t.trim(),keywords:[]};let n=[];for(let o of r.groups.keywords.trim().split(`
`)){let s=o.match(YWe);if(s){let a=s[1].split(/,/g).map(c=>c.trim());a.length&&n.unshift({keyword:a[0],variations:a.slice(1)})}}return{rephrasedQuestion:r.groups.question.trim(),keywords:n}}var th=class extends Qv.PromptElement{constructor(r,n,o,s,a,c,l){super(r);this.accessor=n;this.logService=o;this.telemetryService=s;this.workspaceChunkSearch=a;this.workspaceService=c;this.endpointProvider=l}async prepare(r,n,o=Wt.None){let s=await Z2(this.accessor,{valueFor4096:4,maxMultiplier:4});if(o.isCancellationRequested)return;let a=await this.endpointProvider.getChatEndpoint("gpt-4o-mini");n?.report(new xi(mQ.t("Collecting workspace information")));let c=(await this.workspaceChunkSearch.searchFileChunks(a,this.props.query,this.props.maxResults??s,{include:this.props.include},n,o)).slice(0,s);if(o.isCancellationRequested||!c.length)return;let l=new Nr;for(let d of c){let p=l.get(d.file)??[];d.isFullFile?p=[d]:p.some(f=>f.isFullFile||f.range.containsRange(d.range))||(p=[...p.filter(f=>!d.range.containsRange(f.range)),d]),l.set(d.file,p)}let u=Array.from(l.values()).flatMap(d=>d.sort((p,f)=>je.compareRangesUsingStarts(p.range,f.range)).map(p=>new Bo.PromptReference(p.isFullFile?p.file:new fn(p.file,cC(p.range)))));return{chunks:c,references:u}}render(r,n){if(r)return vscpp(vscppf,null,vscpp("references",{value:r.references}),r.chunks.map((o,s)=>{let a=typeof this.props.priority<"u"?this.props.priority+(1-(s+1)/r.chunks.length):void 0;return{chunk:o,priority:a}}).reverse().map(({chunk:o,priority:s})=>{let a=vI(this.workspaceService,o.file);return vscpp(Qv.TextChunk,{priority:s},"Here is a potentially relevant code excerpt ",o.isFullFile?`starting at line ${o.range.startLineNumber} `:"","in `",a,"`:",vscpp("br",null),Si(S5(o.file),o.text))}))}};E([Vo(r=>r.logService),eD(function(r,n){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepareWorkspaceChunks",{status:n},{execTime:r})})],th.prototype,"prepare",1),th=E([y(1,Rt),y(2,ie),y(3,ge),y(4,Kv),y(5,qe),y(6,xe)],th);var Yv=class extends Qv.PromptElement{constructor(r,n,o,s,a,c,l){super(r);this.accessor=n;this.logService=o;this.chatFetcher=s;this.telemetryService=a;this.tokenizerProvider=c;this.endpointProvider=l}async prepare(r,n,o){let s=this.props,a=s.promptContext.query;if(!a)return;let c=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),l=new qn(async()=>{this.logService.internal.debug("[Workspace Resolver] Asking the model to update the user question and provide queries...");let{messages:u}=await oye(this.accessor,this.props.promptContext,c);if(o.isCancellationRequested)return;let d=this.tokenizerProvider.acquireTokenizer(c).tokenLength(a),f=await this.chatFetcher.fetchOne("workspaceContext",u,async g=>{},o,2,c,void 0,{temperature:0,max_tokens:d+200});if(o.isCancellationRequested)return;let m;if(f.type!=="success")if(this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.error",{type:f.type,reason:f.reason,requestId:f.requestId}),f.type==="length")m=f.truncatedValue;else throw new Error(mQ.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",f.type,f.reason));else m=f.value;let h=sye(a,m);return this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.success",{type:f.type,requestId:f.requestId},{totalKeywordCount:h.keywords.flatMap(g=>[g.keyword,g.variations]).length}),{rephrasedQuery:h.rephrasedQuestion,keywords:h.keywords}});return new class{constructor(){this.rawQuery=a}resolveQueryAndKeywords(u){return ka(l.value,u)}async resolveQuery(u){return this.maySkipResolve()?a:(await this.resolveQueryAndKeywords(u))?.rephrasedQuery??a}maySkipResolve(){return s.promptContext.chatVariables.hasVariables()?!1:!/\b(it|that|this)\b/i.test(a)}}}render(r,n){if(!r)return;let o=this.props.include??{workspaceStructure:!0,workspaceChunks:!0};return vscpp(vscppf,null,o.workspaceStructure&&vscpp(vs,{maxSize:500,...this.props}),o.workspaceChunks&&vscpp(th,{priority:this.props.priority,query:r}))}};E([eD(function(r,n){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepare",{status:n},{execTime:r})})],Yv.prototype,"prepare",1),Yv=E([y(1,Rt),y(2,ie),y(3,yt),y(4,ge),y(5,_r),y(6,xe)],Yv);var SC=class extends Qv.PromptElement{render(e,r){return vscpp(Qv.UserMessage,null,vscpp(Yv,{...this.props}))}};var A6=class extends IC.PromptElement{render(e,r){let{query:n,history:o,chatVariables:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(IC.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge of the codebase the user has open in their workspace.",vscpp("br",null),vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),"# Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the provided relevant workspace information (code excerpts, file names, and symbols) to understand the user's workspace.",vscpp("br",null),"2. Consider how to answer the user's prompt based on the provided information and your specialized coding knowledge. Always assume that the user is asking about the code in their workspace instead of asking a general programming question. Prefer using variables, functions, types, and classes from the workspace over those from the standard library.",vscpp("br",null),"3. Generate a response that clearly and accurately answers the user's question. In your response, add fully qualified links for referenced symbols (example: [`namespace.VariableName`](path/to/file.ts)) and links for files (example: [path/to/file](path/to/file.ts)) so that the user can open them. If you do not have enough information to answer the question, respond with \"I'm sorry, I can't answer that question with what I currently know about your workspace\".",vscpp("br",null),vscpp("br",null),"DO NOT mention that you cannot read files in the workspace.",vscpp("br",null),"DO NOT ask the user to provide additional information about files in the workspace.",vscpp("br",null),"Remember that you MUST add links for all referenced symbols from the workspace and fully qualify the symbol name in the link, for example: [`namespace.functionName`](path/to/util.ts).",vscpp("br",null),"Remember that you MUST add links for all workspace files, for example: [path/to/file.js](path/to/file.js)",vscpp("br",null),vscpp("br",null),"# Examples",vscpp("br",null),"Question:",vscpp("br",null),"What file implements base64 encoding?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Base64 encoding is implemented in [src/base64.ts](src/base64.ts) as [`encode`](src/base64.ts) function.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How can I join strings with newlines?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the [`joinLines`](src/utils/string.ts) function from [src/utils/string.ts](src/utils/string.ts) to join multiple strings with newlines.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I build this project?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To build this TypeScript project, run the `build` script in the [package.json](package.json) file:",vscpp("br",null),vscpp("br",null),"```sh",vscpp("br",null),"npm run build",vscpp("br",null),"```",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I read a file?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To read a file, you can use a [`FileReader`](src/fs/fileReader.ts) class from [src/fs/fileReader.ts](src/fs/fileReader.ts).",vscpp("br",null)),vscpp(It,{flexGrow:1,priority:400,history:o}),vscpp(bn,{flexGrow:1,document:this.props.document,range:this.props.selection,priority:600}),vscpp(IC.UserMessage,{flexGrow:1},vscpp(Yv,{priority:800,...this.props})),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:s,query:n}))}};var cD="workspace",aD=class extends us{constructor(r,n,o,s,a){super(r,n,o);this.instantiationService=s;this.tabsAndEditorsService=a}createRenderer(r,n,o,s){let a=this.tabsAndEditorsService.activeTextEditor;return Me.create(this.instantiationService,n,A6,{promptContext:r,document:a?.document,selection:a?.selection,endpoint:n})}};aD=E([y(3,j),y(4,Ft)],aD);var Xv=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=Xv.ID;this.description=aye.t("Ask a question about the files in your current workspace");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID=cD}get intentDetectionInput(){let e="workspace_questions";return{functionName:e,sampleQuestion:"How do I build this project?",functionCallingBlurb:`If the user's message is about files in the current project, repository, or workspace, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(aD,this,r,n)}};Xv=E([y(0,j),y(1,xe)],Xv);var Io=q(require("vscode"));var CC={location:"sameFolder",prefix:"test_",suffixes:[".test",".spec","_test","Test","_spec","_test","Tests",".Tests","Spec"]},TC={csharp:{suffixes:["Test"],location:"testFolder"},dart:{suffixes:["_test"],location:"testFolder"},go:{suffixes:["_test"],location:"sameFolder"},java:{suffixes:["Test"],location:"testFolder"},javascript:{suffixes:[".test",".spec"],location:"sameFolder"},javascriptreact:{suffixes:[".test",".spec"],location:"sameFolder"},kotlin:{suffixes:["Test"],location:"testFolder"},php:{suffixes:["Test"],location:"testFolder"},powershell:{suffixes:[".Tests"],location:"testFolder"},python:{prefix:"test_",suffixes:["_test"],location:"testFolder"},ruby:{suffixes:["_test","_spec"],location:"testFolder"},rust:{suffixes:[""],location:"testFolder"},swift:{suffixes:["Tests"],location:"testFolder"},typescript:{suffixes:[".test",".spec"],location:"sameFolder"},typescriptreact:{suffixes:[".test",".spec"],location:"sameFolder"}},QWe={cs:"csharp",dart:"dart",go:"go",java:"java",js:"javascriptreact",kt:"kotlin",php:"php",ps1:"powershell",py:"python",rb:"ruby",rs:"rust",swift:"swift",ts:"typescript",tsx:"typescriptreact"},XWe=function(){let t={};for(let[e,r]of Object.entries(QWe))t[e]=TC[r];return t}(),Gp=class{constructor(e,r){this._search=e;this._tabs=r}_findTabMatchingPattern(e){return this._tabs.tabs.find(n=>n.uri&&n.uri.scheme!==Tn.untitled&&_6(n.uri,e))?.uri}async findTestFileForSourceFile(e,r){if(e.isUntitled)return;let n=Ml(e.uri),o=tl(e.uri),s=TC[e.languageId]??CC,a=[];if(s.prefix&&a.push(s.prefix+n),s.suffixes)for(let u of s.suffixes??[]){let d=n.replace(`${o}`,`${u}${o}`);a.push(d)}let c=a.length===1?`**/${a[0]}`:`**/{${a.join(",")}}`,l=this._findTabMatchingPattern(c);return l||(e.languageId==="python"?l=await this._search.findFilesWithExcludes(c,"**/*.pyc",1,r):l=await this._search.findFilesWithDefaultExcludes(c,1,r)),l}async findAnyTestFileForSourceFile(e,r){let n=TC[e.languageId]??CC,o=[];if(n.prefix&&o.push(`${n.prefix}*`),n.suffixes){let c=tl(e.uri);for(let l of n.suffixes??[])o.push(`*${l}${c}`)}let s=o.length===1?`**/${o[0]}`:`**/{${o.join(",")}}`,a=this._findTabMatchingPattern(s);return a||(e.languageId==="python"?a=await this._search.findFilesWithExcludes(s,"**/*.pyc",1,r):a=await this._search.findFilesWithDefaultExcludes(s,1,r)),a}async findFileForTestFile(e,r){let n=TC[e.languageId]??CC,o=Ml(e.uri),s=[];n.suffixes&&s.splice(0,0,...n.suffixes),n.prefix&&s.splice(0,0,n.prefix);for(let a of s){let c=o.replace(a,"");if(c!==o){let l=`**/${c}`,u=this._findTabMatchingPattern(l);if(u||(u=await this._search.findFilesWithDefaultExcludes(l,1,r)),u)return u}}}};Gp=E([y(0,Hp),y(1,Ft)],Gp);function Jv(t){let e;He.isUri(t)||(e=TC[t.languageId],t=t.uri);let r=Ml(t),n=tl(t);if(e??=XWe[n.replace(".","")],e){if(e.suffixes&&e.suffixes.some(s=>r.endsWith(s+n))||e.prefix&&r.startsWith(e.prefix))return!0}else if(CC.suffixes.some(s=>r.endsWith(s+n))||r.startsWith(CC.prefix))return!0;return!1}function JWe(t){let e=TC[t.languageId]??CC,r=Ml(t.uri);if(e.prefix)return e.prefix+r;let n=tl(t.uri),o=e.suffixes&&e.suffixes.length>0?e.suffixes[0]:".test";return r.replace(`${n}`,`${o}${n}`)}function ZWe(t){let e=Qfe(t.uri,"..");if(t.languageId==="java"){let r=e.path;if(r.includes("/src/main/")){let n=r.replace("/src/main/","/src/test/");return e.with({path:n})}}return e}function D6(t){let e=JWe(t),r=ZWe(t);return He.joinPath(r,e).with({scheme:Tn.untitled})}var EC=ne("ITestGenInfoStorage"),N6=class{constructor(){this.sourceFileToTest=void 0}};var wC=class{constructor(e,r,n,o,s){this.instaService=e;this.parserService=r;this.testGenInfoStorage=n;this.tabsAndEditorsService=o;this.ignoreService=s}async runCommand(e){let r,n;if(e)r=e.document,n=e.selection;else{let o=Io.window.activeTextEditor;if(o===void 0)return;r=o.document,n=o.selection}if(Jv(r.uri))return Io.commands.executeCommand("vscode.editorChat.start",{message:"/tests ",autoSend:!0,initialRange:n});{let o=await this.identifyTestableNode(r,n);this.updateTestGenInfo(r,o,n);let s=await this.findOrCreateTestFile(r),a=await Io.workspace.openTextDocument(s),c=await this.determineTestInsertPosition(a),l=await Io.window.showTextDocument(a,this.getTabGroupByUri(s));return l.selection=new Io.Selection(c.start,c.end),l.revealRange(c,Io.TextEditorRevealType.InCenter),c.end.line===0&&c.end.character===0||await l.edit(d=>{d.insert(c.start,`

`)}),Io.commands.executeCommand("vscode.editorChat.start",{message:"/tests",autoSend:!0})}}async determineTestInsertPosition(e){let r=this.parserService.getTreeSitterAST(e),n=r?await r.findLastTest():null,o;if(n===null){let s=e.lineAt(e.lineCount-1);o=new Io.Range(s.range.end,s.range.end)}else{let s=e.positionAt(n.endIndex),a=e.lineAt(s).range.end;o=new Io.Range(a,a)}return o}updateTestGenInfo(e,r,n){this.testGenInfoStorage.sourceFileToTest={uri:e.uri,target:r?.range??n,identifier:r?.identifier}}async identifyTestableNode(e,r){let n=this.parserService.getTreeSitterAST(e);if(!n)return null;let o=await n.getTestableNode({startIndex:e.offsetAt(r.start),endIndex:e.offsetAt(r.end)});if(!o)return null;let{startIndex:s,endIndex:a}=o.node,c=new Io.Range(e.positionAt(s),e.positionAt(a));return{identifier:o.identifier.name,range:c}}async findOrCreateTestFile(e){let n=await this.instaService.createInstance(Gp).findTestFileForSourceFile(e,Wt.None);return n!==void 0&&await this.ignoreService.isCopilotIgnored(n)&&(n=void 0),n===void 0&&(n=D6(e)),n}getTabGroupByUri(e){for(let n of this.tabsAndEditorsService.tabs)if(n.uri?.toString()===e.toString())return n.tab.group.viewColumn;let r=this.tabsAndEditorsService.activeTextEditor?.viewColumn;return r===void 0?Io.ViewColumn.Two:r>Io.ViewColumn.One?r-1:Io.ViewColumn.Beside}};wC=E([y(0,j),y(1,dt),y(2,EC),y(3,Ft),y(4,Te)],wC);var B6=q(Ct()),yQ=q(require("path"));var eKe="vscode-notebook-cell";function er(t){return t.scheme===eKe||t.scheme==="untitled"&&t.fragment.startsWith("notebook-chat-input")}var PC=q(Ue());var kC=q(Ue());var ro=ne("IGitExtensionService");var on=class extends kC.PromptElement{constructor(r,n,o,s){super(r);this.accessor=n;this.ignoreService=o;this.tokenizerProvider=s}async prepare(r){let n=this.tokenizerProvider.acquireTokenizer(r.endpoint),o=[];for(let l of this.props.input)await this.ignoreService.isCopilotIgnored(l.document.uri)||o.push(l);let s=o.map(l=>{let{document:u,change:d,selection:p}=l,f;if(d?.hunks.length){let m=d.hunks[0];f=[m.range.start.line>0?on.enumeratedLines(u,0,m.range.start.line):"",...d.hunks.map((h,g,v)=>{let b=g+1<v.length?v[g+1].range.start.line:u.lineCount;return[on.enumeratedChangeLines(h.text,h.range.start.line),`
`,h.range.end.line<b?on.enumeratedLines(u,h.range.end.line,b):""]}).flat()].join("")}else if(p){let m=p.end.line+(p.end.character>0?1:0);f=on.enumeratedSelectedLines(u,0,u.lineCount,p.start.line,m)}else f=on.enumeratedLines(u,0,u.lineCount);return{input:l,hunks:[{range:new Be(0,0,l.document.lineCount,0),text:f}],tokens:n.tokenLength(f)}}),a=s.reduce((l,{tokens:u})=>l+u,0);if(this.props.logService.internal.info(`[CurrentChange] Full documents: ${a} tokens, ${r.tokenBudget} budget`),a<=r.tokenBudget)return{input:s.map(({input:l,hunks:u})=>({input:l,hunks:u}))};let c=s.slice().sort((l,u)=>u.tokens-l.tokens);for(let l of c){let{input:u,tokens:d}=l,{document:p,change:f,selection:m}=u;if(f?.hunks.length){let h=[],g=0;for(let v of f.hunks){let b=await Fs.getDefinitionAtRange(this.accessor,p,v.range,!1);if(b){let _=b.range.end.line+(b.range.end.character>0?1:0),x=v.range.end.line+(v.range.end.character>0?1:0),S=[v.range.start.line>b.range.start.line?on.enumeratedLines(p,b.range.start.line,v.range.start.line):"",on.enumeratedChangeLines(v.text,v.range.start.line),`
`,_>x?on.enumeratedLines(p,x,_):""].join("");h.push({range:new Be(Math.min(v.range.start.line,b.range.start.line),0,Math.max(_,x),0),text:S}),g+=n.tokenLength(S)}else{let _=on.enumeratedChangeLines(v.text,v.range.start.line),x=v.range.end.line+(v.range.end.character>0?1:0);h.push({range:new Be(v.range.start.line,0,x,0),text:_}),g+=n.tokenLength(_)}}l.hunks=h,l.tokens=g,a+=l.tokens-d}else if(m){let h=await Fs.getDefinitionAtRange(this.accessor,p,m,!1);if(h){let g=h.range.end.line+(h.range.end.character>0?1:0),v=m.end.line+(m.end.character>0?1:0),b=on.enumeratedSelectedLines(p,h.range.start.line,g,m.start.line,v),_=n.tokenLength(b);l.hunks=[{range:h.range,text:b}],l.tokens=_,a+=l.tokens-d}else{let g=m.end.line+(m.end.character>0?1:0),v=on.enumeratedSelectedLines(p,m.start.line,g,m.start.line,g);l.hunks=[{range:new Be(m.start.line,0,g,0),text:v}],l.tokens=n.tokenLength(v),a+=l.tokens-d}}else l.hunks=[],l.tokens=0,a+=l.tokens-d;if(this.props.logService.internal.info(`[CurrentChange] Reduced ${u.relativeDocumentPath} to defintions: ${a} tokens, ${r.tokenBudget} budget`),a<=r.tokenBudget)return{input:s.map(({input:h,hunks:g})=>({input:h,hunks:g}))}}if(this.props.logService.public.info(`[CurrentChange] Still too large: ${a} tokens, ${r.tokenBudget} budget, ${s.length} inputs`),s.length>1){let l=new Error("Split prompt.");throw l.code="split_input",l}return{input:s.map(({input:l,hunks:u})=>({input:l,hunks:u}))}}render(r,n){let o=r.input.filter(s=>s.hunks.length>0);if(o.length)return vscpp(vscppf,null,vscpp(kC.UserMessage,{priority:this.props.priority},o.map(s=>vscpp(vscppf,null,s.input.change?vscpp(vscppf,null,"Change at cursor:",vscpp("br",null),vscpp("br",null),"Each line is annotated with the line number in the file.",vscpp("br",null)):vscpp(vscppf,null,"Current selection with the selected lines labeled as such:",vscpp("br",null)),vscpp("br",null),"From the file: ",s.input.relativeDocumentPath,vscpp("br",null),s.hunks.map(a=>vscpp(nt,{references:[new kC.PromptReference(new fn(s.input.document.uri,a.range))],uri:s.input.document.uri,range:a.range,code:a.text,languageId:`${s.input.document.languageId}/${s.input.relativeDocumentPath}: FROM_LINE: ${a.range.start.line+1} - TO_LINE: ${a.range.end.line}`})),vscpp("br",null),vscpp("br",null)))))}static async getCurrentChanges(r,n){let o=r.getExtensionApi();return o?(await Promise.all(o.repositories.map(async a=>{let c=await(n==="index"?a.diffIndexWithHEAD():a.diffWithHEAD());return await Promise.all(c.map(async u=>{let d=await(n==="index"?a.diffIndexWithHEAD(u.uri.fsPath):a.diffWithHEAD(u.uri.fsPath));return{repository:a,uri:u.uri,hunks:on.parseDiff(d).map(p=>on.gitHunkToHunk(p))}}))}))).flat():[]}static async getCurrentChange(r,n,o){let a=r.get(ro).getExtensionApi();if(!a)return;let c=a.getRepository(n.uri);if(!c)return;let l=await c.diffWithHEAD(n.uri.fsPath);if(!l)return;let d=on.parseDiff(l).find(p=>p.additions.some(f=>{let m=f.start-1,h=m+f.length-1;return o.line>=m&&o.line<=h}));if(d)return{repository:c,uri:n.uri,hunks:[on.gitHunkToHunk(d)]}}static async getChanges(r,n,o,s){let c=r.get(ro).getExtensionApi();if(!c)return;let l=on.parseDiff(s),u=c.repositories.find(d=>d.rootUri.toString().toLowerCase()===n.toString().toLowerCase());if(u)return{repository:u,uri:o,hunks:l.map(d=>on.gitHunkToHunk(d))}}static gitHunkToHunk(r){return{range:new Be(r.startAddedLine-1,0,r.startAddedLine-1+r.addedLines,0),text:r.diffText}}static parseDiff(r){let n=r.split(`
@@`);return n.length&&n[n.length-1].endsWith(`
`)&&(n[n.length-1]=n[n.length-1].slice(0,-1)),n.map(s=>{let a=s.match(/-(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))?/);if(a){let c=parseInt(a[1]),l=a[2]?parseInt(a[2]):1,u=parseInt(a[3]),d=a[4]?parseInt(a[4]):1,p=[],f=s.split(`
`).slice(1),m=0,h;for(let g of f){let v=g.charAt(0);v==="+"?(h===void 0&&(h=u+m),m++):(h!==void 0&&(p.push({start:h,length:u+m-h}),h=void 0),v===" "&&m++)}return h!==void 0&&(p.push({start:h,length:u+m-h}),h=void 0),c===0&&(c=1),u===0&&(u=1),{startDeletedLine:c,deletedLines:l,startAddedLine:u,addedLines:d,additions:p,diffText:f.join(`
`)}}return null}).filter(Boolean)}static enumeratedLines(r,n,o){return r.getText(new Be(n,0,o,0)).split(`
`).map((l,u)=>u===o-n?l:`/* Line ${n+u+1} */${l}`).join(`
`)}static enumeratedSelectedLines(r,n,o,s,a){return r.getText(new Be(n,0,o,0)).split(`
`).map((d,p)=>{if(p===o-n)return d;let f=n+p;return`/* ${s<=f&&f<a?"Selected ":""}Line ${f+1} */${d}`}).join(`
`)}static enumeratedChangeLines(r,n){let o=0;return r.split(`
`).filter(a=>a[0]!=="-").map((a,c)=>{let l=a[0],u=l==="-";return u&&o++,`/* ${u?"Removed Line":`${l==="+"?"Changed ":""}Line ${n+c-o+1}`} */${a.substring(1)}`}).join(`
`)}};on=E([y(1,Rt),y(2,Te),y(3,_r)],on);var RC=class extends PC.PromptElement{render(e,r){return vscpp(vscppf,null,vscpp(PC.SystemMessage,{priority:1001},"You are a world-class software engineer and the author and maintainer of the discussed code. Your feedback prefectly combines detailed feedback and explanation of context.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. Provide feedback on the current ",this.props.input[0]?.change?vscpp(vscppf,null,"change"):vscpp(vscppf,null,"selection")," on where it can be improved or introduces a problem.",vscpp("br",null),"2a. Focus on naming conventions, readability, style and local logical correctness.",vscpp("br",null),"2b. Avoid commenting on correct code.",vscpp("br",null),"2c. Avoid commenting on commented out code.",vscpp("br",null),"2d. Keep scoping rules in mind.",vscpp("br",null),"3. Reply with an enumerated list of feedback with source line number, filepath, kind (bug, performance, consistency, documentation, naming, readability, style, other), severity (low, medium, high), and feedback text.",vscpp("br",null),"3a. E.g.: 1. Line 357 in src/flow.js, bug, high severity: `i` is not incremented.",vscpp("br",null),"3b. E.g.: 2. Line 361 in src/arrays.js, documentation, low severity: Function `binarySearch` is not documented.",vscpp("br",null),"3c. E.g.: 3. Line 176 in src/vs/platform/actionWidget/browser/actionWidget.ts, consistency, medium severity: The color id `'background.actionBar'` is not consistent with the other color ids used. Use `'actionBar.background'` instead.",vscpp("br",null),"3d. E.g.: 4. Line 410 in src/search.js, documentation, medium severity: Returning `-1` when the target is not found is a common convention, but it should be documented.",vscpp("br",null),"3e. E.g.: 5. Line 51 in src/account.py, bug, high severity: The deposit method is not thread-safe. You should use a lock to ensure that the balance update is an atomic operation.",vscpp("br",null),"3f. E.g.: 6. Line 220 in src/account.py, readability, low severity: The withdraw method is very long and combines multipe logical steps, consider splitting it into multiple methods.",vscpp("br",null),"4. Try to sort the feedback by file and line number.",vscpp("br",null),'5. When there is no feedback to provide, reply with "No feedback to provide."',vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Provide clear and relevant examples when helpful."),vscpp(qi,{flexGrow:1,priority:700}),vscpp(PC.UserMessage,null,vscpp(cr,{priority:725,languageId:this.props.input[0]?.document.languageId,customIntroduction:"When providing feedback for code, please check for these user provided coding guidelines.",includeCodeFeedbackInstructions:!0})),vscpp(on,{input:this.props.input,logService:this.props.logService,priority:1e3,flexGrow:2}),this.props.input.map(n=>vscpp(Kl,{document:n.document,range:n.selection,priority:800})),this.props.chatVariables&&this.props.query&&vscpp(Mr,{flexGrow:3,priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};var L6=class{constructor(e,r){this.originalText=e;this._combinedEditsSinceStart=Or.empty;this._text=r.apply(this.originalText),this._textAfterTrackedEdits=this._text,this._originalEdits=r}handleEdits(e){let r=e.apply(this._text),n=this._combinedEditsSinceStart.compose(e);n=n.removeCommonSuffixPrefix(this._textAfterTrackedEdits),this._combinedEditsSinceStart=n,this._text=r}computeTrackedEditsSurvivalScore(){let e=0,r=0,n=0,o=0,s=this._originalEdits.getNewTextRanges(),a=tKe(s,this._combinedEditsSinceStart);for(let c=0;c<s.length;c++){let l=this._originalEdits.edits[c],u=this.originalText.substring(l.replaceRange.start,l.replaceRange.endExclusive),d=l.newText,p=a[c],f=this._text.substring(p.start,p.endExclusive),m=lD(f,d),h=lD(d,u),g=lD(f,u);if(h!==1){let _=1-Math.max(g-h,0)/(1-h);n+=l.replaceRange.length*_,o+=l.replaceRange.length}let v=l.newText.length*m,b=l.newText.length;e+=v,r+=b}return{fourGram:r===0?1:e/r,noRevert:o===0?1:n/o}}};function lD(t,e){if(t.length<4||e.length<4)return t===e?1:0;let n=new Map;for(let c=0;c<=t.length-4;c++){let l=t.substring(c,c+4),u=n.get(l)||0;n.set(l,u+1)}for(let c=0;c<=e.length-4;c++){let l=e.substring(c,c+4),u=n.get(l)||0;n.set(l,u-1)}let o=t.length-4+1+e.length-4+1,s=0;for(let c of n.values())s+=Math.abs(c);return(o-s)/o}function tKe(t,e){t=t.slice();let r=[],n=0;for(let o of e.edits){for(;;){let a=t[0];if(!a||a.endExclusive>=o.replaceRange.start)break;t.shift(),r.push(a.delta(n))}let s=[];for(;;){let a=t[0];if(!a||!a.intersectsOrTouches(o.replaceRange))break;t.shift(),s.push(a)}for(let a=s.length-1;a>=0;a--){let c=s[a],l=c.intersect(o.replaceRange).length;c=c.deltaEnd(-l+(a===0?o.newText.length:0));let u=c.start-o.replaceRange.start;u>0&&(c=c.delta(-u)),a!==0&&(c=c.delta(o.newText.length)),c=c.delta(-(o.newText.length-o.replaceRange.length)),t.unshift(c)}n+=o.newText.length-o.replaceRange.length}for(;;){let o=t[0];if(!o)break;t.shift(),r.push(o.delta(n))}return r}var zp=class{constructor(e,r,n,o,s,a,c,l){this._document=e;this._originalDocumentText=r;this._edits=n;this._sendTelemetryEvent=s;this._gitService=c;this._telemetryService=l;this._editSurvivalTracker=new L6(this._originalDocumentText,this._edits);this._store=new ht;this._store.add(a.onDidChangeTextDocument(u=>{if(u.document!==this._document)return;let d=Or.from(u.contentChanges);this._editSurvivalTracker.handleEdits(d)})),this._editSurvivalTracker.handleEdits(o),this._initialBranchName=this._getCurrentBranchName(),this._reportAfter(30*1e3),this._reportAfter(120*1e3),this._reportAfter(300*1e3),this._reportAfter(600*1e3,()=>{this._store.dispose()})}_getCurrentBranchName(){return this._gitService.getRepository(this._document.uri)?.headBranchName}_reportAfter(e,r){let n=new BM(()=>{this._report(e),n.dispose(),r&&r()},e);this._store.add(n)}_report(e){let r=this._editSurvivalTracker.computeTrackedEditsSurvivalScore(),o=this._getCurrentBranchName()!==this._initialBranchName;this._sendTelemetryEvent({telemetryService:this._telemetryService,fourGram:r.fourGram,noRevert:r.noRevert,timeDelayMs:e,didBranchChange:o})}};zp=E([y(5,qe),y(6,Ho),y(7,ge)],zp);function O6(t,e){return r=>{r.telemetryService.sendMSFTTelemetryEvent("inline.trackEditSurvival",t,{...e,survivalRateFourGram:r.fourGram,survivalRateNoRevert:r.noRevert,timeDelayMs:r.timeDelayMs,didBranchChange:r.didBranchChange?1:0})}}function M6(){let t=ir(),e=ci.createAndMarkAsIssued({messageId:t});return new hQ(e)}var hQ=class t{constructor(e){this.raw=e}get properties(){return this.raw.properties}get measurements(){return this.raw.measurements}markAsDisplayed(){this.raw.markAsDisplayed()}extendedBy(e,r){let n=this.raw.extendedBy(e,r);return new t(n)}};function cye(t,e,r,n,o,s,a){let c=t.turns[t.turns.length-1].contextParts.map(d=>d.kind).sort(),l={source:"user",turnIndex:(t.turns.length-1).toString(),conversationId:e,uiKind:r,inputSources:c.join(",")},u={promptTokenLen:o,messageCharLen:n.length};return s&&(l.suggestion=s),a=a.extendedBy(l,u),a}function lye(t,e,r,n,o,s,a){o!==void 0&&(a=a.extendedBy({offTopic:o.toString()})),a=a.extendedBy({headerRequestId:r}),gQ(t,s,e,n,{},{},a)}function F6(t,e,r,n,o,s,a,c){let l=vQ(o);gQ(t,a,n,o,{source:"model",turnIndex:e.turns.length.toString(),conversationId:r,headerRequestId:s,uiKind:n,codeBlockLanguages:JSON.stringify({...l})},{messageCharLen:o.length,numCodeBlocks:l.length},c)}function uye(t,e,r,n,o,s,a,c){gQ(t,a,n,o,{source:"offTopic",turnIndex:e.turns.length.toString(),conversationId:r,userMessageId:s,uiKind:n},{messageCharLen:o.length},c)}function gQ(t,e,r,n,o,s,a){let c={...n?{messageText:n}:{},...o};e&&(o.languageId=e.languageId,s.documentLength=e.getText().length);let l=a.extendedBy(o,s),u=a.extendedBy(c),d=rKe(r);return t.sendGHTelemetryEvent(`${d}.message`,l.raw.properties,l.raw.measurements),t.sendRestrictedGHTelemetryEvent(`${d}.messageText`,u.raw.properties,u.raw.measurements),l.raw}function U6(t,e,r,n,o){return Zv(t,o,{suggestion:e,messageId:r,suggestionId:n},{},"conversation.suggestionShown")}function Zv(t,e,r,n,o,s){let a=s??ci.createAndMarkAsIssued();e&&(r.languageId=e.languageId,n.documentLength=e.getText().length);let c=a.extendedBy(r,n);return t.sendGHTelemetryEvent(o,c.properties,c.measurements),c}function rKe(t){switch(t){case"conversationInline":return"inlineConversation";case"conversationPanel":default:return"conversation"}}function vQ(t){let e=t.split(`
`),r=[],n;for(let o=0;o<e.length;o++){let s=e[o];if(n)new RegExp(`^\\s*${n.delimiter}\\s*$`).test(s)&&(r.push(n.languageId),n=void 0);else{let a=s.match(/^(\s*)(`{3,}|~{3,})(\w*)/);a&&(n={delimiter:a[2],languageId:a[3]})}}return r}var e0=class{constructor(e,r,n,o,s,a){this.telemetryService=e;this.endpointProvider=r;this.fetcher=n;this.logService=o;this.instantiationService=s;this.ignoreService=a}async generateComments(e,r,n){let o=Date.now(),s=this.ignoreService,a=await Promise.all(e.map(_=>s.isCopilotIgnored(_.document.uri))),c=e.filter((_,x)=>!a[x]);if(c.length===0)return this.logService.public.info("All input documents are ignored. Skipping feedback generation."),{type:"error",severity:"info",reason:B6.t("All input documents are ignored by configuration. Check your .copilotignore file.")};let l=await this.endpointProvider.getChatEndpoint("gpt-4"),u=[],d=[c];for(;d.length;){let _=d.shift();try{let S=await Me.create(this.instantiationService,l,RC,{input:_,logService:this.logService}).render();this.logService.internal.debug(`[FeedbackGenerator] Rendered batch of ${_.length} inputs.`),u.push(S)}catch(x){if(x.code==="split_input"){let S=Math.floor(_.length/2);d.unshift(_.slice(0,S),_.slice(S)),this.logService.internal.debug(`[FeedbackGenerator] Splitting in batches of ${d[0].length} and ${d[1].length} inputs due to token limit.`)}else throw x}}if(r.isCancellationRequested)return{type:"cancelled"};let p=c[0]?.selection?"selection":"change";if(u.length>10)return{type:"error",reason:p==="selection"?B6.t("There is too much text to review, try reviewing a smaller selection."):B6.t("There are too many changes to review, try reviewing a smaller set of changes.")};let m={source:"vscodeCopilotChat",promptCount:u.length,messageId:ir(),inputType:p,inputRanges:c.map(_=>({uri:_.document.uri,ranges:_.selection?[_.selection]:_.change?.hunks.map(x=>x.range)||[]}))},h=Date.now(),g=await Promise.all(u.map(async _=>{let x=[],S=n?async k=>{let M=uD(m,c,k,!0);M.length>x.length&&(n.report(M.slice(x.length)),x=M)}:void 0,I=await this.fetcher.fetchOne("feedbackGenerator",_.messages,S,r,3,l,void 0,void 0,{messageId:m.messageId}),w=I.type==="success"?uD(m,c,I.value,!1):[];return n&&w&&w.length>x.length&&(n.report(w.slice(x.length)),x=w),{fetchResult:I,comments:w}})),v=g.find(_=>_.fetchResult.type!=="success")?.fetchResult||g[0].fetchResult,b=g.map(_=>_.comments).flat();return this.telemetryService.sendMSFTTelemetryEvent("feedback.generateDiagnostics",{model:l.model,requestId:v.requestId,responseType:v.type,source:m.source,messageId:m.messageId,documentType:c[0]&&er(c[0]?.document.uri)?"notebook":"text",languageId:c[0]?.document.languageId,inputType:m.inputType,commentTypes:[...new Set(b?.map(_=>bQ.has(_.kind)?_.kind:"unknown")).values()].sort().join(",")||void 0},{promptCount:u.length,numberOfDiagnostics:b?.length??-1,inputDocumentCount:m.inputRanges.length,inputLineCount:m.inputRanges.reduce((_,x)=>_+x.ranges.reduce((S,I)=>S+(I.end.line-I.start.line),0),0),timeToRequest:h-o,timeToComplete:Date.now()-o}),r.isCancellationRequested?{type:"cancelled"}:v.type==="success"?{type:"success",comments:b||[]}:{type:"error",reason:v.reason}}};e0=E([y(0,ge),y(1,xe),y(2,yt),y(3,ie),y(4,j),y(5,Te)],e0);var bQ=new Set(["bug","performance","consistency","documentation","naming","readability","style","other"]);function uD(t,e,r,n=!1){let o=[];for(let s of _Q(r,n)){let{relativeDocumentPath:a,from:c,to:l,kind:u,severity:d,content:p}=s;if(!bQ.has(u))continue;let f=a&&e.find(S=>S.relativeDocumentPath===a);if(!f)continue;let m=f.document,h=f.selection?[f.selection]:f.change?.hunks.map(S=>S.range),g=m.lineAt(c>=0?c:0),v=m.lineAt((l<=m.lineCount?l:m.lineCount)-1),b=v.text.trimEnd().length,_=new Be(g.lineNumber,g.firstNonWhitespaceCharacterIndex,v.lineNumber,b);if(h&&!h.some(S=>S.intersection(_)))continue;let x={request:t,document:m,uri:m.uri,languageId:m.languageId,range:_,body:new vo(p),kind:u,severity:d,originalIndex:o.length,actionCount:0};o.push(x)}return o}function _Q(t,e=!1){let r=/(?<num>\d+)\. Line (?<from>\d+)(-(?<to>\d+))?([^:]*)( in `?(?<relativeDocumentPath>[^,:`]+))`?(, (?<kind>\w+))?(, (?<severity>\w+) severity)?: (?<content>.+?)((?=\n\d+\.|\n\n)|(?<earlyEnd>$))/gs;return Dr(Array.from(t.matchAll(r),n=>{let o=n.groups;if(e&&typeof o.earlyEnd=="string")return;let s=parseInt(o.from)-1,a=o.to?parseInt(o.to):s+1,c=o.relativeDocumentPath?.replaceAll(yQ.default.sep==="/"?"\\":"/",yQ.default.sep),l=o.kind||"other",u=o.severity||"unknown",d=o.content.trim();if(d.endsWith("```")){let f=d.lastIndexOf("```",d.length-4);f!==-1&&(d=d.substring(0,f).trim())}let p=[...d.matchAll(/```/g)];if(p.length%2){let f=p[p.length-1];d=d.substring(0,f.index).trim()}return{relativeDocumentPath:c,from:s,to:a,linkOffset:n.index+o.num.length+2,linkLength:5+o.from.length+(o.to?o.to.length+1:0),kind:l,severity:u,content:d}}))}function t0(t,e,r,n,o,s){n.public.debug("[FeedbackGenerator] user feedback received");let a=Array.isArray(t)?t:[t],c=a[0];if(!c){n.public.warn("[FeedbackGenerator] No review comment found for user feedback");return}let l={source:c.request.source,messageId:c.request.messageId,userAction:r},u=bQ.has(c.kind)?c.kind:"unknown",d={source:c.request.source,requestId:c.request.messageId,documentType:er(c.uri)?"notebook":"text",languageId:c.languageId,inputType:c.request.inputType,commentType:u,userAction:r},p={commentIndex:c.originalIndex,actionCount:c.actionCount,inputDocumentCount:c.request.inputRanges.length,inputLineCount:c.request.inputRanges.reduce((f,m)=>f+m.ranges.reduce((h,g)=>h+(g.end.line-g.start.line),0),0),promptCount:c.request.promptCount,totalComments:e,comments:a.length,commentLength:a.reduce((f,m)=>f+(typeof m.body=="string"?m.body.length:m.body.value.length),0)};if(r==="helpful"||r==="unhelpful"?(o.sendMSFTTelemetryEvent("review.comment.vote",d,p),o.sendInternalMSFTTelemetryEvent("review.comment.vote",d),Zv(o,void 0,l,{},"review.comment.vote")):(c.actionCount++,o.sendMSFTTelemetryEvent("review.comment.action",d,p),o.sendInternalMSFTTelemetryEvent("review.comment.action",d),Zv(o,void 0,l,{},"review.comment.action")),r==="discardComment"){let{document:f,range:m}=c,h=f.offsetAt(m.start),g=f.offsetAt(m.end),v=f.getText(m);s.createInstance(zp,f,f.getText(),Or.single(St.ofStartAndLength(h,g-h),v),Or.empty,nKe(d,p))}}function nKe(t,e){return r=>{r.telemetryService.sendMSFTTelemetryEvent("review.discardCommentRangeSurvival",t,{...e,survivalRateFourGram:r.fourGram,survivalRateNoRevert:r.noRevert,timeDelayMs:r.timeDelayMs,didBranchChange:r.didBranchChange?1:0})}}var dD=q(require("path")),Ti=q(require("vscode"));var r0=require("vscode"),xQ,q6=class{constructor(e){this._outputChannel=r0.window.createOutputChannel("GitHub Copilot Chat",{log:!0});xQ=this._outputChannel,e.subscriptions.push(this._outputChannel)}logIt(e,r,...n){switch(e){case r0.LogLevel.Trace:this._outputChannel.trace(r);break;case r0.LogLevel.Debug:this._outputChannel.debug(r);break;case r0.LogLevel.Info:this._outputChannel.info(r);break;case r0.LogLevel.Warning:this._outputChannel.warn(r);break;case r0.LogLevel.Error:this._outputChannel.error(r);break}}};var rh=q(require("vscode")),SQ=q(require("path")),dye=q(require("readline"));var iKe="github-code-review",oKe=!1;async function pye(t,e,r,n){let o=t.get(ie),a=await t.get(Tt).getCopilotToken(),l=t.get(ro).getExtensionApi();if(!l)return{type:"success",comments:[]};let u=typeof e=="string"?(await Promise.all(l.repositories.map(async v=>{let b=await(e==="index"?v.diffIndexWithHEAD():v.diffWithHEAD());return await Promise.all(b.map(async x=>{let S=await rh.workspace.openTextDocument(x.uri),I=await(e==="index"?v.show("HEAD",x.uri.fsPath).catch(()=>""):v.show("",x.uri.fsPath).catch(()=>"")),w=e==="index"?await v.show("",x.uri.fsPath).catch(()=>""):S.getText(),k=SQ.relative(v.rootUri.fsPath,x.uri.fsPath);return{repository:v,uri:x.uri,relativePath:process.platform==="win32"?k.replace(/\\/g,"/"):k,before:I,after:w,document:S}}))}))).flat():await Promise.all(e.patches.map(async v=>{let b=rh.Uri.parse(v.fileUri),_=await rh.workspace.openTextDocument(b),x=_.getText(),S=uKe(x,v.patch),I=SQ.relative(e.repositoryRoot,b.fsPath);return{relativePath:process.platform==="win32"?I.replace(/\\/g,"/"):I,before:S,after:x,document:_}}));o.public.debug(`[github review agent] files: ${u.map(v=>v.relativePath).join(", ")}`);let d=t.get(en),p=t.get(gt),{requestId:f,rl:m}=oKe?{requestId:"test-request-id",rl:["data: ...","data: [DONE]"]}:await lKe(t.get(Kr),p,d.remoteAgentsURL,a.token,u.map(v=>({path:v.relativePath,content:v.before})),u.map(v=>({path:v.relativePath,content:v.after})),n);if(!m||n.isCancellationRequested)return{type:"cancelled"};o.public.info(`[github review agent] request id: ${f}`);let h={source:"githubReviewAgent",promptCount:-1,messageId:f||ir(),inputType:"change",inputRanges:[]},g=[];for await(let v of m){if(n.isCancellationRequested)return{type:"cancelled"};o.public.debug(`[github review agent] response line: ${v}`);for(let b of cKe(v)){let _=u.find(F=>F.relativePath===b.data.path);if(!_)continue;let x=_.document,S=x.lineAt(b.data.line-1),I=S.text.trimEnd().length,w=new rh.Range(S.lineNumber,S.firstNonWhitespaceCharacterIndex,S.lineNumber,I),k=b.data.body,M=aKe(k),H={request:h,document:x,uri:x.uri,languageId:x.languageId,range:w,body:new rh.MarkdownString(M),kind:"bug",severity:"medium",originalIndex:g.length,actionCount:0,skipSuggestion:M!==k};g.push(H),r.report([H])}}return{type:"success",comments:g}}var sKe=/```suggestion(\u0020*(\r\n|\n))((?<suggestion>[\s\S]*?)(\r\n|\n))?```/;function aKe(t){return t.replace(new RegExp(sKe,"g"),(e,...r)=>`***
Suggested change:
\`\`\`
${r[3]??""}
\`\`\`
***`)}var cKe=t=>{if(t==="data: [DONE]")return[];if(t==="")return[];let e=JSON.parse(t.replace("data: ",""));return Array.isArray(e.copilot_references)&&e.copilot_references.length>0?e.copilot_references.filter(n=>n.type==="github.generated-pull-request-comment"):[]};async function lKe(t,e,r,n,o,s,a){let c={messages:[{role:"user",copilot_references:[{type:"github.pull_request",id:"1",data:{type:"pull-request",headFileContents:s,baseFileContents:o}}]}]},l=e.isProduction(),u=l?void 0:await ul(process.env.HMAC_SECRET),d=t.makeAbortController(),p=a.onCancellationRequested(()=>d.abort()),f;try{f=await t.fetch(`${r}/${iKe}`,{method:"POST",headers:{Authorization:"Bearer "+n,"Copilot-Integration-Id":l?"vscode-chat":"vscode-chat-dev",...u?{"Request-Hmac":u}:void 0,"X-Copilot-Code-Review-Mode":"ide",...e.getEditorVersionHeaders()},body:JSON.stringify(c),signal:d.signal})}catch(g){if(t.isAbortError(g))return{requestId:void 0,rl:void 0};throw g}finally{p.dispose()}let m=f.headers.get("x-github-request-id")||void 0;if(!f.ok){let g=await f.text();throw new Error(`Agent returned an unexpected HTTP ${f.status} error (request id ${m}): ${g}`)}let h=await f.body();if(!h)throw new Error(`Agent returned an unexpected response: got 200 OK, but response body was empty (request id ${m}).`);return{requestId:m,rl:dye.createInterface({input:h})}}function uKe(t,e){let r=dKe(e.split(/\r?\n/));return pKe(t.split(/\r?\n/),r).join(`
`)}function dKe(t){let e=[],r=-1;for(let n of t)if(n.startsWith("@@")){let o=/@@ -(\d+),\d+ \+\d+,\d+ @@/.exec(n);o&&(r=parseInt(o[1],10))}else r!==-1&&(n.startsWith("+")?e.push({beforeLineNumber:r,content:n.slice(1),type:"add"}):(n.startsWith("-")&&e.push({beforeLineNumber:r,content:n.slice(1),type:"remove"}),r++));return e}function pKe(t,e){for(let r of e)r.type==="add"?t.splice(r.beforeLineNumber-1,1):r.type==="remove"&&t.splice(r.beforeLineNumber-1,0,r.content);return t}function fKe(t,e){let r=new Uo,n=t.onCancellationRequested(()=>{r.cancel(),s()}),o=e.onCancellationRequested(()=>{r.cancel(),s()});function s(){n.dispose(),o.dispose()}return r.token}async function AC(t,e,r){let n=Ti.window.activeTextEditor,o=n?.selection;if(e==="selection"){if(!n)return;if(!o||o.isEmpty)try{let a=await t.get(ev).selectEnclosingScope(n,{reason:Ti.l10n.t("Select an enclosing range to review"),includeBlocks:!0});if(!a)return;o=a}catch(a){if(ed(a))return}}let s=e==="selection"?Ti.l10n.t("Reviewing selected code in {0}...",dD.default.posix.basename(n.document.uri.path)):e==="index"?Ti.l10n.t("Reviewing staged changes..."):e==="workingTree"?Ti.l10n.t("Reviewing unstaged changes..."):Ti.l10n.t("Reviewing changes...");return Ti.window.withProgress({location:Ti.ProgressLocation.Notification,title:s,cancellable:!0},async(a,c)=>{let l=t.get(qo),u=t.get(Tt);l.removeReviewComments(l.getReviewComments());let d={report:g=>l.addReviewComments(g)},p=r?fKe(r,c):c,f=await u.getCopilotToken(),m=(e==="index"||e==="workingTree"||typeof e=="object")&&f.sku?.startsWith("copilot_enterprise")&&f.isInternal,h;try{h=m?await pye(t,e,d,p):await mKe(t,e,n,d,p)}catch(g){h={type:"error",reason:g.message}}if(h.type==="error"){let g=Ti.l10n.t("Show Log");await Ti.window.showInformationMessage(h.severity==="info"?Ti.l10n.t("Reviewing your code did not provide any feedback."):Ti.l10n.t("Code review generation failed."),{modal:!0,detail:h.reason},...h.severity==="info"?[]:[g])===g&&xQ.show()}else h.type==="success"&&h.comments.length===0&&await Ti.window.showInformationMessage(Ti.l10n.t("Reviewing your code did not provide any feedback."),{modal:!0});return h})}async function mKe(t,e,r,n,o){let s=t.get(j).createInstance(e0),a=[];if(e==="index"||e==="workingTree"){let c=await on.getCurrentChanges(t.get(ro),e);(await Promise.all(c.map(async u=>{try{return{document:await Ti.workspace.openTextDocument(u.uri),relativeDocumentPath:dD.default.relative(u.repository.rootUri.fsPath,u.uri.fsPath),change:u}}catch(d){try{if((await Ti.workspace.fs.stat(u.uri)).type===Ti.FileType.File)throw d;return}catch(p){if(p.code==="FileNotFound")return;throw d}}}))).map(u=>{u&&a.push(u)})}else if(e==="selection")a.push({document:r.document,relativeDocumentPath:dD.default.basename(r.document.uri.fsPath),selection:r.selection});else for(let c of e.patches){let l=He.parse(c.fileUri);a.push({document:await Ti.workspace.openTextDocument(l),relativeDocumentPath:dD.default.relative(e.repositoryRoot,l.fsPath),change:await on.getChanges(t,He.file(e.repositoryRoot),l,c.patch)})}return s.generateComments(a,o,n)}var aT=q(Ct()),jye=q(Ue());var DC=ne("IDiffService");var $p=class{constructor(e,r){this.initialText=e;this._diffService=r;this._document=new IQ(e)}addEdits(e){let r=hKe(e,this._document);this._document.apply(r)}getText(){return this._document.getValue()}async getEdits(){let e=this.getText();return await Or.fromDiff(this.initialText,e,this._diffService)}};$p=E([y(1,DC)],$p);var j6=class{constructor(){this.initialText=""}addEdits(e){}getText(){return""}async getEdits(){return Or.empty}};function hKe(t,e){return new Or(t.map(r=>{let n=e.positionToOffset(r.range.start),o=e.positionToOffset(r.range.end);return new Ii(new St(n,o),r.newText)}))}var IQ=class{constructor(e=""){this._converter=void 0;this._value="";this._value=e}getValue(){return this._value}apply(e){this._value=e.apply(this._value),this._converter=void 0}positionToOffset(e){return this._converter||(this._converter=new pc(this._value)),this._converter.positionToOffset(new Ut(e.line+1,e.character+1))}};var Vi=ne("ILanguageDiagnosticService"),NC=class{constructor(e){this._ignoreService=e}waitForNewDiagnostics(e,r,n=5e3){let o,s,a;return new Promise(c=>{o=r.onCancellationRequested(()=>c([])),a=setTimeout(()=>c(this.getDiagnostics(e)),n),s=this.onDidChangeDiagnostics(l=>{for(let u of l.uris)if(od(u,e)){c(this.getDiagnostics(e));break}})}).finally(()=>{o.dispose(),s.dispose(),clearTimeout(a)})}};NC=E([y(0,Te)],NC);function fye(t){return t.map(e=>e.range).reduce((e,r)=>e.union(r))}function mye(t){return t.severity===gI.Error}function CQ(t,e,r=[gI.Error,gI.Warning]){return t.find(n=>n.range.contains(e)&&r.includes(n.severity))}var Y6=q(Ct());var dl=ne("IRunCommandExecutionService");var z_=q(Ue());var gye=q(Ue());var nh=q(Ue());var hye=q(Ue());async function vKe(t,e,r){let n=t.get(tI),o=t.get(dt),s=t.get(he),a=t.get(Lt),c=await n.getEntries(),l=new Nr,u=Date.now(),d=1e3*f6(s.getExperimentBasedConfig(le.TemporalContextMaxAge,a),0,Number.MAX_SAFE_INTEGER),p=[],f=Number.MAX_SAFE_INTEGER,m=0;for(let[_,x]of c)if(!od(_.uri,r.uri)&&(x=x.filter(S=>u-S.timestamp<=d),x.length!==0)){p.push({document:_,formattingOptions:void 0,selection:void 0}),l.set(_.uri,x);for(let S of x)S.timestamp<f&&(f=S.timestamp),S.timestamp>m&&(m=S.timestamp)}let h=m-f;if(p.length===0)return new Map;let g=s.getExperimentBasedConfig(le.TemporalContextPreferSameLang,a),v=await Jve(o,p,e,{costFnOverride:(_,x,S)=>{let I=l.get(S.uri);if(!I)return!1;let w=g&&S.languageId!==r.languageId?1:0,k=Number.MAX_SAFE_INTEGER;for(let M of I){if(_.range.contains(M.offset)){let H=h&&1-(M.timestamp-f)/h;return _.children.length===0?1+w+H:3+w+H+x}k=Math.min(k,Math.abs(M.offset-_.range.start),Math.abs(M.offset-_.range.endExclusive))}return 1+k+w+x}}),b=new Map;for(let _=0;_<v.length;_++)Q1(v[_].text)||b.set(p[_].document,v[_]);return b}var G_=class extends z5{constructor(r,n){super();this.documentCount=r;this.totalCharLength=n}},Ql=class extends hye.PromptElement{constructor(r,n,o,s){super(r);this.instantiationService=n;this.configurationService=o;this.experimentationService=s}async render(r,n){if(!this.configurationService.getExperimentBasedConfig(le.TemporalContextEnabled,this.experimentationService))return;let s=await this.instantiationService.invokeFunction(vKe,n.tokenBudget,this.props.currentDocument);return vscpp(Zt,{name:"recentDocuments"},"I have read or edited some files recently, they may be helpful for answering.",vscpp("br",null),Array.from(_i.map(s,([a,c])=>vscpp(vscppf,null,vscpp(Zt,{name:c.isOriginal?"document":"documentFragment"},"From `",vscpp(O_,{value:a.uri,mode:1}),"` I have read or edited:",vscpp("br",null),vscpp(nt,{languageId:a.languageId,uri:a.uri,code:c.text})),vscpp("br",null)))),vscpp("meta",{value:new G_(s.size,_i.reduce(s.values(),(a,c)=>a+c.text.length,0))}))}};Ql=E([y(1,j),y(2,he),y(3,Lt)],Ql);var LC=class extends nh.PromptElement{constructor(r,n,o){super(r);this._ignoreService=n;this._instantiationService=o}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if(er(this.props.documentContext.document.uri))throw pn("InlineChatGenerateMarkdownPrompt should not be used with a notebook!");if(a!=="markdown")throw pn("InlineChatGenerateMarkdownPrompt should only be used with markdown documents!");if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{query:l,history:u,chatVariables:d}=this.props.promptContext,p=await this._instantiationService.invokeFunction(Xl.create,o.document,o.fileIndentInfo,o.wholeRange,1),f=m=>m.createReplyInterpreter(hs.Mute,0,m.insertStreaming,ji.createFencedBlockClassifier(yc.FenceSequence),h=>h.value.trim()!==p.placeholderText);return vscpp(vscppf,null,vscpp(nh.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),"The user needs help to write some new markdown.",vscpp("br",null),"The markdown is always delimited by ",yc.FenceSequence,".",vscpp("br",null),p.hasContent&&vscpp(vscppf,null,"The user includes existing markdown and marks with ",p.placeholderText," where the new code should go.",vscpp("br",null)),p.hasContent&&vscpp(vscppf,null,'DO NOT include the text "',p.placeholderText,'" in your reply.',vscpp("br",null)),p.hasContent&&vscpp(vscppf,null,"DO NOT repeat any markdown from the user in your reply.",vscpp("br",null)),!p.hasContent&&vscpp(vscppf,null,"Your answer must begin and end with ",yc.FenceSequence,vscpp("br",null)),vscpp(ct,null)),vscpp(It,{inline:!0,priority:700,history:u}),vscpp(nh.UserMessage,{priority:725},vscpp(cr,{languageId:a}),vscpp(Ql,{currentDocument:s})),vscpp(Kt,{priority:750,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:750,chatVariables:d}),vscpp(nh.UserMessage,{priority:900,flexGrow:2,flexReserve:n.endpoint.modelMaxPromptTokens/3},vscpp(bc,{flexGrow:1,tokenBudget:"usePromptSizingBudget",documentData:p,createReplyInterpreter:f}),vscpp(Zt,{name:"userPrompt"},vscpp(So,{chatVariables:d,query:l}),vscpp("br",null)),p.hasContent&&vscpp(vscppf,null,"Remember to start and end your answer with ",yc.FenceSequence,". The markdown that would fit at ",p.placeholderText," is:")))}};LC=E([y(1,Te),y(2,j)],LC);var yc=class t extends _v{static{this.FenceSequence="-+-+-+-+-+"}async render(e){if(this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1)return this._handleFoulPrompt();let n=t.FenceSequence,o=`${n}
${this.props.code}
${n}`;return vscpp(nh.TextChunk,null,o)}};function yKe(t){return t!==null&&typeof t=="object"&&typeof t.get=="function"}var Xl=class t{constructor(e,r,n,o,s,a){this.document=e;this.formattingOptions=r;this.structure=n;this.selection=o;this.offsetSelections=s;this.kind=a;let c=a===0?s.adjusted:s.original,l=e.getText(),u=l.substring(c.start,c.endExclusive),d=l.substring(0,c.start),p=l.substring(c.endExclusive);this.hasCodeWithoutSelection=d.trim().length>0||p.trim().length>0,this.hasContent=u.trim().length>0||d.trim().length>0||p.trim().length>0,this.placeholderText=c.isEmpty?"$PLACEHOLDER$":"$SELECTION_PLACEHOLDER$"}static async create(e,r,n,o,s){yKe(e)&&(e=e.get(dt));let a=await Ap(e,r,n);o=r.validateRange(o);let c=Y5(a,r,o);return new t(r,n,a,o,c,s)}summarizeDocument(e){let r=Lv(t6(e),this.document,this.selection,this.structure),n;return this.kind===0?n=r.projectOffsetRange(this.offsetSelections.adjusted):n=r.projectOffsetRange(new St(this.offsetSelections.original.endExclusive,this.offsetSelections.original.endExclusive)),new WI(r,this.document.uri,this.formattingOptions,n)}},bc=class extends gye.PromptElement{constructor(r,n,o){super(r);this.logger=n;this.ignoreService=o}async render(r,n){let{createReplyInterpreter:o,documentData:s}=this.props;if(await this.ignoreService.isCopilotIgnored(s.document.uri))return vscpp("ignoredFiles",{value:[s.document.uri]});let{tokenBudget:c}=this.props;c==="usePromptSizingBudget"&&(c=n.tokenBudget*.85-300);let l=s.summarizeDocument(c);for(let S=0;S<5;S++){let I=l.codeAbove+l.codeSelected+l.codeBelow;if(await n.countTokens(I)<=c)break;c*=.85,l=s.summarizeDocument(c)}this.logger.internal.info(`Summarized doc to fit token budget (${c} / ${n.endpoint.modelMaxPromptTokens}): ${l.codeAbove.length} + ${l.codeSelected.length} + ${l.codeBelow.length}`);let{uri:u,languageId:d}=s.document,p=d==="markdown",f=p?"markdown":"code",{codeAbove:m,codeSelected:h,codeBelow:g,hasCodeWithoutSelection:v,hasContent:b}=l,_=`${m}${s.placeholderText}${g}`,x=o?o(l):l.createReplyInterpreter(hs.Mute,1,l.replaceSelectionStreaming,ji.createCodeBlockClassifier(),S=>S.value.trim()!==s.placeholderText);return vscpp(Zt,{name:"currentDocument"},vscpp("meta",{value:new Ms(x)}),!b&&vscpp(vscppf,null,"I am in an empty file `",vscpp(O_,{value:u,mode:1}),"`."),b&&vscpp(vscppf,null,"I have the following ",f," in a file called `",vscpp(O_,{value:u,mode:1}),"`:"),!p&&v&&vscpp(vscppf,null,vscpp(nt,{uri:u,languageId:d,code:_,shouldTrim:!1}),vscpp("br",null)),p&&v&&vscpp(vscppf,null,vscpp(yc,{uri:u,code:_}),vscpp("br",null)),(!Q1(h)||this.props._allowEmptySelection)&&vscpp(Zt,{name:"selection"},!p&&v&&vscpp(vscppf,null,"The ",s.placeholderText," code is:",vscpp("br",null)),p&&v&&vscpp(vscppf,null,"I need your help with the following content:"),!p&&vscpp(nt,{uri:u,languageId:d,code:h,shouldTrim:!1}),p&&vscpp(yc,{uri:u,code:h})))}};bc=E([y(1,ie),y(2,Te)],bc);var OC=class extends z_.PromptElement{constructor(r,n,o,s,a){super(r);this._ignoreService=n;this._parserService=o;this._experimentationService=s;this._configurationService=a}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if(er(s.uri))throw pn("InlineChatEditCodePrompt should not be used with a notebook!");if(a==="markdown")throw pn("InlineChatEditCodePrompt should not be used with a markdown document!");if(await this._ignoreService.isCopilotIgnored(s.uri))return vscpp("ignoredFiles",{value:[s.uri]});let{query:l,history:u,chatVariables:d}=this.props.promptContext,p=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsInline,this._experimentationService),f=await Xl.create(this._parserService,s,o.fileIndentInfo,o.wholeRange,0),m=h=>h.createReplyInterpreter(hs.Mute,1,h.replaceSelectionStreaming,ji.createCodeBlockClassifier(),g=>g.value.trim()!==f.placeholderText);return vscpp(vscppf,null,vscpp(z_.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",a,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),f.hasCodeWithoutSelection&&vscpp(vscppf,null,"The user includes existing code and marks with ",f.placeholderText," where the selected code should go.",vscpp("br",null)),vscpp(ct,null)),p&&vscpp(qi,{priority:600}),vscpp(It,{inline:!0,priority:700,history:u}),vscpp(z_.UserMessage,null,vscpp(cr,{priority:725,languageId:a}),vscpp(Ql,{priority:600,currentDocument:s})),vscpp(Kt,{priority:750,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:750,chatVariables:d}),vscpp(z_.UserMessage,{priority:900,flexGrow:2,flexReserve:n.endpoint.modelMaxPromptTokens/3},vscpp(bc,{flexGrow:1,tokenBudget:"usePromptSizingBudget",documentData:f,createReplyInterpreter:m}),vscpp(Zt,{name:"userPrompt"},vscpp(So,{chatVariables:d,query:l}),vscpp("br",null)),f.hasCodeWithoutSelection&&vscpp(vscppf,null,"The modified ",f.placeholderText," code with ``` is:")))}};OC=E([y(1,Te),y(2,dt),y(3,Lt),y(4,he)],OC);var $_=q(Ue());var MC=class extends $_.PromptElement{constructor(r,n,o){super(r);this._ignoreService=n;this._instantiationService=o}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if(er(this.props.documentContext.document.uri))throw pn("InlineChatEditMarkdownPrompt should not be used with a notebook!");if(a!=="markdown")throw pn("InlineChatEditMarkdownPrompt should only be used with markdown documents!");if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let l=await this._instantiationService.invokeFunction(Xl.create,s,o.fileIndentInfo,o.wholeRange,0),{query:u,history:d,chatVariables:p}=this.props.promptContext,f=m=>m.createReplyInterpreter(hs.Mute,0,m.replaceSelectionStreaming,ji.createFencedBlockClassifier(yc.FenceSequence),h=>h.value.trim()!==l.placeholderText);return vscpp(vscppf,null,vscpp($_.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),"The user needs help to modify some markdown content.",vscpp("br",null),"The markdown is always delimited by ",yc.FenceSequence,".",vscpp("br",null),"Your answer must begin and end with ",yc.FenceSequence,".",vscpp("br",null),vscpp(ct,null)),vscpp(It,{inline:!0,priority:700,history:d}),vscpp($_.UserMessage,{priority:725},vscpp(cr,{languageId:a})),vscpp(Kt,{priority:750,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:750,chatVariables:p}),vscpp($_.UserMessage,{priority:900,flexGrow:2,flexReserve:n.endpoint.modelMaxPromptTokens/3},vscpp(bc,{documentData:l,createReplyInterpreter:f,tokenBudget:"usePromptSizingBudget"}),vscpp(Zt,{name:"userPrompt"},vscpp(So,{chatVariables:p,query:u}),vscpp("br",null),"The rewritten markdown content that would fit at ",l.placeholderText," wrapped with ",yc.FenceSequence," is:")))}};MC=E([y(1,Te),y(2,j)],MC);var W_=q(Ue());var FC=class extends W_.PromptElement{constructor(r,n,o,s,a){super(r);this._ignoreService=n;this._parserService=o;this._experimentationService=s;this._configurationService=a}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if(er(s.uri))throw pn("InlineChatGenerateCodePrompt should not be used with a notebook!");if(a==="markdown")throw pn("InlineChatGenerateCodePrompt should not be used with a markdown document!");if(await this._ignoreService.isCopilotIgnored(s.uri))return vscpp("ignoredFiles",{value:[s.uri]});let{query:l,history:u,chatVariables:d}=this.props.promptContext,p=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsInline,this._experimentationService),f=await Xl.create(this._parserService,s,o.fileIndentInfo,o.wholeRange,1),m=h=>h.createReplyInterpreter(hs.Mute,1,n.endpoint.family!=="gpt-3.5-turbo"?h.insertStreaming:h.insertOrReplaceStreaming,ji.createCodeBlockClassifier(),g=>g.value.trim()!==f.placeholderText);return vscpp(vscppf,null,vscpp(W_.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",a,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to write some new code.",vscpp("br",null),f.hasContent&&vscpp(vscppf,null,"The user includes existing code and marks with ",f.placeholderText," where the new code should go.",vscpp("br",null)),f.hasContent&&vscpp(vscppf,null,'DO NOT include the text "',f.placeholderText,'" in your reply.',vscpp("br",null)),f.hasContent&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!f.hasContent&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)),vscpp(ct,null)),p&&vscpp(qi,{priority:600}),vscpp(It,{inline:!0,priority:700,history:u}),vscpp(W_.UserMessage,{priority:725},vscpp(cr,{languageId:a}),vscpp(Ql,{currentDocument:s})),vscpp(Kt,{priority:750,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:750,chatVariables:d}),vscpp(W_.UserMessage,{priority:900,flexGrow:2,flexReserve:n.endpoint.modelMaxPromptTokens/3},vscpp(bc,{flexGrow:1,tokenBudget:"usePromptSizingBudget",documentData:f,createReplyInterpreter:m}),vscpp(Zt,{name:"userPrompt"},vscpp(So,{chatVariables:d,query:l}),vscpp("br",null)),f.hasContent&&vscpp(vscppf,null,"The code that would fit at ",f.placeholderText," with ``` is:")))}};FC=E([y(1,Te),y(2,dt),y(3,Lt),y(4,he)],FC);var Us=q(Ue());var UC=ne("INotebookService");function n0(t){return er(t)?t.path.endsWith(".ipynb"):!1}function vye(t,e){return t.notebookDocuments.find(n=>n.uri.fsPath===e.fsPath)?.notebookType}var TQ={core:1e3,context:800,runtimeCore:600,history:500,other:100};var bd=q(Ue());var _n=q(Ue());function yye(t,e,r,n,o,s){if(r.start.line!==r.end.line&&r.end.character===0){let p=t.lineAt(r.end.line-1);r=new Be(r.start,new xr(r.end.line-1,p.text.length))}else if(e.end.character===0&&e.end.line!==e.start.line&&(r.start.line===e.start.line&&r.start.character===0&&r.end.line===e.end.line&&r.end.character===t.lineAt(r.end.line).text.length||r.isEqual(e))){let p=t.lineAt(r.end.line-1);r=new Be(r.start,new xr(r.end.line-1,p.text.length))}let a=new sa(s,t,o,"ed8c6549bwf9"),c=new sa(s,t,o,"abpxx6d04wxr"),l=new sa(s,t,o,"be15d9bcejpp"),u=()=>(c.trim(),a.trim(e),l.trim(),{language:o,above:c,range:a,below:l});for(let p=r.end.line;p>=r.start.line;p--)if(!a.prependLine(p))return u();let d={aboveLineIndex:r.start.line-1,belowLineIndex:r.end.line+1,minimumLineIndex:Math.max(0,n.start.line),maximumLineIndex:Math.min(t.lineCount-1,n.end.line)};return EQ(d,c,l),u()}function EQ(t,e,r){let n=t.aboveLineIndex,o=!0,s=t.belowLineIndex,a=!0;for(let c=0;c<100&&(o||a);c++)!o||a&&c%4===3?s<=t.maximumLineIndex&&r.appendLine(s)?s++:a=!1:n>=t.minimumLineIndex&&e.prependLine(n)?n--:o=!1;e.isComplete=n<t.minimumLineIndex,r.isComplete=s>t.maximumLineIndex}function H6(t,e,r,n,o){let s={...n,aboveCells:[],belowCells:[]},a,c,l;if(r.document.uri.scheme==="vscode-notebook-cell"){a=e.notebookDocuments.find(S=>S.uri.fsPath===r.document.uri.fsPath&&S.getCells().find(I=>I.document===r.document));let x=a?.getCells().findIndex(S=>S.document===r.document);if(x===void 0||x===-1)return s;c=x-1,l=x+1}else{if(t.activeNotebookEditor?.notebook.uri.path!==r.document.uri.path)return s;let x=t.activeNotebookEditor;a=x?.notebook;let S=x.selection.start;c=S-1,l=S}if(!a)return s;let{language:u,above:d,range:p,below:f}=n,m=d.lines.length+p.lines.length+f.lines.length,h=[],g=[],v=()=>(h.forEach(x=>x.trim()),g.forEach(x=>x.trim()),{language:u,above:d,range:p,below:f,aboveCells:h,belowCells:g}),b=!0,_=!0;for(let x=m;x<100&&(b||_);x++)if(b)if(c>=0){let I=a.cellAt(c).document,w=new sa(o,I,mn(I),"CELL:"+I.uri.fragment);for(let k=0;k<I.lineCount;k++)w.appendLine(k);h.unshift(w),c--}else b=!1;else if(l<a.cellCount){let I=a.cellAt(l).document,w=new sa(o,I,mn(I),"CELL:"+I.uri.fragment);for(let k=0;k<I.lineCount;k++)w.appendLine(k);g.push(w),l++}else _=!1;return v()}var bye=q(Ue());var ih=class extends bye.PromptElement{render(){return vscpp(vscppf,null,"```",this.props.language.languageId,vscpp("br",null),this.props.document&&vscpp(vscppf,null,Pp.forDocument(this.props.language,this.props.document),vscpp("br",null)),this.props.code&&vscpp(vscppf,null,this.props.code,vscpp("br",null)),"```")}};var _ye=q(Ue());var Na=class extends _ye.PromptElement{render(){if(!this.props.codeRegion.hasContent)return;let e=[];return this.props.useMarkers&&e.push(this.props.codeRegion.startMarker),e.push(...this.props.codeRegion.lines),this.props.useMarkers&&e.push(this.props.codeRegion.endMarker),vscpp(ih,{language:this.props.codeRegion.language,document:this.props.codeRegion.document,code:e.join(`
`)})}};var G6=class extends _n.PromptElement{render(e,r){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let n=n0(this.props.documentContext.document.uri),{below:o,above:s,range:a,aboveCells:c,belowCells:l}=this.props,u=c||[],d=l||[],p=this.props.documentContext.language,f=this.props.includeDelimeters??!1;return vscpp(vscppf,null,n?vscpp(vscppf,null,(u.length>0||d.length>0)&&vscpp(qC,{documentContext:this.props.documentContext,aboveCells:u,belowCells:d}),p.languageId==="markdown"?vscpp(PQ,{cellIndex:u.length,selected:a,above:s,below:o,includeDelimeters:f}):vscpp(AQ,{cellIndex:u.length,selected:a,above:s,below:o,includeDelimeters:f})):vscpp(vscppf,null,vscpp(i0,{documentContext:this.props.documentContext}),vscpp(BC,{documentContext:this.props.documentContext,aboveCells:u,belowCells:d}),p.languageId==="markdown"?vscpp(kQ,{cellIndex:u.length,selected:a,above:s,below:o,includeDelimeters:f}):vscpp(RQ,{cellIndex:u.length,selected:a,above:s,below:o,includeDelimeters:f})))}},xye=[{viewType:"polyglot-notebook",exampleCells:[{lan:"markdown",source:"Samples"},{lan:"csharp",source:"using Microsoft.Data.Analysis;"},{lan:"csharp",source:`DateTimeDataFrameColumn dateTimes = new DateTimeDataFrameColumn("DateTimes");
 Int32DataFrameColumn ints = new Int32DataFrameColumn("Ints", 6);
 StringDataFrameColumn strings = new StringDataFrameColumn("Strings", 6);`},{lan:"csharp",source:'dateTimes.Append(DateTime.Parse("2019/01/01"));'}]},{viewType:"sql-notebook",exampleCells:[{lan:"sql",source:"SELECT * FROM users;"}]},{viewType:"node-notebook",exampleCells:[{lan:"javascript",source:'console.log("Hello World");'},{lan:"javascript",source:"const {display} = require('node-kernel');"},{lan:"markdown",source:"# Plain text output"},{lan:"javascript",source:"display.text('Hello World');"}]},{viewType:"sas-notebook",exampleCells:[{lan:"sas",source:"proc print data=sashelp.class; run;"},{lan:"sas",source:`data race;
pr = probnorm(-15/sqrt(325));
run;

proc print data=race;
var pr;
run;
`}]},{viewType:"http-notebook",exampleCells:[{lan:"http",source:"GET https://httpbin.org/get"},{lan:"http",source:"POST https://httpbin.org/post"}]},{viewType:"powerbi-notebook",exampleCells:[{lan:"markdown",source:"# Get Groups"},{lan:"powerbi-api",source:"GET /groups"},{lan:"powerbi-api",source:`%dax /groups/ccce57d1-10af-1234-1234-665f8bbd8458/datasets/51ba6d4b-1234-1234-8635-a7d743a5ea89
EVALUATE INFO.TABLES()
This`}]},{viewType:"wolfram-language-notebook",exampleCells:[{lan:"wolfram",source:"Plot[Sin[x], {x, 0, 2 Pi}]"}]},{viewType:"github-issues",exampleCells:[{lan:"github-issues",source:`$vscode=repo:microsoft/vscode
$milestone=milestone:"May 2020"`},{lan:"github-issues",source:"$vscode $milestone is:closed author:@me -assignee:@me label:bug -label:verified"},{lan:"github-issues",source:"$vscode assignee:@me is:open label:freeze-slow-crash-leak"}]},{viewType:"rest-book",exampleCells:[{lan:"rest-book",source:"GET google.com"},{lan:"rest-book",source:`GET https://www.google.com
    ?query="fun"
    &page=2
    User-Agent: rest-book
    Content-Type: application/json`}]}],wQ=class extends _n.PromptElement{render(){let e=this.props.viewType,r=xye.find(o=>o.viewType===this.props.viewType);if(!r)return vscpp(vscppf,null);let{exampleCells:n}=r;return vscpp(_n.UserMessage,null,"Below you will find a set of example cells for a ",e," notebook.",vscpp("br",null),n.map((o,s)=>vscpp(vscppf,null,"CELL INDEX: ",s,":",vscpp("br",null),"```",o.lan,vscpp("br",null),o.source,vscpp("br",null),vscpp("br",null),"```")))}},i0=class extends _n.PromptElement{constructor(r,n,o){super(r);this.workspaceService=o}render(r,n){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatCustomNotebookInfoRenderer should be used only with a notebook!");let o=vye(this.workspaceService,this.props.documentContext.document.uri),s=xye.find(c=>c.viewType===o),a=s?o:"custom";return vscpp(vscppf,null,vscpp(_n.UserMessage,null,"I am working on a ",a," notebook in VS Code.",vscpp("br",null),a," notebooks in VS Code are documents that contain a mix of rich Markdown, executable code snippets, ",vscpp("br",null),"and accompanying rich output. These are all separated into distinct cells and can be interleaved in any order ",vscpp("br",null),"A ",a," notebook contains multiple cells.",vscpp("br",null)),s&&vscpp(wQ,{viewType:s.viewType}))}};i0=E([y(1,Rt),y(2,qe)],i0);var BC=class extends _n.PromptElement{render(e,r){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatCustomNotebookCellsContextRenderer should be used only with a notebook!");let{aboveCells:n,belowCells:o,documentContext:s}=this.props,a=n||[],c=o||[],l=s.language;return vscpp(vscppf,null,(a.length>0||c.length>0)&&vscpp(_n.UserMessage,null,"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",l.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),a.length>0&&vscpp(jC,{cells:a,title:`Here are the cells in this custom notebook:
`}),c.length>0&&vscpp(jC,{cells:c,cellIndexDelta:a.length+1,title:`Here are the cells below the current cell that I am editing in this custom notebook:
`})))}},kQ=class extends _n.PromptElement{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(_n.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following content in the selection:",vscpp(Na,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following content:",vscpp(ih,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following markdown content above the selection:",vscpp(Na,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following markdown content below the selection:",vscpp(Na,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},RQ=class extends _n.PromptElement{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(_n.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following code in the selection:",vscpp(Na,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following code:",vscpp(ih,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following code above the selection:",vscpp(Na,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following code below the selection:",vscpp(Na,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},qC=class extends _n.PromptElement{render(e,r){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let{aboveCells:n,belowCells:o}=this.props,s=this.props.documentContext.language;return vscpp(vscppf,null,(n.length>0||o.length>0)&&vscpp(_n.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"This Jupyter Notebook already contains multiple cells.",vscpp("br",null),"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",s.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the cells in this Jupyter Notebook:",vscpp("br",null),"`CELL INDEX: 0",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"# create a dataframe with sample data",vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"In this new cell, I am working with the following code:",vscpp("br",null),"```python",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null),n.length>0&&vscpp(jC,{cells:n,title:`Here are the cells in this Jupyter Notebook:
`}),o.length>0&&vscpp(jC,{cells:o,cellIndexDelta:n.length+1,title:`Here are the cells below the current cell that I am editing in this Jupyter Notebook:
`})))}},PQ=class extends _n.PromptElement{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(_n.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following content in the selection:",vscpp(Na,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following content:",vscpp(ih,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following markdown content above the selection:",vscpp(Na,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following markdown content below the selection:",vscpp(Na,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},AQ=class extends _n.PromptElement{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(_n.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following code in the selection:",vscpp(Na,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following code:",vscpp(ih,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following code above the selection:",vscpp(Na,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(_n.UserMessage,null,"In this new cell, I have the following code below the selection:",vscpp(Na,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},jC=class extends _n.PromptElement{render(){return vscpp(vscppf,null,this.props.title,vscpp("br",null),this.props.cells.map((e,r)=>vscpp(DQ,{index:r+(this.props.cellIndexDelta??0),cell:e})))}},DQ=class extends _n.PromptElement{render(){return vscpp(vscppf,null,"CELL INDEX: ",this.props.index,vscpp("br",null),"```",this.props.cell.language.languageId,vscpp("br",null),this.props.cell.lines.join(`
`),vscpp("br",null),"```")}};function NQ(t,e,r,n,o){let s=t*4,a=new Dp(s),c=yye(e.document,e.selection,r,new Be(0,0,e.document.lineCount,0),e.language,a);return H6(n,o,e,c,a)}var VC=class extends bd.PromptElement{constructor(r,n,o){super(r);this.tabsAndEditorsService=n;this.workspaceService=o}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext;return{wholeRange:r.validateRange(n)}}render(r,n){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=NQ(n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new zm(o,s),l=n0(this.props.documentContext.document.uri),{hasCodeWithoutSelection:u,codeWithoutSelection:d,codeSelected:p}=this.props,{aboveCells:f,belowCells:m}=s,h=f||[],g=m||[],v=this.props.documentContext.language,b=v.languageId==="markdown",_=u||p.length>0;return vscpp(vscppf,null,vscpp("meta",{value:c}),l?vscpp(vscppf,null,(h.length>0||g.length>0)&&vscpp(qC,{documentContext:this.props.documentContext,aboveCells:h,belowCells:g}),vscpp(bd.UserMessage,null,b?vscpp(vscppf,null,_&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),!_&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:v.languageId,code:d,shouldTrim:!1}),vscpp("br",null)),u&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(nt,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1})):vscpp(vscppf,null,_&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),!_&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:v.languageId,code:d,shouldTrim:!1}),vscpp("br",null)),p.length>0&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(nt,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1})))):vscpp(vscppf,null,vscpp(i0,{documentContext:this.props.documentContext}),vscpp(BC,{documentContext:this.props.documentContext,aboveCells:h,belowCells:g}),vscpp(bd.UserMessage,null,b?vscpp(vscppf,null,u&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),!u&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:v.languageId,code:d,shouldTrim:!1}),vscpp("br",null)),u&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(nt,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1})):vscpp(vscppf,null,u&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),!u&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:v.languageId,code:d,shouldTrim:!1}),vscpp("br",null)),u&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(nt,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1})))))}};VC=E([y(1,Ft),y(2,qe)],VC);var HC=class extends bd.PromptElement{constructor(r,n,o,s,a,c){super(r);this.configurationService=n;this.notebookService=o;this.tabsAndEditorsService=s;this.experimentationService=a;this.workspaceService=c}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext,o=this.experimentationService.getTreatmentVariable("vscode","copilotchat.notebookSummary")||this.configurationService.getConfig(le.NotebookSummaryExperimentEnabled),s;return o&&this.tabsAndEditorsService.activeNotebookEditor?.notebook&&this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path===r.uri.path&&(s=this.notebookService.getCellExecutions(this.tabsAndEditorsService.activeNotebookEditor.notebook.uri)),{wholeRange:r.validateRange(n),executedCells:s}}render(r,n){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=NQ(n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new zm(o,s),l=n0(this.props.documentContext.document.uri),{hasContent:u,code:d}=this.props,{aboveCells:p,belowCells:f}=s,m=p||[],h=f||[],g=this.props.documentContext.language,v=g.languageId==="markdown",b=r.executedCells||[];return vscpp(vscppf,null,vscpp("meta",{value:c}),l?vscpp(vscppf,null,b.length>0&&vscpp(LQ,{documentContext:this.props.documentContext,executedCells:b}),b.length===0&&(m.length>0||h.length>0)&&vscpp(qC,{documentContext:this.props.documentContext,aboveCells:m,belowCells:h}),vscpp(bd.UserMessage,null,v?vscpp(vscppf,null,u&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),!u&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,u&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),!u&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1}),vscpp("br",null))))):vscpp(vscppf,null,vscpp(i0,{documentContext:this.props.documentContext}),vscpp(BC,{documentContext:this.props.documentContext,aboveCells:m,belowCells:h}),vscpp(bd.UserMessage,null,v?vscpp(vscppf,null,u&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),!u&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,u&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),!u&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),u&&vscpp(vscppf,null,vscpp(nt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1}),vscpp("br",null))))))}};HC=E([y(1,he),y(2,UC),y(3,Ft),y(4,Lt),y(5,qe)],HC);var LQ=class extends bd.PromptElement{render(e,r){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatJupyterNotebookCellSummaryContextRenderer should be used only with a notebook!");let n=this.props.documentContext.language,o=this.props.executedCells||[];return vscpp(vscppf,null,vscpp(bd.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"Users have executed the following cells in this notebook",vscpp("br",null),"Each cell contains a code block started with ```",n.languageId,vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the executed cells in this Jupyter Notebook:",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null),o.map(s=>vscpp(OQ,{cell:s}))))}},OQ=class extends bd.PromptElement{render(){return vscpp(vscppf,null,"```",this.props.cell.document.languageId,vscpp("br",null),this.props.cell.document.getText(),vscpp("br",null),"```")}};var GC=class extends Us.PromptElement{constructor(r,n,o){super(r);this.tabsAndEditorsService=n;this.notebookService=o}async prepare(){if(this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path!==this.props.documentContext.document.uri.path)return{variables:[],packages:[]};let n=this.tabsAndEditorsService.activeNotebookEditor?.notebook;if(!n)return{variables:[],packages:[]};let o=this.notebookService.getVariables(n.uri),s=Promise.resolve([]),[a,c]=await Promise.all([o,s]);return{variables:a,packages:c}}render(r){let{priorities:n}=this.props;return vscpp(vscppf,null,r.variables.length!==0&&vscpp(vscppf,null,vscpp(Us.UserMessage,{priority:n.runtimeCore},"The following variables are present in this Jupyter Notebook:",r.variables.map(o=>vscpp(vscppf,null,vscpp(Us.TextChunk,null,"Name: ",o.variable.name,vscpp("br",null),o.variable.type&&vscpp(vscppf,null,"Type: ",o.variable.type),vscpp("br",null),"Value: ",o.variable.value,vscpp("br",null),o.indexedChildrenCount>0&&vscpp(vscppf,null,"Length: ",o.indexedChildrenCount),vscpp("br",null),o.variable.summary&&vscpp(vscppf,null,"Summary: ",o.variable.summary)))))),r.packages.length!==0&&vscpp(vscppf,null,vscpp(Us.UserMessage,{priority:n.other},"The following pip packages are available in this Jupyter Notebook:",r.packages.map(o=>vscpp(vscppf,null,vscpp(Us.TextChunk,null,o.name,"==",o.version),vscpp("br",null))))))}};GC=E([y(1,Ft),y(2,UC)],GC);var zC=class extends Us.PromptElement{constructor(r,n,o,s){super(r);this.configurationService=n;this.ignoreService=o;this.parserService=s}async prepare(r){let n=this.configurationService.getConfig(le.NotebookAdditionalCodeGenerationRuleEnabled),{documentContext:o}=this.props,s=await this.ignoreService.isCopilotIgnored(o.document.uri),a=o.document.validateRange(o.wholeRange);return{summarizedDocument:await Q2(this.parserService,o.document,o.fileIndentInfo,a,r.endpoint.modelMaxPromptTokens/3),isIgnored:s,priorities:TQ,additionalCodeGenerationRule:n}}render(r,n){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatNotebookBasePrompt should be used only with a notebook!");let{query:o,history:s,chatVariables:a}=this.props.promptContext,{language:c}=this.props.documentContext,l=c.languageId!=="markdown",u=n0(this.props.documentContext.document.uri),d=r.summarizedDocument.splitAroundOriginalSelectionEnd(),{codeAbove:p,hasContent:f,codeBelow:m}=d,h=`${p}$PLACEHOLDER$${m}`,g=d.createReplyInterpreter(hs.Mute,l?1:0,n.endpoint.model!=="gpt-3.5-turbo"?d.insertStreaming:d.insertOrReplaceStreaming,l?ji.createCodeBlockClassifier():ji.createAlwaysInsideCodeBlockClassifier(),_=>_.value.trim()!=="$PLACEHOLDER$"),v=r.priorities,b=r.additionalCodeGenerationRule??!1;return vscpp(vscppf,null,vscpp("meta",{value:new Ms(g)}),vscpp(Us.SystemMessage,{priority:v.core},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",c.languageId,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to write some new code.",vscpp("br",null),u&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),f&&vscpp(vscppf,null,"The user includes existing code and marks with $PLACEHOLDER$ where the new code should go.",vscpp("br",null)),f&&vscpp(vscppf,null,'DO NOT include the text "$PLACEHOLDER$" in your reply.',vscpp("br",null)),f&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!f&&l&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)),!l&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."),vscpp(ct,null)),vscpp(It,{inline:!0,priority:v.history??700,history:s}),vscpp(Us.UserMessage,{priority:725},vscpp(cr,{languageId:c.languageId})),vscpp(Kt,{priority:v.core,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:v.context,chatVariables:a}),vscpp(HC,{documentContext:this.props.documentContext,hasContent:f,code:h,priority:v.core}),vscpp(GC,{documentContext:this.props.documentContext,priorities:v,query:o}),vscpp(Us.UserMessage,{priority:v.core},b&&vscpp(vscppf,null,"Please generate code for: "),vscpp(So,{chatVariables:a,query:o}),vscpp("br",null),f&&l&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ with ``` is:"),f&&!l&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ without ``` is:")))}};zC=E([y(1,he),y(2,Te),y(3,dt)],zC);var $C=class extends Us.PromptElement{constructor(r,n,o,s){super(r);this.configurationService=n;this.ignoreService=o;this.parserService=s}async prepare(r){let n=this.configurationService.getConfig(le.NotebookAdditionalCodeGenerationRuleEnabled),{documentContext:o}=this.props,s=await this.ignoreService.isCopilotIgnored(o.document.uri),a=o.document.validateRange(o.wholeRange);return{summarizedDocument:await Q2(this.parserService,o.document,o.fileIndentInfo,a,r.endpoint.modelMaxPromptTokens/3),isIgnored:s,priorities:TQ,additionalCodeGenerationRule:n}}render(r,n){if(!er(this.props.documentContext.document.uri))throw pn("InlineChatNotebookEditPrompt should be used only with a notebook!");if(r.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{query:o,history:s,chatVariables:a}=this.props.promptContext,c=n0(this.props.documentContext.document.uri),{language:l}=this.props.documentContext,u=l.languageId==="markdown",d=r.summarizedDocument.splitAroundAdjustedSelection(),{codeAbove:p,codeSelected:f,codeBelow:m,hasCodeWithoutSelection:h}=d,g=`${p}$SELECTION_PLACEHOLDER$${m}`,v=d.createReplyInterpreter(hs.Mute,1,d.replaceSelectionStreaming,ji.createCodeBlockClassifier(),x=>x.value.trim()!=="$SELECTION_PLACEHOLDER$"),b=r.priorities,_=r.additionalCodeGenerationRule??!1;return vscpp(vscppf,null,vscpp("meta",{value:new Ms(v)}),vscpp(Us.SystemMessage,{priority:b.core},vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",l.languageId,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),h&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null))),c&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),u&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."),h&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null)),vscpp(ct,null)),vscpp(VC,{documentContext:this.props.documentContext,hasCodeWithoutSelection:h,codeWithoutSelection:g,codeSelected:f,priority:b.core}),vscpp(It,{inline:!0,priority:b.history??700,history:s}),vscpp(Us.UserMessage,{priority:b.context},vscpp(cr,{languageId:l.languageId})),vscpp(Kt,{priority:b.core,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:b.context,chatVariables:a}),vscpp(GC,{documentContext:this.props.documentContext,priority:b.core,priorities:b,query:o}),vscpp(Us.UserMessage,{priority:b.core},_&&vscpp(vscppf,null,"Please edit code for: "),vscpp(So,{chatVariables:a,query:o}),vscpp("br",null),h&&u&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code without ``` is:"),h&&!u&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code with ``` is:")))}};$C=E([y(1,he),y(2,Te),y(3,dt)],$C);var Wp=class{constructor(e,r,n,o,s,a){this.intent=e;this.location=r;this.endpoint=n;this.documentContext=o;this.editStrategy=s;this.instantiationService=a;this.replyInterpreter=null}async buildPrompt(e,r,n){let o;er(this.documentContext.document.uri)?o=this.editStrategy===4?zC:$C:this.documentContext.document.languageId==="markdown"?o=this.editStrategy===4?LC:MC:o=this.editStrategy===4?FC:OC;let s=Me.create(this.instantiationService,this.endpoint,o,{documentContext:this.documentContext,promptContext:e}),a=await s.render(r,n);this.replyInterpreter=s.getMeta(Ms)?.replyInterpreter??null;let c=s.getMeta(G_);return{...a,telemetryData:c&&[c]}}processResponse(e,r,n,o){if(!this.replyInterpreter)throw new Error("Could not process response without a reply interpreter!");return this.replyInterpreter.processResponse(e,r,n,o)}};Wp=E([y(5,j)],Wp);var K_;(e=>{function t(r,n){let{options:o,document:s,selection:a,visibleRanges:c}=r,l={insertSpaces:o.insertSpaces,tabSize:o.tabSize},u=mn(s);return n||(c.length===1?n=c[0]:c.length>1?n=c[0].union(c[c.length-1]):n=a),{document:s,fileIndentInfo:l,language:u,selection:a,wholeRange:n}}e.fromEditor=t})(K_||={});var fD=q(Ct());var $6=q(Ue());var o0="---",Sr;(o=>(o.FILEPATH=o0+"FILEPATH",o.FIND=o0+"FIND",o.REPLACE=o0+"REPLACE",o.COMPLETE=o0+"COMPLETE"))(Sr||={});var _d=class extends $6.PromptElement{render(){return vscpp(vscppf,null,"When proposing a code change, provide one or more modifications in the following format:",vscpp("br",null),"Each modification consist of three sections headed by `",Sr.FILEPATH,"`, `",Sr.FIND,"` and `",Sr.REPLACE,"`.",vscpp("br",null),"After ",Sr.FILEPATH," add the path to the file that needs to be changed.",vscpp("br",null),"After ",Sr.FIND," add a code block containing a section of the program that will be replaced.",vscpp("br",null),"Add multiple lines so that a find tool can find and identify a section of the programm. Start and end with a line that will not be modified. ",vscpp("br",null),"Include all comments and empty lines exactly as they appear in the original source code. Do not abreviate any line or summarize the code with `...`. ",vscpp("br",null),"After ",Sr.REPLACE," add a code block with the updated version of the original code in the find section. Maintain the same indentation and code style as in the original code.",vscpp("br",null),"After all modifications, add ",Sr.COMPLETE,".",vscpp("br",null))}},Y_=class extends $6.PromptElement{render(){return vscpp(vscppf,null,this.props.fileName?s0(this.props.fileName)+`
`:"","```",this.props.language??"",vscpp("br",null),this.props.code.join(`
`),vscpp("br",null),"```")}},Kp=class extends $6.PromptElement{render(){return vscpp(vscppf,null,this.props.changes.map(e=>vscpp(vscppf,null,s0(e.fileName),vscpp("br",null),Sr.FIND,vscpp("br",null),"```",vscpp("br",null),e.find.join(`
`),vscpp("br",null),"```",vscpp("br",null),Sr.REPLACE,vscpp("br",null),"```",vscpp("br",null),e.replace.join(`
`),vscpp("br",null),"```",vscpp("br",null))),Sr.COMPLETE)}};function s0(t){return`${Sr.FILEPATH} ${eI(t)}`}function Tye(t){return`${o0}${t}`}function z6(t){return!t.match(/\S/)}function UQ(t,e,r,n){let o=0;for(;o<e.length&&z6(e[o]);)o++;if(o===e.length){let d=$m(t,4,!1),p=t.length>0?Iye(t,0,t.length-1,d.tabSize):0,f=Sye(r,p,d);return ms.insert(n,f)}let s=e[o],a=MQ(s),c,l=0,u=o;e:for(;l<t.length;){for(;l<t.length&&!Cye(t[l],s,a);)l++;if(l===t.length)return c??{message:"First find line not found",label:"invalid patch",severity:"error"};let d=l,p=-1;for(;l<t.length&&u<e.length;){let f=t[l];if(MQ(f)===f.length){l++;continue}let h=e[u],g=MQ(h);if(g===h.length){u++;continue}if(Cye(f,h,g))p=l,l++,u++;else{l=d+1,u=o,h.indexOf("...")!==-1?c={message:"Find contains ellipses",label:"patch lazy",severity:"error"}:bKe(f)?c={message:"Find not matching a comment",label:"patch no comment",severity:"error"}:c={message:`Find line ${u} does not match line ${l}`,label:"invalid patch",severity:"error"};continue e}}for(;u<e.length&&z6(e[u]);)u++;if(u===e.length&&d!==-1&&p!==-1){let f=$m(t,4,!1),m=Iye(t,d,p,f.tabSize),h=Sye(r,m,f);return ms.replace(d,p+1,h,p===t.length-1)}}return c??{message:"Not all lines of find found",label:"invalid patch",severity:"error"}}function Eye(t){return t===32||t===9}function bKe(t){return t.match(/^\s*(\/\/|\/\*|#)/)!==null}function Sye(t,e,r){let n,o=0;for(n=0;n<t.length&&z6(t[n]);n++);if(n===t.length)return[];for(o=t.length;o>n&&z6(t[o-1]);o--);if(n===o)return[];let s=Number.MAX_SAFE_INTEGER,a=[];for(let l=n;l<o;l++){let u=t[l],d=wye(u,r.tabSize);d.length!==u.length&&d.level<s&&(s=d.level),a.push(d)}let c=[];for(let l=n;l<o;l++){let u=t[l],{level:d,length:p}=a[l-n],f=Math.max(0,e+d-s),m=r.insertSpaces?" ".repeat(r.tabSize*f):"	".repeat(f);c.push(m+u.substring(p))}return c}function MQ(t){let e=0;for(;e<t.length&&Eye(t.charCodeAt(e));)e++;return e}function Iye(t,e,r,n){let o=Number.MAX_SAFE_INTEGER;for(let s=e;s<=r;s++){let a=t[s],c=wye(a,n);c.length!==a.length&&c.level<o&&(o=c.level)}return o!==Number.MAX_SAFE_INTEGER?o:0}function wye(t,e){let r=0,n=0,o=0,s=0,a=t.length;for(;o<a;){let c=t.charCodeAt(o);if(c===32)r++,r===e&&(n++,r=0,s=o+1);else if(c===9)n++,r=0,s=o+1;else break;o++}return{level:n,length:s}}function Cye(t,e,r){t=t.replace(/\r\n$/,`
`),e=e.replace(/\r\n$/,`
`);let n=t.length-1,o=e.length-1;for(;n>=0&&o>=r&&t.charCodeAt(n)===e.charCodeAt(o);)n--,o--;if(o>=r)return!1;for(;n>=0&&Eye(t.charCodeAt(n));)n--;return n<0}function kye(t){let e=new Set;for(let r of Pye(FQ(t)))r.marker===Sr.FILEPATH&&e.add(r.content.join(`
`).trim());return[...e]}function a0(){return{getFirstParagraph(t){let e=[];for(let r of FQ(t)){if(r.length===0||r.startsWith(o0))break;e.push(r)}return e.join(`
`)},process(t,e,r,n=0){let o,s,a=[],c=[],l=[],u=[],d=[],p=[],f=new Set,m=[],h=[];e:for(let g of Pye(FQ(t)))switch(g.marker){case void 0:m=g.content;break;case Sr.FILEPATH:s=g.content.join(`
`).trim();break;case Sr.FIND:o=g.content;break;case Sr.REPLACE:{g.content&&o&&s&&(l.push({fileName:s,find:o,replace:g.content}),f.add(s));break}case Sr.COMPLETE:h=g.content;break e;default:c.push(g);break}if(l.length===0)return a.push({message:"No patch sections found",label:"no patch",severity:"error"}),{edits:u,contentAfter:h,contentBefore:m,appliedPatches:[],otherSections:c,invalidPatches:d,otherPatches:p,annotations:a};if(r){let g=eI(r.fsPath);f.has(g)||a.push({message:`No patch for input document: ${g}, patches for ${[...f.keys()].join(", ")}`,label:"other file",severity:"warning"}),f.size>1&&a.push({message:`Multiple files modified: ${[...f.keys()].join(", ")}`,label:"multi file",severity:"warning"});let v=[];for(let b of l)b.fileName!==g?p.push(b):v.push(b);l=v}if(l.length!==0){let g=Rv.fromString(e);for(let v of l){if(Am(v.find,v.replace)){a.push({message:"Patch is a no-op",label:"patch no op",severity:"error"}),d.push(v);continue}v.find.length<=1&&a.push({message:`Small patch: ${Math.min(v.find.length)}`,label:"patch small",severity:"warning"});let b=UQ(g,pD(v.find),pD(v.replace),n);b instanceof ms?_Ke(u,b.toTextEdit())||(a.push({message:"Overlapping edits",label:"overlapping edit",severity:"error"}),d.push(v)):(a.push(b),d.push(v))}}return{edits:u,appliedPatches:l,otherSections:c,invalidPatches:d,otherPatches:p,annotations:a,contentBefore:m,contentAfter:h}}}}function _Ke(t,e){for(let r=0;r<t.length;r++){let n=t[r];if(e.range.end.isBeforeOrEqual(n.range.start))return t.splice(r,0,e),!0;if(e.range.start.isBefore(n.range.end))return!1}return t.push(e),!0}function pD(t){let e=[],r,n=/^`{3,}/;for(let o of t){let s=o.match(n);if(s)if(r){if(s[0]===r)return e;e.push(o)}else r=s[0];else r&&e.push(o)}return t}async function*Rye(t){let e,r=[],n=Xn.map(t,a=>a.delta.text),o=new Wm(n[Symbol.asyncIterator]());for(;!o.endOfStream;){let a=await o.readLineIncludingLF(),c;if(a.startsWith(o0)){a.startsWith(Sr.FILEPATH)?c=Sr.FILEPATH:a.startsWith(Sr.FIND)?c=Sr.FIND:a.startsWith(Sr.REPLACE)?c=Sr.REPLACE:a.startsWith(Sr.COMPLETE)?c=Sr.COMPLETE:c=s(a),yield{marker:e,content:r},r=[s(a.substring(c.length))],e=c;continue}r.push(s(a))}yield{marker:e,content:r};function s(a){return a.endsWith(`
`)?a.slice(0,-1):a}}function*Pye(t){let e,r=[];for(let n of t){let o;if(n.startsWith(o0)){n.startsWith(Sr.FILEPATH)?o=Sr.FILEPATH:n.startsWith(Sr.FIND)?o=Sr.FIND:n.startsWith(Sr.REPLACE)?o=Sr.REPLACE:n.startsWith(Sr.COMPLETE)?o=Sr.COMPLETE:o=n,yield{marker:e,content:r},r=[n.substring(o.length)],e=o;continue}r.push(n)}yield{marker:e,content:r}}function*FQ(t){let e=0,r=t.indexOf(`
`);for(;r!==-1;)yield t.substring(e,r),e=r+1,r=t.indexOf(`
`,e);e<t.length&&(yield t.substring(e))}var Go=q(Ue());var W6=class extends Go.PromptMetadata{constructor(r,n,o){super();this.projectedDocument=r;this.documentUri=n;this.selection=o}},WC=class extends Go.PromptElement{constructor(r,n,o){super(r);this.ignoreService=n;this.parserService=o}async render(r,n){let{document:o,fileIndentInfo:s,selection:a}=this.props.documentContext;if(await this.ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});let l=n.endpoint.modelMaxPromptTokens/3*4,u;if(o.getText().length>l){let d=await Ap(this.parserService,o,s??Ave(o));u=Lv(l,o,a,d,{tryPreserveTypeChecking:!1})}else u=new ll(o.getText(),Or.empty,o.languageId);return vscpp(vscppf,null,vscpp("references",{value:[new Go.PromptReference(o.uri)]}),vscpp("meta",{value:new W6(u,o.uri,a)}),vscpp(Go.SystemMessage,{priority:1e3},"You are an AI programming assistant that is specialized in applying code changes to an existing document.",vscpp("br",null),"I have a code block that represents a suggestion for a code change and I have a ",o.languageId," file opened in a code editor.",vscpp("br",null),"I expect you to come up with code changes that apply the code block to the editor at a given selection. ",vscpp("br",null),"I want the changes to be applied in a way that is safe and does not break the existing code, is correctly indented and matching the code style.",vscpp("br",null),"For the response, always follow these instructions:",vscpp("br",null),"1. Analyse the code block, the content of the editor and the current selection to decide if the code block should replace existing code or is to be inserted.",vscpp("br",null),"2. A comment like `",BQ.forLanguage(o.languageId),"` indicates a section of code that has not changed",vscpp("br",null),"3. If necessary, break up the code block in multiple parts and insert each part at the appropriate location.",vscpp("br",null),"4. If necessary, make changes to other parts in the editor so that the final result is valid, properly formatted and indented.",vscpp("br",null),"5. Finally, provide the code modifications",vscpp("br",null),vscpp(_d,null),vscpp("br",null),vscpp(ct,null),vscpp(kt,null)),vscpp(Go.UserMessage,{priority:100},"I have the following code open in the editor.",vscpp("br",null),vscpp(Y_,{fileName:"someFolder/myFile.ts",language:"typescript",code:["import { readFileSync } from 'fs';","","class C { }"]}),vscpp("br",null),"This is the code block that represents a suggestion for a code change:",vscpp("br",null),vscpp(Y_,{code:["private _stream: Stream;"]}),vscpp("br",null),"Please find out how the code block can be applied to the editor."),vscpp(Go.AssistantMessage,{priority:100},vscpp(Kp,{changes:[{fileName:"someFolder/myFile.cs",find:["import { readFileSync } from 'fs';"],replace:["import { readFileSync } from 'fs';","import { Stream } from 'stream';"]},{fileName:"someFolder/myFile.ts",find:["class C { }"],replace:["class C {","	private _stream: Stream;","}"]}]})),vscpp(Go.UserMessage,{priority:700},vscpp(ia,null,u.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",u.lineCount,".",vscpp("br",null),s0(o.fileName),vscpp("br",null),vscpp(nt,{uri:o.uri,languageId:o.languageId,code:u.text,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",s0(o.fileName),vscpp("br",null))),this.renderSelection(u),"This is the code block that represents a suggestion for a code change:",vscpp("br",null),vscpp(nt,{uri:o.uri,languageId:o.languageId,code:this.props.codeBlock,shouldTrim:!1}),vscpp("br",null),vscpp(Go.TextChunk,null,"Please find out how the code block can be applied to the editor. Provide the code changes in the format as described above.",vscpp("br",null))))}renderSelection(r){let{document:n,selection:o}=this.props.documentContext;if(!o)return;let s=r.projectRange(o),a=n.getText(new Be(o.start.line,0,o.end.line+1,0)).trimEnd();return vscpp(vscppf,null,s.isEmpty?vscpp(vscppf,null,"I have the selection at line ",s.start.line+1,", column ",s.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",s.start.line+1,", column ",s.start.character+1," to line ",s.end.line+1," column ",s.end.character+1,".",vscpp("br",null),a.length>0?vscpp(vscppf,null,"This is the content of the lines that contain the selection:",vscpp(nt,{uri:n.uri,languageId:n.languageId,code:a,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"The selection consists of whitespaces only.")))}};WC=E([y(1,Te),y(2,dt)],WC);var BQ=new class{forLanguage(t){let e=t?mn(t):{lineComment:{start:"//",end:void 0}},{start:r,end:n}=e.lineComment;return n?`${r} ...existing code... ${n}`:`${r} ...existing code...`}},BZt=new class{forLanguage(t){let e=t?mn(t):{lineComment:{start:"//",end:void 0}},{start:r,end:n}=e.lineComment;return n?`${r} filepath: /path/to/file.ts ${n}`:`${r} filepath: /path/to/file.ts`}};function Aye(t,e,r){if(t){let c=Ls(e);if(c.length!==1)throw new Error("Expected exactly one code block in the code mapper response");let l=t.getText().match(/\n*$/)?.[0]??"",u=c[0].code.trimEnd()+l,d=new Be(new xr(0,0),new xr(t.lineCount,0));return{edits:[new Nn(d,u)],annotations:[]}}let n=r.getMeta(W6);if(!n)throw new Error("CodeMapperPrompt: Metadata not found");let o=a0(),s=n.selection?n.projectedDocument.projectRange(n.selection).start.line:void 0,a=o.process(e,n.projectedDocument.text,n.documentUri,s);return{edits:n.projectedDocument.projectBackTextEdit(a.edits),annotations:a.annotations}}var KC=class extends Go.PromptElement{constructor(r,n){super(r);this.ignoreService=n}async render(r,n){let{document:o}=this.props.documentContext;return await this.ignoreService.isCopilotIgnored(o.uri)?vscpp("ignoredFiles",{value:[o.uri]}):vscpp(vscppf,null,vscpp("references",{value:[new Go.PromptReference(o.uri)]}),vscpp(Go.SystemMessage,{priority:1e3},"You are an AI programming assistant that is specialized in applying code changes to an existing document.",vscpp("br",null),vscpp(ct,null),"The user has a code block that represents a suggestion for a code change and a ",o.languageId," file opened in a code editor.",vscpp("br",null),"Rewrite the existing document to fully incorporate the code changes in the provided code block.",vscpp("br",null),"For the response, always follow these instructions:",vscpp("br",null),"1. Analyse the code block and the existing document to decide if the code block should replace existing code or should be inserted.",vscpp("br",null),"2. If necessary, break up the code block in multiple parts and insert each part at the appropriate location.",vscpp("br",null),"3. Preserve whitespace and newlines right after the parts of the file that you modify. 4. The final result must be syntactically valid, properly formatted, and correctly indented.",vscpp("br",null),"5. Finally, provide the fully rewritten file.",vscpp("br",null)),vscpp(Go.UserMessage,{priority:700},o.lineCount>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",o.lineCount,".",vscpp("br",null),vscpp(nt,{uri:o.uri,languageId:o.languageId,code:o.getText(),shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty editor."),"This is the code block that represents the suggested code change:",vscpp("br",null),vscpp(nt,{uri:o.uri,languageId:o.languageId,code:this.props.codeBlock,shouldTrim:!1}),vscpp("br",null),"Rewrite the code in the current editor to incorporate the suggested code change.",vscpp("br",null)))}};KC=E([y(1,Te)],KC);async function xKe(t,e,r,n){let{uri:o,lineCount:s}=t,a=IKe(t),c="```",l=Xn.map(e,g=>g.delta.text),u=new Wm(l[Symbol.asyncIterator]()),d=[],p=g=>{d.push(g),f<s?r.textEdit(o,[Nn.replace(new Be(f,0,f,1073741824),g)]):r.textEdit(o,[Nn.replace(new Be(f,1073741824,f,1073741824),`
`+g)]),f+=1},f=0,m=!1;for(;!u.endOfStream&&!n.isCancellationRequested;){let g=await u.readLine();if(g.startsWith(c)&&m){m=!1;break}else g.startsWith(c)?m=!0:m&&p(g)}let h=CKe(d);for(let g=h;g<a;g++)p("");f<s&&r.textEdit(o,[Nn.delete(new Be(f-1,d.length>0?d[d.length-1].length:0,s,0))])}async function SKe(t,e,r,n,o){let s=Rv.fromString(e);function a(d){if(Am(d.find,d.replace))return;let p=UQ(s,pD(d.find),pD(d.replace),0);p instanceof ms&&(n.textEdit(t,p.toTextEdit()),s=p.apply(s))}let c,l,u=[];for await(let d of Rye(r))switch(d.marker){case void 0:break;case Sr.FILEPATH:l=d.content.join(`
`).trim();break;case Sr.FIND:c=d.content;break;case Sr.REPLACE:{d.content&&c&&l&&a({fileName:l,find:c,replace:d.content});break}case Sr.COMPLETE:break;default:u.push(d);break}}var Q_=class{constructor(e,r,n){this.codeBlock=e;this.textBeforeCodeBlock=r;this.documentContext=n}isEqualTo(e){return this.documentContext.document.version===e.documentContext.document.version&&od(this.documentContext.document.uri,e.documentContext.document.uri)&&this.isEqualCodeBlock(e.codeBlock)&&this.textBeforeCodeBlock===e.textBeforeCodeBlock&&this.isEqualSelection(e.documentContext.selection)}isEqualCodeBlock(e){return this.codeBlock===e}isEqualSelection(e){let r=this.documentContext.selection;return r===e?!0:r===void 0||e===void 0?!1:r.isEqual(e)}},c0=class{constructor(e,r,n,o,s,a,c){this.endpointProvider=e;this.chatMLFetcher=r;this.configurationService=n;this.experimentationService=o;this.instantiationService=s;this.tokenizerProvider=a;this.logService=c}async mapCode({codeBlock:e,documentContext:r,textBeforeCodeBlock:n},o,s){let a=this.configurationService.getExperimentBasedConfig(le.CodeMapperChatEndpoint,this.experimentationService)??"gpt-4",c=await this.endpointProvider.getChatEndpoint(a),l=this.tokenizerProvider.acquireTokenizer(c).tokenLength(r.document.getText())<4096/4*3,u=new Mp,d=l?KC:WC,p=o?async(S,I,w)=>{u.update(S,w)}:void 0,f;o&&(l?f=xKe(r.document,u.stream,o,s):f=SKe(r.document.uri,r.document.getText(),u.stream,o,s));let m=Me.create(this.instantiationService,c,d,{documentContext:r,codeBlock:e,textBeforeCodeBlock:n}),h=Date.now(),g=await m.render(void 0,s);if(s.isCancellationRequested)return;let v=await this.chatMLFetcher.fetchOne("codeMapper",g.messages,p,s,3,c);u.resolve(),await f;let b,_,x=(S,I,w)=>({edits:S,errorMessage:w,annotations:I,telemetry:{endpoint:c,timeToComplete:Date.now()-h,fetchResult:v}});if(v.type==="success")if(o)b=x([],[],void 0);else{let S=Aye(l?r.document:void 0,v.value,m);S.edits.length===0?b=x([],S.annotations,fD.t("The code mapper request did not return any edits.")):b=x(S.edits,S.annotations,void 0)}else{switch(v.type){case"rateLimited":_=fD.t("The request to Copilot was rate-limited. Please wait and try sending again later.");break;case"filtered":_=fD.t("The request to Copilot was filtered.");break;case"canceled":return;default:_=fD.t("The request to Copilot failed.")}b=x([],[{label:_,message:`request ${v.type}`,severity:"error"}],_)}return(b.annotations.length||b.errorMessage)&&this.logService.public.info(`[code mapper] Problems generating edits: ${b.annotations.map(S=>`${S.message} [${S.label}]`).join(", ")}, ${_}`),b}};c0=E([y(0,xe),y(1,yt),y(2,he),y(3,Lt),y(4,j),y(5,_r),y(6,ie)],c0);function IKe(t){let e=0;for(let r=t.lineCount-1;r>=0&&t.lineAt(r).text.trim()==="";r--)e++;return e}function CKe(t){let e=0;for(let r=t.length-1;r>=0&&t[r].trim()==="";r--)e++;return e}var qQ=class{constructor(e,r){this.codeMapper=e;this.input=r;this.collectedEdits=[];this.cancellationTokenSource=new Ahe;let n={textEdit:(o,s)=>{this.responseStream?this.responseStream.textEdit(o,s):this.collectedEdits.push({target:o,edits:s})}};this.promise=this.codeMapper.mapCode(r,n,this.cancellationTokenSource.token)}async getResult(e,r){if(r.isCancellationRequested){this.cancellationTokenSource.cancel();return}this.responseStream=e,this.collectedEdits.forEach(o=>e.textEdit(o.target,o.edits));let n=r.onCancellationRequested(()=>this.cancellationTokenSource.cancel());try{return await this.promise}finally{n.dispose()}}cancel(){this.cancellationTokenSource.cancel()}},QC=ne("ICodeMapperService"),YC=class extends Oe{constructor(r,n,o,s,a){super();this.instantiationService=r;this._tabsAndEditorsService=n;this._workspaceService=o;this._fileSystemService=s;this._logService=a;this.cachedCodeMapperRequests=new Nr;this.codeMapper=this.instantiationService.createInstance(c0),this._workspaceService.onDidChangeTextDocument(c=>{let l=c.document.uri,u=this.cachedCodeMapperRequests.get(l);if(u){for(let d of u)d.cancel();this.cachedCodeMapperRequests.delete(l),this._logService.public.debug(`[CodeMapperService] clear cache: ${l}`)}})}async triggerComputation(r,n){let o=await this._getDocumentContextForCodeBlock(r);if(!o)return;let s=this.cachedCodeMapperRequests.get(o.document.uri);s||(s=[],this.cachedCodeMapperRequests.set(o.document.uri,s)),this._logService.public.debug(`[CodeMapperService] trigger request: ${r.resource.path}`);let a=new Q_(r.code,n,o);s.push(new qQ(this.codeMapper,a))}async _mapCodeBlock(r,n,o){let s=this.cachedCodeMapperRequests.get(r.documentContext.document.uri);if(s){let a=s.find(c=>c.input.isEqualTo(r));if(a)return this._logService.public.debug(`[CodeMapperService] using cached request: ${r.documentContext.document.uri.path}`),s.splice(s.indexOf(a),1),a.getResult(n,o)}return this._logService.public.debug(`[CodeMapperService] new request: ${r.documentContext.document.uri.path}`),this.codeMapper.mapCode(r,n,o)}async mapCode(r,n,o){let s=new Nr,a=[];for(let c of r.codeBlocks){let l;if(s.has(c.resource)){this._logService.public.debug("[CodeMapperService] skipping code block because it is in the same document as a previous code block");continue}else l=this._getDocumentContextForCodeBlock(c),s.set(c.resource,l);let u=await l;if(!u){n.textEdit(c.resource,new Nn(new Be(0,0,0,0),c.code));continue}let d=new Q_(c.code,(c.code,r.conversation,void 0),u);if(a.push(this._mapCodeBlock(d,n,o)),o.isCancellationRequested)return}return Promise.allSettled(a).then(c=>{let l=[],u=[];for(let d of c)if(d.status==="fulfilled"){let p=d.value;if(!p)return;l.push(...p.annotations),p.errorMessage&&u.push(p.errorMessage)}else u.push(d.reason.message);return{annotations:l,errorMessage:u.length?u.join(`
`):void 0}})}async _getDocumentContextForCodeBlock(r){let n=this._tabsAndEditorsService.visibleTextEditors.find(a=>od(a.document.uri,r.resource));if(n)return K_.fromEditor(n);let o=this._workspaceService.textDocuments.find(a=>od(a.uri,r.resource));if(o)return{document:o};if(await this._fileSystemService.stat(r.resource).then(()=>!0,()=>!1))try{return{document:await this._workspaceService.openTextDocument(r.resource)}}catch{return}}};YC=E([y(0,j),y(1,Ft),y(2,qe),y(3,mr),y(4,ie)],YC);var Dye=q(Ct()),pl=q(Ue());var K6=class extends pl.PromptElement{async render(e,r){let{history:n}=this.props.promptContext;return vscpp(vscppf,null,vscpp(pl.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp("br",null),"The user has a request for modifying one or more files.",vscpp("br",null),"Please come up with a solution that you first describe step-by-step, then provide the updated code using markdown code blocks.",vscpp("br",null),"Each code block starts with a comment containing the filepath.",vscpp("br",null),"Use one code block per file that needs to be modified.",vscpp("br",null),"Avoid repeating the entire file contents in the code blocks.",vscpp("br",null),"Use `",BQ.forLanguage(this.props.session.languageId),"` comments to represent regions of unchanged code.",vscpp("br",null),vscpp(kt,null),"Here is an example of how you should format a code block belonging to the file example.ts in your response:",vscpp("br",null),["```typescript","// filepath: /Users/someone/proj01/example.ts","class Person {","	// ...existing code...","	age: number;","	// ...existing code...","	getAge() {","		return this.age;","	}","}","```"].join(`
`)),vscpp(It,{flexGrow:1,priority:700,history:n,omitPromptVariables:!0}),vscpp(mD,{flexGrow:2,priority:900,...this.props}))}},mD=class extends pl.PromptElement{constructor(r,n,o){super(r);this.experimentationService=n;this._configurationService=o}async render(r,n){let{query:o,chatVariables:s}=this.props.promptContext,a=this.props.session.workingSet,c=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsChat,this.experimentationService);return vscpp(vscppf,null,vscpp(pl.UserMessage,null,c&&vscpp(qi,{flexGrow:1,priority:600,embeddedInsideUserMessage:!0}),vscpp(cr,{flexGrow:5,priority:750,languageId:void 0}),vscpp(Kt,{flexGrow:4,priority:899,embeddedInsideUserMessage:!0,endpoint:this.props.endpoint,promptContext:this.props.promptContext,documentContext:this.props.documentContext}),vscpp(Ci,{flexGrow:3,priority:899,embeddedInsideUserMessage:!0,chatVariables:s}),vscpp(jQ,{flexGrow:2,flexReserve:n.tokenBudget*.8,priority:810,workingSet:a}),vscpp("br",null),"<prompt>",vscpp(So,{flexGrow:6,priority:900,chatVariables:s,query:o}),vscpp("br",null),"</prompt>"))}};mD=E([y(1,Lt),y(2,he)],mD);var jQ=class extends pl.PromptElement{render(e,r){let n=this.props.workingSet;return vscpp(vscppf,null,n.map((o,s)=>vscpp(hD,{entry:o,flexGrow:s})))}},hD=class extends pl.PromptElement{constructor(r,n,o){super(r);this._ignoreService=n;this.instantiationService=o}async render(r,n){let{document:o,range:s,renderSelection:a}=this.props.entry;if(await this._ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});let u=await this.instantiationService.createInstance(Op).summarizeDocument(o,void 0,s,n.tokenBudget,{costFnOverride:LY}),d=u.isOriginal?void 0:{status:{description:Dye.t("Part of this file was not sent to the model due to context window limitations. Try attaching specific selections from your file instead."),kind:2}};return vscpp(ia,{priority:this.props.priority},"<file>",vscpp(nt,{includeFilepath:!0,languageId:o.languageId,uri:o.uri,references:[new pl.PromptReference(o.uri,void 0,d)],code:u.text}),vscpp("br",null),"</file>",a&&vscpp(gD,{document:o,selection:s}))}};hD=E([y(1,Te),y(2,j)],hD);var gD=class extends pl.PromptElement{constructor(r,n){super(r);this._ignoreService=n}async render(r,n){let{document:o,selection:s}=this.props;if(!o||!s)return;if(await this._ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});if(o.lineCount>=4){let c=[],l=()=>c.reduce((m,h)=>m+h.length,0),u=Math.max(0,s.start.line),d=Math.min(o.lineCount-1,s.end.line);d>u&&s.end.character===0&&d--,u<d&&s.start.character===o.lineAt(u).text.length&&u++;for(let m=u;m<=d;m++){let h=o.lineAt(m);c.push(h.text)}let p=u-1,f=d+1;for(;c.length<4&&l()<10;)p>=0&&(c.unshift(o.lineAt(p).text),p--),f<o.lineCount&&(c.push(o.lineAt(f).text),f++);return vscpp(vscppf,null,"<file-selection>",vscpp(nt,{includeFilepath:!0,languageId:o.languageId,uri:o.uri,references:[new pl.PromptReference(o.uri,void 0)],code:c.join(`
`),shouldTrim:!1}),vscpp("br",null),"</file-selection>")}else return}};gD=E([y(1,Te)],gD);var XC=class{constructor(e){this._workspaceService=e;this.workingSet=[]}get languageId(){if(this.workingSet.length>0)return this.workingSet[this.workingSet.length-1].document.languageId}async updateWorkingSet(e,r){r=r.reverse();for(let o of r)o.value instanceof nr&&this._addWorkingSetEntry(await this._resolveWorkingSetEntry({uri:o.value})),o.value instanceof fn&&this._addWorkingSetEntry(await this._resolveWorkingSetEntry({uri:o.value.uri,range:o.value.range}));if(e){let{document:o,selection:s}=e;this._getWorkingSetEntry(o.uri)||this._addWorkingSetEntry({document:o,range:s,renderSelection:!0})}return r.filter(o=>!(o.value instanceof nr||o.value instanceof fn))}async _resolveWorkingSetEntry(e){try{return{document:await this._workspaceService.openTextDocument(e.uri),range:e.range,renderSelection:e.renderSelection}}catch{return null}}_addWorkingSetEntry(e){e&&this.workingSet.push(e)}_getWorkingSetEntry(e){return this.workingSet.find(r=>r.document.uri.toString()===e.toString())}};XC=E([y(0,qe)],XC);var xd=class{constructor(e,r,n){this.instantiationService=e;this.endpointProvider=r;this.configurationService=n;this.id=xd.ID;this.description=Y6.t("Make changes to existing code");this.locations=[1,2]}static{this.ID="edit"}get intentDetectionInput(){let e="edit_text";return{functionName:e,sampleQuestion:"Change this method to use async/await",modelDescription:"Make changes to existing code",functionCallingBlurb:`If the user's message appears related to refactoring or changing existing code, such as the code in the active selection, you should use the '${e}' function.`}}get commandInfo(){return{hiddenFromUser:!this.configurationService.getConfig(le.PanelEditingEnabled)}}async invoke(e){let{location:r,documentContext:n,request:o}=e,s=await this.endpointProvider.getChatEndpoint(o);if(r===2)return this.instantiationService.createInstance(X_,this,r,s,n);if(!n)throw new Error("Open a file to add code.");return this.instantiationService.createInstance(Wp,this,r,s,n,2)}};xd=E([y(0,j),y(1,xe),y(2,he)],xd);var X_=class extends us{constructor(r,n,o,s,a,c,l,u,d){super(r,n,o);this.documentContext=s;this.instantiationService=a;this.envService=c;this.runCommandExecutionService=l;this.configurationService=u;this.codeMapperService=d;this._session=void 0;this.linkification={disable:!0}}async createRenderer(r,n,o,s){this._session=this._getPreviousSession(r.previousConversation)??this.instantiationService.createInstance(XC);let a=await this._session.updateWorkingSet(this.documentContext,r.chatVariables);return Me.create(this.instantiationService,n,K6,{session:this._session,endpoint:n,promptContext:{...r,chatVariables:a}})}_getPreviousSession(r){let n=r?.getLatestTurn()?.intentInvocation;return n instanceof X_?n._session:void 0}async processResponse(r,n,o,s){let a="```",c=/^(`+)([^ \n]*)/,l=Xn.map(n,p=>p.delta.text),u=new Wm(l[Symbol.asyncIterator]()),d=this.envService.hasNewMappedEditsProviderAPI()&&this.configurationService.getConfig(le.EditIntentAutoApply);for(;!u.endOfStream;){for(;!u.endOfStream&&await u.peek(a.length)!==a;)await Nye(u,o);if(u.endOfStream)break;let p=await u.readLineIncludingLF();o.markdown(p);let f=p.match(c),m=f?f[2]:void 0,h=mn(m),g=`${h.lineComment.start} filepath:`,v="// filepath:",b=h.lineComment.end??"",_,x=[];for(;!u.endOfStream;){let I=await u.peek(Math.max(a.length,g.length,v.length));if(I.startsWith(a))break;if(!_&&(I.startsWith(g)||I.startsWith(v))){let w=await u.readLineIncludingLF(),k=I.startsWith(g)?w.substring(g.length):w.substring(v.length);k=k.trim(),k.endsWith(b)&&(k=k.substring(0,k.length-b.length)),k=k.trim(),_=He.parse(k),o.codeblockUri(_);continue}await Nye(u,o,x)}if(_&&(x[x.length-1]===`
`&&x.pop(),d&&this.codeMapperService.triggerComputation({resource:_,code:x.join("")})),u.endOfStream)break;let S=await u.readLineIncludingLF();o.markdown(S)}if(this.envService.hasNewMappedEditsProviderAPI())if(d){let p=new UM;o.progress("Computing file changes...",async()=>(await Fl(1500),await this.runCommandExecutionService.executeCommand("workbench.action.chat.applyAll"),p.open(),Y6.t("Applied file changes"))),await p.wait()}else o.button({command:"workbench.action.chat.applyAll",title:Y6.t("Apply...")})}};X_=E([y(4,j),y(5,gt),y(6,dl),y(7,he),y(8,QC)],X_);async function Nye(t,e,r){for(;!t.endOfStream;){let n=t.readImmediateExcept(`
`);if(n.length>0&&(e.markdown(n),r?.push(n)),await t.peek(1)===`
`){t.readImmediate(1),e.markdown(`
`),r?.push(`
`);break}}}var Lye=q(Ct());var Sd=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=Sd.ID;this.description=Lye.t("Generate new code");this.locations=[1];this.commandInfo={hiddenFromUser:!0}}static{this.ID="generate"}get intentDetectionInput(){let e="generate_code_or_markdown";return{functionName:e,sampleQuestion:"Add a function that returns the sum of two numbers",modelDescription:"Generate new code",functionCallingBlurb:`If the user's message appears related to generating new code, you should use the '${e}' function.`}}async invoke(e){let{location:r,documentContext:n,request:o}=e;if(!n)throw new Error("Open a file to add code.");let s=await this.endpointProvider.getChatEndpoint(o);return this.instantiationService.createInstance(Wp,this,r,s,n,4)}};Sd=E([y(0,j),y(1,xe)],Sd);var l0=class extends us{constructor(r,n,o,s=Fv,a,c){super(r,n,o);this.prompt=s;this.documentContext=a;this.instantiationService=c}createRenderer(r,n,o,s){return Me.create(this.instantiationService,n,this.prompt,{documentContext:this.documentContext,endpoint:n,promptContext:r})}};l0=E([y(5,j)],l0);var aa=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=aa.ID;this.locations=[1,2];this.description="Intent of this command is unclear or is not related to information technologies";this.commandInfo={hiddenFromUser:!0};this.intentDetectionInput={sampleQuestion:"Add a dog to this comment."}}static{this.ID="unknown"}async invoke(e){let{location:r,documentContext:n,request:o}=e,s=await this.endpointProvider.getChatEndpoint(o);if(r===1){if(!n)throw new Error("Open a file to add code.");return this.instantiationService.createInstance(Wp,this,r,s,n,2)}return this.instantiationService.createInstance(l0,this,r,s,void 0,n)}};aa=E([y(0,j),y(1,xe)],aa);var J_="_github.copilot.openRelativePath",JC="_github.copilot.openSymbolInFile",vD=[J_,JC,"_github.copilot.openSymbolFromReferences"];function Yp(t,e){return`command:${t}?${encodeURIComponent(JSON.stringify(e))}`}function Q6(t,e,r){let n=t;n.startsWith("`")||(n=n.replace(/(?<!\\)\[/g,"\\[").replace(/(?<!\\)\]/g,"\\]"));let o=e.replace(/(?<!\\)\(/g,"\\(").replace(/(?<!\\)\)/g,"\\)");return`[${n}](${o} "${TKe(r)}")`}function TKe(t){return t.replace(/"/g,'\\"')}var X6=class{constructor(e,r){this.value=e;this.title=r}};function yD(t){let e=[];for(let r of t){let n=e.at(-1);typeof r=="string"&&typeof n=="string"?e[e.length-1]=n+r:e.push(r)}return e}var ZC=class{constructor(e,r){this.fileSystem=e;this.workspaceService=r}async linkify(e,r,n){let o=0,s=await this.doLinkifyParts(/\[(`?)([^`\s]+)\1\]\((\2)\)/g,[e],a=>a[2],r,n);return o+=s.addedLinkCount,n.isCancellationRequested?{parts:[],addedLinkCount:0}:(s=await this.doLinkifyParts(/(?<!\[)`([^`\s]+)`(?!\])/g,s.parts,a=>a[1],r,n),o+=s.addedLinkCount,s=await this.doLinkifyParts(/(?<![\[`()<])(\S+\.\S+)(?![\]`])/gu,s.parts,a=>a[1],r,n),o+=s.addedLinkCount,s)}async doLinkifyParts(e,r,n,o,s){let a=0,c=[];for(let l of r)if(typeof l=="string"){let u=0;for(let p of l.matchAll(e)){let f=l.slice(u,p.index);f&&c.push(f);let m=p[0],h=n(p),g=await this.resolvePathText(h,o);if(s.isCancellationRequested)return{parts:[],addedLinkCount:0};g?(a++,c.push(new X6(g))):c.push(m),u=p.index+m.length}let d=l.slice(u);d&&c.push(d)}else c.push(l);return{parts:yD(c),addedLinkCount:a}}async resolvePathText(e,r){let n=this.workspaceService.getWorkspaceFolders();if(/^[\w\-_]+:/.test(e)||!n.length||e.length<2)return;if(e.startsWith("/"))try{let a=nr.file(e);if(await this.exists(a))return a}catch{}for(let a of n){let c=nr.joinPath(a,e);if(await this.exists(c))return c}let o=RM(e);return r.references.map(a=>"variableName"in a.anchor?jA(a.anchor.value)?a.anchor.value:a.anchor.value?.uri:jA(a.anchor)?a.anchor:a.anchor.uri).filter(a=>!!a).find(a=>Ml(a)===o)}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};ZC=E([y(0,mr),y(1,qe)],ZC);function Oye(t,e,r){return Q6("`"+t+"`",Yp(J_,[bD(e),r]),e.fsPath)}function bD(t){return{scheme:t.scheme,authority:t.authority,path:t.path,query:t.query,fragment:t.fragment}}var Jl;(s=>{let t;(u=>(u[u.Default=0]="Default",u[u.CodeBlock=1]="CodeBlock",u[u.Accumulating=2]="Accumulating"))(t=s.Type||={});let e;(u=>(u[u.Word=0]="Word",u[u.InlineCode=1]="InlineCode",u[u.PotentialLink=2]="PotentialLink"))(e=s.AccumulationType||={}),s.Default={type:0};class n{constructor(c,l,u=""){this.fence=c;this.indent=l;this.contents=u;this.type=1}appendContents(c){return new n(this.fence,this.indent,this.contents+c)}}s.CodeBlock=n;class o{constructor(c,l=0){this.pendingText=c;this.accumulationType=l;this.type=2}}s.Accumulating=o})(Jl||={});var J6=class{constructor(e,r=[]){this.context=e;this.linkifiers=r;this._state=Jl.Default;this._appliedText="";this._totalAddedLinkCount=0}get totalAddedLinkCount(){return this._totalAddedLinkCount}async append(e,r,n){let o={parts:[],trustedCommands:r?.length?vM([...vD,...r]):vD,addedLinkCount:0};for(let s of e.split(/(\s+)/))if(s.length)switch(this._state.type){case 0:{/^\s+$/.test(s)?o=eT(o,this.doAppend(s)):/^[^\[`]*`[^`]*$/.test(s)?this._state=new Jl.Accumulating(s,1):/^\s*\[[^\]]+$/.test(s)?this._state=new Jl.Accumulating(s,2):this._state=new Jl.Accumulating(s);break}case 1:{if(new RegExp("(^|\\n)"+this._state.fence+"($|\\n)").test(s)||this._state.contents.length>2&&new RegExp("(^|\\n)\\s*"+this._state.fence+"($|\\n\\s*$)").test(this._appliedText+s)){let a=this._appliedText.match(/(\n|^)([ \t]*)[`~]*$/);if(a&&a[2].length<=this._state.indent.length){this._state=Jl.Default,o=eT(o,this.doAppend(s));break}}this._state=this._state.appendContents(s),o=eT(o,this.doAppend(s));break}case 2:{let a=async c=>{let l=c.pendingText+s;this._state=Jl.Default;let u=await this.doLinkifyAndAppend(l,n);o=eT(o,u)};if(this._state.accumulationType===2){if(/]/.test(s)){this._state=new Jl.Accumulating(this._state.pendingText+s,0);break}else if(/\n/.test(s)){await a(this._state);break}}else if(this._state.accumulationType===1&&/`/.test(s)){await a(this._state);break}else if(this._state.accumulationType===0&&/\s/.test(s)){let c=this._state.pendingText+s;this._state=Jl.Default;let l=c.match(/(^|\n)\s*(`{3,}|~{3,})/);if(l){let u=this._appliedText.match(/(\n|^)([ \t]*)$/);this._state=new Jl.CodeBlock(l[2],u?.[2]??""),o=eT(o,this.doAppend(c))}else o=eT(o,await this.doLinkifyAndAppend(c,n));break}this._state=new Jl.Accumulating(this._state.pendingText+s,this._state.accumulationType);break}}return o}async flush(e){let r;switch(this._state.type){case 1:{r=this.doAppend(this._state.contents);break}case 2:{let n=this._state.pendingText;r=await this.doLinkifyAndAppend(n,e);break}}return this._state=Jl.Default,r}doAppend(e){return this._appliedText=this._appliedText+e,{parts:[e],trustedCommands:vD,addedLinkCount:0}}async doLinkifyAndAppend(e,r){this.doAppend(e);let n=new Set(vD),o=0,s=[e];for(let a of this.linkifiers){let c=[];for(let l of s)if(typeof l=="string"){let u=await a.linkify(l,this.context,r);if(r.isCancellationRequested)return{parts:[],addedLinkCount:0};if(u){c.push(...u.parts),o+=u.addedLinkCount;for(let d of u.trustedCommands??[])n.add(d)}else c.push(l)}else c.push(l);s=yD(c)}return s=s.map(a=>typeof a=="string"?a.replace(/\[([^\[\]]+)]\(([^\s\)]+)\)/g,(c,l,u)=>/^\w+:/.test(u)?c:l):a),this._totalAddedLinkCount+=o,{parts:s,trustedCommands:Array.from(n),addedLinkCount:o}}};function eT(t,e){return{parts:yD([...t.parts,...e.parts]),trustedCommands:Array.from(new Set([...t.trustedCommands??[],...e.trustedCommands??[]])),addedLinkCount:t.addedLinkCount+e.addedLinkCount}}var tT=class{constructor(e,r){this.fileSystem=e;this.workspaceService=r}async linkify(e,r,n){let o=this.workspaceService.getWorkspaceFolders(),s=0;if(e=await DM(e,/\[`([^`\[\]]+?)`]\((\S+?\.\w+)\)/g,async(a,c,l)=>{for(let u of o){let d=nr.joinPath(u,l);if(await this.exists(d))return s++,EKe(d,c,r.requestId)}return"`"+c+"`"}),!(!s||n.isCancellationRequested))return{parts:[e],trustedCommands:[JC],addedLinkCount:s}}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};tT=E([y(0,mr),y(1,qe)],tT);function EKe(t,e,r){return Q6("`"+e+"`",Yp(JC,[bD(t),e,r]),t.fsPath)}var nT=ne("ILinkifyService"),rT=class{constructor(e,r){this.globalLinkifiers=new Set;this.registerGlobalLinkifier({create:()=>new ZC(e,r)}),this.registerGlobalLinkifier({create:()=>new tT(e,r)})}registerGlobalLinkifier(e){if(this.globalLinkifiers.has(e))throw new Error("Linkifier already registered");return this.globalLinkifiers.add(e),{dispose:()=>this.globalLinkifiers.delete(e)}}createLinkifier(e,r){return new J6(e,[...r,...this.globalLinkifiers].map(n=>n.create()))}};rT=E([y(0,mr),y(1,qe)],rT);var u0=class{constructor(e,r,n,o,s){this.sequencer=Promise.resolve();this._linkifier=s.createLinkifier(e,n),this._progress=r,this._token=o}get totalAddedLinkCount(){return this._linkifier.totalAddedLinkCount}markdown(e){return this.appendMarkdown(typeof e=="string"?new vo(e):e),this}anchor(e,r){return this.enqueue(()=>this._progress.anchor(e,r),!1),this}button(e){return this.enqueue(()=>this._progress.button(e),!0),this}filetree(e,r){return this.enqueue(()=>this._progress.filetree(e,r),!0),this}progress(e){return this.enqueue(()=>this._progress.progress(e),!1),this}warning(e){return this.enqueue(()=>this._progress.warning(e),!1),this}reference(e){return this.enqueue(()=>this._progress.reference(e),!1),this}reference2(e){return this.enqueue(()=>this._progress.reference(e),!1),this}codeCitation(e,r,n){return this.enqueue(()=>this._progress.codeCitation(e,r,n),!1),this}push(e){return e instanceof ai?this.appendMarkdown(e.value):this.enqueue(()=>this._progress.push(e),this.isBlockPart(e)),this}isBlockPart(e){return e instanceof ud||e instanceof I_||e instanceof Da||e instanceof jF}textEdit(e,r){return this.enqueue(()=>this._progress.textEdit(e,r),!0),this}markdownWithVulnerabilities(e,r){return this.enqueue(()=>this._progress.markdownWithVulnerabilities(e,r),!1),this}codeblockUri(e){"codeblockUri"in this._progress&&this.enqueue(()=>this._progress.codeblockUri(e),!1)}detectedParticipant(e,r){return this.enqueue(()=>this._progress.detectedParticipant(e,r),!1),this}confirmation(e,r,n){return this.enqueue(()=>this._progress.confirmation(e,r,n),!0),this}enqueue(e,r){return r&&(this.sequencer=this.sequencer.then(()=>this.doFinalize())),this.sequencer=this.sequencer.then(e),this.sequencer}async appendMarkdown(e){this.enqueue(async()=>{await this.doApplyText(e.value,e.isTrusted)},!1)}async finalize(){await this.enqueue(()=>this.doFinalize(),!1)}async doFinalize(){let e=await this._linkifier.flush(this._token);this._token.isCancellationRequested||e&&this.outputMarkdown(e)}async doApplyText(e,r){if(!e)return;let n=typeof r=="object"&&r.enabledCommands?r.enabledCommands:[],o=await this._linkifier.append(e,n,this._token);this._token.isCancellationRequested||o&&this.outputMarkdown(o)}outputMarkdown(e){for(let r of e.parts)if(typeof r=="string"){if(!r.length)continue;let n=new vo(r);n.isTrusted={enabledCommands:e.trustedCommands??[]},this._progress.markdown(n)}else this._progress.anchor(r.value,r.title)}};u0=E([y(4,nT)],u0);var wKe=3,kKe=3,RKe=1;function iT(t,e){let r=0;for(let n of e)r+=PKe(t,n);return r+=wKe,r}function PKe(t,e){let r=kKe;for(let[n,o]of Object.entries(e))o&&(r+=t.tokenLength(o),n==="name"&&(r+=RKe));return r}var d0=class{constructor(e,r,n,o,s,a,c,l){this._startTime=e;this._sessionId=r;this._documentContext=n;this._firstTurn=o;this._request=s;this._telemetryService=a;this._languageDiagnosticsService=c;this._tokenizerProvider=l;this.baseUserTelemetry=M6()}get telemetryMessageId(){return this.baseUserTelemetry.properties.messageId}makeRequest(e,r,n,o,s,a,c,l){let u=r===1?xD:_D;return new u(this._sessionId,this._documentContext,this._firstTurn,this._request,this._startTime,this.baseUserTelemetry,n,o,e,s,a,this._tokenizerProvider.acquireTokenizer(c),c,l,this._telemetryService,this._languageDiagnosticsService)}};d0=E([y(5,ge),y(6,Vi),y(7,_r)],d0);var oT=class{constructor(e,r,n,o,s,a,c,l,u,d,p,f,m,h,g,v){this._uiKind=e;this._sessionId=r;this._documentContext=n;this._firstTurn=o;this._request=s;this._startTime=a;this._conversation=l;this._queryWithoutCommand=u;this._intent=d;this._messages=p;this._references=f;this._tokenizer=m;this._endpoint=h;this._genericTelemetryData=g;this._telemetryService=v;this._requestStartTime=Date.now();this._firstTokenTime=0;this._addedLinkCount=0;this._markdownCharCount=0;this._editCount=0;this._editLineCount=0;this._userTelemetry=cye(this._conversation,this._sessionId,this._uiKind,this._request.prompt,iT(this._tokenizer,this._messages),this._intent.id,c),queueMicrotask(()=>this._sendInternalRequestTelemetryEvent())}get telemetryMessageId(){return this._userTelemetry.properties.messageId}get editCount(){return this._editCount}get editLineCount(){return this._editLineCount}markReceivedToken(){this._firstTokenTime===0&&(this._firstTokenTime=Date.now())}markAddedLinks(e){this._addedLinkCount+=e}markEmittedMarkdown(e){this._markdownCharCount+=e.value.length}markEmittedEdits(e,r){this._editCount+=r.length,this._editLineCount+=r.reduce((n,o)=>n+o.newText.split(`
`).length,0)}sendTelemetry(e,r,n,o){lye(this._telemetryService,this._uiKind,e,this._request.prompt,r==="offTopic",this._documentContext?.document,this._userTelemetry),r==="offTopic"&&uye(this._telemetryService,this._conversation,this._sessionId,this._uiKind,this._request.prompt,this.telemetryMessageId,this._documentContext?.document,this._userTelemetry),r==="success"&&F6(this._telemetryService,this._conversation,this._sessionId,this._uiKind,n,this.telemetryMessageId,this._documentContext?.document,this._userTelemetry.extendedBy({replyType:o.kind})),this._sendResponseTelemetryEvent(r,n,o),this._sendResponseInternalTelemetryEvent(r,n)}_getTelemetryData(e){return this._genericTelemetryData.find(r=>r instanceof e)}};oT=E([y(15,ge)],oT);var _D=class extends oT{constructor(e,r,n,o,s,a,c,l,u,d,p,f,m,h,g){super("conversationPanel",e,r,n,o,s,a,c,l,u,d,p,f,m,h,g)}_sendInternalRequestTelemetryEvent(){let e=this._conversation.getLatestTurn()?.contextParts.map(r=>r.kind)??[];this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionMessage",{intent:this._intent.id,isParticipantDetected:String(this._request.isParticipantDetected),detectedIntent:this._request.enableCommandDetection?this._intent?.id:"none",contextTypes:e.join(","),query:this._request.prompt},{})}_sendResponseTelemetryEvent(e,r,n){let o=this._conversation.getLatestTurn(),s=r?vQ(r):[],a=["programming-related tasks","programming related questions","software development topics","related to programming","expertise is limited","sorry, i can't assist with that"],c=0;e==="success"&&!r.trim().includes(`
`)&&a.some(l=>r.toLowerCase().includes(l))&&(c=1),this._telemetryService.sendMSFTTelemetryEvent("panel.request",{command:this._intent.id,contextTypes:o.contextParts.map(l=>l.kind).join(",")??"none",promptTypes:this._messages.map(l=>`${l.role}${"name"in l&&l.name?`-${l.name}`:""}:${l.content?.length}`).join(","),conversationId:this._sessionId,requestId:o.requestId,responseId:o.requestId,responseType:e,languageId:this._documentContext?.document.languageId,codeBlocks:s.join(","),model:this._endpoint.model,isParticipantDetected:String(this._request.isParticipantDetected)},{turn:this._conversation.turns.length,textBlocks:s.length?-1:r.split(/\n{2,}/).length??0,links:this._addedLinkCount,maybeOffTopic:c,messageTokenCount:this._tokenizer.tokenLength(o.request.message),promptTokenCount:iT(this._tokenizer,this._messages),userPromptCount:this._messages.filter(l=>l.role==="user").length,responseTokenCount:this._tokenizer.tokenLength(r)??0,timeToRequest:this._requestStartTime-this._startTime,timeToFirstToken:this._firstTokenTime?this._firstTokenTime-this._startTime:-1,timeToComplete:Date.now()-this._startTime,...OY(o.references)})}_sendResponseInternalTelemetryEvent(e,r){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{chatLocation:"panel",intent:this._intent.id,request:this._request.prompt,response:r??"",isParticipantDetected:String(this._request.isParticipantDetected),sessionId:this._sessionId},{turnNumber:this._conversation.turns.length})}};_D=E([y(14,ge)],_D);var xD=class extends oT{constructor(r,n,o,s,a,c,l,u,d,p,f,m,h,g,v,b){super("conversationInline",r,n,o,s,a,c,l,u,d,p,f,m,h,g,v);this._languageDiagnosticsService=b;this._diagnosticsTelemetryData=Z6(this._documentContext.selection,this._languageDiagnosticsService.getDiagnostics(this._documentContext.document.uri))}get _isNotebookDocument(){return er(this._documentContext.document.uri)?1:0}_sendInternalRequestTelemetryEvent(){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionRequest",{conversationId:this._sessionId,requestId:this.telemetryMessageId,chatLocation:"inline",intent:this._intent.id,language:this._documentContext.document.languageId,prompt:this._messages.map(r=>`${r.role.toUpperCase()}:
${r.content}`).join(`
---
`),model:this._endpoint.model},{isNotebook:this._isNotebookDocument})}_sendResponseTelemetryEvent(r,n,o){let s=this._getTelemetryData(G_);this._telemetryService.sendMSFTTelemetryEvent("inline.request",{command:this._intent.id,contextTypes:"none",promptTypes:this._messages.map(a=>`${a.role}${"name"in a&&a.name?`-${a.name}`:""}:${a.content.length}`).join(","),conversationId:this._sessionId,requestId:this.telemetryMessageId,languageId:this._documentContext.document.languageId,responseType:r,replyType:o.kind,model:this._endpoint.model,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,outcomeAnnotations:o.annotations?.map(a=>a.label).join(",")},{firstTurn:this._firstTurn?1:0,isNotebook:this._isNotebookDocument,withIntentDetection:this._request.enableCommandDetection?1:0,messageTokenCount:this._tokenizer.tokenLength(this._queryWithoutCommand),promptTokenCount:iT(this._tokenizer,this._messages),responseTokenCount:r==="success"?this._tokenizer.tokenLength(n):-1,implicitCommand:this._request.prompt.trim().startsWith(`/${this._intent.id}`)?0:1,attemptCount:this._request.attempt||0,selectionLineCount:Math.abs(this._documentContext.selection.end.line-this._documentContext.selection.start.line)+1,wholeRangeLineCount:Math.abs(this._documentContext.wholeRange.end.line-this._documentContext.wholeRange.start.line)+1,editCount:this._editCount>0?this._editCount:-1,editLineCount:this._editLineCount>0?this._editLineCount:-1,markdownCharCount:this._markdownCharCount,problemsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problemsCount,selectionProblemsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problemsCount,diagnosticsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticsCount,selectionDiagnosticsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticsCount,timeToRequest:this._requestStartTime-this._startTime,timeToFirstToken:this._firstTokenTime?this._firstTokenTime-this._startTime:-1,timeToComplete:Date.now()-this._startTime,...OY(this._references),temporalCtxFileCount:s?.documentCount??-1,temporalCtxTotalCharCount:s?.totalCharLength??-1})}_sendResponseInternalTelemetryEvent(r,n){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{chatLocation:"inline",intent:this._intent.id,request:this._request.prompt,response:n,conversationId:this._sessionId,requestId:this.telemetryMessageId,responseType:r,problems:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problems,selectionProblems:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problems,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,language:this._documentContext.document.languageId},{isNotebook:this._isNotebookDocument})}};xD=E([y(14,ge),y(15,Vi)],xD);var Zl=q(Ue());var _c=ne("ITestProvider");var Bye=q(Ct());function Mye(t){let e=(o,s,a)=>{let c="",l=a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ";if(s===1?c=`${l}${o.name}
`:s>1&&(c=`|   ${"    ".repeat(s-2)}${l}${o.name}
`),o.children){let u=o.children.length-1;o.children.forEach((d,p)=>{c+=e(d,s+1,p===u)})}return c},r=`${t.baseUri.path.replace("/","")}
`,n=t.value.length-1;return t.value.forEach((o,s)=>{r+=e(o,1,s===n)}),`\`\`\`filetree
${r}\`\`\`
`}var Qp=ne("IConversationStore"),e8=class{constructor(){this.conversationMap=new Hg(1e3)}addConversation(e,r){this.conversationMap.set(e,r)}getConversation(e){return this.conversationMap.get(e)}get lastConversation(){return this.conversationMap.last}};var Id=q(Ct());var p0=ne("ISurveyService");function Fye(t){if(t<90)return`${t} seconds`;let e=Math.floor(t/60);if(t<=5400)return`${e} minutes`;let r=Math.floor(e/60),n=e%60,o=`${r} hours`;return n>0&&(o+=` ${n} minutes`),o}var Uye=q(Ct());var f0=class{constructor(e,r,n,o){this.stopStartMappings=e;this.processNonReportedDelta=r;this.experimentationService=n;this.configurationService=o;this.stagedDeltasToApply=[];this.currentStartStop=void 0;this.nonReportedDeltas=[];this._enableSnippyAnnotations=!1}async processResponse(e,r,n,o){return this._enableSnippyAnnotations=this.configurationService.getExperimentBasedConfig(le.ShowCodeMatches,this.experimentationService),this.doProcessResponse(r,n,o)}async doProcessResponse(e,r,n){for await(let{delta:o}of e){if(n.isCancellationRequested)return;this.applyDelta(o,r)}}applyDeltaToProgress(e,r){let n=e.ipCitations;n?.length&&this._enableSnippyAnnotations&&n.forEach(s=>{let a=s.citations.license==="NOASSERTION"?Uye.t("unknown"):s.citations.license;r.codeCitation(He.parse(s.citations.url),a,s.citations.snippet)});let o=e.codeVulnAnnotations?.map(s=>({title:s.details.type,description:s.details.description}));o?.length?r.markdownWithVulnerabilities(e.text??"",o):e.text&&r.markdown(e.text)}updateStagedDeltasUpToIndex(e,r){let n=[];for(let o=0;o<e+r;){let s=this.stagedDeltasToApply.shift();if(s){if(o+s.text.length<=e)n.push(s);else if(o<e||o<e+r){if(o<e){let c={...s};c.text=s.text.substring(0,e-o),n.push(c)}let a={...s};a.text=s.text.substring(e-o+r),a.text&&this.stagedDeltasToApply.unshift(a)}o+=s.text.length}else break}return n}checkForKeyWords(e,r,n){let o=this.stagedDeltasToApply.map(s=>s.text).join("")+r.text;for(let s of e){let a=o.indexOf(s);if(a===-1)continue;return this.stagedDeltasToApply.push(r),this.updateStagedDeltasUpToIndex(a,s.length).forEach(l=>n(l)),s}for(let s of e)for(let a=s.length-1;a>0;a--){let c=s.substring(0,a);if(o.endsWith(c)){this.stagedDeltasToApply=[...this.stagedDeltasToApply,r];return}}[...this.stagedDeltasToApply,r].forEach(s=>{n(s)}),this.stagedDeltasToApply=[]}postReportRecordProgress(e){this.nonReportedDeltas.push(e)}applyDelta(e,r){if(this.currentStartStop===void 0){let n=this.checkForKeyWords(this.stopStartMappings.map(o=>o.stop),e,o=>this.applyDeltaToProgress(o,r));n&&(this.currentStartStop=this.stopStartMappings.find(o=>o.stop===n));return}else{if(!this.currentStartStop.start)return;this.checkForKeyWords([this.currentStartStop.start],e,this.postReportRecordProgress.bind(this))&&(this.processNonReportedDelta&&this.processNonReportedDelta(this.nonReportedDeltas).forEach(s=>this.applyDeltaToProgress({text:s},r)),this.currentStartStop=void 0,this.stagedDeltasToApply.length>0&&this.applyDelta({text:""},r))}}};f0=E([y(2,Lt),y(3,he)],f0);var SD={errorDetails:{message:Id.t("Cancelled")}},m0=class extends G5{constructor(r,n,o,s,a,c,l,u,d,p,f,m,h,g,v,b){super(n,o,s,a,c,l,u,d,p);this.intent=r;this._instantiationService=f;this.options=m;this._telemetryService=h;this._logService=g;this._chatMLFetcher=v;this._surveyService=b}async getResult(){if(this.checkCancellation())return SD;try{let r=this.documentContext?.document.getText(),n=this.turn.request.message,o=this.request.references,s=new xo(o),a=this.conversation.turns.slice(0,-1);if(this.checkCancellation())return SD;this.intent&&(this.turn.request={message:n,type:"user"}),this._logService.public.trace("Processing intent");let c=await this.intent.invoke({location:this.location,documentContext:this.documentContext,request:this.request});if(this.checkCancellation())return SD;this._logService.public.trace("Processed intent"),this.turn.intentInvocation=c;let l=c.endpoint,u=await this.handleConfirmationsIfNeeded();if(u)return u;let d,p={query:this.turn.request.message,history:a,chatVariables:s,previousConversation:this.previousConversation,tools:{toolReferences:this.request.toolReferences,toolInvocationToken:this.request.toolInvocationToken}};try{d=await this.buildPrompt(c,p,this.stream,this.token);let[S,I]=[d.references,d.omittedReferences].map(w=>w.reduce((k,M)=>("variableName"in M.anchor&&k.add(M.anchor.variableName),k),new Set));for(let w of d.references){let k=w.options??("variableName"in w.anchor&&I.has(w.anchor.variableName)?{status:{kind:2,description:Id.t("Part of this attachment was not sent to the model due to context window limitations.")}}:void 0);this.stream.reference2(w.anchor,void 0,k)}for(let w of d.omittedReferences)"variableName"in w.anchor&&!S.has(w.anchor.variableName)&&this.stream.reference2(w.anchor,void 0,{status:{kind:3,description:Id.t("This attachment was not sent to the model due to context window limitations.")}});this.turn.addReferences(d.references)}catch(S){if(ed(S))return SD;throw S}if(this.checkCancellation())return SD;let f=this.chatTelemetry.makeRequest(this.intent,this.location,this.conversation,this.request.prompt,d.messages,d.references,c.endpoint,d.telemetryData??[]);this._logService.public.trace("Built prompt"),this.turn.chatMessages=d.messages,this.fixMessageNames(this.intent,d.messages);let m=new ID(this.documentContext?.document.uri),h=this,g=new class{constructor(){this.context=new CD(h.turn,d.messages,m)}processResponse(S,I,w,k,M){return typeof c.processResponse=="function"?c.processResponse(this.context,w,k,M):h._instantiationService.createInstance(f0,[{stop:"[COMMANDS START]"}],void 0).processResponse(this.context,w,k,M)}};this._logService.public.trace("Sending prompt to model");let v=this.stream,b=new j6;this.documentContext&&this.location===1&&(b=this.previousConversation?.getLatestTurn()?.inlineResponseInfo?.aiEditCollector??this._instantiationService.createInstance($p,this.documentContext.document.getText()),v=ol.spy(v,S=>{S instanceof Da&&b.addEdits(S.edits)}));let _=this.location===1?"inline":"chat",x=await this.fetchConversationResponse(`${st.toStringShorter(this.location)}/${this.intent.id}`,v,l,n,d.messages,m,g,c.linkification,{messageId:this.chatTelemetry.telemetryMessageId,messageSource:this.intent?.id&&this.intent.id!==aa.ID?`${_}.${this.intent.id}`:`${_}.user`},f);return d.hasIgnoredFiles&&v.markdown(Id.t(zM)),this.documentContext&&(this.turn.inlineResponseInfo={kind:"ok",promptQuery:{...this.documentContext,intent:this.intent,query:this.request.prompt},interactionOutcome:m.interactionOutcome,store:m.store,aiEditCollector:b,messageId:this.chatTelemetry.telemetryMessageId,telemetry:f},this.turn.requestDebugInformation={uri:this.documentContext.document.uri,intentId:this.intent.id,languageId:this.documentContext.document.languageId,initialDocumentText:r,userPrompt:this.request.prompt,userSelection:this.documentContext.selection}),x}catch(r){this._logService.public.error(r),this._telemetryService.sendGHTelemetryException(r,"Error");let n=r.message;return this.turn.status="error",this.turn.response={message:n,type:"meta"},{errorDetails:{message:n}}}}async buildPrompt(r,n,o,s){let a={report(c){o.push(c)}};return await r.buildPrompt(n,a,s)}async handleConfirmationsIfNeeded(){if((this.request.acceptedConfirmationData?.length||this.request.rejectedConfirmationData?.length)&&this.turn.intentInvocation.confirmationHandler)return await this.turn.intentInvocation.confirmationHandler(this.request.acceptedConfirmationData,this.request.rejectedConfirmationData,this.stream),{}}fixMessageNames(r,n){n.forEach(o=>{o.role!=="system"&&"name"in o&&o.name===r?.id&&(o.name=void 0)})}async fetchConversationResponse(r,n,o,s,a,c,l,u,d,p){let f=M6();this.turn.requestId=this.chatTelemetry.telemetryMessageId,this.turn.modelMessageId=f.properties.messageId,n=c.spyOnStream(n);let m=u?.disable?void 0:this._instantiationService.createInstance(u0,{requestId:this.turn.requestId,references:this.turn.references},n,u?.additionaLinkifiers??[],this.token);n=m??n,n=ol.spy(n,x=>{x instanceof ai&&p.markEmittedMarkdown(x.value),x instanceof Da&&p.markEmittedEdits(x.uri,x.edits)});let h=new Mp,g=l.processResponse(this.turn,a,h.stream,n,this.token);if(a.length===0)return h.resolve(),await g,await m?.finalize(),{};let v=!1;g.finally(()=>{v=!0});let b=await this._chatMLFetcher.fetchOne(r,a,async(x,S,I)=>(p.markReceivedToken(),h.update(x,I),v?x.length:void 0),this.token,this.location,o,void 0,{temperature:this.calculateTemperature()},d,{intent:!0});h.resolve(),await g;let _=b.type==="success"?b.value:"";if(m&&(await m.finalize(),p.markAddedLinks(m.totalAddedLinkCount)),this.location===1&&b.type==="success"&&b.value.length===0)return p.sendTelemetry(b.requestId,"unknown","Empty response",c.interactionOutcome),{};switch(this._surveyService.signalUsage(`${this.location===1?"inline":"panel"}.${this.intent.id}`,this.documentContext?.document.languageId),p.sendTelemetry(b.requestId,b.type,_,c.interactionOutcome),b.type){case"success":return await this.processSuccessfulFetchResult(_,b.requestId,f);case"offTopic":return this.processOffTopicFetchResult(s);case"canceled":return this.turn.status="cancelled",this.turn.response={message:"Cancelled",type:"user"},{errorDetails:this.turn.response};case"rateLimited":return this.turn.status="error",{errorDetails:{message:Id.t("Sorry, your request was rate-limited. Please wait {0} before trying again.",b.retryAfter?Fye(b.retryAfter):"a moment"),responseIsFiltered:!0}};case"badRequest":case"failed":return this.turn.status="error",this.turn.response={message:Id.t("Sorry, your request failed. Please report the following request id {0} and try again",b.requestId),type:"server"},{errorDetails:this.turn.response};case"filtered":return this.turn.status="filtered",{errorDetails:{message:HF(b.category),responseIsFiltered:!0}};case"agent_unauthorized":return this.turn.status="error",{};case"agent_failed_dependency":return this.turn.status="error",{errorDetails:{message:b.reason}};case"length":return this.turn.status="error",{errorDetails:{message:Id.t("Sorry, the response hit the length limit. Please rephrase your prompt.")}};case"unknown":return this.turn.status="error",{errorDetails:{message:Id.t("Sorry, no response was returned.")}};case"extensionBlocked":return this.turn.status="error",{errorDetails:{message:Id.t("Sorry, something went wrong.")}}}}async processSuccessfulFetchResult(r,n,o){if(r.length===0){let s=Id.t("The model unexpectedly did not return a response, which may indicate a service issue. Please report a bug.");return this.turn.status="error",this.turn.response={type:"meta",message:s},{errorDetails:{message:s}}}return this.turn.status="success",this.turn.response={message:r,type:"model"},o.markAsDisplayed(),F6(this._telemetryService,this.conversation,this.sessionId,this.uiKind,r,n,this.documentContext?.document,o),{}}processOffTopicFetchResult(r){return this.stream.markdown(this.options.rejectionMessage),this.turn.response={message:this.options.rejectionMessage,type:"offtopic-detection"},this.turn.status="off-topic",{}}calculateTemperature(){return this.request.attempt>0?Math.min(this.options.temperature*(this.request.attempt+1),2):this.options.temperature}};m0=E([y(10,j),y(11,dc),y(12,ge),y(13,ie),y(14,yt),y(15,p0)],m0);var sT=class{constructor(e,r,n,o,s,a,c,l,u,d,p,f){this.request=r;this.stream=n;this.token=o;this.chatAgentArgs=s;this._instantiationService=a;this._commandService=c;this._ignoreService=l;this._intentService=u;this._conversationStore=d;this._logService=f;this.location=this.request.location2 instanceof v2?1:2,this.intentDetector=this._instantiationService.createInstance(Xp,this.location),this._setupPreviousConversation(e),this.conversation=new Sp;let m=TD(this.conversation,e,this._commandService);this._sessionId=m??ir(),this.turn=this.newTurn(this.request),this.documentContext=this._inferDocumentContext(p.activeTextEditor,e),this.chatTelemetry=this._instantiationService.createInstance(d0,Date.now(),this._sessionId,this.documentContext,this.conversation.turns.length===1,this.request),this.turn.userMessageId=this.chatTelemetry.telemetryMessageId}async sanitizeVariables(){let e=this.request.references.map(async n=>{let o=!1;return n.value instanceof nr&&(o=await this._ignoreService.isCopilotIgnored(n.value)),o&&n.range&&(this.turn.request.message=this.turn.request.message.slice(0,n.range[0])+this.turn.request.message.slice(n.range[1])),o?null:n}),r=Dr(await Promise.all(e));return{...this.request,references:r}}async getResult(){this._logService.public.trace(`[${st.toStringShorter(this.location)}] chat request received from extension host`);try{this.request=await this.sanitizeVariables();let e=this.chatAgentArgs.intentId?this._commandService.getCommand(this.chatAgentArgs.intentId,this.location):void 0,r=this.checkCommandUsage(e);if(!r){let n=this.conversation.turns.slice(0,-1),o=await this.selectIntent(e,this.turn,n),s;typeof o.requestHandler=="function"?s=this._instantiationService.createInstance(o.requestHandler,o,this._sessionId,this.conversation,this.previousConversation,this.request,this.stream,this.token,this.documentContext,this.chatAgentArgs.agentName,this.chatTelemetry):s=this._instantiationService.createInstance(m0,o,this._sessionId,this.conversation,this.previousConversation,this.request,this.stream,this.token,this.documentContext,this.chatAgentArgs.agentName,this.chatTelemetry),this.request.isParticipantDetected||this.intentDetector.collectIntentDetectionContextInternal(this.turn.request.message,this.request.enableCommandDetection?o.id:"none",new xo(this.request.references),n,this.documentContext?.document),r=await s.getResult()}return this._conversationStore.addConversation(this.turn.requestId,this.conversation),{...r,metadata:{...r.metadata,modelMessageId:this.turn.modelMessageId??"",responseId:this.turn.requestId,sessionId:this._sessionId,agentId:this.chatAgentArgs.agentId,command:this.request.command}}}catch(e){throw e}}newTurn(e){let r={message:e.prompt,type:"user"},n=new xp(r,this._sessionId);return this.conversation.addTurn(n),n}_inferDocumentContext(e,r){let n;if(this.request.location2 instanceof v2){let{document:o,wholeRange:s,selection:a}=this.request.location2;n={document:o,language:mn(o),wholeRange:s,selection:a,fileIndentInfo:void 0}}else if(this.request.location2 instanceof Vhe){let{cell:o}=this.request.location2;n={document:o,language:mn(o),wholeRange:new Be(0,0,0,0),selection:new _p(0,0,0,0),fileIndentInfo:void 0}}else e&&(n=K_.fromEditor(e));if(this.previousConversation&&n){let o=this.previousConversation.getLatestTurn().inlineResponseInfo;o&&o.store&&o.store.lastDocumentContent===n.document.getText()&&(n.wholeRange=o.store.lastWholeRange,this._logService.public.debug("Ignoring passed in whole range and using the whole range from the previous turn"))}return e&&e?.document===n?.document&&!n.fileIndentInfo&&e?.document===n.document&&(n.fileIndentInfo={insertSpaces:e.options.insertSpaces,tabSize:e.options.tabSize}),n}_setupPreviousConversation(e){if(e.length===0||this.request.attempt!==0)return;let r=gM(e,o=>o instanceof Bhe);if(!r?.result.metadata)return;let n=r.result.metadata;this.previousConversation=n?.responseId?this._conversationStore.getConversation(n.responseId):void 0}async selectIntent(e,r,n){let o=e?.intent;if(!o&&this.location===1){let s;this.location===1&&this.documentContext&&this.request.attempt===0&&n.length===0&&(this.documentContext.selection.isEmpty&&this.documentContext.document.lineAt(this.documentContext.selection.start.line).text.trim()===""?s="generate":!this.documentContext.selection.isEmpty&&this.documentContext.selection.start.line!==this.documentContext.selection.end.line&&(s="edit"));let a=this.request.enableCommandDetection,c=this.intentDetector.detectIntent(this.documentContext,this.request.prompt,this.chatAgentArgs.agentId,this.token,this.chatTelemetry.baseUserTelemetry,s,this.request.attempt>0&&this.request.enableCommandDetection,new xo([]),n,[]);if(a&&(o=await c,this.location===1&&o?.id==="edit"&&this.documentContext&&this.documentContext.selection.isEmpty&&this.documentContext.document.lineAt(this.documentContext.selection.start.line).text.trim()===""&&(o=this._intentService.getIntent("generate",1)),o)){let l=this._commandService.getCommand(o.id,this.location);l&&this.stream.detectedParticipant(this.chatAgentArgs.agentId,{name:l.commandId,description:l.details})}}return o??this._intentService.unknownIntent}checkCommandUsage(e){if(e?.intent&&!(e.intent.commandInfo?.allowsEmptyArgs??!0)&&!this.turn.request.message){let r=t5(e.intent.id),n="";r&&(n=`@${r.agent} `,r.command&&(n+=` /${r.command}`),n+=` ${e.details}`);let o=Bye.t(`Please specify a question when using this command.

Usage: {0}`,n);return this.turn.response={type:"meta",message:o},this.turn.status="error",{errorDetails:{message:o}}}}};sT=E([y(5,j),y(6,Wl),y(7,Te),y(8,hc),y(9,Qp),y(10,Ft),y(11,ie)],sT);function TD(t,e,r){let n,o;for(let s of e)if(s instanceof Uhe)o=new xp({message:s.prompt,type:"user"}),o.promptVariables=new xo(s.references);else{let a=s.response.map(l=>l instanceof ai?l.value.value:l instanceof ud?Mye(l):"content"in l?l.content:l instanceof UF?l.value:null).filter(Boolean).join("");if(o){let l=s.command||ige(s.participant),u=r.getCommand(l,2);o.response={message:a,type:"model",name:u?.commandId||aa.ID},s.result.errorDetails?s.result.errorDetails?.responseIsFiltered?o.status="filtered":s.result.errorDetails.message==="Cancelled"?o.status="cancelled":o.status="error":o.status="success",t.addTurn(o),o=void 0}let c=s.result;typeof c.metadata?.sessionId=="string"&&(n=c.metadata.sessionId)}return n}var Xp=class{constructor(e,r,n,o,s,a,c,l,u,d,p,f,m){this.location=e;this.logService=r;this.chatMLFetcher=n;this.endpointProvider=o;this.telemetryService=s;this.configurationService=a;this.testProvider=c;this.experimentationService=l;this.intentService=u;this.commandService=d;this.instantiationService=p;this.authenticationService=f;this.tabsAndEditorsService=m}async provideParticipantDetection(e,r,n,o){if(n.location!==1||this.configurationService.getNonExtensionConfig("chat.experimental.detectParticipant.enabled")!==!0&&!this.experimentationService.getTreatmentVariable("vscode","copilotchat.chatParticipantDetectionPublic")&&!(this.authenticationService.copilotToken?.isInternal&&this.experimentationService.getTreatmentVariable("vscode","copilotchat.chatParticipantDetection"))||(await this.endpointProvider.getChatEndpoint(e)).family.startsWith("o1"))return;let a=new xo(e.references),c=new Sp;TD(c,r.history,this.commandService);let l;try{let u=await this.detectIntent(void 0,e.prompt,void 0,o,void 0,void 0,void 0,a,c.turns),d=n.participants?.filter(p=>p.participant!==aK&&!p.participant.startsWith(nK)&&p.disambiguation.length)??[];if(u&&"participant"in u)return l=u,u;if(u){l=u.id;let p=t5(u.id);if(p)return{participant:CI(p.agent),command:p.command}}else if(d.length){let p=await this.detectIntent(void 0,e.prompt,void 0,o,void 0,void 0,!0,new xo(e.references),c.turns,d);if(p&&"participant"in p)return l=p,p}}finally{l&&this.collectIntentDetectionContextInternal(e.prompt,l,a,c.turns.slice(0,-1),this.tabsAndEditorsService.activeTextEditor?.document)}}async detectIntent(e,r,n,o,s,a,c,l,u,d){this.logService.public.trace("Building intent detector");let p;this.location===2?p=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"):p=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo");let f=Me.create(this.instantiationService,p,this.location===1?Cd:GQ,{preferredIntent:a,location:this.location,userQuestion:r,documentContext:e,history:u,chatVariables:l,thirdPartyParticipants:d}),{messages:m}=await f.render(void 0,o);this.logService.public.trace("Built intent detector");let h=[],g=async(S,I,w)=>{if(w.copilotFunctionCalls)for(let k of w.copilotFunctionCalls)h.push({name:k.name,arguments:JSON.parse(k.arguments)})},v=await this.chatMLFetcher.fetchMany("intentDetection",m,g,o,this.location,p,void 0,{stop:[";"],n:1}),b=this.validateResult(v,s,r,h.map(S=>S.name),a,d),_=b&&"id"in b?b?.id:b?.participant;this.sendTelemetry(a,_,e?.language.languageId,c);let x=f.getMeta(ED);return this.sendInternalTelemetry(r,a,x?.filePath,x?.fileExcerpt,_,e?.language.languageId,c,m.slice(0,-1)),b}async collectIntentDetectionContextInternal(e,r,n,o=[],s){let a=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:c}=await yo(this.instantiationService,a,bn,{document:s}),{messages:l}=await yo(this.instantiationService,a,It,{history:o,priority:1e3},void 0,void 0,{validate:!1}).catch(()=>({messages:[]})),{history:u,fileExcerpt:d,attachedContext:p,fileExcerptExceedsBudget:f}=this.prepareInternalTelemetryContext(c?.[0]?.content,l,n);this.telemetryService.sendInternalMSFTTelemetryEvent("participantDetectionContext",{chatLocation:st.toString(this.location),userQuery:e,history:u.join(""),assignedIntent:typeof r=="string"?r:void 0,assignedThirdPartyChatParticipant:typeof r!="string"?r.participant:void 0,assignedThirdPartyChatCommand:typeof r!="string"?r.command:void 0,fileExcerpt:d??(f?"<truncated>":"<none>"),attachedContext:p.join(";")},{})}getFunctions(e){let r=e!==void 0&&er(e.document.uri);return Cd.getDetectableIntents(this.location,r,this.intentService,this.configurationService,this.testProvider).map(n=>({name:n.id,functionName:n.intentDetectionInput.functionName,description:n.intentDetectionInput.modelDescription||n.description}))}validateResult(e,r,n,o,s,a){if(e.type!=="success"){r&&this.sendPromptIntentErrorTelemetry(r,e);return}let c=o?.length?o.map(p=>{let[f,m]=p.replaceAll("```","").split(".");return(m??f).replaceAll("'","")}):e.value.map(p=>p.trimStart().split(`
`)[0].replaceAll("```","").replace(/function id:|response:/i,"").trim());if(c=c.filter(p=>p!==aa.ID),!c.length&&s&&(c=[s]),c[0]==="github_questions"||c[0]==="web_questions")return{participant:aK};let l=a?.reduce((p,f)=>(f.disambiguation.forEach(m=>{p[m.category??m.categoryName]={participant:f.participant,command:f.command}}),p),{}),u=c.map(p=>this.intentService.getIntent(p,this.location)??(this.location===1?this.intentService.getIntentByFunctionName(p,this.location):void 0)??(qye[p]&&this.intentService.getIntent(qye[p],this.location))??l?.[p]).filter(p=>p!==void 0)?.[0],d=u&&"id"in u?u?.id:u?.participant;if(this.logService.internal.debug(`picked intent "${d}" from ${JSON.stringify(e.value,null,"	")}`),r){let p=r.extendedBy({messageText:n,promptContext:c.join(),intent:d||"unknown"});this.telemetryService.sendRestrictedGHTelemetryEvent("conversation.promptIntent",p.raw.properties,p.raw.measurements)}return u}sendPromptIntentErrorTelemetry(e,r){let n=e.extendedBy({resultType:r.type,reason:r.reason});this.telemetryService.sendRestrictedGHTelemetryErrorEvent("conversation.promptIntentError",n.raw.properties,n.raw.measurements)}sendTelemetry(e,r,n,o){this.telemetryService.sendMSFTTelemetryEvent("intentDetection",{chatLocation:st.toString(this.location),preferredIntent:e??"<none>",detectedIntent:r??"<none>",languageId:n??"<none>",isRerunWithoutIntentDetection:String(o)??"<none>"})}prepareInternalTelemetryContext(e,r,n){let o=5e3,s=[];if(n)for(let l of n){let u=Buffer.byteLength(l.uniqueName,"utf8");if(o-u<0)break;o-=u,s.push(l.uniqueName)}let a=!1;if(e){let l=Buffer.byteLength(e,"utf8");l>o?(a=!0,e=void 0):o-=l}else e=void 0;let c=[];for(let l=r.length-1;l>=0;l-=1){let u=r[l],d=`${u.role.toUpperCase()}: ${u.content}

`,p=Buffer.byteLength(d,"utf8");if(o-p<0)break;c.push(d),o-=p}return{fileExcerpt:e,fileExcerptExceedsBudget:a,history:c.reverse(),attachedContext:s}}sendInternalTelemetry(e,r,n,o,s,a,c,l){let{fileExcerpt:u,history:d}=this.prepareInternalTelemetryContext(o,l);this.telemetryService.sendInternalMSFTTelemetryEvent("intentDetection",{chatLocation:st.toString(this.location),request:e,preferredIntent:r??"<none>",filePath:n??"<none>",fileExerpt:u??"<none>",detectedIntent:s??"<none>",languageId:a??"<none>",isRerunWithoutIntentDetection:String(c)??"<none>",history:d.join("")},{})}};Xp=E([y(1,ie),y(2,yt),y(3,xe),y(4,ge),y(5,he),y(6,_c),y(7,Lt),y(8,hc),y(9,Wl),y(10,j),y(11,Tt),y(12,Ft)],Xp);var ED=class extends Zl.PromptMetadata{constructor(r,n){super();this.fileExcerpt=r;this.filePath=n}},Cd=class extends Zl.PromptElement{constructor(r,n,o,s,a){super(r);this._ignoreService=n;this._configurationService=o;this._testProvider=s;this._intentService=a}static getDetectableIntents(r,n,o,s,a){let c=o.getIntents(r),l=[];for(let u=0;u<c.length;u++){let d=c[u];d.id==="review"&&!s.getConfig(le.ReviewIntent)||d.id==="fixTestFailure"&&(!a.isEnabled.get()||_i.isEmpty(a.getAllFailures()))||d.id==="tests"&&n||d.commandInfo?.defaultEnablement===!1||d.intentDetectionInput.disabled&&r===2||l.push(d)}return l}async prepare(r,n,o){let{documentContext:s}=this.props,a=!1;return s!==void 0&&(a=await this._ignoreService.isCopilotIgnored(s.document.uri)),{isDocumentCopilotIgnored:a}}render(r){let{preferredIntent:n,location:o,userQuestion:s,documentContext:a}=this.props,c,l,u;try{if(a!==void 0&&!r.isDocumentCopilotIgnored){let{document:h,selection:g}=a;c=h.uri;let v=new Be(new xr(Math.max(g.start.line-5,0),0),new xr(Math.min(g.end.line+5,h.lineCount),h.lineAt(g.end.line).text.length));l=h.getText(v),u=l.trim().length>0?vscpp(nt,{uri:c,languageId:h.languageId,code:l,shouldTrim:!1}):void 0}}catch{}let d=new ED(l,c?.path),p=a!==void 0&&er(a.document.uri),f=Cd.getDetectableIntents(o,p,this._intentService,this._configurationService,this._testProvider),m=(n?this._intentService.getIntent(n,o)?.intentDetectionInput.functionName:void 0)??n;return vscpp(vscppf,null,vscpp("meta",{value:d}),vscpp(Zl.SystemMessage,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null)),vscpp(Zl.UserMessage,null,"A software developer is using an AI chatbot in a code editor",c&&` in file ${c.path}`,".",vscpp("br",null),u===void 0?vscpp("br",null):vscpp(vscppf,null,"Current active file contains following excerpt:",vscpp("br",null),u,vscpp("br",null)),"The developer added the following request to the chat and your goal is to select a function to perform the request.",vscpp("br",null),m&&`The developer probably wants Function Id '${m}', pick different only if you're certain.`,vscpp("br",null),"Request: ",s,vscpp("br",null),vscpp("br",null),"Available functions:",vscpp("br",null),f.map(h=>vscpp(vscppf,null,"Function Id: ",h.id,vscpp("br",null),"Function Description: ",h.intentDetectionInput.modelDescription||h.description,vscpp("br",null),vscpp("br",null))),vscpp("br",null),"Here are some examples to make the instructions clearer:",vscpp("br",null),f.map(h=>vscpp(vscppf,null,"Request: ",h.intentDetectionInput.sampleQuestion,vscpp("br",null),"Response: ",h.id,vscpp("br",null),vscpp("br",null))),"Request: ",s,vscpp("br",null),"Response:"))}};Cd=E([y(1,Te),y(2,he),y(3,_c),y(4,hc)],Cd);var qye={workspace_questions:"workspace",create_workspace_or_extension:"unknown",create_new_workspace:"unknown",create_jupyter_notebook:"newNotebook",create_new_jupyter_notebook:"newNotebook",vscode_questions:"unknown",github_questions:"github",web_questions:"github",create_tests:"tests",generate_test_for_code:"tests",terminal_state_questions:"terminalExplain",configure_python_environment:"vscode",generate_with_workspace_context:"workspace",generate_code_sample:"unknown",unknown:"unknown"},VQ=class extends Zl.PromptElement{render(){return vscpp(vscppf,null,'| workspace_questions | The user wants to learn about the code or files in their current workspace. Questions in this category may be about understanding what the whole workspace does or locating the implementation of some code. | "What does this project do?" |',vscpp("br",null),'| generate_with_workspace_context | The user wants to generate code based on multiple files in the workspace and did not specify which files to reference. | "Create a README for this project." |',vscpp("br",null),'| generate_code_sample | The user wants to generate code snippets without referencing the contents of the current workspace. This category does not include generating entire projects. | "Write an example of computing a SHA256 hash." |',vscpp("br",null),'| create_workspace_or_extension | The user wants to create a complete workspace from scratch in Visual Studio Code, such as a new application or Visual Studio Code extension. The user may have specified individual files that you should refer to. This does not include requests to generate individual methods or files. | "Scaffold a Node server." |',vscpp("br",null),'| configure_python_environment | The user wants to set up their Python environment. | "Create a virtual environment for my project." |',vscpp("br",null),'| create_tests | The user wants to generate unit tests. | "Generate tests for my selection using pytest." |',vscpp("br",null),'| create_jupyter_notebook | The user wants to create a new Jupyter notebook in Visual Studio Code. | "Create a notebook to analyze this CSV file." |',vscpp("br",null),'| vscode_questions | The user wants to learn about, use, or configure the editor, terminal, debugger, tasks, extensions, commands, or settings in Visual Studio Code. This category does not include creating VS Code extensions or generating and explaining code. | "Switch to light mode." |',vscpp("br",null),'| terminal_state_questions | The user wants to learn about specific state such as the selection, command, or failed command in the integrated terminal in Visual Studio Code. | "Why did the latest terminal command fail?" |',vscpp("br",null),'| github_questions | The user is asking about an issue, pull request, branch, commit hash, diff, discussion, repository, or published release on GitHub.com.  This category does not include performing local Git operations using the CLI. | "What has been changed in the pull request 1361 in browserify/browserify repo?" |',vscpp("br",null),'| web_questions | The user is asking a question that requires current knowledge from a web search engine. Such questions often reference time periods that exceed your knowledge cutoff. | "What is the latest LTS version of Node.js?" |',vscpp("br",null),`| unknown | The user's question does not fit exactly one of the categories above, is about a product other than Visual Studio Code or GitHub, or is a general question about code, code errors, or software engineering. | "How do I center a div in CSS?" |`,vscpp("br",null))}},HQ=class extends Zl.PromptElement{render(){return vscpp(vscppf,null,this.props.participants.flatMap(e=>e.disambiguation.map(r=>vscpp(vscppf,null,"| ",r.category??r.categoryName," | ",r.description," | ",r.examples[0]?`"${r.examples[0]}"`:"--"," |",vscpp("br",null)))),vscpp("br",null),`| unknown | The user's question does not fit exactly one of the categories above or is a general question about code, code errors, or software engineering. | "How do I center a div in CSS?" |`,vscpp("br",null))}},GQ=class extends Cd{render(){let{history:e,chatVariables:r,userQuestion:n}=this.props,o=!!(e?.length&&e.length>0);return vscpp(vscppf,null,vscpp(Zl.SystemMessage,null,`You are a helpful AI programming assistant to a user who is a software engineer, acting on behalf of the Visual Studio Code editor. Your task is to choose one category from the Markdown table of categories below that matches the user's question. Carefully review the user's question, any previous messages, and any provided context such as code snippets. Respond with just the category name. Your chosen category will help Visual Studio Code provide the user with a higher-quality response, and choosing incorrectly will degrade the user's experience of using Visual Studio Code, so you must choose wisely. If you cannot choose just one category, or if none of the categories seem like they would provide the user with a better result, you must always respond with "unknown".`,vscpp("br",null),vscpp("br",null),"| Category name | Category description | Example of matching question |",vscpp("br",null),"| -- | -- | -- |",vscpp("br",null),this.props.thirdPartyParticipants?vscpp(HQ,{participants:this.props.thirdPartyParticipants}):vscpp(VQ,null)),o&&vscpp(It,{history:e,priority:800}),vscpp(Mr,{query:n,chatVariables:r,priority:900}))}},t8=class extends Cd{constructor(e,r,n,o,s){super(e,r,n,o,s)}render(e){let{preferredIntent:r,location:n,userQuestion:o,documentContext:s,history:a,chatVariables:c}=this.props,l=(r?this._intentService.getIntent(r,n)?.intentDetectionInput.functionName:void 0)??r,u,d,p;try{if(s!==void 0&&!e.isDocumentCopilotIgnored){let{document:v,selection:b}=s;u=v.uri;let _=new Be(new xr(Math.max(b.start.line-5,0),0),new xr(Math.min(b.end.line+5,v.lineCount),v.lineAt(b.end.line).text.length));d=v.getText(_),p=d.trim().length>0?vscpp(nt,{uri:u,languageId:v.languageId,code:d,shouldTrim:!1}):void 0}}catch{}let f=new ED(d,u?.path),m=s!==void 0&&er(s.document.uri),h=Cd.getDetectableIntents(n,m,this._intentService,this._configurationService,this._testProvider),g=!!(a?.length&&a.length>0);return vscpp(vscppf,null,vscpp("meta",{value:f}),vscpp(Zl.SystemMessage,{priority:1e3},"You are an AI programming assistant in the Visual Studio Code editor.",vscpp("br",null),u&&vscpp(vscppf,null,"The user is currently looking at the file ",u.path,".",vscpp("br",null)),p&&vscpp(vscppf,null,"The current active file contains the following excerpt:",vscpp("br",null),p,vscpp("br",null)),"Your task is to choose the function from the following list that is most relevant to the user's message. This function will be executed to provide the user with a more specific and actionable response.",vscpp("br",null),vscpp("br",null),Dr(h.filter(v=>!!v.intentDetectionInput.functionCallingBlurb).map(v=>`Function name: ${v.intentDetectionInput.functionName??v.id}
${v.intentDetectionInput.functionCallingBlurb}
An example of a question that matches the '${v.intentDetectionInput.functionName??v.id}' function is: "${v.intentDetectionInput.sampleQuestion}".`)).join(`

`),vscpp("br",null),vscpp("br",null),n===2&&vscpp(vscppf,null,"If the user's question is not related to the functions described above, or if it is related to two or more functions described above, you should use the 'unknown' function.",vscpp("br",null)),l&&vscpp(vscppf,null,"The user probably wants the '",l,"' function, pick different only if you're certain.",vscpp("br",null)),"Your response should contain just the name of the function and no other text. You can only choose from the functions mentioned above."),g&&vscpp(It,{history:a,priority:800}),vscpp(Mr,{query:o,chatVariables:c,priority:900}))}};t8=E([y(1,Te),y(2,he),y(3,_c),y(4,hc)],t8);var r8={top_p:1,temperature:.1};var zQ=class{constructor(e,r,n,o,s){this.wholeRange=e;this.document=r;this.formattingOptions=n;this.preferredIntent=o;this.agent=s;this._requests=[];this.aiEditCollector=void 0;this.store=void 0;this.sessionId=ir(),this.conversation=void 0}addRequest(e){this._requests.push(e)}getRequests(){return this._requests}};var h0=class{constructor(e,r,n,o,s,a,c,l,u,d,p,f){this.agent=e;this.rejectionMessage=r;this.logService=n;this._telemetryService=o;this.tabAndEditorsService=s;this.languageDiagnosticsService=a;this.ignoreService=c;this.chatMLFetcher=l;this.tokenizerProvider=u;this.instantiationService=d;this.commandService=p;this.intentService=f}async prepareInteractiveEditorSession(e){if(await this.ignoreService.isCopilotIgnored(e.document.uri))throw new Error(aT.t("Inline chat is disabled for this file due to content exclusion policies."));let n;if(this.tabAndEditorsService.activeTextEditor?.document.uri.toString()===e.document.uri.toString()){let s=this.tabAndEditorsService.activeTextEditor.options;n={insertSpaces:s.insertSpaces,tabSize:s.tabSize}}let o;return e.selection.isEmpty&&e.document.lineAt(e.selection.start.line).text.trim()===""?o=Sd.ID:!e.selection.isEmpty&&e.selection.start.line!==e.selection.end.line&&(o=xd.ID),new zQ(e.selection,e.document,n,o,this.agent)}async provideInteractiveEditorResponse(e,r,n,o){this.logService.public.trace("Providing Inline Chat Response"),r.attempt===0&&e.addRequest(r);let s=e.aiEditCollector=this.instantiationService.createInstance($p,e.document.getText()),a=n;n=new ol(l=>{"edits"in l&&s.addEdits(l.edits),a.push(l)});let c=await this.fetchResponse(e,r,n,o);return!c||c.kind==="error"||(e.store=c.store),c}async resolveIntent(e,r,n,o,s){let a,c="",l=!1;if(!e.command&&e.prompt.startsWith("/")&&e.prompt.startsWith("/")){let f=/\/(?<intentId>\w+)(?<restOfQuery>\s.*)?/s.exec(e.prompt)?.groups;e.command=f?.intentId??void 0,e.prompt=f?.restOfQuery?.trim()??""}if(e.command&&this.commandService.getCommand(e.command,1))a=this.commandService.getCommand(e.command,1)?.intent,c=e.prompt,l=!0;else{let p=e.enableCommandDetection,m=this.instantiationService.createInstance(Xp,1).detectIntent(r,e.prompt,n?.agent,s,o,n?.preferredIntent,!p,new xo(e.references),void 0);p&&(a=await m,a?.id===xd.ID&&r.selection.isEmpty&&r.document.lineAt(r.selection.start.line).text.trim()===""&&(a=this.intentService.getIntent(Sd.ID,1))),c=e.prompt}let u;if(a){let p=this.commandService.getCommand(a.id,1);p&&(u={name:p.commandId,description:p.details})}a??=this.intentService.unknownIntent;let d=await a.invoke({request:e,location:1,documentContext:r,slashCommand:u});return{queryWithoutCommand:c,intentInvocation:d,slashCommand:u,fromQuery:l}}async buildPrompt(e,r,n,o,s){let a;if(n.length>0){let u=`The current code is a result of a previous interaction with you. Here are my previous messages: 
- ${n.map(d=>d.prompt).join(`
- `)}`;a=[new xp({message:u,type:jye.ChatRole.User})]}else a=[];let c={history:a,query:e.queryWithoutCommand,chatVariables:new xo(r.references),tools:{toolReferences:r.toolReferences,toolInvocationToken:r.toolInvocationToken}},l={report(u){o.push(u)}};return await e.intentInvocation.buildPrompt(c,l,s)}async fetchResponse(e,r,n,o){let s;e.getRequests().length>1&&r.attempt===0&&e.store&&e.document.getText()===e.store.lastDocumentContent&&(s=e.store.lastWholeRange,this.logService.public.debug("Ignoring passed in whole range and using the whole range from the previous turn"));let a=e.document.getText(),c={document:e.document,fileIndentInfo:e.formattingOptions,language:mn(e.document),selection:r.selection,wholeRange:s??r.wholeRange},l=new d0(Date.now(),e.sessionId,c,e.conversation===void 0,r,this._telemetryService,this.languageDiagnosticsService,this.tokenizerProvider);(e.getRequests().length>1||r.attempt>0)&&(e.preferredIntent=void 0),this.logService.public.trace("Resolving inline chat intent");let u=await this.resolveIntent(r,c,e,l.baseUserTelemetry,o);this.logService.public.trace("Resolved inline chat intent");let d=u.intentInvocation;u.slashCommand&&!u.fromQuery&&n.detectedParticipant("github.copilot.editor",u.slashCommand);let p={query:u.queryWithoutCommand,...c,intent:d.intent},f=new ID(e.document.uri);n=f.spyOnStream(n),this.logService.public.trace("Building prompt");let{messages:m,references:h}=await this.buildPrompt(u,r,e.getRequests().slice(0,-1),n,o);this.logService.public.trace("Built prompt");for(let Z of h)n.reference(Z.anchor);if(o.isCancellationRequested)return;let g=e.conversation;g||(g=e.conversation=new Sp);let v=new xp({message:m.map(Z=>Z.content).join(`
`),type:"user"});v.requestDebugInformation={uri:e.document.uri,intentId:u.intentInvocation.intent.id,languageId:e.document.languageId,initialDocumentText:a,userPrompt:r.prompt,userSelection:r.selection},v.chatMessages=m,v.requestId=l.telemetryMessageId,g.addTurn(v);let b=new CD(v,m,f),_,x,S=d.linkification?.disable?void 0:this.instantiationService.createInstance(u0,{requestId:v.requestId,references:h},n,d.linkification?.additionaLinkifiers??[],o),I=S??n;if(m.length===0)return await d.processResponse(b,Xn.EMPTY,I,o),S&&await S.finalize(),{kind:"ok",promptQuery:p,interactionOutcome:f.interactionOutcome,store:f.store,messageId:l.telemetryMessageId,aiEditCollector:e.aiEditCollector,telemetry:void 0};let w=l.makeRequest(d.intent,1,g,u.queryWithoutCommand,m,h,d.endpoint,[]);I=ol.spy(I,Z=>{Z instanceof ai&&w.markEmittedMarkdown(Z.value),Z instanceof Da&&w.markEmittedEdits(Z.uri,Z.edits)});let k=new Mp,M=d.processResponse(b,k.stream,I,o),H=!1;M.finally(()=>{H=!0});let F=async(Z,V,A)=>(w.markReceivedToken(),k.update(Z,A),H?Z.length:void 0);try{_=await this.chatMLFetcher.fetchOne(`inlineChat/${d.intent.id}`,m,F,o,1,d.endpoint,void 0,{temperature:h0.pickTemperature(r),top_p:r8.top_p},{messageId:w.telemetryMessageId,messageSource:d.intent.id!==aa.ID?`inline.${d.intent.id}`:"inline.user"},{intent:!0})}catch(Z){throw this._telemetryService.sendGHTelemetryException(Z,"Fetching failed: "),v.status="error",v.response={message:Z.message,type:"server"},new Error("Failed to make request")}if(_.type!=="success")return this._handleFetchError(v,_,w,f.interactionOutcome);if(x=_.value,x.length===0){w.sendTelemetry(_.requestId,"unknown","Empty response",f.interactionOutcome);return}k.resolve(),await M,S&&await S.finalize(),v.status="success";let ue=x;return v.response={message:ue,type:"model"},w.sendTelemetry(_.requestId,"success",ue,f.interactionOutcome),{kind:"ok",promptQuery:p,interactionOutcome:f.interactionOutcome,store:f.store,messageId:w.telemetryMessageId,aiEditCollector:e.aiEditCollector,telemetry:w}}_handleFetchError(e,r,n,o){let{turnStatus:s,message:a,messageType:c,errorDetails:l}=this._interpretFetchError(r);return e.status=s,e.response={message:a,type:c},n.sendTelemetry(r.requestId,r.type,a,o),{kind:"error",errorDetails:l}}_interpretFetchError(e){switch(e.type){case"rateLimited":return{turnStatus:"error",message:`Response failed ${e.type}: ${e.reason}`,messageType:"server",errorDetails:{message:aT.t("Sorry, your request was rate-limited. Please wait and try sending again later.")}};case"badRequest":return{turnStatus:"error",message:`Response failed ${e.type}: ${e.reason}`,messageType:"server",errorDetails:{message:e.reason}};case"failed":return this.logService.public.error(`Response failed: ${e.reason}`),{turnStatus:"error",message:e.reason,messageType:"server",errorDetails:{message:e.reason}};case"canceled":return this.logService.public.debug(`Response canceled: ${e.reason}`),{turnStatus:"error",message:"Cancelled",messageType:"user",errorDetails:{message:"Cancelled"}};case"unknown":{let r=`Response is empty: ${e.reason}`;return this.logService.public.info(r),{turnStatus:"error",message:r,messageType:"server",errorDetails:{message:aT.t("Sorry, no response was returned.")}}}case"filtered":{let r=`Response got filtered: ${e.reason}`;return this.logService.internal.info(r),{turnStatus:"filtered",message:r,messageType:"server",errorDetails:{message:HF(e.category),responseIsFiltered:!0}}}case"offTopic":return this.logService.internal.info(`Response marked as offtopic: ${e.reason}`),{turnStatus:"off-topic",message:this.rejectionMessage,messageType:"offtopic-detection",errorDetails:{message:this.rejectionMessage}};case"length":{let r=`Response was too long: ${e.reason}`;return this.logService.internal.info(r),{turnStatus:"error",message:r,messageType:"server",errorDetails:{message:aT.t("Sorry, the response hit the length limit. Please rephrase your prompt.")}}}default:return this.logService.public.error("Unexpected response type"),this.logService.internal.error(JSON.stringify(e)),{turnStatus:"error",message:`Unexpected response type: ${JSON.stringify(e)}`,messageType:"server",errorDetails:{message:aT.t("Sorry, something went wrong.")}}}}static pickTemperature(e){return"attempt"in e&&typeof e.attempt=="number"?Math.min(r8.temperature*(e.attempt+1),2):r8.temperature}};h0=E([y(2,ie),y(3,ge),y(4,Ft),y(5,Vi),y(6,Te),y(7,yt),y(8,_r),y(9,j),y(10,Wl),y(11,hc)],h0);var ID=class{constructor(e){this._currentDocument=e;this._annotations=[];this._seenMarkdown=!1;this._seenEdits=new yM;this._seenNoOpEdits=!1;this.store=void 0}get _interactionOutcomeKind(){return this._seenEdits.size>0?this._seenEdits.size===1&&this._currentDocument&&this._seenEdits.has(this._currentDocument)?"inlineEdit":"workspaceEdit":this._seenMarkdown?"conversational":this._seenNoOpEdits?"noopEdit":"none"}get interactionOutcome(){return new K5(this._interactionOutcomeKind,this._annotations)}spyOnStream(e){return ol.spy(e,r=>{r instanceof ai&&this._markEmittedMarkdown(r.value),r instanceof Da&&this._markEmittedEdits(r.uri,r.edits)})}_markEmittedMarkdown(e){this._seenMarkdown=!0}_markEmittedEdits(e,r){this._seenEdits.add(e)}addAnnotations(e=[]){this._seenNoOpEdits=this._seenNoOpEdits||e.some(r=>r.label==="noop edits"),this._annotations=this._annotations.concat(e)}storeInInlineSession(e){this.store=e}},CD=class{constructor(e,r,n){this.turn=e;this.messages=r;this._interactionOutcomeComputer=n}addAnnotations(e){this._interactionOutcomeComputer.addAnnotations(e)}storeInInlineSession(e){this._interactionOutcomeComputer.storeInInlineSession(e)}};function Z6(t,e){let r=e.filter(u=>t.intersection(u.range)),n={problems:e.map(u=>u.message).join(", "),problemsCount:e.length,diagnosticCodes:"",diagnosticsCount:0},o={problems:r.map(u=>u.message).join(", "),problemsCount:r.length,diagnosticCodes:"",diagnosticsCount:0},s=new Map,a=new Map;e.forEach(u=>{let d=u.code,p=typeof d=="string"||typeof d=="number"?d.toString():d?d.value.toString():"",f=u.source?`${u.source}@${p}`:p;s.set(f,(s.get(f)||0)+1),t.intersection(u.range)&&a.set(f,(a.get(f)||0)+1)});let c=u=>{let d="";return u.forEach((p,f)=>{d+=`${f}:${p},`}),d};n.diagnosticCodes=c(s),n.diagnosticsCount=s.size,o.diagnosticCodes=c(a),o.diagnosticsCount=a.size;let l=e.length>0?e[0].source??"":"";return{fileDiagnosticsTelemetry:n,selectionDiagnosticsTelemetry:o,diagnosticsProvider:l}}var li=q(require("vscode"));var g0=class extends li.CodeAction{constructor(){super(...arguments);this.isAI=!0}},La=class{constructor(e,r){this.configurationService=e;this.ignoreService=r}static{this.fixKind=li.CodeActionKind.QuickFix.append("copilot")}static{this.explainKind=li.CodeActionKind.QuickFix.append("explain").append("copilot")}static{this.reviewKind=li.CodeActionKind.RefactorRewrite.append("review").append("copilot")}static{this.providedCodeActionKinds=[this.fixKind,this.explainKind,this.reviewKind]}static getSevereDiagnostics(e){let r=e.filter(n=>n.severity<=li.DiagnosticSeverity.Warning);return r.length===0?[]:r}static getDiagnosticsAsText(e){return e.map(r=>r.message).join(", ")}async provideCodeActions(e,r,n){if(!this.configurationService.getConfig(le.EnableCodeActions)||await this.ignoreService.isCopilotIgnored(e.uri))return;let s=[],a=li.window.activeTextEditor;if(!a)return s;if(this.configurationService.getConfig(le.ReviewContextMenu)&&!a.selection.isEmpty){let h=new g0(li.l10n.t("Review using Copilot (Experimental)"),La.reviewKind);h.command={title:h.title,command:"github.copilot.interactiveEditor.review"},s.push(h)}let c=La.getSevereDiagnostics(n.diagnostics);if(c.length===0)return s;let l=c.map(h=>h.range).reduce((h,g)=>h.union(g)),u=new li.Selection(l.start,l.end),d=La.getDiagnosticsAsText(c),p=new g0(li.l10n.t("Fix using Copilot"),La.fixKind);p.diagnostics=c,p.command={title:p.title,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${d}`,position:l.start,initialSelection:u,initialRange:l}]};let f=new g0(li.l10n.t("Explain using Copilot"),La.explainKind);f.diagnostics=c;let m=`/explain ${d}`;return this.configurationService.getConfig(le.ExplainIntentRefer)&&(m=`@${cD} ${m}`),f.command={title:f.title,command:"github.copilot.chat.explain",arguments:[m]},s.push(p,f),s}};La=E([y(0,he),y(1,Te)],La);var Td=class{constructor(e,r,n,o,s){this.logger=e;this.configurationService=r;this.ignoreService=n;this.parserService=o;this.telemetryService=s}static{this.generateOrModifyKind=li.CodeActionKind.RefactorRewrite.append("copilot")}static{this.generateDocsKind=li.CodeActionKind.RefactorRewrite.append("generateDocs").append("copilot")}static{this.generateTestsKind=li.CodeActionKind.RefactorRewrite.append("generateTests").append("copilot")}static{this.providedCodeActionKinds=[this.generateOrModifyKind,this.generateDocsKind,this.generateTestsKind]}async provideCodeActions(e,r,n){if(!this.configurationService.getConfig(le.EnableCodeActions)||await this.ignoreService.isCopilotIgnored(e.uri))return;let s=this.provideGenerateUsingCopilotCodeAction(e,r),a=await this.provideDocGenCodeAction(e,r),c=await this.provideTestGenCodeAction(e,r);return Dr([a,s,c])}provideGenerateUsingCopilotCodeAction(e,r){let n;if(r.isEmpty){let s=e.lineAt(r.start.line).text;r.end.character===s.length&&/^\s*$/g.test(s)&&(n=li.l10n.t("Generate using Copilot"))}else{let s=e.getText(r);/^\s*$/g.test(s)||(n=li.l10n.t("Modify using Copilot"))}if(n===void 0)return;let o=new g0(n,Td.generateOrModifyKind);return o.command={title:o.title,command:"vscode.editorChat.start",arguments:[{position:r.start,initialSelection:new li.Selection(r.start,r.end),initialRange:r}]},o}async provideDocGenCodeAction(e,r){let n=e.offsetAt(r.start),o=e.offsetAt(r.end),s={startIndex:n,endIndex:o},a,c=this.parserService.getTreeSitterAST(e);if(c)try{a=await c.getDocumentableNodeIfOnIdentifier(s)}catch(p){this.logger.internal.error(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed"),this.telemetryService.sendGHTelemetryException(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed")}if(a===void 0)return;let l=li.l10n.t("Generate Documentation using Copilot"),u=new g0(l,Td.generateDocsKind),d=a.nodeRange===void 0?void 0:new Be(e.positionAt(a.nodeRange.startIndex),e.positionAt(a.nodeRange.endIndex));return u.command={title:l,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:"/doc",initialRange:d}]},u}async provideTestGenCodeAction(e,r){let n=e.offsetAt(r.start),o=e.offsetAt(r.end),s={startIndex:n,endIndex:o},a=null,c=this.parserService.getTreeSitterAST(e);if(c)try{a=await c.getTestableNode(s)}catch(p){this.logger.internal.error(p,"RefactorsProvider: getTestableNode failed"),this.telemetryService.sendGHTelemetryException(p,"RefactorsProvider: getTestableNode failed")}if(!a||!Os(e,a.identifier.range).contains(r))return;let u=li.l10n.t("Generate Tests using Copilot"),d=new g0(u,Td.generateTestsKind);return d.command={title:u,command:"github.copilot.interactiveEditor.generateTests"},d}};Td=E([y(0,ie),y(1,he),y(2,Te),y(3,dt),y(4,ge)],Td);var Vye=require("util"),v0=q(require("vscode"));var AKe="application/vnd.code.notebook.error",n8=class{constructor(e){this.accessor=e}async provideCellStatusBarItems(e,r){if(v0.workspace.getConfiguration("notebook").get("cellFailureDiagnostics"))return[];if(e.kind===v0.NotebookCellKind.Markup){let a=v0.workspace.getConfiguration("notebook.experimental").get("cellChat");if(!a)return[];let c=e.document.getText().trim();if(!a||c.length===0)return[];let l="Generate code from markdown content",u=c;return[{text:"$(sparkle)",alignment:v0.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:l,command:{title:l,command:"notebook.cell.chat.start",arguments:[{index:e.index+1,input:u,autoSend:!0}]}}]}let o=e.outputs.flatMap(a=>a.items).find(a=>a.mime===AKe);if(!o)return[];let s;try{let a=new Vye.TextDecoder;if(s=JSON.parse(a.decode(o.data)),!s.name&&!s.message)return[];let c="Fix using Copilot",l=[s.name,s.message].filter(Boolean).join(": ").replace(/\s*\(\S+,\s*line\s*\d+\)/,"");return[{text:"$(sparkle)",alignment:v0.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:c,command:{title:c,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${l}`}]}}]}catch(a){this.accessor.get(ie).public.error(`Failed to parse error output ${a}`)}return[]}};function Gye(t){let e=t.get(j),r=new ht,n=async(b,_)=>{let x=`@${cD} /explain `,S,I,w=!1;if(typeof b=="string"&&b)x=b;else{let k=t.get(Ft),M=bn.getCurrentSelection(k,!0);if(M){let F=_t.languages.getDiagnostics(M.activeDocument.uri),ue=F.filter(V=>!!V.range.intersection(M.range));La.getSevereDiagnostics(ue).length&&(x+=La.getDiagnosticsAsText(F),w=!0)}let H=bn.getCurrentSelection(k);if(!w&&H&&(x+=p6,S=xv.formatSelection({languageId:H.languageId,selectedText:H.selectedText}),I=H.activeDocument.uri),!w&&M&&_)try{let F=await Fs.getSelectedScope(t,{document:M.activeDocument,selection:M.range});if(F&&F.symbolAtCursorState&&F.symbolAtCursorState.codeAtCursor){x+=p6;let ue=F.symbolAtCursorState.document.languageId??"";S=xv.formatSelection({languageId:ue,selectedText:F.symbolAtCursorState.codeAtCursor}),I=M.activeDocument.uri}}catch(F){if(F instanceof dn)return}}I&&S&&!await t.get(Te).isCopilotIgnored(I)&&(x+=S),_t.commands.executeCommand("workbench.action.chat.open",{query:x})},o=async(b,_=!1)=>{let x=t.get(qo),S=x.findReviewComment(b);if(!S||!S.suggestion)return;let I=_t.window.activeTextEditor;if(!I||I.document!==S.document)return;let{edits:w}=await S.suggestion;I.edit(M=>{w.forEach(H=>{M.replace(H.range,H.newText)})}),_&&f(b,1);let k=x.getReviewComments().length;x.removeReviewComments([S]),t0(S,k,"applySuggestion",t.get(ie),t.get(ge),t.get(j))},s=async b=>{let _=t.get(qo),x=_.findReviewComment(b);if(!x)return;let S=_.getReviewComments().length,I=x.body instanceof _t.MarkdownString?x.body.value:x.body;_.removeReviewComments([x]),await _t.commands.executeCommand("vscode.editorChat.start",{initialRange:b.range,message:`/fix ${I}`,autoSend:!0}),t0(x,S,"continueInInlineChat",t.get(ie),t.get(ge),t.get(j))},a=async b=>{let _=t.get(qo),x=_.findReviewComment(b);if(!x)return;let S=_.getReviewComments().length,I=x.body instanceof _t.MarkdownString?x.body.value:x.body;await _t.commands.executeCommand("workbench.action.chat.open",{query:"Explain your comment.",isPartialQuery:!0,previousRequests:[{request:"Review my code.",response:`In file \`${Hye.default.basename(x.uri.fsPath)}\` at line ${x.range.start.line+1}:

${I}`}]}),t0(x,S,"continueInChat",t.get(ie),t.get(ge),t.get(j))},c=async(b,_=!1)=>{_&&f(b,1);let x=t.get(qo),S=x.findReviewComment(b);if(S){let I=x.getReviewComments().length;x.removeReviewComments([S]),t0(S,I,"discardComment",t.get(ie),t.get(ge),t.get(j))}},l=async()=>{let b=t.get(qo),_=b.getReviewComments();_.length&&(b.removeReviewComments(_),t0(_,_.length,"discardAllComments",t.get(ie),t.get(ge),t.get(j)))},u=async b=>{let _=t.get(qo),x=_.findReviewComment(b);if(x){let S=_.getReviewComments().length;t0(x,S,"helpful",t.get(ie),t.get(ge),t.get(j))}},d=async b=>{let _=t.get(qo),x=_.findReviewComment(b);if(x){let S=_.getReviewComments().length;t0(x,S,"unhelpful",t.get(ie),t.get(ge),t.get(j))}},p=t.get(Bt).extensionMode;typeof p=="number"&&p!==_t.ExtensionMode.Test&&t.get(qo).updateContextValues();let f=(b,_)=>{let x=t.get(qo),S;if(b){let w=x.findReviewComment(b);if(!w)return;let k=x.getReviewComments(),H=(k.indexOf(w)+_+k.length)%k.length;S=k[H]}else{let w=x.getReviewComments();S=w[_>0?0:w.length-1]}let I=S&&x.findCommentThread(S);I&&(_!==0&&I.reveal(),DKe(t,I))},m=()=>_t.commands.executeCommand("vscode.editorChat.start",{message:"/generate "}),h=()=>_t.commands.executeCommand("vscode.editorChat.start",{message:`/${Bp.ID} `,autoSend:!0,initialRange:_t.window.activeTextEditor?.selection}),g=b=>{let _=b&&typeof b=="object"&&"document"in b&&b.document&&typeof b.document=="object"&&"getText"in b.document&&"selection"in b&&b.selection instanceof _t.Range?b:void 0;return e.createInstance(wC).runCommand(_)},v=()=>{let b=_t.window.activeTextEditor;if(!b)return;let _=b.selection,x=_t.languages.getDiagnostics(b.document.uri).filter(S=>!!_.intersection(S.range)).map(S=>S.message).join(", ");return _t.commands.executeCommand("vscode.editorChat.start",{message:`/fix ${x}`,autoSend:!0,initialRange:_t.window.activeTextEditor?.selection})};return r.add(_t.commands.registerCommand("github.copilot.chat.explain",n)),r.add(_t.commands.registerCommand("github.copilot.chat.explain.palette",()=>n(void 0,!0))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review",()=>AC(t,"selection"))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.stagedChanges",()=>AC(t,"index"))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.changes",()=>AC(t,"workingTree"))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.apply",o)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.applyAndNext",b=>o(b,!0))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.applyShort",b=>o(b,!0))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.continueInInlineChat",s)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.continueInChat",a)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.discard",c)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.discardAndNext",b=>c(b,!0))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.discardShort",b=>c(b,!0))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.discardAll",l)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.markHelpful",u)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.markUnhelpful",d)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.previous",b=>f(b,-1))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.next",b=>f(b,1))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.review.current",b=>f(b,0))),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.generate",m)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.generateDocs",h)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.generateTests",g)),r.add(_t.commands.registerCommand("github.copilot.interactiveEditor.fix",v)),r.add(_t.languages.registerCodeActionsProvider("*",e.createInstance(La),{providedCodeActionKinds:La.providedCodeActionKinds})),r.add(_t.languages.registerCodeActionsProvider("*",e.createInstance(Td),{providedCodeActionKinds:Td.providedCodeActionKinds})),r.add(_t.notebooks.registerNotebookCellStatusBarItemProvider("jupyter-notebook",new n8(t))),r}function DKe(t,e){let r=t.get(qo),n=r.findReviewComment(e);!n||n.suggestion||n.skipSuggestion||(n.suggestion=(async()=>{let o=n.body instanceof _t.MarkdownString?n.body.value:n.body,a=t.get(j).createInstance(h0,"editorAgentName","options.rejectionMessage"),c=n.document,l=new _t.Selection(n.range.start,n.range.end),u=await a.prepareInteractiveEditorSession({document:c,selection:l}),d=u.wholeRange??l,p="fix",f=o,m={location:_t.ChatLocation.Editor,location2:new _t.ChatRequestEditorData(c,l,d),command:p,prompt:f,selection:l,wholeRange:d,references:[],attempt:0,enableCommandDetection:!1,isParticipantDetected:!1,toolReferences:[],toolInvocationToken:void 0},h="",g=[],v=new ol(_=>{_ instanceof _t.ChatResponseTextEditPart&&_.edits.length>0?g.push(..._.edits.map(x=>({range:x.range,newText:x.newText,oldText:c.getText(x.range)})).filter(x=>x.newText!==x.oldText)):_ instanceof _t.ChatResponseMarkdownPart&&(h+=_.value.value)});await a.provideInteractiveEditorResponse(u,m,v,Wt.None);let b={markdown:h,edits:g};return n.suggestion=b,r.updateReviewComment(n),e.contextValue=g.length?"hasSuggestion":"hasNoSuggestion",b})().catch(o=>(t.get(ie).public.error(o,"Error fetching suggestion"),n.suggestion={markdown:`Error fetching suggestion: ${o?.message}`,edits:[]},r.updateReviewComment(n),n.suggestion)),r.updateReviewComment(n))}var oh=q(Ct());function i8(t,e=!1){let r=t.length,n=0,o="",s=0,a=16,c=0,l=0,u=0,d=0,p=0;function f(x,S){let I=0,w=0;for(;I<x||!S;){let k=t.charCodeAt(n);if(k>=48&&k<=57)w=w*16+k-48;else if(k>=65&&k<=70)w=w*16+k-65+10;else if(k>=97&&k<=102)w=w*16+k-97+10;else break;n++,I++}return I<x&&(w=-1),w}function m(x){n=x,o="",s=0,a=16,p=0}function h(){let x=n;if(t.charCodeAt(n)===48)n++;else for(n++;n<t.length&&cT(t.charCodeAt(n));)n++;if(n<t.length&&t.charCodeAt(n)===46)if(n++,n<t.length&&cT(t.charCodeAt(n)))for(n++;n<t.length&&cT(t.charCodeAt(n));)n++;else return p=3,t.substring(x,n);let S=n;if(n<t.length&&(t.charCodeAt(n)===69||t.charCodeAt(n)===101))if(n++,(n<t.length&&t.charCodeAt(n)===43||t.charCodeAt(n)===45)&&n++,n<t.length&&cT(t.charCodeAt(n))){for(n++;n<t.length&&cT(t.charCodeAt(n));)n++;S=n}else p=3;return t.substring(x,S)}function g(){let x="",S=n;for(;;){if(n>=r){x+=t.substring(S,n),p=2;break}let I=t.charCodeAt(n);if(I===34){x+=t.substring(S,n),n++;break}if(I===92){if(x+=t.substring(S,n),n++,n>=r){p=2;break}switch(t.charCodeAt(n++)){case 34:x+='"';break;case 92:x+="\\";break;case 47:x+="/";break;case 98:x+="\b";break;case 102:x+="\f";break;case 110:x+=`
`;break;case 114:x+="\r";break;case 116:x+="	";break;case 117:let k=f(4,!0);k>=0?x+=String.fromCharCode(k):p=4;break;default:p=5}S=n;continue}if(I>=0&&I<=31)if(wD(I)){x+=t.substring(S,n),p=2;break}else p=6;n++}return x}function v(){if(o="",p=0,s=n,l=c,d=u,n>=r)return s=r,a=17;let x=t.charCodeAt(n);if($Q(x)){do n++,o+=String.fromCharCode(x),x=t.charCodeAt(n);while($Q(x));return a=15}if(wD(x))return n++,o+=String.fromCharCode(x),x===13&&t.charCodeAt(n)===10&&(n++,o+=`
`),c++,u=n,a=14;switch(x){case 123:return n++,a=1;case 125:return n++,a=2;case 91:return n++,a=3;case 93:return n++,a=4;case 58:return n++,a=6;case 44:return n++,a=5;case 34:return n++,o=g(),a=10;case 47:let S=n-1;if(t.charCodeAt(n+1)===47){for(n+=2;n<r&&!wD(t.charCodeAt(n));)n++;return o=t.substring(S,n),a=12}if(t.charCodeAt(n+1)===42){n+=2;let I=r-1,w=!1;for(;n<I;){let k=t.charCodeAt(n);if(k===42&&t.charCodeAt(n+1)===47){n+=2,w=!0;break}n++,wD(k)&&(k===13&&t.charCodeAt(n)===10&&n++,c++,u=n)}return w||(n++,p=1),o=t.substring(S,n),a=13}return o+=String.fromCharCode(x),n++,a=16;case 45:if(o+=String.fromCharCode(x),n++,n===r||!cT(t.charCodeAt(n)))return a=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return o+=h(),a=11;default:for(;n<r&&b(x);)n++,x=t.charCodeAt(n);if(s!==n){switch(o=t.substring(s,n),o){case"true":return a=8;case"false":return a=9;case"null":return a=7}return a=16}return o+=String.fromCharCode(x),n++,a=16}}function b(x){if($Q(x)||wD(x))return!1;switch(x){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function _(){let x;do x=v();while(x>=12&&x<=15);return x}return{setPosition:m,getPosition:()=>n,scan:e?_:v,getToken:()=>a,getTokenValue:()=>o,getTokenOffset:()=>s,getTokenLength:()=>n-s,getTokenStartLine:()=>l,getTokenStartCharacter:()=>s-d,getTokenError:()=>p}}function $Q(t){return t===32||t===9}function wD(t){return t===10||t===13}function cT(t){return t>=48&&t<=57}var zye;(function(t){t[t.lineFeed=10]="lineFeed",t[t.carriageReturn=13]="carriageReturn",t[t.space=32]="space",t[t._0=48]="_0",t[t._1=49]="_1",t[t._2=50]="_2",t[t._3=51]="_3",t[t._4=52]="_4",t[t._5=53]="_5",t[t._6=54]="_6",t[t._7=55]="_7",t[t._8=56]="_8",t[t._9=57]="_9",t[t.a=97]="a",t[t.b=98]="b",t[t.c=99]="c",t[t.d=100]="d",t[t.e=101]="e",t[t.f=102]="f",t[t.g=103]="g",t[t.h=104]="h",t[t.i=105]="i",t[t.j=106]="j",t[t.k=107]="k",t[t.l=108]="l",t[t.m=109]="m",t[t.n=110]="n",t[t.o=111]="o",t[t.p=112]="p",t[t.q=113]="q",t[t.r=114]="r",t[t.s=115]="s",t[t.t=116]="t",t[t.u=117]="u",t[t.v=118]="v",t[t.w=119]="w",t[t.x=120]="x",t[t.y=121]="y",t[t.z=122]="z",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.asterisk=42]="asterisk",t[t.backslash=92]="backslash",t[t.closeBrace=125]="closeBrace",t[t.closeBracket=93]="closeBracket",t[t.colon=58]="colon",t[t.comma=44]="comma",t[t.dot=46]="dot",t[t.doubleQuote=34]="doubleQuote",t[t.minus=45]="minus",t[t.openBrace=123]="openBrace",t[t.openBracket=91]="openBracket",t[t.plus=43]="plus",t[t.slash=47]="slash",t[t.formFeed=12]="formFeed",t[t.tab=9]="tab"})(zye||(zye={}));var o8;(function(t){t.DEFAULT={allowTrailingComma:!1}})(o8||(o8={}));function $ye(t,e=[],r=o8.DEFAULT){let n=null,o=[],s=[];function a(l){Array.isArray(o)?o.push(l):n!==null&&(o[n]=l)}return WQ(t,{onObjectBegin:()=>{let l={};a(l),s.push(o),o=l,n=null},onObjectProperty:l=>{n=l},onObjectEnd:()=>{o=s.pop()},onArrayBegin:()=>{let l=[];a(l),s.push(o),o=l,n=null},onArrayEnd:()=>{o=s.pop()},onLiteralValue:a,onError:(l,u,d)=>{e.push({error:l,offset:u,length:d})}},r),o[0]}function WQ(t,e,r=o8.DEFAULT){let n=i8(t,!1),o=[];function s(Z){return Z?()=>Z(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function a(Z){return Z?()=>Z(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>o.slice()):()=>!0}function c(Z){return Z?V=>Z(V,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function l(Z){return Z?V=>Z(V,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>o.slice()):()=>!0}let u=a(e.onObjectBegin),d=l(e.onObjectProperty),p=s(e.onObjectEnd),f=a(e.onArrayBegin),m=s(e.onArrayEnd),h=l(e.onLiteralValue),g=c(e.onSeparator),v=s(e.onComment),b=c(e.onError),_=r&&r.disallowComments,x=r&&r.allowTrailingComma;function S(){for(;;){let Z=n.scan();switch(n.getTokenError()){case 4:I(14);break;case 5:I(15);break;case 3:I(13);break;case 1:_||I(11);break;case 2:I(12);break;case 6:I(16);break}switch(Z){case 12:case 13:_?I(10):v();break;case 16:I(1);break;case 15:case 14:break;default:return Z}}}function I(Z,V=[],A=[]){if(b(Z),V.length+A.length>0){let P=n.getToken();for(;P!==17;){if(V.indexOf(P)!==-1){S();break}else if(A.indexOf(P)!==-1)break;P=S()}}}function w(Z){let V=n.getTokenValue();return Z?h(V):(d(V),o.push(V)),S(),!0}function k(){switch(n.getToken()){case 11:let Z=n.getTokenValue(),V=Number(Z);isNaN(V)&&(I(2),V=0),h(V);break;case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return S(),!0}function M(){return n.getToken()!==10?(I(3,[],[2,5]),!1):(w(!1),n.getToken()===6?(g(":"),S(),ue()||I(4,[],[2,5])):I(5,[],[2,5]),o.pop(),!0)}function H(){u(),S();let Z=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(Z||I(4,[],[]),g(","),S(),n.getToken()===2&&x)break}else Z&&I(6,[],[]);M()||I(4,[],[2,5]),Z=!0}return p(),n.getToken()!==2?I(7,[2],[]):S(),!0}function F(){f(),S();let Z=!0,V=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(V||I(4,[],[]),g(","),S(),n.getToken()===4&&x)break}else V&&I(6,[],[]);Z?(o.push(0),Z=!1):o[o.length-1]++,ue()||I(4,[],[4,5]),V=!0}return m(),Z||o.pop(),n.getToken()!==4?I(8,[4],[]):S(),!0}function ue(){switch(n.getToken()){case 3:return F();case 1:return H();case 10:return w(!0);default:return k()}}return S(),n.getToken()===17?r.allowEmptyContent?!0:(I(4,[],[]),!1):ue()?(n.getToken()!==17&&I(9,[],[]),!0):(I(4,[],[]),!1)}var Wye;(function(t){t[t.None=0]="None",t[t.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=2]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",t[t.InvalidUnicode=4]="InvalidUnicode",t[t.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",t[t.InvalidCharacter=6]="InvalidCharacter"})(Wye||(Wye={}));var Kye;(function(t){t[t.OpenBraceToken=1]="OpenBraceToken",t[t.CloseBraceToken=2]="CloseBraceToken",t[t.OpenBracketToken=3]="OpenBracketToken",t[t.CloseBracketToken=4]="CloseBracketToken",t[t.CommaToken=5]="CommaToken",t[t.ColonToken=6]="ColonToken",t[t.NullKeyword=7]="NullKeyword",t[t.TrueKeyword=8]="TrueKeyword",t[t.FalseKeyword=9]="FalseKeyword",t[t.StringLiteral=10]="StringLiteral",t[t.NumericLiteral=11]="NumericLiteral",t[t.LineCommentTrivia=12]="LineCommentTrivia",t[t.BlockCommentTrivia=13]="BlockCommentTrivia",t[t.LineBreakTrivia=14]="LineBreakTrivia",t[t.Trivia=15]="Trivia",t[t.Unknown=16]="Unknown",t[t.EOF=17]="EOF"})(Kye||(Kye={}));var Jp=$ye;var Qye=WQ;var Yye;(function(t){t[t.InvalidSymbol=1]="InvalidSymbol",t[t.InvalidNumberFormat=2]="InvalidNumberFormat",t[t.PropertyNameExpected=3]="PropertyNameExpected",t[t.ValueExpected=4]="ValueExpected",t[t.ColonExpected=5]="ColonExpected",t[t.CommaExpected=6]="CommaExpected",t[t.CloseBraceExpected=7]="CloseBraceExpected",t[t.CloseBracketExpected=8]="CloseBracketExpected",t[t.EndOfFileExpected=9]="EndOfFileExpected",t[t.InvalidCommentToken=10]="InvalidCommentToken",t[t.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=12]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",t[t.InvalidUnicode=14]="InvalidUnicode",t[t.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",t[t.InvalidCharacter=16]="InvalidCharacter"})(Yye||(Yye={}));var nbe=q(require("path"));function s8(t,e){let r=t.trim().split(`
`),n=[],o,s={name:"",children:[]};n[0]=s;for(let c of r){let l=qKe(c),u=c.lastIndexOf("\u2500\u2500 "),d=u>=0?c.substring(u+3):c,p={name:d};if(l===0){o=e(d),s.name=d;continue}else{for(;l>0&&n[l-1]===void 0;)l--;n[l-1].children===void 0?n[l-1].children=[p]:n[l-1].children?.push(p),n[l]=p}}if(o===void 0)throw new Error("Base URI is undefined");let a=Zye(s.children);return s.children=a.sort((c,l)=>c.children&&!l.children?-1:1),{chatResponseTree:new ud([s],o),projectName:s.name}}function Jye(t){let e=t.map(n=>({node:n,path:n.name})),r=[];for(;e.length>0;){let{node:n,path:o}=e.shift();if(n.children&&n.children.length>0)for(let s of n.children)e.push({node:s,path:`${o}/${s.name}`});else r.push(o)}return r}function qKe(t){let e=(t.match(/│   /g)||[]).length;return e+=(t.match(/\|   /g)||[]).length,e+=(t.match(/    /g)||[]).length,e+=(t.match(/├── /g)||[]).length,e+=(t.match(/└── /g)||[]).length,e}var jKe=["node_modules","out","bin","debug","obj","lib",".dll",".pdb",".lib",".jpg",".png",".ico",".gif",".svg",".jpeg",".tiff",".bmp",".webp",".jpeg",".gitignore","LICENSE.txt","yarn.lock","package-lock.json"];function Zye(t){let e=[];for(let r of t)VKe(r)||(r.children&&(r.children=Zye(r.children)),e.push(r));return e}function VKe(t){return!!jKe.includes(t.name)}var kD=q(Ct()),fl=q(Ue()),ebe=q(require("path"));var a8=ne("IProjectTemplatesIndex"),lT=class{constructor(e=!0,r,n){this._isIndexLoaded=!1;let o=qm(r.getEditorInfo().version);this.embeddingsCache=e?n.createInstance(Hl,1,"projectTemplateEmbeddings",o,"project-templates"):n.createInstance(pd,1,"projectTemplateEmbeddings",o)}async updateIndex(){this._isIndexLoaded||(this._isIndexLoaded=!0,this._embeddings=await this.embeddingsCache.getCache())}async nClosestValues(e,r,n=0){if(await this.updateIndex(),!this._embeddings)return[];let o=Object.entries(this._embeddings).map(s=>{if(!s[1].embedding)return{key:`${s[0]}`,similarity:0};let a=mv(e,s[1].embedding);return{key:`${s[0]} `,similarity:a}});return o=o.filter(s=>s.similarity>n),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,r).map(s=>s.key)}};lT=E([y(1,gt),y(2,j)],lT);async function Z_(t,e,r,n){let o=null,s=!1;o=setTimeout(()=>{s||t.report(e)},n);try{let a=await r;return s=!0,a}finally{o&&clearTimeout(o)}}var c8=q(Ue());var wn=class extends c8.PromptElement{async render(){let e=Si(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0);return vscpp(c8.TextChunk,null,e)}};function HKe(t){let e=t.split(`
`),r={};return e.forEach((n,o)=>{n.startsWith("# Intent")?r.intent=e[o+1]?.trim():n.startsWith("# Question")&&(r.question=e[o+1]?.trim())}),r}var uT=class extends fl.PromptElement{constructor(r,n,o,s,a,c,l){super(r);this.chatMLFetcher=n;this.instantiationService=o;this.embeddingsComputer=s;this.endPointProvider=a;this.projectTemplatesIndex=c;this.repositoryService=l}async prepare(r,n,o){if(!n)throw new Error("Progress is required");n?.report(new xi(kD.t("Determining user intent...")));let s=await this.endPointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:a}=await GKe(this.instantiationService,s,this.props.promptContext);if(o.isCancellationRequested)return{};let c=await this.chatMLFetcher.fetchOne("newWorkspace",a,void 0,o,2,s,void 0,{temperature:0});if(c.type==="success"){let l=HKe(c.value);if(l.intent==="File")return{intent:l};if(l.intent==="Project"){if(this.props.useTemplates){let u=await this.endPointProvider.getEmbeddingsEndpoint("text3small"),d=await this.embeddingsComputer.computeEmbeddings(u,[l.question],{dimensions:512},void 0);if(d){n.report(new xi(kD.t("Searching project template index...")));let p=await this.projectTemplatesIndex.nClosestValues(d.embeddings[0],1);if(p.length>0){let f=p[0]?.split(":"),m=f[0].trim(),h=f[1].trim(),g=f[2].trim()===""?".":f[2].trim();if(m&&h&&g){let v=await Z_(n,new xi(kD.t("Fetching project contents...")),this.repositoryService.getRepositoryItems(m,h,g),500);if(v.length>0){let b;return g==="."?b=`httpx://github.com/${m}/${h}`:b=ebe.default.dirname(v[0].html_url),this._metadata=new ex(m,h,g,v),{url:b}}}}}}return{intent:l}}else return{intent:{intent:"Project",question:this.props.promptContext.query}}}else throw new Error(kD.t("Encountered an error while determining user intent: ({0}) {1}",c.type,c.reason))}render(r){let{query:n,history:o,chatVariables:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(It,{priority:600,history:o.filter(a=>a.response?.name===YQ&&a.request.type==="user")}),r.intent?.intent==="File"&&vscpp(vscppf,null,vscpp(fl.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to generate the contents of a new file based on the user's query.",vscpp("br",null),"If a code snippet or markdown is provided, consider it as part of the file content creation process.",vscpp("br",null),"The code should not contain bugs and should adhere to best practices.",vscpp("br",null),"Your response should be just two code blocks - the first one with the file contents and the second JSON code block with a file name.",vscpp("br",null),"Your response should not contain any other information or explanation.",vscpp("br",null),"# Response Template",vscpp("br",null),vscpp(wn,{code:`
    def greet(name):
      print(f"Hello, {name}!")
    greet("John Doe")
  `,languageId:"python"}),vscpp(wn,{code:`
    'fileName': 'suggestedFileName',
`,languageId:"json"}),vscpp("br",null),"Examples:",vscpp("br",null),"User: Generate the contents of the new file based on this query:",vscpp("br",null),"python hello world file",vscpp("br",null),"Assistant:",vscpp("br",null),vscpp(wn,{code:`
    def greet(name):
      print(f"Hello, {name}!")

    greet("John Doe")
  `,languageId:"python"}),vscpp(wn,{code:`
    {
    'fileName': 'sampleHelloWorld.py',
    }
`,languageId:"json"}),vscpp(kt,null)),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{priority:900,chatVariables:s,query:r.intent.question})),r.intent?.intent==="Project"&&!this._metadata&&vscpp(vscppf,null,vscpp(fl.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to suggest a filetree directory structure for a project that a user wants to create.",vscpp("br",null),"If a step does not relate to filetree directory structures, do not respond. Please do not guess a response and instead just respond with a polite apology if you are unsure. ## Additional Rules ##",vscpp("br",null),'If the user does not specify "app" or "project" in their query, assume they are asking for a project.',vscpp("br",null),`You should always start your response to the user with "Sure, here's a proposed directory structure for a [project type] app:"`,vscpp("br",null),"You should generate a markdown file tree structure for the sample project and include it in your response if you are proposing a sample.",vscpp("br",null),"You should only list common files for the user's desired project type if you are proposing a sample.",vscpp("br",null),"You should always include a README.md file which describes the project if you are proposing a sample.",vscpp("br",null),"Do not include folders and files generated after compiling, building or running the project such as node_modules, dist, build, out.",vscpp("br",null),"Do not include image files such as png, jpg, ico, etc.",vscpp("br",null),"Do not include any descriptions or explanations in your response other than what is shown in the response templates.",vscpp("br",null),"If the user asks for a file content to be modified, respond with the same file tree structure and ask them to open the file to view the modifications.",vscpp("br",null),"Do not attempt to modify the file content your self and simply respond with the same file tree structure.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"## Response template ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),["","Examples for response templates above. Please follow these examples as closely as possible.","","## Valid setup question","","User: Create a TypeScript express app","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Invalid setup question","","User: Create a horse project","Assistant: Sorry, I don't know how to set up a horse project."].join(`
`),vscpp(kt,null)),vscpp(fl.UserMessage,{priority:750},vscpp(cr,{languageId:void 0})),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{priority:900,chatVariables:s,query:r.intent.question})),!r.intent&&this._metadata&&vscpp(vscppf,null,vscpp(fl.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. The user has identified a project URL for a new project they want to create. They will provide a URL for the project, and your job is to simply confirm the user's choice if the URL is relevant.",vscpp("br",null),"If the URL is not relevant, you should ignore the URL and simply suggest a file tree directory structure for a project that the user wants to create. Do not attempt to clarify the URL to the user.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"## Response template when the user has provided a project URL but it is irrelevant. Notice how the response ignores the provided URL entirely and does not attempt to clarify this to the user. ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),["","Examples for response templates above. Please follow these examples as closely as possible.","","## Valid setup question with an irrelevant URL ##","","User: Create a TypeScript express app","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Invalid setup question ##","","User: Create a horse project","Assistant: Sorry, I don't know how to set up a horse project."].join(`
`),"## Response template when the user has provided a project URL that is relevant ##",vscpp("br",null),"# USING_URL ",vscpp("br",null),"Sure, here's a GitHub sample project to help you get started on [project type]: [Project Type Sample](url)",vscpp("br",null),["","Examples for response template with a relevant URL described above. Please follow this example as closely as possible.","","## Valid setup question with a relevant project URL. Notice how you should not propose a file directory structure in this case. ##","","User: Create a VSCode extension sample for contributing getting started walkthrough.","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","# USING_URL","Sure, here's a GitHub sample project to help you get started on creating a VSCode extension with a walkthrough contribution: [Walkthrough Sample](https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample)",""].join(`
`),vscpp("br",null),"## Additional Rules for Project Tree generation ##",vscpp("br",null),"You should only generate a file tree structure if the URL procvided by the user is not relevant.",vscpp("br",null),"You should generate a markdown file tree structure for the sample project and include it in your response if you are proposing a sample.",vscpp("br",null),"You should only list common files for the user's desired project type if you are proposing a sample.",vscpp("br",null),"You should always include a README.md file which describes the project if you are proposing a sample.",vscpp("br",null),"Do not include folders and files generated after compiling, building, or running the project such as node_modules, dist, build, out.",vscpp("br",null),"Do not include image files such as png, jpg, ico, etc.",vscpp("br",null),"Do not include any descriptions or explanations in your response other than what is shown in the response templates.",vscpp("br",null),"If the user asks for a file content to be modified, respond with the same file tree structure and ask them to open the file to view the modifications.",vscpp("br",null),"Do not attempt to modify the file content yourself and simply respond with the same file tree structure.",vscpp("br",null),vscpp(kt,null)),vscpp(fl.UserMessage,{priority:750},vscpp(cr,{languageId:void 0})),vscpp(fl.UserMessage,{priority:900},r.url&&vscpp(vscppf,null,"Below is the URL you should consider for your response.",vscpp("br",null),"URL: ",r.url,vscpp("br",null))),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{priority:900,chatVariables:s,query:n}),this._metadata&&vscpp(vscppf,null,vscpp("meta",{value:this._metadata}))))}};uT=E([y(1,yt),y(2,j),y(3,oa),y(4,xe),y(5,a8),y(6,Vl)],uT);var ex=class extends ql{constructor(r,n,o,s){super();this.org=r;this.repo=n;this.path=o;this.githubRepoItems=s}};(e=>{function t(r){return r instanceof e}e.is=t})(ex||={});async function GKe(t,e,r){return Me.create(t,e,KQ,{promptContext:r,endpoint:e}).render()}var KQ=class extends fl.PromptElement{render(e,r){let{query:n,history:o,chatVariables:s}=this.props.promptContext;return vscpp(vscppf,null,o&&vscpp(It,{priority:500,history:o}),vscpp(fl.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant focused on aiding users in crafting clear and specific specifications about project or file creation within Visual Studio Code. Your role involves:",vscpp("br",null),"- Helping users articulate their intent about creating projects for various platforms and programming languages.",vscpp("br",null),"- Assessing the user's intent to determine whether it pertains to project or file creation.",vscpp("br",null),"- Identifying the programming language the user is inquiring about, or inferring it based on the platform or project type mentioned.",vscpp("br",null),"- Rewriting the user's query to eliminate ambiguity and ensure clarity.",vscpp("br",null),"- Resolving any pronouns and vague terms to their specific referents.",vscpp("br",null),"- Responding with a rephrased question that accurately reflects the user's intent.",vscpp("br",null),`- Using the additional context to resolve ambiguities in the user's query, such as "it" or "that".`,vscpp("br",null),"- If the user does not specify an application logic or feature, you should assume that the user is new to programming and provide a basic project structure to help with a simple Hello World project.",vscpp("br",null),'- If the user does not specify "app," "project," or "file" in their query, assume they are asking for a project. - If it is not clear what the user is asking for or if the question appears to be unrelated to Visual Studio Code, do not try to rephrase the question and simply return the original question.',vscpp("br",null),"- DO NOT ask the user for additional information or clarification.",vscpp("br",null),"- DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"Guidelines for rewriting questions:",vscpp("br",null),"- Understand the user's intent by carefully reading their question.",vscpp("br",null),"- Clarify pronouns ('it', 'that') by deducing their referents from the question or conversation context.",vscpp("br",null),"- Resolve ambiguous terms ('this') to their specific meanings based on the question or conversation context.",vscpp("br",null),"- Rephrase the question under a `# Question` header, ensuring all vague terms are clarified without altering the original intent.",vscpp("br",null),vscpp("br",null),"When responding:",vscpp("br",null),"- Use Markdown to format your response, starting with a `# Question` header followed by the rephrased question.",vscpp("br",null),"- If the user's intent is unclear or unrelated to Visual Studio Code, simply return the original question without modification.",vscpp("br",null),"- If the user has not explicitly mentioned that they are looking for a project or a file, assume that they are asking for a Visual Studio project.",vscpp("br",null),"- Avoid requesting additional information or directly answering the question.",vscpp("br",null),"- Use the template below to report the identified intent, rephrased question, and any application logic or feature that may be relevant.",vscpp("br",null),vscpp("br",null),"# Response Template",vscpp("br",null),"# Intent",vscpp("br",null),"Project|File",vscpp("br",null),"# Question",vscpp("br",null),"Rephrased question here.",vscpp("br",null),vscpp("br",null),"# Examples:",vscpp("br",null),"User: Python game.",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a new Python sample game project.",vscpp("br",null),vscpp("br",null),"User: Node.js server",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a new Node.js development environment.",vscpp("br",null),vscpp("br",null),"User: TS web app",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),'Create a new TypeScript project with a basic "Hello World" web application.',vscpp("br",null),vscpp("br",null),"User: VS Code extension custom sidebar",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a Visual Studio Code extension sample that adds a custom sidebar.",vscpp("br",null),vscpp("br",null),vscpp(kt,null)),vscpp(fl.UserMessage,{flexGrow:1,priority:750},vscpp(cr,{languageId:void 0})),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:s,query:n}))}};var xc=q(Ue());var l8=class extends xc.PromptElement{render(){return vscpp(vscppf,null,this.props.history&&vscpp(d8,{messages:this.props.history}),vscpp(xc.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the contents of a file in a project when given the user description, specification and tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and give me contents for just the file requested by the user. The code should not contain bugs.",vscpp("br",null),"If the user has asked for modifications to an existing file, please use the File path and File contents provided below if applicable.",vscpp("br",null),"If the file is supposed to be empty, please respond with a code comment saying that this file is intentionally left blank.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null)),this.props.relavantFiles&&this.props.relavantFiles.size>0&&vscpp(vscppf,null,vscpp(xc.UserMessage,{priority:500},"Below, you will find a list of file paths and their contents previously used",vscpp("br",null),Array.from(this.props.relavantFiles).map(([e,r])=>`File path: ${e}
File contents: ${r}
`).join(`
`))),vscpp(xc.UserMessage,{priority:900},"Generate the contents of the file: ",this.props.filePath," ",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`filetree' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"The project should adhere to the following specification:",vscpp("br",null),this.props.projectSpecification,vscpp("br",null)))}},u8=class extends xc.PromptElement{render(){return vscpp(vscppf,null,this.props.history&&vscpp(d8,{messages:this.props.history}),vscpp(xc.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and respond with a text description that lists and summarizes each file inside this project.",vscpp("br",null),"List the classes, types, interfaces, functions, and constants it exports and imports if it is a code file.",vscpp("br",null),"Consider filenames and file extensions when determining the programming languages used in the project. List any special configurations or settings required for configuration files such as package.json or tsconfig.json to help compile the project successfully",vscpp("br",null),"You should be as specific as possible when listing the public properties and methods for each exported class.",vscpp("br",null),"Do not use code blocks or backticks. Do not include any text before or after the file contents.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Valid question",vscpp("br",null),"User: I want to set up the following project: Create a TypeScript Express app",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown ",vscpp("br",null),"my-express-app",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 controllers",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 routes",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"## Valid response",vscpp("br",null),"Assistant: The project has the following files:",vscpp("br",null),"\\`src/app.ts\\`: This file is the entry point of the application. It creates an instance of the express app and sets up middleware and routes.",vscpp("br",null),"\\`src/controllers/index.ts\\`: This file exports a class \\`IndexController\\` which has a method \\`getIndex\\` that handles the root route of the application.",vscpp("br",null),"\\`src/routes/index.ts\\`: This file exports a function \\`setRoutes\\` which sets up the routes for the application. It uses the \\`IndexController\\` to handle the root route.",vscpp("br",null),"\\`src/types/index.ts\\`: This file exports interfaces \\`Request\\` and \\`Response\\` which extend the interfaces from the \\`express\\` library.",vscpp("br",null),"\\`tsconfig.json\\`: This file is the configuration file for TypeScript. It specifies the compiler options and the files to include in the compilation.",vscpp("br",null),"\\`package.json\\`: This file is the configuration file for npm. It lists the dependencies and scripts for the project.",vscpp("br",null),"\\`README.md\\`: This file contains the documentation for the project.",vscpp("br",null)),vscpp(xc.UserMessage,{priority:900},"I want to set up the following project: ",this.props.query,vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null)))}},d8=class extends xc.PromptElement{render(e,r){let n=[];for(let o of this.props.messages)switch(o.role){case"user":n.push(vscpp(xc.UserMessage,{priority:600},o.content));break;case"assistant":n.push(vscpp(xc.AssistantMessage,{priority:800},o.content));break;default:break}return vscpp(vscppf,null,n)}};var dT=class{constructor(e,r,n,o){this.promptType=e;this.endpointProvider=r;this.instantiationService=n;this.chatMLFetcher=o}async generate(e,r){let n=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),s=await Me.create(this.instantiationService,n,this.promptType,e).render(),a=await this.chatMLFetcher.fetchOne("newWorkspaceContentGenerator",s.messages,void 0,r,3,n,void 0,void 0);return a.type==="success"?e.filePath?this.parseContents(e.filePath,a.value):a.value:""}};dT=E([y(1,xe),y(2,j),y(3,yt)],dT);var pT=class extends dT{constructor(e,r,n){super(u8,e,r,n)}parseContents(e,r){throw new Error("Method not implemented.")}};pT=E([y(0,xe),y(1,j),y(2,yt)],pT);var fT=class extends dT{constructor(e,r,n){super(l8,e,r,n)}parseContents(e,r){function n(o,s){try{let a=s.exec(o.trim());if(a&&a.length>2)return a[2]}catch(a){console.error(a)}return o}if(e.endsWith(".md")){let o=n(r,/^```([a-zA-Z]+)?\s*([\s\S]+?)\s*```$/),[s,...a]=o.split("#");return s.length?["",...a].join("#"):o}else return n(r,/```([^\n]+)?\s*\n([\s\S]+?)\s*```/g)}};fT=E([y(0,xe),y(1,j),y(2,yt)],fT);var DD=ne("INewWorkspacePreviewContentManager"),eX="github.copilot.createProject",tX="github.copilot.createFile",p8="github.copilot.openFile",mT=class{constructor(e){this.responseScopedData=new Map;this.prevFileContents=new Map;this.copilotContentManager=e.createInstance(RD),this.githubContentManager=e.createInstance(PD),this.fileContentManager=new QQ}set(e,r,n,o){this.responseScopedData.set(e,n),JQ(n.baseUri)?this.githubContentManager.set(e,r,n,o):ZQ(n.baseUri)?this.fileContentManager.set(e,r,n,o):this.copilotContentManager.set(e,r,n,o)}get(e){this.prevResponseId!==e.authority&&(this.prevFileContents.clear(),this.prevResponseId=e.authority);let r;return JQ(e)?r=this.githubContentManager.get(e.authority,e.path):ZQ(e)?r=this.fileContentManager.get(e.authority,e.path):r=this.copilotContentManager.get(e.authority,e.path,this.prevFileContents),r?.content?.then(n=>{if(this.prevFileContents.has(e.path))return;let s=new TextDecoder().decode(n);this.prevFileContents.set(e.path,s)}),r}getFileTree(e){return this.responseScopedData.get(e)}};mT=E([y(0,j)],mT);var RD=class{constructor(e){this.instantiationService=e;this.promises=[];this.responseScopedData=new Map;this.generatePlanPrompt=this.instantiationService.createInstance(pT);this.generateFilePrompt=this.instantiationService.createInstance(fT)}set(e,r,n,o){let{userPrompt:s,projectStructure:a,chatMessages:c}=o,l={query:s,fileTreeStr:a,history:c},u=this.generatePlanPrompt.generate(l,Wt.None);this.promises.push(u);let d=this._getResponseScopedData(e),p={userPrompt:s,projectSpecification:u,projectStructure:a,fileTree:n,chatMessages:c};d.set(r,p)}get(e,r,n){let{projectName:o,path:s}=this._getProjectMetadata(r),c=this._getResponseScopedData(e).get(o);if(!c)return;let l=c.fileTree.value,u=rX(l,s);if(u&&!u?.content){let d=u;d.content=this._getFileContent(c.userPrompt,c.projectStructure,c.projectSpecification,r,c.chatMessages,n).catch(()=>d.content=void 0)}return u}_prefetch(e,r,n,o,s){let a=Date.now();return o.children?{...o,type:2,children:o.children.map(c=>this._prefetch(e,r,n,c,s)),ctime:a}:{...o,type:1,content:void 0,ctime:a}}async _getFileContent(e,r,n,o,s,a){let c={query:e,fileTreeStr:r,filePath:o,projectSpecification:await n,history:s,relavantFiles:a.has(o)?new Map([[o,a.get(o)]]):void 0};return this.generateFilePrompt.generate(c,Wt.None).then(l=>Buffer.from(l))}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}_getProjectMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}};RD=E([y(0,j)],RD);var PD=class{constructor(e){this.repositoryService=e;this.responseScopedData=new Map}set(e,r,n,o){let s=o,a=this._getResponseScopedData(e),c={...s,fileTree:n};a.set(r,c)}get(e,r){let{projectName:n,path:o}=this._getProjectMetadata(r),a=this._getResponseScopedData(e).get(n);if(!a)return;let c=a.fileTree.value,l=rX(c,o);if(l&&!l?.content&&!l?.children){let u=l,d=a.path==="."?nbe.relative(a.repo,r):r.slice(1);u.content=this.repositoryService.getRepositoryItemContent(a.org,a.repo,d).catch(()=>u.content=void 0)}return l}_getProjectMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}};PD=E([y(0,Vl)],PD);var QQ=class{constructor(){this.responseScopedData=new Map}set(e,r,n,o){let s=o,a=this._getResponseScopedData(e),c={content:s,fileTree:n};a.set(r,c)}get(e,r){let{projectName:n,path:o}=this._getFileMetadata(r),a=this._getResponseScopedData(e).get(n);if(!a)return;let c=a.fileTree.value,l=rX(c,o);return l&&!l?.content&&!l?.children&&(l.content=Promise.resolve(new Uint8Array(new TextEncoder().encode(a.content)))),l}_getFileMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}};function rX(t,e){let r;for(let n of e)r?r.children&&(r=r.children.find(o=>o.name===n)??r):r=t.find(o=>o.name===n);return r}var YQ="new",hT=class{constructor(e,r){this.endpointProvider=e;this.instantiationService=r;this.id="new";this.locations=[2];this.description=oh.t("Scaffold code for a new file or project in a workspace");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID="new"}get intentDetectionInput(){let e="create_new_workspace";return{functionName:e,sampleQuestion:"Create a RESTful API server using typescript",modelDescription:"Scaffolds a new file or project from scratch based on requirements from the user.",functionCallingBlurb:`If the user's message is related to generating files, folders, projects, workspaces, or VS Code extensions, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(AD,this,n,r)}};hT=E([y(0,xe),y(1,j)],hT);function tbe(t,e){return{command:eX,arguments:[t,e],title:oh.t("Create Workspace...")}}function zKe(t){return{command:tX,arguments:[t],title:oh.t("Create File...")}}var AD=class{constructor(e,r,n,o,s,a,c){this.intent=e;this.endpoint=r;this.location=n;this.instantiationService=o;this.configurationService=s;this.newWorkspacePreviewContentManager=a;this.workspaceService=c;this.linkification={disable:!0}}async getShouldUseProjectTemplate(){let e=this.configurationService.getConfig(le.UseProjectTemplates);return e!==void 0?e:!1}async buildPrompt(e,r,n){let{query:o,history:s,chatVariables:a}=e,c=!a.hasVariables()&&s[s.length-1]?.request?.message!==o&&await this.getShouldUseProjectTemplate(),l=Me.create(this.instantiationService,this.endpoint,uT,{promptContext:e,useTemplates:c,endpoint:this.endpoint}),u=await l.render(r,n),d=l.getMeta(ex);return d&&(this.githubContentMetadata=d),u}processResponse(e,r,n,o){return new XQ(this.newWorkspacePreviewContentManager,this.workspaceService,this.githubContentMetadata).processResponse(e,r,n,o)}};AD=E([y(3,j),y(4,he),y(5,DD),y(6,qe)],AD);function $Ke(t,e,r){let n;r?n=t.map(u=>[e.path,u.path].join("/")):n=t.map(u=>u.path);let o=n[0].split("/")[0],s={name:o,children:[]},a={rootName:s};for(let u of n){let d=u.split("/"),p=o,f=s;for(let m=1;m<d.length;m++){let h=d[m];if(p+=`/${h}`,!a[p]){let g={name:h};f.children===void 0&&(f.children=[]),f.children.push(g),a[p]=g}f=a[p]}}let c;r?c=s.children?.[0].children??[]:c=s.children??[];let l=c?.sort((u,d)=>u.children&&!d.children?-1:1)??[];return new ud(l,e)}var f8="vscode-copilot-workspace",m8="vscode-copilot-github-workspace",tx="vscode-copilot-file";function rbe(t,e,r=!1){return nr.from({scheme:r?m8:f8,authority:t??"",path:e?`/${e}`:void 0})}var XQ=class{constructor(e,r,n){this.newWorkspacePreviewContentManager=e;this.workspaceService=r;this.githubContentMetadata=n;this._appliedText="";this._p=Promise.resolve("")}async processResponse(e,r,n,o){let{turn:s,messages:a}=e,c=!1,l="",u=/```filetree\n/,d=a.filter(f=>f.role!=="system"),p=!1;for await(let{delta:f}of r){if(o.isCancellationRequested)break;let m=f.text;this._p=this._p.then(async()=>{let h=s.requestId??"";if(s.response||(s.response={message:this._appliedText,type:"model"}),!m)return this._appliedText;if(s.response.message+=m,this._appliedText+=m,this._appliedText.startsWith("#"))/(?:.*\n){1,}/.test(this._appliedText)&&n.markdown(m);else{let g=s.request.message,v=this._appliedText.match(/```filetree\n([\s\S]+?)\n```/);if(v&&(c||!p)){c=!1;let[b,_]=this._appliedText.split(v[0]);p||n.markdown(b),l=v[1];let{chatResponseTree:x,projectName:S}=s8(l,I=>rbe(h,I));n.progress(oh.t("Generating workspace preview...")),n.push(x),n.markdown(_),this.newWorkspacePreviewContentManager.set(h,S,x,{userPrompt:g,projectStructure:l,chatMessages:d})}else if(this._appliedText.match(u)&&!c&&!v){c=!0;let[b,_]=this._appliedText.split(u);l+=_,n.progress(oh.t("Generating workspace preview..."))}else c?l+=m:!c&&!this._appliedText.match(/```/)&&(p=!0,n.markdown(m))}return this._appliedText})}if(await this._p,s.requestId&&this.githubContentMetadata&&this.githubContentMetadata.org&&this.githubContentMetadata.repo&&this.githubContentMetadata.path&&this.githubContentMetadata.githubRepoItems&&!this.newWorkspacePreviewContentManager.getFileTree(s.requestId)){n.reference(nr.parse(this.githubContentMetadata.githubRepoItems[0].html_url)),n.progress(oh.t("Generating workspace preview..."));let f=this.githubContentMetadata.path===".",m=f?this.githubContentMetadata.repo:this.githubContentMetadata.path.split("/")[0],h=$Ke(this.githubContentMetadata.githubRepoItems,rbe(s.requestId,m,!0),f);n.push(h);let g=this.workspaceService.getWorkspaceFolders();n.button(tbe(h,g.length>0?g[0]:void 0)),this.newWorkspacePreviewContentManager.set(s.requestId,m,h,this.githubContentMetadata);let v=encodeURIComponent(`["@workspace /${YQ} ${s.request.message}"]`),b=new vo(oh.t("Hint: You can [regenerate this project without using this sample](command:workbench.action.chat.open?{0}) or use this [setting](command:workbench.action.openSettings?%5B%22github.copilot.chat.useProjectTemplates%22%5D) to configure the behavior.",v));b.isTrusted={enabledCommands:["workbench.action.openSettings","workbench.action.chat.open"]},n.markdown(b)}else{if(!s.requestId)throw new Error("Request ID is undefined");let f=Ls(this._appliedText);if(f.length===2){let m;try{m=Jp(f[1].code)}catch(_){throw _}let h=nr.from({scheme:tx,authority:s.requestId,path:`/${m.fileName}`}),g=new ud([{name:`${m.fileName}`}],h),v=Yp(p8,[g]),b=new vo(`[${m.fileName}](${v})`);b.isTrusted={enabledCommands:[p8]},n.markdown(oh.t("Sure, here is the file you requested:")),n.markdown(b),this.newWorkspacePreviewContentManager.set(s.requestId,m.fileName,g,f[0].code)}}this.pushCommands(s.requestId,n)}pushCommands(e,r){let n=this.newWorkspacePreviewContentManager.getFileTree(e);if(!n||JQ(n.baseUri))return;if(ZQ(n.baseUri)){r.button(zKe(n));return}let o=this.workspaceService.getWorkspaceFolders();r.button(tbe(n,o.length>0?o[0]:void 0))}};function JQ(t){return t.scheme===m8}function ZQ(t){return t.scheme===tx}var nX=q(Ct());var ui=ne("ITerminalService");var y0=q(Ue());var h8=q(Ue());var sh=class extends h8.PromptElement{constructor(r,n){super(r);this._terminalService=n}static{this.variableInfo={name:"terminalLastCommand",description:"The active terminal's last run command",defaultEnablement:!0}}async prepare(){return this._terminalService.terminalLastCommand}render(r,n){if(!r)return;let o=[];r.commandLine&&(o.push("The following is the last command run in the terminal:"),o.push(r.commandLine)),r.cwd&&(o.push("It was run in the directory:"),o.push(typeof r.cwd=="object"?r.cwd.toString():r.cwd)),r.output&&(o.push("It has the following output:"),o.push(r.output));let s=o.join(`
`);return vscpp(vscppf,null,vscpp(h8.UserMessage,{priority:this.props.priority},"The active terminal's last run command:",vscpp("br",null),s))}};sh=E([y(1,ui)],sh);var ND=q(Ue());var gT=class extends ND.PromptElement{constructor(r,n){super(r);this._terminalService=n}static{this.variableInfo={name:"terminalSelection",description:"The active terminal's selection",defaultEnablement:!0}}async prepare(){return this._terminalService.terminalSelection}render(r,n){return r.trim().length===0?vscpp(vscppf,null,vscpp(ND.UserMessage,{priority:this.props.priority},"The active terminal has no selection.")):vscpp(vscppf,null,vscpp(ND.UserMessage,{priority:this.props.priority},"The active terminal's selection:",vscpp("br",null),r))}};gT=E([y(1,ui)],gT);var g8=class extends y0.PromptElement{render(e){let{history:r,chatVariables:n}=this.props.promptContext,o=this.props.promptContext.query||"What did the last command do?";return vscpp(vscppf,null,vscpp(y0.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer by giving a detailed answer to their query.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),`Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
- Provide any command suggestions using the active shell and operating system.
- Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,vscpp("br",null)),vscpp(It,{flexGrow:1,priority:600,history:r}),vscpp(y0.UserMessage,{flexGrow:1,priority:750},vscpp(cr,{languageId:void 0})),vscpp(y0.UserMessage,{flexGrow:1,priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(y0.UserMessage,{flexGrow:1,priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(gT,{flexGrow:1,priority:800}),vscpp(sh,{flexGrow:1,priority:800}),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:n,query:o}))}};var Ed=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=Ed.ID;this.locations=[2];this.description=nX.t("Explain what just happened in the terminal");this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:!0,sampleRequest:nX.t("What did the last command do?")}}static{this.ID="terminalExplain"}static{this.intentName="explain"}get intentDetectionInput(){let e="explain_terminal_state";return{functionName:e,sampleQuestion:"What did the last command do?",functionCallingBlurb:`If the user's message is about explaining what happened in the terminal, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(LD,this,n,r)}};Ed=E([y(0,j),y(1,xe)],Ed);var LD=class{constructor(e,r,n,o,s,a){this.intent=e;this.endpoint=r;this.location=n;this.instantiationService=o;this.envService=s;this.terminalService=a}async buildPrompt(e,r,n){let o=this.envService.OS,s=this.terminalService.terminalShellType;return await Me.create(this.instantiationService,this.endpoint,g8,{promptContext:e,osName:o,shellType:s,endpoint:this.endpoint}).render(r,n)}};LD=E([y(3,j),y(4,gt),y(5,ui)],LD);var rx=q(Ct()),hn=q(require("vscode"));function ibe(t){let e=new ht,r=t.get(_c);return KKe(e,t.get(ge)),YKe(r,t.get(he),e),WKe(e),e}function WKe(t){async function e(r){let n=_i.first(r.entries());if(!n)return;await hn.workspace.applyEdit(r,{isRefactoring:!0});let o=await hn.workspace.openTextDocument(n[0]);await hn.window.showTextDocument(o,{preview:!0,selection:n[1][0].range})}t.add(hn.commands.registerCommand("github.copilot.tests.fixTestFailure.applyAndRerun",async(r,n,o)=>{await e(n),await Fl(1e3),hn.commands.executeCommand("testing.reRunFailTests");let s=await new Promise(d=>{let p=hn.tests.onDidChangeTestResults(()=>{hn.tests.testResults.length&&(d(hn.tests.testResults[0]),p.dispose())})}),a=QKe(r,s.results);if(a===void 0||!a.taskStates.some(d=>d.state===hn.TestResultState.Failed||d.state===hn.TestResultState.Errored))return;let c=rx.t("Undo"),l=rx.t("Try Fixing Again"),u=await hn.window.showInformationMessage(rx.t("Looks like the test still failed. What would you like to do?"),rx.t("Keep Changes"),c,l);if(u===l){let d=Pm(a.taskStates,p=>p.messages.find(f=>!!f.location));d?hn.commands.executeCommand("github.copilot.tests.fixTestFailure",{message:d,test:a,source:"retry"}):hn.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}else u===c&&await e(o)}))}function KKe(t,e){t.add(hn.commands.registerCommand("github.copilot.tests.fixTestFailure",async r=>{if(!r.test.uri)return;e.sendMSFTTelemetryEvent("intent.fixTestFailure.actioned",{source:r.source??"testResultsPanel"});let n=await hn.workspace.openTextDocument(r.test.uri);await hn.window.showTextDocument(n,{preserveFocus:!1,preview:!0,selection:r.test.range?new hn.Range(r.test.range.start,r.test.range.start):void 0}),await hn.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}))}function YKe(t,e,r){r.add(hn.languages.registerCodeActionsProvider("*",{provideCodeActions(n,o,s,a){if(!e.getConfig(le.EnableCodeActions)||!t.isEnabled.get())return;let l=t.getFailureAtPosition(n.uri,o.start);if(!l)return;let u=new hn.CodeAction(rx.t("Fix test failure"),hn.CodeActionKind.QuickFix);return u.isAI=!0,u.command={title:rx.t("Fix test failure"),command:"github.copilot.tests.fixTestFailure",arguments:[{message:l.task.messages[0],test:l.snapshot,source:"sparkles"}]},[u]}}))}function QKe(t,e){let r=[];for(let n=t;n;n=n.parent)r.push(n.id);for(let n=r.length-1;n>=0;n--){let o=r[n],s=e.find(a=>a.id===o);if(!s)return;if(n===0)return s;e=s.children}}var sbe=q(Ct()),tn=q(require("vscode"));function v8(t,e){if(!e.length)return;let r;for(let n of t)if(n.children){let o=n.name===e[0]?{symbol:n,matchCount:1}:void 0;if(o){let c=v8(n.children,e.slice(1));c&&(o={symbol:c.symbol,matchCount:o.matchCount+c.matchCount})}let s=v8(n.children,e),a;o&&s?a=o.matchCount>=s.matchCount?o:s:a=o??s,a&&(!r||a.matchCount>r?.matchCount)&&(r=a)}else n.name===e[0]&&(r??={symbol:n,matchCount:1});return r}function obe(t,e){return(v8(t,[e])??v8(t,XKe(e)))?.symbol}function XKe(t){return Array.from(t.matchAll(/[#\w$][\w\d$]*/g),e=>e[0])}var y8="_github.copilot.openSymbolFromReferences";function abe(t){return z1(tn.commands.registerCommand(J_,async(...[e,r])=>{t.sendMSFTTelemetryEvent("panel.action.filelink",{requestId:r});let n=tn.workspace.workspaceFolders?.[0].uri;if(!n)return;let o=typeof e=="string"?tn.Uri.joinPath(n,e):tn.Uri.from(e);if(await s(o))await tn.commands.executeCommand("revealInExplorer",o);else return tn.commands.executeCommand("vscode.open",o);async function s(a){if(a.path.endsWith("/"))return!0;try{return(await tn.workspace.fs.stat(a)).type===tn.FileType.Directory}catch{return!1}}}),tn.commands.registerCommand(JC,async(...[e,r,n])=>{let o=tn.Uri.from(e),s;try{s=await tn.commands.executeCommand("vscode.executeDocumentSymbolProvider",o)}catch(a){console.error(a)}if(s?.length){let a=obe(s,r);if(t.sendMSFTTelemetryEvent("panel.action.symbollink",{requestId:n},{hadMatch:a?1:0}),a){let c=a instanceof tn.SymbolInformation?a.location.range:a.selectionRange;return tn.commands.executeCommand("vscode.open",o,{selection:new tn.Range(c.start,c.start)})}}return tn.commands.executeCommand("vscode.open",o)}),tn.commands.registerCommand(y8,async(...[e,r,n])=>{let o;for(let s of r)try{let a=(await tn.commands.executeCommand("vscode.executeDefinitionProvider",tn.Uri.from(s.uri),s.pos)).at(0);if(a){o={type:"definition",loc:JKe(a)};break}}catch(a){console.error(a)}if(!o){let s=r.at(0);s&&(o={type:"firstOccurrence",loc:new tn.Location(tn.Uri.from(s.uri),s.pos)})}return t.sendMSFTTelemetryEvent("panel.action.openSymbolFromReferencesLink",{requestId:n,resolvedDestinationType:o?.type??"unresolved"}),o?tn.commands.executeCommand("vscode.open",o.loc.uri,{selection:new tn.Range(o.loc.range.start,o.loc.range.start)}):tn.window.showWarningMessage((0,sbe.t)("Could not resolve this symbol in the current workspace."))}))}function JKe(t){return"uri"in t?t:new tn.Location(t.targetUri,t.targetRange)}var cbe=q(Ct());var ml=q(require("vscode"));async function b8(t,e,r,n,o){let s=t.get(dt),a=n.symbolMatchesOnly??!1,c=[],l=n.maxResultCount??1/0,u=new fp(10);try{await Promise.all(e.map(d=>u.queue(async()=>{if(c.length>=l||o.isCancellationRequested)return;let p;jA(d.anchor)?p=await iX(s,r,d.anchor,new ml.Range(0,0,Number.MAX_SAFE_INTEGER,0),a,o):"range"in d.anchor?p=await iX(s,r,d.anchor.uri,d.anchor.range,a,o):"value"in d.anchor&&He.isUri(d.anchor.value)&&(p=await iX(s,r,d.anchor.value,new ml.Range(0,0,Number.MAX_SAFE_INTEGER,0),a,o)),p&&c.push(p)})))}finally{u.dispose()}return c.sort((d,p)=>p.type-d.type).map(d=>d.location).slice(0,n.maxResultCount)}async function iX(t,e,r,n,o,s){let a=await ZKe(r);if(!a||s.isCancellationRequested)return;let c=await eYe(t,a,n,s);if(s.isCancellationRequested)return;for(let d of c)if(d.identifier===e){let p=a.positionAt(d.startIndex);return{type:2,location:new ml.Location(r,p)}}if(o)return;let l=a.getText(n),u=a.offsetAt(n.start);for(let d of l.matchAll(new RegExp(g_(e),"g")))if(d.index){let p=a.positionAt(u+d.index);if("getWordRangeAtPosition"in a){let f=a.getText(a.getWordRangeAtPosition(p));if(e===f)return{type:1,location:new ml.Location(r,p)}}else{let f=a.getText(new ml.Range(p,a.positionAt(a.offsetAt(p)+e.length)));if(e===f)return{type:1,location:new ml.Location(r,p)}}}}async function ZKe(t){let e=ml.workspace.textDocuments.find(r=>r.uri.toString()===t.toString());if(e)return e;try{let r=await ml.workspace.fs.readFile(t),n=Ns(t).languageId,o=hC.create(t.toString(),n,0,new TextDecoder().decode(r));return new class{constructor(){this.languageId=n}getText(s){return o.getText(s)}offsetAt(s){return o.offsetAt(s)}positionAt(s){let a=o.positionAt(s);return new ml.Position(a.line,a.character)}}}catch{return}}async function eYe(t,e,r,n){let o=cl(e.languageId);if(!o)return[];let s=t.getTreeSitterASTForWASMLanguage(o,e.getText());return s?s.getSymbols({startIndex:e.offsetAt(r.start),endIndex:e.offsetAt(r.end)}):[]}var vT=class{constructor(e,r){this.maxPotentialWordMatches=e;this.instantiationService=r;this.cache=new Map}async resolve(e,r,n){if(!r.length)return;let o=this.cache.get(e);if(o)return o;{let s=this.doResolve(e,r,n);return this.cache.set(e,s),s}}async doResolve(e,r,n){let o=await this.instantiationService.invokeFunction(s=>b8(s,r,e,{maxResultCount:this.maxPotentialWordMatches},n));if(!n.isCancellationRequested){if(!o.length){let s=e.split(/([#\w$][\w\d$]*)/g).map(c=>c.trim()).filter(c=>c.length),a;for(let c of s){if(!/[#\w$][\w\d$]*/.test(c))break;a=c}if(a&&a!==e&&(o=await this.instantiationService.invokeFunction(c=>b8(c,r,a,{symbolMatchesOnly:!0,maxResultCount:this.maxPotentialWordMatches},n)),n.isCancellationRequested))return}return o.slice(0,this.maxPotentialWordMatches)}}};vT=E([y(1,j)],vT);var tYe=/(?<!\[)`([^`\n]+)`(?!\])/g,rYe=8,yT=class{constructor(e){this.resolver=e.createInstance(vT,rYe)}async linkify(e,r,n){if(!r.references.length)return;let o=0,s=await DM(e,tYe,async(a,c)=>{let l=await this.resolver.resolve(c,r.references,n);return l?.length?(o++,this.createOpenSymbolCommand(l,a,r.requestId)):a});if(o)return{parts:[s],trustedCommands:[y8],addedLinkCount:o}}createOpenSymbolCommand(e,r,n){let o=Yp(y8,["",e.map(s=>({uri:bD(s.uri),pos:s.range.start})),n]);return`[${r}](${o} "${(0,cbe.t)("Go to definition")}")`}};yT=E([y(0,j)],yT);var ix=q(require("vscode"));var Zp=q(Ct());var nx=q(Ue());var _8=q(Ct()),ca=q(Ue());var bT=class extends ca.PromptElement{constructor(r,n,o,s,a,c,l,u,d){super(r);this.chatMLFetcher=n;this.logService=o;this.embeddingsComputer=s;this.endPointProvider=a;this.combinedEmbeddingIndex=c;this.docSearchClient=l;this.envService=u;this.instantiationService=d}async prepare(r,n,o){n?.report(new xi(_8.t("Refining question to improve search accuracy.")));let s=this.props.promptContext.query,a=await this.endPointProvider.getChatEndpoint("gpt-3.5-turbo"),c=Me.create(this.instantiationService,a,oX,this.props.promptContext),{messages:l}=await c.render();if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};this.logService.internal.debug("[VSCode Prompt] Asking the model to update the user question.");let u=await this.chatMLFetcher.fetchOne("vscodePrompt",l,async b=>{},o,2,a,void 0,{temperature:0});if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};u.type==="success"?s=nYe(this.props.promptContext.query,u.value):this.logService.public.error(`[VSCode Prompt] Failed to refine the question: ${u.requestId}`);let d=n?Z_(n,new xi(_8.t("Searching doc index...")),this.searchDocsSearchForContext(s,10,o,this.logService),1e3):this.searchDocsSearchForContext(s,10,o,this.logService);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};let p=await this.endPointProvider.getEmbeddingsEndpoint("text3small"),f=await this.embeddingsComputer.computeEmbeddings(p,[s],{dimensions:512},void 0);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};if(!f)return{docSearchResults:await d,settings:[],commands:[],query:s};let m=n?Z_(n,new xi(_8.t("Searching command and setting index....")),this.combinedEmbeddingIndex.nClosestValues(f.embeddings[0],5),500):this.combinedEmbeddingIndex.nClosestValues(f.embeddings[0],5),h=await Promise.allSettled([m,d]),g=h[0].status==="fulfilled"?h[0].value:{commands:[],settings:[]};return{docSearchResults:(h[1].status==="fulfilled"?h[1].value:[])||[],settings:g.settings,commands:g.commands,query:s}}async searchDocsSearchForContext(r,n,o,s){try{return await this.docSearchClient.search(r,{repo:"microsoft/vscode-docs"},{limit:n,similarity:.75},o)}catch(a){return this.logService.public.error(a,"Failed to search docs search for query"),[]}}render(r){let n=this.envService.OS;return vscpp(vscppf,null,vscpp(ca.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on settings and commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",n," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),"If you are referencing multiple commands and settings, please respond step by step in a numbered list format.",vscpp("br",null),vscpp("br",null),vscpp(Zt,{name:"instructions"},"Additional Rules",vscpp("br",null),"You must respond with either a setting to set or a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted code block at the end of the sentence that references that command.",vscpp("br",null),"Similarly, all referenced settings must be properly formatted in a code block.",vscpp("br",null),"All responses for settings and commands code blocks must strictly adhere to the template shown below:",vscpp("br",null),"The response template for a command is as follows:",vscpp("br",null),vscpp(wn,{code:`{
					  "type": "command",
					  "commands": {
						"command": "commandName",
						"args": "commandArgs"
					  }
					}`,languageId:"json"}),"The response template for a setting is as follows:",vscpp("br",null),vscpp(wn,{code:`{
					  "type": "setting",
					  "settings": {
						"setting": "settingValue"
					  }
					}`,languageId:"json"}),vscpp("br",null),"If you are referencing multiple settings, combine all settings into the same code block at the beginning of your response, and then describe each setting in a numbered list after the code block, as shown in the template below:",vscpp("br",null),"## Multiple settings response template",vscpp("br",null),vscpp(wn,{code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
	...
	}
}`,languageId:"json"}),vscpp("br",null),"If you are referencing multiple commands, do not combine all the commands into the same JSON markdown code block. Instead, describe each command and include the JSON markdown code block in a numbered list, as shown in the template below:",vscpp("br",null),"## Multiple commands response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. ...",vscpp("br",null),'If you are referencing multiple commands and setting, respond with numbered steps for the user to follow. First mention all the commands as per the "Multiple commands response template" and then all the settings as per the "Multiple settings response template" shown above.',vscpp("br",null),"## Multiple command and settings response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. A short summary of the combined settings.",vscpp(wn,{code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
  }
}`,languageId:"json"}),vscpp("br",null),vscpp("br",null),"If a command or setting references another command or setting, you must respond with both the original and the referenced commands or settings.",vscpp("br",null),"The code block containing the command or setting should be included immediately after the sentence referencing it.",vscpp("br",null),vscpp("br",null),"Do not suggest opening the settings editor.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest commands or settings identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),'If an extension might help the user, you may suggest a search query for the extension marketplace. You must also include the command **Search marketplace** (`workbench.extensions.search`) with args set to the suggested query in the commands section at the end of your response. The query can also contain the tags "@popular", "@recommended", or "@featured" to filter the results.',vscpp("br",null),vscpp("br",null),vscpp(Zt,{name:"examples"},"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp(Zt,{name:"example"},"## Single setting response",vscpp("br",null),"Question: How do I disable telemetry?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(wn,{code:`{
  "type": "setting",
  "settings": {
    "telemetry.telemetryLevel": "off",
  }
}`,languageId:"json"}),"is a setting which can be used to disable telemetry.",vscpp("br",null),vscpp("br",null)),vscpp(Zt,{name:"example"},"## Multiple settings response",vscpp("br",null),"Question: How can I change the font size in all areas of Visual Studio Code, including the editor, terminal?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(wn,{code:`{
  "type": "setting",
  "settings": {
	"editor.fontSize": 18,
	"terminal.integrated.fontSize": 14,
	"window.zoomLevel": 1
  }
}`,languageId:"json"}),'1. `"editor.fontSize": 18` - This setting adjusts the font size within the editor. The default size is overridden by the value `18`, making the text larger and more readable according to user preference.',vscpp("br",null),'2. `"terminal.integrated.fontSize": 14` - Similarly, this setting changes the font size in the integrated terminal. By setting it to `14`, it increases the font size in the terminal independently from the editor.',vscpp("br",null),'3. `"window.zoomLevel": 1` - This setting controls the zoom level of the entire Visual Studio Code interface. A value of `1` means that the interface will be zoomed in to 120% of the original size, making everything appear bigger. A value of `0` would indicate no zoom (100% - default size), positive values zoom in, and negative values zoom out.',vscpp("br",null)),vscpp(Zt,{name:"example"},"## Multiple commands response",vscpp("br",null),"Question: What is the command to report an issue for other extensions in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Here are some possible commands:",vscpp("br",null),"1. **Report Issue** - This command can be used to report an issue for other extensions.",vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.reportExtensionIssue"
  }
}`,languageId:"json"}),"2. **Docker: Report Issue** - This command can be used to report an issue for the Docker extension.",vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
	"command": "vscode-docker.help.reportIssue"
  }
}`,languageId:"json"}),"3. **Codespaces: Report Issue** - This command can be used to report an issue for the Codespaces extension.",vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
	"command": "github.codespaces.reportIssue"
  }
}`,languageId:"json"})),vscpp(Zt,{name:"example"},"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
	"command": "workbench.action.closeAllEditors"
  }
}`,languageId:"json"})),vscpp(Zt,{name:"example"},"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null)),vscpp(Zt,{name:"example"},"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null)),vscpp(Zt,{name:"example"},"## Marketplace search",vscpp("br",null),"Question: How do I add PHP support?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Search marketplace** command to search for extensions that add PHP support.",vscpp("br",null),vscpp("br",null),vscpp(wn,{code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.search",
	"args": "php"
	}
}`,languageId:"json"})))),vscpp(kt,null)),vscpp(It,{flexGrow:1,priority:700,history:this.props.promptContext.history}),vscpp(ca.UserMessage,{flexGrow:1,priority:800},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command or setting is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands and settings we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. A setting may reference another setting, that will appear as \\`#setting.id#\\`, you must return the referenced setting as well. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null),r.commands.length>0&&vscpp(vscppf,null,"Here are some possible commands:",vscpp("br",null)),r.commands.length>0&&r.commands.map(o=>vscpp(ca.TextChunk,null,"- ",o.label,' ("',o.key,'") (Keybinding: "',o.keybinding,'")')),r.settings.length>0&&vscpp(vscppf,null,"Here are some possible settings:",vscpp("br",null)),r.settings.length>0&&r.settings.map(o=>vscpp(ca.TextChunk,null,sK(o))),r.docSearchResults.length>0&&vscpp(vscppf,null,"Below is a list of information from the Visual Studio Code documentation which might be relevant to the question. ",vscpp("br",null)),r.docSearchResults.map(o=>vscpp(ca.TextChunk,null,"##",o?.title?.trim()," - ",o.path,vscpp("br",null),o.contents))),vscpp(Kt,{priority:899,...this.props,promptContext:{...this.props.promptContext,query:r.query},flexGrow:2}),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:this.props.promptContext.chatVariables,query:this.props.promptContext.query}))}};bT=E([y(1,yt),y(2,ie),y(3,oa),y(4,xe),y(5,md),y(6,dC),y(7,gt),y(8,j)],bT);var oX=class extends ca.PromptElement{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(It,{priority:500,history:this.props.history}),vscpp(ca.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant who helps the user create well-formed and unambiguous questions about their Visual Studio Code development environment.",vscpp("br",null),"Specifically, you help users rewrite questions about how to use Visual Studio Code's Commands and Settings.",vscpp("br",null),"Evaluate the question to determine the user's intent. ",vscpp("br",null),"Determine if the user's question is about the editor, terminal, activity bar, side bar, status bar or other parts of Visual Studio Code's workbench and include those keyword in the rewrite.",vscpp("br",null),"Determine if the user is asking about Visual Studio Code's Commands and/or Settings and explicitly include those keywords during the rewrite. ",vscpp("br",null),"Respond in Markdown. Under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"If it is not clear what the user is asking for or if the question appears to be unrelated to Visual Studio Code, do not try to rephrase the question and simply return the original question. ",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are trying to do in the Visual Studio Code environment.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what 'this' refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of the question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: opne cmmand palete",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I open the command palette in Visual Studio Code?",vscpp("br",null),vscpp("br",null),vscpp("br",null),"User: change font size",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I change the font size in the editor in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"User: Move editor and pin",vscpp("br",null),"Assistant: ",vscpp("br",null),"# Question",vscpp("br",null),"How do I move the editor to another group and then pin the editor in Visual Studio Code",vscpp("br",null),vscpp(kt,null)),vscpp(ca.UserMessage,{priority:700},this.props.query))}};function nYe(t,e){let r=e.match(/#+\s*Question\n(?<question>.+)/si);return r?.groups?r.groups.question.trim():t.trim()}var _T=class extends ca.PromptElement{constructor(r,n,o,s,a){super(r);this.embeddingComputer=o;this.endPointProvider=s;this.combinedIndex=a}async prepare(r,n,o){if(o.isCancellationRequested)return;let s=await this.endPointProvider.getEmbeddingsEndpoint("text3small"),a=await this.embeddingComputer.computeEmbeddings(s,[this.props.query],{dimensions:512},o);if(!o.isCancellationRequested&&a&&a.embeddings.length>0){this.combinedIndex.commandIdIndex.isIndexLoaded||await this.combinedIndex.commandIdIndex.calculateEmbeddings();let c=this.combinedIndex.commandIdIndex.nClosestValues(a.embeddings[0],5);if(c.length)return{snippets:c}}}render(r,n){let o=this.priority;return vscpp(vscppf,null,r&&r.snippets.length>0&&vscpp(ca.UserMessage,null,"Here are some possible commands:",vscpp("br",null),r.snippets.reverse().map(s=>vscpp(ca.TextChunk,{priority:o++},"- ",s.label,' ("',s.key,'") (Keybinding: "',s.keybinding,'")',vscpp("br",null)))))}};_T=E([y(1,Rt),y(2,oa),y(3,xe),y(4,md)],_T);var xT=class extends nx.PromptElement{constructor(r,n){super(r);this.envService=n}render(r,n){let o=this.envService.OS;return vscpp(vscppf,null,vscpp(nx.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",o," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),"If you are referencing multiple commands, please respond step by step in a numbered list format.",vscpp("br",null),vscpp("br",null),vscpp(Zt,{name:"instructions"},"Additional Rules",vscpp("br",null),"You must respond with a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted JSON markdown code block at the end of the sentence that references that command.",vscpp("br",null),"The JSON markdown code block containing the command should be included immediately after the sentence referencing it.",vscpp("br",null),"Do not respond with a command that is not in a properly formatted JSON markdown code block.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest command identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),vscpp("br",null),vscpp(Zt,{name:"examples"},"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),vscpp(Zt,{name:"example"},"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(wn,{code:`{
	"command": "workbench.action.closeAllEditors"
}`,languageId:"json"})),vscpp(Zt,{name:"example"},"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null)),vscpp(Zt,{name:"example"},"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null))))),vscpp(It,{priority:600,history:this.props.history}),vscpp(nx.UserMessage,{priority:700},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null)),vscpp(_T,{priority:800,query:this.props.query}),vscpp(nx.UserMessage,{priority:900},this.props.query))}};xT=E([y(1,gt)],xT);var iYe="Run create a new terminal command",OD="runCommanndConfirmationInteractedWith",x8=new vo(Zp.t("[Configure automatic command execution]({0})",Yp("workbench.action.openSettings",["github.copilot.chat.runCommand.enabled"])));x8.isTrusted={enabledCommands:["workbench.action.openSettings"]};var b0=class{constructor(e,r,n,o,s,a){this.configurationService=e;this.endpointProvider=r;this.runCommandExecutionService=n;this.combinedEmbeddingIndex=o;this.vscodeExtensionContext=s;this.instantiationService=a;this.id=b0.ID;this.locations=[2];this.description=Zp.t("Run a command");this.intentDetectionInput={sampleQuestion:iYe,disabled:!0};this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:Ra}}static{this.ID="runCommand"}async invoke(e){let r=this.configurationService,n=e.location,s=await this.endpointProvider.getChatEndpoint(e.request);return{intent:this,location:n,endpoint:s,processResponse:async(a,c,l,u)=>{let d=this.runCommandExecutionService,p=this.configurationService,f="";l.progress(Zp.t("Searching command index..."));for await(let{delta:g}of c){if(u.isCancellationRequested)return;f+=g.text}let m=sYe(this.combinedEmbeddingIndex,f)[0];if(!m){l.markdown(f),l.warning(Zp.t("Could not find a command for your request."));return}if(p.getConfig(le.RunCommandEnabled)===!1){l.markdown(`Automatic command execution is currently disabled.
`),l.markdown(x8),l.button(m);return}if(!oYe.has(m.command)){l.warning(Zp.t("Automatically executing the command: {0} is prohibited due to security risks or potential destructive action.",m.title)),l.button(m);return}this.vscodeExtensionContext.globalState.get(OD,!1)?(await d.executeCommand(m.command,m.arguments),l.markdown(Zp.t("Ran: {0}",`\`${m.title}\``))):l.confirmation(Zp.t("Enable automatic command execution and run [{0}](command:{1})",m.title,m.command),"",{command:m})},confirmationHandler:async(a,c,l)=>{if(a){let[u]=a;u&&(this.vscodeExtensionContext.globalState.update(OD,!0),l.markdown(x8),l.progress(Zp.t("Enabled automatic command execution")),this.runCommandExecutionService.executeCommand(u.command.command,u.command.arguments),l.markdown(Zp.t("Ran: `{ 0}`",`\`${u.command.title}\``)))}if(c){let[u]=c;this.vscodeExtensionContext.globalState.update(OD,!0),l.markdown(x8),await r.setConfig(le.RunCommandEnabled,!1),l.warning("Disabled automatic command execution"),l.button(u.command)}},buildPrompt:async({query:a,history:c},l,u)=>await Me.create(this.instantiationService,s,xT,{query:a,history:c}).render(l,u)}}};b0=E([y(0,he),y(1,xe),y(2,dl),y(3,md),y(4,Bt),y(5,j)],b0);var oYe=new Set(["cursorUndo","cursorRedo","editor.action.forceRetokenize","editor.action.toggleWordWrap","editor.action.moveCarretLeftAction","editor.action.moveCarretRightAction","editor.action.fontZoomIn","editor.action.fontZoomOut","editor.action.fontZoomReset","editor.action.smartSelect.expand","editor.action.smartSelect.shrink","editor.emmet.action.expandAbbreviation","editor.action.setSelectionAnchor","editor.action.inspectTMScopes","editor.action.commentLine","editor.action.addCommentLine","editor.action.removeCommentLine","editor.action.blockComment","editor.action.transposeLetters","editor.action.indentationToSpaces","editor.action.indentationToTabs","editor.action.indentUsingTabs","editor.action.indentUsingSpaces","editor.action.changeTabDisplaySize","editor.action.detectIndentation","editor.action.reindentlines","editor.action.reindentselectedlines","deleteInsideWord","editor.action.copyLinesUpAction","editor.action.copyLinesDownAction","editor.action.duplicateSelection","editor.action.moveLinesUpAction","editor.action.moveLinesDownAction","editor.action.sortLinesAscending","editor.action.sortLinesDescending","editor.action.removeDuplicateLines","editor.action.trimTrailingWhitespace","editor.action.deleteLines","editor.action.indentLines","editor.action.outdentLines","editor.action.insertLineBefore","editor.action.insertLineAfter","deleteAllLeft","deleteAllRight","editor.action.joinLines","editor.action.transpose","editor.action.transformToUppercase","editor.action.transformToLowercase","editor.action.transformToSnakecase","editor.action.transformToCamelcase","editor.action.transformToPascalcase","editor.action.transformToTitlecase","editor.action.transformToKebabcase","expandLineSelection","editor.action.formatDocument","editor.action.formatSelection","editor.action.showContextMenu","editor.action.inlineEdit.trigger","editor.debug.action.conditionalBreakpoint","editor.debug.action.addLogPoint","editor.debug.action.triggerByBreakpoint","editor.debug.action.editBreakpoint","editor.debug.action.goToNextBreakpoint","editor.debug.action.goToPreviousBreakpoint","editor.action.selectToBracket","editor.action.jumpToBracket","editor.action.removeBrackets","editor.action.clipboardCopyWithSyntaxHighlightingAction","editor.action.pasteAs","editor.action.pasteAsText","editor.action.inPlaceReplace.up","editor.action.inPlaceReplace.down","editor.action.openLink","editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","editor.action.unicodeHighlight.showExcludeOptions","editor.action.quickFix","editor.action.refactor","editor.action.sourceAction","codelens.showLensesInCurrentLine","editor.unfold","editor.unfoldRecursively","editor.fold","editor.foldRecursively","editor.foldAll","editor.unfoldAll","editor.foldAllBlockComments","editor.foldAllMarkerRegions","editor.unfoldAllMarkerRegions","editor.foldAllExcept","editor.unfoldAllExcept","editor.toggleFold","editor.gotoParentFold","editor.gotoPreviousFold","editor.gotoNextFold","editor.createFoldingRangeFromSelection","editor.removeManualFoldingRanges","editor.foldLevel1","editor.foldLevel2","editor.foldLevel3","editor.foldLevel4","editor.foldLevel5","editor.foldLevel6","editor.foldLevel7","editor.action.wordHighlight.trigger","actions.find","editor.action.startFindReplaceAction","editor.actions.findWithArgs","actions.findWithSelection","editor.action.nextMatchFindAction","editor.action.previousMatchFindAction","editor.action.nextSelectionMatchFindAction","editor.action.previousSelectionMatchFindAction","editor.action.insertCursorAbove","editor.action.insertCursorBelow","editor.action.insertCursorAtEndOfEachLineSelected","editor.action.addSelectionToNextFindMatch","editor.action.addSelectionToPreviousFindMatch","editor.action.moveSelectionToNextFindMatch","editor.action.moveSelectionToPreviousFindMatch","editor.action.selectHighlights","editor.action.addCursorsToBottom","editor.action.addCursorsToTop","editor.action.focusNextCursor","editor.action.focusPreviousCursor","editor.action.marker.next","editor.action.marker.prev","editor.action.marker.nextInFiles","editor.action.marker.prevInFiles","editor.action.triggerSuggest","editor.action.resetSuggestSize","editor.action.dirtydiff.previous","editor.action.dirtydiff.next","workbench.action.editor.previousChange","workbench.action.editor.nextChange","editor.action.formatChanges","editor.action.showHover","editor.action.showDefinitionPreviewHover","editor.action.inlineSuggest.trigger","editor.debug.action.selectionToWatch","workbench.action.debug.nextConsole","workbench.debug.action.focusRepl","workbench.action.debug.prevConsole","editor.debug.action.toggleInlineBreakpoint","workbench.action.debug.restart","editor.debug.action.runToCursor","workbench.action.debug.selectDebugConsole","workbench.action.showAboutDialog","workbench.action.editor.changeEOL","workbench.action.editor.changeEncoding","workbench.action.clearEditorHistory","notebook.clearNotebookEdtitorTypeCache","notebook.clearNotebookKernelsMRUCache","workbench.action.clearRecentFiles","workbench.action.closeAllGroups","workbench.action.closeAllEditors","workbench.action.closeEditorsInGroup","workbench.action.closeActiveEditor","workbench.action.closeEditorInAllGroups","workbench.action.closeEditorsInOtherGroups","workbench.action.closeEditorsToTheLeft","workbench.action.closeOtherEditors","workbench.action.closeActivePinnedEditor","workbench.action.closeSidebar","workbench.action.closeUnmodifiedEditors","workbench.files.action.compareWithClipboard","workbench.files.action.compareWithSaved","workbench.files.action.compareNewUntitledTextFiles","workbench.action.tasks.configureDefaultBuildTask","workbench.action.tasks.configureTaskRunner","testing.configureProfile","workbench.action.pauseSocketWriting","workbench.action.triggerReconnect","workbench.action.copyEditorGroupToNewWindow","copyFilePath","copyRelativeFilePath","workbench.action.customizeLayout","workbench.notebook.layout.configure","workbench.action.duplicateActiveEditorGroupDown","workbench.action.duplicateActiveEditorGroupLeft","workbench.action.duplicateActiveEditorGroupRight","workbench.action.duplicateActiveEditorGroupUp","workbench.action.focusActiveEditorGroup","workbench.action.focusAboveGroup","workbench.action.focusBelowGroup","workbench.action.focusFirstEditorGroup","workbench.action.focusPanel","workbench.action.focusSideBar","workbench.action.focusAuxiliaryBar","workbench.action.focusLastEditorGroup","workbench.action.focusLeftGroup","workbench.action.focusNextGroup","workbench.action.focusNextPart","workbench.files.action.focusFilesExplorer","workbench.action.focusPreviousGroup","workbench.action.focusPreviousPart","workbench.action.focusRightGroup","workbench.action.focusStatusBar","workbench.action.navigateBackInEditLocations","workbench.action.navigateBackInNavigationLocations","workbench.action.navigateForwardInEditLocations","workbench.action.navigateForwardInNavigationLocations","workbench.action.navigateLast","workbench.action.navigatePreviousInEditLocations","workbench.action.navigatePreviousInNavigationLocations","workbench.action.quickOpen","workbench.action.navigateToLastEditLocation","workbench.action.navigateToLastNavigationLocation","workbench.action.gotoLine","workbench.action.compareEditor.nextChange","testing.goToNextMessage","workbench.action.compareEditor.previousChange","testing.goToPreviousMessage","workbench.action.gotoSymbol","workbench.action.showAllSymbols","workbench.action.editorLayoutTwoByTwoGrid","workbench.action.closePanel","workbench.action.inspectContextKeys","workbench.action.inspectKeyMappings","workbench.action.inspectKeyMappingsJSON","notebook.inspectLayout","workbench.action.joinAllGroups","workbench.action.joinTwoGroups","workbench.action.keepEditor","merge.dev.loadContentsFromFolder","workbench.action.logStorage","workbench.action.logWorkingCopies","workbench.action.moveActiveEditorGroupDown","workbench.action.moveEditorGroupToNewWindow","workbench.action.moveActiveEditorGroupLeft","workbench.action.moveActiveEditorGroupRight","workbench.action.moveActiveEditorGroupUp","workbench.action.moveEditorToFirstGroup","workbench.action.moveEditorToAboveGroup","workbench.action.moveEditorToBelowGroup","workbench.action.moveEditorToLastGroup","workbench.action.moveEditorToLeftGroup","workbench.action.moveEditorToNextGroup","workbench.action.moveEditorToPreviousGroup","workbench.action.moveEditorToRightGroup","workbench.action.moveEditorLeftInGroup","workbench.action.moveEditorRightInGroup","workbench.action.positionPanelLeft","workbench.action.positionPanelRight","workbench.action.positionPanelBottom","workbench.action.movePanelToSecondarySideBar","workbench.action.moveSecondarySideBarToPanel","workbench.action.moveView","workbench.action.navigateEditorGroups","workbench.action.quickOpenNavigateNext","workbench.action.quickOpenNavigatePrevious","workbench.action.navigateUp","workbench.action.navigateDown","workbench.action.navigateLeft","workbench.action.navigateRight","workbench.action.newGroupAbove","workbench.action.newGroupBelow","workbench.action.newGroupLeft","workbench.action.newGroupRight","workbench.action.newEmptyEditorWindow","welcome.showNewFileEntries","explorer.newFile","explorer.newFolder","workbench.action.files.newUntitledFile","workbench.action.newWindow","workbench.action.nextPanelView","workbench.action.openExtensionLogsFolder","workbench.action.files.openFile","workbench.action.firstEditorInGroup","workbench.action.lastEditorInGroup","workbench.action.openLogsFolder","merge.dev.openContentsJson","workbench.action.nextEditor","workbench.action.nextEditorInGroup","workbench.action.openNextRecentlyUsedEditor","workbench.action.openNextRecentlyUsedEditorInGroup","workbench.action.previousEditor","workbench.action.previousEditorInGroup","workbench.action.openPreviousRecentlyUsedEditor","workbench.action.openPreviousRecentlyUsedEditorInGroup","workbench.action.openProcessExplorer","workbench.action.openRecent","merge.dev.openSelectionInTemporaryMergeEditor","workbench.action.pinEditor","workbench.action.previousPanelView","workbench.action.quickOpenLeastRecentlyUsedEditor","workbench.action.openPreviousEditorFromHistory","workbench.action.quickOpenPreviousRecentlyUsedEditor","workbench.action.webview.reloadWebviewAction","workbench.action.reloadWindow","workbench.action.removeLargeStorageDatabaseEntries","workbench.action.reopenClosedEditor","workbench.action.reopenWithEditor","menu.resetHiddenStates","mergeEditor.resetCloseWithConflictsChoice","files.participants.resetChoice","workbench.action.evenEditorWidths","workbench.action.resetViewLocations","workbench.files.action.showActiveFileInExplorer","revealFileInOS","workbench.action.revertAndCloseActiveEditor","workbench.action.files.revert","workbench.action.files.save","workbench.action.files.saveAll","workbench.action.files.saveFiles","workbench.files.action.saveAllInGroup","workbench.action.files.saveAs","workbench.action.files.saveWithoutFormatting","workbench.action.quickOpenSelectNext","workbench.action.quickOpenSelectPrevious","workbench.action.setLogLevel","workbench.action.alignPanelCenter","workbench.action.alignPanelJustify","workbench.action.alignPanelLeft","workbench.action.alignPanelRight","workbench.action.showAllEditors","workbench.action.showAllEditorsByMostRecentlyUsed","workbench.action.showEditorsInActiveGroup","workbench.action.tasks.showTasks","workbench.action.tasks.showLog","_workbench.output.showViewsLog","workbench.action.editorLayoutSingle","workbench.action.splitEditor","workbench.action.splitEditorDown","workbench.action.splitEditorToFirstGroup","workbench.action.splitEditorToAboveGroup","workbench.action.splitEditorToBelowGroup","workbench.action.splitEditorToLastGroup","workbench.action.splitEditorToLeftGroup","workbench.action.splitEditorToNextGroup","workbench.action.splitEditorToPreviousGroup","workbench.action.splitEditorToRightGroup","workbench.action.splitEditorLeft","workbench.action.splitEditorOrthogonal","workbench.action.splitEditorRight","workbench.action.splitEditorUp","editor.action.startDebugTextMate","workbench.action.stopTracing","workbench.action.tasks.terminate","workbench.action.editorLayoutThreeColumns","workbench.action.editorLayoutThreeRows","workbench.action.toggleAutoSave","editor.action.toggleRenderControlCharacter","workbench.action.toggleEditorGroupLock","workbench.action.toggleEditorWidths","workbench.action.toggleKeybindingsLog","notebook.toggleLayoutTroubleshoot","editor.action.toggleMinimap","workbench.action.toggleMultiCursorModifier","notebook.action.toggleNotebookStickyScroll","workbench.action.toggleSidebarPosition","workbench.action.toggleSidebarVisibility","editor.action.toggleRenderWhitespace","editor.action.toggleScreenReaderAccessibilityMode","workbench.action.toggleScreencastMode","workbench.action.toggleAuxiliaryBar","workbench.action.toggleStatusbarVisibility","editor.action.toggleTabFocusMode","testing.toggleTestingPeekHistory","workbench.action.toggleEditorGroupLayout","redo","editor.action.selectAll","undo","debug.addConfiguration","workbench.debug.viewlet.action.addDataBreakpointOnAddress","workbench.debug.viewlet.action.addFunctionBreakpointAction","workbench.action.browseColorThemesInMarketplace","workbench.action.closeWindow","workbench.action.selectTheme","workbench.action.tasks.configureDefaultTestTask","workbench.action.configureRuntimeArguments","remote.tunnel.copyAddressCommandPalette","workbench.action.selectIconTheme","workbench.action.focusActivityBar","workbench.action.focusBanner","workbench.action.generateColorTheme","workbench.action.activityBarLocation.hide","editor.action.measureExtHostLatency","workbench.action.activityBarLocation.bottom","workbench.action.activityBarLocation.top","workbench.action.nextSideBarView","workbench.action.tasks.openUserTasks","welcome.showAllWalkthroughs","workbench.action.previousSideBarView","workbench.action.selectProductIconTheme","workbench.action.reloadWindowWithExtensionsDisabled","workbench.debug.viewlet.action.removeAllBreakpoints","editor.inlayHints.Reset","resetGettingStartedProgress","workbench.action.zoomReset","workbench.action.restartExtensionHost","remote.tunnel.closeCommandPalette","workbench.action.switchWindow","workbench.debug.viewlet.action.toggleBreakpointsActivatedAction","workbench.action.toggleLightDarkThemes","breadcrumbs.toggle","editor.action.toggleColumnSelection","workbench.action.toggleDevTools","debug.action.toggleDisassemblyViewSourceCode","tree.toggleStickyScroll","workbench.action.uninstallCommandLine","workbench.action.openWalkthrough","workbench.action.zoomIn","editor.action.clipboardCopyAction","editor.action.clipboardCutAction","editor.action.clipboardPasteAction","notification.acceptPrimaryAction","_workbench.extensions.action.cleanUpExtensionsFolder","notifications.clearAll","workbench.action.clearCommandHistory","workbench.action.configureLanguageBasedSettings","workbench.extensions.action.configureWorkspaceFolderRecommendedExtensions","workbench.extensions.action.disableAll","workbench.extensions.action.disableAllWorkspace","notifications.focusToasts","workbench.debug.action.focusBreakpointsView","workbench.debug.action.focusCallStackView","workbench.panel.repl.view.focus","workbench.views.extensions.disabled.focus","workbench.views.extensions.enabled.focus","workbench.extensions.action.focusExtensionsView","workbench.explorer.fileView.focus","workbench.views.extensions.installed.focus","workbench.files.action.focusOpenEditorsView","outline.focus","workbench.panel.output.focus","workbench.panel.markers.view.focus","workbench.view.search.focus","workbench.scm.repositories.focus","workbench.scm.focus","terminal.focus","timeline.focus","workbench.debug.action.focusVariablesView","workbench.debug.action.focusWatchView","workbench.action.focusTitleBar","workbench.action.openAccessibilitySettings","workbench.action.openDefaultKeybindingsFile","workbench.action.openRawDefaultSettings","workbench.extensions.action.openExtensionsFolder","workbench.action.openGlobalKeybindings","workbench.action.openGlobalKeybindingsFile","workbench.action.openQuickChat","search.action.openInEditor","workbench.action.openSettings2","workbench.action.openGlobalSettings","workbench.action.openSettingsJson","workbench.action.openView","workbench.action.openWorkspaceSettings","workbench.action.openWorkspaceSettingsFile","workbench.profiles.actions.help","workbench.action.quickTextSearch","workbench.extensions.action.refreshExtension","editor.emmet.action.removeTag","workbench.action.openIssueReporter","workbench.action.reportPerformanceIssueUsingReporter","workbench.action.showCommands","workbench.extensions.action.listBuiltInExtensions","workbench.extensions.action.showDisabledExtensions","workbench.extensions.action.showEnabledExtensions","workbench.extensions.action.listWorkspaceUnsupportedExtensions","notifications.showList","workbench.profiles.actions.showProfileContents","workbench.action.remote.showMenu","workbench.action.showWindowLog","notifications.toggleDoNotDisturbMode","notifications.toggleDoNotDisturbModeBySource","editor.action.toggleStickyScroll","editor.action.accessibilityHelp","editor.action.accessibleView","extension.js-debug.addXHRBreakpoints","editor.emmet.action.balanceIn","editor.emmet.action.balanceOut","workbench.debug.panel.action.clearReplAction","workbench.action.clearLocalePreference","workbench.output.action.clearOutput","json.clearCache","search.action.clearHistory","workbench.files.action.collapseExplorerFolders","workbench.action.configureLocale","workbench.action.openSnippets","editor.emmet.action.decrementNumberByOneTenth","editor.emmet.action.decrementNumberByOne","editor.emmet.action.decrementNumberByTen","workbench.action.localHistory.deleteAll","extension.js-debug.disableSourceMapStepping","extension.js-debug.editXHRBreakpoints","editor.emmet.action.evaluateMathExpression","workbench.action.populateFileFromSnippet","references-view.findImplementations","workbench.action.localHistory.restoreViaPicker","workbench.action.findInFiles","search.action.focusSearchList","npm.focus","workbench.panel.chat.view.copilot.focus","~remote.forwardedPorts.focus","workbench.action.problems.focus","editor.emmet.action.matchTag","editor.emmet.action.nextEditPoint","editor.emmet.action.prevEditPoint","accessibility.announcement.help","signals.sounds.help","editor.emmet.action.incrementNumberByOneTenth","editor.emmet.action.incrementNumberByOne","editor.emmet.action.incrementNumberByTen","workbench.action.showInteractivePlayground","extension.js-debug.createDebuggerTerminal","vscode-testresolver.killServerAndTriggerHandledError","editor.emmet.action.mergeLines","ipynb.newUntitledIpynb","search.action.openNewEditor","vscode-testresolver.newWindow","git.openAllChanges","git.openChange","extension.js-debug.debugLink","workbench.action.openLogFile","search.action.openNewEditorToSide","search.action.openEditor","workbench.action.webview.openDeveloperTools","perf.event.profiling","perf.insta.printAsyncCycles","perf.insta.printTraces","github.publish","editor.emmet.action.reflectCSSValue","workbench.files.action.refreshFilesExplorer","extension.js-debug.removeAllCustomBreakpoints","extension.js-debug.callers.removeAll","extension.js-debug.callers.remove","extension.js-debug.removeXHRBreakpoint","workbench.action.replaceInFiles","editor.emmet.action.selectNextItem","editor.emmet.action.selectPrevItem","simpleBrowser.show","references-view.showCallHierarchy","workbench.action.showEmmetCommands","git.showOutput","references-view.showIncomingCalls","workbench.action.showLogs","editor.action.showOrFocusStandaloneColorPicker","references-view.showOutgoingCalls","workbench.action.showOutputChannels","workbench.action.showRuntimeExtensions","references-view.showSubtypes","references-view.showSupertypes","vscode-testresolver.showLog","references-view.showTypeHierarchy","vscode-testresolver.toggleConnectionSlowdown","json.sort","editor.emmet.action.splitJoinTag","git.diff.stageHunk","git.diff.stageSelection","extension.node-debug.startWithStopOnEntry","perfview.show","extension.node-debug.toggleAutoAttach","editor.emmet.action.toggleComment","extension.js-debug.addCustomBreakpoints","workbench.action.toggleLockedScrolling","workbench.action.toggleNotebookClipboardLog","workbench.action.togglePanel","extension.js-debug.toggleSkippingFile","workbench.action.editorLayoutTwoColumnsBottom","workbench.action.editorLayoutTwoColumns","workbench.action.editorLayoutTwoRows","workbench.action.editorLayoutTwoRowsRight","workbench.action.unpinEditor","editor.emmet.action.updateImageSize","editor.emmet.action.updateTag","workbench.action.openLicenseUrl","editor.emmet.action.wrapWithAbbreviation","workbench.action.zoomOut","inlineChat.copyRecordings","workbench.action.terminal.accessibleBufferGoToNextCommand","workbench.action.addRootFolder","search.action.cancel","workbench.action.terminal.changeColor","workbench.action.terminal.changeIcon","workbench.action.editor.changeLanguageMode","workbench.profiles.actions.cleanupProfiles","workbench.action.terminal.clear","workbench.action.chat.clearHistory","workbench.action.chat.clearInputHistory","workbench.action.terminal.clearPreviousSessionHistory","workbench.action.terminal.clearSelection","workbench.action.closeFolder","workbench.files.action.compareFileWith","workbench.action.terminal.openSettings","workbench.action.copyEditorToNewWindow","workbench.action.terminal.copyLastCommand","workbench.action.terminal.copyLastCommandAndLastCommandOutput","workbench.action.terminal.copyLastCommandOutput","workbench.profiles.actions.createTemporaryProfile","workbench.action.localHistory.create","workbench.action.terminal.new","workbench.action.terminal.newInActiveWorkspace","workbench.action.createTerminalEditor","workbench.action.createTerminalEditorSide","workbench.action.terminal.newWithCwd","workbench.action.decreaseViewSize","workbench.action.decreaseViewHeight","workbench.action.decreaseViewWidth","workbench.action.terminal.fontZoomOut","workbench.action.terminal.detachSession","workbench.debug.viewlet.action.disableAllBreakpoints","workbench.action.duplicateWorkspaceInNewWindow","workbench.debug.viewlet.action.enableAllBreakpoints","workbench.action.minimizeOtherEditorsHideSidebar","workbench.action.chat.export","workbench.action.terminal.findNext","workbench.action.terminal.findPrevious","breadcrumbs.focusAndSelect","breadcrumbs.focus","workbench.action.terminal.focusFind","workbench.action.terminal.focusHover","workbench.action.terminal.focusNext","workbench.action.terminal.focusNextPane","workbench.action.terminal.focusPrevious","workbench.action.terminal.focusPreviousPane","workbench.action.terminal.focus","workbench.action.terminal.focusTabs","workbench.action.terminal.goToRecentDirectory","hideCustomTitleBar","workbench.action.hideEditorActions","workbench.action.hideEditorTabs","workbench.action.terminal.hideFind","workbench.action.chat.import","workbench.action.increaseViewSize","workbench.action.increaseViewHeight","workbench.action.increaseViewWidth","workbench.action.terminal.fontZoomIn","workbench.action.chat.inlineVoiceChat","workbench.action.chat.insertCodeBlock","workbench.action.chat.insertIntoNewFile","editor.action.insertSnippet","workbench.action.terminal.join","workbench.action.terminal.killAll","workbench.action.terminal.killEditor","workbench.action.terminal.kill","workbench.action.lockEditorGroup","workbench.action.maximizeEditorHideSidebar","workbench.action.editorActionsTitleBar","workbench.action.moveEditorToNewWindow","workbench.action.terminal.moveToEditor","workbench.action.terminal.moveIntoNewWindow","workbench.action.chat.newChat","workbench.action.chat.nextCodeBlock","workbench.action.chat.nextFileTree","workbench.action.debug.configure","workbench.action.files.showOpenedFileInNewWindow","workbench.action.chat.openInEditor","workbench.action.chat.openInNewWindow","workbench.action.chat.openInSidebar","workbench.action.terminal.openDetectedLink","workbench.action.openChat","workbench.action.files.openFolder","workbench.action.terminal.openFileLink","workbench.action.terminal.openUrlLink","workbench.action.openWorkspace","workbench.action.files.openFileFolder","workbench.action.chat.previousCodeBlock","workbench.action.chat.previousFileTree","workbench.action.quickOpenLeastRecentlyUsedEditorInGroup","workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup","workbench.action.chat.quickVoiceChat","workbench.action.terminal.recordSession","workbench.action.terminal.relaunch","workbench.action.removeRootFolder","workbench.action.terminal.renameWithArg","workbench.profiles.actions.renameProfile","workbench.action.terminal.rename","workbench.action.reopenTextEditor","workbench.action.files.resetActiveEditorReadonlyInSession","workbench.action.terminal.fontZoomReset","workbench.profiles.actions.resetWorkspaces","workbench.action.terminal.resizePaneDown","workbench.action.terminal.resizePaneLeft","workbench.action.terminal.resizePaneRight","workbench.action.terminal.resizePaneUp","workbench.action.terminal.restartPtyHost","workbench.action.saveWorkspaceAs","workbench.action.terminal.scrollDown","workbench.action.terminal.scrollDownPage","workbench.action.terminal.scrollToBottom","workbench.action.terminal.scrollToNextCommand","workbench.action.terminal.scrollToPreviousCommand","workbench.action.terminal.scrollToTop","workbench.action.terminal.scrollUp","workbench.action.terminal.scrollUpPage","workbench.action.terminal.selectAll","workbench.action.terminal.selectDefaultShell","workbench.action.terminal.selectToNextCommand","workbench.action.terminal.selectToNextLine","workbench.action.terminal.selectToPreviousCommand","workbench.action.terminal.selectToPreviousLine","workbench.action.toggleSeparatePinnedEditorTabs","workbench.action.files.setActiveEditorReadonlyInSession","workbench.action.files.setActiveEditorWriteableInSession","workbench.action.terminal.setDimensions","workbench.action.chat.history","workbench.action.terminal.showEnvironmentContributions","workbench.action.showEditorTab","workbench.action.terminal.showTextureAtlas","workbench.action.splitEditorInGroup","workbench.action.terminal.split","workbench.action.terminal.splitInActiveWorkspace","workbench.action.editorDictation.start","extension.bisect.start","inlineChat.start","workbench.action.terminal.chat.start","workbench.action.startTrackDisposables","workbench.action.chat.startVoiceChat","workbench.action.quickOpenTerm","workbench.action.terminal.switchTerminal","workbench.action.files.toggleActiveEditorReadonlyInSession","workbench.action.toggleCenteredLayout","workbench.action.toggleEditorVisibility","workbench.action.toggleEditorType","workbench.action.toggleFullScreen","workbench.action.toggleMaximizedPanel","workbench.action.terminal.sizeToContentWidth","workbench.action.toggleSplitEditorInGroup","workbench.action.terminal.toggleStickyScroll","workbench.action.toggleZenMode","workbench.action.troubleshootIssue.start","workbench.action.terminal.unsplit","workbench.action.terminal.searchWorkspace","workbench.action.terminal.toggleFindCaseSensitive","workbench.action.terminal.toggleFindRegex","workbench.action.terminal.toggleFindWholeWord","workbench.action.chat.voiceChatInChatView","workbench.action.terminal.writeDataToTerminal","merge-conflict.accept.all-both","merge-conflict.accept.all-current","merge-conflict.accept.all-incoming","merge-conflict.accept.both","merge-conflict.accept.current","merge-conflict.accept.incoming","merge-conflict.accept.selection","git.addRemote","git.stashApplyLatest","git.stashApply","git.checkoutDetached","git.checkout","git.cherryPick","git.clone","git.cloneRecursive","git.closeAllDiffEditors","git.closeAllUnmodifiedEditors","git.closeOtherRepositories","git.close","git.commit","git.commitAmend","git.commitSigned","git.commitAll","git.commitAllAmend","git.commitAllSigned","git.commitEmpty","git.commitStaged","git.commitStagedAmend","git.commitStagedSigned","merge-conflict.compare","jupyter.continueEditSessionInCodespace","issue.copyGithubHeadLink","issue.copyGithubPermalink","issue.copyMarkdownGithubPermalink","git.branchFrom","git.branch","jupyter.createnewinteractive","workbench.action.terminal.newWithProfile","workbench.profiles.actions.createProfile","git.createTag","git.deleteBranch","workbench.profiles.actions.deleteProfile","git.deleteRemoteTag","git.deleteTag","git.cleanAll","git.cleanAllTracked","git.cleanAllUntracked","git.clean","git.stashDropAll","git.stashDrop","github.copilot.interactiveEditor.explain.palette","workbench.profiles.actions.exportProfile","git.fetch","git.fetchPrune","git.fetchAll","jupyter.filterKernels","github.copilot.interactiveEditor.fix","github.copilot.interactiveEditor.generateDocs","github.copilot.interactiveEditor.generateTests","github.copilot.interactiveEditor.generate","git.init","git.merge","merge-conflict.next","git.openRepository","git.stashPopLatest","git.stashPop","merge-conflict.previous","git.publish","git.pull","git.pullRebase","git.pullFrom","git.push","git.pushWithTags","git.pushTags","git.pushTo","git.rebase","git.refresh","git.removeRemote","git.renameBranch","jupyter.resetLoggingLevel","workbench.profiles.actions.createFromCurrentProfile","jupyter.selectJupyterInterpreter","github.copilot.interactiveSession.feedback","workbench.panel.chatSidebar","workbench.view.explorer","workbench.view.extensions","workbench.view.extension.github-pull-requests","workbench.view.debug","workbench.view.search","workbench.view.scm","git.stageAll","git.stageAllMerge","git.stageAllTracked","git.stageAllUntracked","git.stage","git.stash","git.stashIncludeUntracked","git.stashStaged","workbench.profiles.actions.switchProfile","git.sync","git.syncRebase","workbench.panel.comments","workbench.debug.action.toggleRepl","workbench.action.output.toggleOutput","~remote.forwardedPortsContainer","workbench.actions.view.problems","workbench.action.terminal.toggleTerminal","workbench.editSessions.actions.signIn","git.undoCommit","git.unstageAll","git.unstage","git.viewChanges","git.viewStagedChanges","git.stashView"]);function sYe(t,e){let r=Ls(e);for(let n of r){if(n.language!=="json"&&n.language!=="")return[];let o;try{o=Jp(n.code)}catch{}if(!o||!o.hasOwnProperty("command"))return[];let s=t.getCommand(o.command);if(s)return[{command:s.key,title:s.label,arguments:o.args}]}return[]}function lbe(t){let e=new ht,r=t.get(Bt),n=r.extensionMode;return typeof n=="number"&&n!==ix.ExtensionMode.Test&&e.add(new sX(r,t)),e}var sX=class extends ht{constructor(e,r){super();let n=r.get(he);this.add(ix.workspace.onDidChangeConfiguration(o=>{if(o.affectsConfiguration("github.copilot.chat.runCommand.enabled")){let s=n.getConfig(le.RunCommandEnabled);ix.commands.executeCommand("setContext","github.copilot.chat.runCommand.enabled",s),s&&e.globalState.update(OD,!1)}})),ix.commands.executeCommand("setContext","github.copilot.chat.runCommand.enabled",n.getConfig(le.RunCommandEnabled))}};var dX={};Pn(dX,{create:()=>dYe});var ube=q(Ct());var MD=class{constructor(e){this.instantiationService=e;this.kind="workspace";this.variableInfo={name:"codebase",fullName:"Codebase",icon:"folder",description:ube.t("Searches through the codebase and pulls out relevant information for the query."),defaultEnablement:!0}}async resolveContext(e,r,n){if(!e.message)return;let{messages:o,references:s}=await yo(this.instantiationService,e.endpoint,SC,{promptContext:{chatVariables:new xo([]),query:this.turnQueryIntoWorkspaceQuery(e.message),history:e.history??[]},include:{workspaceChunks:!0}},n,r);if(o.length>0)return{kind:this.kind,userMessages:o.map(a=>a.content),references:s}}turnQueryIntoWorkspaceQuery(e){let r=e;return r.startsWith("@")&&(r=r.replace(/@\w+\s*/,"")),r=r.replaceAll(/\#files/gi,"files"),r}};MD=E([y(0,j)],MD);jn.register(new ye(MD));var dbe=q(require("path"));var FD=class{constructor(e,r){this._tabsAndEditorsService=e;this._ignoreService=r;this.kind="current-editor";this.variableInfo={name:"editor",description:"The visible source code in the active editor",fullName:"Current Editor",icon:"file-code",defaultEnablement:!0,registerTool:!0}}async resolveContext(e){let r=this._tabsAndEditorsService.activeTextEditor;if(r?.document.uri&&await this._ignoreService.isCopilotIgnored(r?.document.uri))return;let n=r?.visibleRanges[0];if(n){let o="";r.selection.isSingleLine&&(o=`The cursor is on line: ${r.selection.start.line}`);let s=[`Excerpt from active file ${dbe.basename(r.document.uri.path)}, lines ${n.start.line+1} to ${n.end.line+1}:`,Si(r.document.languageId,r.document.getText(n),!1),"",o].join(`
`);return{kind:this.kind,userMessages:[s],references:[new Bo.PromptReference({uri:r.document.uri,range:n})]}}}};FD=E([y(0,Ft),y(1,Te)],FD);jn.register(new ye(FD));var UD=class{constructor(e){this._instantiationService=e;this.kind="current-selection-implementations"}async resolveContext(e,r,n){let{references:o,messages:s}=await yo(this._instantiationService,e.endpoint,Kl,{});return{kind:this.kind,references:o,userMessages:s.map(a=>a.content)}}};UD=E([y(0,j)],UD);jn.register(new ye(UD));var pbe=q(Ct());var ST=ne("IDebugOutputService");var BD=class{constructor(e){this._debugOutputService=e;this.kind="debug-console-output";this.variableInfo={name:"debugConsole",description:pbe.t("The output in the debug console"),defaultEnablement:!1}}async resolveContext(){return{kind:this.kind,userMessages:[`Debug console output:
`+this._debugOutputService.consoleOutput]}}};BD=E([y(0,ST)],BD);jn.register(new ye(BD));var ox=q(Ue());var S8=q(Ue());var _0=class extends S8.PromptElement{constructor(r,n,o,s,a,c,l,u){super(r);this.ignoreService=n;this.extensionContext=o;this.languageFeaturesService=s;this.workspaceService=a;this.logService=c;this.parserService=l;this.telemetryService=u}static{this.DEFAULT_TIMEOUT_MS=200}async render(r,n){if(await this.ignoreService.isCopilotIgnored(this.props.document.uri))return vscpp("ignoredFiles",{value:[this.props.document.uri]});let o=this.extensionContext.extensionMode===nl.Test?0:this.props.timeoutMs===void 0?_0.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,[s,a]=await this.findReferences(o);return this.logService.public.debug(`Found ${s.length} implementation(s)/definition(s), ${a.length} usages`),s.length>0&&this.logService.public.debug("Implementation(s)/definition(s) found:"+JSON.stringify(s,null,"	")),a.length>0&&this.logService.public.debug("Usages found:"+JSON.stringify(a,null,"	")),vscpp(vscppf,null,this.renderCodeExcerpts(`Relevant definition${s.length>1?"s":""}:`,s),this.renderCodeExcerpts("Other usages:",a))}renderCodeExcerpts(r,n){if(n.length>0)return vscpp(vscppf,null,r,vscpp("br",null),vscpp("br",null),n.map(o=>{let c=`${`${mn(o.languageId).lineComment.start} FILEPATH: ${o.uri.path}`}
${o.code}`;return vscpp(nt,{uri:o.uri,languageId:o.languageId,code:c,references:[new S8.PromptReference(new fn(o.uri,o.excerptRange))]})}),vscpp("br",null),vscpp("br",null))}async findReferences(r){let{document:n,position:o}=this.props,s=async()=>{try{let u=await this.languageFeaturesService.getReferences(n.uri,o);return this.logService.public.debug(`Found ${u.length} references: `+JSON.stringify(u,null,"	")),u}catch{return[]}},a=await mc(this.logService,this.telemetryService,n,r*3,s,[]),c=[],l=[];for(let u of a){if(await this.ignoreService.isCopilotIgnored(u.uri))continue;let d=await this.workspaceService.openTextDocument(u.uri),p=this.parserService.getTreeSitterAST(d);if(!p)continue;let f=_o(u.range,d),m=await p.getCallExpressions(f),h=await p.getFunctionDefinitions();if(m.length>0)l.push({languageId:d.languageId,uri:d.uri,code:m[0].text,excerptRange:Os(d,m[0])});else if(h.some(g=>En.doIntersect(g,f))){let v=(await Tv(this.parserService,this.telemetryService,{document:d,language:mn(n.languageId),wholeRange:u.range,selection:new _p(u.range.start,u.range.end),fileIndentInfo:void 0})).range;c.push({languageId:d.languageId,uri:d.uri,code:d.getText(v),excerptRange:v})}}return[c,l]}};_0=E([y(1,Te),y(2,Bt),y(3,jo),y(4,qe),y(5,ie),y(6,dt),y(7,ge)],_0);function fbe(t,e,r){let n=typeof r.code=="object"?r.code.value:r.code,o=aYe(t,e,r.source,n);return{fixes:o,messageReplacement(){for(let s of o)if(s.replaceMessage!==void 0)return s.replaceMessage},additionalContext(){let s=[];for(let a of o)a.additionalContext!==void 0&&s.push(a.additionalContext);return s}}}function aYe(t,e,r,n){if(!r||n===void 0)return[];let o=cYe[r];if(!o)return[];let s=o[n];if(!s)return[];let a=t.get(Lt),c=t.get(he),l=t.get(Uv);return(n.toString()==="C0301"||n.toString()==="C0301:line-too-long")&&!c.getExperimentBasedConfig(le.usePythonCookbookLineTooLong,a)&&!l.isInSimulationTests?[]:(t.get(ge).sendMSFTTelemetryEvent("cookbookAccessed",{languageId:e,diagnosticCode:n.toString(),provider:r}),(Array.isArray(s)?s:[s]).map(p=>typeof p=="string"?{title:p,message:""}:p))}var cYe={pylint:{C0301:["Split into many short lines to make sure each line is less than 20 tokens; split into many more lines than you normally would. Make sure to do the following: You must split all long strings, comments, and dictionary arguments and lists into shorter lines."]},Pylint:{"C0301:line-too-long":["Split into many short lines to make sure each line is less than 20 tokens; split into many more lines than you normally would. Make sure to do the following: You must split all long strings, comments, and dictionary arguments and lists into shorter lines."]},ts:{2345:{title:"Use this declaration and other usages as examples.",message:"",additionalContext:0},2554:{title:"Use this declaration and other usages as examples.",message:"",additionalContext:0}},eslint:{"class-methods-use-this":["Make the method static.","Move the method outside of the class.","Rewrite the method to use properties of the class."],"consistent-this":["Use the alias for this required by eslint consistent-this rule.","Use this directly instead of an alias."],"constructor-super":{title:"Add missing super call and pass through new arguments.",message:"The code is missing a super call in the constructor. Copy base class parameters to this constructor and pass them to super.",replaceMessage:"Missing super call in constructor"},"func-names":["Give the function expression the same name as the variable it is assigned to.","Convert the function to an arrow function."],"func-style":[{title:"Convert the function declaration to an expression.",message:"The function expression should be assigned to a variable with the name of the original function declaration."}],"max-lines-per-function":["Split into multiple functions."],"max-nested-callbacks":["Rewrite to avoid at least one callback."],"max-params":[{title:"Rewrite the signature to use an object parameter.",message:"Preserve all the parameters of the original signature."}],"max-statements":["Split into multiple functions."],"no-case-declarations":["Surround the case block with braces.","Move the declaration outside the case block."],"no-dupe-else-if":["Fix the duplicate condition to be different from the first.","Remove the duplicate condition"],"no-duplicate-case":[{title:"Change the duplicate condition to be different.",message:"Do not delete the duplicate case, just fix it",replaceMessage:"Duplicated condition."},"Remove the duplicate condition"],"no-duplicate-imports":"Merge the duplicated import lines.","no-fallthrough":[{title:"Rewrite to avoid fallthrough.",message:"Use the return value of the following cases and copy it to the preceding fallthrough case.",replaceMessage:"Fallthrough case in switch statement."},"Add a // fallthrough comment.","Add a break statement."],"no-inner-declarations":["Move the inner declaration to the top of its containing function.","Move the inner declaration to the bottom of its containing function.","Change the inner function declaration to an expression."],"no-multi-assign":"Assign each variable in separate statements.","no-negated-condition":"Invert the branches of the conditional.","no-new":["Convert the class to functions.","Assign the resulting object to a variable."],"no-sequences":[{title:"Wrap the whole comma sequence in parentheses.",message:"",replaceMessage:"Unnecessary comma sequence"},{title:"Rewrite, preserving the original behavior.",message:"The last element of the comma sequence is the one returned."},{title:"Delete the non-final elements of the sequence.",message:"They are unused unless it is for side effects."}],"no-sparse-arrays":["Remove duplicated commas.","Add default values for the missing elements."],"require-await":["Removed the unused async keyword.",{title:"Rewrite the function to use await.",message:"The code should change to call asynchronous functions where appropriate."}],"sort-keys":{title:"Sort the properties of the entire object literal.",message:"",replaceMessage:"Unsorted keys in object literal."}}};var lYe=200,mbe=300,eu=class extends ox.PromptElement{constructor(r,n,o){super(r);this.accessor=n;this.ignoreService=o}async render(r,n){let{diagnostics:o,documentContext:s}=this.props;return await this.ignoreService.isCopilotIgnored(s.document.uri)?vscpp("ignoredFiles",{value:[s.document.uri]}):o.length>0&&vscpp(vscppf,null,o.map((c,l)=>{let u=fbe(this.accessor,s.language.languageId,c);return vscpp(vscppf,null,vscpp(aX,{diagnostic:c,cookbook:u,maxLength:lYe,documentContext:s}),vscpp(qD,{diagnostic:c,cookbook:u,document:s.document}),vscpp(cX,{cookbook:u}))}))}};eu=E([y(1,Rt),y(2,Te)],eu);var aX=class extends ox.PromptElement{render(e,r){let n=this.props.diagnostic,o=this.props.documentContext.document,s=n.range,a=o.getText(new Be(s.start.line,0,s.end.line+1,0)).trimEnd(),c=a.length>0&&a.length<this.props.maxLength?a:"";return c?vscpp(vscppf,null,"This code",vscpp("br",null),vscpp(nt,{code:c,uri:o.uri,shouldTrim:!1}),vscpp("br",null),vscpp(vscppf,null,"has the problem reported:",vscpp(Zt,{name:"compileError"},n.message))):vscpp(vscppf,null)}},qD=class extends ox.PromptElement{constructor(r,n,o,s,a,c){super(r);this.workspaceService=n;this.parserService=o;this.ignoreService=s;this.logService=a;this.telemetryService=c}async render(r,n){let{infos:o,ignoredFiles:s,definitionRanges:a}=await this.getRelatedInfos();return!o.length&&!a.length?vscpp("ignoredFiles",{value:s}):vscpp(vscppf,null,"This diagnostic has some related code:",vscpp("br",null),o.map(c=>vscpp(nt,{code:c.content,uri:c.uri,references:[new ox.PromptReference(new fn(c.uri,c.range))]})),a.map(c=>vscpp(_0,{document:this.props.document,position:c.start})),vscpp("ignoredFiles",{value:s}))}async getRelatedInfos(){let r=[],n=[],o=[],s=this.props.diagnostic;if(s.relatedInformation)for(let c of s.relatedInformation)try{let l=c.location;if(await this.ignoreService.isCopilotIgnored(l.uri)){o.push(l.uri);continue}let u=await this.workspaceService.openTextDocument(l.uri),d=l.range,p=this.parserService.getTreeSitterAST(u),f;if(p){let m=C5(d),h=await p.getCoarseParentScope(m);f=u.getText(T5(h))}(!f||f.length>mbe)&&(f=u.getText(d)),f.length<=mbe&&r.push({content:f,uri:l.uri,range:l.range})}catch{}let a=this.props.cookbook.additionalContext();for(let c of a)switch(c){case 0:{let l=this.parserService.getTreeSitterAST(this.props.document);if(l){let u=_o(this.props.diagnostic.range,this.props.document),d=await mc(this.logService,this.telemetryService,this.props.document,500,()=>l.getCallExpressions(u),[]);for(let p of d){let f=Os(this.props.document,p);n.push(f)}}break}case 1:{n.push(this.props.diagnostic.range);break}}return{infos:r,definitionRanges:n,ignoredFiles:o}}};qD=E([y(1,qe),y(2,dt),y(3,Te),y(4,ie),y(5,ge)],qD);var cX=class extends ox.PromptElement{render(e,r){let n=this.props.cookbook.fixes;if(n.length){let o=n[0];return vscpp(Zt,{name:"suggestedFix"},o.title+o.message)}return null}};function hbe(t,e,r,n){let o=t.modelMaxPromptTokens*4/3,s=new Dp(o),a=e.document,c=e.language,l=new sa(s,a,c,"ed8c6549bwf9"),u=new sa(s,a,c,"abpxx6d04wxr"),d=new sa(s,a,c,"be15d9bcejpp"),p=()=>(u.trim(),l.trim(),d.trim(),{contextInfo:{language:c,above:u,range:l,below:d},tracker:s});if(!uYe(l,r,n))return p();let m={aboveLineIndex:n.start.line-1,belowLineIndex:n.end.line+1,minimumLineIndex:0,maximumLineIndex:a.lineCount-1};return EQ(m,u,d),p()}function uYe(t,e,r){let n=Math.floor((e.start.line+e.end.line)/2),o=Math.max(n-r.start.line,r.end.line-n);t.appendLine(n);for(let s=1;s<=o;s++){let a=n-s,c=n+s;if(a>=r.start.line&&!t.prependLine(a)||c<=r.end.line&&!t.appendLine(c))return!1}return!0}function x0(t,e,r,n){let o=t.getDiagnostics(e).filter(s=>!!s.range.intersection(r));if(n){let s=o.filter(a=>n.includes(a.message));if(s.length>0)return s}return o}async function gbe(t,e,r){let n=C5(e),o=Math.max(r,e.end.line-e.start.line+r),s=await t.getFixSelectionOfInterest(n,o);return T5(s)}var jD=class{constructor(e,r){this._instantiationService=e;this._languageDiagnosticsService=r;this.kind="diagnostics"}async resolveContext(e,r){let n=e.documentContext;if(!n)return;let o=x0(this._languageDiagnosticsService,n.document.uri,n.selection,e.message),{messages:s}=await yo(this._instantiationService,e.endpoint,eu,{documentContext:n,diagnostics:o});return{kind:this.kind,userMessages:s.map(a=>a.content)}}};jD=E([y(0,j),y(1,Vi)],jD);jn.register(new ye(jD));var I8=q(Ue());var IT=class{constructor(e=!0,r,n){let o=qm(r.getEditorInfo().version);this.embeddingsCache=e?n.createInstance(Hl,1,"api",o,"api"):n.createInstance(pd,1,"api",o)}async updateIndex(){this.apiChunks=await this.embeddingsCache.getCache()}nClosestValues(e,r,n=0){if(!this.apiChunks)return[];let o=this.apiChunks.map(s=>{if(!s.embedding)return{text:s.text,similarity:0};let a=mv(e,s.embedding);return{text:this.toContextString(s),similarity:a}});return o=o.filter(s=>s.similarity>n),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,r).map(s=>s.text)}toContextString(e){return e.type==="code"?`API Reference Code Snippet from vscode.d.ts:
${Si(e.lang,e.text)}`:e.type==="command"?`${e.text}`:e.type==="documentationCodeBlock"?`Example code from VS Code documentation:
${Si(e.lang,e.text)}`:""}};IT=E([y(1,gt),y(2,j)],IT);var lX=ne("IApiEmbeddingsIndex"),sx=class extends I8.PromptElement{constructor(r,n,o,s){super(r);this.apiEmbeddingsIndex=n;this.embeddingsComputer=o;this.endpointProvider=s}async renderAsString(){return`Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant.
${(await this.getSnippets()).join(`

`)}`}async getSnippets(){await this.apiEmbeddingsIndex.updateIndex();let r=await this.endpointProvider.getEmbeddingsEndpoint("text3small"),n=await this.embeddingsComputer.computeEmbeddings(r,[this.props.query],{dimensions:512},Wt.None);return n&&n.embeddings.length>0?this.apiEmbeddingsIndex.nClosestValues(n.embeddings[0],5):[]}async render(r,n){let o=await this.getSnippets();if(o.length)return vscpp(vscppf,null,"Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant.",vscpp("br",null),o.map(s=>vscpp(vscppf,null,vscpp(I8.TextChunk,null,s),vscpp("br",null),vscpp("br",null))))}};sx=E([y(1,lX),y(2,oa),y(3,xe)],sx);var vbe=q(Ct()),ybe=q(require("path"));var VD=class{constructor(e,r,n){this._workspaceService=e;this._gitService=r;this._tabsAndEditorsService=n;this.kind="git-metadata";this.variableInfo={name:"git",description:vbe.t("Information about the current git repository"),defaultEnablement:!1}}async resolveContext(e,r){let n=this._workspaceService,s=this._gitService.repositories,a=n.getWorkspaceFolders();if(s.length===0||!a)return;if(a.length>1){let l=e.documentContext?.document.uri??this._tabsAndEditorsService.activeTextEditor?.document.uri;if(l){let u=n.getWorkspaceFolder(l);if(u){let d=a.findIndex(p=>p.toString()===u.toString());d!==-1&&(s=[s[d]],a=[a[d]])}}}let c=[];for(let l=0;l<s.length;l++){if(r.isCancellationRequested)return;let u=s[l],d=a[l];if(!u)continue;let p=[];p.push(`Workspace Folder: ${ybe.basename(d.path)}`),p.push("```"),u.headBranchName?(p.push(`Current Branch name: ${u.headBranchName}`),p.push(`Upstream: ${u.upstreamBranchName?u.upstreamBranchName:"none"}`)):p.push("Detached HEAD?: yes"),p.push(`Is currently rebasing?: ${u.isRebasing?"yes":"no"}`),p.push(`Remotes: ${(u.remotes??[]).join(", ")}`),p.push("```"),c.push(p.join(`
`))}return{kind:this.kind,userMessages:[`Metadata about the current git repository:
`+c.join(`
`)]}}};VD=E([y(0,qe),y(1,Ho),y(2,Ft)],VD);jn.register(new ye(VD));var bbe=q(Ct());var HD=class{constructor(e){this.terminalService=e;this.kind="terminal-buffer";this.variableInfo={name:"terminalBuffer",description:bbe.t("The active terminal's buffer"),defaultEnablement:!1}}async resolveContext(){let e=this.terminalService.terminalBuffer;return{kind:this.kind,userMessages:[`The active terminal's buffer:
`+e]}}};HD=E([y(0,ui)],HD);jn.register(new ye(HD));var uX=q(Ct());var GD=class{constructor(e){this.terminalService=e;this.kind="terminal-last-command";this.variableInfo={name:"terminalLastCommand",description:uX.t("The active terminal's last run command"),fullName:uX.t("Terminal Last Command"),icon:"terminal",defaultEnablement:!0,registerTool:!0}}async resolveContext(){let e=this.terminalService.terminalLastCommand;if(!e)return;let r=[];e.commandLine&&(r.push("The following is the last command run in the terminal:"),r.push(e.commandLine)),e.cwd&&(r.push("It was run in the directory:"),r.push(typeof e.cwd=="object"?e.cwd.toString():e.cwd)),e.output&&(r.push("It has the following output:"),r.push(e.output));let n=r.join(`
`);return{kind:this.kind,userMessages:[`The active terminal's last run command:
`+n]}}};GD=E([y(0,ui)],GD);jn.register(new ye(GD));var zD=class{constructor(e){this.terminalService=e;this.kind="terminal-selection";this.variableInfo={name:"terminalSelection",icon:"terminal",fullName:"Terminal Selection",description:"The active terminal's selection",defaultEnablement:!0,registerTool:!0}}async resolveContext(){let e=this.terminalService.terminalSelection;return{kind:this.kind,userMessages:[`The active terminal's selection:
`+e]}}};zD=E([y(0,ui)],zD);jn.register(new ye(zD));var $D=class{constructor(e){this.terminalService=e;this.kind="terminal-shell-type"}async resolveContext(){let e=this.terminalService.terminalShellType;return{kind:this.kind,userMessages:[`The active terminal's shell type:
`+e]}}};$D=E([y(0,ui)],$D);jn.register(new ye($D));var WD=q(Ct());function _be(t,e){let r=Ls(e);for(let n of r){if(n.language!=="json"&&n.language!=="")return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let o;try{o=Jp(n.code)}catch{}if(!o)return[];let s=o.hasOwnProperty("type")&&o.type==="setting",a=o.hasOwnProperty("type")&&o.type==="command";if(s){let c=[],l=o.settings;if(!l)return c;let u="",d=!1;for(let p of Object.keys(l))c.some(f=>f.command?.arguments&&f.command.arguments[0].includes(`@id:${p}`))||(u+=`@id:${p} `,t.hasSetting(p)||(d=!0));return u=u.trimEnd(),u&&c.push({command:{command:"workbench.action.openSettings",arguments:[u],title:WD.t("Show in Settings Editor")},showCodeBlock:!0,failedValidation:d,codeBlock:"```json\n"+JSON.stringify(l,null,2)+"\n```"}),c}else if(a){let c=o.commands.command;if(!c)return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let l=o.commands.args,u=[];if(c==="workbench.extensions.search"||c==="workbench.extensions.installExtension"){let d=(Array.isArray(l)?l:[l]).filter(p=>typeof p=="string");if(d.length===1){let p=["featured","popular","recentlyPublished","recommended","updates","builtin","enabled","disabled","installed","workspaceUnsupported"];d[0].includes(":")&&!d[0].startsWith("@")?d[0]=`@${d[0]}`:p.includes(d[0])&&(d[0]=`@${d[0]}`)}return u.push({command:{command:"workbench.extensions.search",arguments:d,title:WD.t("Search Extension Marketplace")},showCodeBlock:!1,failedValidation:!1}),u}else{let d=t.getCommand(c);if(!d)continue;return u.push({command:{command:"workbench.action.quickOpen",arguments:[`>${d.originalLabel??""}`],title:u.length>1?WD.t('Show "{0}"',d.originalLabel??""):WD.t("Show in Command Palette")},showCodeBlock:!1,failedValidation:!1}),u}}else return[{command:void 0,showCodeBlock:!0,failedValidation:!1}]}return[]}function dYe(){}var pX={};Pn(pX,{create:()=>pYe});function pYe(t){let e=t.get(ie);t.get(qe).ensureWorkspaceIsFullyLoaded().catch(r=>e.public.error(r))}var fYe=[..._me,pX,dX],xbe=fYe;var gX={};Pn(gX,{create:()=>mYe});var ax=require("vscode");var ys=require("vscode");async function C8(t,e,r){let n=t?.repositories;if(!n)return r.internal.debug("No git repositories found"),!1;let o=n.map(uC).filter(a=>a);return(await Promise.all(o.map(a=>{let[c,l]=a.split("/");return e.isAvailable(c,l)}))).every(a=>a)}var Ibe="github.copilotChat.signIn",Cbe="github.copilotChat.signInGHE",Tbe="github.copilotChat.signInChoose";async function Ebe(t,e){let r=t.get(Ho),n=t.get(Vl),o=t.get(Tt);if(await C8(r,n,t.get(ie))){await o.getAnyGitHubSession(e?{forceNewSession:!0}:{createIfNone:!0});return}await o.getPermissiveGitHubSession({forceNewSession:{learnMore:He.parse("https://aka.ms/copilotRepoScope")}})}async function fX(t,e){let r=t.get(he);if(r.getConfig(le.AuthProvider)!=="github")try{await r.setConfig(le.AuthProvider,"github")}catch(o){console.error(o)}await Ebe(t,e)}async function mX(t,e){let r=t.get(he);if(r.getConfig(le.AuthProvider)!=="github-enterprise")try{await r.setConfig(le.AuthProvider,"github-enterprise")}catch(a){console.error(a)}let o=ys.workspace.getConfiguration("github-enterprise");if(!o.get("uri")){let a=!1,c=await ys.window.showInputBox({prompt:ys.l10n.t("What is your GHE.com instance?"),placeHolder:ys.l10n.t('i.e. "octocat" or "https://octocat.ghe.com"...'),validateInput(u){if(a=!1,!!u){if(/^[a-zA-Z\-_]+$/.test(u))return a=!0,{message:ys.l10n.t({message:"Will resolve to {0}",args:[`https://${u}.ghe.com`],comment:"The {0} will be replaced with a URL"}),severity:ys.InputBoxValidationSeverity.Info};if(!/^(https:\/\/)?([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.ghe\.com\/?$/.test(u))return{message:ys.l10n.t('Please enter a valid GHE.com instance (i.e. "octocat" or "https://octocat.ghe.com")'),severity:ys.InputBoxValidationSeverity.Error}}}});if(!c)return;let l=c;a?l=`https://${l}.ghe.com`:c.toLowerCase().startsWith("https://")||(l="https://"+c),await o.update("uri",l,ys.ConfigurationTarget.Global)}await Ebe(t,e)}async function wbe(t,e){let r=await ys.window.showQuickPick([{label:ys.l10n.t("Sign in to GitHub.com"),providerId:"github"},{label:ys.l10n.t("Sign in to GHE.com"),providerId:"github-enterprise"}],{placeHolder:ys.l10n.t("Sign in to...")});r&&(r.providerId==="github"?await fX(t,e):await mX(t,e))}var T8=require("vscode");async function kbe(t){let e=new hX(t);return await e.run(),e}var hX=class{constructor(e){this.accessor=e;this.authenticationService=this.accessor.get(Tt);this.logService=this.accessor.get(ie);this.ghRepoService=this.accessor.get(Vl);this.gitService=this.accessor.safeGet(Ho);this.vscodeExtensionContext=this.accessor.get(Bt);this.disposables=new ht}async run(){await this.waitForChatEnabled(),!(!this.gitService||await C8(this.gitService,this.ghRepoService,this.logService)||(this.registerListeners(),await this.authenticationService.getPermissiveGitHubSession({silent:!0})))&&await this.showPrompt()}async waitForChatEnabled(){try{if((await this.authenticationService.getCopilotToken()).isChatEnabled())return}catch(e){this.logService.public.error(e,"Failed to get copilot token")}await Ol.toPromise(Ol.filter(this.authenticationService.onDidAuthenticationChange,()=>this.authenticationService.copilotToken?.isChatEnabled()??!1))}registerListeners(){this.disposables.add(this.authenticationService.onDidAuthenticationChange(async()=>{if(!this.authenticationService.permissiveGitHubSession)if(this.authenticationService.anyGitHubSession)await this.showPrompt();else{this.vscodeExtensionContext.globalState.update("copilot.shownPermissiveTokenModal",!1);return}}))}async showPrompt(){try{let e=this.vscodeExtensionContext.globalState.get("copilot.shownPermissiveTokenModal",!1),r={};e||(r.forceNewSession={detail:T8.l10n.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:T8.Uri.parse("https://aka.ms/copilotRepoScope")},this.vscodeExtensionContext.globalState.update("copilot.shownPermissiveTokenModal",!0)),await this.authenticationService.getPermissiveGitHubSession(r)&&this.logService.public.debug("Got permissive GitHub token")}catch(e){this.logService.public.error(e,"Failed to get permissive GitHub token"),await this.authenticationService.getPermissiveGitHubSession({})}}dispose(){this.disposables.dispose()}};function mYe(t){let e=t.get(Rt),r;return kbe(e).then(n=>r=n),ax.Disposable.from(ax.commands.registerCommand(Ibe,n=>fX(e,n)),ax.commands.registerCommand(Cbe,n=>mX(e,n)),ax.commands.registerCommand(Tbe,n=>wbe(e,n)),new ax.Disposable(()=>r?.dispose()))}var vX={};Pn(vX,{create:()=>xYe});var tu=q(require("vscode"));function ah(t){return He.isUri(t)}var hYe="vscode-chat-code-block",gYe=[/^\n```(typescript|javascript|tsx|jsx)\S*\nany\n```\n$/i],vYe=[new Set(["typescript","javascript","typescriptreact","javascriptreact"]),...Array.from(L_.keys(),t=>new Set([t]))],KD=class{constructor(e,r){this.accessor=e;this.telemetryService=r}async provideDefinition(e,r,n){return this.goTo("vscode.experimental.executeDefinitionProvider_recursive",e,r,n)}async provideImplementation(e,r,n){return this.goTo("vscode.experimental.executeImplementationProvider_recursive",e,r,n)}async provideTypeDefinition(e,r,n){return this.goTo("vscode.experimental.executeTypeDefinitionProvider_recursive",e,r,n)}async provideHover(e,r,n){let o=await this.execHover(e.uri,r),s=this.filterOutGenericHovers(o);if(s?.length)return this.convertHover(s);if(n.isCancellationRequested)return;let a=await this.getReferencesContext(e,r,n);if(!(!a||n.isCancellationRequested)){for(let c of a.wordMatches){let l=await this.execHover(c.uri,c.range.start);if(n.isCancellationRequested)return;if(l?.length)return this.convertHover(l)}return this.convertHover(o)}}async execHover(e,r){return tu.commands.executeCommand("vscode.experimental.executeHoverProvider_recursive",e,r)}convertHover(e){return e.length?new tu.Hover(e.flatMap(r=>r.contents),e[0].range):void 0}filterOutGenericHovers(e){return e.filter(r=>r.contents.some(n=>{if(typeof n=="string")return n.length;if(!n.value.length)return!1;for(let o of gYe)if(o.test(n.value))return!1;return!0}))}async goTo(e,r,n,o){let s=await gC(r.uri.fragment);if(o.isCancellationRequested)return;this.telemetryService.sendMSFTTelemetryEvent("codeBlock.action.goTo",{languageId:r.languageId,command:e,codeBlockId:s});let a=await this.executeGoToInChatBlocks(e,r,n);if(a?.length)return a;if(!o.isCancellationRequested)return this.executeGoToInChatReferences(e,r,n,o)}async executeGoToInChatBlocks(e,r,n){return(await this.executeGoTo(e,r.uri,n))?.map(s=>"uri"in s?{targetRange:s.range,targetUri:s.uri}:s)}async executeGoTo(e,r,n){return tu.commands.executeCommand(e,r,n)}async executeGoToInChatReferences(e,r,n,o){let s=await this.getReferencesContext(r,n,o);if(!(!s||o.isCancellationRequested))for(let a of s.wordMatches){let c=await this.executeGoTo(e,a.uri,a.range.start);if(o.isCancellationRequested)return;if(c)return c.map(l=>"uri"in l?{targetRange:l.range,targetUri:l.uri,originSelectionRange:s.wordRange}:{targetSelectionRange:l.targetSelectionRange,targetRange:l.targetRange,targetUri:l.targetUri,originSelectionRange:s.wordRange})}}async getReferencesContext(e,r,n){let o=this.getReferences(e);if(!o?.length)return;let s=e.getWordRangeAtPosition(r);if(!s)return;let a=e.getText(s),c=await b8(this.accessor,o,a,{},n);return{wordRange:s,wordMatches:c}}getReferences(e){let r=this.extractReferences(e),n=mn(e),o=bYe(n);return o?r.filter(s=>{let a=yYe(s);if(!a)return!1;let c=Ns(a);return!!o.has(c.languageId)}):r}extractReferences(e){try{let r=decodeURIComponent(e.uri.fragment);return JSON.parse(r).references.map(o=>"range"in o?new Bo.PromptReference(new fn(nr.from(o.uri),new Be(o.range.startLineNumber-1,o.range.startColumn-1,o.range.endLineNumber-1,o.range.endColumn-1))):new Bo.PromptReference(nr.from(o.uri)))}catch{return[]}}};KD=E([y(0,Rt),y(1,ge)],KD);function yYe(t){return ah(t.anchor)?t.anchor:"uri"in t.anchor?t.anchor.uri:"value"in t.anchor&&ah(t.anchor.value)?t.anchor.value:void 0}function bYe(t){return vYe.find(e=>e.has(t.languageId))}function Rbe(t){let e=t.get(j).createInstance(KD),r={scheme:hYe,exclusive:!0};return tu.Disposable.from(tu.languages.registerDefinitionProvider(r,e),tu.languages.registerTypeDefinitionProvider(r,e),tu.languages.registerImplementationProvider(r,e),tu.languages.registerHoverProvider(r,e))}function xYe(t){return Rbe(t)}var yX={};Pn(yX,{create:()=>SYe});var hl=require("vscode");var E8=ne("IContextResolverService"),CT=class extends Oe{constructor(r){super();this._instantiationService=r;this._initialized=!1;this._contextResolvers=new Map}get contextResolvers(){return this._initialize(),this._contextResolvers.values()}_initialize(){if(!this._initialized){this._initialized=!0;let r=jn.getContextResolverDescriptors();for(let n of r){let o=this._instantiationService.createInstance(n);this._contextResolvers.set(o.kind,o),G1(o)&&this._register(o)}}}};CT=E([y(0,j)],CT);var S0=ne("ChatVariableService"),TT=class{constructor(e,r){this._contextResolverService=r;this._variableEnablements=e.getConfigMixedWithDefaults(le.ConversationVariablesEnablements)}isVariableEnabled(e){return typeof this._variableEnablements[e.name]=="boolean"?this._variableEnablements[e.name]:typeof e.defaultEnablement=="boolean"?e.defaultEnablement:!!this._variableEnablements["*"]}getVariables(){let e=[];for(let r of this._contextResolverService.contextResolvers)r.variableInfo&&this.isVariableEnabled(r.variableInfo)&&e.push({name:r.variableInfo.name,fullName:r.variableInfo.fullName,icon:r.variableInfo.icon,kind:r.kind,description:r.variableInfo.description,registerTool:r.variableInfo.registerTool,resolve:r.resolveContext.bind(r)});return e}getVariable(e){return this.getVariables().find(r=>r.name===e)}};TT=E([y(0,he),y(1,E8)],TT);function SYe(t){let e=t.get(xe),r=t.get(S0),n=new ht;for(let o of r.getVariables())o.registerTool!=="canBeInvokedManually"&&n.add(hl.chat.registerChatVariableResolver(`copilot.${o.name}`,o.name,o.description??"",void 0,o.name==="codebase",{async resolve(s,a,c){return[]},resolve2:async(s,a,c,l)=>{let u={endpoint:await e.getChatEndpoint("gpt-3.5-turbo"),message:a.prompt},d={report(f){c.push(f)}},p=await o.resolve(u,l,d);return p?(p.references?.forEach(f=>{"variableName"in f.anchor||c.reference(f.anchor)}),[{level:hl.ChatVariableLevel.Full,value:p.userMessages.join(`

`),description:""}]):[]}},o.fullName,o.icon?new hl.ThemeIcon(o.icon):void 0));return n.add(IYe(t)),n}function IYe(t){return hl.Disposable.from(hl.commands.registerCommand("github.copilot.chat.attachSelection",()=>{hl.commands.executeCommand("workbench.action.chat.attachSelection")}),hl.commands.registerCommand("github.copilot.chat.attachFile",()=>{hl.commands.executeCommand("workbench.action.chat.attachFile")}))}var Oa=require("vscode");var Lbe=require("vscode");var I0=class{constructor(){this._inFlightPromises=new Map}getOrCreate(e,r){let n=this._inFlightPromises.get(e);if(n)return n;let o=r().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,o),o}};var ch=require("vscode");var Pbe="You are not signed in to GitHub. Please sign in to use Copilot.";function w8(t){return t.getConfig(le.AuthProvider)==="github-enterprise"?"github-enterprise":"github"}async function Abe(t,e,r,n={}){if(!(await ch.authentication.getAccounts(t)).length)return await ch.authentication.getSession(t,e,n);if(n.forceNewSession)return await ch.authentication.getSession(t,e,{...n,forceNewSession:n.forceNewSession,clearSessionPreference:!0});let s=await r();if(s)return s;if(n.createIfNone)return await ch.authentication.getSession(t,e,{forceNewSession:!0,clearSessionPreference:!0})}function k8(t,e){let r=w8(t);return Abe(r,rK,async()=>{let n=await ch.authentication.getSession(r,YF,{silent:!0});if(n)return n;let o=await ch.authentication.getSession(r,rK,{silent:!0});if(o)return o;let s=await ch.authentication.getSession(r,Zhe,{silent:!0});if(s)return s},e)}function Dbe(t,e){let r=w8(t);return Abe(r,YF,async()=>await ch.authentication.getSession(r,YF,{silent:!0}),e)}var Nbe=!1,YD=class extends Error{},QD=class extends Error{},XD=class extends Error{},JD=class extends Error{},ZD=class extends Error{},ET=class extends xI{constructor(r,n,o,s,a,c){super(new dv(o,s),r,n,o,s,a);this.configurationService=c;this._taskSingler=new I0}async getCopilotToken(r){if(!this.copilotToken||this.copilotToken.expires_at<fv()||r)try{this._logService.internal.debug(`Getting CopilotToken (force: ${r})...`),this.copilotToken=await this._authShowWarnings(),this._logService.internal.debug(`Got CopilotToken (force: ${r}).`)}catch(n){throw this._logService.internal.debug(`Getting CopilotToken (force: ${r}) threw error: ${n}`),this.copilotToken=void 0,n}return new T_(this.copilotToken)}async _auth(){let r=await k8(this.configurationService,{silent:!0});if(!r)return this._logService.public.warn("GitHub login failed"),this._telemetryService.sendGHTelemetryErrorEvent("auth.github_login_failed"),{kind:"failure",reason:"GitHubLoginFailed"};this._logService.public.info(`Logged in as ${r.account.label}`);let n=await this.authFromGitHubToken(r.accessToken);return n.kind==="success"&&this._logService.public.info(`Got Copilot token for ${r.account.label}`),n}async _authShowWarnings(){let r=await this._taskSingler.getOrCreate("auth",()=>this._auth());if(r.kind==="failure"&&r.reason==="NotAuthorized"){let n=r.message;if(n?.includes("No access to GitHub Copilot found"))throw new YD(n??"User not authorized");if(n?.includes("Your subscription has ended"))throw new QD(n);if(n?.includes("Contact Support."))throw new XD(n)}if(r.kind==="failure"){let n=r.message;if(n?.includes("Please contact your enterprise admin to enable your managed account for Copilot for Business"))throw new JD(n)}if(r.kind==="failure"&&r.reason==="HTTP401"){let n="Your GitHub token is invalid. Please sign out from your GitHub account using the VS Code accounts menu and try again.";throw Nbe||(Nbe=!0,Lbe.window.showWarningMessage(n)),Error(n)}if(r.kind==="failure"&&r.reason==="GitHubLoginFailed")throw Error("GitHubLoginFailed");if(r.kind==="failure"&&r.reason==="RateLimited")throw Error("Your account has exceeded GitHub's API rate limit. Please try again later.");if(r.kind==="failure")throw Error("Failed to get copilot token");if(r.kind==="success"&&r.chat_enabled===!1)throw new ZD("Copilot Chat is disabled");return r}};ET=E([y(0,ie),y(1,ge),y(2,en),y(3,Kr),y(4,gt),y(5,he)],ET);var C0={Activated:"github.copilot-chat.activated",Offline:"github.copilot.offline",IndividualDisabled:"github.copilot.interactiveSession.individual.disabled",IndividualExpired:"github.copilot.interactiveSession.individual.expired",ContactSupport:"github.copilot.interactiveSession.contactSupport",EnterpriseDisabled:"github.copilot.interactiveSession.enterprise.disabled",CopilotChatDisabled:"github.copilot.interactiveSession.chatDisabled"},CYe="github.copilot.chat.debug",wT=class extends Oe{constructor(r,n,o,s){super();this._authenticationService=r;this._telemetryService=n;this._fetcherService=o;this._logService=s;this._needsOfflineCheck=!1;this._inspectContext().catch(console.error),this._register(r.onDidAuthenticationChange(async()=>await this._inspectContext())),this._register(Oa.commands.registerCommand("github.copilot.offline",async()=>await this._inspectContext())),this._register({dispose:()=>this._cancelPendingOfflineCheck()}),this._register(Oa.window.onDidChangeWindowState(()=>this._runOfflineCheck("Window state change")))}_scheduleOfflineCheck(){this._cancelPendingOfflineCheck(),this._needsOfflineCheck=!0,this._logService.public.debug(`[context keys] Scheduling offline check. Active: ${Oa.window.state.active}, focused: ${Oa.window.state.focused}.`),Oa.window.state.active&&Oa.window.state.focused&&(this._scheduledOfflineCheck=setTimeout(()=>{this._scheduledOfflineCheck=void 0,this._runOfflineCheck("Scheduled offline check")},60*1e3).unref())}_runOfflineCheck(r){this._logService.public.debug(`[context keys] ${r}. Needs offline check: ${this._needsOfflineCheck}, active: ${Oa.window.state.active}, focused: ${Oa.window.state.focused}.`),this._needsOfflineCheck&&Oa.window.state.active&&Oa.window.state.focused&&this._inspectContext().catch(n=>this._logService.public.error(n))}_cancelPendingOfflineCheck(){this._needsOfflineCheck=!1,this._scheduledOfflineCheck&&(clearTimeout(this._scheduledOfflineCheck),this._scheduledOfflineCheck=void 0)}async _inspectContext(){this._logService.public.debug("[context keys] Updating context keys."),this._cancelPendingOfflineCheck();let r=Object.values(C0),n,o,s;try{let a=await this._authenticationService.getCopilotToken();s=!!(a.isInternal&&a.isVscodeTeamMember),o=C0.Activated}catch(a){n=a;let c=a.message||a,l=ci.createAndMarkAsIssued({reason:c});this._telemetryService.sendGHTelemetryErrorEvent("activationFailed",l.properties,l.measurements);let u=c==="GitHubLoginFailed"?Pbe:`GitHub Copilot could not connect to server. Extension activation failed: "${c}"`;this._logService.public.error(u)}n instanceof YD?o=C0.IndividualDisabled:n instanceof QD?o=C0.IndividualExpired:n instanceof JD?o=C0.EnterpriseDisabled:n instanceof XD?o=C0.ContactSupport:n instanceof ZD?o=C0.CopilotChatDisabled:this._fetcherService.isFetcherError(n)&&(o=C0.Offline,this._scheduleOfflineCheck()),o&&Oa.commands.executeCommand("setContext",o,!0),s!==void 0&&Oa.commands.executeCommand("setContext",CYe,s);for(let a of r)a!==o&&Oa.commands.executeCommand("setContext",a,!1)}};wT=E([y(0,Tt),y(1,ge),y(2,Kr),y(3,ie)],wT);var AT=q(require("vscode"));var T0=class extends Oe{constructor(r,n,o,s){super();this._initialText=r;this._document=n;this._workspaceService=o;this._diffService=s;this._additionalEdits=Or.empty;this._documentText=this._document.getText();this._register(this._workspaceService.onDidChangeTextDocument(a=>{if(a.document.uri.toString()!==this._document.uri.toString())return;let c=Or.from(a.contentChanges);this._additionalEdits=this._additionalEdits.compose(c)}))}async compute(){let r=await Or.fromDiff(this._initialText,this._documentText,this._diffService);return{getEditsSinceInitial:()=>{if(this._store.isDisposed)throw new yr("EditComputer has been disposed");return r.compose(this._additionalEdits)}}}};T0=E([y(2,qe),y(3,DC)],T0);var kT=class{constructor(e,r,n){this.instantiationService=e;this._tabsAndEditorsService=r;this._telemetryService=n;this.codeMapper=this.instantiationService.createInstance(c0)}async provideMappedEdits(e,r,n,o){let s=this._tabsAndEditorsService.visibleTextEditors.find(a=>od(a.document.uri,e.uri));if(s){let a=K_.fromEditor(s),c=new Q_(r[0],(r[0],n.conversation,void 0),a),l=await this.codeMapper.mapCode(c,void 0,o);if(!l)return;if(this.reportTelemetry(l,a),!l.errorMessage){let u=new S_;return u.set(e.uri,l.edits),u}throw new Error(l.errorMessage)}}reportTelemetry(e,r){if(!e.telemetry)return;let{endpoint:n,fetchResult:o,timeToComplete:s}=e.telemetry;if(this._telemetryService.sendMSFTTelemetryEvent("codemapper.request",{model:n.model,requestId:o.requestId,responseType:o.type,outcomeAnnotations:e.annotations?.map(a=>a.label).join(",")},{timeToComplete:s,editCount:e.edits.length}),e.edits.length){let a=this.instantiationService.createInstance($p,r.document.getText());a.addEdits(e.edits);let c=this.instantiationService.createInstance(T0,a.getText(),r.document);(async()=>{try{let[l,u]=await Promise.all([a.getEdits(),c.compute()]),d=u.getEditsSinceInitial(),p={requestId:o.requestId,command:"codemapper"};this.instantiationService.createInstance(zp,r.document,a.initialText,l,d,O6(p,void 0))}finally{c.dispose()}})()}}};kT=E([y(0,j),y(1,Ft),y(2,ge)],kT);var RT=class{constructor(e){this._codeMapperService=e}async provideMappedEdits(e,r,n){let o=await this._provideMappedEdits(e,r,n);return o?.errorMessage?{errorMessage:o.errorMessage}:null}async _provideMappedEdits(e,r,n){return await this._codeMapperService.mapCode(e,r,n)}};RT=E([y(0,QC)],RT);var TYe="chatEditingEnabled",PT=class extends Oe{constructor(e,r,n){super(),"registerMappedEditsProvider"in AT.chat&&this._register(AT.chat.registerMappedEditsProvider("*",e.createInstance(kT))),r.hasNewMappedEditsProviderAPI()&&this._register(AT.chat.registerMappedEditsProvider2(e.createInstance(RT)));let o=cs(this,n.onDidChangeConfiguration,()=>n.getConfig(le.PanelEditingEnabled));this._register(Ul(s=>{let a=o.read(s);AT.commands.executeCommand("setContext",TYe,a)}))}};PT=E([y(0,j),y(1,gt),y(2,he)],PT);var zo=q(require("vscode"));var P8=ne("IBlockedExtensionService"),R8=class{constructor(){this.blockedExtensions=new Map}reportBlockedExtension(e,r){this.blockedExtensions.has(e)&&clearTimeout(this.blockedExtensions.get(e));let n=setTimeout(()=>{this.blockedExtensions.delete(e)},r*1e3);this.blockedExtensions.set(e,n)}isExtensionBlocked(e){return this.blockedExtensions.has(e)}};var w0=q(Ue()),Obe=q(fF()),E0=q(require("vscode"));var eN=class extends w0.PromptElement{render(){let e=[],r=[];for(let n of this.props.messages)if(n.role===E0.LanguageModelChatMessageRole.System)e.push(n.content);else if(n.role===E0.LanguageModelChatMessageRole.Assistant){let o=n.content2.find(a=>typeof a=="string")??n.content,s=n.content2.filter(a=>a instanceof E0.LanguageModelChatResponseToolCallPart);r.push(vscpp(w0.AssistantMessage,{name:n.name,toolCalls:s.map(a=>({id:a.toolCallId,type:"function",function:{name:a.name,arguments:a.parameters}}))},o))}else n.role===E0.LanguageModelChatMessageRole.User&&n.content2.forEach(o=>{o instanceof E0.LanguageModelChatMessageToolResultPart?r.push(vscpp(Obe.ToolMessage,{toolCallId:o.toolCallId},o.content)):typeof o=="string"&&r.push(vscpp(w0.UserMessage,{name:n.name},o))});return vscpp(vscppf,null,vscpp(w0.SystemMessage,null,this.props.noSafety?e:vscpp(vscppf,null,vscpp(ct,null),vscpp(Jn,null),vscpp("br",null),e.join(`
`))),r)}};var DT=class{constructor(e,r,n,o,s,a){this._logService=e;this._instantiationService=r;this._authenticationService=n;this._endpointProvider=o;this._embeddingsComputer=s;this._vsCodeExtensionContext=a;this.id="languageModelAccess";this._store=new ht;if(this._vsCodeExtensionContext.extensionMode===nl.Test){this._logService.public.warn("[LanguageModelAccess] LanguageModels and Embeddings are NOT AVAILABLE in test mode.");return}this.activationBlocker=Promise.all([this._registerLanguageModels(),this._registerEmbeddings()])}dispose(){this._store.dispose()}async _registerLanguageModels(){let e=new Map,r=async()=>{let o=await this._getAuthSession(),s=new Map,a=o?await this._endpointProvider.getAllChatEndpoints():[],c=new Set;this._logService.public.debug("[LanguageModelAccess] UPDATING language models");let l=await this._endpointProvider.getChatEndpoint("gpt-4");for(let u of a){if(this._store.isDisposed)break;if(c.has(u.family))continue;c.add(u.family);let d=e.get(u.model);if(d){s.set(u.model,d);continue}let p=await Me.create(this._instantiationService,u,eN,{noSafety:!1,messages:[]}).countTokens(),f={vendor:"copilot",name:u.name,family:u.family,version:u.version,maxInputTokens:u.modelMaxPromptTokens-p-Phe,maxOutputTokens:4096/2,auth:o&&{label:o.account.label},isDefault:u.model===l.model,isUserSelectable:u.family.startsWith("o1")||u.family==="gpt-4o"},m=this._instantiationService.createInstance(tN,u,f),h=zo.chat.registerChatResponseProvider(u.model,m,f);s.set(u.model,{endpoint:u,dispo:h}),this._logService.public.debug(`[LanguageModelAccess] ADDED language model ${u.model}`)}for(let[u,d]of e)s.has(u)||(d.dispo.dispose(),this._logService.public.debug("[LanguageModelAccess] REMOVED language model "+u));e=s,this._store.isDisposed||(n=setTimeout(r,1e3*60*15))},n;await r(),this._store.add(this._authenticationService.onDidAuthenticationChange(()=>r())),this._store.add(Zi(()=>{clearInterval(n);for(let o of e.values())o.dispo.dispose()}))}async _registerEmbeddings(){let e=this._store.add(new Gg),r=async()=>{if(!await this._getAuthSession()){e.clear();return}let n=this._embeddingsComputer,o=await this._endpointProvider.getEmbeddingsEndpoint("ada");e.clear(),e.value=zo.lm.registerEmbeddingsProvider(`copilot.${o.model}`,new class{async provideEmbeddings(s,a){let c=await n.computeEmbeddings(o,s,{parallelism:2},a);if(!c)throw new Error("Failed to compute embeddings");return c.embeddings.map(l=>({values:l.slice(0)}))}})};this._store.add(this._authenticationService.onDidAuthenticationChange(()=>r())),await r()}async _getAuthSession(){try{await this._authenticationService.getCopilotToken()}catch(r){this._logService.public.warn("[LanguageModelAccess] LanguageModel/Embeddings are not available without auth token"),this._logService.public.error(r);return}let e=this._authenticationService.anyGitHubSession;if(!e){this._logService.public.error("[LanguageModelAccess] Auth token not present when we expected it to be");return}return e}};DT=E([y(0,ie),y(1,j),y(2,Tt),y(3,xe),y(4,oa),y(5,Bt)],DT);var tN=class extends Oe{constructor(r,n,o,s,a,c,l,u){super();this._endpoint=r;this._metadata=n;this._expService=o;this._telemetryService=s;this._chatMLFetcher=a;this._tokenizerProvider=c;this._blockedExtensionService=l;this._instantiationService=u;this._onDidReceiveLanguageModelResponse2=this._register(new Yt);this.onDidReceiveLanguageModelResponse2=this._onDidReceiveLanguageModelResponse2.event;this._register(this._chatMLFetcher.onDidMakeChatMLRequest(({model:d,source:p,tokenCount:f})=>{d===this._endpoint.model&&this._onDidReceiveLanguageModelResponse2.fire({extensionId:p?.extensionId??jm,tokenCount:f})}))}async _provideLanguageModelResponse(r,n,o,s,a){let c=zo.extensions.getExtension(o,!0);if(!c||typeof c.packageJSON.version!="string")throw new Error("Invalid extension information");let l=c.packageJSON.version,u=zo.l10n.t("The extension has been temporarily blocked due to making too many requests. Please try again later.");if(this._blockedExtensionService.isExtensionBlocked(o))throw zo.LanguageModelError.Blocked(u);let d=this._expService.getTreatmentVariable("vscode","copilotchat.languageModelControlList"),p=Mbe.extractCustomTokenLimit(d??"",o)??this._metadata.maxInputTokens,{messages:f,tokenCount:m}=await Me.create(this._instantiationService,this._endpoint,eN,{noSafety:!1,messages:r}).render();if(this._telemetryService.sendMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:l,model:this._endpoint.model},{tokenCount:m,tokenLimit:p}),f.length===0||m>p)throw new Error("Message exceeds token limit.");if(n.tools&&n.tools.length>128)throw new Error("Cannot have more than 128 tools per request.");if(n.toolChoice&&!n.tools?.some(_=>_.name===n.toolChoice))throw new Error("toolChoice not found in tools list.");let h=new Proxy(this._endpoint,{get:function(_,x,S){return x==="getExtraHeaders"?function(){return{..._.getExtraHeaders?.()??{},"x-onbehalf-extension-id":`${o}/${l}`}}:Reflect.get(_,x,S)}}),g=bX.Default.convert(n.modelOptions??{}),v={messageSource:`api.${o}`};g.tools=n.tools?.map(_=>({type:"function",function:{name:_.name,description:_.description,parameters:_.parametersSchema}})),g.tool_choice=n.toolChoice?{type:"function",function:{name:n.toolChoice}}:void 0;let b=await this._chatMLFetcher.fetchMany("copilotLanguageModelWrapper",f,s,a,3,h,{extensionId:o},g,v,{intent:!0});if(b.type!=="success")throw b.type==="extensionBlocked"?(this._blockedExtensionService.reportBlockedExtension(o,b.retryAfter),zo.LanguageModelError.Blocked(u)):new Error(b.reason);this._telemetryService.sendInternalMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:l,requestid:b.requestId,query:f[f.length-1].content,model:this._endpoint.model},{tokenCount:m,tokenLimit:p})}async provideLanguageModelResponse2(r,n,o,s,a){let c=async(l,u,d)=>{if(d.text&&s.report({index:u,part:new zo.LanguageModelChatResponseTextPart(d.text)}),d.copilotFunctionCalls)for(let p of d.copilotFunctionCalls)s.report({index:u,part:new zo.LanguageModelChatResponseToolCallPart(p.name,p.id,p.arguments)})};return this._provideLanguageModelResponse(r,n,o,c,a)}async provideLanguageModelResponse(r,n,o,s,a){let c=async(l,u,d)=>{s.report({index:u,part:d.text})};return this._provideLanguageModelResponse(r,{modelOptions:n},o,c,a)}async provideTokenCount(r){if(typeof r=="string")return this._tokenizerProvider.acquireTokenizer(this._endpoint).tokenLength(r);{let s={role:new Map([[zo.LanguageModelChatMessageRole.Assistant,"assistant"],[zo.LanguageModelChatMessageRole.User,"user"],[zo.LanguageModelChatMessageRole.System,"system"]]).get(r.role)??"user",content:r.content};return this._tokenizerProvider.acquireTokenizer(this._endpoint).countMessageTokens(s)}}};tN=E([y(2,Lt),y(3,ge),y(4,yt),y(5,_r),y(6,P8),y(7,j)],tN);var Mbe;(e=>{function t(r,n){let o=r.indexOf(n);if(o<0)return;let s=o+n.length,a=r.indexOf(",",s);a<0&&(a=r.length);let c=Number(r.substring(s,a));if(!isNaN(c))return c*1e3}e.extractCustomTokenLimit=t})(Mbe||={});function EYe(...t){return e=>t.some(r=>r(e))}var bX=class t{constructor(e){this._description=e}static{this._defaultDesc={stop:EYe(OM,UA),temperature:J1,max_tokens:J1,frequency_penalty:J1,presence_penalty:J1}}static{this.Default=new t({...this._defaultDesc})}convert(e){let r={};for(let n in this._description){let o=this._description[n],s=e[n];s!=null&&o(s)&&(r[n]=s)}return r}};var ef=q(require("vscode"));var NT=class extends Oe{constructor(e){super(),this._register(ef.commands.registerCommand("github.copilot.debug.workbenchState",async()=>{let r=await ef.window.showInputBox({prompt:"Enter a comma-separated list of symbol queries. Can be left blank if not using WorkspaceSymbols"}),n=await ef.window.showInputBox({prompt:"Enter a file name - .state.json will be appended as the extension",value:"workspaceState"});if(!n)return;let o=await e.createInstance(cx).captureWorkspaceStateSnapshot(r?.split(",")??[]),s=ef.workspace.workspaceFolders?.[0].uri;if(!s)return;let a=ef.Uri.joinPath(s,`${n}.state.json`),c=JSON.stringify(o,null,2);c=c.replace(new RegExp(`${s.fsPath}/`,"g"),"./"),ef.workspace.fs.writeFile(a,Buffer.from(c))}))}};NT=E([y(0,j)],NT);var cx=class{constructor(e,r,n,o,s,a,c){this.tabAndEditorsService=e;this.languageDiagnosticService=r;this.languageService=n;this.workspaceService=o;this.terminalService=s;this.debugOutputService=a;this.gitService=c}async captureWorkspaceStateSnapshot(e){let r=this.workspaceService.getWorkspaceFolders().map(d=>d.fsPath+"/"),n=this.workspaceService.notebookDocuments.map(d=>d.uri.fsPath),s=(await Promise.all(e.map(d=>this.languageService.getWorkspaceSymbols(d)))).flat().map(d=>({name:d.name,kind:d.kind,containerName:d.containerName,filePath:d.location.uri.fsPath,start:d.location.range.start,end:d.location.range.end})),a=this.tabAndEditorsService.activeTextEditor?this.languageDiagnosticService.getDiagnostics(this.tabAndEditorsService.activeTextEditor.document.uri).map(d=>({start:d.range.start,end:d.range.end,message:d.message,severity:d.severity,relatedInformation:d.relatedInformation?.map(wYe)})):[],c=this.tabAndEditorsService.activeTextEditor?{selections:this.tabAndEditorsService.activeTextEditor?.selections.map(d=>({anchor:d.anchor,active:d.active,isReversed:d.isReversed}))??[],documentFilePath:this.tabAndEditorsService.activeTextEditor?.document.uri.fsPath??"",visibleRanges:this.tabAndEditorsService.activeTextEditor?.visibleRanges.map(d=>({start:d.start,end:d.end}))??[],languageId:this.tabAndEditorsService.activeTextEditor?.document.languageId??"javascript"}:void 0,l=this.terminalService.terminalLastCommand?{commandLine:this.terminalService.terminalLastCommand.commandLine,cwd:typeof this.terminalService.terminalLastCommand.cwd=="object"?this.terminalService.terminalLastCommand.cwd.toString():this.terminalService.terminalLastCommand.cwd,exitCode:this.terminalService.terminalLastCommand.exitCode,output:this.terminalService.terminalLastCommand.output}:void 0;return{workspaceFoldersFilePaths:r,symbols:s,activeFileDiagnostics:a,activeTextEditor:c,debugConsoleOutput:this.debugOutputService.consoleOutput,terminalBuffer:this.terminalService.terminalBuffer,terminalLastCommand:l,terminalSelection:this.terminalService.terminalSelection,terminalShellType:this.terminalService.terminalShellType,repoContexts:this.gitService.repositories,notebookDocumentFilePaths:n,activeNotebookEditor:void 0}}};cx=E([y(0,Ft),y(1,Vi),y(2,jo),y(3,qe),y(4,ui),y(5,ST),y(6,Ho)],cx);function wYe(t){return{filePath:t.location.uri.fsPath,start:t.location.range.start,end:t.location.range.end,message:t.message}}var F8=q(require("path")),nN=q(require("util")),Qe=require("vscode");var A8=class{constructor(){this.logprobs=[];this.top_logprobs=[];this.text=[];this.newText=[];this.tokens=[];this.text_offset=[]}append(e){e.text&&(this.text.push(e.text),this.newText.push(e.text)),e.delta?.content&&(this.text.push(e.delta.content),this.newText.push(e.delta.content)),e.delta?.function_call&&(this.text.push(e.delta.function_call.arguments),this.newText.push(e.delta.function_call.arguments)),e.logprobs&&(this.tokens.push(e.logprobs.tokens??[]),this.text_offset.push(e.logprobs.text_offset??[]),this.logprobs.push(e.logprobs.token_logprobs??[]),this.top_logprobs.push(e.logprobs.top_logprobs??[]))}flush(){let e=this.newText.join("");return this.newText=[],e}},_X=class{constructor(e){this.index=e;this.arguments=""}update(e){e.id&&(this.id=e.id),e.function?.name&&(this.name=e.function.name),e.function?.arguments&&(this.arguments+=e.function.arguments)}},xX=class{constructor(){this.toolCalls=new Map}getToolCalls(){return Array.from(this.toolCalls.values()).map(e=>({name:e.name,arguments:e.arguments,id:e.id}))}hasToolCalls(){return this.toolCalls.size>0}update(e){e.delta?.tool_calls?.forEach(r=>{let n=this.toolCalls.get(r.index);n||(n=new _X(r.index),this.toolCalls.set(r.index,n)),n.update(r)})}};function kYe(t){let e=t.split(`
`),r=e.pop();return[e.filter(n=>n!==""),r]}var D8=class t{constructor(e,r,n,o,s,a){this.logService=e;this.telemetryService=r;this.expectedNumChoices=n;this.response=o;this.body=s;this.cancellationToken=a;this.requestId=UI(this.response);this.stats=new SX(this.expectedNumChoices);this.solutions={};this.completedFunctionCallIdxs=new Map;this.functionCalls={};this.toolCalls=new xX;this.functionCallName=void 0}static async create(e,r,n,o,s){let a=await o.body();return a.setEncoding("utf8"),new t(e,r,n,o,a,s)}async*processSSE(e=async()=>{}){try{yield*this.processSSEInner(e)}finally{this.cancel(),this.logService.public.info(`request done: requestId: [${this.requestId.headerRequestId}] model deployment ID: [${this.requestId.deploymentId}]`),this.logService.internal.debug(`request stats: ${this.stats}`)}}async*processSSEInner(e){let r="",n=!1;e:for await(let o of this.body){if(this.maybeCancel("after awaiting body chunk"))return;let[s,a]=kYe(r+o.toString());r=a;let c=!1;for(let l of s){let u=l.slice(5).trim();if(u==="[DONE]"){yield*this.finishSolutions();return}let d;try{d=JSON.parse(u)}catch{this.logService.public.error(`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:${l}`),lh(this.telemetryService,`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:`,l);continue}if(d.copilot_confirmation&&RYe(d.copilot_confirmation)&&await e("",0,{text:"",copilotConfirmation:d.copilot_confirmation}),!d.choices){!d.copilot_references&&!d.copilot_confirmation&&(d.error!==void 0?(this.logService.public.error(`Error in response for request id ${this.requestId.headerRequestId}:${d.error.message}`),lh(this.telemetryService,`Error in response for request id ${this.requestId.headerRequestId}:`,d.error.message)):(this.logService.public.error(`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`),lh(this.telemetryService,`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`))),d.copilot_errors&&await e("",0,{text:"",copilotErrors:d.copilot_errors}),d.copilot_references&&await e("",0,{text:"",copilotReferences:d.copilot_references});continue}if(this.requestId.created===0&&(this.requestId=UI(this.response,d),this.requestId.created===0&&d.choices?.length&&(this.logService.public.error(`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)} ${this.requestId}`),lh(this.telemetryService,`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)}`,this.requestId))),this.allSolutionsDone())break e;for(let p=0;p<d.choices.length;p++){let f=d.choices[p],m={...f};delete m.index,delete m.content_filter_results,delete m.content_filter_offsets,this.logService.internal.trace("choice "+JSON.stringify(m)),this.stats.add(f.index),f.index in this.solutions||(this.solutions[f.index]=new A8);let h=this.solutions[f.index];if(h===null)continue;let g,v=async(_,x,S,I,w)=>(_&&(!Array.isArray(_)||!_.every(k=>Fve(k)))&&(_=void 0),x&&(!Array.isArray(x)||!x.every(Uve))&&(x=void 0),g=await e(h.text.join(""),f.index,{text:h.flush(),codeVulnAnnotations:_,ipCitations:x,copilotReferences:S,copilotFunctionCalls:I,copilotErrors:w}),g!==void 0&&(n=!0),this.maybeCancel("after awaiting finishedCb"));if(f.delta?.copilot_annotations?.CodeVulnerability||f.delta?.copilot_annotations?.IPCodeCitations){if(await v()||!n&&(h.append(f),await v(f.delta.copilot_annotations.CodeVulnerability,f.delta?.copilot_annotations?.IPCodeCitations)))continue}else if(f.delta?.role==="function"){if(f.delta.content)try{let _=JSON.parse(f.delta.content);if(Array.isArray(_)&&await v(void 0,void 0,_))continue}catch(_){this.logService.public.error(`Error parsing function references: ${JSON.stringify(_)}`)}}else if(f.delta?.function_call)c=!0,this.functionCallName??=f.delta.function_call.name,this.functionCalls[this.functionCallName]??=new A8,this.functionCalls[this.functionCallName].append(f);else if(f.delta?.tool_calls)c=!0,this.toolCalls.update(f);else if((f.finish_reason==="function_call"||f.finish_reason==="stop")&&this.functionCallName){let _=this.functionCalls[this.functionCallName],x={name:this.functionCallName,arguments:_.flush()};this.completedFunctionCallIdxs.set(f.index,"function");try{if(await v(void 0,void 0,void 0,[x]))continue}catch(S){this.logService.public.error(S)}this.functionCalls[this.functionCallName]=null,this.functionCallName=void 0;continue}else if((f.finish_reason==="tool_calls"||f.finish_reason==="stop")&&this.toolCalls.hasToolCalls()){let _=this.toolCalls.getToolCalls();this.completedFunctionCallIdxs.set(f.index,"tool");try{if(await v(void 0,void 0,void 0,_))continue}catch(x){this.logService.public.error(x)}continue}else if(h.append(f),await v())continue;if(f.finish_reason||g!==void 0){if(this.stats.markYielded(f.index),yield{solution:h,finishOffset:g,reason:f.finish_reason??"client-trimmed",filterReason:PYe(f),requestId:this.requestId,index:f.index},this.maybeCancel("after yielding finished choice"))return;c||(this.solutions[f.index]=null)}}}}for(let[o,s]of Object.entries(this.solutions)){let a=Number(o);if(s!==null&&(this.stats.markYielded(a),yield{solution:s,finishOffset:void 0,reason:"Iteration Done",requestId:this.requestId,index:a},this.maybeCancel("after yielding after iteration done")))return}if(r.length>0&&!n)try{let o=JSON.parse(r);o.error!==void 0&&(this.logService.public.error(o.error,`Error in response: ${o.error.message}`),lh(this.telemetryService,`Error in response: ${o.error.message}`,o.error))}catch{this.logService.public.error(`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${r}`),lh(this.telemetryService,`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${r}`)}}async*finishSolutions(){for(let[e,r]of Object.entries(this.solutions)){let n=Number(e);if(r!==null){if(this.completedFunctionCallIdxs.has(n)){yield{solution:r,finishOffset:void 0,reason:this.completedFunctionCallIdxs.get(n)==="function"?"function_call":"tool_calls",requestId:this.requestId,index:n};continue}if(this.stats.markYielded(n),yield{solution:r,finishOffset:void 0,reason:"DONE",requestId:this.requestId,index:n},this.maybeCancel("after yielding on DONE"))return}}}maybeCancel(e){return this.cancellationToken?.isCancellationRequested?(this.logService.public.debug("Cancelled: "+e),this.cancel(),!0):!1}cancel(){this.body.destroy()}allSolutionsDone(){let e=Object.values(this.solutions);return e.length===this.expectedNumChoices&&e.every(r=>r===null)}};function RYe(t){return typeof t.title=="string"&&typeof t.message=="string"&&!!t.confirmation}function Ube(t){let r={text:t.text.join(""),tokens:t.text};if(t.logprobs.length===0)return r;let n=t.logprobs.reduce((c,l)=>c.concat(l),[]),o=t.top_logprobs.reduce((c,l)=>c.concat(l),[]),s=t.text_offset.reduce((c,l)=>c.concat(l),[]),a=t.tokens.reduce((c,l)=>c.concat(l),[]);return{...r,logprobs:{token_logprobs:n,top_logprobs:o,text_offset:s,tokens:a}}}function PYe(t){if(t.finish_reason==="content_filter"){if(t.delta?.copilot_annotations?.TextCopyright)return"snippy";if(t.delta?.copilot_annotations?.Sexual||t.delta?.copilot_annotations?.SexualPattern)return"sexual";if(t.delta?.copilot_annotations?.Violence)return"violence";if(t.delta?.copilot_annotations?.HateSpeech||t.delta?.copilot_annotations?.HateSpeechPattern)return"hate";if(t.delta?.copilot_annotations?.SelfHarm)return"self_harm";if(t.delta?.copilot_annotations?.PromptPromBlockList)return"prompt";if(t.content_filter_results){for(let e of Object.keys(t.content_filter_results))if(t.content_filter_results[e]?.filtered)return e}}}var SX=class{constructor(e){this.choices=new Map;for(let r=0;r<e;r++)this.choices.set(r,new rN)}add(e){let r=this.choices.get(e)??new rN;r.increment(),this.choices.set(e,r)}markYielded(e){let r=this.choices.get(e)??new rN;r.markYielded(),this.choices.set(e,r)}toString(){return Array.from(this.choices.entries()).map(([e,r])=>`${e}: ${r.yieldedTokens} -> ${r.seenTokens}`).join(", ")}},rN=class{constructor(){this.yieldedTokens=-1;this.seenTokens=0}increment(){this.seenTokens++}markYielded(){this.yieldedTokens=this.seenTokens}};function lh(t,e,r){let n=[e,r],o=n.length>0?JSON.stringify(n):"no msg",s=ci.createAndMarkAsIssued({context:"fetch",level:aF[5],message:o});t.sendRestrictedGHTelemetryErrorEvent("log",s.properties,s.measurements);let a=ci.createAndMarkAsIssued({context:"fetch",level:aF[5],message:"[redacted]"});t.sendGHTelemetryErrorEvent("log",a.properties,a.measurements)}function IX(t,e,r){let n=r.extendedBy({messagesJson:JSON.stringify(e)});t.sendRestrictedGHTelemetryEvent("engine.messages",n.properties,n.measurements)}function AYe(t,e,r,n,o,s,a,c,l){return IX(t,[e],l),{message:e,choiceIndex:n,requestId:o,blockFinished:s,finishReason:a,filterReason:c,tokens:r.tokens,numTokens:r.tokens.length,telemetryData:l}}function Bbe(t,e,r,n){let o=r.solution.text.join(""),s=!1;r.finishOffset!==void 0&&(e.internal.debug(`message ${r.index}: early finish at offset ${r.finishOffset}`),o=o.substring(0,r.finishOffset),s=!0),e.public.info(`message ${r.index} returned. finish reason: [${r.reason}]`),e.internal.debug(`message ${r.index} details: finishOffset: [${r.finishOffset}] completionId: [{${r.requestId.completionId}}] created: [{${r.requestId.created}}]`);let a=Ube(r.solution),c={role:"assistant",content:o};return AYe(t,c,a,r.index,r.requestId,s,r.reason,r.filterReason,n)}function qbe(t,e,r,n){let s=t.copilotToken?.isInternal??!1?e.getConfig(le.DebugOverrideChatMaxTokenNum):0,a=-3;if(s>0)return a+=s,a;let c={};try{let l=r.getTreatmentVariable("vscode","copilotchat.contextWindows");c=JSON.parse(l??"{}")}catch{}if(c[n.id])return a+=c[n.id],a;if(n.capabilities?.limits?.max_prompt_tokens)return a+=n.capabilities.limits.max_prompt_tokens,a;switch(n.id){case"gpt-3.5-turbo":a+=7168;break;case"gpt-4o-2024-05-13":a+=3072;break;default:a+=3072}return a}async function NYe(t,e,r,n,o,s,a){let l=(await D8.create(e,t,n,r,a)).processSSE(o);return Xn.map(l,d=>{let p=d.reason??"client-trimmed",f=s.extendedBy({completionChoiceFinishReason:p,headerRequestId:d.requestId.headerRequestId});return t.sendGHTelemetryEvent("completion.finishReason",f.properties,f.measurements),Bbe(t,e,d,s)})}var LT=class{constructor(e,r,n,o){this.domainService=e;this.disableSnippy=n;this.urlOverride=o;this._maxTokens=r.capabilities.limits?.max_prompt_tokens??8192,this.model=r.id,this.name=r.name,this.version=r.version,this.family=r.capabilities.family}get modelMaxPromptTokens(){return this._maxTokens}get url(){return this.urlOverride??this.domainService.capiChatURL}interceptBody(e){if(e&&this.disableSnippy&&(e.snippy={enabled:!1},Object.keys(e).forEach(r=>{r.startsWith("intent")&&delete e[r]})),e&&this.family.startsWith("o1")){let r=e.messages.map(n=>n.role==="system"?{role:"user",content:n.content}:n);Object.keys(e).forEach(n=>{delete e[n]}),e.messages=r,e.model=this.model,e.stream=!1}}getExtraHeaders(){let e={};return this.disableSnippy&&(e["Editor-Plugin-Version"]="simulation-tests-plugin/2",e["Editor-Version"]="simulation-tests-editor/1.85"),e}async processResponseFromChatEndpoint(e,r,n,o,s,a,c){if(this.family.startsWith("o1")){let l=await n.json(),u=l.choices[0].message,d=n.headers.get("X-Request-ID")??ir(),p={blockFinished:!1,choiceIndex:0,filterReason:void 0,finishReason:"stop",message:u,numTokens:l.usage.completion_tokens,tokens:u.content.split(" "),requestId:{headerRequestId:d,completionId:l.id,created:l.created,deploymentId:"",serverExperiments:""},telemetryData:a};return await s(u.content,0,{text:u.content}),Xn.fromArray([p])}else return NYe(e,r,n,o,s,a,c)}};var N8=ne("IPromptVariablesService");var wd=q(require("vscode"));var L8=ne("IFeedbackReporter"),CX=class{async reportInline(e,r,n){}async reportChat(e){}},Svr=new CX;var MT=ne("IUserFeedbackService"),OT=class{constructor(e,r,n,o,s,a){this.telemetryService=e;this.conversationStore=r;this.feedbackReporter=n;this.surveyService=o;this.languageDiagnosticsService=s;this.instantiationService=a}handleUserAction(e,r){let n=wd.window.activeTextEditor?.document,o=wd.window.activeTextEditor?.selection,s=e.result,a=s.metadata?.responseId&&this.conversationStore.getConversation(s.metadata.responseId);if(typeof a=="object"&&a.getLatestTurn()?.intentInvocation?.location===1){this._handleInlineChatUserAction(s.metadata?.sessionId,r,a,e,void 0);return}switch(e.action.kind){case"copy":this.telemetryService.sendMSFTTelemetryEvent("panel.action.copy",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,copyType:e.action.copyKind,characterCount:e.action.copiedCharacters,lineCount:e.action.copiedText.split(`
`).length});break;case"insert":this.telemetryService.sendMSFTTelemetryEvent("panel.action.insert",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,characterCount:e.action.totalCharacters,newFile:e.action.newFile?1:0});break;case"runInTerminal":this.telemetryService.sendMSFTTelemetryEvent("panel.action.runinterminal",{languageId:n?.languageId,requestId:s.metadata?.responseId,blockLanguage:e.action.languageId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex});break;case"followUp":this.telemetryService.sendMSFTTelemetryEvent("panel.action.followup",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command});break;case"bug":a?this.feedbackReporter.reportChat(a.getLatestTurn()):wd.window.showInformationMessage("Conversation not found, is it restored? Please try again.");break}if(e.action.kind==="copy"||e.action.kind==="insert"){let c={};c={totalCharacters:e.action.totalCharacters},e.action.kind==="copy"&&(c={...c,copiedCharacters:e.action.copiedCharacters}),n&&o&&(c={...c,cursorLocation:n.offsetAt(o.active)}),Zv(this.telemetryService,wd.window.activeTextEditor?.document,{codeBlockIndex:e.action.codeBlockIndex.toString(),messageId:s.metadata?.modelMessageId??"",headerRequestId:s.metadata?.responseId??"",participant:r},c,e.action.kind==="copy"?"conversation.acceptedCopy":"conversation.acceptedInsert")}}handleFeedback(e,r){let n=wd.window.activeTextEditor?.document,o=e.result,s=o.metadata?.responseId&&this.conversationStore.getConversation(o.metadata.responseId);if(typeof s=="object"&&s.getLatestTurn()?.inlineResponseInfo){this._handleInlineChatUserAction(o.metadata?.sessionId,r,s,void 0,e);return}this.telemetryService.sendMSFTTelemetryEvent("panel.action.vote",{languageId:n?.languageId,requestId:o.metadata?.responseId,participant:r,command:o.metadata?.command,reason:e.unhelpfulReason},{direction:e.kind===wd.ChatResultFeedbackKind.Helpful?1:2}),Zv(this.telemetryService,n,{rating:e.kind===wd.ChatResultFeedbackKind.Helpful?"positive":"negative",messageId:o.metadata?.modelMessageId??"",headerRequestId:o.metadata?.responseId??"",reason:e.unhelpfulReason??""},{},"conversation.messageRating")}_handleInlineChatUserAction(e,r,n,o,s){if(!e)return;let a=n.getLatestTurn()?.inlineResponseInfo;if(!a)return;let c;if(o?.action.kind==="editor"?c=o.action.accepted?3:2:o?.action.kind==="bug"?c=4:s?.kind===wd.ChatResultFeedbackKind.Helpful?c=1:s?.kind===wd.ChatResultFeedbackKind.Unhelpful&&(c=0),c===void 0)return;if(c===4&&n){this.feedbackReporter.reportInline(n,a.promptQuery,a.interactionOutcome);return}let l={messageId:a.messageId},u,{selection:d,wholeRange:p,intent:f,query:m}=a.promptQuery,h=n?.getLatestTurn()?.requestId??"",g=f?.id,v=a.promptQuery.document.languageId,b=g==="fix"?Z6(d,this.languageDiagnosticsService.getDiagnostics(a.promptQuery.document.uri)):void 0,_=er(a.promptQuery.document.uri)?1:0;this.surveyService.signalUsage(`inline.${g??"default"}`,v);let x={languageId:v,replyType:a.interactionOutcome.kind,conversationId:e,requestId:h,command:g},S=a.telemetry?.editCount??0,I=a.telemetry?.editLineCount??0,w={selectionLineCount:d?Math.abs(d.end.line-d.start.line):-1,wholeRangeLineCount:p?Math.abs(p.end.line-p.start.line):-1,editCount:S>0?S:-1,editLineCount:I>0?I:-1,isNotebook:_,problemsCount:b?.fileDiagnosticsTelemetry.problemsCount??0,selectionProblemsCount:b?.selectionDiagnosticsTelemetry.problemsCount??0,diagnosticsCount:b?.fileDiagnosticsTelemetry.diagnosticsCount??0,selectionDiagnosticsCount:b?.selectionDiagnosticsTelemetry.diagnosticsCount??0},k=(M,H)=>{this.telemetryService.sendInternalMSFTTelemetryEvent(M,{language:v,intent:g,query:m,conversationId:e,requestId:h,replyType:a.interactionOutcome.kind,problems:b?.fileDiagnosticsTelemetry.problems??"",selectionProblems:b?.selectionDiagnosticsTelemetry.problems??"",diagnosticCodes:b?.fileDiagnosticsTelemetry.diagnosticCodes??"",selectionDiagnosticCodes:b?.selectionDiagnosticsTelemetry.diagnosticCodes??""},{isNotebook:_,...H})};if(c===3&&a.aiEditCollector){let M=a.aiEditCollector,H=this.instantiationService.createInstance(T0,a.aiEditCollector.getText(),a.promptQuery.document);(async()=>{try{let[F,ue]=await Promise.all([M.getEdits(),H.compute()]),Z=ue.getEditsSinceInitial();this.instantiationService.createInstance(zp,a.promptQuery.document,M.initialText,F,Z,O6(x,w))}finally{H.dispose()}})()}if(a.aiEditCollector=void 0,c===1||c===0){let M=c===1?1:0;this.telemetryService.sendMSFTTelemetryEvent("inline.action.vote",{...x,reason:s?.unhelpfulReason},{...w,vote:M}),k("interactiveSessionVote",{vote:M})}else if(c===2||c===3){let M=c===3?1:0;this.telemetryService.sendMSFTTelemetryEvent("inline.done",x,{...w,accepted:M}),k("interactiveSessionDone",{accepted:M})}switch(c){case 1:l.rating="positive",u="inlineConversation.messageRating";break;case 0:l.rating="negative",u="inlineConversation.messageRating";break;case 2:l.action="undo",u="inlineConversation.undo";break;case 3:l.action="accept",u="inlineConversation.accept";break;case 4:u="";break}u&&Zv(this.telemetryService,a.promptQuery.document,l,{},u)}};OT=E([y(0,ge),y(1,Qp),y(2,L8),y(3,p0),y(4,Vi),y(5,j)],OT);var FT=new Map,iN=class{constructor(e){this.label=e;this.iconPath=new Qe.ThemeIcon("lock")}},LYe=Qe.l10n.t("Sign in again to {0}","GitHub"),O8="github",M8="platform",jbe={web:"bing-search",kb:"kb-search"},TX="kb:",Vbe="github.copilot.chat.selectKnowledgeBase",UT=class{constructor(e,r,n,o,s,a,c,l,u,d,p,f,m,h,g){this.logService=e;this.fetcherService=r;this.envService=n;this.promptVariablesService=o;this.workspaceService=s;this.tabsAndEditorsService=a;this.ignoreService=c;this.gitService=l;this.githubRepositoryService=u;this.chatMLFetcher=d;this.vscodeExtensionContext=p;this.authenticationService=f;this.domainService=m;this.userFeedbackService=h;this.configurationService=g;this.disposables=new ht;this.knowledgeBases=null;this.organizationsMissingSSO=void 0;this.disposables.add(new Qe.Disposable(()=>FT.forEach(v=>v.dispose()))),this.disposables.add(Qe.commands.registerCommand(Vbe,async()=>{let v=Qe.window.createQuickPick();v.placeholder=Qe.l10n.t("Select a knowledge base"),v.busy=!0,v.show(),v.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(),v.busy=!1;let b=await new Promise((_,x)=>{v.canSelectMany=!1;let S=!1;v.onDidAccept(async()=>{if(v.selectedItems[0]instanceof iN){v.busy=!0;let I=await this.authenticationService.getPermissiveGitHubSession({forceNewSession:!0});if(!I){this.logService.public.error("Failed to get a new auth session for knowledge base selection"),_(void 0),v.hide();return}if(S=!0,this.organizationsMissingSSO=void 0,this.knowledgeBases?.clear(),v.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(I.accessToken),v.items.length===1&&v.items[0]instanceof iN){this.logService.public.error("Failed to fetch new knowledge bases after fetching new auth session"),_(void 0),v.hide();return}v.busy=!1,v.show()}else _(v.selectedItems[0]),v.hide()}),v.onDidHide(()=>{S||_(void 0)})});return v.dispose(),b?.insertText})),this.refreshRemoteAgents(),this.disposables.add(this.authenticationService.onDidAccessTokenChange(()=>{this.refreshRemoteAgents()}))}dispose(){this.disposables.dispose()}async refreshRemoteAgents(){return this.refreshRemoteAgentsP||(this.refreshRemoteAgentsP=this._doRefreshRemoteAgents()),this.refreshRemoteAgentsP.finally(()=>this.refreshRemoteAgentsP=void 0)}async _doRefreshRemoteAgents(){let e=new Set(FT.keys());try{let r=this.authenticationService.anyGitHubSession?.accessToken;if(!r){this.logService.public.warn("Unable to fetch remote agents because user is not signed in.");return}try{e.delete(M8)||(this.logService.public.info("Registering default platform agent..."),FT.set(M8,this.registerAgent(null)))}catch(a){this.logService.public.info(`Encountered error while registering platform agent: ${JSON.stringify(a)}`)}let o=await(await this.fetcherService.fetch(this.domainService.remoteAgentsURL,{method:"GET",headers:{Authorization:nN.format("Bearer %s",r),...this.envService.getEditorVersionHeaders()}})).text(),s;try{if(s=JSON.parse(o).agents,!Array.isArray(s))throw new Error("Expected 'agents' to be an array")}catch(a){o.includes("access denied")||this.logService.public.warn(`Invalid remote agent response: ${o} (${a})`);return}for(let a of s)e.delete(a.slug)||FT.set(a.slug,this.registerAgent(a))}catch(r){this.logService.public.error(r,"Failed to load remote slash commands")}for(let r of e)FT.get(r).dispose(),FT.delete(r)}checkAuthorized(e){if(e===O8)return!0;if(!this.configurationService.getConfig(le.EnableImplicitContext))return!1;let r=`copilot.agent.${e}.authorized`;return this.vscodeExtensionContext.globalState.get(r,!1)||this.vscodeExtensionContext.workspaceState.get(r,!1)}async setAuthorized(e,r=!1){await(r?this.vscodeExtensionContext.globalState:this.vscodeExtensionContext.workspaceState).update(`copilot.agent.${e}.authorized`,!0)}registerAgent(e){let r=new ht,n=`github.copilot-dynamic.${e?.slug??M8}`,o=e?.slug??O8,s=e?.description??Qe.l10n.t("Get answers grounded in web search, code search, and your enterprise's knowledge bases"),a={name:o,description:s,publisherName:e?.owner_login??"GitHub",fullName:e?.name??"GitHub"},c=!1,l=r.add(Qe.chat.createDynamicChatParticipant(n,a,async(u,d,p,f)=>{let m=FYe(d),h=ir(),g=ir(),v={sessionId:m,modelMessageId:g,responseId:h,agentId:n,command:u.command};if(u.acceptedConfirmationData)for(let _ of u.acceptedConfirmationData){if(_?.ssoSignIn)return await this.authenticationService.getPermissiveGitHubSession({forceNewSession:!0}),p.markdown(Qe.l10n.t("Please complete the sign-in process in your browser.")),{metadata:v};if(_?.url)return await this.setAuthorized(o,u.prompt.startsWith(Qe.l10n.t("Authorize for all workspaces"))),await Qe.commands.executeCommand("vscode.open",nr.parse(_.url)),p.markdown(Qe.l10n.t("Please complete authorization in your browser and resend your question.")),{metadata:v};if(_?.hasAcknowledgedImplicitReferences)return await this.setAuthorized(o,u.prompt.startsWith(Qe.l10n.t("Allow for All Workspaces"))),p.markdown(Qe.l10n.t("Your preference has been saved.")),{metadata:v}}let b=this.authenticationService.anyGitHubSession?.accessToken;e?.slug||(b=this.authenticationService.permissiveGitHubSession?.accessToken??(await this.authenticationService.getPermissiveGitHubSession({createIfNone:!0}))?.accessToken);try{let _=new LT(this.domainService,{capabilities:{type:"chat",family:"remote"},id:"gpt-3.5-turbo",name:"Remote Agents",version:"1.0"},void 0,e?`${this.domainService.remoteAgentsURL}/${e.slug}?chat`:`${this.domainService.remoteAgentsURL}/chat`),x=await this.promptVariablesService.resolveVariablesInPrompt(u.prompt,u.references),S=[],{copilot_skills:I,copilot_references:w}=await this.resolveCopilotSkills(o,u);w&&S.push(...w);let k=!1;try{let B=await this.prepareClientPlatformReferences([...u.references],o);k=B.hasIgnoredFiles,B.clientReferences&&S.push(...B.clientReferences);for(let U of B.vscodeReferences)p.reference(U)}catch(B){return B instanceof Error&&B.message.includes("File seems to be binary and cannot be opened as text")?(p.markdown(Qe.l10n.t("Sorry, binary files are not currently supported.")),{metadata:v}):{errorDetails:{message:B.message},metadata:v}}let M=new Map,H=[],F=OYe(u),ue,Z,V=!1,A,P=await this.chatMLFetcher.fetchMany("remoteAgent",[...MYe(n,d),{role:"user",content:u.acceptedConfirmationData?.length||u.rejectedConfirmationData?.length?"":x.message,...S.length?{copilot_references:S}:void 0,copilot_confirmations:F?.length?F:void 0}],async(B,U,$)=>{if($.copilotReferences){let W=(Y,Se)=>{let ee="url"in Y?Y.url:"url"in Y.data?Y.data.url:"html_url"in Y.data?Y.data.html_url:void 0;if(ee&&typeof ee=="string"){if(!M.has(ee)){let Ie;Bve(Y)?Ie=nr.joinPath(this.vscodeExtensionContext.extensionUri,"assets","bing.svg"):new URL(ee).hostname==="github.com"?Ie=new Qe.ThemeIcon("github"):Ie=new Qe.ThemeIcon("globe"),ue?ue?.report(new Qe.ChatResponseReferencePart(nr.parse(ee),Ie)):p.reference(nr.parse(ee),Ie),M.set(ee,Se??Y)}}else if(Y.metadata){let Ie=Y.metadata.display_icon?nr.parse(Y.metadata.display_icon):new Qe.ThemeIcon("globe"),Xe=Y.metadata.display_url?nr.parse(Y.metadata.display_url):Y.metadata.display_name;ue?ue.report(new qF(Xe,Ie)):p.reference2(Xe,Ie),M.set(Y.metadata.display_url??Y.metadata.display_name,Se??Y)}};for(let Y of $.copilotReferences)if(Array.isArray(Y.data.results))Y.data.results.forEach(Se=>{W(Se,Y)});else if(Y.data.type==="github.agent")H.push(Y);else{if(Y.type==="github.text")continue;("html_url"in Y.data||"url"in Y.data&&typeof Y.data.url=="string"||Y.metadata)&&W(Y)}}let ce=(W,Y)=>{Z?.deferred.complete(Z.resolvedMessage),ue=W;let Se=new Om;return Z={deferred:Se,resolvedMessage:Y},Se.p};if($.copilotFunctionCalls)for(let W of $.copilotFunctionCalls)switch(W.name){case"bing-search":{try{let Y=JSON.parse(W.arguments);p.progress(Qe.l10n.t('Searching Bing for "{0}"...',Y.query),async Se=>ce(Se,Qe.l10n.t('Bing search results for "{0}"',Y.query)))}catch{}break}case"kb-search":{try{let Y=JSON.parse(W.arguments);p.progress(Qe.l10n.t('Searching knowledge base for "{0}"...',Y.query),async Se=>ce(Se,Qe.l10n.t('Knowledge base results for "{0}"',Y.query)))}catch{}break}case"codesearch":{try{let Y=JSON.parse(W.arguments);p.progress(Qe.l10n.t('Searching {0} for "{1}"...',Y.scopingQuery,Y.query),async Se=>ce(Se,Qe.l10n.t('Code search results for "{0}" in {1}',Y.query,Y.scopingQuery)))}catch{}break}}if($.copilotErrors&&typeof p.warning=="function"){V=!0;for(let W of $.copilotErrors)W.code==="sso"?A=W.identifier:ue?ue?.report(new Qe.ChatResponseWarningPart(W.message)):p.warning(W.message)}if($.copilotConfirmation){V=!0;let W=$.copilotConfirmation;p.confirmation(W.title,W.message,W.confirmation)}if($.text){Z?.deferred.complete(Z.resolvedMessage);let W=new Qe.MarkdownString($.text);W.supportHtml=!0,p.markdown(W)}},f,2,_,void 0,{secretKey:b,copilot_thread_id:m,...I?{copilot_skills:I}:void 0},{messageSource:`serverAgent.${e?.slug??M8}`});if(v.copilot_references=[...new Set(M.values()).values(),...H],P.type==="success"&&k&&p.markdown(Qe.l10n.t(zM)),A&&b){let B=this.updateMissingSSOOrganizationInfo(A,b),U=B?Qe.l10n.t("Please grant permission to read resources protected by SSO in the {0} organization.",B):Qe.l10n.t("Please grant permission to read resources protected by SSO.");p.confirmation(LYe,U,{ssoSignIn:!0},[Qe.l10n.t("Sign In")])}if(P.type!=="success"){if(this.logService.internal.warn(`Bad response from /agents/${o}: ${P.type} ${P.reason}`),P.reason.includes("400 no docs found"))return{errorDetails:{message:"No docs found"},metadata:v};if(P.type==="agent_unauthorized"){let B=new URL(P.authorizationUrl),U=e?.editor_context?Qe.l10n.t("**@{0}** will read your active file and selection.",o)+`
`:"";return p.confirmation(Qe.l10n.t("Authorize agent"),U+Qe.l10n.t("Please authorize usage of **@{0}** on {1} and resend your question.",o,B.hostname),{url:P.authorizationUrl},[Qe.l10n.t("Authorize"),Qe.l10n.t("Authorize for All Workspaces")]),{metadata:v,nextQuestion:{prompt:u.prompt,participant:n,command:u.command}}}else{if(P.type==="agent_failed_dependency")return{errorDetails:{message:Qe.l10n.t("Sorry, an error occurred: {0}",P.reason)},metadata:v};if(P.type!=="unknown"||!V)return{errorDetails:{message:P.reason},metadata:v}}}return!this.checkAuthorized(o)&&e?.editor_context&&!c&&(p.confirmation(Qe.l10n.t("Grant access to editor context"),Qe.l10n.t("**@{0}** would like to read your active file and selection.",o),{hasAcknowledgedImplicitReferences:!0},[Qe.l10n.t("Allow"),Qe.l10n.t("Allow for All Workspaces")]),c=!0),{metadata:v}}catch(_){return this.logService.public.error(`/agents/${o} failed: ${_}`),{metadata:v}}}));return l.iconPath=e?nr.parse(e.avatar_url):new Qe.ThemeIcon("github"),o===O8&&(l.participantVariableProvider={triggerCharacters:["#"],provider:{provideCompletionItems:async(u,d)=>(await this.getPlatformAgentSkills()).map(f=>{let m=new Qe.ChatCompletionItem(`copilot.${f.name}`,"#"+f.name,[{value:f.insertText,level:Qe.ChatVariableLevel.Full,description:f.description}]);return m.command=f.command,m.detail=f.description,m.fullName=f.fullName,m.icon=f.icon,m})}}),r.add(l.onDidReceiveFeedback(u=>this.userFeedbackService.handleFeedback(u,n))),r}async prepareClientPlatformReferences(e,r){let n=[],o=[],s=!1,a=!1,c=async(p,f)=>{let m=F8.basename(p.uri.toString()),h=p.getText(f);return await this.ignoreService.isCopilotIgnored(p.uri)?(s=!0,h="content-exclusion"):m.startsWith(".")?h="hidden-file":Buffer.byteLength(h,"utf8")>1024**3&&(h="file-too-large"),h},l=async(p,f,m)=>{n.push({type:"client.file",data:{language:p.languageId,content:await c(p)},is_implicit:!!m,id:F8.basename(p.uri.path)}),o.push(f?{variableName:f,value:p.uri}:p.uri)},u=async(p,f,m=!1,h)=>{let g=p.selection.start.line,v=p.selection.isEmpty?new Qe.Range(new Qe.Position(g,0),new Qe.Position(g+1,0)):p.selection;n.push({type:"client.selection",data:{start:{line:v.start.line,col:v.start.character},end:{line:v.end.line,col:v.end.character},content:await c(p.document,v)},is_implicit:!!h,id:F8.basename(p.document.uri.path)}),m&&o.push(f?{variableName:f,value:new Qe.Location(p.document.uri,v)}:new Qe.Location(p.document.uri,v))};if(this.checkAuthorized(r)){let{activeTextEditor:p}=this.tabsAndEditorsService;p&&(await l(p.document,void 0,!0),await u(p,void 0,void 0,!0),a=!0)}for(let p of e)if(p.value instanceof nr){let f=await this.workspaceService.openTextDocument(p.value);await l(f,p.name)}else if(p.name==="selection"){let{activeTextEditor:f}=this.tabsAndEditorsService;if(!f)throw new Error(Qe.l10n.t({message:"Please open a text editor to use the `#selection` variable.",comment:"{Locked='`#selection`'}"}));a||await u(f,p.name,!0)}else p.name==="editor"&&this.tabsAndEditorsService.activeTextEditor&&await l(this.tabsAndEditorsService.activeTextEditor.document,p.name);this.gitService.isInitialized||await this.gitService.initialize();let d=this.gitService.repositories;for(let p of d){let f=uC(p);if(f)try{let[m,h]=f?.split("/"),g=await this.githubRepositoryService.getRepositoryInfo(m,h);n.push({type:"github.repository",id:f,data:{type:"repository",name:h,ownerLogin:m,id:g.id}})}catch(m){m instanceof Error&&m.message.includes("Failed to fetch repository info")&&this.authenticationService.getPermissiveGitHubSession({silent:!0}),this.logService.public.error(m,"Failed to fetch info about current GitHub repository")}}return{clientReferences:n,vscodeReferences:o,hasIgnoredFiles:s}}async listEnabledSkills(e){if(!this.enabledSkillsPromise){let r=await this.fetcherService.fetch(this.domainService.listSkillsURL,{method:"GET",headers:{Authorization:nN.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}});this.enabledSkillsPromise=r.json().then(n=>n?.skills.reduce((o,s)=>o.add(s.slug),new Set))}return this.enabledSkillsPromise}async resolveCopilotSkills(e,r){if(e===O8){let n=new Set,o=new Set;for(let s of r.references)if(jbe[s.name])n.add(jbe[s.name]);else if(s.name.startsWith(TX)){n.add("kb-search"),await this.getKnowledgeBases();let a=this.knowledgeBases?.get(s.name.slice(TX.length));a&&o.add(a)}return{copilot_skills:[...n],copilot_references:[...o]}}return{copilot_skills:[]}}async updateMissingSSOOrganizationInfo(e,r){let n=e?.split("partial-results; organizations=")[1];if(n){let o=n.split(",");this.logService.public.debug(`Missing knowledge bases SSO for ${o.length} organizations: ${n}`);let s=await this.getOrganizationName(r,parseInt(o[0]));return s?this.organizationsMissingSSO={name:s,numberOfOrganizations:o.length}:this.organizationsMissingSSO={name:void 0,numberOfOrganizations:o.length},s}}async getKnowledgeBases(e){if(this.knowledgeBases?.size)return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO};let r=e??(await this.authenticationService.getPermissiveGitHubSession({createIfNone:!0}))?.accessToken;if(!r)return this.logService.public.debug("No auth token available to fetch knowledge bases"),{knowledgeBases:[],organizationsMissingSSO:void 0};let n=await this.listKnowledgeBases(r),o=await n.text(),s=n.headers.get("X-GitHub-SSO");s&&this.updateMissingSSOOrganizationInfo(s,r);try{let a=JSON.parse(o);this.knowledgeBases=new Map;let c=a.map(l=>({label:l.name,organization:l.owner.login,iconPath:new Qe.ThemeIcon("github"),insertText:l.name,name:l.name,description:l.description,type:"github.knowledge-base",id:ir(),data:{type:"knowledge-base",id:l.id}}));for(let l of c)this.knowledgeBases.set(l.name,l);return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO}}catch(a){return this.logService.public.error(a),{knowledgeBases:[],organizationsMissingSSO:this.organizationsMissingSSO}}}async getOrganizationName(e,r){let n=await this.fetcherService.fetch(`https://api.github.com/user/${r}`,{method:"GET",headers:{Authorization:nN.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}});if(n.ok)return(await n.json()).name}async listKnowledgeBases(e){return this.fetcherService.fetch("https://api.github.com/user/knowledge-bases",{method:"GET",headers:{Authorization:nN.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}})}async getKnowledgeBaseAutocompleteQuickPickItems(e){let{knowledgeBases:r,organizationsMissingSSO:n}=await this.getKnowledgeBases(e),o=[];if(n){let a;n.name&&n.numberOfOrganizations>1?a=Qe.l10n.t("Single-sign on to see knowledge bases from {0} and {1} other organizations",n.name,n.numberOfOrganizations-1):n.name?a=Qe.l10n.t("Single-sign on to see knowledge bases from the {0} organization",n.name):n.numberOfOrganizations===1?a=Qe.l10n.t("Single-sign on to see knowledge bases from 1 additional organization"):a=Qe.l10n.t("Single-sign on to see knowledge bases from {0} additional organizations",n.numberOfOrganizations),o.push(new iN(a)),o.push({kind:Qe.QuickPickItemKind.Separator,label:""})}let s=new Map;for(let a of r){let c=a.organization;s.has(c)||s.set(c,[]),s.get(c)?.push(a)}for(let a of[...s.keys()].sort()){let c=s.get(a);c?.length&&(o.push({kind:Qe.QuickPickItemKind.Separator,label:a}),o.push(...c.sort((l,u)=>l.label.localeCompare(u.label))))}return o}async getPlatformAgentSkills(){let e=this.authenticationService.anyGitHubSession?.accessToken;if(!e)return[];let r=await this.listEnabledSkills(e);return[{name:"web",insertText:"#web",description:"Search Bing for real-time context",kind:"bing-search",command:void 0},{name:"kb",insertText:`#${TX}`,icon:new Qe.ThemeIcon("book"),fullName:"Knowledge Bases...",description:"Search your enterprises' knowledge bases",kind:"kb-search",command:{title:"",command:Vbe}}].filter(n=>r.has(n.kind))}};UT=E([y(0,ie),y(1,Kr),y(2,gt),y(3,N8),y(4,qe),y(5,Ft),y(6,Te),y(7,Ho),y(8,Vl),y(9,yt),y(10,Bt),y(11,Tt),y(12,en),y(13,MT),y(14,he)],UT);function OYe(t){return[...t.acceptedConfirmationData?.map(r=>({state:"accepted",confirmation:r}))??[],...t.rejectedConfirmationData?.map(r=>({state:"dismissed",confirmation:r}))??[]]}function MYe(t,e){let r=[];for(let n of e.history)if(n.participant===t&&(n instanceof Qe.ChatRequestTurn&&r.push({role:"user",content:n.prompt}),n instanceof Qe.ChatResponseTurn)){let o=n.result.metadata?.copilot_references,s=n.response.map(a=>a instanceof Qe.ChatResponseMarkdownPart?a.value.value:"content"in a?a.content:null).filter(a=>!!a).join("");r.push({role:"assistant",content:s,...o?{copilot_references:o}:void 0})}return r}function FYe(t){let e;for(let r of t.history)if(r instanceof Qe.ChatResponseTurn){let n=r.result.metadata?.sessionId;if(typeof n=="string"){e=n;break}}return e??ir()}var EX=q(require("vscode"));var U8=class extends Oe{constructor(){super(),this._register(EX.commands.registerCommand("github.copilot.open.walkthrough",()=>{EX.commands.executeCommand("workbench.action.openWalkthrough",{category:"GitHub.copilot#copilotWelcome"},!1)}))}};var Co=q(require("vscode"));var wX;(n=>{let t=new Map;t.set("typescript",new Set(["abstract","any","as","asserts","async","await","bigint","boolean","break","case","catch","class","const","continue","constructor","debugger","declare","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","implements","import","in","infer","instanceof","interface","is","keyof","let","module","namespace","never","new","null","number","object","of","package","private","protected","public","readonly","require","return","set","static","string","super","switch","symbol","this","throw","true","try","type","typeof","undefined","unique","unknown","var","void","while","with","yield"])),t.set("javascript",new Set(["async","await","break","case","catch","class","const","continue","constructor","debugger","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","import","in","instanceof","interface","is","let","new","null","require","return","set","static","string","super","switch","symbol","this","throw","true","try","type","typeof","undefined","var","void","while","with","yield"]));function e(o,s){let a=t.get(o.languageId),c=[],l=o.lineAt(s),u=l.firstNonWhitespaceCharacterIndex,d=u;for(;u<l.range.end.character;){let p=new Co.Position(s.line,u),f=o.getWordRangeAtPosition(p);if(!f){u+=1;continue}let m=f.start.character,h=f.end.character;if(m!==d){let v=l.text.substring(d,m);c.push({type:v.match(/^\s+$/)?"space":"other",value:v})}let g=l.text.substring(m,h);c.push({type:a?.has(g)?"keyword":"word",value:g}),u=h+1,d=h}return c}function r(o,s,a){let c=e(o,s),l=0,u=0,d=0,p=0;for(let f=0;f<c.length;f++)switch(c[f].type){case"keyword":u+=1;break;case"word":l+=1;break;case"space":d+=1;break;case"other":p+=1;break}return a?.public.trace("[ChatTrigger] "+JSON.stringify({wordCount:l,keywordCount:u,spaceCount:d,otherCount:p,tokenCount:c.length})),!(c.length<4||d<2||u>=l||p>d)}n.isMostlyNaturalLanguage=r})(wX||={});var oN=class{constructor(e){this._logService=e}async provideCompletionItems(e,r){let n=e.lineAt(r);if(n.isEmptyOrWhitespace||r.character<n.range.end.character||!wX.isMostlyNaturalLanguage(e,r,this._logService))return;let o=new Co.CompletionItem({label:n.text.trim(),description:"Trigger Inline Chat"});return o.kind=Co.CompletionItemKind.Event,o.command={command:"inlineChat.startWithCurrentLine",title:"Trigger Inline Chat"},o.range=n.range.with(n.range.start.with(void 0,n.firstNonWhitespaceCharacterIndex)),o.filterText=n.text.substring(n.firstNonWhitespaceCharacterIndex),new Co.CompletionList([o],!0)}};oN=E([y(0,ie)],oN);var sN=class{constructor(e,r){this._logService=e;this._store=new ht;this._sessionStore=new ht;this._deco=Co.window.createTextEditorDecorationType({opacity:".6",after:{contentText:"\xA0".repeat(10)+"Press Cmd+I to continue with Github Copilot...",fontStyle:"italic",color:"var(--vscode-editorGhostText-foreground)"}}),this._store.add(Co.window.onDidChangeActiveTextEditor(()=>this._update())),this._update()}dispose(){this._deco.dispose(),this._store.dispose()}_update(){this._sessionStore.clear();let e=Co.window.activeTextEditor;!e||!e.viewColumn||Co.languages.match(Hbe,e.document)&&(this._sessionStore.add(Co.window.onDidChangeTextEditorSelection(r=>{if(r.textEditor!==e)return;let n=[],o=e.document.lineAt(e.selection.active.line).range;r.kind===Co.TextEditorSelectionChangeKind.Keyboard&&e.selection.isSingleLine&&o.end.character-e.selection.active.character<4&&wX.isMostlyNaturalLanguage(e.document,e.selection.active,this._logService)&&n.push(o),e.setDecorations(this._deco,n),Co.commands.executeCommand("setContext","github.copilot.chat.editor.enableLineTrigger",n.length>0)})),this._sessionStore.add(Zi(()=>{e.setDecorations(this._deco,[])})))}};sN=E([y(0,ie),y(1,Bt)],sN);var Hbe=["typescript","typescriptreact","javascript","javascriptreact"],BT=class{constructor(e,r){this._store=new ht;let n=this._store.add(new Gg),o=this._store.add(new Gg),s=()=>{if(r.getConfig(le.InlineChatCompletionsTrigger)){let a=e.createInstance(oN);n.value=Co.languages.registerCompletionItemProvider(Hbe,a)}else n.clear();r.getConfig(le.InlineChatHint)?o.value=e.createInstance(sN):o.clear()};this._store.add(r.onDidChangeConfiguration(a=>{(a.affectsConfiguration(le.InlineChatCompletionsTrigger.fullyQualifiedId)||a.affectsConfiguration(le.InlineChatHint.fullyQualifiedId))&&s()})),s()}dispose(){this._store.dispose()}};BT=E([y(0,j),y(1,he)],BT);var hh=require("vscode");var ru=class t{constructor(e){this.edits=e}static{this.empty=new t([])}static create(e){return new t(e)}static single(e){return new t([e])}static replace(e,r){return new t([tf.replace(e,r)])}static fromOffsetEdit(e){return new t(e.edits.map(r=>tf.replace(r.replaceRange,r.newText)))}toOffsetEdit(){return new Or(this.edits.map(e=>new Ii(e.range,e.newText)))}compose(e){let r=this.toOffsetEdit().compose(e.toOffsetEdit());return t.fromOffsetEdit(r)}getNewRanges(){return this.toOffsetEdit().getNewTextRanges()}apply(e){let r="",n=0;for(let o of this.edits)r+=e.substring(n,o.range.start),r+=o.newText,n=o.range.endExclusive;return r+=e.substring(n),r}normalize(){let e=[],r;for(let n of this.edits)n.newText.length===0&&n.range.length===0||(r&&r.range.endExclusive===n.range.start?r=tf.replace(r.range.join(n.range),r.newText+n.newText):(r&&e.push(r),r=n));return r&&e.push(r),new t(e)}toString(){return this.edits.map(e=>e.toString()).join("")}decompose(){let e=[],r=0;for(let n of this.edits)e.push(t.replace(St.ofStartAndLength(n.range.start+r,n.range.length),n.newText)),r+=n.newText.length-n.range.length;return e}getRange(){if(this.edits.length!==0)return this.edits[0].range.join(this.edits[this.edits.length-1].range)}isEmpty(){return this.edits.length===0}},tf=class t{constructor(e,r){this.range=e;this.newText=r}static replace(e,r){return new t(e,r)}static insert(e,r){return new t(new St(e,e),r)}static delete(e){return new t(e,"")}toString(){return`${this.range}->${JSON.stringify(this.newText)}`}},k0=class{constructor(e,r){this.base=e;this.edit=r}getEditedState(){return this.base.apply(this.edit)}rebase(e){return tv(()=>null.base.equals(this.base.apply(e))),tv(()=>null.base.apply(null.edit).equals(this.base.apply(e).apply(this.edit))),null}toString(){return`==RootedEdit.Base==
${this.base}
==Edit==
${this.edit}
`}};var R0=class t{constructor(e){this.value=e}apply(e){return new t(e.apply(this.value))}equals(e){return this.value===e.value}getTransformer(){return this._transformer||(this._transformer=new kX(this.value)),this._transformer}getValueOfRange(e){return this.getTransformer().getOffsetRange(e).substring(this.value)}getLines(){return rd(this.value)}toString(){return this.value}},kX=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineEndOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let r=0;r<e.length;r++)e.charAt(r)===`
`&&(this.lineStartOffsetByLineIdx.push(r+1),r>0&&e.charAt(r-1)==="\r"?this.lineEndOffsetByLineIdx.push(r-1):this.lineEndOffsetByLineIdx.push(r));this.lineEndOffsetByLineIdx.push(e.length)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new St(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let r=td(this.lineStartOffsetByLineIdx,s=>s<=e),n=r+1,o=e-this.lineStartOffsetByLineIdx[r]+1;return new Ut(n,o)}getRange(e){return je.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Km.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Km(e,this.text.length-this.lineStartOffsetByLineIdx[e])}getLineLength(e){return this.lineEndOffsetByLineIdx[e-1]-this.lineStartOffsetByLineIdx[e-1]}};var PSe=q(kSe());function ON(){return Date.now()}function RSe(t,e){return t.endLineNumberExclusive<=e.startLineNumber?e.startLineNumber-t.endLineNumberExclusive:e.endLineNumberExclusive<=t.startLineNumber?t.startLineNumber-e.endLineNumberExclusive:0}var D9=class{constructor(e,r){this.filePath=e;this.version=r;this.time=ON();this._isEmpty=!0;this._inputEdit=void 0;this._resultEdit=void 0;this.prompt=void 0;this.isCachedResult=void 0;this.error=void 0;this.responseResults=void 0}toLogDocument(){let e=[];if(e.push("# "+this.getDebugName()),this._inputEdit&&(e.push("## User Edit"),e.push(`<details open><summary>Edit</summary>
`),e.push("``` patch"),e.push(this._inputEdit.toString()),e.push("```"),e.push(`
</details>
`)),this._resultEdit&&(e.push(`## Computed Next Edit ${this.isCachedResult===void 0?"":this.isCachedResult?"(cached)":"(not cached)"}`),e.push(`<details open><summary>Edit</summary>
`),e.push("``` patch"),e.push(this._resultEdit.toString()),e.push("```"),e.push(`
</details>
`)),this.prompt){e.push("## Prompt"),e.push(`<details open><summary>Value</summary>
`);let r=this.prompt;e.push("```"),e.push(...r.split(`
`)),e.push("```"),e.push(`
</details>
`)}return this.error&&(e.push("## Error"),e.push("```"),e.push(String(this.error)),this.error instanceof Error&&(e.push(""),e.push(String(this.error.stack))),e.push("```")),this.responseResults&&(e.push("## Response Results"),e.push(`<details open><summary>Value</summary>
`),e.push("```"),e.push(PSe.stringify(this.responseResults,null,"	")),e.push("```"),e.push(`
</details>
`)),e.join(`
`)}get isEmpty(){return this._isEmpty}setRequestInput(e){this._isEmpty=!1,this._inputEdit=e}setResult(e){this._isEmpty=!1,this._resultEdit=e}setIsCachedResult(e){this._isEmpty=!1,this.isCachedResult=e}setPrompt(e){this._isEmpty=!1,this.prompt=e}setError(e){this._isEmpty=!1,this.error=e}getError(){return this.error}setResponseResults(e){this._isEmpty=!1,this.responseResults=e}getDebugName(){return`Inline Edit ${this.version} | ${set(this.filePath)}`}};function set(t){let e=Math.max(t.lastIndexOf("/"),t.lastIndexOf("\\"));return e===-1?t:t.slice(e+1)}var N9=class{constructor(){this._documentState=new Map}handleDocumentOpened(e,r){this._documentState.set(e,new lZ(r.value))}handleEdit(e,r){this._documentState.get(e).handleEdit(r)}handleDocumentClosed(e){this._documentState.delete(e)}getRecentEdit(e){let r=this._documentState.get(e);if(r)return r.getRecentEdit()}},lZ=class{constructor(e){this.edits=[];this.baseValue=e}handleEdit(e){this.edits.push({edit:e,instant:ON()})}getRecentEdit(){return this._applyStaleEdits(),new k0(new R0(this.baseValue),this._composeEdits())}_composeEdits(){let e=ru.empty;for(let r of this.edits)e=e.compose(r.edit);return e}_applyStaleEdits(){for(;this.edits.length>0;){let e=this.edits[0];if(ON()-e.instant<5*1e3)break;this.baseValue=e.edit.apply(this.baseValue),this.edits.shift()}}};var JT=ne("INesFetchService");var MN=class t{constructor(e){this._value=ZM(this,void 0);this.promiseResult=this._value;this.promise=e.then(r=>(__(n=>{this._value.set(new FN(r,void 0),n)}),r),r=>{throw __(n=>{this._value.set(new FN(void 0,r),n)}),r})}static fromFn(e){return new t(e())}},FN=class{constructor(e,r){this.data=e;this.error=r}getDataOrThrow(){if(this.error)throw this.error;return this.data}};function uZ(t,e,r,n){return e||(e=o=>o!=null),new Promise((o,s)=>{let a=!0,c=!1,l=t.map(d=>({isFinished:e(d),error:r?r(d):!1,state:d})),u=Ul(d=>{let{isFinished:p,error:f,state:m}=l.read(d);(p||f)&&(a?c=!0:u.dispose(),f?s(f===!0?m:f):o(m))});if(n){let d=n.onCancellationRequested(()=>{u.dispose(),d.dispose(),s(new dn)});if(n.isCancellationRequested){u.dispose(),d.dispose(),s(new dn);return}}a=!1,c&&u.dispose()})}var aet=!1;aet&&cme(new QM);var LSe=q(require("assert"));var Yr=class t{static fromRange(e){return new t(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new t(e.startLineNumber,e.endLineNumber+1)}static subtract(e,r){return r?e.startLineNumber<r.startLineNumber&&r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(e.startLineNumber,r.startLineNumber),new t(r.endLineNumberExclusive,e.endLineNumberExclusive)]:r.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=r.endLineNumberExclusive?[]:r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(Math.max(r.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new t(e.startLineNumber,Math.min(r.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let r=new L9(e[0].slice());for(let n=1;n<e.length;n++)r=r.getUnion(new L9(e[n].slice()));return r.ranges}static join(e){if(e.length===0)throw new yr("lineRanges cannot be empty");let r=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let o=1;o<e.length;o++)r=Math.min(r,e[o].startLineNumber),n=Math.max(n,e[o].endLineNumberExclusive);return new t(r,n)}static ofLength(e,r){return new t(e,e+r)}static deserialize(e){return new t(e[0],e[1])}constructor(e,r){if(e>r)throw new yr(`startLineNumber ${e} cannot be after endLineNumberExclusive ${r}`);this.startLineNumber=e,this.endLineNumberExclusive=r}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new t(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new t(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new t(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let r=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(r<=n)return new t(r,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new je(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new je(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let r=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.startLineNumber;r<this.endLineNumberExclusive;r++)e(r)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new St(this.startLineNumber-1,this.endLineNumberExclusive-1)}},L9=class t{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let r=B1(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),n=td(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)this._normalizedRanges.splice(r,0,e);else if(r===n-1){let o=this._normalizedRanges[r];this._normalizedRanges[r]=o.join(e)}else{let o=this._normalizedRanges[r].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(r,n-r,o)}}contains(e){let r=P$(this._normalizedRanges,n=>n.startLineNumber<=e);return!!r&&r.endLineNumberExclusive>e}intersects(e){let r=P$(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!r&&r.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let r=[],n=0,o=0,s=null;for(;n<this._normalizedRanges.length||o<e._normalizedRanges.length;){let a=null;if(n<this._normalizedRanges.length&&o<e._normalizedRanges.length){let c=this._normalizedRanges[n],l=e._normalizedRanges[o];c.startLineNumber<l.startLineNumber?(a=c,n++):(a=l,o++)}else n<this._normalizedRanges.length?(a=this._normalizedRanges[n],n++):(a=e._normalizedRanges[o],o++);s===null?s=a:s.endLineNumberExclusive>=a.startLineNumber?s=new Yr(s.startLineNumber,Math.max(s.endLineNumberExclusive,a.endLineNumberExclusive)):(r.push(s),s=a)}return s!==null&&r.push(s),new t(r)}subtractFrom(e){let r=B1(this._normalizedRanges,a=>a.endLineNumberExclusive>=e.startLineNumber),n=td(this._normalizedRanges,a=>a.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)return new t([e]);let o=[],s=e.startLineNumber;for(let a=r;a<n;a++){let c=this._normalizedRanges[a];c.startLineNumber>s&&o.push(new Yr(s,c.startLineNumber)),s=c.endLineNumberExclusive}return s<e.endLineNumberExclusive&&o.push(new Yr(s,e.endLineNumberExclusive)),new t(o)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let r=[],n=0,o=0;for(;n<this._normalizedRanges.length&&o<e._normalizedRanges.length;){let s=this._normalizedRanges[n],a=e._normalizedRanges[o],c=s.intersect(a);c&&!c.isEmpty&&r.push(c),s.endLineNumberExclusive<a.endLineNumberExclusive?n++:o++}return new t(r)}getWithDelta(e){return new t(this._normalizedRanges.map(r=>r.delta(e)))}};var O9=class t{constructor(e){this.edits=e}static fromEdit(e,r){let n=e.edits.map(o=>new ph(r.getTransformer().getRange(o.range),o.newText));return new t(n)}},ph=class t{constructor(e,r){this.range=e;this.newText=r}static joinEdits(e,r){if(e.length===0)throw new yr;if(e.length===1)return e[0];let n=e[0].range.getStartPosition(),o=e[e.length-1].range.getEndPosition(),s="";for(let a=0;a<e.length;a++){let c=e[a];if(s+=c.newText,a<e.length-1){let l=e[a+1],u=je.fromPositions(c.range.getEndPosition(),l.range.getStartPosition()),d=r.getValueOfRange(u);s+=d}}return new t(je.fromPositions(n,o),s)}};var hx=class t{constructor(e){this.edits=e;rI(aW(e,(r,n)=>r.lineRange.endLineNumberExclusive<=n.lineRange.startLineNumber))}static{this.empty=new t([])}static fromEdit(e){let r=O9.fromEdit(e.edit,e.base);return t.fromTextEdit(r,e.base)}static fromTextEdit(e,r){let n=e.edits,o=[],s=[];for(let a=0;a<n.length;a++){let c=n[a],l=a+1<n.length?n[a+1]:void 0;if(s.push(c),l&&l.range.startLineNumber===c.range.endLineNumber)continue;let u=ph.joinEdits(s,r);s.length=0;let d=B0.fromSingleTextEdit(u,r);o.push(d)}return new t(o)}static createFromUnsorted(e){let r=e.slice();return r.sort(q1(n=>n.lineRange.startLineNumber,j1)),new t(r)}toEdit(e){let r=[];for(let n of this.edits){let o=n.toSingleEdit(e);r.push(o)}return ru.create(r)}toString(){return this.edits.map(e=>e.toString()).join(",")}serialize(){return this.edits.map(e=>e.serialize())}getNewLineRanges(){let e=[],r=0;for(let n of this.edits)e.push(Yr.ofLength(n.lineRange.startLineNumber+r,n.newLines.length)),r+=n.newLines.length-n.lineRange.length;return e}mapLineNumber(e){let r=0;for(let n of this.edits){if(n.lineRange.endLineNumberExclusive>e)break;r+=n.newLines.length-n.lineRange.length}return e+r}mapLineRange(e){return new Yr(this.mapLineNumber(e.startLineNumber),this.mapLineNumber(e.endLineNumberExclusive))}rebase(e){return new t(this.edits.map(r=>new B0(e.mapLineRange(r.lineRange),r.newLines)))}humanReadablePatch(e){let r=[];function n(c,l,u,d){let p=u==="unmodified"?" ":u==="deleted"?"-":"+";d===void 0&&(d="[[[[[ WARNING: LINE DOES NOT EXIST ]]]]]");let f=c===-1?"   ":c.toString().padStart(3," "),m=l===-1?"   ":l.toString().padStart(3," ");r.push(`${p} ${f} ${m} ${d}`)}function o(){r.push("---")}let s=0,a=!0;for(let c of ife(this.edits,(l,u)=>RSe(l.lineRange,u.lineRange)<=5)){a?a=!1:o();let l=c[0].lineRange.startLineNumber-2;for(let u of c){for(let f=Math.max(1,l);f<u.lineRange.startLineNumber;f++)n(f,f+s,"unmodified",e[f-1]);let d=u.lineRange,p=u.newLines;for(let f of d.mapToLineArray(m=>m)){let m=e[f-1];n(f,-1,"deleted",m)}for(let f=0;f<p.length;f++){let m=p[f];n(-1,d.startLineNumber+s+f,"added",m)}l=d.endLineNumberExclusive,s+=u.newLines.length-u.lineRange.length}for(let u=l;u<=Math.min(l+2,e.length);u++)n(u,u+s,"unmodified",e[u-1])}return r.join(`
`)}apply(e){let r=[],n=0;for(let o of this.edits){for(;n<o.lineRange.startLineNumber-1;)r.push(e[n]),n++;for(let s of o.newLines)r.push(s);n=o.lineRange.endLineNumberExclusive-1}for(;n<e.length;)r.push(e[n]),n++;return r}},B0=class t{constructor(e,r){this.lineRange=e;this.newLines=r}static fromSingleTextEdit(e,r){let n=rd(e.newText),o=r.getTransformer().getLineLength(e.range.startLineNumber)+1,s;if(e.range.startColumn===o&&n[0].length===0)n.shift(),s=e.range.startLineNumber+1;else{let l=new je(e.range.startLineNumber,1,e.range.startLineNumber,e.range.startColumn),u=r.getValueOfRange(l);n[0]=u+n[0],s=e.range.startLineNumber}let a;if(s<e.range.endLineNumber&&e.range.endColumn===1&&n[n.length-1].length===0)n.pop(),a=e.range.endLineNumber;else{let l=r.getTransformer().getLineLength(e.range.endLineNumber)+1,u=new je(e.range.endLineNumber,e.range.endColumn,e.range.endLineNumber,l),d=r.getValueOfRange(u);n[n.length-1]=n[n.length-1]+d,a=e.range.endLineNumber+1}let c=new Yr(s,a);return new t(c,n)}toSingleTextEdit(e){if(this.newLines.length===0){let r=e.getTransformer().textLength;if(this.lineRange.endLineNumberExclusive===r.lineCount+1){let n;if(this.lineRange.startLineNumber>1){let s=this.lineRange.startLineNumber-1,a=e.getTransformer().getLineLength(s)+1;n=new Ut(s,a)}else n=new Ut(1,1);let o=r.addToPosition(new Ut(1,1));return new ph(je.fromPositions(n,o),"")}else return new ph(new je(this.lineRange.startLineNumber,1,this.lineRange.endLineNumberExclusive,1),"")}else if(this.lineRange.isEmpty){let r,n,o,s=this.lineRange.startLineNumber;return s===e.getTransformer().textLength.lineCount+1?(r=s-1,n=e.getTransformer().getLineLength(r)+1,o=this.newLines.map(a=>`
`+a).join("")):(r=s,n=1,o=this.newLines.map(a=>a+`
`).join("")),new ph(je.fromPositions(new Ut(r,n)),o)}else{let r=this.lineRange.endLineNumberExclusive-1,n=e.getTransformer().getLineLength(r)+1,o=new je(this.lineRange.startLineNumber,1,r,n),s=this.newLines.join(`
`);return new ph(o,s)}}toSingleEdit(e){let r=this.toSingleTextEdit(e),n=e.getTransformer().getOffsetRange(r.range);return tf.replace(n,r.newText)}toString(){return`${this.lineRange}->${JSON.stringify(this.newLines)}`}serialize(){return{lineRange:this.lineRange.serialize(),newLines:this.newLines}}},UN=class t{constructor(e,r){this.base=e;this.edit=r}static fromEdit(e){let r=hx.fromEdit(e);return new t(e.base,r)}toString(){return this.edit.humanReadablePatch(this.base.getLines())}toEdit(){return this.edit.toEdit(this.base)}toRootedEdit(){return new k0(this.base,this.toEdit())}getEditedState(){let e=this.base.getLines();return this.edit.apply(e)}};var M9=class{constructor(e,r){this.documents=e;this.activeDocumentIdx=r;rI(e.length>0),rI(r>=0&&r<e.length)}getActiveDocument(){return this.documents[this.activeDocumentIdx]}},F9=class{constructor(e,r,n){this.uri=e;this.documentLinesBeforeEdit=r;this.recentEdit=n}},ZT=class t{constructor(e){this.state=e}static noEdit(){return new t({kind:"noEdit"})}static edit(e){return new t({kind:"edit",edit:e})}};var dZ=class{constructor(e){this.result=e}async ifAsyncOk(e){return await e(this.result)}ifOk(e){return e(this.result)}map(e){return e(this.result)}},pZ=class{constructor(e,r){this.reason=e;this.message=r}async ifAsyncOk(e){return this}ifOk(e){return this}map(e){}};function BN(t){return t.reason!==void 0}function eE(t){return new dZ(t)}function Cc(t,e){return new pZ(t,e)}var qN=class extends Error{},q0=class extends Error{},gx=class{constructor(e){this.requestId=e}static createFromRecord(e,r){let n=new Set(Object.keys(e));if(U9(n,new Set(["type","from_line","to_line","code"]))){if(e.type==="replace")return new fh(Number(e.from_line),Number(e.to_line),e.code,r);throw new q0(`fields only fit replace type but type is ${e.type}`)}else if(U9(n,new Set(["type","before_line","code"]))){if(e.type==="insert")return new sf({lineNum:Number(e.before_line),insert:0},e.code,r);throw new q0(`fields only fit insert type but type is ${e.type}`)}else if(U9(n,new Set(["type","after_line","code"]))){if(e.type==="insert")return new sf({lineNum:Number(e.after_line),insert:1},e.code,r);throw new q0(`fields only fit insert type but type is ${e.type}`)}else if(U9(n,new Set(["type","from_line","to_line"]))){if(e.type==="delete")return new mh(Number(e.from_line),Number(e.to_line),r);throw new q0(`fields only fit delete type but type is ${e.type}`)}else throw new qN(`fields ${Array.from(n)} do not fit any known type of EditCommand`)}},jN=(r=>(r[r.BeforeLine=0]="BeforeLine",r[r.AfterLine=1]="AfterLine",r))(jN||{}),sf=class extends gx{constructor(r,n,o){super(o);this.line=r;this.text=n;this.kind="insert"}toString(){let r=["kind: "+this.kind];return r.push("lineNum: "+this.line.lineNum),r.push("insert: "+jN[this.line.insert]),r.push("text: "+this.text),r.join(`
`)}},fh=class extends gx{constructor(r,n,o,s){super(s);this.fromLine=r;this.toLine=n;this.text=o;this.kind="replace"}toString(){let r=["kind: "+this.kind];return r.push("fromLine: "+this.fromLine),r.push("toLine: "+this.toLine),r.push("text: "+this.text),r.join(`
`)}},mh=class extends gx{constructor(r,n,o){super(o);this.fromLine=r;this.toLine=n;this.kind="delete"}toString(){let r=["kind: "+this.kind];return r.push("fromLine: "+this.fromLine),r.push("toLine: "+this.toLine),r.join(`
`)}};function U9(t,e){if(t.size!==e.size)return!1;for(let r of t)if(!e.has(r))return!1;return!0}var B9=class{constructor(e,r){this.uri=e;this.lines=r}serialize(){return{uri:this.uri.toString(),lines:this.lines}}},q9=class{constructor(e,r){this.doc=e;this.lineEdit=r}serialize(){return{doc:this.doc.serialize(),edits:this.lineEdit.serialize()}}},j9=class{constructor(e,r){this.doc=e;this.edits=r}};var fZ=q(require("stream"));var V9={created:0,completionId:"",headerRequestId:""};var ASe=q(require("stream")),H9=class extends ASe.Transform{constructor(){super({readableObjectMode:!0,writableObjectMode:!0});this.buf=""}_transform(r,n,o){this.buf+=r.text,r.completionId&&(this.completionId=r.completionId),r.created&&(this.created=r.created);let s=this.buf.split(/\r?\n/);this.buf=s.pop()??"";for(let a of s)this.push({text:a,completionId:this.completionId,created:this.created});o()}_flush(r){this.buf&&this.push({text:this.buf,completionId:this.completionId,created:this.created}),r()}};function DSe(t){let e=t.toString();return e.startsWith("file://")?e.substring(7):e}function NSe(t,e,r,n,o){let s="";return t.forEach(a=>{s+=`${DSe(a.doc.uri)}: |+2
`,s+=`${r(a.doc.lines)}
`}),t.slice().reverse().forEach(a=>{s+=`edit ${DSe(a.doc.uri)}:
`,a.edits.forEach(c=>{if(c instanceof mh)s+=`  - type: delete
`,s+=`    from_line: ${c.fromLine}
`,s+=`    to_line: ${c.toLine}
`;else if(c instanceof sf)s+=`  - type: insert
`,s+=`    code: |+2
`,s+=`${e(c.text)}
`,c.line.insert===1?s+=`    after_line: ${c.line.lineNum}
`:c.line.insert===0&&(s+=`    before_line: ${c.line.lineNum}
`);else if(c instanceof fh)s+=`  - type: replace
`,s+=`    from_line: ${c.fromLine}
`,s+=`    code: |+2
`,s+=`${e(c.text)}
`,s+=`    to_line: ${c.toLine}
`;else throw new Error("Unknown edit command type")})}),n&&o===void 0?s+=`  - type:
`:o!==void 0&&(s+=`  - type: replace
`,s+=`    from_line: ${o}
`,s+=`    code:
`),s}var G9=class t{constructor(e=!1){this.promptWithTrailingEdit=e}static{this.strategyName="edit-command"}stops(){return[`
name:`]}static lineSourceText(e){return typeof e=="string"?(e.endsWith(`
`)?e:e+`
`).split(`
`).map((n,o)=>`  ${o+1}:${n}`).join(`
`):e.map((r,n)=>`  ${n+1}:${r}`).join(`
`)}static indentCode(e){return(e.endsWith(`
`)?e.slice(0,-1):e).split(`
`).map(n=>`      ${n}`).join(`
`)}createPrompt(e){let r=[];for(let{lineRange:n,newLines:o}of e.lineEdit.edits)if(n.isEmpty)r.push(new sf({lineNum:n.startLineNumber,insert:1},o.join(`
`),V9));else if(o.length===0){if(n.startLineNumber===n.endLineNumberExclusive)continue;r.push(new mh(n.startLineNumber,n.endLineNumberExclusive,V9))}else r.push(new fh(n.startLineNumber,n.endLineNumberExclusive,o.join(`
`),V9));return NSe([new j9(e.doc,r)],t.indentCode,t.lineSourceText,this.promptWithTrailingEdit,this.renumberedFocusLine)}async*extractChanges(e,r){let n=new fZ.PassThrough({readableObjectMode:!0,writableObjectMode:!0});this.promptWithTrailingEdit&&this.renumberedFocusLine===void 0?n.write({text:"  - type:"}):this.renumberedFocusLine!==void 0&&(n.write({text:`  - type: replace
`}),n.write({text:"    from_line: "+this.renumberedFocusLine+`
`}),n.write({text:"    code:"})),e.pipe(n);let o=new H9;n.pipe(o);let s={},a=0,c="",l="readingEdit";for await(let u of o){let d=u.text;if(a=u.created,c=u.completionId,l==="readingCodeBlock"&&(d.startsWith("      ")?s.code+=d.slice(6)+`
`:l="readingEdit"),l!=="readingCodeBlock"){let[p,f]=d.trim().split(":");if(p==="code")s.code="",l="readingCodeBlock";else if(f!==void 0)if(p==="- type"){if(s.type)return;s.type=f.trim()}else p==="line_from"||p==="from_line"?s.from_line=f.trim():p==="line_to"||p==="to_line"?s.to_line=f.trim():p==="before_line"||p==="line_before"?(p="before_line",s.before_line=f.trim()):(p==="after_line"||p==="line_after")&&(f=f.trim(),f==="0"?s.before_line="1":s.after_line=f);try{yield gx.createFromRecord(s,{created:a,completionId:c,headerRequestId:r}),s={}}catch(m){if(!(m instanceof qN)){if(m instanceof q0)return}}}}}async*parseResponse(e,r){let n=new fZ.PassThrough({readableObjectMode:!0,writableObjectMode:!0}),o="",s=[];n.on("data",u=>{o+=u.text,u.logProb&&s.push(u.logProb)}),e.pipe(n);let a=!1,c,l;for await(let u of this.extractChanges(n,r))a=!0,c=l,l=s.reduce((d,p)=>d+p,0)/s.length,yield{maybeEditCommand:eE(u),modelResponse:o,requestId:u.requestId,lastLogProbsAvg:c,currentLogProbsAvg:l};a||(yield{maybeEditCommand:Cc("no-suggestions"),modelResponse:o,requestId:{headerRequestId:r,completionId:"",created:0}})}};var cet=!0,uet=t=>JSON.stringify(t.serialize()),mZ=class{constructor(e,r=20){this.cachingStrategy=e;this.cache=new Bl(r)}get(e){let r=this.cachingStrategy(e);return this.cache.get(r)}set(e,r){let n=this.cachingStrategy(e);this.cache.put(n,r)}},tE=class{constructor(e,r){this.nesFetchService=e;this.logService=r;this.resultCache=new mZ(uet)}async provideNextEdit(e,r,n){let o=e.getActiveDocument(),s=new q9(new B9(He.parse(o.uri),o.documentLinesBeforeEdit),o.recentEdit);if(s.lineEdit.edits.length===0)return ZT.noEdit();if(cet){let l=this.resultCache.get(s);if(l)return this.trace("[cache HIT]",l),r.setIsCachedResult(!0),ZT.edit(l)}this.trace("[cache MISS] will fetch response"),r.setIsCachedResult(!1);let c=(await this.doGetNextEdit(s,n,r)).rebase(s.lineEdit);return this.resultCache.set(s,c),ZT.edit(c)}async doGetNextEdit(e,r,n){let o=ir(),s=new G9,a=s.createPrompt(e);this.trace("Prompt",a),n.setPrompt(a);let c;try{c=await this.nesFetchService.fetch(a,s.stops(),o,Wt.None)}catch(l){throw this.trace("Assertion failure: NesFetchService#fetch should return error as Result.Error not throw",l),l}if(r.isCancellationRequested)throw new dn;if(BN(c))throw this.trace("Failed to fetch nes response",c.reason),new Error("Failed to get response from nes");{let l=c.result,u=s.parseResponse(l,o),d=[],p=[];try{for await(let h of u){if(r.isCancellationRequested)throw new dn;if(d.push(h),BN(h.maybeEditCommand))this.trace("A responseResult is error",h);else{this.trace("Response result is success",h);let g=h.maybeEditCommand.result;p.push(g)}}}catch(h){throw this.trace("Unexpected error when awaiting responseResult",h),h}n.setResponseResults(d);let f=[];for(let h of p)if(h instanceof sf){let g=h.line.lineNum+(h.line.insert===1?1:-1),v=new Yr(g,g);this.isValidRange(e,v)&&f.push(new B0(v,this.toNewLines(h.text)))}else if(h instanceof fh){let g=new Yr(h.fromLine,h.toLine+1);this.isValidRange(e,g)&&f.push(new B0(g,this.toNewLines(h.text)))}else if(h instanceof mh){let g=new Yr(h.fromLine,h.toLine+1);this.isValidRange(e,g)&&f.push(new B0(g,[]))}else LSe.default.fail(`Unknown edit command kind: ${h.constructor.name}`);return this.trace(`Parsed ${f.length} edits from nes response`,f),hx.createFromUnsorted(f)}}isValidRange(e,r){let n=e.doc.lines.length;return r.startLineNumber>0&&r.startLineNumber<=n&&r.endLineNumberExclusive<=n+1}toNewLines(e){return(e.endsWith(`
`)?e.slice(0,-1):e).split(`
`)}trace(e,...r){let n=r.map(o=>JSON.stringify(o,null,"	")).join(`
-----
`);this.logService.internal.trace(`[NextEditPredictor] ${e} ${n}`)}};tE=E([y(0,JT),y(1,ie)],tE);var rE=class{constructor(e,r,n){this._tracker=e;this._statelessNextEditProvider=r;this._parseService=n;this._subsequentEditLookupMap=new Map}async getNextEdit(e,r,n){let o=this._tracker.getRecentEdit(e);if(!o||o.edit.isEmpty())return new vx(void 0);let s=o.getEditedState().value,a=this._subsequentEditLookupMap.get(s);if(a)return this._subsequentEditLookupMap.delete(s),new vx(a);let l=!0?this.getProjectedDocumentClipping(o):await this.getProjectedDocumentSummarizedDocument(o),u=det(o,l),d=UN.fromEdit(u);if(d.edit.edits.length===0)return new vx(void 0);r.setRequestInput(d);let p=new M9([new F9(e,d.base.getLines(),d.edit)],0),f=await this._statelessNextEditProvider.provideNextEdit(p,r,n),m=f.state.kind==="edit"?f.state.edit:hx.empty,h=new UN(u.getEditedState(),m);if(r.setResult(h),m.edits.length===0)return new vx(void 0);let g=h.toEdit(),v=pet(g,l),b=v.decompose(),_=o.getEditedState();for(let x=0;x<b.length-1;x++){let S=b[x];_=_.apply(S),this._subsequentEditLookupMap.set(_.value,b[x+1].edits[0])}return new vx(v.edits[0])}getProjectedDocumentClipping(e){let r=e.base.getTransformer(),n=r.getRange(e.edit.getRange()),o=Yr.fromRange(n);function s(u,d){return new Yr(u.startLineNumber-d,u.endLineNumberExclusive+d)}let a=new Yr(1,r.textLength.lineCount+1),c=a.intersect(s(o,100)),l=Yr.subtract(a,c);return new K2(new W2(e.base.value),new Or(l.map(u=>Ii.delete(r.getOffsetRange(new je(u.startLineNumber,1,u.endLineNumberExclusive,1))))))}async getProjectedDocumentSummarizedDocument(e){let r=await met(this._parseService,{getText:()=>e.base.value,languageId:"typescript"});if(!r)throw new Error("could not parse");let n=new W2(e.base.value),o=OSe(n.offsetRangeToRange(e.edit.edits[0].range));return e6(200*50,{costFnOverride:(a,c,l)=>{let u=OSe(l.offsetRangeToRange(a.range)),d=fet(o,u);return d>100?!1:d}},[{overlayNodeRoot:r,document:n,selection:void 0}])[0]}};rE=E([y(2,dt)],rE);function det(t,e){let r=e.projectOffsetEdit(t.edit.toOffsetEdit());return new k0(new R0(e.text),ru.fromOffsetEdit(r))}function pet(t,e){let r=e.projectBackOffsetEdit(t.toOffsetEdit());return ru.fromOffsetEdit(r)}function OSe(t){return new Yr(t.start.line+1,t.end.line+1)}function fet(t,e){return t.endLineNumberExclusive<=e.startLineNumber?e.startLineNumber-t.endLineNumberExclusive:e.endLineNumberExclusive<=t.startLineNumber?t.startLineNumber-e.endLineNumberExclusive:0}var vx=class{constructor(e){this.edit=e}};async function met(t,e){return await t.getTreeSitterAST(e)?.getStructure()}var nE=class extends Oe{constructor(r){super();this._requestLogger=r}add(r){r.isEmpty||this._requestLogger.addEntry({type:"MarkdownContentRequest",debugName:r.getDebugName(),error:r.getError(),startTimeMs:r.time,markdownContent:r.toLogDocument()})}};nE=E([y(0,il)],nE);var iE=class extends Oe{constructor(r,n,o,s,a){super();this._configurationService=s;this._authenticationService=a;this._inlineEditsConfigEnabled=cs(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.InlineEditsEnabled));this._copilotToken=cs(this,this._authenticationService.onDidAuthenticationChange,()=>this._authenticationService.copilotToken);this.inlineEditsEnabled=cd(this,r=>this._inlineEditsConfigEnabled.read(r)&&this._copilotToken.read(r)?.isInternal);this._register(b_((c,l)=>{if(!this.inlineEditsEnabled.read(c))return;let u=new tE(n,o),d=this._register(r.createInstance(VN,u)),p=this._register(r.createInstance(nE)),f=new hZ(d,p);l.add(hh.languages.registerInlineEditProvider("*",f))}))}};iE=E([y(0,j),y(1,JT),y(2,ie),y(3,he),y(4,Tt)],iE);var VN=class extends Oe{constructor(r,n){super();this._predictor=r;this._instantiationService=n;this.tracker=new N9;this.nextEditProvider=this._instantiationService.createInstance(rE,this.tracker,this._predictor);this._register(hh.workspace.onDidOpenTextDocument(o=>{this.tracker.handleDocumentOpened(Rd(o),FSe(o))})),this._register(hh.workspace.onDidChangeTextDocument(o=>{let s=gZ(o.contentChanges);this.tracker.handleEdit(Rd(o.document),s)})),this._register(hh.workspace.onDidCloseTextDocument(o=>{this.tracker.handleDocumentClosed(Rd(o))}));for(let o of hh.workspace.textDocuments)this.tracker.handleDocumentOpened(Rd(o),FSe(o))}};VN=E([y(1,j)],VN);var hZ=class{constructor(e,r){this.model=e;this.logger=r}async provideInlineEdit(e,r,n){if(e.uri.scheme==="output")return;let o=new D9(e.fileName,e.version);try{let s=await Zfe(v_(this.model.nextEditProvider.getNextEdit(Rd(e),o,n),4e3),n);return s?.edit?{range:het(e,s.edit.range),text:s.edit.newText}:void 0}catch(s){throw o.setError(s),s}finally{this.logger.add(o)}}};function het(t,e){return new hh.Range(t.positionAt(e.start),t.positionAt(e.endExclusive))}function gZ(t){let e=t.map(r=>tf.replace(St.ofStartAndLength(r.rangeOffset,r.rangeLength),r.text));return e.reverse(),ru.create(e)}function FSe(t){return new R0(t.getText())}function Rd(t){return t.uri.toString()}var Wo=q(require("vscode"));var j0=class{constructor(e,r){this.logService=e;this.parserService=r;this.store=new ht,this.onDidChangeCodeLenses=Wo.tests.onDidChangeTestResults}static{this.codeLensTitle=Wo.l10n.t("Generate tests using Copilot")}static isEnabled(e){return e.getConfig(le.GenerateTestsCodeLens)}dispose(){this.store.dispose()}provideCodeLenses(e,r){return this.computeCodeLens(e,r)}async computeCodeLens(e,r){if(e.uri.scheme==="output")return[];let n=Wo.tests.testResults;if(n.length===0)return this.logService.public.trace("No test results"),[];let o=n[0],s;try{s=await o.getDetailedCoverage?.(e.uri,r)}catch(c){return this.logService.public.error(c),[]}if(!s||s.length===0)return this.logService.public.trace("No detailed coverage"),[];let a=[];for(let c of s)if(c instanceof Wo.DeclarationCoverage){if(this.logService.public.trace(`Received statement coverage for ${c.name}. (detail.executed: ${c.executed})`),!!c.executed)continue;let u=c.location instanceof Wo.Range?c.location:new Wo.Range(c.location,c.location);a.push(this.createCodeLens(e,u))}else c instanceof Wo.StatementCoverage?this.logService.public.trace("Received statement coverage; did nothing"):this.logService.public.error("Unexpected coverage type");if(a.length===0){let c=this.parserService.getTreeSitterAST(e);if(c===void 0)return a;let l=await c.getTestableNodes();if(l===null)return a;let u=s.flatMap(p=>p.executed?[]:p.location instanceof Wo.Position?[p.location.line]:this.toLineNumbers(p.location)),d=new Set(u);for(let p of l){let f=e.positionAt(p.node.startIndex),m=e.positionAt(p.node.endIndex),h=new Wo.Range(f,m);sfe(f.line,m.line).every(g=>d.has(g))&&a.push(this.createCodeLens(e,h))}}return a}createCodeLens(e,r){return new Wo.CodeLens(r,{title:j0.codeLensTitle,command:"github.copilot.interactiveEditor.generateTests",arguments:[{document:e,selection:r}]})}toLineNumbers(e){let r=[];for(let n=e.start.line;n<=e.end.line;n++)r.push(n);return r}};j0=E([y(0,ie),y(1,dt)],j0);var oE=class extends Oe{constructor(e,r){if(super(),j0.isEnabled(e)){let n=this._register(r.createInstance(j0));this._register(Wo.languages.registerCodeLensProvider("*",n))}}};oE=E([y(0,he),y(1,j)],oE);var ATe=q(require("dns")),DTe=q(require("util")),Ch=q(require("vscode"));var get=q(require("http")),vet=q(require("https"));var sE=class extends Vv{constructor(r){super();this._envService=r}fetch(r,n){let o=n.headers||{};o["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let s=n.body;if(n.json){if(n.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");o["Content-Type"]="application/json",s=JSON.stringify(n.json)}let a=n.method||"GET";if(a!=="GET"&&a!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let c=n.signal??new AbortController().signal;if(c&&!(c instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(r,a,o,s,c)}_fetch(r,n,o,s,a){return new Promise((c,l)=>{let d=(r.startsWith("https:")?vet:get).request(r,{method:n,headers:o},p=>{if(a.aborted){p.destroy(),d.destroy(),l(vZ(a));return}let f=new yZ(d,p,a);c(new pv(p.statusCode||0,p.statusMessage||"",f.headers,async()=>f.text(),async()=>f.json(),async()=>f.body()))});d.setTimeout(60*1e3),d.on("error",l),s&&d.write(s),d.end()})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(r){return yet(r)}isDNSLookupFailedError(r){return r&&r.code==="ENOTFOUND"}isFetcherError(r){return r&&["EADDRINUSE","ECONNREFUSED","ECONNRESET","ENOTFOUND","EPIPE","ETIMEDOUT"].includes(r.code)}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.code}.`}};function vZ(t){return t.reason}function yet(t){return t&&t.name==="AbortError"}var yZ=class{constructor(e,r,n){this.req=e;this.res=r;this.signal=n;this.headers=new class{get(o){let s=r.headers[o];return Array.isArray(s)?s[0]:s??null}[Symbol.iterator](){let o=Object.keys(r.headers),s=0;return{next:()=>{if(s>=o.length)return{done:!0,value:void 0};let a=o[s++];return{done:!1,value:[a,this.get(a)]}}}}}}text(){return new Promise((e,r)=>{let n=[];this.res.on("data",o=>n.push(o)),this.res.on("end",()=>e(Buffer.concat(n).toString())),this.res.on("error",r),this.signal.addEventListener("abort",()=>{this.res.destroy(),this.req.destroy(),r(vZ(this.signal))})})}async json(){let e=await this.text();return JSON.parse(e)}async body(){return this.signal.addEventListener("abort",()=>{this.res.emit("error",vZ(this.signal)),this.res.destroy(),this.req.destroy()}),this.res}};var bZ=require("stream");var aE=class t extends Vv{constructor(r,n){super();this._net=r;this._envService=n}static create(r){let n=bet();return n?new t(n,r):null}async fetch(r,n){let o=n.headers||{};o["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let s=n.body;if(n.json){if(n.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");o["Content-Type"]="application/json",s=JSON.stringify(n.json)}let a=n.method||"GET";if(a!=="GET"&&a!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let c=n.signal??new AbortController().signal;if(c&&!(c instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(r,a,o,s,c)}async _fetch(r,n,o,s,a){let c=await this._net.fetch(r,{method:n,headers:o,body:s,signal:a});return new pv(c.status,c.statusText,c.headers,()=>c.text(),()=>c.json(),async()=>{if(!c.body)return bZ.Readable.from([]);let l=c.body[Symbol.asyncIterator]();return bZ.Readable.from(l)})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(r){return r&&r.name==="AbortError"}isDNSLookupFailedError(r){return r?.message==="net::ERR_INTERNET_DISCONNECTED"}isFetcherError(r){return r&&r.message&&r.message.startsWith("net::")}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.message}.`}};function bet(){try{return require("electron").net}catch{}}var hE=q(J1e(),1),n1r={ALPN_HTTP2:hE.default.ALPN_HTTP2,ALPN_HTTP2C:hE.default.ALPN_HTTP2C,ALPN_HTTP1_1:hE.default.ALPN_HTTP1_1,ALPN_HTTP1_0:hE.default.ALPN_HTTP1_0},{fetch:i1r,context:d7,reset:o1r,noCache:s1r,h1:a1r,keepAlive:c1r,h1NoCache:l1r,keepAliveNoCache:u1r,cacheStats:d1r,clearCache:p1r,offPush:f1r,onPush:m1r,createUrl:h1r,timeoutSignal:g1r,Body:v1r,Headers:Z1e,Request:y1r,Response:b1r,AbortController:p7,AbortError:QN,AbortSignal:_1r,FetchBaseError:x1r,FetchError:JZ,ALPN_HTTP2:S1r,ALPN_HTTP2C:I1r,ALPN_HTTP1_1:C1r,ALPN_HTTP1_0:T1r}=hE.default;var TTe=q(require("tls"));var xTe=q(require("crypto")),STe=q(require("fs")),ITe=require("tls");var f7=ne("IWindowsCaCertsLoader");var K7=ne("IRootCertificateReader"),pL=class{constructor(e,r){this.delegate=e;this.logService=r}async getAllRootCAs(){try{return await this.delegate.getAllRootCAs()}catch(e){return this.logService.public.warn(`Failed to read root certificates: ${e}`),[]}}};pL=E([y(1,ie)],pL);var fL=class{constructor(e,r){this._logService=r;this.delegates=e.map(n=>new pL(n,r))}async getAllRootCAs(){return this.certificates||(this.certificates=this.removeExpiredCertificates((await Promise.all(this.delegates.map(e=>e.getAllRootCAs()))).flat())),this.certificates}removeExpiredCertificates(e){let r=Date.now(),n=e.filter(o=>{try{let s=new xTe.X509Certificate(o),a=Date.parse(s.validTo);return isNaN(a)||a>r}catch(s){return this._logService.public.error(s,"Failed to parse certificate "+o),!1}});return e.length!==n.length&&this._logService.public.info(`Removed ${e.length-n.length} expired certificates`),n}};fL=E([y(1,ie)],fL);var ote=class{async getAllRootCAs(){return ITe.rootCertificates}},ste=class{async getAllRootCAs(){let e=process.env.NODE_EXTRA_CA_CERTS;return e?await CTe(e):[]}},ate=class{async getAllRootCAs(){let e=[];for(let r of["/etc/ssl/certs/ca-certificates.crt","/etc/ssl/certs/ca-bundle.crt"]){let n=await CTe(r);e=e.concat(n)}return e}},cte=class{async getAllRootCAs(){let e=_Te();return e.all(e.der2.pem).filter(r=>r!==void 0)}},mL=class{constructor(e){this.windowsCaCertsLoader=e}async getAllRootCAs(){return await this.windowsCaCertsLoader.loadCaCerts()||[]}};mL=E([y(0,f7)],mL);var DE=class extends fL{constructor(e,r,n){super([new ote,new ste,Xst(n,e)],r)}};DE=E([y(1,ie),y(2,j)],DE);function Xst(t,e){switch(e){case"linux":return new ate;case"darwin":return new cte;case"win32":return t.createInstance(mL);default:return new lte}}var lte=class{async getAllRootCAs(){throw new Error("No certificate reader available for unsupported platform")}};async function CTe(t){try{let n=(await STe.promises.readFile(t,{encoding:"utf8"})).split(/(?=-----BEGIN CERTIFICATE-----)/g).filter(s=>s.length>0),o=new Set(n);return Array.from(o)}catch(e){if(e?.code!=="ENOENT")throw e}return[]}var NE=class{constructor(e){this._certificateReader=e}#t;async enhanceProxySettings(e){let r=await this.getCertificates();return{...e,ca:r}}async getCertificates(){let e=await this._certificateReader.getAllRootCAs();if(e.length!==0)return e}async createSecureContext(){let e=await this._certificateReader.getAllRootCAs(),n=TTe.createSecureContext({_vscodeAdditionalCaCerts:e});for(let o of e)n.context.addCACert(o);return{secureContext:n,certs:e}}async applyToRequestOptions(e){this.#t??=this.createSecureContext();let r=await this.#t;e.secureContext=r.secureContext,e.ca=r.certs,e.cert=r.certs}};NE=E([y(0,K7)],NE);var ETe=q(require("http"));var hL=ne("IKerberosLoader");var Jst=407,OE=ne("IProxySocketFactory"),Dx=class extends Error{constructor(e,r,n){super(e),this.code=r?.code,this.syscall=r?.syscall,this.errno=r?.errno,/^Failed to establish a socket connection to proxies:/.test(r?.message??"")?this.code="ProxyFailedToEstablishSocketConnection":/^InitializeSecurityContext:/.test(r?.message??"")?this.code="ProxyInitializeSecurityContext":r?.message==="Miscellaneous failure (see text): Server not found in Kerberos database"?this.code="ProxyKerberosServerNotFound":/^Unspecified GSS failure. {2}Minor code may provide more information: No Kerberos credentials available/.test(r?.message??"")&&(this.code="ProxyGSSFailureNoKerberosCredentialsAvailable"),n!==void 0&&(this.code=n)}};var gL=class{constructor(e,r=process.platform,n,o,s){this.delegate=e;this.platform=r;this.kerberosLoader=n;this.configurationService=o;this.logService=s;this.successfullyAuthorized=new Hg(20)}async createSocket(e,r){this.successfullyAuthorized.get(this.getProxyCacheKey(r))&&(this.logService.public.debug("Proxy authorization already successful once, skipping 407 rountrip"),await this.reauthorize(e,r));try{return await this.delegate.createSocket(e,r)}catch(n){if(n instanceof Dx&&n.code===`ProxyStatusCode${Jst}`){this.logService.public.debug("Proxy authorization required, trying to authorize first time");let o=await this.authorizeAndCreateSocket(e,r);if(o)return this.logService.public.debug("Proxy authorization successful, caching result"),this.successfullyAuthorized.set(this.getProxyCacheKey(r),!0),o}throw n}}async reauthorize(e,r){let n=await this.authorize(r);n&&(this.logService.public.debug("Proxy re-authorization successful, received token"),e.headers["Proxy-Authorization"]="Negotiate "+n)}async authorizeAndCreateSocket(e,r){let n=await this.authorize(r);if(this.logService.public.debug("Proxy authorization successful, received token"),n)return this.logService.public.debug("Trying to create socket with proxy authorization"),e.headers["Proxy-Authorization"]="Negotiate "+n,await this.delegate.createSocket(e,r)}async authorize(e){this.logService.public.debug("Loading kerberos module");let r=await Zst(this.kerberosLoader);if(!r){this.logService.public.debug("Could not load kerberos module");return}let n=this.computeSpn(e);this.logService.public.debug("Initializing kerberos client using spn "+n);let o=await r.initializeClient(n);this.logService.public.debug("Perform client side kerberos step");let s=await o.step("");return this.logService.public.debug("Received kerberos server response"),s}computeSpn(e){let n=this.configurationService.getConfig(le.KerberosServicePrincipal)??e.kerberosServicePrincipal;if(n)return this.logService.public.debug("Using configured kerberos spn "+n),n;let o=this.platform==="win32"?`HTTP/${e.host}`:`HTTP@${e.host}`;return this.logService.public.debug("Using default kerberos spn "+o),o}getProxyCacheKey(e){return e.host+":"+e.port}};gL=E([y(2,hL),y(3,he),y(4,ie)],gL);var LE=class extends gL{constructor(e,r,n,o){super(e.createInstance(vL),process.platform,r,n,o)}};LE=E([y(0,j),y(1,hL),y(2,he),y(3,ie)],LE);var vL=class{constructor(e){this.logService=e}async createSocket(e,r){let n=this.createConnectRequestOptions(e,r);return new Promise((o,s)=>{this.logService.public.debug("Attempting to establish connection to proxy");let a=ETe.request(n);a.useChunkedEncodingByDefault=!1,a.once("connect",(c,l,u)=>{this.logService.public.debug("Socket Connect returned status code "+c.statusCode),a.removeAllListeners(),l.removeAllListeners(),c.statusCode!==200?(l.destroy(),s(new Dx(`tunneling socket could not be established, statusCode=${c.statusCode}`,void 0,`ProxyStatusCode${c.statusCode}`))):u.length>0?(l.destroy(),s(new Dx(`got non-empty response body from proxy, length=${u.length}`,void 0,"ProxyNonEmptyResponseBody"))):(this.logService.public.debug("Successfully established tunneling connection to proxy"),o(l))}),a.once("error",c=>{if(!c.message&&c instanceof AggregateError){let l=c.stack;c=new AggregateError(c.errors,`Aggregate error:${c.errors.map(u=>`
- ${u.message}`).join("")}`),c.stack=l}this.logService.public.debug("Proxy socket connection error "+c.message),a.removeAllListeners(),s(new Dx(`tunneling socket could not be established, cause=${c.message}`,c))}),a.on("timeout",()=>{this.logService.public.debug("Proxy socket connection timeout"),s(new Dx(`tunneling socket could not be established, proxy socket connection timeout while connecting to ${n.host}:${n.port}`,void 0,"ProxyTimeout"))}),a.end()})}createConnectRequestOptions(e,r){let n=`${e.hostname}:${e.port}`,o={...r,method:"CONNECT",path:n,agent:!1,headers:{host:n,"Proxy-Connection":"keep-alive"},timeout:e.timeout};return e.localAddress&&(o.localAddress=e.localAddress),this.configureProxyAuthorization(o,e),o}configureProxyAuthorization(e,r){e.headers["Proxy-Authorization"]=[],e.proxyAuth&&e.headers["Proxy-Authorization"].push("Basic "+Buffer.from(e.proxyAuth).toString("base64")),r.headers&&r.headers["Proxy-Authorization"]&&e.headers["Proxy-Authorization"].push(r.headers["Proxy-Authorization"])}};vL=E([y(0,ie)],vL);async function Zst(t){try{return t.loadKerberos()}catch{return}}var ME=class extends Vv{constructor(r,n,o){super();this.envService=r;this.proxySocketFactory=n;this.createSocketFactory=(r,n)=>async o=>{o.rejectUnauthorized=n,o.timeout=r.connectionTimeoutInMs,await this.certificateConfigurator.applyToRequestOptions(o);let s=await this.certificateConfigurator.enhanceProxySettings(r);return await this.proxySocketFactory.createSocket(o,s)};this.fetchApi=this.createFetchApi(),this.certificateConfigurator=o.createInstance(NE)}set proxySettings(r){this._proxySettings=r,this.fetchApi=this.createFetchApi()}get proxySettings(){return this._proxySettings}set rejectUnauthorized(r){this._rejectUnauthorized=r,this.fetchApi=this.createFetchApi()}get rejectUnauthorized(){return this._rejectUnauthorized}createFetchApi(){return d7({userAgent:`GitHubCopilotChat/${this.envService.getVersion()}`,socketFactory:this._proxySettings?this.createSocketFactory(this._proxySettings,this.rejectUnauthorized):void 0,rejectUnauthorized:this.rejectUnauthorized})}async fetch(r,n){let o=n.signal,s=!1,a={...n,body:n.body?n.body:n.json,signal:o};await this.certificateConfigurator.applyToRequestOptions(a);let c=await this.certificateConfigurator.getCertificates();this.fetchApi.setCA(c);let l=await this.fetchApi.fetch(r,a).catch(u=>{throw s?new QN(`Request to <${r}> timed out after ${n.timeout}ms`):u});return new pv(l.status,l.statusText,l.headers,()=>l.text(),()=>l.json(),async()=>l.body)}disconnectAll(){return this.fetchApi.reset()}makeAbortController(){return new p7}isAbortError(r){return r instanceof QN}isDNSLookupFailedError(r){return r instanceof JZ&&r.code==="ENOTFOUND"}isFetcherError(r){return r instanceof JZ}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.code}.`}};ME=E([y(0,gt),y(1,OE),y(2,j)],ME);var kTe=require("net"),RTe=require("url"),FE=require("vscode");function eat(t){return t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy||null}function PTe(t,e){let r=FE.workspace.onDidChangeConfiguration(n=>{let o=n.affectsConfiguration("http.proxy");(n.affectsConfiguration("http.proxyStrictSSL")||n.affectsConfiguration("http.proxyAuthorization")||n.affectsConfiguration("http.proxyKerberosServicePrincipal")||o)&&wTe(t,e,o)});return wTe(t,e),r}var wTe=(t,e,r)=>{let o=FE.workspace.getConfiguration("http").get("proxy")||eat(e);if(o){let s={},a=FE.workspace.getConfiguration("http").get("proxyAuthorization"),c=FE.workspace.getConfiguration("http").get("proxyStrictSSL",!0);a&&(s["Proxy-Authorization"]=a);let l=o,u=o.split(":");if(u.length>2){if(o.includes("[")){let b=o.indexOf("["),_=o.indexOf("]");l=o.substring(b+1,_)}}else l=u[0];let d=(0,kTe.isIP)(l);d===4?o=`https://${o}`:d===6&&(o.includes("[")?o.startsWith("https://")||(o=`https://${o}`):o=`https://[${o}]`);let{hostname:p,port:f,username:m,password:h}=tat(o),g=m&&h&&`${decodeURIComponent(m)}:${decodeURIComponent(h)}`;t.proxySettings={host:p,port:parseInt(f),proxyAuth:g,headers:s};let v=FE.workspace.getConfiguration("http").get("proxyKerberosServicePrincipal");v&&(t.proxySettings.kerberosServicePrincipal=v),t.rejectUnauthorized=c}else r&&!o&&(t.proxySettings=void 0)};function tat(t){try{return new RTe.URL(t)}catch{throw new Error(`Invalid proxy URL: '${t}'`)}}var ry=class extends ME{constructor(r,n,o){super(r,n,o);this._store=new ht;this._store.add(PTe(this,process.env))}dispose(){this._store.dispose()}};ry=E([y(0,gt),y(1,OE),y(2,j)],ry);var UE=class{constructor(e,r,n,o,s){this._context=e;this.envService=r;this.configurationService=n;this.domainService=o;this.instantiationService=s;this._context.subscriptions.push(Ch.commands.registerCommand("github.copilot.debug.collectDiagnostics",async()=>{let a=await Ch.workspace.openTextDocument({language:"markdown"}),c=await Ch.window.showTextDocument(a);await pu(c,`## GitHub Copilot Chat

- Extension Version: ${this.envService.getVersion()} (${this.envService.getBuildType()})
- VS Code: ${this.envService.getEditorInfo().format()}
- OS: ${this.envService.OS}${Ch.env.remoteName?`
- Remote Name: ${Ch.env.remoteName}`:""}

## Network

User Settings:
\`\`\`json
  "github.copilot.advanced": {
    "debug.useElectronFetcher": ${this.configurationService.getConfig(le.DebugUseElectronFetcher)},
    "debug.useNodeFetcher": ${this.configurationService.getConfig(le.DebugUseNodeFetcher)}
  }
\`\`\`
`);let l=this.domainService.capiBaseURL,u=[this.domainService.dotComAPIURL,`${l.endsWith("/")?l:`${l}/`}_ping`],d=10,p=aE.create(this.envService),f=!!p&&this.configurationService.getConfig(le.DebugUseElectronFetcher),m=!f&&this.configurationService.getConfig(le.DebugUseNodeFetcher),h={Electron:{fetcher:p,current:f},Node:{fetcher:new sE(this.envService),current:m},Helix:{fetcher:this.instantiationService.createInstance(ry),current:!f&&!m}};for(let g of u){let v=new URL(g).host;await pu(c,`
Connecting to ${g}:
`);for(let b of[4,6]){await pu(c,`- DNS ipv${b} Lookup: `);try{let _=DTe.promisify(ATe.lookup),x=Date.now(),S=await Promise.race([_(v,{family:b}),Fl(d*1e3)]);S?await pu(c,`${S.address} (${Date.now()-x} ms)
`):await pu(c,`timed out after ${d} seconds
`)}catch(_){await pu(c,`Error: ${_?.message}
`)}}for(let[b,_]of Object.entries(h))if(await pu(c,`- ${b} Fetcher${_.current?" (configured)":""}: `),_.fetcher)try{let x=Date.now(),S=await Promise.race([_.fetcher.fetch(g,{}),Fl(d*1e3)]);S?await pu(c,`HTTP ${S.status} (${Date.now()-x} ms)
`):await pu(c,`timed out after ${d} seconds
`)}catch(x){await pu(c,`Error: ${x?.message}
`)}else await pu(c,`Unavailable
`)}await pu(c,`
## Documentation

In corporate networks: [Troubleshooting firewall settings for GitHub Copilot](https://docs.github.com/en/copilot/troubleshooting-github-copilot/troubleshooting-firewall-settings-for-github-copilot).`)}))}};UE=E([y(0,Bt),y(1,gt),y(2,he),y(3,en),y(4,j)],UE);async function pu(t,e){await t.edit(r=>{r.insert(t.document.lineAt(t.document.lineCount-1).range.end,e)})}var LTe=require("http"),Cs=q(require("vscode"));var NTe=q(require("vscode"));var BE=class extends ht{constructor(r,n,o){super();this.setting=r;this.configurationService=o;this.contextKeyName=n??`${r.fullyQualifiedId}.enabled`,this.add(o.onDidChangeConfiguration(s=>{r.firstPart==="advanced"?s.affectsConfiguration(`${hp}.advanced`)&&this.updateContextKey():s.affectsConfiguration(r.fullyQualifiedId)&&this.updateContextKey()})),this.updateContextKey()}updateContextKey(){NTe.commands.executeCommand("setContext",this.contextKeyName,this.configurationService.getConfig(this.setting))}};BE=E([y(2,he)],BE);var OTe="vscode.copilot.chat.showRequestHtmlItem",qE=class extends Oe{constructor(r,n){super();this.id="requestLogTree";this._register(Cs.window.registerTreeDataProvider("copilot-chat",r.createInstance(bL))),this._register(r.createInstance(BE,le.ShowRequestLog,"github.copilot.advanced.debug.enabled"));let o;this._register(Cs.commands.registerCommand(OTe,async s=>{o||(o=this._register(new yL(n)));let a=await o.port;await Cs.commands.executeCommand("simpleBrowser.show",`http://127.0.0.1:${a}/${s}`)}))}};qE=E([y(0,j),y(1,il)],qE);var yL=class extends Oe{constructor(e){super();let r=(0,LTe.createServer)((n,o)=>{let a=new URL(n.url||"/","http://localhost").pathname.replaceAll("/",""),c=e.getRequests().find(l=>l.id===a);!c||c.kind!==0?(o.statusCode=404,o.end("Not Found")):(o.setHeader("Content-Type","text/html"),o.setHeader("Content-Length",c.html.length),o.end(c.html))});this.port=new Promise((n,o)=>{r.listen(0,"127.0.0.1",()=>n(r.address().port)).on("error",o)}),this._register(Zi(()=>r.close()))}};yL=E([y(0,il)],yL);var bL=class{constructor(e){this.requestLogger=e;this.onDidChangeTreeData=this.requestLogger.onDidChangeRequests.bind(this.requestLogger)}getTreeItem(e){return e}getChildren(e){return e?[]:this.requestLogger.getRequests().map(r=>{switch(r.kind){case 1:return new dte(r);case 0:return new ute(r);default:KM(r)}})}};bL=E([y(0,il)],bL);var ute=class extends Cs.TreeItem{constructor(e){super(`<${e.name}/>`,Cs.TreeItemCollapsibleState.None),this.description=`${e.tokens} tokens`,this.command={command:OTe,title:"",arguments:[e.id]},this.iconPath=new Cs.ThemeIcon("code")}},dte=class extends Cs.TreeItem{constructor(e){if(super(e.entry.debugName,Cs.TreeItemCollapsibleState.None),e.entry.type==="MarkdownContentRequest"){this.iconPath=e.entry.error?e.entry.error instanceof dn?new Cs.ThemeIcon("testing-skipped-icon"):new Cs.ThemeIcon("error"):void 0;let r=new Date(e.entry.startTimeMs).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});this.description=r}else{let r=`${e.entry.endTime.getTime()-e.entry.startTime.getTime()}ms`,n=e.entry.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});this.description=`[${r}] [${n}]`,this.iconPath=e.entry.type==="ChatMLSuccess"?void 0:new Cs.ThemeIcon("error"),this.tooltip=`${e.entry.type==="ChatMLCancelation"?"cancelled":e.entry.result.type}
	${e.entry.chatEndpoint.model}
	${r}
	${n}`}this.command={command:"vscode.open",title:"",arguments:[Cs.Uri.parse(dd.buildUri({kind:"request",id:e.id}))]}}};var Lx=require("fs"),$Te=require("net"),vf=q(require("path")),qa=q(require("vscode"));var wc=ne("IExtensionsService");var jE=ne("ILaunchConfigService");var GE=require("path");var UTe=q(Ct()),rn=q(Ue()),Nx=require("path");var Y7=(t,e)=>{let r=[t,...Ls(t).map(n=>n.code)];for(let n of r)try{let o=Jp(n);if(o&&"configurations"in o&&Array.isArray(o.configurations))return o.configurations=o.configurations.map(s=>MTe(s,e)),o;if(o&&"type"in o&&"request"in o)return{configurations:[MTe(o,e)]}}catch{}},nat=["name","type","request","debugServer","preLaunchTask","postDebugTask","presentation","internalConsoleOptions","suppressMultipleSessionWarning"];function MTe(t,e){"type"in t&&t.type==="python"&&(t.type="debugpy");let r=iat(t.type,e);if(!r)return t;for(let n of Object.keys(t))nat.includes(n)||n in r||delete t[n];return t}function FTe(t,e){for(let r of e.allAcrossExtensionHosts){let n=r.packageJSON?.contributes?.debuggers;if(!n)continue;let o=n.filter(a=>a.type===t&&!a.deprecated);if(!Array.isArray(o)||o.length===0)continue;let s=o.filter(a=>!!a.configurationAttributes.launch||!!a.configurationAttributes.attach).map(a=>{let c=[a.configurationAttributes.launch?.properties,a.configurationAttributes.attach?.properties].filter(l=>l!==void 0).flat();return Object.entries(c).map(l=>Object.entries(l[1]).map(u=>`${u[0]}: ${u[1].description||u[1].markdownDescription}`).flat()).flat()}).flat();if(s.length)return s}}function iat(t,e){for(let r of e.allAcrossExtensionHosts){let n=r.packageJSON?.contributes?.debuggers;if(!n)continue;let o=n.filter(s=>s.type===t&&!s.deprecated);if(!(!Array.isArray(o)||o.length===0))return o.flatMap(s=>[s.configurationAttributes.launch?.properties,s.configurationAttributes.attach?.properties]).filter(s=>s!==void 0).reduce((s,a)=>({...s,...a}),{})}}function oat(t,e){let r={configurations:[{type:"node",request:"launch",name:"Launch Program",program:"${workspaceFolder}/app/index.js",args:["--serve"]}]},n={configurations:[{type:"cppvsdbg",request:"launch",name:"Launch Program",program:"${workspaceFolder}/${input:executableName}.exe",stopAtEntry:!0}],inputs:[{type:"promptString",id:"executableName",description:"Name of your executable"}]},o=s=>e===1?JSON.stringify(s):`\`\`\`json
${JSON.stringify(s,null,2)}
\`\`\``;return t===0?`# Example
User:
My operating system is macOS.
Create a debug configuration to do the following: launch my node app

Assistant:
${o(r)}

# Example
User:
My operating system is Windows.
Create a debug configuration to do the following: debug my c++ program

Assistant:
${o(n)}
`:`# Example
User:
My operating system is macOS.
In the working directory \${workspaceFolder}/app, I ran this on the command line: node ./index --serve

Assistant:
${o(r)}

# Example
User:
My operating system is Windows.
In the working directory \${workspaceFolder}, I ran this on the command line: make test

Assistant:
${o(n)}
`}var ny=class extends rn.PromptElement{constructor(r,n,o,s,a,c,l,u,d,p,f,m){super(r);this.workspace=n;this.chatMLFetcher=o;this.endpointProvider=s;this.instantiationService=a;this.extensionsService=c;this.logService=l;this.docSearchClient=u;this.fileSystemService=p;this.ignoreService=f;this.envService=m;this.gitService=d.safeGet(ro)}async prepare(r,n,o){if(o.isCancellationRequested)return{};let s=n?Z_(n,new xi(UTe.t("Searching doc index...")),this.searchDocsSearchForContext(10,o),1e3):this.searchDocsSearchForContext(10,o);if(o.isCancellationRequested)return{};let a=await this.getDebuggerType(n,o),[c,l,u]=await Promise.all([s,this.getResources(a,n,o),this.getSchema(a,n,o)]);return{docSearchResults:c,resources:l,schema:u}}async getFiles(r,n,o){let s=this.props.input.type===1?this.props.input.absoluteCwd:void 0;if(s||(this.workspace.getWorkspaceFolders().length===1?s=this.workspace.getWorkspaceFolders()?.[0]?.fsPath:s=(await this.workspace.showWorkspaceFolderPicker())?.uri.fsPath),!s)return;let a=[],c=new Set(r.map(f=>s+Nx.sep+f)),l=new Set,u=this.gitService?.getExtensionApi()?.getRepository(He.from({scheme:"file",path:s}));if(u)try{l=await u.checkIgnore([...c])}catch{}let d,p=s;for(let f of r){s=p,(f==="tasks.json"||f==="launch.json")&&(s+=Nx.sep+".vscode");let m=await sat(s,async h=>{if(h===Nx.sep)return;let g=He.from({scheme:"file",path:h+Nx.sep+f});try{d=await this.fileSystemService.readFile(g)}catch{return}if(d)return l.has(g.fsPath)||await this.ignoreService.isCopilotIgnored(g)?void 0:g});m&&a.push(m)}return a}async getResources(r,n,o){let s=await this.queryModelForRequestedFiles(r,n,o);if(s?.length)return this.getFiles(s,n,o)}async queryModelForRequestedFiles(r,n,o){let s=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),c=await(this.props.input.type===1?Me.create(this.instantiationService,s,fte,{debuggerType:r,input:this.props.input,os:this.envService.OS}):Me.create(this.instantiationService,s,pte,{debuggerType:r,input:this.props.input,os:this.envService.OS})).render(void 0,o),l=await this.chatMLFetcher.fetchOne("referenceFiles",c.messages,void 0,o,2,s);if(l.type!=="success")return;let u;try{u=JSON.parse(l.value)}catch{return}if(Array.isArray(u))return this.props.input.type===0&&(u.push("launch.json"),this.props.input.userQuery||u.push("README.md")),n?.report(new xi("Requesting resources")),u}async getSchema(r,n,o){if(!r)return;let s=FTe(r,this.extensionsService);if(s)return n?.report(new xi("Identified launch config properties")),s}async getDebuggerType(r,n){let o=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),a=await Me.create(this.instantiationService,o,mte,{debuggerTypes:this.getAllDebuggerTypes(),input:this.props.input,os:this.envService.OS}).render(void 0,n),c=await this.chatMLFetcher.fetchOne("debugType",a.messages,void 0,n,2,o);if(c.type==="success")return/`(.*?)`/.exec(c.value)?.[1]||c.value}getAllDebuggerTypes(){return this.extensionsService.allAcrossExtensionHosts.filter(r=>!!r.packageJSON?.contributes?.debuggers).map(r=>{let n=[];for(let o of r.packageJSON?.contributes?.debuggers)o.type==="*"||o.deprecated||n.push(`- ${o.type}: ${o.label} (${r.id})`);return n}).flat()}async searchDocsSearchForContext(r,n){if(this.props.input.type!==0||!this.props.input.userQuery)return[];try{return await this.docSearchClient.search(this.props.input.userQuery,{repo:"microsoft/vscode-docs"},{limit:r,similarity:.75},n)}catch(o){return this.logService.public.error(o,"Failed to search docs search for query"),[]}}render(r,n){let o=this.props.input.type===1?1:0;return vscpp(vscppf,null,vscpp(rn.SystemMessage,{priority:1e3},o===1?vscpp(vscppf,null,"You are a Visual Studio Code assistant who specializes in debugging and creating launch configurations. Your task is to create a launch configuration for the user's query.",vscpp("br",null)):vscpp(vscppf,null,"You are a Visual Studio Code assistant who specializes in debugging, searching for existing launch configurations, and creating launch configurations. Your task is to find an existing launch configuration that matches the query or to create a launch configuration for the user's query if no match is found. If there's no query, still provide a response, checking for existing configurations in the launch.json file, if any.",vscpp("br",null)),vscpp(hr,null),vscpp(ct,null),o===0&&vscpp(vscppf,null,"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null)),"Print out only the VS Code `launch.json` file needed to debug the command, formatted as JSON.",vscpp("br",null),"Pay attention to my operating system and suggest the best tool for the platform I'm working on. For example, for debugging native code on Windows, you would not suggest the `lldb` type.",vscpp("br",null),"If there are unknowns, such as the path to the program, use the `inputs` field in the launch.json schema to prompt the user with an informative message. Input types may either be `promptString` for free text input or `pickString` with an `options` array for enumerations.",vscpp("br",null),"Do not give any other explanation. Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"If there are unknowns, such as the path to the program, use the `inputs` field in the launch.json schema to prompt the user with an informative message. Input types may either be `promptString` for free text input or `pickString` with an `options` array for enumerations. Do not include a default value for the input field.",vscpp("br",null),"Always include the following properties in the launch.json file:",vscpp("br",null),"- type: the type of debugger to use for this launch configuration. Every installed debug extension introduces a type: node for the built-in Node debugger, for example, or php and go for the PHP and Go extensions.",vscpp("br",null),"- request:  the request type of this launch configuration. Currently, launch and attach are supported.",vscpp("br",null),"- name:  the reader-friendly name to appear in the Debug launch configuration dropdown.",vscpp("br",null),"If a result is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),oat(this.props.input.type,o),vscpp("br",null)),vscpp(It,{priority:600,history:this.props.history}),vscpp(rn.UserMessage,{priority:700},r.docSearchResults&&r.docSearchResults.length>0&&vscpp(vscppf,null,"Below is a list of information from the Visual Studio Code documentation which might be relevant to the question. ",vscpp("br",null)),r.docSearchResults&&r.docSearchResults.map(s=>{s?.title&&s.contents&&(rn.TextChunk,s?.title?.trim(),s.path,s.contents)})),vscpp(rn.UserMessage,{priority:850},r.schema&&vscpp(vscppf,null,"Below is a list of properties that the launch config might include. ",vscpp("br",null),r.schema.map(s=>vscpp(rn.TextChunk,null,s,vscpp("br",null))),")",vscpp("br",null))),vscpp(rn.UserMessage,{priority:800},r.resources&&r.resources.length>0&&vscpp(vscppf,null,"Below is a list of resources from the workspace that might be useful in building the launch config. ",vscpp("br",null)),r.resources&&r.resources.map(s=>vscpp(Fp,{variableName:(0,Nx.basename)(s.path),variableValue:s}))),vscpp(rn.UserMessage,{priority:700},this.props.input.type===0&&vscpp(vscppf,null,"If a program property is included in the launch config, and its path does not exist in the workspace or there are multiple files that could work, use the `inputs` field in the launch.json schema to prompt the user with an informative message.",vscpp("br",null)),vscpp(vs,{maxSize:1e3})),vscpp(rn.UserMessage,{priority:850},this.props.input.type===0&&vscpp(vscppf,null,"If the resources contain a launch.json, and ",this.props.input.userQuery," is non-empty, search in that file for an existing configuration based on the query. Pay particular attention to the name of the launch configuration and compare it to the query. If a match is found, include that configuration. Do not include the whole launch.json context. End the response with HAS_MATCH.",vscpp("br",null),"If the resources contain a launch.json and ",this.props.input.userQuery," is empty, scan the README.md, if any, to determine which configuration is recommended. Show some, not all, of the launch configurations that are available. End the response with HAS_CONFIG_NO_QUERY.",vscpp(vscppf,null),vscpp("br",null),"If no match is found, include the new configuration that was generated. End the response with GENERATED_CONFIG.",vscpp("br",null))),vscpp(VE,{priority:900,input:this.props.input,os:this.envService.OS}))}};ny=E([y(1,qe),y(2,yt),y(3,xe),y(4,j),y(5,wc),y(6,ie),y(7,dC),y(8,Rt),y(9,mr),y(10,Te),y(11,gt)],ny);var pte=class extends rn.PromptElement{render(e,r){return vscpp(vscppf,null,vscpp(rn.SystemMessage,{priority:10},"You are a Visual Studio Code assistant who specializes in debugging and creating launch configurations. Your job is to return an array of file names that may contain useful information to translate a user query into a VS Code debug configuration.",vscpp("br",null),`If a user's query includes "task", include "tasks.json" in the response.`,vscpp("br",null),"Do not give any other explanation and return only a JSON array of strings. Avoid wrapping the whole response in triple backticks. Do not include any other information in your response.",vscpp("br",null),vscpp(rn.TextChunk,{priority:8},"# Example 1",vscpp("br",null),"## User: ",vscpp("br",null),"Create node app launch configuration",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["package.json","index.js","app.js"]),vscpp("br",null),vscpp("br",null),"# Example 2",vscpp("br",null),"## User: ",vscpp("br",null),"Launch a rust app with lldb",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["Cargo.toml","src/main.rs"]),vscpp("br",null),vscpp("br",null),"# Example 3",vscpp("br",null),"## User: ",vscpp("br",null),"Launch a go app",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["main.go","go.mod"]),vscpp("br",null),vscpp("br",null))),vscpp(rn.UserMessage,{priority:7},vscpp(vs,{maxSize:1e3})),vscpp(VE,{priority:4,...this.props}))}},fte=class extends rn.PromptElement{render(e,r){return vscpp(vscppf,null,vscpp(rn.SystemMessage,{priority:10},"You are a Visual Studio Code assistant who specializes in debugging and creating launch configurations. Your job is to return an array of file names that may contain useful information to translate a command line invocation into a VS Code debug configuration.",vscpp("br",null),"For example, when running a task `make tests`, you should ask for the `Makefile` because it contains information about how the tests are run.",vscpp("br",null),`If a user's query includes "task", include "tasks.json" in the response.`,vscpp("br",null),"Do not give any other explanation and return only a JSON array of strings. Avoid wrapping the whole response in triple backticks. Do not include any other information in your response.",vscpp("br",null),vscpp(rn.TextChunk,{priority:8},"# Example",vscpp("br",null),"## User: ",vscpp("br",null),"`npm run start`",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["package.json"]),vscpp("br",null),vscpp("br",null),"# Example",vscpp("br",null),"## User: ",vscpp("br",null),"cargo run",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["Cargo.toml"]),vscpp("br",null),vscpp("br",null))),vscpp(rn.UserMessage,{priority:7},vscpp(vs,{maxSize:1e3})),vscpp(VE,{priority:4,...this.props}))}},VE=class extends rn.PromptElement{render(){return this.props.input.type===0&&this.props.input.userQuery?vscpp(rn.UserMessage,null,"Here's a description of the app I want to debug: ",this.props.input.userQuery,this.props.debuggerType?` and the debugging type: ${this.props.debuggerType}`:""):this.props.input.type===0?this.props.debuggerType?vscpp(rn.UserMessage,null,"I want to use the $",this.props.debuggerType," debug type for my configuration."):vscpp(rn.UserMessage,null,"Find an existing launch config for my app or create one based on my project stucture and workspace"):vscpp(rn.UserMessage,null,"My operating system is ",this.props.os,".",vscpp("br",null),"In the working directory `",(this.props.input.relativeCwd||this.props.input.absoluteCwd).replaceAll("\\","/"),"`, I ran this on the command line:",vscpp("br",null),"```\n"+this.props.input.args.map(e=>e.replaceAll(`
`,"\\n")).join(` \\
  `)+"\n```")}},mte=class extends rn.PromptElement{render(e,r){let n=this.props.input.type===1;return vscpp(vscppf,null,vscpp(rn.SystemMessage,{priority:10},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"You are a debugging expert. Your job is to return the debug type to use for launch config for the given use case.",vscpp("br",null),"Pay attention to my operating system and suggest the best tool for the platform I'm working on. For example, for debugging native code on Windows, you would not suggest the `lldb` type.",vscpp("br",null),this.props.input.type===1&&vscpp(vscppf,null,"The command I give you is used to run code that I'm working on. Although the command itself might not directly be my program, you should suggest a tool to debug the likely language I'm working in.",vscpp("br",null)),"The user will list the debug types they have installed, but this is not a complete list of debug types available. You may suggest a type outside of that list if it's a better fit.",vscpp("br",null),vscpp("br",null),vscpp(rn.TextChunk,{priority:8},"# Example 1",vscpp("br",null),"## User: ",vscpp("br",null),n?"npx mocha":"Node.js",vscpp("br",null),"## Response:",vscpp("br",null),"`node`",vscpp("br",null),vscpp("br",null),"# Example 2",vscpp("br",null),"## User: ",vscpp("br",null),n?"python3 example.py":"Python",vscpp("br",null),"## Response:",vscpp("br",null),"`debugpy`",vscpp("br",null),vscpp("br",null),"# Example 3",vscpp("br",null),"## User: ",vscpp("br",null),n?"mvn test -Dtest=TestCircle":"Java",vscpp("br",null),"## Response:",vscpp("br",null),"`java`",vscpp("br",null),vscpp("br",null)),"Suggest the right debug type for my use case. Print ONLY the debug type. NEVER print any other explanation.",vscpp("br",null)),vscpp(qi,{flexGrow:1,priority:7}),vscpp(VE,{...this.props,priority:6}),vscpp(rn.UserMessage,{priority:5,flexGrow:1},vscpp(rn.TextChunk,null,"Here are the debug types I have installed:"),vscpp(rn.TextChunk,{flexGrow:1,breakOnWhitespace:!0},this.props.debuggerTypes.join(`
`))))}};async function sat(t,e){for(;;){let r=await e(t);if(r!==void 0)return r;let n=kM(t);if(n===t)return;t=n}}var Q7=ne("IDebugCommandToConfigConverter"),HE=class{constructor(e,r,n,o,s,a){this.endpointProvider=e;this.instantiationService=r;this.chatMLFetcher=n;this.workspace=o;this.telemetry=s;this.extensionsService=a}async convert(e,r,n){let o=cat(e,this.workspace),s=await this.endpointProvider.getChatEndpoint("gpt-4"),c=await Me.create(this.instantiationService,s,ny,{input:{type:1,relativeCwd:o?.path,absoluteCwd:e,args:r},history:[]}).render(void 0,n),l=await this.chatMLFetcher.fetchOne("debugCommandToConfig",c.messages,void 0,n,3,s);if(l.type!=="success")return{ok:!1,config:void 0,text:l.reason,workspaceFolder:o?.folder};let u=Y7(l.value,this.extensionsService);return this.telemetry.sendMSFTTelemetryEvent("onboardDebug.configGenerated",{configType:u?.configurations[0].type},{ok:u?1:0}),{ok:!0,config:u,text:l.value,workspaceFolder:o?.folder}}};HE=E([y(0,xe),y(1,j),y(2,yt),y(3,qe),y(4,ge),y(5,wc)],HE);function cat(t,e){let r;for(let n of e.getWorkspaceFolders()){let o=(0,GE.relative)(n.fsPath,t),s=(0,GE.isAbsolute)(o)?1/0:X1(o,"..");(!r||s<r.distance||s===r.distance&&o.length<r.rel.length)&&(r={rel:(0,GE.join)("${workspaceFolder}",o).replaceAll("\\","/"),distance:s,folder:n})}return r&&{folder:r.folder,path:r.rel}}var BTe="copilot-chat.terminalToDebugging.configs",uat=30,zE=class{constructor(e,r,n,o,s,a,c){this.interactor=e;this.telemetry=r;this.context=n;this.commandToConfig=o;this.extensionsService=s;this.workspaceService=a;this.launchConfigService=c}async start({args:e,cwd:r,forceNew:n,printOnly:o,save:s},a){this.telemetry.sendMSFTTelemetryEvent("onboardDebug.commandExecuted",{binary:e[0]});let c=this.tryMatchExistingConfig(r,e);if(!c||n){this.interactor.isGenerating();let p=await this.commandToConfig.convert(r,e,a);if(!p.ok)return{kind:0,text:p.text};this.interactor.didGenerate(),c={args:e,cwd:r,folder:p.workspaceFolder,inputs:[],config:p.config},this.telemetry.sendMSFTTelemetryEvent("onboardDebug.configGenerated",{binary:e[0],debugType:c.config.configurations[0].type})}let l=c.config.configurations[0],u=c.folder&&this.workspaceService.getWorkspaceFolder(He.revive(c.folder));if(o||s)return this.saveConfigInLRU(c),s&&await this.save(c.config,u),{kind:1,folder:u,config:l};if(!this.hasMatchingExtension(l))return{kind:2,debugType:l.type};let d=await this.launchConfigService.resolveConfigurationInputs(c.config,new Map(c.inputs),this.interactor);return d?(c.inputs=[...d.inputs],this.saveConfigInLRU(c),{kind:1,folder:u,config:d.config}):{kind:3}}async save(e,r){await this.launchConfigService.add(r,e),r&&await this.launchConfigService.show(r,e.configurations[0].name)}hasMatchingExtension(e){for(let r of this.extensionsService.allAcrossExtensionHosts){let n=r.packageJSON?.contributes?.debuggers;if(Array.isArray(n)&&n.some(o=>o&&o.type===e.type))return!0}return!1}tryMatchExistingConfig(e,r){let n=this.readStoredConfigs(),o=n.findIndex(s=>s.cwd===e&&Am(s.args,r));if(o!==-1)return n[o]}readStoredConfigs(){return this.context.workspaceState.get(BTe,[])}saveConfigInLRU(e){let r=this.readStoredConfigs().slice(),n=r.indexOf(e);for(n>=1&&r.splice(n,1),r.unshift(e);r.length>uat;)r.pop();this.context.workspaceState.update(BTe,r)}};zE=E([y(1,ge),y(2,Bt),y(3,Q7),y(4,wc),y(5,qe),y(6,jE)],zE);var qTe=require("stream"),X7=class extends qTe.Transform{constructor(r){super();this.prefix=[];this.splitSuffix=Buffer.alloc(0);if(typeof r=="string"&&r.length===1)this.splitter=r.charCodeAt(0);else if(typeof r=="number")this.splitter=r;else throw new Error("not implemented here")}_transform(r,n,o){let s=0;for(;s<r.length;){let a=r.indexOf(this.splitter,s);if(a===-1)break;let c=r.subarray(s,a),l=this.prefix.length||this.splitSuffix.length?Buffer.concat([...this.prefix,c,this.splitSuffix]):c;this.push(l),this.prefix.length=0,s=a+1}s<r.length&&this.prefix.push(r.subarray(s)),o()}_flush(r){this.prefix.length&&this.push(Buffer.concat([...this.prefix,this.splitSuffix])),r()}};var J7=class{constructor(e){this.stream=e;this.methods=new Map;this.pendingRequests=new Map;this.idCounter=0,this.stream.pipe(new X7(0)).on("data",r=>this.handleData(r))}registerMethod(e,r){this.methods.set(e,r)}async callMethod(e,r){let n=this.idCounter++,o={id:n,method:e,params:r},s=new Promise((a,c)=>{this.pendingRequests.set(n,{resolve:a,reject:c})});return this.stream.write(JSON.stringify(o)+"\0"),s}async handleData(e){let r=JSON.parse(e.toString());if("method"in r){let{id:n,method:o,params:s}=r,a={id:n};try{if(this.methods.has(o)){let c=await this.methods.get(o)(s);a.result=c}else throw new Error(`Method not found: ${o}`)}catch(c){a.error={code:-1,message:String(c)}}this.stream.write(JSON.stringify(a)+"\0")}else{let{id:n,result:o,error:s}=r,a=this.pendingRequests.get(n);this.pendingRequests.delete(n),o!==void 0?a?.resolve(o):s!==void 0&&a?.reject(new Error(s.message))}}};var Z7=q(require("vscode"));var jTe="__copilotTrackedSession",VTe=(t,e,r)=>{let n=ir(),o=new ht,s=!1,a=new Set;function c(l,u){r.callMethod("exit",{code:l,error:u}),o.dispose()}r.registerMethod("stop",()=>(a.forEach(l=>Z7.debug.stopDebugging(l)),Promise.resolve())),o.add(Z7.debug.registerDebugAdapterTrackerFactory("*",{createDebugAdapterTracker(l){if(l.configuration[jTe]!==n&&(!l.parentSession||!a.has(l.parentSession)))return;let u=!s;return s=!0,a.add(l),{onWillStartSession(){u&&r.callMethod("started",{})},onDidSendMessage(d){d.type==="event"&&d.event==="output"&&d.body.output&&r.callMethod("output",d.body)},onError(d){u&&c(1,String(d))},onExit(d,p){u&&c(d??0,p)},onWillStopSession(){u&&c(0)}}}})),Z7.debug.startDebugging(t,{...e,[jTe]:n}).then(l=>{l||c(1)})};var HTe="copilot-chat.terminalToDebugging.registered",GTe="PATH",eU="copilot-debug",zTe="github.copilot.chat.debugTerminalCommands",tU="copilotDebugCommand.js",$E=class extends Oe{constructor(r,n,o){super();this.context=r;this.logService=n;this.instantiationService=o;this._register(qa.window.registerUriHandler(this)),this._register(qa.workspace.onDidChangeConfiguration(s=>{s.affectsConfiguration(zTe)&&(this.registerSerializer=this.registerSerializer.then(()=>this.registerEnvironment()))})),this.registerSerializer=this.registerEnvironment()}handleUri(r){let n=process.platform==="win32"?"\\\\.\\pipe\\"+r.path.slice(1):r.path.substring(1),o=new Uo,s=(0,$Te.connect)(n,()=>{this.logService.public.info(`Got a debug connection on ${n}`);let a=new J7(s),c=this.instantiationService.createInstance(zE,{didGenerate:()=>a.callMethod("didGenerate"),isGenerating:()=>a.callMethod("isGenerating"),prompt:async(l,u)=>await qa.window.showInputBox({prompt:l,value:u,ignoreFocusOut:!0})});a.registerMethod("start",async l=>{let u=await c.start(l,o.token);return u.kind===1&&!(l.printOnly||l.save)&&VTe(u.folder&&qa.workspace.getWorkspaceFolder(u.folder),{...u.config,internalConsoleOptions:"neverOpen"},a),u})});s.on("error",a=>{this.logService.public.error(`Error connecting to debug client on ${n}: ${a}`),o.dispose(!0)}),s.on("end",()=>{o.dispose(!0)})}getVersionNonce(){return this.context.extensionMode!==qa.ExtensionMode.Production?String(Date.now()):qa.extensions.getExtension(jm)?.packageJSON.version??String(Date.now())}async registerEnvironment(){let r=qa.workspace.getConfiguration().get(zTe,!1),n=this.context.globalStorageUri;if(!n||n.scheme!=="file")return;let o=vf.join(this.context.globalStorageUri.fsPath,"debugCommand"),s=this.context.globalState.get(HTe),a=this.getVersionNonce();if(!r)s&&(this.context.environmentVariableCollection.delete(GTe),await Lx.promises.rm(s.location,{recursive:!0,force:!0}));else if(!s)await this.fillStoragePath(o),this.context.environmentVariableCollection.append(GTe,vf.delimiter+o);else if(s.version!==a)await this.fillStoragePath(o);else return;this.context.globalState.update(HTe,r?{location:o,version:a}:void 0)}async fillStoragePath(r){let n=qa.Uri.from({scheme:qa.env.uriScheme,authority:jm});if(await Lx.promises.mkdir(r,{recursive:!0}),process.platform==="win32")await Lx.promises.writeFile(vf.join(r,`${eU}.bat`),pat(r,n));else{let o=vf.join(r,eU);await Lx.promises.writeFile(o,dat(r,n)),await Lx.promises.chmod(o,488)}await Lx.promises.copyFile(vf.join(__dirname,tU),vf.join(r,tU))}};$E=E([y(0,Bt),y(1,ie),y(2,j)],$E);var dat=(t,e)=>`#!/bin/sh
ELECTRON_RUN_AS_NODE=1 NODE_OPTIONS="" "${process.execPath}" "${vf.join(t,tU)}" "${e}" "$@"`,pat=(t,e)=>`@echo off
SET ELECTRON_RUN_AS_NODE=1
SET NODE_OPTIONS=""
"${process.execPath}" "${vf.join(t,tU)}" "${e}" %*
`;var _L=q(require("vscode"));var KTe=q(require("path"));var Th=q(Ue());var fat=/\s*(?:. )?([a-z0-9_-]+)\s*/,rU=ne("ILanguageToolsProvider"),WE=class{constructor(e,r,n){this.endpointProvider=e;this.instantiationService=r;this.chatMLFetcher=n}async getToolsForLanguages(e,r){let n=await this.endpointProvider.getChatEndpoint("gpt-4"),s=await Me.create(this.instantiationService,n,hte,{languages:e}).render(void 0,r),a=await this.chatMLFetcher.fetchOne("debugCommandIdentifier",s.messages,void 0,r,3,n);return a.type!=="success"?{ok:!1,commands:[]}:{ok:!0,commands:a.value.split(`
`).map(c=>fat.exec(c)?.[1]).filter(c=>!!c)}}};WE=E([y(0,xe),y(1,j),y(2,yt)],WE);var hte=class extends Th.PromptElement{render(e,r){return vscpp(vscppf,null,vscpp(Th.SystemMessage,{priority:10},"You are an AI programming assistant that is specialized for usage of command-line tools developers use to build software.",vscpp("br",null),"I'm working on software in the given following languages. Please list the names of common command-line tools I might use to build and test my software.",vscpp("br",null),"Do NOT list tools that don't run my code, such as those used only for linting. For example, if I ask for JavaScript, the list should include tools like node, npx, and mocha, but not eslint.",vscpp("br",null),"Be thorough! Try to give a list of *at least* 10 such tools.",vscpp("br",null),"Print these tools out as a list, separated by commas. Do NOT print any additional explanation or context.",vscpp("br",null),vscpp(Th.TextChunk,{priority:8},"# Example",vscpp("br",null),"## User: ",vscpp("br",null),"- python",vscpp("br",null),"- rust",vscpp("br",null),"## Response:",vscpp("br",null),"- python",vscpp("br",null),"- pip",vscpp("br",null),"- cargo",vscpp("br",null),"- rustc",vscpp("br",null))),vscpp(Th.UserMessage,{priority:9},vscpp(Th.TextChunk,{breakOnWhitespace:!0,flexGrow:1},"The languages I'm working in are:",vscpp("br",null),this.props.languages.join(`
 -`))))}};var nU=ne("IDebuggableCommandIdentifier"),KE=class extends Oe{constructor(r,n,o,s,a){super();this.configurationService=r;this.context=n;this.languageToolsProvider=s;this.fileSystemService=a;this.recentlySeenLanguages=new Set;this._register(o.onDidOpenTextDocument(c=>{gat.includes(c.languageId)||this.recentlySeenLanguages.add(c.languageId)}))}async isDebuggable(r,n,o){if(!this.isGloballyEnabled())return!1;let s=mat(n).toLowerCase();return this.getSpecificTreatment(s)??this.isWellKnownCommand(s)??await this.isWorkspaceLocal(r,s)??await this.isModelSuggestedCommand(s,o)??!1}isGloballyEnabled(){return this.configurationService.getConfig(le.TerminalToDebuggerEnabled)}async isWorkspaceLocal(r,n){let o=KTe.default.isAbsolute(n)?He.file(n):r&&He.joinPath(r,n);if(o)try{return await this.fileSystemService.stat(o),!0}catch{}}async isModelSuggestedCommand(r,n){let o=this.loadModelKnownCommands();for(let l of o.languages)this.recentlySeenLanguages.delete(l);if(o.commands.some(l=>r.includes(l)))return!0;if(!this.recentlySeenLanguages.size)return!1;let s=[...this.recentlySeenLanguages];this.recentlySeenLanguages.clear();let{commands:a,ok:c}=await this.languageToolsProvider.getToolsForLanguages(s,n);return c&&this.storeModelKnownCommands({languages:o.languages.concat(s),commands:vM(o.commands.concat(a))}),a.some(l=>r.includes(l))}isWellKnownCommand(r){return hat.some(n=>r.includes(n))||void 0}getSpecificTreatment(r){let n=this.configurationService.getConfig(le.TerminalToDebuggerPatterns);for(let o of n){if(o.startsWith("!")&&r.includes(o))return!1;if(r.includes(o))return!0}}loadModelKnownCommands(){return this.context.globalState.get(WTe,{languages:[],commands:[]})}storeModelKnownCommands(r){return this.context.globalState.update(WTe,r)}};KE=E([y(0,he),y(1,Bt),y(2,qe),y(3,rU),y(4,mr)],KE);var WTe="chat.debuggableCommands";function mat(t){let r=/\s*([^\s]+)/.exec(t);return r?r[1]:t}var hat=["abap","ant","automake","autotools","ava","babel","bcp","behat","behave","biber","bibtex","bmake","boot","broccoli-sass","browserify","build_runner","bundler","busted","cabal","cargo","cargo-bench","cargo-fuzz","cargo-make","cargo-run","cargo-test","cargo-watch","carthage","carton","clang","clippy-driver","clj","clojure","cmake","cocoapods","codeception","common_test","composer","conan","coverage","cpan","cpanm","csc","ct_run","ctest","cucumber","cuda-gdb","cuda-memcheck","cypress","dart","dart-sass","dart2js","dartanalyzer","dartdevc","db2cli","ddemangle","devenv","devtools","dfix","dialyzer","dmd","doctest","dotnet","dotnet-script","dotnet-test-nunit","dotnet-test-xunit","dpp","dscanner","dsymutil","dub","dune","dustmite","dvilualatex","dvipdf","dvipdfmx","dvips","erl","erlang","erlc","esbuild","escript","eunit","eyeglass","fastlane","fennel","flutter","forever","fpc","fsharpc","fsi","g","gaiden","gcc","gcov","gdb","gdc","ghc","ghcid","gmake","gmaven","go","gpars","gradle","grape","griffon","grinder","grip","groovy","groovyc","grunt","grunt-sass","gulp","gulp-sass","hdevtools","hlint","hspec","irb","isql","jasmine","java","javac","jazzy","jdeps","jest","jlink","julia","junit","kaocha","karma","kobalt","kotest","kotlin-dsl","kotlinc","kscript","latexmk","lazbuild","lcov","ld","ldc2","ldoc","leiningen","lldb","lua","luacheck","luajit","lualatex","luarocks","luaunit","make","markdown","markdown-it","markdown-pdf","marked","matlab","maven","mbuild","mcc","md2pdf","mdbook","merlin","mex","midje","minitest","mlint","mmake","mocha","mockk","mono","moonscript","msbuild","mssql-cli","mstest","multimarkdown","mysql","ncu","ninja","nmake","node","node-sass","nose","npm","npx","nrepl","nsight","nsys","nunit-console","nvcc","ocamlbuild","ocamlc","ocamldebug","ocamlfind","ocamlopt","ocamlrun","opam","otest","otool","paket","panda","pandoc","parcel","pdflatex","perl","perl6","perlbrew","pgbench","phing","php","php-cs-fixer","phpcs","phpdbg","phpstan","phpunit","pip","pipenv","plackup","playwright","pm2","pmake","powershell","ppc386","ppcrossarm","ppcrossavr","ppcrossmips","ppcrossppc","ppcrosssparc","ppcrosswin32","ppcrossx64","protractor","prove","pry","psql","psysh","pub","pwsh","pytest","python","qmake","quickcheck","rails","rake","rakudo","rdmd","react-scripts","rebar3","relx","remake","rollup","rspec","rubocop","ruby","runghc","rustc","rustup","sass","sassc","scons","showdown","sinatra","speclj","spek","spock","spring-boot","sqlcmd","sqlite3","sqsh","stack","svelte-kit","swift","swiftc","test","test-runner","testng","testthat","tools","torch","tox","ts-node","tsc","unittest","utop","valgrind","vbc","virtualenv","vite","vstest","vue-cli-service","vue-test-utils","webdev","webpack","x","xcodebuild","xctest","xelatex","xunit","yarn","zef","zig"],gat=["abap","bat","bibtex","c","clojure","code-refactoring","coffeescript","cpp","csharp","css","cuda-cpp","d","dart","diff","dockercompose","dockerfile","erlang","fsharp","git-commit","git-rebase","github-issues","go","graphql","groovy","haml","handlebars","haskell","html","ini","jade","java","javascript","javascriptreact","json","jsonc","julia","kotlin","latex","less","log","lua","makefile","markdown","matlab","objective-c","objective-cpp","ocaml","pascal","perl","perl6","php","pip-requirements","plaintext","powershell","pug","python","r","razor","ruby","rust","sass","scss","shaderlab","shellscript","slim","snippets","sql","stylus","svelte","swift","tex","text","toml","typescript","typescriptreact","vb","vue","vue-html","xml","xsl","yaml","zig"];var vat="copilot-chat.terminalToDebugging",YE=class extends Oe{constructor(r){super();this.debuggableCommandIdentifier=r;this.lastExecutionFor=new Map;this._register(_L.window.registerTerminalQuickFixProvider(vat,this)),this._register(_L.window.onDidCloseTerminal(n=>{this.lastExecutionFor.delete(n)})),this._register(_L.window.onDidEndTerminalShellExecution(n=>{this.lastExecutionFor.set(n.terminal,n)}))}async provideTerminalQuickFixes(r,n){let s=_L.window.activeTerminal?.shellIntegration?.cwd;if(await this.debuggableCommandIdentifier.isDebuggable(s,r.commandLine,n))return{terminalCommand:`${eU} ${r.commandLine}`,shouldExecute:!1}}};YE=E([y(0,nU)],YE);var Ko=q(require("vscode"));var iU=require("path"),XE=q(require("vscode"));var gte="---------------------------------",QE=class{constructor(e){this._instantiationService=e}async reportInline(e,r,n){if(!await this._instantiationService.createInstance(iy).canReport())return;let s=e.getLatestTurn();if(!s)return;let a=r.intent?this._embedCodeblock("INTENT",r.intent.id):"",c=this._embedCodeblock("CONTEXT",JSON.stringify({document:r.document.uri.toString(),fileIndentInfo:r.fileIndentInfo,language:r.language,wholeRange:r.wholeRange,selection:r.selection},null,"	")),l="",u=s.chatMessages;if(u&&u.length>0){let m=u.map(h=>this._embedCodeblock(h.role.toUpperCase(),h.content)).join(`
`);l=`	${gte}
${this._headerSeparator()}PROMPT MESSAGES:
${m}`}else l=this._embedCodeblock(s.request.type.toUpperCase(),s.request.message);let d=this._embedCodeblock("ASSISTANT",s.response?.message||""),p=this._embedCodeblock("Interaction outcome",JSON.stringify(n,null,"	")),f=[];YTe(f,a,c,l,d,p),QTe(f,s),await this._reportIssue("Feedback for inline chat",f.join(`
`))}async reportChat(e){if(!await this._instantiationService.createInstance(iy).canReport())return;let n="",o=e.chatMessages;if(o&&o.length>0){let d=o.map(p=>this._embedCodeblock(p.role.toUpperCase(),p.content)).join(`
`);n=`	${gte}
${this._headerSeparator()}PROMPT MESSAGES:
${d}`}else n=this._embedCodeblock(e.request.type.toUpperCase(),e.request.message);let s=e.intentInvocation?.intent?this._embedCodeblock("INTENT",`[${e.intentInvocation.intent.id}] ${e.intentInvocation.intent.description}`):"",a=this._embedCodeblock("ASSISTANT",e.response?.message||""),c=await this._instantiationService.createInstance(cx).captureWorkspaceStateSnapshot([]),l=this._embedCodeblock("WORKSPACE STATE",JSON.stringify(c,null,2)),u=[];YTe(u,s,n,a,l),await QTe(u,e),await this._reportIssue("Feedback for sidebar chat",u.join(`
`))}_embedCodeblock(e,r){let n=this._bodySeparator()+r.split(`
`).join(`
${this._bodySeparator()}`);return`	${gte}
${this._headerSeparator()}${e}:
${n}`}_headerSeparator(){return"	"}_bodySeparator(){return"		"}async _reportIssue(e,r){await XE.commands.executeCommand("workbench.action.openIssueReporter",{extensionId:jm,issueTitle:e,data:r,issueBody:"",uri:XE.Uri.parse("https://github.com/microsoft/vscode-copilot")})}};QE=E([y(0,j)],QE);function YTe(t,...e){t.push("<details><summary>Prompt Details</summary>","<p>",...e,"</p>","</details>")}async function QTe(t,e){let r=await vte(e);r&&t.push("<details><summary>STest</summary>","<p>","STest code:","","```ts",...r,"```","</p>","</details>")}async function vte(t){let e=t.intentInvocation;if(e){if(e.location===1)return yat(t);if(e.location===2&&e.intent.id==="edit")return bat(t)}}function yat(t){let e=t.requestDebugInformation;if(!e)return;let r=(0,iU.basename)(e.uri.path),n=o=>JSON.stringify(o);return[`stest({ description: 'Issue #XXXXX', language: ${n(e.languageId)}, model }, (testingServiceCollection) => {`,"	return simulateInlineChat(testingServiceCollection, {","		files: [toFile({",`			fileName: ${n(`${e.intentId}/issue-XXXXX/${r}`)},`,`			fileContent: ${n(e.initialDocumentText)}`,"		})],","		queries: [","			{",`				file: ${n(r)},`,`				selection: ${n(XTe(e.userSelection))},`,`				query: ${n(e.userPrompt)},`,"				diagnostics: 'tsc',",`				expectedIntent: ${n(e.intentId)},`,"				validate: async (outcome, workspace, accessor) => {","					assertInlineEdit(outcome);","					await assertNoDiagnosticsAsync(accessor, outcome, workspace, KnownDiagnosticProviders.tscIgnoreImportErrors);","				}","			}","		]","	});","});"]}function XTe(t){return[t.start.line,t.start.character,t.end.line,t.end.character]}async function bat(t){let e=t.requestDebugInformation,r=s=>JSON.stringify(s),n=[],o=async s=>{try{if(s.scheme!=="file")return;let a=await XE.workspace.openTextDocument(s),c=(0,iU.basename)(s.path),l=0;for(;n.find(u=>u.name===c);)c=`${c}_${++l}`;n.push({name:c,fileContent:a.getText()})}catch{}};for(let s of t.references)if(s instanceof Bo.PromptReference){let a=s.anchor;if(ah(a))await o(a);else if(b2(a))await o(a.uri);else if(a.variableName==="file"){let c=a.value;ah(c)?await o(c):b2(c)&&await o(c.uri)}}return["stest({ description: 'Issue #XXXXX' }, (testingServiceCollection) => {","	return simulatePanelCodeMapper(testingServiceCollection, {","		files: [",...n.map(s=>`			toFile({ fileName: ${r(`multiFile/issue-XXXXX/${s.name}`)}, fileContent: ${r(s.fileContent)} }),`),"		],","		queries: [","			{",`				file: ${e?r((0,iU.basename)(e.uri.path)):void 0},`,`				selection: ${e?r(XTe(e.userSelection)):void 0},`,`				query: ${r(t.request.message)},`,"				validate: async (outcome, workspace, accessor) => {","					assertWorkspaceEdit(outcome);","					assert.strictEqual((await getWorkspaceDiagnostics(accessor, workspace, 'tsc')).filter(d => d.kind === 'syntactic').length, 0);","				}","			}","		]","	}); ","}); "]}var iy=class{constructor(e,r){this._configurationService=e;this._authenticationService=r;this.debugReportFeedback=cs(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.DebugReportFeedback))}async canReport(){return!(!this._configurationService.getConfig(le.DebugReportFeedback)||!(await this._authenticationService.getCopilotToken())?.isInternal)}};iy=E([y(0,he),y(1,Tt)],iy);var JE=class extends Oe{constructor(r,n,o){super();this._conversationStore=r;this._instantiationService=n;this.launchConfigService=o;let s=this._instantiationService.createInstance(iy);this._register(Ul(a=>{let c=s.debugReportFeedback.read(a);Ko.commands.executeCommand("setContext","github.copilot.debugReportFeedback",c)})),this._register(Ko.commands.registerCommand("github.copilot.debug.generateSTest",async()=>{if(!await s.canReport())return;let a=this._conversationStore.lastConversation?.getLatestTurn();if(a){let c=await vte(a);c&&(Ko.env.clipboard.writeText(c.join(`
`)),Ko.window.showInformationMessage("STest copied to clipboard"))}})),this._register(Ko.commands.registerCommand("github.copilot.createLaunchJsonFileWithContents",async a=>{let c=Ko.workspace.workspaceFolders;if(!c){Ko.window.showErrorMessage("No workspace folder is open.");return}await o.add(c[0].uri,a),await o.show(c[0].uri,a.configurations[0].name)})),this._register(Ko.commands.registerCommand("github.copilot.debug.generateConfiguration",async()=>{await Ko.commands.executeCommand("workbench.action.chat.open","@vscode /startDebugging",{location:Ko.ChatLocation.Panel})})),this._register(Ko.commands.registerCommand("github.copilot.startDebugging",async(a,c)=>{let l=await this.launchConfigService.resolveConfigurationInputs(a);if(l?.config){await this.launchConfigService.launch(l?.config),c.progress(Ko.l10n.t("Started debugging {0}",l.config.name));return}else{c.markdown(Ko.l10n.t("Could not start debugging. Please try again."));return}}))}};JE=E([y(0,Qp),y(1,j),y(2,jE)],JE);var _te=q(require("vscode"));function bte(t){return/^[a-z][a-z0-9]*$/.test(t)?"lowercase":/^[a-z][a-zA-Z0-9]*$/.test(t)?"camelCase":/^[a-z]+(_[a-z0-9]+)*$/.test(t)?"snake_case":/^[a-z]+(-[a-z0-9]+)*$/.test(t)?"kebab-case":/^[A-Z][a-z0-9]*$/.test(t)?"Capitalized":/^[A-Z0-9]+(_[A-Z0-9]+)+$/.test(t)?"SCREAMING_SNAKE_CASE":/^[A-Z]+$/.test(t)?"Uppercase":/^[A-Z][a-zA-Z0-9]*$/.test(t)?"PascalCase":/^[A-Z][a-z0-9]*(_[a-z0-9]+)*$/.test(t)?"Capital_snake_case":"Unknown"}function yte(t){return t.map((e,r)=>r===0?e.toLowerCase():e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()).join("")}function _at(t){return t.map(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()).join("")}function oU(t){return t.map(e=>e.toLowerCase()).join("_")}function xat(t){return t.map(e=>e.toLowerCase()).join("-")}function JTe(t,e){let r=bte(t);if(r===e)return t;{let n=Sat(t,r);switch(e){case"camelCase":return yte(n);case"PascalCase":return _at(n);case"snake_case":return oU(n);case"SCREAMING_SNAKE_CASE":return oU(n).toUpperCase();case"Capital_snake_case":return oU(n).charAt(0).toUpperCase()+oU(n).substring(1);case"kebab-case":return xat(n);case"Capitalized":return yte(n).charAt(0).toUpperCase()+yte(n).substring(1);case"Uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();case"Unknown":return t}}}function Sat(t,e){switch(e){case"camelCase":case"PascalCase":return t.split(/(?=[A-Z])/);case"snake_case":case"SCREAMING_SNAKE_CASE":case"Capital_snake_case":case"kebab-case":return t.split(/[-_]/).map(r=>r.toLowerCase());case"Capitalized":case"Uppercase":case"lowercase":case"Unknown":return[t]}}var ew=q(Ue());var ZTe=q(Ue());var oy=class extends ZTe.PromptElement{constructor(r,n,o,s,a,c,l,u){super(r);this._languageFeaturesService=n;this._workspaceService=o;this._vscodeExtensionCtxService=s;this._ignoreService=a;this._logService=c;this._parserService=l;this._telemetryService=u}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){if(await this._ignoreService.isCopilotIgnored(this.props.document.uri))return{k:"ignored"};let r=this._vscodeExtensionCtxService.extensionMode===nl.Test?0:this.props.timeoutMs===void 0?oy.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,n=await this.findDefinition(r);return this._logService.internal.debug(`Found ${n.length} implementation(s)/definition(s)`),n.length>0&&this._logService.internal.debug("Implementation(s)/definition(s) found:"+JSON.stringify(n,null,"	")),{k:"found",definitions:n}}render(r,n){if(r.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.document.uri]});let{document:o,position:s}=this.props,{definitions:a}=r;if(a.length===0){let c=o.lineAt(s.line);a.push({languageId:o.languageId,uri:o.uri,code:c.text,excerptRange:c.range})}return vscpp(vscppf,null,"Relevant definition",a.length>1?"s":"",": ",vscpp("br",null),vscpp("br",null),a.map(c=>{let d=`${`${mn(c.languageId).lineComment.start} FILEPATH: ${c.uri.path}`}
${c.code}`;return vscpp(nt,{uri:c.uri,languageId:c.languageId,code:d})}))}async findDefinition(r){let{document:n,position:o}=this.props,s=async l=>{try{let u=await this._languageFeaturesService.getImplementations(n.uri,l);if(this._logService.internal.debug(`Found ${u.length} implementations`+JSON.stringify(u,null,"	")),u.length>0)return u}catch{}try{let u=await this._languageFeaturesService.getDefinitions(n.uri,l);if(this._logService.internal.debug(`Found ${u.length} definitions`+JSON.stringify(u,null,"	")),u.length>0)return u}catch{}return this._logService.internal.debug("No definitions or implementations found"),[]},a=await mc(this._logService,this._telemetryService,n,r*3,()=>s(o),[]),c=Dr(await Promise.all(a.map(async l=>{let u=Gm(l)?l.targetUri:n.uri;return await this._ignoreService.isCopilotIgnored(u)?void 0:l})));return Promise.all(c.map(async l=>{let{uri:u,range:d}=Gm(l)?{uri:l.targetUri,range:l.targetRange}:l,p=await this._workspaceService.openTextDocument(u),f=cl(p.languageId),m,h;if(f===void 0){let g=p.lineAt(d.start.line);m=g.text,h=g.range}else h=(await Tv(this._parserService,this._telemetryService,{document:p,language:mn(n.languageId),wholeRange:d,selection:new _p(d.start,d.end),fileIndentInfo:void 0})).range,m=p.getText(h);return{languageId:p.languageId,uri:p.uri,code:m,excerptRange:h}}))}};oy=E([y(1,jo),y(2,qe),y(3,Bt),y(4,Te),y(5,ie),y(6,dt),y(7,ge)],oy);var ZE=class extends ew.PromptElement{constructor(r,n,o){super(r);this.instaService=n;this.endpointProvider=o;let{document:s,range:a}=this.props;this._defAtPos=n.createInstance(new ye(oy,[{document:s,position:a.start}]))}async prepare(r,n,o){let{document:s,range:a}=this.props,c=await this._defAtPos.prepare();if(!(c.k==="found"&&c.definitions.some(d=>d.excerptRange.contains(this.props.range)))){let d=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),p={document:s,fileIndentInfo:void 0,language:mn(s.languageId),wholeRange:a,selection:new _p(a.start,a.end)};this._defAroundCursor=this.instaService.createInstance(Cv,{documentContext:p,endpointInfo:d})}return{defAtPositionState:c,defAroundCursorState:this._defAroundCursor?await this._defAroundCursor.prepare(r):void 0}}render(r,n){let{document:o,range:s}=this.props,a=o.getText(s),c=Iat(a),l=c?` keeping prefix '${c}'`:"",u=this._defAtPos.render(r.defAtPositionState,n),d=r.defAroundCursorState!==void 0&&this._defAroundCursor?.render(r.defAroundCursorState,n);return vscpp(vscppf,null,vscpp(ew.SystemMessage,null,"You are a distinguished software engineer.",vscpp("br",null),vscpp(ct,null),vscpp("br",null),'You must reply with a JSON array of strings of at least four new names, e.g., `["first", "second", "third", "fourth"]`.',vscpp("br",null),"You must respect existing naming conventions",l,"."),d,vscpp(ew.UserMessage,null,u!==void 0&&vscpp(vscppf,null,u,vscpp("br",null)),"Think of the purpose of `",a,"` in the given code. Think of several names that reflect what `",a,"` is and what it does",l,". Follow existing naming conventions. Reply with a JSON array of strings of at least four new names for `",a,"`."))}};ZE=E([y(1,j),y(2,xe)],ZE);function Iat(t){return t.match(/^([\\.\\$\\_]+)/)?.[0]}var Md=class{constructor(e,r,n,o,s,a,c){this._instaService=e;this._chatMLFetcher=r;this._ignoreService=n;this._telemetryService=o;this._configurationService=s;this._endpointProvider=a;this._simulationTestContext=c;this.supportsAutomaticTriggerKind=Promise.resolve(this.isEnabled(g2.Automatic))}isEnabled(e){return e===g2.Invoke?!0:this._configurationService.getConfig(le.AutomaticRenameSuggestions)}async provideNewSymbolNames(e,r,n,o){let s="",a=new Fo,c=e.getText(r);if(!this.isEnabled(n))throw new Error("CopilotFeatureUnavailableOrDisabled");if(await this._ignoreService.isCopilotIgnored(e.uri))throw new Error("CopilotIgnoredDocument");let l=e.languageId,u,d;if(o.isCancellationRequested)s="afterEnablementCheck";else{let p=await this._endpointProvider.getChatEndpoint("gpt-3.5-turbo");if(u=this.delayBeforeFetchMs,o.isCancellationRequested)s="afterRunParametersFetch";else{let f=new Fo(!1);f.reset();let m=await this._computePrompt(e,r,p,o),h=f.elapsed();if(o.isCancellationRequested)s="afterPromptCompute";else{d=a.elapsed();let g;if(n===g2.Automatic&&(g=u?Math.max(0,u-d):void 0,g!==void 0&&g>0&&await new Promise(v=>setTimeout(v,g))),o.isCancellationRequested)s="afterDelay";else{f.reset();let v=await this._chatMLFetcher.fetchOne("renameSuggestionsProvider",m.messages,void 0,o,3,p,void 0,{top_p:void 0,temperature:void 0}),b=f.elapsed();switch(o.isCancellationRequested&&(s="afterFetchStarted"),v.type){case"success":{let _=v.value,{replyFormat:x,symbolNames:S,redundantCharCount:I}=Md.parseResponse(_);return x==="unknown"&&this._sendInternalTelemetry({languageId:l,reply:_}),this._sendPublicTelemetry({triggerKind:n,languageId:l,cancellationReason:s,fetchResultType:v.type,promptConstructionTime:h,promptTokenCount:m.tokenCount,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:g,timeElapsedBeforeDelay:d,successResponseCharCount:_.length,responseUnusedCharCount:I,fetchTime:b,replyFormat:x,symbolNamesCount:S.length}),Md.preprocessSymbolNames({currentSymbolName:c,newSymbolNames:S,languageId:l}).map(k=>new qhe(k,[jhe.AIGenerated]))}default:return this._sendPublicTelemetry({triggerKind:n,languageId:l,cancellationReason:s,fetchResultType:v.type,promptConstructionTime:h,promptTokenCount:m.tokenCount,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:g,timeElapsedBeforeDelay:d,fetchTime:b}),null}}}}}return this._sendPublicTelemetry({triggerKind:n,languageId:l,cancellationReason:s,expectedDelayBeforeFetch:u,timeElapsedBeforeDelay:d}),null}get delayBeforeFetchMs(){return this._simulationTestContext.isInSimulationTests?0:250}_computePrompt(e,r,n,o){return Me.create(this._instaService,n,ZE,{document:e,range:r}).render(void 0,o)}static preprocessSymbolNames({currentSymbolName:e,newSymbolNames:r,languageId:n}){let o=bte(e),s;switch(o){case"lowercase":n==="python"?s="snake_case":s="camelCase";break;case"Uppercase":case"camelCase":case"PascalCase":case"snake_case":case"SCREAMING_SNAKE_CASE":case"Capital_snake_case":case"kebab-case":case"Capitalized":case"Unknown":s=o;break;default:return o}return s==="Unknown"?r:r.map(a=>JTe(a,s))}static parseResponse(e){let r=Md._parseReplyAsJSONStringArray(e);if(r!==void 0)return r;let n=Md._parseReplyAsList(e);return n!==void 0?n:{replyFormat:"unknown",symbolNames:[],redundantCharCount:e.length}}static _parseReplyAsJSONStringArray(e){let r=/\[.*?\]/gs,n=[...e.matchAll(r)];for(let o=0;o<n.length;o++){let s=n[o];try{let a=JSON.parse(s[0]);if(Array.isArray(a)){let c=a.filter(l=>typeof l=="string");if(c.length>0){let l=o===0?"jsonStringArray":"multiJsonStringArray",u=e.length-s[0].length;return{replyFormat:l,redundantCharCount:u,symbolNames:c.map(d=>d.trim())}}}}catch{}}}static _parseReplyAsList(e){let r=/(?:\d+[\.|\)]|[\*\-])\s*(.*)/g,n=e.matchAll(r),o=[];for(let a of n){let c=a[1].trim(),l=["'",'"',"`"];l.includes(c[0])&&(c=c.slice(1)),l.includes(c[c.length-1])&&(c=c.slice(0,-1)),c&&o.push(c)}return o.length===0?void 0:{replyFormat:"list",redundantCharCount:e.length-o.reduce((a,c)=>a+c.length,0),symbolNames:o}}_sendPublicTelemetry({triggerKind:e,languageId:r,cancellationReason:n,fetchResultType:o,timeElapsedBeforeDelay:s,promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:l,actualDelayBeforeFetch:u,successResponseCharCount:d,responseUnusedCharCount:p,fetchTime:f,replyFormat:m,symbolNamesCount:h}){this._telemetryService.sendMSFTTelemetryEvent("provideRenameSuggestions",{languageId:r,cancellationReason:n,fetchResultType:o,replyFormat:m,triggerKind:e===g2.Automatic?"automatic":"manual"},{promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:l,actualDelayBeforeFetch:u,timeElapsedBeforeFetch:s,fetchTime:f,successResponseCharCount:d,responseUnusedCharCount:p,symbolNamesCount:h})}_sendInternalTelemetry({languageId:e,reply:r}){this._telemetryService.sendMSFTTelemetryEvent("provideRenameSuggestionsIncorrectFormatResponse",{languageId:e,reply:r})}static _determinePrefix(e){return e.match(/^([\\.\\$\\_]+)/)?.[0]}};Md=E([y(0,j),y(1,yt),y(2,Te),y(3,ge),y(4,he),y(5,xe),y(6,Uv)],Md);var tw=class extends Oe{constructor(r){super();this.instantiationService=r;"registerNewSymbolNamesProvider"in _te.languages&&this._register(_te.languages.registerNewSymbolNamesProvider({language:"*"},this.instantiationService.createInstance(Md)))}};tw=E([y(0,j)],tw);var Eh=q(require("vscode"));var rw=ne("IWorkspaceMutationManager");var sU="copilot-setup-tests";var nw=class extends Oe{constructor(e){super(),this._register(Eh.workspace.registerTextDocumentContentProvider(sU,{provideTextDocumentContent(r,n){return e.get(r.authority).get(r.path,n)}})),this._register(Eh.commands.registerCommand("github.copilot.tests.applyMutations",r=>{Eh.window.withProgress({location:Eh.ProgressLocation.Notification,cancellable:!0},async(n,o)=>{try{return await e.get(r).apply(n,o)}catch(s){Eh.window.showErrorMessage(`Failed to apply edits: ${s.message}`)}})}))}};nw=E([y(0,rw)],nw);var Ste=q(require("vscode"));var xte=q(Ue());var aU=class{constructor(e,r){this.variable=e;this.endpointProvider=r}async invoke(e,r){let n=e.parameters,o=await this.endpointProvider.getChatEndpoint("gpt-4"),s=await this.variable.resolve({endpoint:o,message:n.query},r,{report:()=>{}}),a;return s?a=s.userMessages.join(`

`):a="",{toString(){return a}}}};aU=E([y(1,xe)],aU);var iw=class{constructor(e){this.instantiationService=e}async invoke(e,r){let n=e.parameters;if(!n.query)throw new Error("Invalid parameters");let o={};return e.requestedContentTypes.includes(xte.contentType)&&(o[xte.contentType]=await zhe(this.instantiationService,sx,{query:n.query},e.tokenOptions,r)),e.requestedContentTypes.includes("text/plain")&&(o["text/plain"]=await this.instantiationService.createInstance(sx,{query:n.query}).renderAsString()),o}};iw=E([y(0,j)],iw);var ow=class{constructor(e,r){this.endpointProvider=e;this.instantiationService=r}async invoke(e,r){let n=e.parameters,o=await this.endpointProvider.getChatEndpoint("gpt-4"),{messages:s}=await yo(this.instantiationService,o,SC,{promptContext:{chatVariables:new xo([]),query:n.query,history:[]},include:{workspaceChunks:!0}},void 0,r);return{"text/plain":s.map(a=>a.content).join(`

`)}}};ow=E([y(0,xe),y(1,j)],ow);var sw=class{constructor(e,r,n){r.subscriptions.push(Ste.lm.registerTool("copilot_codebase",e.createInstance(ow))),r.subscriptions.push(Ste.lm.registerTool("copilot_vscodeAPI",e.createInstance(iw)))}};sw=E([y(0,j),y(1,Bt),y(2,S0)],sw);var iEe=require("fs/promises"),uw=require("path"),Gs=q(require("vscode"));var eEe=q(require("crypto")),lU=require("fs/promises");async function Ite(t){try{return await(0,lU.readFile)(t,"utf8")}catch(e){if(e.code==="ENOENT")return;throw e}}function Cte(t){try{return JSON.parse(t)}catch(e){if(e instanceof SyntaxError){console.error(e);return}throw e}}var cU=class t{constructor(e,r){this.filePath=e;this._writeQueue=new aw;this._value=r}static async readOrCreate(e,r){let n=r,o=await Ite(e);if(o!==void 0){let s=Cte(o);s!==void 0&&(n=s)}return new t(e,n)}get value(){return this._value}async setValue(e){this._value=e,this._writeQueue.clearPending(),this._writeQueue.schedule(()=>this._write())}_write(){return(0,lU.writeFile)(this.filePath,JSON.stringify(this._value,null,4),{encoding:"utf8"})}},aw=class{constructor(){this._runningTask=void 0;this._pendingTasks=[]}schedule(e){let r=this._runningTask!==void 0;this._pendingTasks.push(e),r||this._processQueue()}async _processQueue(){if(this._pendingTasks.length===0)return;let e=this._pendingTasks.shift();if(!e)return;if(this._runningTask)throw new Error("should not happen");this._runningTask=e;let r=e();r instanceof Promise?r.finally(()=>{this._runningTask=void 0,this._processQueue()}):(this._runningTask=void 0,this._processQueue())}clearPending(){this._pendingTasks.length=0}};function tEe(t){let e=eEe.createHash("sha256");return e.update(t,"utf8"),e.digest("hex")}var cw=q(require("vscode"));var uU=class{constructor(){this._visibleTextEditors=cs(this,e=>cw.window.onDidChangeVisibleTextEditors(e),()=>cw.window.visibleTextEditors);this.visibleTextEditors=vme(this,this._visibleTextEditors,e=>new Tte(e));this._visibleTextEditorsMap=cd(this,e=>new Map(this.visibleTextEditors.read(e).map(r=>[r.editor,r])));this._activeTextEditor=cs(this,e=>cw.window.onDidChangeActiveTextEditor(e),()=>cw.window.activeTextEditor);this.activeTextEditor=cd(this,e=>{let r=this._activeTextEditor.read(e);if(r)return this._visibleTextEditorsMap.read(e).get(r)})}},Tte=class{constructor(e){this.editor=e;this.selection=cs(this,e=>cw.window.onDidChangeTextEditorSelection(e),()=>this.editor.selections)}};function rEe(t,e){let r=e.offsetAt(t.start),n=e.offsetAt(t.end);return new St(r,n)}var nEe=require("fs"),fU=q(require("path"));var sy=require("fs"),ay=require("fs/promises");var dU=class t{constructor(e,r,n=!1){this.filePath=e;this._exists=n;this._dirty=!1;this._value=r}static async loadOrCreate(e,r){let n=r,o=await Ite(e);if(o!==void 0){let s=Cte(o);s!==void 0&&(n=s)}return new t(e,n,o!==void 0)}get value(){return this._value}setValue(e){this._value=e,this._dirty=!0}async flushAsync(){if(!this._dirty)return;let e=JSON.stringify(this._value,null,4),r=this.filePath+".new";await(0,ay.writeFile)(r,e,{encoding:"utf8"}),this._exists&&await(0,ay.unlink)(this.filePath),await(0,ay.rename)(r,this.filePath),this._exists=!0,this._dirty=!1}flushSync(){if(!this._dirty)return;let e=JSON.stringify(this._value,null,4),r=this.filePath+".new";(0,sy.writeFileSync)(r,e,{encoding:"utf8"}),this._exists&&(0,sy.unlinkSync)(this.filePath),(0,sy.renameSync)(r,this.filePath),this._exists=!0,this._dirty=!1}},pU=class{constructor(e){this.filePath=e;this._newEntries=[]}appendEntry(e){this._newEntries.push(JSON.stringify(e))}_getTextAndClear(){let e=this._newEntries.map(r=>`
`+r).join("");return this._newEntries.length=0,e}async flushAsync(){let e=this._getTextAndClear();e!==""&&await(0,ay.appendFile)(this.filePath,e,{encoding:"utf8"})}flushSync(){let e=this._getTextAndClear();e!==""&&(0,sy.appendFileSync)(this.filePath,e,{encoding:"utf8"})}};var mU=class extends Oe{constructor(r,n){super();this.repoRootUri=r;this.recordingDirPath=n;this._state=new MN(dU.loadOrCreate(fU.default.join(this.recordingDirPath,"state.json"),{documents:{}}));this._log=new pU(fU.default.join(this.recordingDirPath,"log-1.workspaceRecording.jsonl"));this._queue=new aw;this._documentInitialTexts=new Map;this._writeQueue=new aw;(0,nEe.mkdirSync)(n,{recursive:!0}),this._register(Zi(()=>{this._forceFlush()}))}handleOnDidOpenTextDocument(r,n){this._schedule(o=>{this._documentOpened(r,n,o)})}handleOnDidCloseTextDocument(r){this._schedule(n=>{this._documentClosed(r)})}handleOnDidShowTextDocument(r){this._schedule(async n=>{this._appendEntry({kind:1,id:await this._getId(r),time:n})})}handleOnDidHideTextDocument(r){this._schedule(async n=>{this._appendEntry({kind:2,id:await this._getId(r),time:n})})}handleOnDidChangeTextDocument(r,n){n.isEmpty()||this._schedule(async o=>{this._appendEntry({kind:3,id:await this._getId(r),time:o,edit:Tat(n)})})}handleOnDidFocusedDocumentChange(r){this._schedule(async n=>{this._appendEntry({kind:4,id:await this._getId(r),time:n})})}handleOnDidSelectionChange(r,n){this._schedule(async o=>{this._appendEntry({kind:5,id:await this._getId(r),time:o,selection:n.map(s=>Cat(s))})})}_schedule(r){let n=Date.now();this._queue.schedule(()=>r(n))}_getRelativePath(r){return fU.default.relative(this.repoRootUri,r)}_documentOpened(r,n,o){let s=this._getRelativePath(r);if(this._documentInitialTexts.has(s))throw new yr("should not happen");this._documentInitialTexts.set(s,{value:n,time:o})}_documentClosed(r){this._documentInitialTexts.delete(this._getRelativePath(r))}async _getId(r){let n=this._getRelativePath(r),o=await this._state.promise,s=o.value,a=!1,c=s.documents[n];c||(c={id:Object.entries(s.documents).length,lastSha256:""},a=!0);let l=this._documentInitialTexts.get(n);if(l!==void 0){let u=tEe(l.value);c.lastSha256!==u?(c.lastSha256=u,a=!0,this._appendEntry({kind:0,time:l.time,id:c.id,content:l.value})):this._appendEntry({kind:6,time:l.time,id:c.id}),this._documentInitialTexts.delete(n)}if(a&&(o.setValue({documents:{...s.documents,[n]:c}}),this._scheduleFlush()),c.lastSha256==="")throw new yr("should not happen");return c.id}_scheduleFlush(){this._writeQueue.clearPending(),this._writeQueue.schedule(async()=>{await Fl(10*1e3),await(await this._state.promise).flushAsync(),await this._log.flushAsync()})}_forceFlush(){this._writeQueue.clearPending(),this._state.promiseResult.get()?.data?.flushSync(),this._log.flushSync()}_appendEntry(r){this._log.appendEntry(r),this._scheduleFlush()}};function Cat(t){return[t.start,t.endExclusive]}function Tat(t){return t.edits.map(e=>[e.range.start,e.range.endExclusive,e.newText])}var lw=class extends Oe{constructor(r,n,o){super();this._vscodeExtensionContext=r;this._authenticationService=n;this._configurationService=o;this._copilotToken=cs(this,this._authenticationService.onDidAuthenticationChange,()=>this._authenticationService.copilotToken);this._recordingEnabled=cs(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.WorkspaceRecordingEnabled));this._enabled=cd(this,r=>this._copilotToken.read(r)?.isInternal&&this._recordingEnabled.read(r));this._register(b_((s,a)=>{this._enabled.read(s)&&this.init(a)}))}async init(r){let n=Gs.extensions.getExtension("vscode.git");if(!n)return;await n.activate();let o=n.exports.getAPI(1),s=cs(this,u=>o.onDidOpenRepository(u),()=>o.repositories);await uZ(s,u=>u.length>0,void 0,hfe(r));let a=(0,uw.join)(this._vscodeExtensionContext.globalStorageUri.fsPath,"workspaceRecordings");await(0,iEe.mkdir)(a,{recursive:!0});let c=await cU.readOrCreate((0,uw.join)(a,"workspaces.json"),{workspaceIdxByRoot:{}});if(r.isDisposed)return;let l=new Ete(o,a,c);r.add(l)}};lw=E([y(0,Bt),y(1,Tt),y(2,he)],lw);var Ete=class extends Oe{constructor(r,n,o){super();this.gitApi=r;this.recordingDirPath=n;this.workspacesIndexFile=o;this.workspaces=new Map;this.workspacesChangedSignal=pW(this);this.hasWorkspace=cd(this,r=>(this.workspacesChangedSignal.read(r),[...this.workspaces].length>0));let s="vscodeCopilot.openRecordingFolder";this._register(Gs.commands.registerCommand(s,()=>{Gs.env.openExternal(Gs.Uri.file(n))})),this._register(b_((c,l)=>{if(this.hasWorkspace.read(c)){let u=l.add(Gs.window.createStatusBarItem(Gs.StatusBarAlignment.Right,1e4));u.text="$(record) Rec",u.tooltip="Recording workspace changes (stored locally). Click to open recordings.",u.color="yellow",u.show(),u.command={command:s,title:"Open Recording Folder"}}})),this._register(Gs.workspace.onDidOpenTextDocument(c=>{let l=Rd(c),u=this.getWorkspace(l);u&&u.handleOnDidOpenTextDocument(l,c.getText())})),this._register(Gs.workspace.onDidChangeTextDocument(c=>{let l=Rd(c.document),u=this.getWorkspace(l);if(u){let d=gZ(c.contentChanges);u.handleOnDidChangeTextDocument(l,d)}})),this._register(Gs.workspace.onDidCloseTextDocument(c=>{let l=Rd(c);this.getWorkspace(l)?.handleOnDidCloseTextDocument(l)}));for(let c of Gs.workspace.textDocuments){let l=Rd(c),u=this.getWorkspace(l);u&&u.handleOnDidOpenTextDocument(l,c.getText())}let a=new uU;this._register(b_((c,l)=>{let u=a.activeTextEditor.read(c);if(!u)return;let d=Rd(u.editor.document),p=this.getWorkspace(d);p&&(p.handleOnDidFocusedDocumentChange(d),l.add(Ul(f=>{let h=u.selection.read(f).map(g=>rEe(g,u.editor.document));p.handleOnDidSelectionChange(d,h)})))}))}getWorkspace(r){let n=this.gitApi.repositories.find(s=>r.startsWith(s.rootUri.toString()))?.rootUri.toString().toLowerCase();if(!n)return;let o=this.workspaces.get(n);if(!o){let s=this.workspacesIndexFile.value.workspaceIdxByRoot,a=s[n];a===void 0&&(a=Object.entries(s).length,s={...s,[n]:a},this.workspacesIndexFile.setValue({workspaceIdxByRoot:s}));let c=Eat((0,uw.basename)(n))+"-"+a;o=new mU(n,(0,uw.join)(this.recordingDirPath,c)),this._register(o),this.workspaces.set(n,o),this.workspacesChangedSignal.trigger(void 0)}return o}};function Eat(t){return t.replaceAll(/[^a-zA-Z0-9_.-]/g,"")}var oEe=[...xbe,gX,vX,yX,mo(UE),mo(wT),mo(JE),mo(DT),mo(U8),mo(iE),mo(lw)],sEe=[mo(oE),mo(qE),mo(BT),mo(YE),mo($E),mo(sw),mo(UT),mo(PT),mo(tw),mo(NT),mo(nw)];var uEe=q(Ct());var aEe=q(Ct());var cEe=q(require("fs"));var wte;function wat(t,e,r){let n=t.replace(/\r\n/g,`
`);return wte=wte?.then(()=>r.getSemanticChunkNames(e,n))??r.getSemanticChunkNames(e,n),wte}async function kat(t,e,r,n){let o=await r.get(t)?.getText(e),s=cl(Ns(t).languageId);if(!o||!s)return;let a=new kte(s,o,n);return await a.initTree(e),a}var kte=class{constructor(e,r,n){this.lang=e;this.text=r;this.parserService=n}async initTree(e){this.tree=await ka(wat(this.text,this.lang,this.parserService),e)}async getKeywords(e){if(!this.tree||this.tree.roots.length===0)return;let r=this.findSmallestNodeThatFullyContainsRange(e,this.tree.roots),n;return r?n=this.findContainedChildren(e,r.children):n=this.findContainedChildren(e,this.tree.roots),Dr([r,...n].map(o=>o?.info.detailBlocks.name))}findContainedChildren(e,r){if(!this.tree)return[];let n=[];for(let o of r)e.intersectRanges(this.getNodeRange(o))&&n.push(o);return n}findSmallestNodeThatFullyContainsRange(e,r){if(!this.tree||r.length===0)return;let n;for(let o of r){let s=je.lift(this.getNodeRange(o));if(s.containsRange(e)&&!s.equalsRange(e)){let a=this.findSmallestNodeThatFullyContainsRange(e,o.children);a?n=a:n=o;break}}return n}getNodeRange(e){return{startLineNumber:e.info.mainBlock.range.startPosition.row,startColumn:e.info.mainBlock.range.startPosition.column,endLineNumber:e.info.mainBlock.range.endPosition.row,endColumn:e.info.mainBlock.range.endPosition.column}}},dw=class{constructor(e,r){this._workspaceFileIndex=e;this._parserService=r;this.cache=new Nr}async getKeywords(e,r,n){return await(this.cache.get(e)??await kat(e,r,this._workspaceFileIndex,this._parserService))?.getKeywords(n)??[]}};dw=E([y(0,vc),y(1,dt)],dw);var Ox=q(Ue());var pw=class extends Ox.PromptElement{render(e,r){return vscpp(vscppf,null,vscpp(Ox.SystemMessage,{priority:1e3},"You are a coding assistant who helps the user find relevant code in their workspace by providing a list of relevant keywords they can search for in the codebase's text.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null),"Respond in Markdown. Output a short markdown list of up to 16 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"Re-state key nouns from the user's query in the response. For example, if the user asks about 'base64 encoding', you should include 'base64' in the response.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. Read the user's file structure. DO NOT use keywords that reference the file names. Rather, use these file names to understand what type of code the user is working on.",vscpp("br",null),"3. Use the context from Step 3 to guess what you could 'grep' for in the project in relation to the user's question. These terms should be related to the user's query.",vscpp("br",null),"3. Output a short markdown list of up to 16 relevant keywords that users could try searching for to answer their question. These keywords could used as symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"4. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: base64 encoding",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders"),vscpp(Ox.UserMessage,{priority:700},vscpp(vs,{maxSize:1e3})),vscpp(Ox.UserMessage,{priority:1e3},this.props.query))}};var hU=ne("IWorkspaceSemanticChunkService"),xL=class{constructor(e,r,n,o,s,a,c,l){this.query=e;this.endpoint=r;this.maxResults=n;this.token=o;this._workspaceChunkSearch=s;this._chatFetcher=a;this._instantiationService=c;this._logService=l;this.treeSitterKeywordFetcher=this._instantiationService.createInstance(dw)}async initSemanticSearchMetaprompt(){return(async()=>{let r=new Fo,{messages:n}=await this.buildMetaPrompt(this.endpoint,this.query,this.token);if(this.token.isCancellationRequested)return{rephrasedQuestion:"",keywords:[]};this._logService.internal.debug(`[Semantic search metaprompt] built prompt in ${r.elapsed()}ms`);let o=await this._chatFetcher.fetchOne("searchFileChunks",n,async s=>{},this.token,2,this.endpoint);if(o.type!=="success")throw new Error(aEe.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",o.type,o.reason));return this.token.isCancellationRequested?{rephrasedQuestion:"",keywords:[]}:(this._logService.internal.debug(`[Semantic search metaprompt] took a total of ${r.elapsed()}ms`),Rte(o.value))})()}async search(){return this.metaPromptResponse=this.initSemanticSearchMetaprompt(),{fileResults:await Pte(this._workspaceChunkSearch,this.endpoint,this.query,this.metaPromptResponse,this.maxResults,this.token,this.treeSitterKeywordFetcher),metapromptResult:await this.metaPromptResponse}}async buildMetaPrompt(e,r,n){return Me.create(this._instantiationService,e,pw,{query:r}).render()}};xL=E([y(4,Kv),y(5,yt),y(6,j),y(7,ie)],xL);var Rat=/^[\*\-]\s*(.+)/m;function Rte(t){let e=[],r=new Set;for(let n of t.trim().split(`
`)){let o=n.match(Rat);if(o){let s=o[1].split(/,/g).map(a=>a.trim());if(s.length){let a=s.flatMap(l=>l.split(/[\s\-_.]/g)).filter(l=>!r.has(l));if(new Set(a).forEach(l=>r.add(l)),!a.length)continue;e.unshift({keyword:a[0],variations:a.length>1?a.slice(1):[]})}}}return{keywords:e}}var fw=class{constructor(e){this._instantiationService=e}async searchFileChunks(e,r,n,o){return this._instantiationService.createInstance(xL,e,r,n,o).search()}dispose(){}};fw=E([y(0,j)],fw);async function Pte(t,e,r,n,o,s,a){let c={rawQuery:r,resolveQueryAndKeywords:async()=>{let u=await n;return{rephrasedQuery:r,keywords:u.keywords}},resolveQuery:async()=>r},l=await t.searchFileChunks(e,c,o,{skipRerank:!0},void 0,s);return s.isCancellationRequested||!l.length?[]:await Pat(l,s,a)}async function Pat(t,e,r){let n=[],o=new Nr;for(let[s,a]of t.entries()){let c=o.get(a.file),l=c?c.rank:s,u=c?[...c.ranges,a.range]:[a.range];o.set(a.file,{ranges:u,rank:l})}for(let[s,a]of o.entries()){let c=a.ranges.map((m,h)=>{for(let[g,v]of a.ranges.entries())if(h!==g&&m.containsRange(v))if(m.equalsRange(v)){if(h<g)return}else return;return{range:m}}).filter(m=>m!==void 0),l=[],u;c.sort((m,h)=>m.range.startLineNumber-h.range.startLineNumber);for(let m of c)u&&u.range.endLineNumber>=m.range.startLineNumber-1?u={range:new je(u.range.startLineNumber,u.range.startColumn,m.range.endLineNumber,m.range.endColumn)}:(u&&l.push(u),u=m);u&&l.push(u);let p=(await cEe.promises.readFile(s.fsPath,"utf8")).split(`
`),f=[];for(let m of l){let h=m.range.startLineNumber,g=m.range.endLineNumber,v=p.slice(h,g),b=r?r.getKeywords(s,e,m.range):Promise.resolve([]);f.push({range:m.range,code:v,treeSitterBlockNames:b})}f.length>0&&n.push({result:{file:s,locations:f},rank:a.rank})}return n.sort((s,a)=>s.rank-a.rank).map(s=>s.result)}var mw=class{constructor(e,r,n,o){this._endpointProvider=e;this._workspaceSemanticChunkService=r;this._logService=n;this._telemetryService=o;this._endpoint=void 0;this.name="GitHub Copilot"}async getEndpoint(){return this._endpoint=this._endpoint??await this._endpointProvider.getChatEndpoint("gpt-4o-mini"),this._endpoint}provideAITextSearchResults(e,r,n,o){let s=new Fo;return(async()=>{let c=await this._workspaceSemanticChunkService.searchFileChunks(e,await this.getEndpoint(),1e3,o);return(await Mat(c,o,this._logService,this._telemetryService)).forEach(l=>{n.report(l)}),this._logService.public.debug(`Semantic search took ${s.elapsed()}ms`),{limitHit:!1,message:{text:uEe.t("Results are from Copilot"),trusted:!0,type:1}}})()}};mw=E([y(0,xe),y(1,hU),y(2,ie),y(3,ge)],mw);var Aat=5;function Dat(t){return new RegExp(`\\b(\\w*(${t.map(e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")).join("|")})\\w*)\\b`,"gi")}function lEe(t,e,r){if(t.length===0)return{ranges:[],previewMatchRanges:[]};let n=[],o=[],s=Dat(t);return e.forEach((a,c)=>{let l=Array.from(a.matchAll(s)),u=r.startLineNumber+c,d=c===0?r.startColumn:0,p,f;for(let m of l){if(m.index===void 0)continue;let h=d+m.index,g=h+m[0].length,v=m.index,b=v+m[0].length;if(p&&f)if(p?.end.line===u&&p.end.character>h-Aat){p=p.with(void 0,new xr(u,g)),f=f?.with(void 0,new xr(c,b));continue}else n.push(p),o.push(f);p=new Be(new xr(u,h),new xr(u,g)),f=new Be(new xr(c,v),new xr(c,b))}p&&f&&(n.push(p),o.push(f))}),{ranges:n,previewMatchRanges:o}}async function Nat(t,e,r=Wt.None,n,o){let s=[];return await ka((async()=>{let c=0,l=0;await Promise.all(t.map(async d=>{await Promise.all(d.locations.map(async p=>{let f=p.code,{ranges:m,previewMatchRanges:h}=lEe(e,f,p.range);if(m.length)s.push({uri:d.file,ranges:m,preview:{text:p.code.join(`
`),matches:h}}),c++;else{let g=await p.treeSitterBlockNames,{ranges:v,previewMatchRanges:b}=lEe(g,f,p.range);if(v.length)s.push({uri:d.file,ranges:v,preview:{text:p.code.join(`
`),matches:b}}),c++;else{n?.internal.debug(`No keyword highlights found for ${d.file} at ${p.range.startLineNumber}:${p.range.startColumn}. Treesitter keywords: ${g.join(", ")}.`);let _=Lat(f,cC(p.range));_!==void 0&&s.push({uri:d.file,ranges:_.range,preview:{text:_.code,matches:_.previewRange}}),l++}}}))}));let u=l/(c+l)*100;return n?.public.debug(`Percentage of semantic search chunks with no keyword found: ${u}%`),o?.sendMSFTTelemetryEvent("workspaceSemanticSearch.chunksWithoutKeywords",void 0,{percentOfChunksWithFailedKeywordFind:u}),s})(),r)??[]}function Lat(t,e){for(let r=0;r<t.length;r++){let o=t[r].match(/^\s+/);if(o){let s=e.start.line+r===e.end.line;return{code:t.slice(r).join(`
`).substring(o[0].length),range:new Be(new xr(e.start.line+r,e.start.character+o[0].length),e.end),previewRange:new Be(new xr(0,0),new xr(e.end.line-e.start.line+r,s?e.end.character-e.start.character:e.end.character))}}}}function Oat(t){let e=t.keyword;return e.length===0&&(e=t.variations.find(r=>r.length>0)),e}async function Mat(t,e,r,n){let o=[],s=t.metapromptResult.keywords;return s?await Nat(t.fileResults,Dr(s.map(a=>Oat(a))),e,r,n):o}var dEe=q(require("path")),fu=q(require("vscode"));var Fat=10,Uat=5*60*1e3,Bat=10*1e3,gU=[];function pEe(t){let e=new ht;if(!t.get(he).getConfig(le.FeedbackOnChange))return e;let n=t.get(qo).getDiagnosticCollection(),o=t.get(j).createInstance(e0);return e.add(fu.workspace.onDidChangeTextDocument(async s=>{if(s.document.uri.scheme==="file"&&s.contentChanges.length&&s.document===fu.window.activeTextEditor?.document){let a=t.get(ie);try{a.public.warn("Document changed, delaying diagnostics request");let c=s.document.version;if(await new Promise(m=>setTimeout(m,Bat)),c!==s.document.version){a.public.warn("Skipping diagnostics request because the document has changed");return}let l=Date.now(),u=l-Uat;if(gU=gU.filter(m=>m>u),gU.length>=Fat){a.public.warn("Max requests reached, skipping diagnostics request");return}gU.push(l),a.public.trace("Requesting diagnostics");let d=fu.window.activeTextEditor?.selection,p=await on.getCurrentChange(t,s.document,d.start);if(!p)return a.public.trace("No change found in the current document at the current position."),[];let f=await o.generateComments([{document:s.document,relativeDocumentPath:dEe.basename(s.document.uri.fsPath),change:p,selection:d}],new fu.CancellationTokenSource().token);if(f.type==="success"){let m=f.comments.map(h=>new fu.Diagnostic(h.range,typeof h.body=="string"?h.body:h.body.value,fu.DiagnosticSeverity.Information));n.set(s.document.uri,m)}}catch(c){a.public.error(c,"Error generating diagnostics")}}})),e.add(fu.workspace.onDidCloseTextDocument(s=>{n.set(s.uri,void 0)})),e}var hw=q(require("vscode"));var yf=q(Ue());var Ate=class extends yf.PromptElement{render(){let e=this.props.issues?.map(r=>vscpp(vscppf,null,"------- Issue ",r.reference,":",vscpp("br",null),r.content,vscpp("br",null)));return e&&e.length>0?vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository to fix the following issues: ",vscpp("br",null),e):vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository.")}},Dte=class extends yf.PromptElement{render(){return vscpp(vscppf,null,"Here are two good examples:",vscpp("br",null)," ",this.props.issues&&this.props.issues.length>0?vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.",vscpp("br",null),"Fixes #4520+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.",vscpp("br",null),"Fixes microsoft/vscode-internalbacklog#4533+++",vscpp("br",null)):vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.+++",vscpp("br",null)),";")}},Nte=class extends yf.PromptElement{render(){return vscpp(vscppf,null,vscpp(Ate,{issues:this.props.issues}),"Pull requests have a short and concise title that describes the changes in the code and a slightly longer description.",vscpp("br",null),"To compose the description, read through each commit and patch and distill the essence of that commit into a concise description paragraph. Do not list commits, files or patches. Do not make up an issue reference if the pull request isn't fixing an issue.",vscpp("br",null),"If the pull request is fixing an issue, consider how the commits relate to the issue and include that in the description.",vscpp("br",null),"The title and description of a pull request should be markdown and start with +++ and end with +++.",vscpp("br",null),vscpp(Dte,{issues:this.props.issues}))}},Lte=class extends yf.PromptElement{render(){let e=this.props.commitMessages.map(n=>vscpp(vscppf,null,"* ",n,vscpp("br",null))),r=this.props.patches.map(n=>vscpp(vscppf,null,"```diff",vscpp("br",null),n,vscpp("br",null),"```",vscpp("br",null)));return vscpp(vscppf,null,"These are the commits that will be included in the pull request you are about to make:",vscpp("br",null),e,vscpp("br",null),"Below is a list of git patches that contain the file changes for all the files that will be included in the pull request:",vscpp("br",null),r,vscpp("br",null),"Based on the git patches and on the git commit messages above, the title and description of the pull request should be:",vscpp("br",null))}},vU=class extends yf.PromptElement{render(){return vscpp(vscppf,null,vscpp(yf.SystemMessage,null,vscpp(Nte,{issues:this.props.issues}),vscpp(ct,null)),vscpp(yf.UserMessage,null,vscpp(Lte,{commitMessages:this.props.commitMessages,patches:this.props.patches})))}};var cy=class{constructor(e){this.accessor=e;this.disposables=new ht;this.lastContext={commitMessages:[],patches:[]};this.logService=e.get(ie),this.logService.public.info("[githubTitleAndDescriptionProvider] Initializing GitHub PR title and description provider provider."),this.options=e.get(dc)}dispose(){this.disposables.dispose()}isRegenerate(e,r){if(e.length!==this.lastContext.commitMessages.length||r.length!==this.lastContext.patches.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==this.lastContext.commitMessages[n])return!1;for(let n=0;n<r.length;n++)if(r[n]!==this.lastContext.patches[n])return!1;return!0}async excludePatches(e){let r=this.accessor.get(Te),n=[];for(let o of e)o.fileUri&&await r.isCopilotIgnored(He.parse(o.fileUri))||o.previousFileUri&&o.previousFileUri!==o.fileUri&&await r.isCopilotIgnored(He.parse(o.previousFileUri))||n.push(o.patch);return n}async provideTitleAndDescription(e,r){let n=e.commitMessages,o=OM(e.patches)?e.patches.map(p=>({patch:p})):e.patches,s=await this.excludePatches(o),a=e.issues,c=await this.accessor.get(xe).getChatEndpoint("gpt-3.5-turbo"),l=Math.floor(c.modelMaxPromptTokens*4/3),u=await this.createPRTitleAndDescriptionPrompt(n,s,a,l),d=await this.accessor.get(yt).fetchOne("githubPullRequestTitleAndDescriptionGenerator",u.messages,void 0,r,3,c,void 0,{temperature:this.isRegenerate(n,s)?this.options.temperature+.1:this.options.temperature});if(this.lastContext={commitMessages:n,patches:s},d.type==="success")return cy.parseFetchResult(d.value)}static parseFetchResult(e,r=!0){e=e.trim();let n=e,o="+++",s=n.indexOf(o);if(s===-1)return;for(;n.charAt(s+o.length)==="+";)o+="+";let a=n.lastIndexOf(o);n=n.substring(s+o.length,a>s+o.length?a:void 0).trim().replace(/\++?(\n)\++/,o);let c=n.split(o).filter(p=>p.trim().length>0),l;if(c.length===1)l=c[0].split(`
`);else if(c.length>1){let p=c.slice(1).map(f=>f.split(`
`)).flat().filter(f=>f.trim().length>0);l=[c[0],...p]}else return;let u,d;if(l.length===1){if(u=l[0].trim(),r&&e.includes(`
`)&&e.split(o).length===3)return this.parseFetchResult(e+o,!1)}else if(l.length>1){u=l[0].trim(),d="";let p=l.slice(1);for(let f of p)f.includes("commit message")||(d+=`${f.trim()}

`)}if(u)return u=u.replace(/Title\:\s/,"").trim(),u=u.replace(/^\"(?<title>.+)\"$/,(p,f)=>f),d&&(d=d.replace(/Description\:\s/,"").trim()),{title:u,description:d}}async createPRTitleAndDescriptionPrompt(e,r,n,o){let s=o-Math.floor(o*.2),a=r.join(`

`).length;if(a>s)for(r.sort((u,d)=>u.length-d.length);a>s&&r.length>0;){let u=r.pop();a-=u.length}let c=await this.accessor.get(xe).getChatEndpoint("gpt-3.5-turbo");return Me.create(this.accessor.get(j),c,vU,{commitMessages:e,issues:n,patches:r}).render(void 0,void 0)}};cy=E([y(0,Rt)],cy);var yU=class{constructor(e){this.accessor=e}async provideReviewerComments(e,r){let n=await AC(this.accessor,e,r),o=[];if(n?.type==="success")for(let a of n.comments)o.push(a.uri);let s=n?.type==="success";return{files:o,succeeded:s}}};var bU=class{constructor(e){this.accessor=e;this.disposables=new ht;this.logService=e.get(ie),this.initializeGitHubPRExtensionApi()}dispose(){this.disposables.dispose()}getExtension(){return hw.extensions.getExtension("github.vscode-pull-request-github")}initializeGitHubPRExtensionApi(){let e=this.getExtension(),r=async()=>{if(e){let n=await e.activate();this.logService.public.info("Successfully activated the GitHub.vscode-pull-request-github extension."),this.gitHubExtensionApi=n,this.registerTitleAndDescriptionProvider(),this.registerReviewerCommentsProvider()}};if(e)r();else{this.logService.public.info("GitHub.vscode-pull-request-github extension is not yet activated.");let n=hw.extensions.onDidChange(()=>{e=this.getExtension(),e&&(r(),n.dispose())});this.disposables.add(n)}}async registerTitleAndDescriptionProvider(){if(this.gitHubExtensionApi)try{this.titleAndDescriptionProvider||(this.titleAndDescriptionProvider=this.disposables.add(new cy(this.accessor))),this.disposables.add(this.gitHubExtensionApi.registerTitleAndDescriptionProvider(hw.l10n.t("Generate with Copilot"),this.titleAndDescriptionProvider)),this.logService.public.info("Successfully registered GitHub PR title and description provider.")}catch{}}async registerReviewerCommentsProvider(){if(!this.gitHubExtensionApi)return;let e=this.accessor.get(he);if(!(!e.getConfig(le.ReviewContextMenu)&&!e.getConfig(le.ReviewSCMViewlet)))try{this.reviewerCommentsProvider||(this.reviewerCommentsProvider=new yU(this.accessor)),this.disposables.add(this.gitHubExtensionApi.registerReviewerCommentsProvider(hw.l10n.t("Copilot"),this.reviewerCommentsProvider)),this.logService.public.info("Successfully registered GitHub PR reviewer comments provider.")}catch{}}};var gw=q(require("path")),mEe=require("util"),Ze=require("vscode");var qat=["dockerfile","license","makefile","readme","procfile","gemfile","rakefile","jenkinsfile","vagrantfile"];function fEe(t){return/\.[^/.]+$/.test(t)&&qat.indexOf(t.toLowerCase())===-1}var la=require("vscode"),SL=class{constructor(e){this.contentManager=e;this._onDidChangeFile=new la.EventEmitter;this.onDidChangeFile=this._onDidChangeFile.event}async stat(e){let r=this.contentManager.get(e);if(!r)throw la.FileSystemError.FileNotFound(e);let n=await r.content?.then(o=>o?.length)??0;return{ctime:r.ctime??0,mtime:r.ctime??0,size:n,type:r.children?la.FileType.Directory:la.FileType.File}}readDirectory(e){let r=this.contentManager.get(e);if(!r)throw la.FileSystemError.FileNotFound(e);return r.children?.map(n=>[n.name,n.children?la.FileType.Directory:la.FileType.File])??[]}async readFile(e){let r=this.contentManager.get(e);if(!r)throw la.FileSystemError.FileNotFound(e);let n;try{n=await r.content}catch{}return n??new Uint8Array}watch(e,r){return{dispose(){}}}createDirectory(e){throw la.FileSystemError.NoPermissions(e)}writeFile(e,r,n){throw la.FileSystemError.NoPermissions(e)}delete(e,r){throw la.FileSystemError.NoPermissions(e)}rename(e,r,n){throw la.FileSystemError.NoPermissions(r)}copy(e,r,n){throw la.FileSystemError.NoPermissions(r)}};var xU=require("vscode");var _U=class extends Oe{constructor(r){super();this.contentManager=r;this.onDidChangeEmitter=new xU.EventEmitter;this.onDidChange=this.onDidChangeEmitter.event;this._register(xU.workspace.onDidChangeTextDocument(n=>{n.document.uri.scheme===tx&&this.onDidChangeEmitter.fire(n.document.uri)}))}async provideTextDocumentContent(r,n){let o=this.contentManager.get(r);if(!o)return"";let s;try{s=await o.content}catch{}return new TextDecoder().decode(s)??""}};function hEe(t,e,r){return Ze.Disposable.from(Ze.workspace.registerFileSystemProvider(f8,new SL(t),{isReadonly:new Ze.MarkdownString(Ze.l10n.t(`This file preview was generated by Copilot and may contain surprises or mistakes.

Ask followup questions to refine it, then press Create Workspace.`))}),Ze.workspace.registerFileSystemProvider(m8,new SL(t),{isReadonly:!0}),Ze.workspace.registerTextDocumentContentProvider(tx,new _U(t)),Ze.commands.registerCommand(eX,async(n,o)=>{let s=(await Ze.window.showOpenDialog({defaultUri:o,title:gw.basename(n.baseUri.path),canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,openLabel:"Select as Parent Folder"}))?.[0];s&&await jat(e,o,s,n)}),Ze.commands.registerCommand(p8,async n=>{let o=Ze.Uri.joinPath(n.baseUri,n.value[0].name).toString(),s=await Ze.workspace.openTextDocument(Ze.Uri.parse(o));await Ze.window.showTextDocument(s,{preview:!1})}),Ze.commands.registerCommand(tX,async n=>{let o={defaultUri:Ze.Uri.file(gw.posix.join(Ze.workspace.workspaceFolders?.[0].uri.path??"",n.value[0].name)),saveLabel:Ze.l10n.t("Save File")},s=await Ze.window.showSaveDialog(o);if(s){let a=Ze.Uri.joinPath(n.baseUri,n.value[0].name).toString(),c=await Ze.workspace.openTextDocument(Ze.Uri.parse(a));await Ze.workspace.fs.writeFile(s,Buffer.from(c.getText()));let l=[];Ze.window.tabGroups.all.forEach(d=>{d.tabs.forEach(p=>{p.input instanceof Ze.TabInputText&&p.input.uri.scheme===tx&&l.push(p)})}),Ze.window.tabGroups.close(l,!0);let u=await Ze.workspace.openTextDocument(Ze.Uri.file(s.fsPath));await Ze.window.showTextDocument(u)}}))}async function jat(t,e,r,n){let o=n.baseUri.path,s=await Vat(r,o),a=[];Ze.window.tabGroups.all.forEach(l=>{l.tabs.forEach(u=>{u.input instanceof Ze.TabInputText&&u.input.uri.scheme===f8&&a.push(u)})}),Ze.window.tabGroups.close(a,!0);let c=Ze.Uri.joinPath(r,s);try{if(await Ze.window.withProgress({location:Ze.ProgressLocation.Notification,cancellable:!0},async(m,h)=>{await Ze.workspace.fs.createDirectory(c);let g=gw.basename(o);async function v(b,_,x){let S=b?b.slice(g.length+1):"..",I=Ze.Uri.joinPath(c,S,_.name);if(_.children?.length||!fEe(_.name)){b!==""&&(m.report({message:Ze.l10n.t("Creating folder {0}...",I.fsPath)}),await Ze.workspace.fs.createDirectory(I));for(let w of _.children??[])await v(gw.posix.join(b,_.name),w,x)}else{m.report({message:Ze.l10n.t("Creating file {0}...",I.fsPath)});let w=await Ze.workspace.fs.readFile(Ze.Uri.joinPath(x,b,_.name));await Ze.workspace.fs.writeFile(I,Buffer.from(w))}}for(let b of n.value)await v("",b,n.baseUri);await Gat(c)}),e&&c.fsPath.startsWith(e.fsPath))return;let l=Ze.l10n.t("Would you like to open the created workspace?"),u=Ze.l10n.t("Open"),d=Ze.l10n.t("Open in New Window"),p=[u,d],f=await Ze.window.showInformationMessage(l,{modal:!0},...p);f===u?(Ze.interactive.transferActiveChat(c),t.public.info("[newIntent] Opening folder: "+c.fsPath),Ze.commands.executeCommand("vscode.openFolder",c)):f===d&&Ze.commands.executeCommand("vscode.openFolder",c,!0)}catch(l){let u=Ze.l10n.t("Failed to create workspace: {0}",s);t.public.error(l,u),Ze.window.showErrorMessage(u),await Ze.workspace.fs.delete(c,{recursive:!0})}}async function Vat(t,e){let r=0,n=!0,o=e;for(;n;)try{await Ze.workspace.fs.stat(Ze.Uri.joinPath(t,o)),o=e+"-"+ ++r}catch{n=!1}return o}async function Hat(t){try{return await Ze.workspace.fs.stat(t),!0}catch{return!1}}async function Gat(t){let e=zat();if(e)if(await Hat(e)){let r=await Ze.workspace.fs.readFile(e).then(o=>new mEe.TextDecoder().decode(o)),n=JSON.parse(r);n.push(t.toString()),await Ze.workspace.fs.writeFile(e,Buffer.from(JSON.stringify(n,null,2)))}else await Ze.workspace.fs.writeFile(e,Buffer.from(JSON.stringify([t.toString()],null,2)))}function zat(){let t=Ze.env.appName.indexOf("Insider")>0||Ze.env.appName.indexOf("Code - OSS Dev")>=0?"Code - Insiders":"Code",e=Ze.Uri.file(process.env.HOME||(process.env.USERPROFILE?process.env.USERPROFILE:""));switch(process.platform){case"darwin":return Ze.Uri.joinPath(e,"Library","Application Support",t,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"linux":return Ze.Uri.joinPath(e,".config",t,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"win32":return process.env.APPDATA?Ze.Uri.joinPath(Ze.Uri.file(process.env.APPDATA),t,"User","workspaceStorage","aiGeneratedWorkspaces.json"):void 0;default:return}}var SU=q(Ct()),gEe=require("path"),kc=q(require("vscode")),vEe=require("vscode");var Yo=q(Ue()),IL=require("path");var vw=class extends Yo.PromptElement{constructor(r,n){super(r);this._terminalService=n}render(){let r=this._terminalService.terminalLastCommand?.cwd?typeof this._terminalService.terminalLastCommand.cwd=="string"?this._terminalService.terminalLastCommand.cwd:this._terminalService.terminalLastCommand.cwd.path:void 0;return vscpp(vscppf,null,vscpp(Yo.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to respond with a list of files that you need access to in order to fix the command. Carefully consider the command line, output and current working directory in your response.",vscpp("br",null),vscpp(ct,null),vscpp(kt,null),`
You MUST respond ONLY with a JSON array in the format:

\`\`\`json
[
	{
		fileName: string
	},
	...
]
\`\`\`

Follow these rules in your response:

- Use an absolute path if you know the exact location of the file.
- Do NOT include any introduction, description or prose. Only include the paths.
`),vscpp(Yo.SystemMessage,{priority:1e3},`Examples:

User: npm startt
Assistant:
- \`${r?(0,IL.join)(r,".bin/startt"):".bin/startt"}\`
- \`${r?(0,IL.join)(r,"package.json"):"package.json"}\`
`),vscpp(bw,{priority:800}),vscpp(_w,{priority:600}),vscpp(Yo.UserMessage,{priority:1100},this._terminalService.terminalLastCommand?"":`The following command just failed when run in the terminal \`${this.props.commandLine}\`.

Here is the output of the command:
${(this.props.output??[]).join()}`),vscpp(sh,{priority:800}))}};vw=E([y(1,ui)],vw);var yw=class extends Yo.PromptElement{constructor(r,n){super(r);this._terminalService=n}render(r){let n=this.props.verifiedContextUris.map(o=>vscpp(Fp,{variableName:(0,IL.basename)(o.path),variableValue:o}));return vscpp(vscppf,null,vscpp(Yo.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the user fix a command that was run in the terminal by providing a list of fixed command suggestions. Carefully consider the command line, output and current working directory in your response.",vscpp("br",null),vscpp(ct,null),vscpp(kt,null),`
You MUST respond ONLY with a JSON array containing HIGHLY RELEVANT command suggestions in the format:

\`\`\`json
[
	{
		command: string,
		description: string,
		relevance: 'low' | 'medium' | 'high'
	},
	...
]
\`\`\`

Follow these rules in your response:

- You MUST NOT suggest commands that use non-existent files.
- Under no circumstance will you include an summary, description or any prose whatsoever.
- Do NOT repeat the command and/or output.
- Provide a maximum of 10 suggestions, starting with the most relevant.
- When there is text that needs to be replaced in the suggestion, prefix the text with '{', suffix the text with '}' and use underscores instead of whitespace. Only do this when the replacement text is NOT provided.
- Avoid providing suggestions that do exactly the same thing like aliases.
- Only provide suggestions for the active shell and avoid shelling out where possible.
- The suggestions must be relevant. For example, if the command is a build command, the suggestions must look like build commands, not test commands.
- If the command is related to a particular programming language, do not include suggestions for different languages.
- NEVER suggest to change directory to the current working directory.
`),vscpp(Yo.SystemMessage,{priority:700},`Examples:

User: lss
Assistant:
- \`ls\`

User: clone git
Assistant:
- \`git clone {repository}\`

User: .venv/bin/activate
Context: .venv/bin/activate DOES NOT exist
Assistant:
- \`python -m venv .venv\`

User: .venv/bin/activate
Context: .venv/bin/activate exists
Assistant:
- \`source .venv/bin/activate\`
`),vscpp(bw,{priority:800}),vscpp(_w,{priority:800}),vscpp(Ote,{priority:600}),vscpp(Yo.UserMessage,{priority:1100},this._terminalService.terminalLastCommand?"":`The following command just failed when run in the terminal \`${this.props.commandLine}\`.

Here is the output of the command:
${(this.props.output??[]).join()}`),vscpp(sh,{priority:800}),vscpp(Yo.UserMessage,{priority:700},`${this.props.verifiedContextDirectoryUris.length>0?`The following directories exist:

${this.props.verifiedContextDirectoryUris.map(o=>`- ${o.path}`).join(`
`)}`:""}`),vscpp(Yo.UserMessage,{priority:700},`${this.props.nonExistentContextUris.length>0?`The following files DO NOT exist and cannot be used in the suggestion:

${this.props.nonExistentContextUris.map(o=>`- ${o.path}`).join(`
`)}`:""}`),...n)}};yw=E([y(1,ui)],yw);var Ote=class extends Yo.PromptElement{render(){return vscpp(vscppf,null,vscpp(Yo.SystemMessage,{priority:this.props.priority},`
Follow these guidelines for python:
- NEVER recommend using "pip install" directly, always recommend "python -m pip install"
- The following are pypi modules: ruff, pylint, black, autopep8, etc
- If the error is module not found, recommend installing the module using "python -m pip install" command.
- If activate is not available create an environment using "python -m venv .venv".
`))}},bw=class extends Yo.PromptElement{constructor(r,n){super(r);this._terminalService=n}render(){return vscpp(vscppf,null,vscpp(Yo.UserMessage,{priority:this.props.priority},"The active terminal's shell type is: ",this._terminalService.terminalShellType))}};bw=E([y(1,ui)],bw);var _w=class extends Yo.PromptElement{constructor(r,n){super(r);this._envService=n}render(){return vscpp(vscppf,null,vscpp(Yo.UserMessage,{priority:this.props.priority},"The active operating system is: ",this._envService.OS))}};_w=E([y(1,gt)],_w);function $at(t){switch(t){case 3:return SU.t("high relevance");case 2:return SU.t("medium relevance");case 1:return SU.t("low relevance")}}function Wat(t){return t==="high"?3:t==="medium"?2:1}function yEe(t){bEe=t}var bEe;async function _Ee(t){let e=bEe;if(!e)return;let r=new Promise(o=>{t.createInstance(CL).generateTerminalQuickFix(e,Wt.None).then(s=>{let a=(s??[]).sort((l,u)=>u.relevance-l.relevance).map(l=>({label:l.command,description:l.description,suggestion:l})),c;for(let l=0;l<a.length;l++){let u=a[l],d=a.at(l-1);"suggestion"in u&&(!c||l>0&&"suggestion"in d&&u.suggestion.relevance!==d.suggestion.relevance)&&(c=u.suggestion.relevance,a.splice(l++,0,{label:$at(c),kind:kc.QuickPickItemKind.Separator}))}o(a)})}),n=await kc.window.showQuickPick(r,{canPickMany:!1});if(n&&"suggestion"in n){let o=!n.suggestion.command.match(/{.+}/);kc.window.activeTerminal?.sendText(n.suggestion.command,o)}}var CL=class{constructor(e,r,n,o,s){this._chatMLFetcher=e;this._endpointProvider=r;this._instantiationService=n;this._logService=o;this._workspaceService=s}async generateTerminalQuickFix(e,r){let n=await this._generateTerminalQuickFixFileContext(e,r);if(!n||r.isCancellationRequested)return;let o=[],s=[],a=[];for(let f of n)try{let m=await kc.workspace.fs.stat(f);m.type===kc.FileType.File||m.type===kc.FileType.SymbolicLink?o.push(f):m.type===kc.FileType.Directory?s.push(f):a.push(f)}catch{a.push(f)}let c=await this._endpointProvider.getChatEndpoint("gpt-3.5-turbo"),u=await Me.create(this._instantiationService,c,yw,{commandLine:e.commandLine,output:[],verifiedContextUris:o,verifiedContextDirectoryUris:s,nonExistentContextUris:a}).render(void 0,void 0),d=await this._chatMLFetcher.fetchOne("terminalQuickFixGenerator",u.messages,void 0,r,3,c);if(this._logService.public.info("Terminal QuickFix FetchResult "+d),r.isCancellationRequested)return;if(d.type!=="success")throw new Error(kc.l10n.t("Encountered an error while determining terminal quick fixes: {0}",d.type));this._logService.internal.debug("generalTerminalQuickFix fetchResult.value "+d.value);let p=[];try{let f=JSON.parse(d.value);if(f&&Array.isArray(f)){for(let m of f)if(typeof m=="object"&&m){let h="command"in m&&typeof m.command=="string"?m.command:void 0,g="description"in m&&typeof m.description=="string"?m.description:void 0,v="relevance"in m&&typeof m.relevance=="string"&&(m.relevance==="low"||m.relevance==="medium"||m.relevance==="high")?m.relevance:void 0;h&&g&&v&&p.push({command:h,description:g,relevance:Wat(v)})}}}catch{}return p}async _generateTerminalQuickFixFileContext(e,r){let n=await this._endpointProvider.getChatEndpoint("gpt-3.5-turbo"),s=await Me.create(this._instantiationService,n,vw,{commandLine:e.commandLine,output:[]}).render(void 0,void 0);this._logService.internal.debug("_generalTerminalQuickFixFileContext prompt.messages: "+s.messages);let a=await this._chatMLFetcher.fetchOne("terminalQuickFixGenerator",s.messages,async f=>{},r,3,n);if(this._logService.internal.info("Terminal Quick Fix Fetch Result: "+a),r.isCancellationRequested)return;if(a.type!=="success")throw new Error(kc.l10n.t("Encountered an error while fetching quick fix file context: {0}",a.type));this._logService.internal.debug("_generalTerminalQuickFixFileContext fetchResult.value"+a.value);let c=[];try{let f=JSON.parse(a.value);if(f&&Array.isArray(f)){for(let m of f)if(typeof m=="object"&&m){let h="fileName"in m&&typeof m.fileName=="string"?m.fileName:void 0;h&&c.push({fileName:h})}}}catch{}let l=[],u=new Set,d=this._workspaceService.getWorkspaceFolders(),p=async f=>{for(let m of d){let h=He.joinPath(m,f);if(u.has(h.toString()))return;u.add(h.toString()),l.push(h)}};for(let{fileName:f}of c)f.endsWith(".exe")||f.includes("/bin/")&&!f.endsWith("activate")||((0,gEe.isAbsolute)(f)?l.push(vEe.Uri.file(f)):await p(f));return l}};CL=E([y(0,yt),y(1,xe),y(2,j),y(3,ie),y(4,qe)],CL);var IU=ne("IConversationFeature"),xw=class{constructor(e,r,n,o,s,a,c,l,u,d,p,f,m){this.accessor=e;this.instantiationService=r;this.logService=n;this.configurationService=o;this.conversationOptions=s;this.chatAgentService=a;this.telemetryService=c;this.authenticationService=l;this.embeddingIndex=u;this.devContainerConfigurationService=d;this.gitCommitMessageService=p;this.linkifyService=f;this.newWorkspacePreviewContentManager=m;this._disposables=new ht;this._activatedDisposables=new ht;this._searchProviderRegistered=!1;this._enabled=!1,this._activated=!1,this.registerCopilotTokenListener(),this._disposables.add(l.onDidAuthenticationChange(async()=>{let h=!!l.copilotToken;this.logService.public.debug(`onDidChangeSessionsHandler has token: ${h}`),h?this.activated=!0:this.activated=!1})),this._disposables.add(this.configurationService.onDidChangeConfiguration(h=>{if(h.affectsConfiguration(le.SemanticSearchEnabled.fullyQualifiedId)){let g=this.registerSearchProvider();g&&this._activatedDisposables.add(g)}}))}get enabled(){return this._enabled}set enabled(e){e&&!this.activated&&(this.activated=!0),this._enabled=e,jt.commands.executeCommand("setContext","github.copilot.interactiveSession.disabled",!e)}get activated(){return this._activated}set activated(e){if(this._activated!==e)if(this._activated=e,!e)this._activatedDisposables.clear();else{let r=this.conversationOptions;this._activatedDisposables.add(this.registerProviders()),this._activatedDisposables.add(this.registerCommands(r)),this._activatedDisposables.add(this.registerRelatedInformationProviders()),this._activatedDisposables.add(this.registerParticipants(r)),this._activatedDisposables.add(this.instantiationService.createInstance(rv,sEe))}}dispose(){this._activated=!1,this._activatedDisposables.dispose(),this._disposables?.dispose()}[Symbol.dispose](){this.dispose()}registerParticipants(e){return this.chatAgentService.register(e)}registerSearchProvider(){if(!this._searchProviderRegistered&&this.configurationService.getConfig(le.SemanticSearchEnabled))return this._searchProviderRegistered=!0,jt.workspace.registerAITextSearchProvider("file",this.instantiationService.createInstance(mw))}registerProviders(){let e=new ht;try{this.registerParticipantDetectionProvider();let r=this.registerSearchProvider();r&&e.add(r)}catch(r){this.logService.public.error(r,"Registration of interactive providers failed")}return e}registerParticipantDetectionProvider(){if("registerChatParticipantDetectionProvider"in jt.chat){let e=this.instantiationService.createInstance(Xp,2);this._disposables.add(jt.chat.registerChatParticipantDetectionProvider(e))}}registerCommands(e){let r=new ht;return[jt.commands.registerCommand("github.copilot.interactiveSession.feedback",async()=>jt.env.openExternal(jt.Uri.parse(Qhe))),jt.commands.registerCommand("github.copilot.terminal.explainTerminalSelection",async()=>this.triggerTerminalChat({query:`/${Ed.intentName} #terminalSelection`})),jt.commands.registerCommand("github.copilot.terminal.explainTerminalSelectionContextMenu",()=>jt.commands.executeCommand("github.copilot.terminal.explainTerminalSelection")),jt.commands.registerCommand("github.copilot.terminal.explainTerminalLastCommand",async()=>this.triggerTerminalChat({query:`/${Ed.intentName} #terminalLastCommand`})),jt.commands.registerCommand("github.copilot.terminal.fixTerminalLastCommand",async()=>_Ee(this.instantiationService)),jt.commands.registerCommand("github.copilot.terminal.generateCommitMessage",async()=>{let n=jt.workspace.workspaceFolders;if(!n?.length)return;let o=n.length===1?n[0].uri:await jt.window.showWorkspaceFolderPick().then(c=>c?.uri);if(!o)return;let s=this.gitCommitMessageService.getRepository(o);if(!s)return;let a=await this.gitCommitMessageService.generateCommitMessage(s,Wt.None);if(a){let l=`git commit -m "${a.replace(/"/g,'\\"').replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}"`;jt.window.activeTerminal?.sendText(l,!1)}}),jt.commands.registerCommand("github.copilot.git.generateCommitMessage",async(n,o,s)=>{let a=this.gitCommitMessageService.getRepository(n);if(!a)return;let c=await this.gitCommitMessageService.generateCommitMessage(a,s);c&&(a.inputBox.value=c)}),jt.commands.registerCommand("github.copilot.devcontainer.generateDevContainerConfig",async(n,o=new jt.CancellationTokenSource().token)=>this.devContainerConfigurationService.generateConfiguration(n,o)),pEe(this.accessor),abe(this.telemetryService),this.linkifyService.registerGlobalLinkifier({create:()=>this.instantiationService.createInstance(yT)}),Gye(this.accessor),lbe(this.accessor),this.registerTerminalQuickFixProviders(),hEe(this.newWorkspacePreviewContentManager,this.logService,e),Qat(this.accessor),ibe(this.accessor),Kat(),Yat()].forEach(n=>r.add(n)),r}async triggerTerminalChat(e){let r=this.configurationService.getConfig(le.TerminalChatLocation),n;switch(r){case"quickChat":n="workbench.action.quickchat.toggle",e.query=`@${II} `+e.query;break;case"terminal":n="workbench.action.terminal.chat.start";break;case"chatView":default:n="workbench.action.chat.open",e.query=`@${II} `+e.query;break}await jt.commands.executeCommand(n,e)}registerRelatedInformationProviders(){let e=new ht;return[jt.ai.registerRelatedInformationProvider(jt.RelatedInformationType.CommandInformation,this.embeddingIndex.commandIdIndex),jt.ai.registerRelatedInformationProvider(jt.RelatedInformationType.SettingInformation,this.embeddingIndex.settingsIndex)].forEach(r=>e.add(r)),e}registerCopilotTokenListener(){this._disposables.add(this.authenticationService.onDidAuthenticationChange(()=>{let e=this.authenticationService.copilotToken?.isChatEnabled();this.logService.public.info(`copilot token chat_enabled: ${e}, sku: ${this.authenticationService.copilotToken?.sku??""}`),this.enabled=e??!1}))}registerTerminalQuickFixProviders(){let e=()=>this.enabled;return z1(jt.window.registerTerminalQuickFixProvider("copilot-chat.fixWithCopilot",{provideTerminalQuickFixes(r,n){return!e()||r.commandLine.endsWith("^C")?[]:(yEe(r),[{command:"github.copilot.terminal.fixTerminalLastCommand",title:jt.l10n.t("Fix using Copilot")},{command:"github.copilot.terminal.explainTerminalLastCommand",title:jt.l10n.t("Explain using Copilot")}])}}),jt.window.registerTerminalQuickFixProvider("copilot-chat.generateCommitMessage",{provideTerminalQuickFixes:(r,n)=>this.enabled?[{command:"github.copilot.terminal.generateCommitMessage",title:jt.l10n.t("Generate Commit Message")}]:[]}))}};xw=E([y(0,Rt),y(1,j),y(2,ie),y(3,he),y(4,dc),y(5,QF),y(6,ge),y(7,Tt),y(8,md),y(9,XF),y(10,e5),y(11,nT),y(12,DD)],xw);function Kat(){return jt.commands.registerCommand("github.copilot.executeSearch",async t=>{let e=t.filesToExclude.length>0||t.filesToInclude.length>0;jt.commands.executeCommand("workbench.view.search.focus").then(()=>jt.commands.executeCommand("workbench.action.search.toggleQueryDetails",{show:e})),jt.commands.executeCommand("workbench.action.findInFiles",t)})}function Yat(){return jt.commands.registerCommand("github.copilot.ghpr.applySuggestion",async(t,e)=>{let r=s=>!!(s&&"body"in s&&(s.body instanceof jt.MarkdownString||typeof s.body=="string")),n=s=>"range"in s&&s.range instanceof jt.Range;if(!r(t)||!n(e))return;let o=t.body instanceof jt.MarkdownString?t.body.value:t.body;await jt.commands.executeCommand("vscode.editorChat.start",{initialRange:e.range,message:o,autoSend:!0})})}function Qat(t){return new bU(t)}var BEe=q(Ct());var Sw=class{constructor(e,r,n,o,s,a,c){this.intent=e;this.location=r;this.endpoint=n;this.prompt=o;this.documentContext=s;this.features=a;this.instantiationService=c;this.replyInterpreter=null;this.generateFollowUps=void 0}async buildPrompt(e,r,n){let o=Me.create(this.instantiationService,this.endpoint,this.prompt,{documentContext:this.documentContext,promptContext:e,features:this.features}),s=await o.render(r,n);return this.replyInterpreter=o.getMeta(Ms)?.replyInterpreter??null,this.generateFollowUps=o.getMeta(HI)?.followUps,s}processResponse(e,r,n,o){if(!this.replyInterpreter)throw new Error("Could not process response without a reply interpreter.");return this.replyInterpreter.processResponse(e,r,n,o)}};Sw=E([y(6,j)],Sw);var Mte=q(Ct()),bf=q(Ue());var SEe=q(Ue());var CU=class extends SEe.PromptElement{render(e,r){let{useWorkspaceChunksFromSelection:n,useWorkspaceChunksFromDiagnostics:o}=this.props;if(!n&&!o)return null;let s=r.tokenBudget;return n&&o&&(s=s/2),vscpp(vscppf,null,n&&vscpp(th,{...this.getChunkSearchPropsForSelection()}),o&&vscpp(th,{...this.getChunkSearchPropsForDiagnostics(s)}))}getChunkSearchPropsForSelection(){let{document:e,wholeRange:r}=this.props.documentContext,n=e.validateRange(r);this.props.diagnostics.forEach(a=>{n=n.union(a.range)});let o=e.getText(n),s=[`Please find code that is similar to the following code block:
`,"```",o,"```"].join(`
`);return{query:{rawQuery:s,resolveQueryAndKeywords:async()=>({rephrasedQuery:s,keywords:xEe(o)}),resolveQuery:async()=>s},include:{exclude:[e.uri.fsPath]},maxResults:3}}getChunkSearchPropsForDiagnostics(e){let r=this.props.documentContext.document,n=this.props.diagnostics.map(s=>s.message).join(" "),o=`Please find code that can help me fix the following problems: ${n}`;return{query:{rawQuery:o,resolveQueryAndKeywords:async()=>({rephrasedQuery:o,keywords:xEe(n)}),resolveQuery:async()=>o},include:{exclude:[r.uri.fsPath]},maxResults:3}}};function xEe(t){let e=new Set;for(let r of t.matchAll(/(-?\d*\.\d\w*)|([^\`\~\!\@\#\%\^\&\*\(\)\-\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g))e.add(r[0]);return Array.from(e.values(),r=>({keyword:r,variations:[]}))}var Iw=class extends bf.PromptElement{constructor(r,n,o,s,a){super(r);this.ignoreService=n;this.parserService=o;this.languageDiagnosticsService=s;this.instantiationService=a}async render(r,n){let{document:o,wholeRange:s,fileIndentInfo:a,selection:c,language:l}=this.props.documentContext;if(await this.ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});if(er(o.uri))throw pn("InlineFix3PlusPrompt should not be used with a notebook!");let d=n.endpoint.modelMaxPromptTokens/3*4,p,f=!1;if(o.getText().length>d){let w=await Ap(this.parserService,o,a);p=Lv(d,o,s,w,{tryPreserveTypeChecking:!0}),f=!0}else p=new ll(o.getText(),Or.empty,o.languageId);let{query:m,history:h,chatVariables:g}=this.props.promptContext,{useWorkspaceChunksFromDiagnostics:v,useWorkspaceChunksFromSelection:b}=this.props.features,_=p.projectRange(c),x=o.getText(new Be(c.start.line,0,c.end.line+1,0)).trimEnd(),S=x0(this.languageDiagnosticsService,o.uri,c,m),I=this.instantiationService.createInstance(TL,p,o.uri,_);return vscpp(vscppf,null,vscpp("references",{value:[new bf.PromptReference(o.uri)]}),vscpp("meta",{value:new Ms(I)}),vscpp(bf.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"The user has a ",l.languageId," file opened in a code editor.",vscpp("br",null),"The user expects you to propose a fix for one or more problems in that file.",vscpp("br",null),"For the response always follow these instructions:",vscpp("br",null),"Describe in a single sentence how you would solve the problem. After that sentence, add an empty line. Then provide code changes or a terminal command to run.",vscpp("br",null),"When proposing to fix the problem by running a terminal command, write `",Xat,"` and provide a code block that starts with ```bash and contains the terminal script inside.",vscpp("br",null),vscpp(_d,null),vscpp(ct,null),vscpp(Zt,{name:"example",priority:100},vscpp(Zt,{name:"user"},"I have the following code open in the editor.",vscpp("br",null),vscpp(Y_,{fileName:"someFolder/myFile.cs",language:"csharp",code:["// This is my class","class C { }","","new C().Field = 9;"]})),vscpp(Zt,{name:"assistant"},"The problem is that the class 'C' does not have a field or property named 'Field'. To fix this, you need to add a 'Field' property to the 'C' class.",vscpp("br",null),vscpp("br",null),vscpp(Kp,{changes:[{fileName:"someFolder/myFile.cs",find:["// This is my class","class C { }"],replace:["// This is my class","class C {","public int Field { get; set; }","}"]},{fileName:"someFolder/myFile.cs",find:["new C().Field = 9;"],replace:["// set the field to 9","new C().Field = 9;"]}]})))),vscpp(It,{inline:!0,priority:700,history:h}),vscpp(bf.UserMessage,{priority:700},vscpp(cr,{languageId:l.languageId}),vscpp(Ql,{currentDocument:o}),vscpp(ia,null,...l6(g)),vscpp(ia,null,p.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",p.lineCount,".",vscpp("br",null),s0(o.fileName),vscpp("br",null),vscpp(nt,{uri:o.uri,languageId:l.languageId,code:p.text,shouldTrim:!1,isSummarized:f}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",s0(o.fileName),vscpp("br",null))),vscpp(ia,null,c.isEmpty?vscpp(vscppf,null,"I have the selection at line ",_.start.line+1,", column ",_.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",_.start.line+1,", column ",_.start.character+1," to line ",_.end.line+1," column ",_.end.character+1,".",vscpp("br",null))),vscpp(ia,null,x.length&&!S.some(w=>w.range.contains(c))&&vscpp(vscppf,null,"The content of the lines at the selection is",vscpp(nt,{uri:o.uri,languageId:l.languageId,code:x,shouldTrim:!1}),vscpp("br",null))),vscpp(eu,{documentContext:this.props.documentContext,diagnostics:S}),vscpp(CU,{diagnostics:S,documentContext:this.props.documentContext,useWorkspaceChunksFromDiagnostics:v,useWorkspaceChunksFromSelection:b}),vscpp(Zt,{name:"userPrompt"},vscpp(bf.TextChunk,null,"Please find a fix for my code so that the result is without any errors."),vscpp(So,{chatVariables:g,query:m}),vscpp("br",null))))}};Iw=E([y(1,Te),y(2,dt),y(3,Vi),y(4,j)],Iw);var Xat=Tye("TERMINAL"),TL=class{constructor(e,r,n,o){this.projectedDocument=e;this.documentUri=r;this.adjustedSelection=n;this.logService=o;this._lastText="";this._replyProcessor=a0()}async processResponse(e,r,n,o){let s=!0,a=0;for await(let u of r){if(o.isCancellationRequested)return;let d=u.text;if(d.length>this._lastText.length&&(this._lastText=d,s)){let p=this._replyProcessor.getFirstParagraph(d);p.length>a?(n.markdown(p.substring(a)),a=p.length):(s=!1,n.markdown(`

`),n.progress("Generating edits..."))}}if(this._lastText.length===0){n.warning(Mte.t("Copilot did not provide a response. Please try again."));return}let c=this._replyProcessor.process(this._lastText,this.projectedDocument.text,this.documentUri,this.adjustedSelection.start.line);if(c.otherSections.length)for(let u of c.otherSections)n.markdown(u.content.join(`

`));if(c.otherPatches.length)for(let u of c.otherPatches)n.markdown(u.replace.join(`

`));let l=c.edits;if(l.length)if(l=this.projectedDocument.projectBackTextEdit(l),c.edits.length!==l.length)c.annotations.push({message:"Some edits were not applied because they were out of bounds.",label:"summarize conflict",severity:"error"});else{let u=Jat(c.edits,l,this.projectedDocument);u&&c.annotations.push(u)}e.addAnnotations(c.annotations),l.length?n.textEdit(this.documentUri,l):c.otherPatches.length||n.warning(Mte.t("The edit generation was not successful. Please try again.")),c.annotations.length&&this.logService.public.info(`[inline fix] Problems generating edits: ${c.annotations.map(u=>`${u.message} [${u.label}]`).join(", ")}, invalid patches: ${c.invalidPatches.length}`)}};TL=E([y(3,ie)],TL);function Jat(t,e,r){for(let n=0;n<t.length;n++){let o=r.positionOffsetTransformer.toOffsetRange(t[n].range).substring(r.text),s=r.originalPositionOffsetTransformer.toOffsetRange(e[n].range).substring(r.originalText);if(o!==s)return{message:`Problem projecting edits: '${o}' does not match '${s}' (projectecBack)`,label:"invalid projection",severity:"error"}}}var Fte=q(Ct()),Mx=q(Ue());function IEe(t,e){let r=t;for(let n of e){let o=n.range.start,s=n.range.end,a=r.start,c=r.end,l=n.newText.split(`
`).length,u=l-(s.line-o.line)-1,d=a.line,p=a.line;s.isBefore(a)?(d=a.line+u,p=c.line+u):o.isBefore(a)&&s.isAfterOrEqual(a)&&s.isBeforeOrEqual(c)?(d=o.line,p=c.line+u):o.isAfterOrEqual(a)&&o.isBeforeOrEqual(c)&&s.isAfter(c)?(d=a.line,p=s.line+u):o.isAfter(c)?(d=a.line,p=c.line):r.contains(n.range)?(d=a.line,p=c.line+u):n.range.contains(r)&&(d=o.line,p=o.line+l-1),r=new Be(d,0,p,0)}return r}function CEe(t,e,r){let n=Zat(t,e);if(!n)return null;let{code:o,contentBeforeCode:s,language:a}=n;if(Pp.testLine(r,o)){let c=o.indexOf(`
`);o=o.substring(c).trim()}return{code:o,contentBeforeCode:s,language:a}}function Zat(t,e){e=e.trim();let n=Ls(e).at(0);if(n){let l=rd(e);return{code:n.code,contentBeforeCode:l.slice(0,n.startLine).join(`
`).trimEnd(),language:n.language}}let o=e.split(/\r\n|\r|\n/g),s=!1,a=[],c=[];for(let l of o){let u=D5(t,l);if(s){if(u)return c.push(l),{code:c.join(`
`),contentBeforeCode:a.join(`
`),language:""};c.push(l)}else u?(s=!0,c.push(l)):a.push(l)}return null}var TEe=q(Ue());var TU=class extends TEe.PromptElement{render(){let e=this.props.language;return vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"The user has a ",e.languageId," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Each code block starts with ``` and ",Pp.forLanguage(e),".",vscpp("br",null),"Answer with a single ",e.languageId," code block.",vscpp("br",null),"If you modify existing code, you will use the ",vd.begin(e)," and ",vd.end(e)," markers.")}};var ect=15,Cw=class extends Mx.PromptElement{constructor(r,n,o,s,a,c,l){super(r);this._ignoreService=n;this._instantiationService=o;this._languageDiagnosticsService=s;this._parserService=a;this._tabsAndEditorsService=c;this._workspaceService=l}async render(r,n){let o=this.props.documentContext;if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[o.document.uri]});if(!er(o.document.uri))throw pn("InlineFix4Prompt should not be used with a non-notebook!");let{query:a,history:c,chatVariables:l}=this.props.promptContext,u=x0(this._languageDiagnosticsService,o.document.uri,o.selection,a),d=u.length>0?fye(u):o.selection,p=this._parserService.getTreeSitterAST(o.document),f=p?await gbe(p,d,ect):d,m=hbe(n.endpoint,o,d,f),h=H6(this._tabsAndEditorsService,this._workspaceService,o,m.contextInfo,m.tracker),g=this._instantiationService.createInstance(EL,d,h,o);return vscpp(vscppf,null,vscpp("meta",{value:new Ms(g)}),vscpp("meta",{value:new HI(()=>g.generateFollowUps())}),vscpp(Mx.SystemMessage,null,vscpp(TU,{language:o.language}),vscpp("br",null),"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If you suggest to run a terminal command, use a code block that starts with ```bash.",vscpp("br",null),'When fixing "ModuleNotFoundError" or "Import could not be resolved" errors, always use magic command "%pip install" to add the missing packages. The imports MUST be inserted at the top of the code block and it should not replace existing code.',vscpp("br",null),"You should not import the same module twice.",vscpp("br",null),vscpp(ct,null)),vscpp(It,{inline:!0,priority:700,history:c}),vscpp(Mx.UserMessage,{priority:725},vscpp(cr,{languageId:o.language.languageId})),vscpp(Kt,{priority:750,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:750,chatVariables:l}),vscpp(G6,{documentContext:o,above:h.above,range:h.range,below:h.below,aboveCells:h.aboveCells,belowCells:h.belowCells,includeDelimeters:!0}),vscpp(Mx.UserMessage,null,vscpp(eu,{documentContext:o,diagnostics:u}),"Describe in a single sentence how you would solve the problem. After that sentence, add an empty line. Then add a code block with the fix.",vscpp(So,{chatVariables:l,query:a}),vscpp("br",null)))}};Cw=E([y(1,Te),y(2,j),y(3,Vi),y(4,dt),y(5,Ft),y(6,qe)],Cw);var EL=class{constructor(e,r,n,o,s){this.wholeRange=e;this.contextInfo=r;this.documentContext=n;this._logService=o;this._languageDiagnosticsService=s;this._lastText=void 0;this._lastLength=0}async processResponse(e,r,n,o){for await(let a of r){if(this._lastText=a.text,this._firstSentence===void 0){let c=Rve(a.text);c.length<a.text.length&&(this._firstSentence=c),n.markdown(c.substring(this._lastLength)),this._lastLength=c.length}if(kve(a.text))break}if(!this._lastText)throw new Error("No text");let s=CEe(this.contextInfo,this._lastText,this.documentContext.language);if(!s||s.language==="bash"||s.language==="ps1"){n.markdown(this._lastText.substring(this._lastLength));return}this._edits=this.generateEdits(s.code),this._versionBeforeUpdate=this.documentContext.document.version,n.textEdit(this.documentContext.document.uri,this._edits)}generateEdits(e){let r=e.split(`
`),n=[],o=[];for(let c of r)c.match(/^[%\!]pip/)?n.push(c):o.push(c);if(!n.length)return _Y(this._logService,this.contextInfo,e,2,this.documentContext.fileIndentInfo,B2.fromDocumentContext(this.documentContext));let s=[],a=FI(n,{whichLine:"topMost",lines:this.contextInfo.range.lines},this.documentContext.fileIndentInfo).join(`
`)+`
`;return s.push(new Nn(new Be(this.wholeRange.start,this.wholeRange.start),a)),o.length&&s.push(..._Y(this._logService,this.contextInfo,o.join(`
`),2,this.documentContext.fileIndentInfo,B2.fromDocumentContext(this.documentContext))),s}async generateFollowUps(){return typeof this._edits>"u"||typeof this._versionBeforeUpdate>"u"?[]:this._generateFollowUps(this._edits,this.wholeRange,this._versionBeforeUpdate,Wt.None)}async _generateFollowUps(e,r,n,o){let s=await this._languageDiagnosticsService.waitForNewDiagnostics(this.documentContext.document.uri,o);if(!o.isCancellationRequested&&s.length&&this.documentContext.document.version!==n){let a=IEe(r,e),c=s.filter(l=>mye(l)&&l.range.intersection(a));if(c.length)return c.length===1?[{label:Fte.t("An error remains after applying the change, click here to iterate."),prompt:`/fix ${c[0].message}`}]:[{label:Fte.t("{0} errors remain after applying the change, click here to iterate.",c.length),prompt:"/fix Fix the remaining errors"}]}return[]}};EL=E([y(3,ie),y(4,Vi)],EL);var Fx=q(Ue());var EEe=q(Ue()),Tw=class extends EEe.PromptElement{render(){return vscpp(vscppf,null,"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.")}};var Ew=class extends Fx.PromptElement{constructor(r,n){super(r);this.languageDiagnosticsService=n}render(r,n){let o=this.props.documentContext,{history:s,chatVariables:a}=this.props.promptContext,c=this.props.promptContext.query||"There is a problem in this code. Rewrite the code to show it with the bug fixed.",l=({document:u,selection:d})=>x0(this.languageDiagnosticsService,u.uri,d,c);return vscpp(vscppf,null,vscpp(Fx.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),vscpp(Tw,null),vscpp("br",null),vscpp("br",null),vscpp(Up,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You specialize in being a highly skilled code generator. Your task is to help the Developer fix an issue.",vscpp("br",null),"If context is provided, try to match the style of the provided code as best as possible.",vscpp("br",null),"Generated code is readable and properly indented.",vscpp("br",null),"Markdown blocks are used to denote code.",vscpp("br",null),"Preserve user's code comment blocks, do not exclude them when refactoring code.",vscpp("br",null),"Pay especially close attention to the selection or exception context.",vscpp("br",null),"Given a description of what to do you can refactor, fix or enhance the existing code.",vscpp(kt,null)),vscpp(It,{flexGrow:1,priority:700,history:s}),vscpp(Fx.UserMessage,{flexGrow:1,priority:750},vscpp(cr,{languageId:o?.language.languageId})),vscpp(bn,{flexGrow:1,priority:800,document:o?.document,range:o?.selection}),o&&vscpp(Fx.UserMessage,{flexGrow:1,priority:800},vscpp(eu,{documentContext:o,diagnostics:l(o)})),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:a,query:c}))}};Ew=E([y(1,Vi)],Ew);var dy=q(Ct()),OEe=q(Ue());var AU=q(Ct());var PU=q(Ue());var ww=q(Ue());var EU=class extends ww.PromptElement{render(){let{chunk:e,failure:r,priority:n}=this.props,o=r.task.messages.filter(a=>a.location?.uri.toString()===e.uri.toString()&&e.range.containsPosition({column:a.location.range.start.character+1,lineNumber:a.location.range.start.line+1})),s=new fn(e.uri,new Be(e.range.startLineNumber-1,0,e.range.endLineNumber,0));return vscpp(ww.UserMessage,{priority:n},o.length?vscpp(vscppf,null,'This is the source code of the test that failed. The error message is shown after the text "FAILURE_MESSAGE" on the line where it occurred:'):vscpp(vscppf,null,"The test failed with the message: ",r.task.messages.map(a=>typeof a.message=="object"?a.message.value:a.message).join(`
`),". The source code of the test is:"),vscpp("br",null),vscpp(nt,{references:[new ww.PromptReference(s)],languageId:e.uri.fsPath.replaceAll("\\","/"),uri:e.uri,code:e.source.split(`
`).map((a,c)=>{let l=o.find(u=>u.location?.range.start.line===c+e.range.startLineNumber-1);return l?`${a} FAILURE_MESSAGE: ${l.message.toString().replaceAll(`
`," ")}`:a}).join(`
`)}),vscpp("br",null))}};var ly=q(Ue());function wEe(t,e,r){let n=0,o=t.length;for(;n<o;){let s=n+o>>>1;r(t[s],e)?n=s+1:o=s}return n}function wL(t,e){if(t.length===0)return;let r=t[0];for(let n=1;n<t.length;n++){let o=t[n];e(o,r)>0&&(r=o)}return r}var tct=/^[\*\-]\s*[`"']?([^<([`"'\s]+).*? +in +(.+)/gm,kEe=(t,e)=>[...t.matchAll(tct)].flatMap(([,r,n])=>r.split(",").map(o=>({keyword:o,fileUri:n,interest:"IMPLEMENTATION"}))).map(({keyword:r,fileUri:n,interest:o})=>{let s=wU(e,r,n)||wU(e,r);if(!s){let u=/^.+?(\b[^\b]+)/.exec(r);u&&(s=wU(e,u[1],n)||wU(e,u[1]))}if(!s)return;let{index:a,chunk:c}=s,l=c.convert.positionToOffset(c.range.getStartPosition());return{keyword:r,interest:o,location:{uri:c.uri,position:c.convert.offsetToPosition(l+a)}}}).filter(Z1);function wU(t,e,r){let n=r?t.filter(s=>s.uri.toString().toLowerCase()===r.toLowerCase()):t,o=new RegExp(`^(?!~:).*\\b(${g_(e)})\\b`,"m");for(let s=n.length-1;s>=0;s--){let a=n[s],c=o.exec(a.source);if(c)return{chunk:a,index:c.index+c[0].length-c[1].length}}}var REe=async(t,e,r,n)=>{let o=await r.readFile(t.uri),s=new TextDecoder().decode(o);return rct(t,e,s,n)},rct=async(t,e,r,n)=>{let o=new pc(r),s=new je(t.range.start.line+1,1,t.range.end.line+1,1);return s.endLineNumber-s.startLineNumber<=1&&(s=await nct(t,e,r,o,n)||s.setEndPosition(s.startLineNumber+50,1)),{range:s,source:r.slice(o.positionToOffset(s.getStartPosition()),o.positionToOffset(s.getEndPosition())),uri:t.uri,convert:o}},nct=async(t,e,r,n,o)=>{let s=cl(Ns(t.uri).languageId);if(!s)return;let c=await o.getTreeSitterASTForWASMLanguage(s,r).getFunctionDefinitions(),l=c.find(f=>f.identifier===e);if(l)return Ute(n,l);let u=n.positionToOffset(new Ut(t.range.start.line+1,1));c.sort((f,m)=>f.startIndex-m.startIndex);let d,p;for(let f of c){if(f.startIndex>u){p=f;break}f.startIndex<=u&&f.endIndex>=u&&(d=f)}return p&&(!d||p.startIndex>=d.startIndex&&p.endIndex<=d.endIndex)?Ute(n,p):d&&Ute(n,d)},Ute=(t,e)=>{let r=t.offsetToPosition(e.startIndex),n=t.offsetToPosition(e.endIndex);return new je(r.lineNumber-1,1,n.lineNumber+1,1)},PEe=async(t,e,r,n)=>{let o=cl(Ns(n).languageId);if(!o)return a=>"";let s=await t.getSemanticChunkTree(o,e);return a=>{let c=r.positionToOffset(a.getStartPosition()),l=r.positionToOffset(a.getEndPosition()),u=oct(s.roots,m=>m.info.mainBlock.startIndex<=c&&m.info.mainBlock.endIndex>=c),d="",p=(m,h)=>c<=m&&h<=l?!1:(d&&!d.endsWith(`
`)&&(d+=`
`),d+=e.slice(m,h),!0),f=m=>{if(m.info.detailBlocks.comments instanceof Array)for(let b of m.info.detailBlocks.comments)p(b.startIndex,b.endIndex);let h=/\s*\{\s/.exec(e.slice(m.info.detailBlocks.body.startIndex,m.info.detailBlocks.body.endIndex))?.[0].length||0,g=r.startOffsetOfLineContaining(m.info.mainBlock.startIndex),v=m.info.detailBlocks.body.startIndex+h;p(g,v)&&(d+=" ... "),m.children.forEach(f)};return u.forEach(f),d}},ict=/@@ -\d+,\d+ \+(\d+),(\d+) @@/g,AEe=async(t,{source:e,convert:r},n,o)=>{let s=[];for(let a of o.matchAll(ict)){let[,c,l]=a.map(Number);s.push({uri:n,range:new je(c,1,c+l,1),convert:r,source:e,interest:"CHANGED",tokensWithoutExpansion:t.tokenLength(e.slice(r.positionToOffset(new Ut(c,1)),r.positionToOffset(new Ut(c+l,1))))})}return s},oct=(t,e)=>{let r=n=>{let o=n.children.map(r).filter(Z1);return o.length||e(n)?{children:o,info:n.info}:void 0};return t.map(r).filter(Z1)},DEe=(t,e)=>{let r=new pc(t),n=e.map(u=>{let d=r.positionToOffset(new Ut(u.range.start.line+1,u.range.start.character+1)),p=r.positionToOffset(new Ut(u.range.end.line+1,u.range.end.character+1));return{start:d,end:p,text:u.newText}});n.sort((u,d)=>u.start-d.start||u.end-d.end);let o=0,s=0;function a(u){let d=u.indexOf(`
`);if(d===-1){s+=u.length;return}for(;d!==-1;)o++,s=u.length-d-1,d=u.indexOf(`
`,d+1)}let c=0,l=[];for(let{start:u,end:d,text:p}of n){a(t.slice(c,u));let f=new xr(o,s);a(p);let m=new xr(o,s);c=d;let h=t.slice(u,d);l.push(Nn.replace(new Be(f,m),h))}return l};function sct(t,e,r){let n=wL(t,(u,d)=>u.range.startLineNumber-d.range.startLineNumber).range.getStartPosition(),o=wL(t,(u,d)=>d.range.endLineNumber-u.range.endLineNumber).range.getEndPosition(),s=e?new Ut(Math.max(1,n.lineNumber-Math.ceil(e*2/3)),1):n,a=e-(n.lineNumber-s.lineNumber),c=a>0?new Ut(o.lineNumber+a,1):o,l=r(new je(s.lineNumber,1,c.lineNumber,1));return{start:s,end:c,context:l?l+`
`:"",snippet:t[0].source.slice(t[0].convert.positionToOffset(s),t[0].convert.positionToOffset(c)),original:t}}function act(t){return NEe(t)+"```"+t.original[0].uri.toString()+`
`+t.context+t.snippet+"\n```\n"}function cct({start:t,end:e,snippet:r,original:n}){return{uri:n[0].uri,source:r,convert:n[0].convert,range:new je(t.lineNumber,1,e.lineNumber,1)}}function NEe(t){let e=t.original.flatMap(r=>r.keywords||[]);return e.length?`Definition of \`${e.join("` and `")}\`:
`:`Here's code I've been working on that might be related to the failure:
`}function lct(t){return t.start.lineNumber>1||t.end.lineNumber<t.original[0].convert.lines}var kU=class extends ly.PromptElement{async prepare(e){let{chunks:r,parser:n,tokenizer:o}=this.props,s=0,a,c=new Nr;for(let l of r)c.has(l.uri)||c.set(l.uri,await PEe(n,l.source,l.convert,l.uri));for(;;){let l=(a?a.chunks.map(p=>p.original):r.map(p=>[p])).map(p=>sct(p,s,c.get(p[0].uri))),u=l.map(act).join(""),d=o.tokenLength(u);if(a&&(d*1.1>e.tokenBudget||!l.some(lct)))return Promise.resolve({chunks:l});for(let p=0;p<l.length;p++){let f=l[p],m=f.original[0].uri.toString(),h={startLineNumber:f.start.lineNumber,startColumn:1,endLineNumber:f.end.lineNumber,endColumn:1};for(let g=p+1;g<l.length;g++){let v=l[g];if(v.original[0].uri.toString()!==m)continue;let b={startLineNumber:v.start.lineNumber,startColumn:1,endLineNumber:v.end.lineNumber,endColumn:1};je.areIntersectingOrTouching(h,b)&&(f.original.push(...v.original),l.splice(g,1),g--)}}s++,a={tokens:d,chunks:l}}}render({chunks:e}){return vscpp(vscppf,null,vscpp("meta",{value:new kL(e.map(cct))}),e.map((r,n)=>vscpp(ly.UserMessage,{priority:100-(e.length-n)},NEe(r),vscpp(nt,{languageId:r.original[0].uri.fsPath.replaceAll("\\","/"),uri:r.original[0].uri,code:r.context+r.snippet,references:[new ly.PromptReference(new fn(r.original[0].uri,new Be(r.start.lineNumber-1,0,r.end.lineNumber-1,0)))]}),vscpp("br",null))))}},kL=class extends ly.PromptMetadata{constructor(r){super();this.chunks=r}};var RU=class extends PU.PromptElement{render(){let{chunk:e,testFailure:r,references:n,turnsLeft:o,parser:s,tokenizer:a}=this.props,c=n.length>0;return vscpp(vscppf,null,vscpp(PU.SystemMessage,{priority:1e3},"You are an assistant who specializes in diagnosing and fixing failing tests. The user will provide you with the source code of the test that failed, and the location where the failure happened. They will also provide you with relevant related code. This information may be incomplete.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),`- Read the test's source code and the line containing "FAILURE_MESSAGE". The text after "FAILURE_MESSAGE" is the error returned from running tests.`,vscpp("br",null),"- Assume that the test code and test fixtures are correct. It's more likely the problem is code called by the test.",vscpp("br",null),c&&vscpp(vscppf,null,"- The provided code is incomplete. DO NOT assume that something isn't implemented if it doesn't appear here.",vscpp("br",null)),o===0?vscpp(vscppf,null,"- If you believe you have found a bug in one of the code snippets the user provided, propose a code change.",vscpp("br",null),vscpp(_d,null)):vscpp(vscppf,null,c?vscpp(vscppf,null,"- If you have found a bug the code provided, propose a code change. Do this only if you have found the underlying bug!",vscpp("br",null),vscpp(_d,null),"- Otherwise, if you haven't found the bug, print a list of up to five keywords, classes, or function calls from one of the files that you need more information about to diagnose the failure. Make sure the most relevant keywords are written first. ",o===0&&"You won't get another chance to ask for more info.",vscpp("br",null),LEe):vscpp(vscppf,null,"- Don't try to fix the failure yet. Instead, print a list of keywords, classes, or function calls that you need more information about to diagnose the failure!",vscpp("br",null),LEe,vscpp("br",null)),"- NEVER ask the user for additional information or clarification, or give them suggestions to review code themselves. Instead, print keywords that should be investigated.",vscpp("br",null)),vscpp("br",null),o>0&&vscpp(vscppf,null,"# Example",vscpp("br",null),uct,vscpp("br",null),vscpp("br",null)),c&&vscpp(vscppf,null,"# Example",vscpp("br",null),dct,vscpp("br",null))),vscpp(EU,{chunk:e,failure:r,priority:800}),vscpp(kU,{flexGrow:1,priority:700,chunks:n,parser:s,tokenizer:a}))}},uct=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`/project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\` in /project/my.test.ts:

\`\`\`/project/strings.ts
function doReverseString(str: string): number {
	return stringUtils.reverseString(str);
}
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),vscpp("br",null),"I need more information about:",vscpp("br",null),"- stringUtils.reverseString",vscpp("br",null)),dct=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`/project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\`:

\`\`\`/project/my.test.ts
function doReverseString(str: string): number {
	return stringUtils.reverseString(str);
}

Implementation of \`stringUtils.reverseString\`:

\`\`\`/project/strings.ts
function reverseString(str) {
	let out = '';
	for (let i = str.length; i >= 0; i--) {
		out += str[i];
	}
	return out;
}
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),"The problem is that the loop ieration starts after the last element. To fix this, modify the loop to start at `str.length - 1` instead of `str.length`.",vscpp("br",null),vscpp(Kp,{changes:[{fileName:"/project/stringUtils.ts",find:["	for (let i = str.length; i >= 0; i--) {"],replace:["	for (let i = str.length - 1; i >= 0; i--) {"]}]})),LEe=vscpp(vscppf,null,'- Write your response in a list in the form "- [keyword] in [file where keyword is used]". Do not include any extra text. Keywords should be EXACT substrings from the code the user provides, do not modify them.',vscpp("br",null));var pct=1e3;async function fct(t,e,r){let n=kye(t);if(!n.length)return;let o=He.file(n[0]),s="";try{s=(await r(o)).source}catch{}let a=e.find(u=>u.uri.toString()===o.toString())?.range.startLineNumber,l=a0().process(t,s,void 0,a);return{text:t,uri:o,annotations:l.annotations,code:(l.appliedPatches[0]||l.invalidPatches[0]||l.otherPatches[0])?.replace.join(`
`),before:l.contentBefore.join(`
`),after:l.contentAfter.join(`
`),edits:{apply:l.edits,undo:DEe(s,l.edits)}}}var mct=new Set(["rust"]),Bte=class{constructor(e,r){this.testLocation=r;this.fileCache=new Nr;this.globallySeen=new Set;this._promise=new Om;this.turnsUsed=0;this.tokensUsed=0;this.endpoint=e.endpoint,this.progress=e.progress,this.token=e.token,this.accessor=e.accessor,this.turnsBudget=e.turnsBudget,this.timeBudget=e.timeBudget,this.tokenBudget=e.tokenBudget,this.deadline=Date.now()+this.timeBudget,this.logService=e.accessor.get(ie),this.gitRepo=e.accessor.safeGet(ro)?.getExtensionApi()?.getRepository(this.testLocation.uri)||void 0}get promise(){return this._promise.p}get hasFoundSolution(){return this._promise.isResolved}get possibleExplanation(){return this._possibleExplanation}foundSolution(e){this._promise.complete(e)}gotPossibleExplanation(e,r){(!this._possibleExplanation||e.length>this._possibleExplanation.text.length)&&(this._possibleExplanation={text:e,references:r})}takeTurn(){return this.turnsUsed++,Date.now()+pct>=this.deadline?0:Math.max(0,this.turnsBudget-this.turnsUsed)}throwIfCancelled(){if(this.token.isCancellationRequested||this.hasFoundSolution)throw new dn}async getSymbols(e){let r=this.accessor.get(Te),n=this.accessor.get(_r).acquireTokenizer(this.endpoint),o=new Map,s=await this.getDefinitionLocations(e);this.throwIfCancelled();let a=new Set(s.flatMap(({links:l})=>l.map(u=>u.link.uri.fsPath))),c=new Set;if(this.gitRepo)try{c=await this.gitRepo.checkIgnore([...a])}catch{}for(let{keyword:l,links:u}of s)for(let{interest:d,link:p}of u){if(c.has(p.uri.fsPath)||await r.isCopilotIgnored(p.uri)||p.uri.toString()===this.testLocation.uri.toString()&&!mct.has(Ns(p.uri).languageId))continue;p.range.isEmpty&&(p.range=new Be(p.range.start,p.range.end.with(p.range.start.line+5)));let f=new Ut(p.range.start.line+1,1),m=p.range.isEmpty?new Ut(f.lineNumber+10,1):new Ut(p.range.end.line+1,p.range.end.character+1),h=[d,p.uri.toString(),p.range.start.line].join("\0");if(this.globallySeen.has(h))continue;let g=o.get(h);if(g){g.keywords.push(l);continue}try{let v=await this.readFile(p.uri);o.set(h,{keywords:[l],interest:d,uri:p.uri,range:je.fromPositions(f,m),tokensWithoutExpansion:n.tokenLength(v.source.slice(v.convert.positionToOffset(f),v.convert.positionToOffset(m))),...v}),this.progress.report(new BF(p))}catch{}}for(let l of o.keys())this.globallySeen.add(l);return[...o.values()]}async readFile(e){let r=this.fileCache.get(e);return r||(r=this.accessor.get(mr).readFile(e).then(n=>new TextDecoder().decode(n)).then(n=>({source:n,convert:new pc(n)})),this.fileCache.set(e,r)),r}async getDefinitionLocations(e){let r=this.accessor.get(jo);return Promise.all(e.map(async({keyword:n,interest:o,location:s})=>{let a=new xr(s.position.lineNumber-1,s.position.column-1+(n.length-1)),c=s.uri,l=()=>r.getDefinitions(c,a).then(f=>f.length?f:r.getImplementations(c,a)).then(f=>f.length?{interest:"DEFINITION",link:f[0]}:void 0),u=()=>r.getImplementations(c,a).then(f=>f.length?f:r.getDefinitions(c,a)).then(f=>f.length?{interest:"IMPLEMENTATION",link:f[0]}:void 0),d=[];(o==="DEFINITION"||o==="BOTH")&&d.push(l()),(o==="IMPLEMENTATION"||o==="BOTH")&&d.push(u());let p=(await Promise.all(d)).filter(Z1);return{keyword:n,links:p.map(f=>"targetUri"in f.link?{interest:f.interest,link:new fn(f.link.targetUri,f.link.targetRange)}:f)}}))}};var DU=class t{constructor(e,r,n){this.context=e;this.testFailure=r;this.testLocation=n}static create(e,r,n){let o=Pm(r.task.messages,s=>s.location);return(!o||n.uri.toString()!==o.uri.toString())&&(o=n),new t(new Bte(e,n),r,n)}async tryGetInitialGitContext(){let e=this.context.accessor.get(_r).acquireTokenizer(this.context.endpoint),r=this.context.gitRepo;if(!r)return[];let n=[],o=await r.diffWithHEAD();return await Promise.all(o.map(async s=>{if(s.status===2||s.status===6)return;let[a,c]=await Promise.all([r.diffWithHEAD(s.uri.fsPath),this.context.readFile(s.uri)]);n.push(...await AEe(e,c,s.uri,a))})),n}async climb(){let e=await REe(this.testLocation,this.testFailure.snapshot.label,this.context.accessor.get(mr),this.context.accessor.get(dt));if(!e)throw new Error("Could not find semantic information for the test location");let r=[];try{r=await this.tryGetInitialGitContext()}catch(s){this.context.logService.public.error(s,"Could not get git context for test failure")}let n=await Promise.race([this.context.promise,this.climbInner(this.context,e,{symbols:[],activity:r,name:`"${this.testFailure.snapshot.label}"`,prefixTokens:0,tokens:0}).then(()=>({type:2,possibleSolution:this.context.possibleExplanation}),s=>{if(ed(s))return{type:1,possibleSolution:this.context.possibleExplanation};throw s})]);return this.context.accessor.get(ge).sendMSFTTelemetryEvent("intent.fixTestFailure.outcome",{outcome:n.type===0?"solution":n.type===1?"cancelled":"nosolution",languageId:Ns(this.testLocation.uri).languageId},{requestsMade:this.context.turnsUsed,tokenCount:this.context.tokensUsed}),n}async climbInner(e,r,n,o=!1){let{endpoint:s,progress:a,token:c,accessor:l}=this.context,u=l.get(ge),d=l.get(yt),p=n.name,f=e.takeTurn();o&&(f=0);let m=l.get(_r).acquireTokenizer(s),h=Me.create(l.get(j),s,RU,{testFailure:this.testFailure,chunk:r,tokenizer:m,parser:l.get(dt),references:[...n.activity,...n.symbols],turnsLeft:o?0:f}),g=await h.render();n.prefixTokens=g.tokenCount,n.tokens=n.prefixTokens+g.tokenCount,e.tokensUsed+=n.tokens,e.throwIfCancelled(),a.report(new xi(AU.t("Investigating the code around {0}",p)));let v=await d.fetchOne("failingTestMonkey",g.messages,void 0,c,2,s);if(e.throwIfCancelled(),v.type!=="success")throw u.sendMSFTTelemetryEvent("failingTestResolver.error",{type:v.type,reason:v.reason,requestId:v.requestId}),new Error(AU.t("Encountered an error while deciding what test information to collect: ({0}) {1}",v.type,v.reason));let b=[r,...h.getMeta(kL).chunks],_=await fct(v.value,b,S=>this.context.readFile(S));if(_){e.foundSolution({type:0,references:g.references,solution:_});return}let x=kEe(v.value,b);if(f>0){let S=await e.getSymbols(x);await this.chunkAndSendFollowups(e,r,S,n)}x.length||e.gotPossibleExplanation(v.value,g.references)}async chunkAndSendFollowups(e,r,n,o){let s=[],a=e.accessor.get(_r).acquireTokenizer(e.endpoint);for(let c of n){let l=s[s.length-1],u=c.tokensWithoutExpansion+a.tokenLength("```${tokenizer.tokenLength(symbol.chunk.file.toString())}");!l||u+l.tokens>e.tokenBudget?s.push({activity:o.activity,symbols:[...o.symbols,c],tokens:o.tokens+u,name:o.name,prefixTokens:o.prefixTokens}):(l.symbols.push(c),l.tokens+=u)}for(let c of s){let l=c.symbols.slice(o.symbols.length).flatMap(u=>u.keywords||[]);c.name=l.length>1?AU.t('"{0}" + {1} more symbols...',l[0],l.length-1):`"${l[0]}"`,await this.climbInner(e,r,c)}if(s.length===0)return this.climbInner(e,r,o,!0)}};var uy=class{constructor(e,r,n){this.instantiationService=e;this.testProvider=r;this.endpointProvider=n;this.id="fixTestFailure";this.locations=[1,2];this.description=dy.t("Propose a fix for the a test failure");this.commandInfo={defaultEnablement:!0,allowsEmptyArgs:!0}}static{this.ID="fixTestFailure"}get intentDetectionInput(){let e="fix_test_failure";return{disabled:!0,functionName:e,sampleQuestion:"This test failed, suggest how to fix it.",functionCallingBlurb:`If the user's message is related to generating code to fix test failures, you should use the '${e}' function.`}}async invoke(e){let r;(h=>(h[h.Any=0]="Any",h[h.SameDocument=1]="SameDocument",h[h.InViewRange=2]="InViewRange",h[h.InSelection=3]="InSelection"))(r||={});let n,o=0,s=e.documentContext?.document.uri.toString();for(let d of this.testProvider.getAllFailures())if(!n||!n.snapshot.uri||!n.snapshot.range)n=d;else if(d.snapshot.range&&d.snapshot.uri?.toString()===s&&(o<1&&(n=d,o=1),d.snapshot.range.intersection(e.documentContext.wholeRange)&&(n=d,o=2),d.snapshot.range.intersection(e.documentContext.selection))){n=d,o=3;break}if(!n)throw new H2(dy.t("No test failures found."));let{range:a,uri:c}=n.snapshot;if(!c||!a)throw new H2(dy.t("Tests have no associated editor location."));let l=e.location,u=await this.endpointProvider.getChatEndpoint("gpt-4");return this.instantiationService.createInstance(RL,this,u,l,n,{uri:c,range:a})}};uy=E([y(0,j),y(1,_c),y(2,xe)],uy);var RL=class{constructor(e,r,n,o,s,a){this.intent=e;this.endpoint=r;this.location=n;this.testFailure=o;this.testLocation=s;this.instantiationService=a}async buildPrompt({history:e,query:r,chatVariables:n},o,s){r=r||"This test failed, suggest how to fix it.";let a=Me.create(this.instantiationService,this.endpoint,PL,{testFailure:this.testFailure,chatVariables:n,query:r,endpoint:this.endpoint,progress:o,chatLocation:this.location,location:this.testLocation,history:e}),c=await a.render(o,s),l=a.getMeta(NU)?.value;l&&(this.lastSolutionForInterpreter={outcome:l,test:this.testFailure.snapshot});let u=a.getMeta(LU)?.value;return{...c,references:u||c.references}}processResponse(e,r,n,o){let{outcome:s,test:a}=this.lastSolutionForInterpreter;return new qte(a,s).processResponse(e,r,n,o)}};RL=E([y(5,j)],RL);var PL=class extends OEe.PromptElement{constructor(r,n){super(r);this.accessor=n}async prepare(r,n,o=Wt.None){let{progress:s}=this.props,c=await DU.create({accessor:this.accessor,endpoint:this.props.endpoint,progress:s,token:o,tokenBudget:r.tokenBudget,timeBudget:1/0,turnsBudget:6},this.props.testFailure,this.props.location).climb();if(this.props.chatLocation===1)return{outcome:c};if(c.type===0)if(c.solution.edits){s.report(new ai(new vo(c.solution.before))),s.report(new Da(c.solution.uri,c.solution.edits.apply)),s.report(new ai(new vo(c.solution.after)));let l=new S_;l.set(c.solution.uri,c.solution.edits.apply);let u=new S_;u.set(c.solution.uri,c.solution.edits.undo),s.report(new I_(UEe(this.props.testFailure.snapshot,l,u)))}else s.report(new ai(new vo(c.solution.text)));else c.possibleSolution?s.report(new ai(new vo(c.possibleSolution.text))):c.type===1?(s.report(new ai(MEe())),s.report(new I_({command:"workbench.action.openSettings",title:dy.t("Go to Settings"),arguments:[{query:"github.copilot.config.testFixLimits"}]}))):s.report(new ai(FEe()));return{outcome:c}}render(r,n){return vscpp(vscppf,null,vscpp("meta",{value:new NU(r.outcome)}),vscpp("meta",{value:new LU(r.outcome.type===0?r.outcome.references:r.outcome.possibleSolution?.references||[])}))}};PL=E([y(1,Rt)],PL);var MEe=()=>dy.t("Unfortunately I was unable to find a solution to this test failure in the time alloted. My time limit can be configured in your settings."),FEe=()=>dy.t("Unfortunately I was unable to find a solution to this test failure. Please try providing more context."),NU=class extends ql{constructor(r){super();this.value=r}},LU=class extends ql{constructor(r){super();this.value=r}},qte=class{constructor(e,r){this.test=e;this.solution=r}async processResponse(e,r,n,o){let s=this.solution||{type:1};if(s.type!==0){if(s.possibleSolution){n.markdown(s.possibleSolution.text);return}else if(s.type===1){n.markdown(MEe());return}else if(s.type===2){n.markdown(FEe());return}}let a=s.solution;if(a.annotations&&e.addAnnotations(a.annotations),!a.uri||!a.edits){n.markdown(a.text);return}let c=new S_;c.set(a.uri,a.edits.apply);let l=new S_;l.set(a.uri,a.edits.undo),n.markdown(a.before),n.textEdit(a.uri,a.edits.apply),n.markdown(a.after),n.button(UEe(this.test,c,l))}};function UEe(t,e,r){return{title:dy.t("Apply and Rerun"),command:"github.copilot.tests.fixTestFailure.applyAndRerun",arguments:[t,e,r]}}var kw=class{constructor(e,r,n,o){this._intentService=e;this.instantiationService=r;this.endpointProvider=n;this.accessor=o;this.id="fix";this.locations=[1,2];this.description=BEe.t("Propose a fix for the problems in the selected code");this.commandInfo=void 0}static{this.ID="fix"}get intentDetectionInput(){let e="fix_code_or_markdown";return{functionName:e,sampleQuestion:"There is a problem in this code. Rewrite the code to show it with the bug fixed.",functionCallingBlurb:`If the user's message appears related to fixing problems in the selected code, you should use the '${e}' function.`}}async invoke(e){if(this.shouldDelegateToTestFixer(this.accessor,e))return this._intentService.getIntent(uy.ID,e.location).invoke(e);let{location:r,documentContext:n,request:o}=e;if(!n)throw new Error("Open a file to fix an issue");let s=this.accessor.get(he),a=this.accessor.get(Lt),c=await this.endpointProvider.getEndpointFamilyForLocation(r);if(r===2){let h=await this.endpointProvider.getChatEndpoint(c);return this.instantiationService.createInstance(l0,this,r,h,Ew,e.documentContext)}let l=o.attempt,u=s.getExperimentBasedConfig(le.FixInlineChatEndpoint,a);u||(u=c,l>0&&u==="gpt-3.5-turbo"&&(u="gpt-4"));let d=await this.endpointProvider.getChatEndpoint(u),p;er(n.document.uri)?p=Cw:p=Iw;let f=l>1,m={useWorkspaceChunksFromSelection:f||s.getExperimentBasedConfig(le.FixUseWorkspaceChunksFromSelection,a),useWorkspaceChunksFromDiagnostics:!f&&s.getExperimentBasedConfig(le.FixUseWorkspaceChunksFromDiagnostics,a)};return this.instantiationService.createInstance(Sw,this,r,d,p,n,m)}shouldDelegateToTestFixer(e,r){let n=e.safeGet(_c);return!n?.isEnabled.get()||r.documentContext?.selection.isEmpty===!1?!1:!!(r.location===1&&r.documentContext&&n.getFailureAtPosition(r.documentContext.document.uri,r.documentContext.selection.end)||n.lastResultsFrom&&Date.now()-n.lastResultsFrom<1e4&&!_i.isEmpty(n.getAllFailures()))}};kw=E([y(0,hc),y(1,j),y(2,xe),y(3,Rt)],kw);var jte=q(Ct());var Ux=q(Ue());var OU=class extends Ux.PromptElement{async prepare(){return{}}render(e,r){return vscpp(vscppf,null,vscpp(vscppf,null,vscpp(Ux.SystemMessage,{priority:1e3},"You are an AI that creates a detailed content outline for a Jupyter notebook on a given topic.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"DO NOT include Introduction or Conclusion section in the outline!",vscpp("br",null),"Focus only on sections that will need code!",vscpp("br",null),["","Generate the outline as two parts:","- First part is markdown bullet list of section titles","- Second part is the JSON data that will validate against this JSON schema, wrap the response in code block. We assume that a code block begins with ```[optionally the language] and ends with ```","","The JSON schema is:","{",'  "$schema": "http://json-schema.org/draft-07/schema#",','  "type": "object",','  "properties": {','	"description": {','	  "type": "string"',"	},",'	"sections": {','	  "type": "array",','	  "items": {','		"type": "object",','		"properties": {','		  "title": {','			"type": "string"',"		  },",'		  "content": {','			"type": "string"',"		  }","		},",'		"required": ["title", "content"]',"	  }","	}","  },",'  "required": ["sections"]',"}"].join(`
`),["","Examples:","","Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.","","## Valid notebook creation question","","user: Creating Random Arrays with Numpy","","assistant: Here's an outline for a Jupyter notebook that creates Random Arrays with Numpy:","","* **Import Required Libraries**","* **Create Random Arrays**","* **Seed the Random Number Generator**","* **Generate Random Integers**","","```json","{",'  "description": "A Jupyter notebook that creates Random Arrays with Numpy.",','  "sections": [',"    {",'      "title": "Import Required Libraries",','      "content": "Import the necessary libraries, including NumPy."',"    },","    {",'      "title": "Create Random Arrays",','      "content": "Use NumPy to create random arrays of various shapes and sizes, including 1D, 2D, and 3D arrays."',"    },","    {",'      "title": "Seed the Random Number Generator",','      "content": "Use the seed() function to seed the random number generator for reproducibility."',"    },","	{",'	  "title": "Generate Random Integers",','	  "content": "Use the randint() function to generate random integers within a specified range."',"	}","  ]","}","```"].join(`
`))),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),this.props.promptContext.chatVariables&&Object.keys(this.props.promptContext.chatVariables).length>0?vscpp(Mr,{flexGrow:2,priority:900,chatVariables:this.props.promptContext.chatVariables,query:`Create notebook: ${this.props.promptContext.query}`}):vscpp(Ux.UserMessage,{priority:900},"Create notebook: ",this.props.promptContext.query))}};var MU=q(Ct());var FU=class{constructor(){this.stagedTextToApply="";this.reporting=!0;this._resolvedContentDeferredPromise=new Om;this._incodeblock=!1;this._presentCodeblockProgress=!1}async processResponse(e,r,n,o){let{turn:s}=e;for await(let{delta:a}of r){if(o.isCancellationRequested)return;this.applyDelta(a.text,s,n)}this.pushCommands(s,n)}applyDeltaToTurn(e,r){r.response||(r.response={message:e,type:"model"}),r.response.message+=e}applyDeltaToProgress(e,r){r.markdown(e)}applyDelta(e,r,n){if(!this.reporting){this.applyDeltaToTurn(e,r);return}if(e=this.stagedTextToApply+e,this._incodeblock){let s=e.indexOf("```");if(s===-1){this.stagedTextToApply=e,this.applyDeltaToTurn("",r),this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,n.progress(MU.t("Thinking ...")));return}else{this._incodeblock=!1,e=e.substring(0,s)+"```";try{this.applyDeltaToTurn(e,r)}catch{}finally{this.reporting=!1,this.stagedTextToApply="",this._resolvedContentDeferredPromise.complete(new ai(""))}return}}let o=e.indexOf("```");if(o!==-1){this._incodeblock=!0;let s=e.indexOf("```",o+3);if(s!==-1){this._incodeblock=!1,this.applyDeltaToProgress(e.substring(0,o),n),this.applyDeltaToProgress(e.substring(s+3),n),this.applyDeltaToTurn(e,r),this.reporting=!1,this.stagedTextToApply="";return}else{let a=e.substring(0,o);this.applyDeltaToProgress(a,n),this.applyDeltaToTurn(e,r),this.stagedTextToApply="",this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,n.progress(MU.t("Thinking ..."))),this._resolvedContentDeferredPromise.p.then(c=>n.push(c));return}}this.applyDeltaToProgress(e,n),this.applyDeltaToTurn(e,r),this.stagedTextToApply=""}pushCommands(e,r){let n=(e.response?.message??"").replace(/\n/g,""),s=/```(?:json)?(.+)/g.exec(n);if(s)try{let a=s[1],c=a.indexOf("```"),l=c===-1?a:a.substring(0,c),u=JSON.parse(l);r.button({command:"github.copilot.newNotebook",arguments:[{turn:e,outline:u}],title:MU.t("Create Notebook")})}catch{}return[]}};var Rw=class{constructor(e,r){this.endpointProvider=e;this.instantiationService=r;this.id="newNotebook";this.description=jte.t("Create a new Jupyter Notebook");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,yieldsTo:[{command:"fix"},{command:"explain"},{command:"workspace"},{command:"tests"}],defaultEnablement:!0,sampleRequest:jte.t("How do I create a notebook to load data from a csv file?")}}static{this.ID="newNotebook"}get intentDetectionInput(){let e="create_new_jupyter_notebook";return{functionName:e,modelDescription:"Creates a new Jupyter Notebook for tasks such as data analysis, scientific computing, and machine learning.",sampleQuestion:"How do I create a notebook to load data from a csv file?",functionCallingBlurb:`If the user's message is related to creating a new Jupyter notebook for data analysis, scientific computing, and machine learning, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(AL,this,n,r)}};Rw=E([y(0,xe),y(1,j)],Rw);var AL=class{constructor(e,r,n,o){this.intent=e;this.endpoint=r;this.location=n;this.instantiationService=o;this.linkification={disable:!0}}async buildPrompt(e,r,n){return await Me.create(this.instantiationService,this.endpoint,OU,{promptContext:e,endpoint:this.endpoint}).render(r,n)}processResponse(e,r,n,o){return new FU().processResponse(e,r,n,o)}};AL=E([y(3,j)],AL);var NL=q(Ct()),LL=q(require("path"));var qEe="Review the currently selected code.",hct=NL.t("local changes"),Pw=class extends us{constructor(r,n,o,s,a,c,l,u,d){super(r,n,o);this.documentContext=s;this.instantiationService=a;this.workspaceService=c;this.tabsAndEditorsService=l;this.logService=u;this.gitExtensionService=d;this.linkification={additionaLinkifiers:[{create:()=>new Hte(this.documentContext.document.uri)}]}}async createRenderer({history:r,query:n,chatVariables:o},s,a,c){let l=[];if(n===hct){let u=await on.getCurrentChanges(this.gitExtensionService,"workingTree");(await Promise.all(u.map(async p=>({document:await this.workspaceService.openTextDocument(p.uri),relativeDocumentPath:LL.default.relative(p.repository.rootUri.fsPath,p.uri.fsPath),change:p})))).map(p=>l.push(p))}else{let u=this.tabsAndEditorsService.activeTextEditor;u&&l.push({document:u.document,relativeDocumentPath:LL.default.basename(u.document.uri.fsPath),selection:u.selection})}return Me.create(this.instantiationService,s,RC,{query:n,history:r,chatVariables:o,input:l,logService:this.logService})}async buildPrompt(r,n,o){return r.query===""&&(r={...r,query:qEe}),super.buildPrompt(r,n,o)}};Pw=E([y(4,j),y(5,qe),y(6,Ft),y(7,ie),y(8,ro)],Pw);var Vte=class extends Pw{processResponse(e,r,n,o){return this.instantiationService.createInstance(DL,this.documentContext).processResponse(e,r,n,o)}},Aw=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id="review";this.locations=[2,1];this.description=NL.t("Review the selected code in your active editor");this.intentDetectionInput={sampleQuestion:qEe,disabled:!0}}static{this.ID="review"}async invoke(e){let r=e.documentContext,n=e.location,o=await this.endpointProvider.getChatEndpoint("gpt-4");return n===1?this.instantiationService.createInstance(Vte,this,n,o,r):this.instantiationService.createInstance(Pw,this,n,o,r)}};Aw=E([y(0,j),y(1,xe)],Aw);var Hte=class{constructor(e){this.file=e}async linkify(e,r,n){let o=_Q(e);if(!o.length)return;let s=0,a=0,c=[];for(let l of o)c.push(e.substring(a,l.linkOffset)),c.push(Oye(e.substring(l.linkOffset,l.linkOffset+l.linkLength),this.file.with({fragment:String(l.from+1)}))),s++,a=l.linkOffset+l.linkLength;return c.push(e.substring(a)),{parts:[c.join("")],trustedCommands:[J_],addedLinkCount:s}}},DL=class{constructor(e,r){this.documentContext=e;this.reviewService=r;this.updating=!1;this.text="";this.comments=[]}async processResponse(e,r,n,o){let s={source:"vscodeCopilotChat",promptCount:1,messageId:ir(),inputType:"selection",inputRanges:[{uri:this.documentContext.document.uri,ranges:[this.documentContext.selection]}]};for await(let c of r){if(this.text=c.text,!this.updating){this.updating=!0;let u=new vo(NL.t({message:`Reviewing your code...
`,comment:"{Locked='](command:workbench.panel.markers.view.focus)'}"}));u.isTrusted={enabledCommands:["workbench.panel.markers.view.focus"]},n.markdown(u)}let l=uD(s,[{document:this.documentContext.document,relativeDocumentPath:LL.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!0);l.length>this.comments.length&&(this.reviewService.addReviewComments(l.slice(this.comments.length)),this.comments=l)}let a=uD(s,[{document:this.documentContext.document,relativeDocumentPath:LL.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!1);a.length>this.comments.length&&(this.reviewService.addReviewComments(a.slice(this.comments.length)),this.comments=a),n.markdown(NL.t("Reviewed your code and generated {0} suggestions.",a.length))}};DL=E([y(1,qo)],DL);var Gte=q(Ct());var Dw=q(Ue());var UU=class extends Dw.PromptElement{render(e,r){let{query:n,history:o}=this.props.promptContext;return vscpp(vscppf,null,vscpp(Dw.SystemMessage,{priority:1e3},"You are a VS Code search expert who helps to write search queries for text in a workspace. Users want to search across a whole workspace. Your response will contain parameters to use in the search that targets what the user wants.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"The user's question is ALWAYS related to search or replace. When the user's question does not seem to be related to searching or replacing, you MUST assume that they're searching for or replacing what they are describing.",vscpp("br",null),`For example, if the user says "emojis", try appending "I'm looking for _____" to the beginning (e.g. I'm looking for emojis) to make more sense of it.`,vscpp("br",null),vscpp("br",null),"For all valid questions, you MUST respond with a JSON object with search parameters to use.",vscpp("br",null),'- Your answer MUST wrap the JSON object in "[ARGS START]" and "[ARGS END]". "[ARGS START]" must be on a new line.',vscpp("br",null),'- Your answer MUST have an explanation in full, human-readable sentences. This goes before the "[ARGS START]" line.',vscpp("br",null),vscpp("br",null),'If you put a regex in the "query" parameter, make sure to set "isRegex" to true.',vscpp("br",null),'If you put a regex in the "query" parameter, do not start and/or end with forward slashes to denote a regex literal.',vscpp("br",null),"You MUST NOT give an answer with an empty-string query parameter.",vscpp("br",null),vscpp("br",null),'The "replace" string will be used to replace the query-matched search results.',vscpp("br",null),vscpp("br",null),'If you want to target certain files, set "filesToInclude" to a glob pattern. DO NOT assume the "filesToInclude" and "filesToExclude" without being very sure that the user wants to target these files!',vscpp("br",null),vscpp("br",null),'If the query is case sensitive, set "isCaseSensitive" to true.',vscpp("br",null),vscpp("br",null),"By default, all string fields are the empty string, and all boolean fields are false. Only list the fields you want to change.",vscpp("br",null),vscpp("br",null),"You should write the JSON object of the search parameters in the following format:",vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": ...,',vscpp("br",null),'	"replace": ...,',vscpp("br",null),'	"filesToInclude": ...,',vscpp("br",null),'	"filesToExclude": ...,',vscpp("br",null),'	"isRegex": ...,',vscpp("br",null),'	"isCaseSensitive": ...,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Search for 'foo' in all files under my 'src' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Populate the query field with 'foo' and specify the files to include as 'src/'.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "foo",',vscpp("br",null),'	"filesToInclude": "src" ,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all CamelCase words in all files under the 'src/extensions' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a regex search for camelCase variables by checking for any word that has a lowercase letter followed by an uppercase letter, followed by any number of lowercase letters. You can use `\\b[a-z]+[A-Z][a-z]+\\b` to acheive this.",vscpp("br",null),"This must be case-sensitive since the capitalization of the letters in our regex matters.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "\\\\b[a-z]+[A-Z][a-z]+\\\\b",',vscpp("br",null),'	"filesToInclude": "src/extensions" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all hex color codes in css files",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a search for 6-digit or 3-digit hex color codes using the regex `#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\b`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\\\b",',vscpp("br",null),'	"filesToInclude": "*.css" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all HTTPS links in markdown.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Search all URLs that have the HTTPS protocol in a markdown file. Make sure to include all valid URL characters in their respective places. This regex should achieve this: `https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#()?&//=]*)`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/(www\\\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{2,256}\\\\.[a-z]{2,6}\\\\b([-a-zA-Z0-9@:%_\\\\+.~#()?&//=]*)",',vscpp("br",null),'	"filesToInclude": "*.md" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all YYYY-MM-DD dates with MM/DD/YYYY dates. Don't do this in typescript files.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"You will need to use the regex `(\\d{4})-(\\d{2})-(\\d{2})` to match the YYYY-MM-DD date format. Then, you will need to use the replace string `$2/$3/$1` to replace the date with the MM/DD/YYYY format.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "(\\\\d{4})-(\\\\d{2})-(\\\\d{2})",',vscpp("br",null),'	"replace: "$2/$3/$1",',vscpp("br",null),'	"filesToExclude": "*.ts",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all camel case variable names with snake case variable names.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To replace all camel case variables with snake case, we will need to:",vscpp("br",null),"1. Find all sequences of lowercase letters succeeded by uppercase letters. Use `([a-z]+)([A-Z])` to capture these sequences.",vscpp("br",null),"2. Separate them with an underscore character. `$1_$2` does this.",vscpp("br",null),"3. Convert both characters to lowercase. Adjust the previous replace text to be `\\l$1_\\l$2`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "([a-z]+)([A-Z])",',vscpp("br",null),'	"replace: "\\\\l$1_\\\\l$2",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"alphanumeric",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all alphanumeric characters, you can use the regex `[a-zA-Z0-9]`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "[a-zA-Z0-9]",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"link",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all web links, use the regex `https?:\\/\\/\\S+`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/\\\\S+",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),'Search for actionbar files outside of my "extensions" directoy',vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To do this, use the query `actionbar` in all files except the ones in `extensions`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "actionbar",',vscpp("br",null),'	"filesToExclude": "extensions",',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"typescript for loop",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),'To look for "for" loops in most languages, use the query `for\\s*\\(`.',vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "for\\s*\\(",',vscpp("br",null),'	"isRegex: true,',vscpp("br",null),'	"filesToInclude: "*.ts"',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null)),vscpp(It,{priority:600,history:o}),vscpp(qi,{priority:700}),vscpp(bn,{priority:800,document:this.props.document,range:this.props.selection}),vscpp(Dw.UserMessage,{priority:900},n))}};function gct(t){if(!t)return[];let e=[],r={query:t.query??"",replace:t.replace??"",filesToInclude:t.filesToInclude??"",filesToExclude:t.filesToExclude??"",isRegex:t.isRegex??!1,isCaseSensitive:t.isRegex??!1};return e.push({command:"github.copilot.executeSearch",arguments:[r],title:Gte.t("Search")}),e}function jEe(t){let e=Ls(t).at(0),r;if(e){let n;try{n=Jp(e.code)}catch{}n&&(r=n)}return r}function vct(t){if(!t)return[];let e=[`| Parameter  | Value |
`,`| ------ | ----- |
`];for(let[r,n]of Object.entries(t)){if(n==="")continue;let o=n;(typeof n=="string"||n instanceof String)&&(o=n.replace(/\|/g,"\\|")),e.push(`| ${r} | \`${o}\` |
`)}return e.push(`
`),e}var yct="Search for 'foo' in all files under my 'src' directory",OL=class extends us{constructor(r,n,o,s){super(r,n,o);this.instantiationService=s}createRenderer(r,n,o,s){return Me.create(this.instantiationService,n,UU,{promptContext:r})}processResponse(r,n,o,s){return this.instantiationService.createInstance(ML).processResponse(r,n,o,s)}};OL=E([y(3,j)],OL);var ML=class extends f0{constructor(r,n){super([{start:"[ARGS END]",stop:"[ARGS START]"}],o=>vct(jEe(o.join(""))),r,n);this._response=""}async doProcessResponse(r,n,o){await super.doProcessResponse(r,n,o);let s=jEe(this._response??"");for(let a of gct(s))n.button(a)}applyDelta(r,n){this._response+=r.text,super.applyDelta(r,n)}};ML=E([y(0,Lt),y(1,he)],ML);var Nw=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id="search";this.locations=[2];this.description=Gte.t("Generate query parameters for workspace search");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:Ra}}static{this.ID="search"}get intentDetectionInput(){let e="vscode_search";return{disabled:!0,functionName:e,sampleQuestion:yct,functionCallingBlurb:`If the user's message is related to generating search query parameters for running a file search, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(OL,this,r,n)}};Nw=E([y(0,j),y(1,xe)],Nw);var UL=q(Ct());function bct(t,e){let r=0;for(let n of t)if(r+=n.trim().length,r>=e)return!0;return!1}function _ct(t,e,r){let n=[],o=0;for(;o<t.length&&n.join(`
`).length<e&&n.length<r;)n.push(t[o]),o++;return n}function xct(t){return t.map(e=>{let r=Dr(e.locations.map(n=>{if(!bct(n.code,5))return;let o=_ct(n.code,1e3,15),{trimmedLines:s}=P2(o);s.length<n.code.length&&s.push("...");let a=Si(tl(e.file).replace(/\./g,""),s.join(`
`).replace(/^\n*|\n*$/g,""),!1);return{range:n.range,codePreview:a}}));return{file:e.file,locations:r}})}var FL=class extends us{constructor(r,n,o,s,a){super(r,n,o);this.accessor=s;this.instantiationService=a}async createRenderer({query:r,history:n},o,s,a){return Me.create(this.instantiationService,o,pw,{query:r})}processResponse(r,n,o,s){return new zte(this.accessor,this.endpoint).processResponse(r,n,o,s)}};FL=E([y(3,Rt),y(4,j)],FL);var py=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=py.ID;this.locations=[2];this.description=UL.t("Find relevant code to your query");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!1};this.intentDetectionInput={sampleQuestion:"Where is the toolbar code?",disabled:!0}}static{this.ID="semanticSearch"}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(FL,this,r,n)}};py=E([y(0,j),y(1,xe)],py);var zte=class{constructor(e,r){this.accessor=e;this.endpoint=r}async processResponse(e,r,n,o){let{messages:s}=e,a=s[s.length-1].content,c=0,l="";for await(let{delta:d}of r){if(o.isCancellationRequested)return;c+=d.text.length,l+=d.text}n.progress(UL.t("Looking for relevant code"));let u=Rte(l);return Sct(this.accessor,this.endpoint,a,u,o).then(d=>Ict(this.accessor,d,n))}};async function Sct(t,e,r,n,o){let s=t.get(Kv),a=await Z2(t,{valueFor4096:8,maxMultiplier:4});return Pte(s,e,r,n,a,o,void 0).then(c=>xct(c))}function Ict(t,e,r){if(e.length===0){let o=UL.t(`No relevant code found. Please be more specific.
`);r.markdown(o);return}r.markdown(UL.t(`Here is some relevant code:

`));let n=t.get(qe);for(let o of e)Cct(o,r,n)}function Cct(t,e,r){let o=`## ${vI(r,t.file)}

`;e.markdown(o),t.locations.forEach(s=>{let a={uri:t.file,range:cC(s.range)},c=s.range.startLineNumber,l=s.range.endLineNumber,u=c+1===l?`Line ${c+1}`:`Lines ${c+1}-${l}`;e.markdown("- "),e.anchor(a,u),e.markdown(`

`),e.markdown(s.codePreview+`
`)})}var Xte=q(Ct());var qU=q(Ct()),wh=q(Ue());var BU={perFramework:new Map([["mocha",{name:"Mocha Test Explorer",id:"hbenl.vscode-mocha-test-adapter"}],["jest",{name:"Jest",id:"Orta.vscode-jest"}],["vitest",{name:"Vitest",id:"vitest.explorer"}],["playwright",{name:"Playwright Test for VSCode",id:"ms-playwright.playwright"}],["jasmine",{name:"Jasmine Test Explorer",id:"hbenl.vscode-jasmine-test-adapter"}]])},Lw=new Map([["python",{forLanguage:{extension:{id:"ms-python.python",name:"Python"},associatedFrameworks:["pytest","unittest"]}}],["rust",{forLanguage:{extension:{id:"rust-lang.rust-analyzer",name:"rust-analyzer"}}}],["java",{forLanguage:{extension:{id:"vscjava.vscode-java-test",name:"Test Runner for Java"},associatedFrameworks:["junit","testng"]}}],["csharp",{forLanguage:{extension:{id:"ms-dotnettools.csharp",name:"C#"}}}],["go",{forLanguage:{extension:{id:"golang.Go",name:"Go"}}}],["typescript",BU],["javascript",BU],["javascriptreact",BU],["typescriptreact",BU]]);var Ow=class{constructor(e,r){this.grammar=r;this.accumulator="";this.currentEntries=[];this.tokens=[];this.state=e,this.currentEntries=Object.entries(r[e]||{})}visited(e){return this.tokens.some(r=>r.state===e)}accumulate(e=0,r=this.tokens.length,n){let o="";for(let s=e;s<r&&s<this.tokens.length;s++){let a=this.tokens[s];n!==void 0?a.state===n&&!a.transitionTo&&(o+=a.token):o+=a.token}return o}append(e){let r=0,n,o=this.tokens.length;this.accumulator+=e;for(let[s,a]of this.currentEntries){let c=this.accumulator.indexOf(s);c!==-1&&(!n||c<n.index)&&(n={index:c,toState:a,length:s.length}),r=Math.max(r,s.length)}if(n){n.index>0&&this.tokens.push({state:this.state,token:this.accumulator.slice(0,n.index)}),this.tokens.push({state:this.state,token:this.accumulator.slice(n.index,n.index+n.length),transitionTo:n.toState});let s=this.accumulator.slice(n.index+n.length);this.state=n.toState,this.currentEntries=Object.entries(this.grammar[n.toState]||{}),this.accumulator="",this.append(s)}else this.accumulator.length>r&&(this.tokens.push({state:this.state,token:this.accumulator.slice(0,this.accumulator.length-r)}),this.accumulator=this.accumulator.slice(this.accumulator.length-r));return _i.slice(this.tokens,o)}flush(){return this.accumulator?(this.tokens.push({state:this.state,token:this.accumulator}),_i.slice(this.tokens,-1)):_i.empty()}};var Bx=class{constructor(e,r,n,o){this.endpoint=e;this.documentContext=r;this.instantiationService=n;this.commandService=o}async buildPrompt(e,r,n){return Me.create(this.instantiationService,this.endpoint,$te,{endpoint:this.endpoint,promptContext:e,document:this.documentContext?.document,selection:this.documentContext?.selection}).render(r,n)}async processResponse(e,r,n,o){let s;(p=>(p[p.Reasoning=0]="Reasoning",p[p.Frameworks=1]="Frameworks"))(s||={});let a=u=>{for(let d of u)d.state===0&&d.transitionTo===void 0&&n.markdown(d.token)},c=new Ow(0,{0:{[Fw]:1}});for await(let{delta:u}of r){if(o.isCancellationRequested)return;a(c.append(u.text))}a(c.flush());let l=c.accumulate(void 0,void 0,1).split(`
`).map(u=>u.replace(Fw,"").trim()).filter(u=>!!u);l.length?n.confirmation(qU.t("Pick a testing framework"),qU.t("Pick from these options, or use chat to tell me what you'd prefer:"),void 0,l):n.markdown(qU.t("Use chat to tell me which framework you'd prefer.")),await this.commandService.executeCommand("workbench.action.chat.open",{query:"@workspace /setupTests ",isPartialQuery:!0})}};Bx=E([y(2,j),y(3,dl)],Bx);var Mw=class extends Bx{constructor(r,n,o,s,a,c){super(n,s,a,c);this.intent=r;this.location=o}};Mw=E([y(4,j),y(5,dl)],Mw);var Fw="FRAMEWORK: ",$te=class extends wh.PromptElement{render(e,r){let{query:n,chatVariables:o}=this.props.promptContext;return vscpp(vscppf,null,vscpp(wh.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge around software testing frameworks.",vscpp("br",null),vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),"# Additional Rules",vscpp("br",null),"1. Examine the workspace structure the user is giving you.",vscpp("br",null),"2. Determine the best testing frameworks that should be used for the project.",vscpp("br",null),"3. Give a brief explanation why a user would choose one framework over the other, but be concise and never give the user steps to set up the framework.",vscpp("br",null),"4. If you're unsure which specific framework is best, you can suggest multiple frameworks.",vscpp("br",null),"5. Suggest only frameworks that are used to run tests. Do not suggest things like assertion libraries or build tools.",vscpp("br",null),'6. After determining the best framework to use, write out the name of 1 to 3 suggested frameworks prefixed by the phrase "',Fw,'", for example: "',Fw,'vitest".',vscpp("br",null),vscpp("br",null),"DO NOT mention that you cannot read files in the workspace.",vscpp("br",null),"DO NOT ask the user to provide additional information about files in the workspace.",vscpp("br",null),vscpp("br",null),"# Example",vscpp("br",null),"## Question:",vscpp("br",null),"I am working in a workspace that has the following structure:",vscpp("br",null),"```\nsrc/\n  index.ts\npackage.json\ntsconfig.json\nvite.config.ts\n```",vscpp("br",null),"## Response:",vscpp("br",null),"Because you have a `vite.config.ts` file, it looks like you're working on a browser or Node.js application. If you're working on a browser application, I recommend using Playwright. Otherwise, Vitest is a good choice for Node.js.",vscpp("br",null),Fw,"playwright",vscpp("br",null),Fw,"vitest",vscpp("br",null)),this.props.document&&vscpp(Kte,{document:this.props.document}),vscpp(wh.UserMessage,{flexGrow:2},vscpp(Wte,null)),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:o,query:n}))}},Wte=class extends wh.PromptElement{render(e,r){return vscpp(vs,{maxSize:r.tokenBudget*4/3})}},Kte=class extends wh.PromptElement{render(){let e=Lw.get(this.props.document.languageId);if(e?.perFramework)return vscpp(wh.SystemMessage,{priority:600},"These are the preferred test frameworks for ",this.props.document.languageId,":",vscpp("br",null),vscpp("br",null),[...e.perFramework.keys()].map(r=>`- ${r}`).join(`
`),vscpp("br",null))}};var Uw=q(Ct()),qx=q(Ue());var Bw=class{constructor(e,r,n,o,s,a,c,l,u,d){this.intent=e;this.endpoint=r;this.location=n;this.prompt=o;this.instantiationService=s;this.workspaceService=a;this.workspaceMutationManager=c;this.extensionsService=l;this.commandService=u;this.chatMLFetcher=d;this.recommendedExtension=new qn(()=>{let e=this.prompt.toLowerCase();return Pm(Lw.values(),r=>r.forLanguage?.associatedFrameworks?.some(n=>e.includes(n))?r.forLanguage.extension:r.perFramework&&Pm(r.perFramework,([n,o])=>e.includes(n)?o:void 0))})}async buildPrompt(e,r,n){return this.buildPromptContext=e,this.delegatedSetup=await this.delegateHandling(),this.delegatedSetup?{hasIgnoredFiles:!1,messages:[],omittedReferences:[],references:[],tokenCount:0}:(this.setupConfirmation=await this.getSetupConfirmation(),Me.create(this.instantiationService,this.endpoint,Yte,{endpoint:this.endpoint,promptContext:e,query:this.prompt,setupConfirmation:this.setupConfirmation}).render(r,n))}async processResponse(e,r,n,o){let s;(m=>(m[m.LookingForTree=0]="LookingForTree",m[m.FileTree=1]="FileTree",m[m.FoundTree=2]="FoundTree"))(s||={});let a=e.turn.requestId||ir(),c=d=>{for(let p of d)if(p.transitionTo===1)n.markdown(l.accumulate(0,l.tokens.length-1));else if(p.transitionTo===2){let f=l.accumulate(void 0,void 0,1);this.handleFileTree(a,f,n)}else p.transitionTo===void 0&&p.state!==1&&l.visited(1)&&n.markdown(p.token)},l=new Ow(0,{0:{"```filetree":1},1:{"```":2}});for await(let{delta:d}of r)c(l.append(d.text));c(l.flush()),this.delegatedSetup&&n.markdown(this.delegatedSetup.message);let u=this.setupConfirmation?.command||this.delegatedSetup?.command;u?n.button(u):l.visited(1)?this.recommendExtension(n):await this.doFrameworkQuery(e,n,o)}async doFrameworkQuery(e,r,n){let o=this.instantiationService.createInstance(Bx,this.endpoint,void 0),s=await o.buildPrompt(this.buildPromptContext,void 0,n),a=new Mp,c=o.processResponse(e,a.stream,r,n);await this.chatMLFetcher.fetchOne("testSetupAutomaticFrameworkID",s.messages,(l,u,d)=>(a.update(l,d),Promise.resolve(void 0)),n,this.location,this.endpoint),a.resolve(),await c}async getSetupConfirmation(){let e=this.recommendedExtension.value,n=(e?this.extensionsService.getExtension(e.id):void 0)?.packageJSON?.copilot?.tests?.getSetupConfirmation;if(!n)return;let o;try{o=await this.commandService.executeCommand(n)}catch{}return o}async delegateHandling(){let e=this.recommendedExtension.value,n=(e?this.extensionsService.getExtension(e.id):void 0)?.packageJSON?.copilot?.tests?.setupTests;return n?await this.commandService.executeCommand(n):void 0}recommendExtension(e){let r=this.recommendedExtension.value;r&&this.extensionsService.getExtension(r.id)||(e.markdown(`

`),r?(e.markdown(Uw.t("I also recommend installing the {0} extension to make tests easy to run in VS Code:",r.name)),e.button({command:"workbench.extensions.action.showExtensionsWithIds",title:Uw.t("Get Extension"),arguments:[[r.id]]})):(e.markdown(Uw.t("You can also search for an extension to make tests easy to run in VS Code:")),e.button({command:"workbench.extensions.search",title:Uw.t("Search Extensions"),arguments:[`@category:testing ${this.prompt}`]})))}handleFileTree(e,r,n){let o=this.workspaceService.getWorkspaceFolders().at(0);if(!o)return;let{chatResponseTree:s}=s8(r,()=>Ect(e)),a=s.value[0];s.value.length===1&&/^\[.+\]$/.test(a.name)&&a.children&&(s.value=a.children),this.workspaceMutationManager.create(e,{baseURI:o,files:Jye(s.value),fileTree:r,query:this.prompt}),n.push(s),n.button({command:"github.copilot.tests.applyMutations",title:Uw.t("Apply Changes"),arguments:[e]})}};Bw=E([y(4,j),y(5,qe),y(6,rw),y(7,wc),y(8,dl),y(9,yt)],Bw);var Tct="[project-name]";function Ect(t,e){return He.from({scheme:sU,authority:t,path:e?`/${e}`:"/"})}var Yte=class extends qx.PromptElement{render(e,r){let{query:n,setupConfirmation:o}=this.props;return vscpp(vscppf,null,vscpp(qx.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge around software testing frameworks.",vscpp("br",null),vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),"# Additional Rules",vscpp("br",null),"1. The user will tell you what testing framework they want to set up, and provide you their workspace structure.",vscpp("br",null),"2. Determine how to test up the desired testing framework.",vscpp("br",null),"3. Generate a markdown file tree structure listing files you want to create or edit in order to set up the testing framework. The tree MUST NOT include files that don't need to be modified.",vscpp("br",null),'4. Make sure to include a basic "hello world" test to help the user get started. If you see existing test files in the workspace, make sure to try to match their naming convention.',vscpp("br",null),"5. Do not attempt to modify the file content yourself and simply respond with the file tree structure.",vscpp("br",null),'6. After listing the file tree structure, respond with any terminal commands the user should execute to finish installing the testing framework. Terminal commands should be wrapped in a code fence tagged with the "sh" language.',vscpp("br",null),"7. Finally, provide a command line a user can execute to run their tests.",vscpp("br",null),o&&vscpp(vscppf,null,"8. At the end, include a phrase that conveys '",o.message,"', but rephrase this to indicate that this is the last step the user needs to take to enable rich UI integration in VS Code.",o.command&&` This message will be followed by a button that says "${o.command.title}".`,vscpp("br",null)),vscpp("br",null),"# Example",vscpp("br",null),"## Question:",vscpp("br",null),"I want to: set up mocha tests in the workspace",vscpp("br",null),"I am working in a workspace that has the following structure:",vscpp("br",null),"```\nsrc/\n  index.ts\npackage.json\ntsconfig.json\n```",vscpp("br",null),"## Response:",vscpp("br",null),'Let\'s create a `.mocharc.js` file to configure your test settings, as well as a "hello world" test:',vscpp("br",null),vscpp("br",null),`\`\`\`filetree
${Tct}
\u251C\u2500\u2500 src
\u2502   \u2514\u2500\u2500 index.test.ts
\u2514\u2500\u2500 mocha.opts
\`\`\``,vscpp("br",null),"Then, we'll need to install Mocha in your workspace:",vscpp("br",null),"```sh",vscpp("br",null),"npm install --save-dev mocha ```",vscpp("br",null),vscpp("br",null),"Finally, you can run your tests with the following command:",vscpp("br",null),"```sh",vscpp("br",null),"npx mocha",vscpp("br",null),"```",vscpp("br",null)),vscpp(qx.UserMessage,{flexGrow:2},vscpp(Qte,null)),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:this.props.promptContext.chatVariables,query:`I want to: ${n}`}))}},Qte=class extends qx.PromptElement{render(e,r){return vscpp(vs,{maxSize:r.tokenBudget*4/3})}};var fy=class{constructor(e,r){this.endpointProvider=e;this.instantiationService=r;this.id=fy.ID;this.locations=[2];this.description=Xte.t("Set up Tests");this.isListedCapability=!1;this.intentDetectionInput={sampleQuestion:Xte.t("set up vitest in my project")};this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:Ra}}static{this.ID="setupTests"}async invoke(e){let r=await this.endpointProvider.getChatEndpoint("gpt-4"),n=e.request.prompt;return e.request.acceptedConfirmationData&&(n=`set up tests in my workspace using \`${n.split(":")[0]}\``),n?Promise.resolve(this.instantiationService.createInstance(Bw,this,r,e.location,n)):this.instantiationService.createInstance(Mw,this,r,e.location,e.documentContext)}};fy=E([y(0,xe),y(1,j)],fy);var qw=q(Ct());var wct="Attach to node app at port 5870 with outFiles",my=class{constructor(e,r,n){this.endpointProvider=e;this.instantiationService=r;this.extensionsService=n;this.id=my.ID;this.locations=[2];this.description=qw.t("Start Debugging");this.isListedCapability=!1;this.intentDetectionInput={sampleQuestion:wct};this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:Ra}}static{this.ID="startDebugging"}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint("gpt-4");return{intent:this,location:r,endpoint:n,processResponse:async(o,s,a,c)=>{let l="";a.progress(qw.t("Solving for launch configuration..."));for await(let{delta:m}of s){if(c.isCancellationRequested)return;l+=m.text}let u=Y7(l,this.extensionsService);if(!u){a.markdown(l);return}let d=l.match("HAS_CONFIG_NO_QUERY"),p=l.match("HAS_MATCH"),f=l.match("GENERATED_CONFIG");l=l.replaceAll(/"type": "python",/g,'"type": "debugpy",'),l=l.replace(/HAS_CONFIG_NO_QUERY/g,""),l=l.replace(/HAS_MATCH/g,""),l=l.replace(/GENERATED_CONFIG/g,""),a.markdown(l),d?(a.markdown(`
`+qw.t("Generate a new launch configuration by providing more specifics in your query.")+`
`),a.button({title:OA("selectAndStartDebugging","Select and Start Debugging"),command:"workbench.action.debug.selectandstart"})):p?(a.markdown(`
`+qw.t("Generate a new launch configuration by providing more specifics in your query.")+`
`),a.button({title:OA("startDebugging","Start Debugging Existing"),command:"github.copilot.startDebugging",arguments:[u,a]})):f&&(a.button({title:OA("startDebugging","Start Debugging"),command:"github.copilot.startDebugging",arguments:[u,a]}),a.button({title:OA("saveConfig","Save Configuration"),command:"github.copilot.createLaunchJsonFileWithContents",arguments:[u]})),a.markdown(`
`+qw.t("Debugging can be started in the [Debug View]({0}) or by using the [Start Debugging Command]({1}).","command:workbench.view.debug","command:workbench.action.debug.run"))},buildPrompt:async(o,s,a)=>await Me.create(this.instantiationService,n,ny,{input:{type:0,userQuery:o.query},history:o.history}).render(s,a)}}};my=E([y(0,xe),y(1,j),y(2,wc)],my);var jx=q(Ct());var kh=q(Ue());var jU=class extends kh.PromptElement{render(e){let{query:r,history:n,chatVariables:o}=this.props.promptContext;return vscpp(vscppf,null,vscpp(kh.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer craft a command to run on the command line.",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(Jn,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",`
1. Read the provided relevant workspace information (file names, project files in the project root) to understand the user's workspace.`,`
2. Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
    - Prefer single line commands.
    - Omit an explanation unless the suggestion is complex, if an explanation is included then be concise.
    - Provide the command suggestions using the active shell and operating system.
    - When there is text that needs to be replaced in the suggestion, prefix the text with '{', suffix the text with '}' and use underscores instead of whitespace. Only do this when the replacement text is NOT provided.
    - Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,Jte(this.props.shellType)?"\n    - Prefer idiomatic PowerShell over aliases for other shells or system utilities. For example use `Stop-Process` or `Get-NetTCPConnection` instead of `kill` or `lsof` respectively.\n	- Only use unix utilities when there is no PowerShell equivalent.\n    - Prefer cross-platform PowerShell scripting that works on any operating system.":`
    - Only use a tool like python or perl when it is not possible with the shell.`,`
3. At the end of the response, list all text that needs to be replaced with associated descriptions in the form of a markdown list
`.trim(),vscpp("br",null)),vscpp(kh.SystemMessage,{priority:700},"Examples:",vscpp("br",null),kct(this.props.shellType)),vscpp(It,{flexGrow:1,priority:600,history:n}),vscpp(kh.UserMessage,{flexGrow:1,priority:750},vscpp(cr,{languageId:Jte(this.props.shellType)?"ps1":"bash"})),vscpp(kh.UserMessage,{flexGrow:1,priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(kh.UserMessage,{flexGrow:1,priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(Kt,{priority:899,...this.props,flexGrow:2}),vscpp(Mr,{flexGrow:2,priority:900,chatVariables:o,query:r}))}};function kct(t){let e=['User: How do I revert a specific commit?\nAssistant:\n```sh\ngit revert {commit_id}\n```\n\nUser: How do I commit in git?\nAssistant:\n```sh\ngit commit -m "{message}"\n```'];switch(Jte(t)||e.push("User: go to the foo dir\nAssistant:\n```sh\ncd foo\n```"),t){case"ps1":case"pwsh":case"powershell":{e.push("User: go to the foo dir\nAssistant:\n```pwsh\ncd .\\foo\\\n```\n\nUser: How do I delete a directory?\nAssistant:\n```pwsh\nRemove-Item {dir_name}\n```\n\nUser: create a file called foo\nAssistant:\n```pwsh\nNew-Item -ItemType File -Name foo\n```");break}case"bash":{e.push("User: Print all files starting with \"pre\"\n```bash\nfind . -type f -name 'pre*'\n```");break}default:{e.push("\nUser: How do I print all files recursively within a directory?\nAssistant:\n```sh\nls -lR\n```");break}}return e.join(`

`)}function Jte(t){return t==="ps1"||t==="pwsh"||t==="powershell"}var hy=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.locations=[2];this.id=hy.ID;this.description=jx.t("Ask how to do something in the terminal");this.commandInfo={allowsEmptyArgs:!1}}static{this.ID="terminal"}get intentDetectionInput(){let e="terminal_questions";return{functionName:e,sampleQuestion:"How do I list files in the terminal",functionCallingBlurb:`If the user's message is about how to do something in the terminal, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(BL,this,n,r)}};hy=E([y(0,j),y(1,xe)],hy);var BL=class{constructor(e,r,n,o,s,a){this.intent=e;this.endpoint=r;this.location=n;this.instantiationService=o;this.envService=s;this.terminalService=a}async buildPrompt(e,r,n){let o=this.envService.OS,s=this.terminalService.terminalShellType;return await Me.create(this.instantiationService,this.endpoint,jU,{promptContext:e,osName:o,shellType:s,endpoint:this.endpoint}).render(r,n)}async generateFollowUps(e){let r=jx.t("Explain the suggested command"),n=!1,o=e.response?.message;if(o){let a=Ls(o);if(a.length===0)return[];a.length===1?r=jx.t("Explain this command:")+`

${s(a[0])}`:(n=!0,r=jx.t("Explain these commands:")+`${a.map(c=>`

${s(c)}`).join("")}`)}return[{prompt:r,label:n?jx.t("Explain the suggested commands"):jx.t("Explain the suggested command")}];function s(a){return`${a.startMarkup}${a.language}
${a.code.trim()}
${a.startMarkup}`}}};BL=E([y(3,j),y(4,gt),y(5,ui)],BL);var KEe=q(Ct());var _f=q(Ct());var VEe=require("util");var Vw=ne("ITestDepsResolver"),jw=class{constructor(e,r){this._searchService=e;this._fileSystemService=r;this._perLanguageTestDepsFinder=new Map;this._cachedResults=new Map,this._textDecoder=new VEe.TextDecoder}async getTestDeps(e){let r=this._cachedResults.get(e);if(r!==void 0)return r;let n=this.getTestDepsFinder(e);if(n===void 0)return[];let o=await n.findTestDeps();return this._cachedResults.set(e,o),o}getTestDepsFinder(e){let r=this._perLanguageTestDepsFinder.get(e);if(r===void 0)switch(e){case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":{r=new Zte(this._searchService,this._fileSystemService,this._textDecoder);break}case"python":{r=new ere(this._searchService,this._fileSystemService,this._textDecoder);break}case"java":{r=new tre(this._searchService,this._fileSystemService,this._textDecoder);break}}return r!==void 0&&this._perLanguageTestDepsFinder.set(e,r),r}};jw=E([y(0,Hp),y(1,mr)],jw);var Zte=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._jsTsTestDeps=new Set(["mocha","jest","vitest","chai","ava","jasmine","qunit","tape","cypress","puppeteer","enzyme","testing-library","sinon","supertest","happy-dom","playwright"])}async findTestDeps(){let e=await this._searchService.findFiles("**/package.json",{exclude:"**/node_modules/**",useDefaultExcludes:!0});return(await Promise.allSettled(e.map(async n=>{let o=await this._fileSystemService.readFile(n),s=JSON.parse(this._textDecoder.decode(o)),a=s.dependencies||{},c=s.devDependencies||{};return[a,c].flatMap(u=>Object.keys(u).filter(d=>this._jsTsTestDeps.has(d)))}))).flatMap(n=>n.status==="fulfilled"?n.value:[])}},ere=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._pyTestDeps=["pytest","nose","unittest","tox","doctest","hypothesis","mock","coverage","behave","robotframework"]}async findTestDeps(){let e=new Set,r=["pyproject.toml","setup.py","requirements.txt","tox.ini"],n=await this._searchService.findFiles(`**/{${r.join(",")}}`);return await Promise.all(n.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);o.path.endsWith("pyproject.toml")?this._getPyProjectTomlDeps(a).forEach(l=>e.add(l)):o.path.endsWith("setup.py")?this._getSetupPyDeps(a).forEach(l=>e.add(l)):o.path.endsWith("requirements.txt")?this._getRequirementsTxtDeps(a).forEach(l=>e.add(l)):o.path.endsWith("tox.ini")&&e.add("tox")})),Array.from(e)}_getPyProjectTomlDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}_getSetupPyDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}_getRequirementsTxtDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}},tre=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._javaTestDeps=["junit","testng","mockito","assertj","hamcrest","powermock","spock","cucumber","arquillian","selenium","rest-assured","wiremock","pitest"]}async findTestDeps(){let e=new Set,r=["pom.xml","build.gradle","build.gradle.kts"],n=await this._searchService.findFiles(`**/{${r.join(",")}}`);return await Promise.all(n.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);this._javaTestDeps.filter(c=>a.includes(c)).forEach(c=>e.add(c))})),Array.from(e)}};var VU=ne("ISetupTestsDetector");var HEe="testing.setup.skipForWorkspace";var zEe=t=>t&&t.$isSetupSuggestion&&t.command==="workbench.action.chat.open",Hw=class{constructor(e,r,n,o,s,a){this._configurationService=e;this._testDepsResolver=r;this._testService=n;this._extensionContext=o;this._extensionsService=s;this._commandService=a}showSuggestion(e){this.setDidAlreadyPrompt();let r=[],n=o=>`@category:testing ${o}`;switch(e.type){case 1:case 0:r.push(new C_(_f.t("We recommend installing an extension to run {0} tests.",e.type===1?e.framework:e.language),_f.t("Install {0} (`{1}`)?",e.extension.name,e.extension.id),{$isSetupSuggestion:!0,command:"workbench.extensions.installExtension",arguments:[e.extension.id,{enable:!0}]}));break;case 2:r.push(new C_(_f.t("We recommend installing an extension to run {0} tests.",e.framework),_f.t("Would you like to search for one now?"),{$isSetupSuggestion:!0,command:"workbench.extensions.search",arguments:[n(e.framework)]}));break;case 3:r.push(new C_(_f.t("It looks like you may not have tests set up in this repository yet."),_f.t("Would you like to set them up?"),{$isSetupSuggestion:!0,command:"workbench.action.chat.open",arguments:[{query:"@workspace /setupTests"}]}));break;case 6:e.command?r.push(new C_(e.command.title,e.message,{$isSetupSuggestion:!0,command:e.command.command,arguments:e.command.arguments})):r.push(new ai(e.message));break;case 4:{let o=e.action;switch(o.type){case 1:case 0:{let s=new vo(_f.t("We recommend [installing the {0} extension]({1}) to run {2} tests.",o.extension.name,GEe("workbench.extensions.action.showExtensionsWithIds",[[o.extension.id]]),o.type===1?o.framework:o.language));s.isTrusted={enabledCommands:["workbench.extensions.action.showExtensionsWithIds"]},r.push(new ai(s));break}case 2:{let s=new vo(_f.t("We recommend [installing an extension]({0}) to run {1} tests.",GEe("workbench.extensions.search",[n(o.framework)]),o.framework));s.isTrusted={enabledCommands:["workbench.extensions.search"]},r.push(new ai(s));break}}break}case 5:break;default:KM(e)}return r}async shouldSuggestSetup({document:e},r,n){if(r.rejectedConfirmationData?.some(a=>a.$isSetupSuggestion))return;let o=r.acceptedConfirmationData?.find(a=>a.$isSetupSuggestion);if(o){let a=this._commandService.executeCommand(o.command,...o.arguments);if(o.command==="workbench.extensions.installExtension"){n.progress(_f.t("Installing extension {0}...",o.arguments[0])),await this.waitForExtensionInstall(a,e,o.arguments[0]);return}return{type:5}}if(!this._configurationService.getConfig(le.SetupTests)||await this._testService.hasAnyTests())return;let s=await this.getSuggestActionInner(e);return s&&this.getDidAlreadyPrompt()?{type:4,action:s}:s}async waitForExtensionInstall(e,r,n){await e;let o;do o=this._extensionsService.getExtension(n),await Fl(100);while(!o);let s=o.packageJSON?.copilot?.tests,a=s?.setupTests||s?.getSetupConfirmation;return a?await this.getDelegatedAction(a,r):void 0}getDidAlreadyPrompt(){return this._extensionContext.extensionMode===nl.Development?!!this._didAlreadyPrompt:this._extensionContext.workspaceState.get(HEe,!1)}setDidAlreadyPrompt(){this._extensionContext.extensionMode===nl.Development?this._didAlreadyPrompt=!0:this._extensionContext.workspaceState.update(HEe,!0)}async getDelegatedAction(e,r){try{let n=await this._commandService.executeCommand(e,r.uri);if(n)return{type:6,command:n.command,message:n.message}}catch{}}async getExtensionRecommendationAndDelegate(e,r,n){let o=this._extensionsService.getExtension(e.id);if(!o)return n;let s=o.packageJSON?.copilot?.tests?.getSetupConfirmation;return s?await this.getDelegatedAction(s,r):void 0}async getSuggestActionInner(e){let r=Lw.get(e.languageId),n=r?.forLanguage?.extension;if(n)return this.getExtensionRecommendationAndDelegate(n,e,{type:0,language:e.languageId,extension:n});if(!r?.perFramework)return{type:3,context:e};let o=await this._testDepsResolver.getTestDeps(e.languageId),s=Pm(o,a=>{let c=r.perFramework.get(a);return c&&{extension:c,framework:a}});return s?this.getExtensionRecommendationAndDelegate(s.extension,e,{type:1,...s}):o.length?{type:2,framework:o[0]}:{type:3,context:e}}};Hw=E([y(0,he),y(1,Vw),y(2,_c),y(3,Bt),y(4,wc),y(5,dl)],Hw);function GEe(t,e){return`command:${t}?${encodeURIComponent(JSON.stringify(e))}`}var Hx=q(Ue()),$Ee=q(require("assert")),Rh=q(require("path"));var Vx=q(Ue()),HU=q(require("path"));var Gw=class extends Vx.PromptElement{constructor(r,n,o){super(r);this.parserService=n;this.workspaceService=o}async render(r,n,o,s){let{kind:a,testExampleFile:c}=this.props,l;try{l=await this.workspaceService.openTextDocument(c)}catch{return}let u=await U_(this.parserService,l,void 0,new Be(0,0,0,0),n.tokenBudget),d=[new Vx.PromptReference(c)],p=this.workspaceService.getWorkspaceFolders().find(m=>c.path.startsWith(m.path)),f=c.path;switch(p!==void 0&&(f=HU.relative(p.path,c.path),f=f.split(HU.sep).join("/")),a){case"candidateTestFile":return vscpp(Vx.UserMessage,null,vscpp("references",{value:d}),"Excerpt of the existing test file at `",f,"`:",vscpp("br",null),vscpp(nt,{uri:c,code:u.text,languageId:u.languageId}),vscpp("br",null),"Because a test file exists: ",vscpp("br",null),"- Do not generate preambles, like imports, copyright headers etc.",vscpp("br",null),"- Do generate code that can be appended to the existing test file.");case"anyTestFile":return vscpp(Vx.UserMessage,null,"This is a sample test file:",vscpp("br",null),vscpp(nt,{uri:c,code:u.text,languageId:u.languageId}))}}};Gw=E([y(1,dt),y(2,qe)],Gw);var GU=q(Ue());var gy=class extends GU.PromptElement{constructor(r,n){super(r);this.testDepsResolver=n}async render(r,n){let{languageId:o}=this.props,s=await this.testDepsResolver.getTestDeps(o);return s.length>0&&vscpp(GU.UserMessage,null,"The project has the following testing dependencies: ",s.join(", "),".")}};gy=E([y(1,Vw)],gy);var $U=q(require("path"));function WU({workspaceService:t,chatVariables:e,userQuery:r,testFileToWriteTo:n,testedSymbolIdentifier:o,context:s}){let a=o?`\`${o}\``:"my code",c=e.substituteVariablesWithReferences(r),l=zU(t,n.path),u=[];if(u.push(`Please, generate tests for ${a}.`),l!==null){let p=`The tests will be placed in \`${l}\``;p+=l.includes("/")?".":` located in the same directory as \`${zU(t,s.document.uri.path)}\`.`,u.push(p),u.push("Generate tests accordingly.")}return u.push(c),u.filter(p=>p!=="").join(" ").trim()}function zU(t,e){let r=t.getWorkspaceFolders().find(s=>e.startsWith(s.path));return r===void 0?null:$U.relative(r.path,e).split($U.sep).join("/")}var zw=class{constructor(e,r,n,o,s,a,c,l,u){this.intent=e;this.endpoint=r;this.location=n;this.documentContext=o;this.alreadyConsumedChatVariable=s;this.instantiationService=a;this.workspaceService=c;this.ignoreService=l;this._parserService=u;this._testFileFinder=this.instantiationService.createInstance(Gp)}async buildPrompt(e,r,n){(0,$Ee.default)(!Jv(this.documentContext.document),"TestFromSourceInvocation should not be invoked from a test file");let o=await this.findTestFileForSourceFile(n);if(o!==null&&o.kind==="candidateTestFile")this._testFileToWriteTo={kind:"existing",uri:o.testExampleFile};else{let l=D6(this.documentContext.document);this._testFileToWriteTo={kind:"new",uri:l}}let s;if(this._testFileToWriteTo.kind==="new")s=new Be(0,0,0,0);else{let l=this._testFileToWriteTo.uri,u=await this.workspaceService.openTextDocument(l),d=this._parserService.getTreeSitterAST(u),p=d?await d.findLastTest():null;if(p===null)s=new Be(u.lineCount,0,u.lineCount,0);else{let f=u.positionAt(p.endIndex),m=f.line+1;s=new Be(f.line,f.character,m,0)}}return r.report(new jF(this._testFileToWriteTo.uri,s)),this.location===2&&!e.query&&(e={...e,query:"Write a set of detailed unit test functions for the code above."}),await Me.create(this.instantiationService,this.endpoint,qL,{context:this.documentContext,endpoint:this.endpoint,location:this.location,testExampleFile:o,testFileToWriteTo:this._testFileToWriteTo,promptContext:e,alreadyConsumedChatVariable:this.alreadyConsumedChatVariable}).render(r,n)}async processResponse(e,r,n,o){let s=this.documentContext.document,a=this._additionalResponseParts;this._additionalResponseParts=void 0;let c=this._testFileToWriteTo?.kind,l=this._testFileToWriteTo?.uri;if(this._testFileToWriteTo=void 0,c===void 0||l===void 0)nd(a,"Expected to have a textual response without a test file");else if(c==="new"){let u=new Be(0,0,0,0),d=new ll("",Or.empty,s.languageId);await new Ov(l,d,this.documentContext.fileIndentInfo,hs.Emit,1,(f,m)=>new Dv(m,u.start,f),ji.createCodeBlockClassifier(),f=>!0).processResponse(e,r,n,o)}else{let u=await this.workspaceService.openTextDocument(l),d=this._parserService.getTreeSitterAST(u),p=d?await d.findLastTest():null,f;if(p===null)f=new Be(u.lineCount,0,u.lineCount,0);else{let b=u.positionAt(p.endIndex),_=b.line+1;f=new Be(b.line,b.character,_,0)}let h=(await Q2(this._parserService,u,this.documentContext.fileIndentInfo,f,u.getText().length)).splitAroundOriginalSelectionEnd(),g="$PLACEHOLDER$";await h.createReplyInterpreter(BI.chain(b=>SY(b,"`"+g+"`","selection"),b=>SY(b,g,"selection")),1,h.insertStreaming,ji.createCodeBlockClassifier(),b=>b.value.trim()!==g).processResponse(e,r,n,o)}a?.forEach(u=>n.push(u))}async findTestFileForSourceFile(e){let r,n=await this._testFileFinder.findTestFileForSourceFile(this.documentContext.document,e);if(e.isCancellationRequested)return null;if(n!==void 0)r="candidateTestFile";else{let o=await this._testFileFinder.findAnyTestFileForSourceFile(this.documentContext.document,e);if(e.isCancellationRequested)return null;r="anyTestFile",n=o}return n===void 0||await this.ignoreService.isCopilotIgnored(n)?null:{kind:r,testExampleFile:n}}};zw=E([y(5,j),y(6,qe),y(7,Te),y(8,dt)],zw);var qL=class extends Hx.PromptElement{constructor(r,n,o){super(r);this.parserService=n;this.workspaceService=o}async render(r,n){let{history:o,query:s,chatVariables:a}=this.props.promptContext,{context:c,testExampleFile:l,testFileToWriteTo:u,location:d,alreadyConsumedChatVariable:p}=this.props,f=this.parserService.getTreeSitterAST(c.document),m=c.selection,h,g;if(f!==void 0){let k=await f.getNodeToDocument(_o(c.selection,c.document));m=Os(c.document,k.nodeToDocument),h=k.nodeIdentifier,g=k.nodeToDocument.type}let v=["typescript","typescriptreact"].includes(c.document.languageId)&&g!==void 0&&["class_declaration","method_definition"].includes(g)?{costFnOverride:(k,M)=>k&&(k.kind==="constructor"||k.kind==="method_definition")?0:M}:void 0,b=await U_(this.parserService,c.document,c.fileIndentInfo,m,n.tokenBudget/2,v),_=c.language.languageId,x=await this.computeLangSpecificExtraGuidelines(c,l),S=WU({workspaceService:this.workspaceService,chatVariables:a,userQuery:s,testFileToWriteTo:u.uri,testedSymbolIdentifier:h,context:c}),I=zU(this.workspaceService,c.document.uri.path)??Rh.basename(c.document.uri.path),w=p===void 0?a:a.filter(k=>k.reference!==p);return vscpp(vscppf,null,vscpp(Hx.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(hr,null),vscpp("br",null),vscpp(ct,null),vscpp("br",null),d===1?vscpp(vscppf,null,"The user has a ",_," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",_," code block."):d===2?vscpp(vscppf,null,"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn."):void 0,x.length>0&&vscpp(vscppf,null,vscpp("br",null)," ",x)),vscpp(gy,{languageId:_,priority:750}),vscpp(It,{history:o,priority:700}),vscpp(Hx.UserMessage,{priority:725},vscpp(cr,{languageId:c.language.languageId,includeTestGenerationInstructions:!0})),vscpp(Kt,{priority:750,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:750,chatVariables:w}),l!==null&&vscpp(Gw,{priority:750,...l}),vscpp(Hx.UserMessage,{priority:900},"Here is the current file at `",I,"`:",vscpp("br",null),vscpp("br",null),vscpp(nt,{uri:c.document.uri,languageId:c.document.languageId,code:b.text}),vscpp("br",null),vscpp("br",null),S))}async computeLangSpecificExtraGuidelines(r,n){let o=[];if(r.document.languageId==="python"&&!(n!==null&&n.kind==="candidateTestFile")){o.push("Make sure your answer imports the function to test as this is a total new file.");let a=Rh.dirname(r.document.uri.fsPath),c=Rh.join(a,"__init__.py"),l=this.workspaceService.getWorkspaceFolder(r.document.uri);try{await this.workspaceService.openTextDocument(nr.file(c)),l!==void 0&&Rh.resolve(a)===Rh.resolve(l?.fsPath??"")?o.push("The file is in the root of the workspace, which has an __init__.py but use an absolute import to import the function to test."):o.push("The parent directory of the given file has an __init__.py file making it a regular package. Use a relative import to import the function to test.")}catch{o.push("The parent directory of the given file has no __init__.py file making it a namespace package. Use an absolute import to import the function to test.")}}return o.join(`
`)}};qL=E([y(1,dt),y(2,qe)],qL);var Ph=q(Ue());var KU=q(Ue()),WEe=q(require("assert"));var $w=class extends KU.PromptElement{constructor(r,n,o,s){super(r);this.instaService=n;this.ignoreService=o;this.workspaceService=s}async render(r,n){let{documentContext:o,srcFile:s}=this.props;(0,WEe.default)(Jv(o.document),"Test2Impl must be invoked on a test file.");let a=this.instaService.createInstance(Gp),c,l;if(s?(c=s.uri,l=s.target):c=await a.findFileForTestFile(o.document,Wt.None),c===void 0||await this.ignoreService.isCopilotIgnored(c))return;let u=await this.workspaceService.openTextDocument(c),p=await this.instaService.createInstance(Op).summarizeDocument(u,o.fileIndentInfo,l,n.tokenBudget),f=[new Bo.PromptReference(c)];return vscpp(KU.UserMessage,null,vscpp("references",{value:f}),"Below is the file located at ",c.path,":",vscpp("br",null),vscpp(nt,{code:p.text,uri:c,languageId:o.document.languageId}))}};$w=E([y(1,j),y(2,Te),y(3,qe)],$w);var Ww=class{constructor(e,r,n,o,s,a,c){this.intent=e;this.endpoint=r;this.location=n;this.context=o;this.alreadyConsumedChatVariable=s;this.instantiationService=a;this.testGenInfoStorage=c;this.replyInterpreter=null}async buildPrompt(e,r,n){let o=this.testGenInfoStorage.sourceFileToTest;o!==void 0&&(this.testGenInfoStorage.sourceFileToTest=void 0);let s=Me.create(this.instantiationService,this.endpoint,jL,{context:this.context,promptContext:e,alreadyConsumedChatVariable:this.alreadyConsumedChatVariable,testGenInfo:o}),a=await s.render(r,n);return this.replyInterpreter=s.getMeta(Ms)?.replyInterpreter??null,a}async processResponse(e,r,n,o){return nd(this.replyInterpreter!==null,"TestFromTestInvocation should have received replyInterpreter from its prompt element"),this.replyInterpreter.processResponse(e,r,n,o)}};Ww=E([y(5,j),y(6,EC)],Ww);var jL=class extends Ph.PromptElement{constructor(r,n,o){super(r);this.workspaceService=n;this.parserService=o}async render(r,n){let{history:o,query:s,chatVariables:a}=this.props.promptContext,{context:c,testGenInfo:l,alreadyConsumedChatVariable:u}=this.props;if(er(c.document.uri))throw pn("TestFromTestPrompt should not be used for notebooks");let d=l?.identifier,p=l===void 0?`Please, generate more tests, taking into account existing tests. ${s}`.trim():WU({workspaceService:this.workspaceService,chatVariables:a,userQuery:s,testFileToWriteTo:c.document.uri,testedSymbolIdentifier:d,context:c}),f;if(l!==void 0){let g=await this.workspaceService.openTextDocument(l.uri),v=l.target.start,b=l.target.with(v.with(v.line,0));f=g.getText(b)}let m=await Xl.create(this.parserService,c.document,c.fileIndentInfo,c.wholeRange,0),h=u===void 0?a:a.filter(g=>g.reference!==u);return vscpp(vscppf,null,vscpp(Ph.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(hr,null),vscpp("br",null),"The user has a ",c.language.languageId," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",c.language.languageId," code block.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),vscpp(ct,null)),vscpp(gy,{priority:750,languageId:c.language.languageId}),vscpp(It,{priority:700,history:o}),vscpp(Ph.UserMessage,{priority:725},vscpp(cr,{languageId:c.language.languageId,includeTestGenerationInstructions:!0})),vscpp(Kt,{priority:750,endpoint:n.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ci,{priority:750,chatVariables:h}),vscpp($w,{priority:800,documentContext:c,srcFile:l}),vscpp(Ph.UserMessage,{priority:900},vscpp(bc,{documentData:m,tokenBudget:n.tokenBudget/3,_allowEmptySelection:!0})),l!==void 0&&f!==void 0&&vscpp(Ph.UserMessage,{priority:900},`Repeating excerpt from \`${l?.uri.path}\` here that needs to be tested:`,vscpp("br",null),vscpp(nt,{uri:l.uri,languageId:c.language.languageId,code:f})),vscpp(Ph.UserMessage,{priority:900},p))}};jL=E([y(1,qe),y(2,dt)],jL);var Yw=q(Ue());var Kw=class{constructor(e,r,n,o){this.chatMlFetcher=e;this.endpointProvider=r;this.instantiationService=n;this.logService=o}async parse(e){let r=await this.endpointProvider.getChatEndpoint("gpt-4"),o=await Me.create(this.instantiationService,r,rre,{query:e}).render(),s=await this.chatMlFetcher.fetchOne("testGenParseUserQuery",o.messages,void 0,Wt.None,3,r);return s.type==="success"?this.processResponse(s.value):null}processResponse(e){let r=e.split(/\r\n|\r|\n/).filter(o=>o!=="");r.at(0)!=="```"&&(r.splice(0,1),r.at(-1)==="```"&&r.splice(r.length-1,1),e=r.join(`
`));let n;try{n=JSON.parse(e)}catch(o){return this.logService.internal.error(`Failed to parse user query response
Response:
${e}
Error:
${o}`),null}return this.isParsedUserQuery(n)?n:null}isParsedUserQuery(e){if(typeof e!="object"||e===null)return!1;let r=e;if(r.fileToTest!==void 0&&typeof r.fileToTest!="string")return!1;if(r.symbolsToTest!==void 0){if(!Array.isArray(r.symbolsToTest))return!1;for(let n of r.symbolsToTest)if(typeof n!="string")return!1}return!0}};Kw=E([y(0,yt),y(1,xe),y(2,j),y(3,ie)],Kw);var rre=class extends Yw.PromptElement{constructor(e){super(e)}render(e,r){let{query:n}=this.props;return vscpp(vscppf,null,vscpp(Yw.SystemMessage,null,`
You are a helpful assistant that parses user queries.
The user is a software developer that is asking an AI programming assistant to generate tests.
Your job is to parse the user query into a JSON object of the following shape:

\`\`\`typescript
{
	/**
	 * File reference to test.
	 */
	fileToTest?: string;
	/**
	 * Symbols in {fileToTest} to generate tests for.
	 * Can be undefined if cannot be identified from user query.
	 */
	symbolsToTest?: string[];
}
\`\`\`

You must return a JSON object of the given shape.
`),vscpp(Yw.UserMessage,null,"User query: ",n,vscpp("br",null),"Parsed query:",vscpp("br",null)))}};var Qw=class{constructor(e,r,n,o,s){this.instantiationService=e;this.endpointProvider=r;this.ignoreService=n;this.workspaceService=o;this.logService=s;this.id="tests";this.locations=[2,1];this.description=KEe.t("Generate unit tests for the selected code");this.commandInfo=void 0;this.requestHandler=VL}static{this.ID="tests"}get intentDetectionInput(){let e="generate_test_for_code";return{functionName:e,sampleQuestion:"Write a set of detailed unit test functions for the code above.",functionCallingBlurb:`If the user's message is related to generating tests, you should use the '${e}' function.`}}async invoke(e){let r=e.documentContext,n;if(!r){let a=await this.resolveDocContextProgrammatically(e);a&&(r=a.documentContext,n=a.alreadyConsumedChatVariable)}if(!r){let a=await this.resolveDocContextUsingLlm(e);a&&(r=a.documentContext,n=a.alreadyConsumedChatVariable)}if(!r)throw new Error("To generate tests, open a file and select code to test.");if(await this.ignoreService.isCopilotIgnored(r.document.uri))throw new Error("Copilot is disabled for this file.");let o=e.location,s=await this.endpointProvider.getChatEndpoint("gpt-4");return Jv(r.document)?this.instantiationService.createInstance(Ww,this,s,o,r,n):this.instantiationService.createInstance(zw,this,s,o,r,n)}async resolveDocContextProgrammatically(e){let r=e.request.references,n=0,o=[];for(let c of r)if(c.id==="copilot.file"||c.id==="vscode.file")ah(c.value)&&(n+=1,o.push([c,c.value]));else{if(!ah(c.id))continue;let l=He.parse(c.id);l!==void 0&&o.push([c,l])}if(n>1||o.length===0)return;let[s,a]=o[0];return{documentContext:await this.createDocumentContext(a),alreadyConsumedChatVariable:s}}async resolveDocContextUsingLlm(e){let n=await this.instantiationService.createInstance(Kw).parse(e.request.prompt);if(n===null)return;let{fileToTest:o}=n;if(o!==void 0){this.log("parsedQuery",n),this.log("refs",e.request.references);for(let s=0;s<e.request.references.length;s++){let a=e.request.references[s];if(a.id!=="vscode.file"&&a.id!=="copilot.file")continue;let[c,l]=a.name.trim().split(":");if(!(c!=="file"||l===void 0||!He.isUri(a.value)||l!==o))return{documentContext:await this.createDocumentContext(a.value),alreadyConsumedChatVariable:a}}}}async createDocumentContext(e,r){let n;try{n=await this.workspaceService.openTextDocument(e)}catch(s){this.log(`Tried opening file ${e.toString()} but got error: ${s}`);return}let o=r??new Be(new xr(0,0),new xr(n.lineCount-1,n.lineAt(n.lineCount-1).text.length));return{document:n,fileIndentInfo:void 0,language:mn(n.languageId),wholeRange:o,selection:new _p(o.start,o.end)}}log(...e){let r=e.map(n=>typeof n=="object"?JSON.stringify(n,null,"	"):n).join(`
`);this.logService.internal.debug(`[TestsIntent] ${r}`)}};Qw=E([y(0,j),y(1,xe),y(2,Te),y(3,qe),y(4,ie)],Qw);var VL=class extends m0{constructor(r,n,o,s,a,c,l,u,d,p,f,m,h,g,v,b,_){super(r,n,o,s,a,c,l,u,d,p,f,m,h,g,v,b);this.setupTestsDetector=_}async getResult(){return this.request.acceptedConfirmationData?.some(zEe)?(setTimeout(()=>this.getResultInner()),{}):this.getResultInner()}async getResultInner(){let r=this.documentContext&&await this.setupTestsDetector.shouldSuggestSetup(this.documentContext,this.request,this.stream);if(!r)return super.getResult();let n={};return r.type===4&&(n=await super.getResult()),this.setupTestsDetector.showSuggestion(r).forEach(o=>this.stream.push(o)),n}};VL=E([y(10,j),y(11,dc),y(12,ge),y(13,ie),y(14,yt),y(15,p0),y(16,VU)],VL);var YU=q(Ct());var HL=class extends us{constructor(r,n,o,s,a,c){super(r,n,o);this.instantiationService=s;this.combinedEmbeddingIndex=a;this.workbenchService=c;this.linkification={disable:!0}}async createRenderer(r,n,o,s){return Me.create(this.instantiationService,n,bT,{endpoint:n,promptContext:r})}processResponse(r,n,o,s){return new nre(this.combinedEmbeddingIndex,this.workbenchService).processResponse(r,n,o,s)}};HL=E([y(3,j),y(4,md),y(5,Bm)],HL);var nre=class{constructor(e,r){this.combinedIndex=e;this.workbechService=r;this.stagedTextToApply="";this._incodeblock=!1}async processResponse(e,r,n,o){for await(let{delta:s}of r){if(o.isCancellationRequested)return;await this.applyDelta(s.text,n)}}async processNonReporting(e,r){let n=_be(this.combinedIndex,e);for(let o of n)if(o.showCodeBlock&&r.markdown(o.codeBlock?o.codeBlock:e),o.command&&r.button(o.command),o.failedValidation){if((await this.workbechService.getAllCommands()).map(c=>c.command).includes(o.command.command))return;let a=o.showCodeBlock?YU.t("To apply this setting, an additional extension installation is needed."):YU.t("To execute this command, an additional extension installation is needed.");r.warning(a)}}async applyDelta(e,r){e=this.stagedTextToApply+e;let n=e.indexOf("```");if(this._incodeblock){let o=e.indexOf("```");o===-1?this.stagedTextToApply=e:(this._incodeblock=!1,e="\n```"+e.substring(0,o)+"```\n",await this.processNonReporting(e,r),this.stagedTextToApply="")}else if(n!==-1){this._incodeblock=!0;let o=e.indexOf("```",n+3);if(o!==-1)this._incodeblock=!1,r.markdown(e.substring(0,n)),await this.processNonReporting(e,r),r.markdown(e.substring(o+3));else{let s=e.substring(0,n);r.markdown(s)}}else r.markdown(e)}},vy=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=vy.ID;this.locations=[2];this.description=YU.t("Ask questions about VS Code");this.commandInfo={allowsEmptyArgs:!1}}static{this.ID="vscode"}get intentDetectionInput(){let e="vscode_questions";return{functionName:e,sampleQuestion:"What is the command to open the integrated terminal?",modelDescription:"Looks up information about VS Code via commands, settings, and documentation to accomplish the given editor-specific task.",functionCallingBlurb:`If the user's message is related to commands or settings in Visual Studio Code, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(HL,this,r,n)}};vy=E([y(0,j),y(1,xe)],vy);s6.setIntents([new ye(Bp),new ye(xd),new ye(Nw),new ye(Xv),new ye(Qw),new ye(kw),new ye(iC),new ye(Aw),new ye(hy),new ye(Ed),new ye(aa),new ye(Sd),new ye(py),new ye(Rw),new ye(hT),new ye(b0),new ye(vy),new ye(uy),new ye(my),new ye(fy)]);var wA=require("vscode");var QU=q(require("fs"));var ire=`${process.env.HOME||process.env.USERPROFILE}/.copilot-testing-gh-token`,Rct=`Tests: either GITHUB_PAT must be set, or there must be a GitHub token from an app with access to Copilot in ${ire}. Run "npm run get_token" to get one.`,Xw;function YEe(t){if(!Xw&&(process.env.GITHUB_PAT&&(Xw=t.createInstance(_I,process.env.GITHUB_PAT)),process.env.GITHUB_OAUTH_TOKEN&&(Xw=t.createInstance(E_,process.env.GITHUB_OAUTH_TOKEN)),QU.existsSync(ire))){let e=QU.readFileSync(ire).toString();Xw=t.createInstance(E_,e.trim())}if(!Xw)throw new Error(Rct);return Xw}var QEe=require("vscode");var Jw=class extends SI{constructor(r,n,o,s,a){super(o,s,a);this._configurationService=r;this._domainService=n;this._taskSingler=new I0;this._register(QEe.authentication.onDidChangeSessions(c=>{c.provider.id===w8(this._configurationService)&&(this._logService.internal.debug("Handling onDidChangeSession."),this._handleAuthChangeEvent())})),this._register(this._domainService.onDidChangeDomains(c=>{c.dotcomUrlChanged&&(this._logService.internal.debug("Handling onDidChangeDomains."),this.resetCopilotToken())})),this._handleAuthChangeEvent()}async getAnyGitHubSession(r){let n=()=>k8(this._configurationService,r),o=r?.createIfNone||r?.forceNewSession?await n():await this._taskSingler.getOrCreate("any",n);return this._anyGitHubSession=o,o}async getPermissiveGitHubSession(r){let n=()=>Dbe(this._configurationService,r),o=r?.createIfNone||r?.forceNewSession?await n():await this._taskSingler.getOrCreate("permissive",n);return this._permissiveGitHubSession=o,o}};Jw=E([y(0,he),y(1,en),y(2,ie),y(3,ac),y(4,w_)],Jw);var XEe=q(require("vscode"));var Zw=class extends Oe{constructor(r){super();this.telemetryService=r}async executeCommand(r,...n){try{let o=XEe.commands.executeCommand(r,...n);return this.telemetryService.sendMSFTTelemetryEvent("automaticCommandExecutedSucceeded",{command:r,args:n?.join(",")}),o}catch(o){this.telemetryService.sendMSFTTelemetryEvent("automaticCommandExecutedFailed",{command:r,args:n?.join(","),e:o})}}};Zw=E([y(0,ge)],Zw);var xf=q(require("vscode"));function JEe(t){return typeof t=="string"?t:JSON.stringify(t)}var XU=class extends oF{constructor(){super();this._onDidChangeConfiguration=new Yt;this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;this.config=xf.workspace.getConfiguration(hp),xf.workspace.onDidChangeConfiguration(r=>{r.affectsConfiguration(hp)&&(this.config=xf.workspace.getConfiguration(hp)),this._onDidChangeConfiguration.fire(r)})}getConfig(r){let n=this._getConfiguredValue(r);return n!==void 0?n:r.defaultValue}inspectConfig(r){return this.config.inspect(r.id)}getNonExtensionConfig(r){return xf.workspace.getConfiguration().get(r)}_getTargetFromInspect(r){let n;return r?r.workspaceFolderValue!==void 0?n=xf.ConfigurationTarget.WorkspaceFolder:r.workspaceValue!==void 0?n=xf.ConfigurationTarget.Workspace:n=xf.ConfigurationTarget.Global:n=xf.ConfigurationTarget.Global,n}_setAdvancedConfig(r,n){let o=this.config.get(r.firstPart);return o?o[r.secondPart]=n:o={[r.secondPart]:n},this.config.update(r.firstPart,o,this._getTargetFromInspect(this.config.inspect(r.firstPart)))}_setRegularConfig(r,n){return this.config.update(r.id,n,this._getTargetFromInspect(this.config.inspect(r.id)))}setConfig(r,n){return r.firstPart==="advanced"?this._setAdvancedConfig(r,n):this._setRegularConfig(r,n)}getExperimentBasedConfig(r,n){let o=this._getConfiguredValue(r);if(o!==void 0)return o;let s=n.getTreatmentVariable("vscode",`copilotchat.config.${r.id}`);return s!==void 0?s:r.defaultValue}_getConfiguredValue(r){if(this.config[r.firstPart]&&this.config[r.firstPart][r.secondPart]!==void 0)return this.config[r.firstPart][r.secondPart];let n=this.config.get(r.id);if(n!==void 0)return n}dumpConfig(){let r={};try{let n=sc.contributes.configuration?.properties??{};for(let o in n){let a=o.replace(`${hp}.`,"").split(".").reduce((c,l)=>c[l],this.config);typeof a=="object"&&a!==null?Object.keys(a).filter(c=>c!=="secret_key").forEach(c=>r[`${o}.${c}`]=JEe(a[c])):r[o]=JEe(a)}}catch(n){console.error(`Failed to retrieve configuration properties ${n}`)}return r}};var are=require("vscode"),ZEe=[];function ewe(){return ZEe.join(`
`)}function Pct(t,e){t.push(Act(e)),t.length>40&&t.shift()}var ore=class{constructor(e){this.session=e}onWillStartSession(){}onWillReceiveMessage(e){}onDidSendMessage(e){if(are.debug.activeDebugSession!==this.session)return;let r=this.extractOutput(e);r&&Pct(ZEe,r)}extractOutput(e){if(e.event==="output"&&(e.body.category==="stdout"||e.body.category==="stderr"))return e.body.output}onWillStopSession(){}onError(e){}onExit(e,r){}};function Act(t){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return t&&(t=t.replace(e,"")),t}function twe(){return[are.debug.registerDebugAdapterTrackerFactory("*",new sre)]}var sre=class{createDebugAdapterTracker(e){return new ore(e)}};var JU=class extends Oe{constructor(){super();for(let e of twe())this._register(e)}get consoleOutput(){return ewe()}};var ZU=ne("IDialogService");var rwe=q(require("vscode")),eB=class{showQuickPick(e,r,n){return rwe.window.showQuickPick(e,r,n)}};var iwe=q(require("path"));var tB=class t{constructor(e,r){this.lineRangeMapping=e,this.changes=r}flip(){return new t(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};var rB=class{constructor(e,r){this.range=e;this.text=r}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,r){return e.range.equalsRange(r.range)&&e.text===r.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};var GL=class t{static inverse(e,r,n){let o=[],s=1,a=1;for(let l of e){let u=new t(new Yr(s,l.original.startLineNumber),new Yr(a,l.modified.startLineNumber));u.modified.isEmpty||o.push(u),s=l.original.endLineNumberExclusive,a=l.modified.endLineNumberExclusive}let c=new t(new Yr(s,r+1),new Yr(a,n+1));return c.modified.isEmpty||o.push(c),o}static clip(e,r,n){let o=[];for(let s of e){let a=s.original.intersect(r),c=s.modified.intersect(n);a&&!a.isEmpty&&c&&!c.isEmpty&&o.push(new t(a,c))}return o}constructor(e,r){this.original=e,this.modified=r}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new t(this.modified,this.original)}join(e){return new t(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),r=this.modified.toInclusiveRange();if(e&&r)return new Sf(e,r);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new yr("not a valid diff");return new Sf(new je(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new je(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new Sf(new je(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new je(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,r){if(nwe(this.original.endLineNumberExclusive,e)&&nwe(this.modified.endLineNumberExclusive,r))return new Sf(new je(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new je(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new Sf(je.fromPositions(new Ut(this.original.startLineNumber,1),ek(new Ut(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),je.fromPositions(new Ut(this.modified.startLineNumber,1),ek(new Ut(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),r)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new Sf(je.fromPositions(ek(new Ut(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),ek(new Ut(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),je.fromPositions(ek(new Ut(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),r),ek(new Ut(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),r)));throw new yr}};function ek(t,e){if(t.lineNumber<1)return new Ut(1,1);if(t.lineNumber>e.length)return new Ut(e.length,e[e.length-1].length+1);let r=e[t.lineNumber-1];return t.column>r.length+1?new Ut(t.lineNumber,r.length+1):t}function nwe(t,e){return t>=1&&t<=e.length}var nB=class t extends GL{static fromRangeMappings(e){let r=Yr.join(e.map(o=>Yr.fromRangeInclusive(o.originalRange))),n=Yr.join(e.map(o=>Yr.fromRangeInclusive(o.modifiedRange)));return new t(r,n,e)}constructor(e,r,n){super(e,r),this.innerChanges=n}flip(){return new t(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new t(this.original,this.modified,[this.toRangeMapping()])}},Sf=class t{static assertSorted(e){for(let r=1;r<e.length;r++){let n=e[r-1],o=e[r];if(!(n.originalRange.getEndPosition().isBeforeOrEqual(o.originalRange.getStartPosition())&&n.modifiedRange.getEndPosition().isBeforeOrEqual(o.modifiedRange.getStartPosition())))throw new yr("Range mappings must be sorted")}}constructor(e,r){this.originalRange=e,this.modifiedRange=r}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new t(this.modifiedRange,this.originalRange)}toTextEdit(e){let r=e.getValueOfRange(this.modifiedRange);return new rB(this.originalRange,r)}};var Dct=iwe.join(__dirname,"diffWorker.js"),iB=class{constructor(e=Dct){this._worker=new qn(()=>new zv(e,{name:"Diff worker"}))}dispose(){this._worker.rawValue?.terminate()}async computeDiff(e,r,n){let o=await this._worker.value.proxy.computeDiff(e,r,n);return{identical:o.identical,quitEarly:o.quitEarly,changes:a(o.changes),moves:o.moves.map(c=>new tB(new GL(new Yr(c[0],c[1]),new Yr(c[2],c[3])),a(c[4])))};function a(c){return c.map(l=>new nB(new Yr(l[0],l[1]),new Yr(l[2],l[3]),l[4]?.map(u=>new Sf(new je(u[0],u[1],u[2],u[3]),new je(u[4],u[5],u[6],u[7])))))}}};var tk=class{constructor(e,r,n,o,s,a){this._authService=e;this._tokenizerProvider=r;this._telemetryService=n;this._domainService=o;this._envService=s;this._fetcherService=a}async computeEmbeddings(e,r,n,o){let s=e.maxBatchSize,a=e.modelMaxPromptTokens-1;return this.fetchResponseWithBatches(e,r,o,a,s,n?.dimensions,n?.parallelism)}async fetchResponseWithBatches(e,r,n,o,s,a,c=1){for(let p of r)if(this._tokenizerProvider.acquireTokenizer(e).tokenLength(p)>o)return;let l=[],u=[],d=new fp(c);try{for(let p=0;p<r.length;p+=s){let f=r.slice(p,p+s);u.push(d.queue(async()=>{if(n?.isCancellationRequested)return;let m=await this.rawEmbeddingsFetchWithTelemetry(e,ir(),f,a,n);if(m.type==="failed")throw new Error("Embeddings request failed "+m.reason);return m}))}l=(await Promise.all(u)).flatMap(p=>p?.embeddings??[])}catch{return}finally{d.dispose()}if(!n?.isCancellationRequested)return l.length===0?void 0:{model:e.model,embeddings:l}}async rawEmbeddingsFetchWithTelemetry(e,r,n,o,s){let a=Date.now(),c=await this.rawEmbeddingsFetch(e,r,n,o,s);return c.type==="failed"?(this._telemetryService.sendMSFTTelemetryErrorEvent("embedding.error",{type:c.type,reason:c.reason}),c):(this._telemetryService.sendMSFTTelemetryEvent("embedding.success",{},{batchSize:n.length,inputTokenCount:n.reduce((l,u)=>l+this._tokenizerProvider.acquireTokenizer(e).tokenLength(u),0),timeToComplete:Date.now()-a}),c)}async rawEmbeddingsFetch(e,r,n,o,s){try{let a=await this._authService.getCopilotToken();if(o&&e.model!=="text-embedding-3-small")throw new Error("Dimensions are only supported for text-embeddings-3-small and later models.");let c={input:n,model:e.model,dimensions:o};e.interceptBody?.(c);let l=await Hv(this._fetcherService,this._envService,this._telemetryService,this._domainService,e,a.token,await ul(process.env.HMAC_SECRET),"copilot-panel",r,c,s),u=l.status===200?await l.json():await l.text();return l.status===200&&u.data?{type:"success",embeddings:u.data.map(d=>d.embedding)}:{type:"failed",reason:u.error}}catch(a){let c=a?.message??"Unknown error";return c.match(/Unexpected.*JSON/i)&&(c="timeout"),{type:"failed",reason:c}}}};tk=E([y(0,Tt),y(1,_r),y(2,ge),y(3,en),y(4,gt),y(5,Kr)],tk);var owe="github-enterprise.uri",rk=class extends Oe{constructor(r,n){super();this._configurationService=r;this._tokenStore=n;this._onDidChangeDomains=this._register(new Yt);this.onDidChangeDomains=this._onDidChangeDomains.event;this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com";this._register(this._configurationService.onDidChangeConfiguration(s=>this._onDidConfigChangeHandler(s))),this._dotcomAPIUrl=this._getDotComAPIUrl();let o=this._configurationService.getConfig(le.DebugOverrideCAPIUrl);o.endsWith("/")&&(o=o.slice(0,-1)),this._capiBaseUrl=o,this._capiBaseUrl==="https://api.githubcopilot.com"&&(this._processCopilotToken(this._tokenStore.copilotToken),this._register(this._tokenStore.onDidStoreUpdate(()=>this._processCopilotToken(this._tokenStore.copilotToken))))}_onDidConfigChangeHandler(r){if(r.affectsConfiguration(`${hp}.advanced`)||r.affectsConfiguration(owe)){let n=this._getDotComAPIUrl();this._dotcomAPIUrl!==n&&(this._dotcomAPIUrl=n,this._onDidChangeDomains.fire({capiUrlChanged:!1,telemeryUrlChanged:!1,dotcomUrlChanged:!0}))}}_getDotComAPIUrl(){let r=this._configurationService.getNonExtensionConfig(owe),n=this._configurationService.getConfig(le.AuthProvider)==="github-enterprise";if(r&&n){let o=He.parse(r);return`${o.scheme}://api.${o.authority}`}return"https://api.github.com"}_processCopilotToken(r){let n=this._capiBaseUrl,o=this._telemetryBaseUrl;r?(this._capiBaseUrl=r.endpoints.api,this._telemetryBaseUrl=r.endpoints.telemetry):(this._capiBaseUrl="https://api.githubcopilot.com",this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com"),(n!==this._capiBaseUrl||o!==this._telemetryBaseUrl)&&this._onDidChangeDomains.fire({capiUrlChanged:n!==this._capiBaseUrl,telemeryUrlChanged:o!==this._telemetryBaseUrl,dotcomUrlChanged:!1})}get capiBaseURL(){return this._capiBaseUrl}get capiChatURL(){return`${this._capiBaseUrl}/chat/completions`}get capiEmbeddingsURL(){return`${this._capiBaseUrl}/embeddings`}get capiModelsURL(){return`${this._capiBaseUrl}/models`}get chunksURL(){return`${this.dotComAPIURL}/chunks`}get telemetryURL(){return`${this._telemetryBaseUrl}/telemetry`}get remoteAgentsURL(){return`${this._capiBaseUrl}/agents`}get listSkillsURL(){return`${this._capiBaseUrl}/skills`}get searchSkillURL(){return`${this._capiBaseUrl}/search`}get contentExclusionURL(){return`${this._dotcomAPIUrl}/copilot_internal/content_exclusion`}get tokenURL(){return this._dotcomAPIUrl+"/copilot_internal/v2/token"}get dotComAPIURL(){return this._dotcomAPIUrl}};rk=E([y(0,he),y(1,ac)],rk);var Ah=q(require("vscode"));var oB=class{get sessionId(){return Ah.env.sessionId}get machineId(){return Ah.env.machineId}get OS(){switch(Tfe){case 3:return"Windows";case 1:return"Mac";case 2:return"Linux";default:return"Linux"}}get language(){return Ah.env.language}get uriScheme(){return Ah.env.uriScheme}isProduction(){return GM}isPreRelease(){return Ra}getBuildType(){return sc.buildType}getVersion(){return sc.version}getBuild(){return sc.build}getName(){return sc.name}getEditorInfo(){return new zA("vscode",Ah.version)}getEditorPluginInfo(){return new zA("copilot-chat",sc.version)}getEditorVersionHeaders(){return{"Editor-Version":this.getEditorInfo().format(),"Editor-Plugin-Version":this.getEditorPluginInfo().format()}}hasNewMappedEditsProviderAPI(){return"registerMappedEditsProvider2"in Ah.chat}};var zL=q(require("vscode")),sB=class{get all(){return zL.extensions.all}get allAcrossExtensionHosts(){return zL.extensions.allAcrossExtensionHosts}get onDidChange(){return zL.extensions.onDidChange}get getExtension(){return zL.extensions.getExtension}};var Fd=q(require("vscode")),nk=class{async stat(e){return Fd.workspace.fs.stat(e)}async readDirectory(e){return Fd.workspace.fs.readDirectory(e)}async createDirectory(e){return Fd.workspace.fs.createDirectory(e)}async readFile(e){return Fd.workspace.fs.readFile(e)}async writeFile(e,r){return Fd.workspace.fs.writeFile(e,r)}async delete(e,r){return Fd.workspace.fs.delete(e,r)}async rename(e,r,n){return Fd.workspace.fs.rename(e,r,n)}async copy(e,r,n){return Fd.workspace.fs.copy(e,r,n)}isWritableFileSystem(e){return!!Fd.workspace.fs.isWritableFileSystem(e)}createFileSystemWatcher(e){return Fd.workspace.createFileSystemWatcher(e)}};var aB=class extends nk{constructor(){super()}async readFile(e){return super.readFile(e)}};var yy=q(require("vscode"));var ik=class{constructor(e){this._logService=e;this._onDidChange=new yy.EventEmitter;this.onDidChange=this._onDidChange.event;this._extensionEnablement=void 0;this._disposables=[];this._logService.public.info("Initializing Git extension service."),this._disposables.push(...this._initializeExtensionApi())}getExtensionApi(){return this._api}get extensionAvaiable(){return this._extensionEnablement===void 0?!!yy.extensions.getExtension("vscode.git"):this._extensionEnablement}_initializeExtensionApi(){let e=[],r=yy.extensions.getExtension("vscode.git"),n=async()=>{let o;try{o=await r.activate(),this._logService.public.info("Successfully activated the vscode.git extension.")}catch(a){this._logService.public.error(a,"Failed to activate the vscode.git extension.");return}let s=a=>{this._logService.public.info(`Enablement state of the vscode.git extension: ${a}.`),this._extensionEnablement=a,a?(this._api=o.getAPI(1),this._onDidChange.fire({enabled:!0}),this._logService.public.info("Successfully registered Git commit message provider.")):(this._api=void 0,this._onDidChange.fire({enabled:!1}))};e.push(o.onDidChangeEnablement(s)),s(o.enabled)};if(r)n();else{this._logService.public.info("vscode.git extension is not yet activated.");let o=yy.extensions.onDidChange(()=>{!r&&yy.extensions.getExtension("vscode.git")&&(r=yy.extensions.getExtension("vscode.git"),n(),o.dispose())})}return e}};ik=E([y(0,ie)],ik);var cre=q(require("vscode"));var mu=class extends Oe{constructor(r){super();this.gitExtensionService=r;this._onDidOpenRepository=new Yt;this.onDidOpenRepository=this._onDidOpenRepository.event;this._onDidCloseRepository=new Yt;this.onDidCloseRepository=this._onDidCloseRepository.event;this._onDidFinishInitialRepositoryDiscovery=new Yt;this.onDidFinishInitialization=this._onDidFinishInitialRepositoryDiscovery.event;this._isInitialized=!1;this._register(this._onDidOpenRepository),this._register(this._onDidCloseRepository),this._register(this._onDidFinishInitialRepositoryDiscovery);let n=this.gitExtensionService.getExtensionApi();n?this.registerGitAPIListeners(n):this._register(this.gitExtensionService.onDidChange(o=>{if(o.enabled){let s=this.gitExtensionService.getExtensionApi();s&&this.registerGitAPIListeners(s)}else this._onDidFinishInitialRepositoryDiscovery.fire()}))}registerGitAPIListeners(r){this._register(r.onDidOpenRepository(n=>{let o=mu.repoToRepoContext(n);o&&this._onDidOpenRepository.fire(o)})),this._register(r.onDidCloseRepository(n=>{let o=mu.repoToRepoContext(n);o&&this._onDidCloseRepository.fire(o)})),r.state==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0),this._register(r.onDidChangeState(n=>{n==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0)}))}get isInitialized(){return this._isInitialized}async openRepository(r){let n=this.gitExtensionService.getExtensionApi();if(!n)return;let o=await n.openRepository(r);return mu.repoToRepoContext(o)}getRepository(r){let n=this.gitExtensionService.getExtensionApi();if(n)return mu.repoToRepoContext(n.getRepository(r))}async initialize(){if(this._isInitialized)return;let r=cre.workspace.workspaceFolders;if(!r)return;let n=this.gitExtensionService.getExtensionApi();if(n)for(let o of r)await n.openRepository(o.uri).catch(()=>{})}static repoToRepoContext(r){if(r)return{rootUri:r.rootUri,headBranchName:r.state.HEAD?.name,headCommitHash:r.state.HEAD?.commit,upstreamBranchName:r.state.HEAD?.upstream?.name,upstreamRemote:r.state.HEAD?.upstream?.remote,isRebasing:r.state.rebaseCommit!==null,remotes:r.state.remotes.map(n=>n.name),remoteFetchUrls:r.state.remotes.map(n=>n.fetchUrl)}}get repositories(){if(!cre.workspace.workspaceFolders)return[];let n=this.gitExtensionService.getExtensionApi();return n?Dr(n.repositories.map(o=>mu.repoToRepoContext(o))):[]}};mu=E([y(0,ro)],mu);var ok=class extends dv{constructor(r,n,o){super(n,o);this._authService=r}async getCurrentAuthedUser(){let r=(await this._authService.getAnyGitHubSession())?.accessToken;if(r)return await this.getCurrentAuthedUserWithToken(r)}async getTeamMembership(r){let n=await this._authService.getAnyGitHubSession(),o=n?.accessToken,s=n?.account.label;if(!(!o||!s))return await this.getTeamMembershipWithToken(r,o,s)}};ok=E([y(0,Tt),y(1,en),y(2,Kr)],ok);var sk=class{constructor(e,r){this.accessor=e;this.authenticationService=r;this.githubRepositoryInfoCache=new Map;this.fetcherService=e.get(Kr)}async _doGetRepositoryInfo(e,r){let n=this.authenticationService.permissiveGitHubSession?.accessToken??this.authenticationService.anyGitHubSession?.accessToken,o={Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"};return n&&(o.Authorization=`Bearer ${n}`),this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}`,{method:"GET",headers:o})}async getRepositoryInfo(e,r){let n=this.githubRepositoryInfoCache.get(`${e}/${r}`);if(n)return n;let o=await this._doGetRepositoryInfo(e,r);if(o.ok){let s=await o.json();return this.githubRepositoryInfoCache.set(`${e}/${r}`,s),s}throw new Error(`Failed to fetch repository info for ${e}/${r}`)}async isAvailable(e,r){try{return(await this._doGetRepositoryInfo(e,r)).ok}catch{return!1}}async getRepositoryItems(e,r,n){let o=[];try{let s=this.accessor.get(Tt).permissiveGitHubSession?.accessToken,a=n.split("/").map(l=>encodeURIComponent(l)).join("/"),c=await this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}/contents/${a}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${s}`}});if(c.ok){let l=await c.json();if(Array.isArray(l))for(let u of l)"name"in u&&"path"in u&&"type"in u&&"html_url"in u&&(o.push({name:u.name,path:u.path,type:u.type,html_url:u.html_url}),u.type==="dir"&&o.push(...await this.getRepositoryItems(e,r,u.path)))}else return console.error(`Failed to fetch contents from ${e}:${r}:${n}`),[]}catch{return console.error(`Failed to fetch contents from ${e}:${r}:${n}`),[]}return o}async getRepositoryItemContent(e,r,n){try{let o=this.accessor.get(Tt).permissiveGitHubSession?.accessToken,s=n.split("/").map(c=>encodeURIComponent(c)).join("/"),a=await this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}/contents/${s}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${o}`}});if(a.ok){let c=await a.json();if("content"in c){let l=Buffer.from(c.content,"base64");return new Uint8Array(l)}throw new Error("Unexpected data from GitHub")}}catch{console.error(`Failed to contents from ${e}:${r}:${n}`)}}};sk=E([y(0,Rt),y(1,Tt)],sk);var Gx=q(require("vscode"));var ak=class{constructor(e,r){this._ignoreService=e;this._store=new ht;this._entries=new Hg(30);this._store.add(Gx.workspace.onDidOpenTextDocument(o=>{for(let[s,a]of Array.from(this._entries))s.isClosed&&s.uri.toString()===o.uri.toString()&&(this._entries.delete(s),this._entries.set(o,a))})),this._store.add(Gx.workspace.onDidChangeTextDocument(o=>{if(o.contentChanges.length===0)return;let s=this._entries.get(o.document);if(s)for(let a of o.contentChanges){let c=a.text.length-a.rangeLength;for(let l=0;l<s.length;l++){let u=s[l];u.offset>a.rangeOffset&&(s[l]=u.adjust(c))}}}));let n=async(o,s)=>{if(o.document.uri.scheme==="output")return;let a=o.document,c=this._entries.get(a);c||(c=[],this._entries.set(a,c));for(let l of s)c.push(new $A(a.offsetAt(l.start),Date.now())),l.isEmpty||c.push(new $A(a.offsetAt(l.end),Date.now()));c.length>100&&c.splice(0,33),r.internal.trace(`[HEATMAP] for ${a.uri} has ${c.length} entries`)};this._store.add(Gx.window.onDidChangeTextEditorVisibleRanges(o=>{n(o.textEditor,o.visibleRanges)})),this._store.add(Gx.window.onDidChangeTextEditorSelection(o=>{n(o.textEditor,o.selections)})),this._store.add(Gx.window.onDidChangeActiveTextEditor(o=>{o&&n(o,o.selections)}))}dispose(){this._store.dispose(),this._entries.clear()}async getEntries(){let e=new Map;for(let[r,n]of this._entries.entries())await this._ignoreService.isCopilotIgnored(r.uri)||e.set(r,n);return e}};ak=E([y(0,Te),y(1,ie)],ak);var Nh=require("vscode");var lre=q(require("vscode"));var ck=class extends I6{findTextInFiles(e,r,n,o){return Promise.resolve(lre.workspace.findTextInFiles(e,r,s=>n.report(s),o))}findFiles(e,r,n){return lre.workspace.findFiles2(e,r,n)}};function swe(t){if(typeof t!="string")throw new TypeError("Argument must be a string.");if(!t)return t;let e=t.startsWith("!"),r=e?t.slice(1):t,n=r,o=!1;switch(r[0]==="/"&&(o=!0,n=r.slice(1)),n[0]){case"*":r[1]!=="*"&&(n="**/"+n);break;default:if((!o&&!n.includes("/")||n.endsWith("/"))&&(n="**/"+n),n.endsWith("*")||n.endsWith("?"))break;/\.[a-z\d_-]+$/.test(n)||(n.endsWith("/")||(n+="/"),n+="**")}return e?"!"+n:n}var ywe=q(gwe()),ja=require("path");var lB=class{constructor(){this._ignoreMap=new Map;this._ignoreCache=new Map;this._searchRankCache=null}setIgnoreFile(e,r,n){let o="";e&&(o=(0,ja.relative)(e.fsPath,(0,ja.dirname)(r.fsPath)),o.startsWith("..")&&(o="")),this._ignoreMap.set(r.fsPath,{ignore:(0,ywe.default)().add(n),patterns:rd(n).filter(s=>s.trim()&&!s.startsWith("#")).map(swe).map(s=>o?ja.posix.join(o,s):s)}),this._searchRankCache=null,this._ignoreCache.clear()}removeIgnoreFile(e){this._ignoreMap.delete(e.fsPath),this._searchRankCache=null,this._ignoreCache.clear()}removeWorkspace(e){let r=0;for(let n of this._ignoreMap.keys())vwe(e.fsPath,n)&&(this._ignoreMap.delete(n),r+=1);r>0&&(this._searchRankCache=null,this._ignoreCache.clear())}asMinimatchPatterns(){return[...this._ignoreMap.values()].flatMap(e=>e.patterns)}isIgnored(e){if(this._ignoreMap.size===0)return!1;let r=e.fsPath;if(this._ignoreCache.has(r))return this._ignoreCache.get(r);let n=0,o={ignored:!1,unignored:!1};try{let s=this._searchRank;for(let a of s){n+=1;let c=(0,ja.dirname)(a),l=(0,ja.relative)(c,r);if(!l.startsWith("..")&&c!==r&&vwe(c,r)){let u=this._ignoreMap.get(a);if(!u)throw new Error(`No ignore patterns found for ${a}`);if(o=u.ignore.test(l),o.ignored||o.unignored)break}}return this._ignoreCache.set(r,o.ignored),o.ignored}catch{return!1}}get _searchRank(){if(this._searchRankCache!==null)return this._searchRankCache;let e={},r=n=>n.split(ja.sep).length;return this._searchRankCache=[...this._ignoreMap.keys()].sort((n,o)=>(e[o]||=r(o))-(e[n]||=r(n)))}};function vwe(t,e){return t===e?!0:(t.charAt(t.length-1)!==ja.sep&&(t+=ja.sep),(0,ja.normalize)(e).startsWith((0,ja.normalize)(t)))}var Bwe=q(Awe(),1);var WL=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")};var nlt={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},KL=t=>t.replace(/[[\]\\-]/g,"\\$&"),ilt=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Dwe=t=>t.join(""),Nwe=(t,e)=>{let r=e;if(t.charAt(r)!=="[")throw new Error("not in a brace expression");let n=[],o=[],s=r+1,a=!1,c=!1,l=!1,u=!1,d=r,p="";e:for(;s<t.length;){let g=t.charAt(s);if((g==="!"||g==="^")&&s===r+1){u=!0,s++;continue}if(g==="]"&&a&&!l){d=s+1;break}if(a=!0,g==="\\"&&!l){l=!0,s++;continue}if(g==="["&&!l){for(let[v,[b,_,x]]of Object.entries(nlt))if(t.startsWith(v,s)){if(p)return["$.",!1,t.length-r,!0];s+=v.length,x?o.push(b):n.push(b),c=c||_;continue e}}if(l=!1,p){g>p?n.push(KL(p)+"-"+KL(g)):g===p&&n.push(KL(g)),p="",s++;continue}if(t.startsWith("-]",s+1)){n.push(KL(g+"-")),s+=2;continue}if(t.startsWith("-",s+1)){p=g,s+=2;continue}n.push(KL(g)),s++}if(d<s)return["",!1,0,!1];if(!n.length&&!o.length)return["$.",!1,t.length-r,!0];if(o.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!u){let g=n[0].length===2?n[0].slice(-1):n[0];return[ilt(g),!1,d-r,!1]}let f="["+(u?"^":"")+Dwe(n)+"]",m="["+(u?"":"^")+Dwe(o)+"]";return[n.length&&o.length?"("+f+"|"+m+")":n.length?f:m,c,d-r,!0]};var by=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/\[([^\/\\])\]/g,"$1"):t.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1");var olt=new Set(["!","?","+","*","@"]),Lwe=t=>olt.has(t),slt="(?!(?:^|/)\\.\\.?(?:$|/))",uB="(?!\\.)",alt=new Set(["[","."]),clt=new Set(["..","."]),llt=new Set("().*{}+?[]^$\\!"),ult=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),vre="[^/]",Owe=vre+"*?",Mwe=vre+"+?",lk=class t{type;#t;#i;#d=!1;#r=[];#c;#a;#m;#s=!1;#n;#e;#p=!1;constructor(e,r,n={}){this.type=e,e&&(this.#i=!0),this.#c=r,this.#t=this.#c?this.#c.#t:this,this.#n=this.#t===this?n:this.#t.#n,this.#m=this.#t===this?[]:this.#t.#m,e==="!"&&!this.#t.#s&&this.#m.push(this),this.#a=this.#c?this.#c.#r.length:0}get hasMagic(){if(this.#i!==void 0)return this.#i;for(let e of this.#r)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#i=!0;return this.#i}toString(){return this.#e!==void 0?this.#e:this.type?this.#e=this.type+"("+this.#r.map(e=>String(e)).join("|")+")":this.#e=this.#r.map(e=>String(e)).join("")}#h(){if(this!==this.#t)throw new Error("should only call on root");if(this.#s)return this;this.toString(),this.#s=!0;let e;for(;e=this.#m.pop();){if(e.type!=="!")continue;let r=e,n=r.#c;for(;n;){for(let o=r.#a+1;!n.type&&o<n.#r.length;o++)for(let s of e.#r){if(typeof s=="string")throw new Error("string part in extglob AST??");s.copyIn(n.#r[o])}r=n,n=r.#c}}return this}push(...e){for(let r of e)if(r!==""){if(typeof r!="string"&&!(r instanceof t&&r.#c===this))throw new Error("invalid part: "+r);this.#r.push(r)}}toJSON(){let e=this.type===null?this.#r.slice().map(r=>typeof r=="string"?r:r.toJSON()):[this.type,...this.#r.map(r=>r.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#s&&this.#c?.type==="!")&&e.push({}),e}isStart(){if(this.#t===this)return!0;if(!this.#c?.isStart())return!1;if(this.#a===0)return!0;let e=this.#c;for(let r=0;r<this.#a;r++){let n=e.#r[r];if(!(n instanceof t&&n.type==="!"))return!1}return!0}isEnd(){if(this.#t===this||this.#c?.type==="!")return!0;if(!this.#c?.isEnd())return!1;if(!this.type)return this.#c?.isEnd();let e=this.#c?this.#c.#r.length:0;return this.#a===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let r=new t(this.type,e);for(let n of this.#r)r.copyIn(n);return r}static#u(e,r,n,o){let s=!1,a=!1,c=-1,l=!1;if(r.type===null){let m=n,h="";for(;m<e.length;){let g=e.charAt(m++);if(s||g==="\\"){s=!s,h+=g;continue}if(a){m===c+1?(g==="^"||g==="!")&&(l=!0):g==="]"&&!(m===c+2&&l)&&(a=!1),h+=g;continue}else if(g==="["){a=!0,c=m,l=!1,h+=g;continue}if(!o.noext&&Lwe(g)&&e.charAt(m)==="("){r.push(h),h="";let v=new t(g,r);m=t.#u(e,v,m,o),r.push(v);continue}h+=g}return r.push(h),m}let u=n+1,d=new t(null,r),p=[],f="";for(;u<e.length;){let m=e.charAt(u++);if(s||m==="\\"){s=!s,f+=m;continue}if(a){u===c+1?(m==="^"||m==="!")&&(l=!0):m==="]"&&!(u===c+2&&l)&&(a=!1),f+=m;continue}else if(m==="["){a=!0,c=u,l=!1,f+=m;continue}if(Lwe(m)&&e.charAt(u)==="("){d.push(f),f="";let h=new t(m,d);d.push(h),u=t.#u(e,h,u,o);continue}if(m==="|"){d.push(f),f="",p.push(d),d=new t(null,r);continue}if(m===")")return f===""&&r.#r.length===0&&(r.#p=!0),d.push(f),f="",r.push(...p,d),u;f+=m}return r.type=null,r.#i=void 0,r.#r=[e.substring(n-1)],u}static fromGlob(e,r={}){let n=new t(null,void 0,r);return t.#u(e,n,0,r),n}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();let e=this.toString(),[r,n,o,s]=this.toRegExpSource();if(!(o||this.#i||this.#n.nocase&&!this.#n.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;let c=(this.#n.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${r}$`,c),{_src:r,_glob:e})}get options(){return this.#n}toRegExpSource(e){let r=e??!!this.#n.dot;if(this.#t===this&&this.#h(),!this.type){let l=this.isStart()&&this.isEnd(),u=this.#r.map(m=>{let[h,g,v,b]=typeof m=="string"?t.#v(m,this.#i,l):m.toRegExpSource(e);return this.#i=this.#i||v,this.#d=this.#d||b,h}).join(""),d="";if(this.isStart()&&typeof this.#r[0]=="string"&&!(this.#r.length===1&&clt.has(this.#r[0]))){let h=alt,g=r&&h.has(u.charAt(0))||u.startsWith("\\.")&&h.has(u.charAt(2))||u.startsWith("\\.\\.")&&h.has(u.charAt(4)),v=!r&&!e&&h.has(u.charAt(0));d=g?slt:v?uB:""}let p="";return this.isEnd()&&this.#t.#s&&this.#c?.type==="!"&&(p="(?:$|\\/)"),[d+u+p,by(u),this.#i=!!this.#i,this.#d]}let n=this.type==="*"||this.type==="+",o=this.type==="!"?"(?:(?!(?:":"(?:",s=this.#l(r);if(this.isStart()&&this.isEnd()&&!s&&this.type!=="!"){let l=this.toString();return this.#r=[l],this.type=null,this.#i=void 0,[l,by(this.toString()),!1,!1]}let a=!n||e||r||!uB?"":this.#l(!0);a===s&&(a=""),a&&(s=`(?:${s})(?:${a})*?`);let c="";if(this.type==="!"&&this.#p)c=(this.isStart()&&!r?uB:"")+Mwe;else{let l=this.type==="!"?"))"+(this.isStart()&&!r&&!e?uB:"")+Owe+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=o+s+l}return[c,by(s),this.#i=!!this.#i,this.#d]}#l(e){return this.#r.map(r=>{if(typeof r=="string")throw new Error("string type in extglob ast??");let[n,o,s,a]=r.toRegExpSource(e);return this.#d=this.#d||a,n}).filter(r=>!(this.isStart()&&this.isEnd())||!!r).join("|")}static#v(e,r,n=!1){let o=!1,s="",a=!1;for(let c=0;c<e.length;c++){let l=e.charAt(c);if(o){o=!1,s+=(llt.has(l)?"\\":"")+l;continue}if(l==="\\"){c===e.length-1?s+="\\\\":o=!0;continue}if(l==="["){let[u,d,p,f]=Nwe(e,c);if(p){s+=u,a=a||d,c+=p-1,r=r||f;continue}}if(l==="*"){n&&e==="*"?s+=Mwe:s+=Owe,r=!0;continue}if(l==="?"){s+=vre,r=!0;continue}s+=ult(l)}return[s,by(e),!!r,a]}};var yre=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/[?*()[\]]/g,"[$&]"):t.replace(/[?*()[\]\\]/g,"\\$&");var Ts=(t,e,r={})=>(WL(e),!r.nocomment&&e.charAt(0)==="#"?!1:new uk(e,r).match(t)),dlt=/^\*+([^+@!?\*\[\(]*)$/,plt=t=>e=>!e.startsWith(".")&&e.endsWith(t),flt=t=>e=>e.endsWith(t),mlt=t=>(t=t.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(t)),hlt=t=>(t=t.toLowerCase(),e=>e.toLowerCase().endsWith(t)),glt=/^\*+\.\*+$/,vlt=t=>!t.startsWith(".")&&t.includes("."),ylt=t=>t!=="."&&t!==".."&&t.includes("."),blt=/^\.\*+$/,_lt=t=>t!=="."&&t!==".."&&t.startsWith("."),xlt=/^\*+$/,Slt=t=>t.length!==0&&!t.startsWith("."),Ilt=t=>t.length!==0&&t!=="."&&t!=="..",Clt=/^\?+([^+@!?\*\[\(]*)?$/,Tlt=([t,e=""])=>{let r=qwe([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},Elt=([t,e=""])=>{let r=jwe([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},wlt=([t,e=""])=>{let r=jwe([t]);return e?n=>r(n)&&n.endsWith(e):r},klt=([t,e=""])=>{let r=qwe([t]);return e?n=>r(n)&&n.endsWith(e):r},qwe=([t])=>{let e=t.length;return r=>r.length===e&&!r.startsWith(".")},jwe=([t])=>{let e=t.length;return r=>r.length===e&&r!=="."&&r!==".."},Vwe=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",Fwe={win32:{sep:"\\"},posix:{sep:"/"}},Rlt=Vwe==="win32"?Fwe.win32.sep:Fwe.posix.sep;Ts.sep=Rlt;var gu=Symbol("globstar **");Ts.GLOBSTAR=gu;var Plt="[^/]",Alt=Plt+"*?",Dlt="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Nlt="(?:(?!(?:\\/|^)\\.).)*?",Llt=(t,e={})=>r=>Ts(r,t,e);Ts.filter=Llt;var hu=(t,e={})=>Object.assign({},t,e),Olt=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return Ts;let e=Ts;return Object.assign((n,o,s={})=>e(n,o,hu(t,s)),{Minimatch:class extends e.Minimatch{constructor(o,s={}){super(o,hu(t,s))}static defaults(o){return e.defaults(hu(t,o)).Minimatch}},AST:class extends e.AST{constructor(o,s,a={}){super(o,s,hu(t,a))}static fromGlob(o,s={}){return e.AST.fromGlob(o,hu(t,s))}},unescape:(n,o={})=>e.unescape(n,hu(t,o)),escape:(n,o={})=>e.escape(n,hu(t,o)),filter:(n,o={})=>e.filter(n,hu(t,o)),defaults:n=>e.defaults(hu(t,n)),makeRe:(n,o={})=>e.makeRe(n,hu(t,o)),braceExpand:(n,o={})=>e.braceExpand(n,hu(t,o)),match:(n,o,s={})=>e.match(n,o,hu(t,s)),sep:e.sep,GLOBSTAR:gu})};Ts.defaults=Olt;var Hwe=(t,e={})=>(WL(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:(0,Bwe.default)(t));Ts.braceExpand=Hwe;var Mlt=(t,e={})=>new uk(t,e).makeRe();Ts.makeRe=Mlt;var Flt=(t,e,r={})=>{let n=new uk(e,r);return t=t.filter(o=>n.match(o)),n.options.nonull&&!t.length&&t.push(e),t};Ts.match=Flt;var Uwe=/[?*]|[+@!]\(.*?\)|\[|\]/,Ult=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),uk=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,r={}){WL(e),r=r||{},this.options=r,this.pattern=e,this.platform=r.platform||Vwe,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!r.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!r.nonegate,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=r.windowsNoMagicRoot!==void 0?r.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let r of e)if(typeof r!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,r=this.options;if(!r.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],r.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,this.globSet);let n=this.globSet.map(s=>this.slashSplit(s));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let o=this.globParts.map((s,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let l=s[0]===""&&s[1]===""&&(s[2]==="?"||!Uwe.test(s[2]))&&!Uwe.test(s[3]),u=/^[a-z]:/i.test(s[0]);if(l)return[...s.slice(0,4),...s.slice(4).map(d=>this.parse(d))];if(u)return[s[0],...s.slice(1).map(d=>this.parse(d))]}return s.map(l=>this.parse(l))});if(this.debug(this.pattern,o),this.set=o.filter(s=>s.indexOf(!1)===-1),this.isWindows)for(let s=0;s<this.set.length;s++){let a=this.set[s];a[0]===""&&a[1]===""&&this.globParts[s][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)e[n][o]==="**"&&(e[n][o]="*");let{optimizationLevel:r=1}=this.options;return r>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):r>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(r=>{let n=-1;for(;(n=r.indexOf("**",n+1))!==-1;){let o=n;for(;r[o+1]==="**";)o++;o!==n&&r.splice(n,o-n)}return r})}levelOneOptimize(e){return e.map(r=>(r=r.reduce((n,o)=>{let s=n[n.length-1];return o==="**"&&s==="**"?n:o===".."&&s&&s!==".."&&s!=="."&&s!=="**"?(n.pop(),n):(n.push(o),n)},[]),r.length===0?[""]:r))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let r=!1;do{if(r=!1,!this.preserveMultipleSlashes){for(let o=1;o<e.length-1;o++){let s=e[o];o===1&&s===""&&e[0]===""||(s==="."||s==="")&&(r=!0,e.splice(o,1),o--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(r=!0,e.pop())}let n=0;for(;(n=e.indexOf("..",n+1))!==-1;){let o=e[n-1];o&&o!=="."&&o!==".."&&o!=="**"&&(r=!0,e.splice(n-1,2),n-=2)}}while(r);return e.length===0?[""]:e}firstPhasePreProcess(e){let r=!1;do{r=!1;for(let n of e){let o=-1;for(;(o=n.indexOf("**",o+1))!==-1;){let a=o;for(;n[a+1]==="**";)a++;a>o&&n.splice(o+1,a-o);let c=n[o+1],l=n[o+2],u=n[o+3];if(c!==".."||!l||l==="."||l===".."||!u||u==="."||u==="..")continue;r=!0,n.splice(o,1);let d=n.slice(0);d[o]="**",e.push(d),o--}if(!this.preserveMultipleSlashes){for(let a=1;a<n.length-1;a++){let c=n[a];a===1&&c===""&&n[0]===""||(c==="."||c==="")&&(r=!0,n.splice(a,1),a--)}n[0]==="."&&n.length===2&&(n[1]==="."||n[1]==="")&&(r=!0,n.pop())}let s=0;for(;(s=n.indexOf("..",s+1))!==-1;){let a=n[s-1];if(a&&a!=="."&&a!==".."&&a!=="**"){r=!0;let l=s===1&&n[s+1]==="**"?["."]:[];n.splice(s-1,2,...l),n.length===0&&n.push(""),s-=2}}}}while(r);return e}secondPhasePreProcess(e){for(let r=0;r<e.length-1;r++)for(let n=r+1;n<e.length;n++){let o=this.partsMatch(e[r],e[n],!this.preserveMultipleSlashes);if(o){e[r]=[],e[n]=o;break}}return e.filter(r=>r.length)}partsMatch(e,r,n=!1){let o=0,s=0,a=[],c="";for(;o<e.length&&s<r.length;)if(e[o]===r[s])a.push(c==="b"?r[s]:e[o]),o++,s++;else if(n&&e[o]==="**"&&r[s]===e[o+1])a.push(e[o]),o++;else if(n&&r[s]==="**"&&e[o]===r[s+1])a.push(r[s]),s++;else if(e[o]==="*"&&r[s]&&(this.options.dot||!r[s].startsWith("."))&&r[s]!=="**"){if(c==="b")return!1;c="a",a.push(e[o]),o++,s++}else if(r[s]==="*"&&e[o]&&(this.options.dot||!e[o].startsWith("."))&&e[o]!=="**"){if(c==="a")return!1;c="b",a.push(r[s]),o++,s++}else return!1;return e.length===r.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,r=!1,n=0;for(let o=0;o<e.length&&e.charAt(o)==="!";o++)r=!r,n++;n&&(this.pattern=e.slice(n)),this.negate=r}matchOne(e,r,n=!1){let o=this.options;if(this.isWindows){let g=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),v=!g&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),b=typeof r[0]=="string"&&/^[a-z]:$/i.test(r[0]),_=!b&&r[0]===""&&r[1]===""&&r[2]==="?"&&typeof r[3]=="string"&&/^[a-z]:$/i.test(r[3]),x=v?3:g?0:void 0,S=_?3:b?0:void 0;if(typeof x=="number"&&typeof S=="number"){let[I,w]=[e[x],r[S]];I.toLowerCase()===w.toLowerCase()&&(r[S]=I,S>x?r=r.slice(S):x>S&&(e=e.slice(x)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var a=0,c=0,l=e.length,u=r.length;a<l&&c<u;a++,c++){this.debug("matchOne loop");var d=r[c],p=e[a];if(this.debug(r,d,p),d===!1)return!1;if(d===gu){this.debug("GLOBSTAR",[r,d,p]);var f=a,m=c+1;if(m===u){for(this.debug("** at the end");a<l;a++)if(e[a]==="."||e[a]===".."||!o.dot&&e[a].charAt(0)===".")return!1;return!0}for(;f<l;){var h=e[f];if(this.debug(`
globstar while`,e,f,r,m,h),this.matchOne(e.slice(f),r.slice(m),n))return this.debug("globstar found match!",f,l,h),!0;if(h==="."||h===".."||!o.dot&&h.charAt(0)==="."){this.debug("dot detected!",e,f,r,m);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,f,r,m),f===l))}let g;if(typeof d=="string"?(g=p===d,this.debug("string match",d,p,g)):(g=d.test(p),this.debug("pattern match",d,p,g)),!g)return!1}if(a===l&&c===u)return!0;if(a===l)return n;if(c===u)return a===l-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return Hwe(this.pattern,this.options)}parse(e){WL(e);let r=this.options;if(e==="**")return gu;if(e==="")return"";let n,o=null;(n=e.match(xlt))?o=r.dot?Ilt:Slt:(n=e.match(dlt))?o=(r.nocase?r.dot?hlt:mlt:r.dot?flt:plt)(n[1]):(n=e.match(Clt))?o=(r.nocase?r.dot?Elt:Tlt:r.dot?wlt:klt)(n):(n=e.match(glt))?o=r.dot?ylt:vlt:(n=e.match(blt))&&(o=_lt);let s=lk.fromGlob(e,this.options).toMMPattern();return o&&typeof s=="object"&&Reflect.defineProperty(s,"test",{value:o}),s}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let r=this.options,n=r.noglobstar?Alt:r.dot?Dlt:Nlt,o=new Set(r.nocase?["i"]:[]),s=e.map(l=>{let u=l.map(d=>{if(d instanceof RegExp)for(let p of d.flags.split(""))o.add(p);return typeof d=="string"?Ult(d):d===gu?gu:d._src});return u.forEach((d,p)=>{let f=u[p+1],m=u[p-1];d!==gu||m===gu||(m===void 0?f!==void 0&&f!==gu?u[p+1]="(?:\\/|"+n+"\\/)?"+f:u[p]=n:f===void 0?u[p-1]=m+"(?:\\/|"+n+")?":f!==gu&&(u[p-1]=m+"(?:\\/|\\/"+n+"\\/)"+f,u[p+1]=gu))}),u.filter(d=>d!==gu).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];s="^"+a+s+c+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...o].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,r=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;let n=this.options;this.isWindows&&(e=e.split("\\").join("/"));let o=this.slashSplit(e);this.debug(this.pattern,"split",o);let s=this.set;this.debug(this.pattern,"set",s);let a=o[o.length-1];if(!a)for(let c=o.length-2;!a&&c>=0;c--)a=o[c];for(let c=0;c<s.length;c++){let l=s[c],u=o;if(n.matchBase&&l.length===1&&(u=[a]),this.matchOne(u,l,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return Ts.defaults(e).Minimatch}};Ts.AST=lk;Ts.Minimatch=uk;Ts.escape=yre;Ts.unescape=by;var Gwe="non-git-file",dB=class{constructor(e,r,n,o,s,a,c){this._gitService=e;this._logService=r;this._fetcherService=n;this._authService=o;this._domainService=s;this._fileSystemService=a;this._workspaceService=c;this._contentExclusionCache=new Map;this._contentExclusionFetchPromise=null;this._ignoreGlobResultCache=new Nr;this._ignoreRegexResultCache=new Map;this._lastRuleFetch=0;this._disposables=[];this._contentExclusionCache.set(Gwe,{patterns:[],ifAnyMatch:[],ifNoneMatch:[],repoRootPath:""}),this._disposables.push(this._gitService.onDidCloseRepository(l=>{let u=this.getRepositoryInfo(l);if(u)for(let d of u.fetchUrls)this._contentExclusionCache.delete(d)}))}async isIgnored(e){if(this._ignoreGlobResultCache.has(e)&&!this.isRegexContextExclusionsEnabled||this._ignoreGlobResultCache.get(e))return this._ignoreGlobResultCache.get(e)??!1;this._contentExclusionFetchPromise&&await this._contentExclusionFetchPromise;let r=this._gitService.getRepository(e)??await this._gitService.openRepository(e),n=this.getRepositoryInfo(r);Date.now()-this._lastRuleFetch>30*60*1e3&&await this.makeContentExclusionRequest(),n||(n={repoRootPath:"",fetchUrls:[Gwe]});let o=e.path.replace(n.repoRootPath,"");this.shouldFetchContentExclusionRules(n)&&await this.makeContentExclusionRequest();let s={nocase:!0,matchBase:!0,nonegate:!0,dot:!0};for(let{patterns:l}of this._contentExclusionCache.values())for(let u of l)if(Ts(o,u,s)||Ts(e.path,u,s))return this._logService.public.debug(`File ${e.path} is ignored by content exclusion rule ${u}`),this._ignoreGlobResultCache.set(e,!0),!0;let a="",c="";for(let l of n.fetchUrls){let{ifAnyMatch:u,ifNoneMatch:d}=this._contentExclusionCache.get(l)??{ifAnyMatch:[],ifNoneMatch:[]};if((u.length>0||d.length>0)&&!a)try{if(a=await $he(this._fileSystemService,this._workspaceService,e),c=await gC(a),this._ignoreRegexResultCache.has(c))return this._ignoreRegexResultCache.get(c)??!1}catch{return!0}if(u.length>0&&a&&u.some(p=>p.test(a)))return this._logService.public.debug(`File ${e.path} is ignored by content exclusion rule ifAnyMatch`),this._ignoreRegexResultCache.set(c,!0),!0;if(d.length>0&&a&&!d.some(p=>p.test(a)))return this._logService.public.debug(`File ${e.path} is ignored by content exclusion rule ifNoneMatch`),this._ignoreRegexResultCache.set(c,!0),!0}return this._ignoreGlobResultCache.set(e,!1),this._ignoreRegexResultCache.set(c,!1),!1}get isRegexContextExclusionsEnabled(){return[...this._contentExclusionCache.values()].some(({ifAnyMatch:e,ifNoneMatch:r})=>e.length>0||r.length>0)}async loadRepos(e){(await Promise.all(e.map(o=>this._gitService.openRepository(o)))).map(o=>this.shouldFetchContentExclusionRules(this.getRepositoryInfo(o))).some(o=>o)&&await this.makeContentExclusionRequest()}async asMinimatchPatterns(){return await this._contentExclusionFetchPromise,Array.from(this._contentExclusionCache.values()).flatMap(({patterns:r})=>r)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[],this._contentExclusionCache.clear()}shouldFetchContentExclusionRules(e){if(!e)return!1;let r=!1;for(let n of e?.fetchUrls??[])this._contentExclusionCache.has(n)||(r=!0,this._contentExclusionCache.set(n,{patterns:[],ifAnyMatch:[],ifNoneMatch:[],repoRootPath:e.repoRootPath}));return r}async makeContentExclusionRequest(){this._contentExclusionFetchPromise&&await this._contentExclusionFetchPromise;try{this._contentExclusionFetchPromise=this._contentExclusionRequest(),await this._contentExclusionFetchPromise}catch{this._contentExclusionFetchPromise=null}}async _contentExclusionRequest(){this._ignoreGlobResultCache.clear();let e=Date.now(),r=this._fetcherService,n=(await this._authService.getAnyGitHubSession({silent:!0}))?.accessToken,o=Array.from(this._contentExclusionCache.keys()),s=async a=>{let c=a.join(","),l=new URL(this._domainService.contentExclusionURL);a.length!==0&&l.searchParams.set("repos",c),l.searchParams.set("scope","repo");let u=await r.fetch(l.toString(),{headers:{Authorization:`token ${n}`}});if(!u.ok){this._logService.public.error(`Failed to fetch content exclusion rules: ${u?.statusText}`);return}let d=await u.json();for(let p=0;p<d.length;p++){let f=d[p].rules.map(_=>_.paths).flat(),m=Dr(d[p].rules.map(_=>_.ifAnyMatch).flat()).map(_=>zwe(_)),h=Dr(d[p].rules.map(_=>_.ifNoneMatch).flat()).map(_=>zwe(_)),g=a[p],v=this._contentExclusionCache.get(g)?.repoRootPath;if(v===void 0){this._logService.public.error(`Failed to find repo root for ${g}, skipping exclusion rules`);continue}let b={patterns:Blt(f,v),ifAnyMatch:m,ifNoneMatch:h,repoRootPath:v};this._contentExclusionCache.set(g,b),this._logService.public.trace(`Fetched content exclusion rules for ${g}: ${JSON.stringify(b)}`)}};o.length===0&&await s([]);for(let a=0;a<o.length;a+=10){let c=o.slice(a,a+10);await s(c)}this._lastRuleFetch=Date.now(),this._logService.public.info(`Fetched content exclusion rules in ${Date.now()-e}ms`),this._contentExclusionFetchPromise=null}getRepositoryInfo(e){if(!e||!e.remoteFetchUrls)return;let r=Dr(e.remoteFetchUrls.map(n=>{if(n)try{return O0e(n)}catch{return}}));return{repoRootPath:e.rootUri.path,fetchUrls:r}}};function Blt(t,e){return t.map(r=>r.startsWith("/")?`${e}${r}`:r)}function zwe(t){if(!t.startsWith("/")&&!t.endsWith("/"))return new RegExp(t);let e=t.slice(1,t.lastIndexOf("/")),r=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,r)}var pB=".copilotignore",fB=class{constructor(e,r,n,o,s,a,c,l){this._gitService=e;this._logService=r;this._fetcherService=n;this._authService=o;this._workspaceService=s;this._domainService=a;this.searchService=c;this.fs=l;this._copilotIgnoreFiles=new lB;this._copilotIgnoreEnabled=!1;this._onDidChangeCopilotIgnoreEnablement=new Yt;this._disposables=[];this.onDidChangeCopilotIgnoreEnablement=this._onDidChangeCopilotIgnoreEnablement.event;this._disposables.push(this._onDidChangeCopilotIgnoreEnablement),this._disposables.push(this._authService.onDidAuthenticationChange(()=>{let u=this._authService.copilotToken?.isCopilotIgnoreEnabled()??!1;this._copilotIgnoreEnabled!==u&&this._onDidChangeCopilotIgnoreEnablement.fire(u),this._copilotIgnoreEnabled=u,this._copilotIgnoreEnabled===!1&&this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._copilotIgnoreEnabled===!0&&!this._remoteContentExclusions&&(this._remoteContentExclusions=new dB(this._gitService,this._logService,this._fetcherService,this._authService,this._domainService,this.fs,this._workspaceService))}))}dispose(){this._disposables.forEach(e=>e.dispose()),this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._disposables=[]}get isEnabled(){return this._copilotIgnoreEnabled}get isRegexExclusionsEnabled(){return this._remoteContentExclusions?.isRegexContextExclusionsEnabled??!1}async isCopilotIgnored(e){let r=!1;return this._copilotIgnoreEnabled&&(r=this._copilotIgnoreFiles.isIgnored(e)||await(this._remoteContentExclusions?.isIgnored(e)??!1)),r}async asMinimatchPattern(){if(!this._copilotIgnoreEnabled)return;let e=[],r=(await this.searchService.findFiles("**/.git/HEAD",{useDefaultExcludes:!1,useDefaultSearchExcludes:!1})).map(o=>He.joinPath(o,"..",".."));await this._remoteContentExclusions?.loadRepos(r),e.push(await this._remoteContentExclusions?.asMinimatchPatterns()??[]),e.push(this._copilotIgnoreFiles.asMinimatchPatterns());let n=e.flat();if(n.length!==0)return n.length===1?n[0]:`{${n.join(",")}}`}init(){return this._init??=(async()=>{for(let e of this._workspaceService.getWorkspaceFolders())await this.addWorkspace(e)})(),this._init}trackIgnoreFile(e,r,n){r.path.endsWith(pB)&&this._copilotIgnoreFiles.setIgnoreFile(e,r,n)}removeIgnoreFile(e){e.path.endsWith(pB)&&this._copilotIgnoreFiles.removeIgnoreFile(e)}removeWorkspace(e){this._copilotIgnoreFiles.removeWorkspace(e)}isIgnoreFile(e){return!!e.path.endsWith(pB)}async addWorkspace(e){if(e.scheme!=="file")return;let r=await this.searchService.findFilesWithDefaultExcludes(new fC(e,`${pB}`),void 0,Wt.None);for(let n of r){let o=(await this.fs.readFile(n)).toString();this.trackIgnoreFile(e,n,o)}}};var dk=class extends fB{constructor(e,r,n,o,s,a,c){super(e,n,o,s,a,c,new ck,new nk),this.installListeners()}installListeners(){this._disposables.push(Nh.workspace.onDidChangeWorkspaceFolders(e=>{for(let r of e.removed)this.removeWorkspace(r.uri);for(let r of e.added)this.addWorkspace(r.uri)})),this._disposables.push(Nh.workspace.onDidSaveTextDocument(async e=>{if(this.isIgnoreFile(e.uri)){let r=(await Nh.workspace.fs.readFile(e.uri)).toString(),n=Nh.workspace.getWorkspaceFolder(e.uri);this.trackIgnoreFile(n?.uri,e.uri,r)}}),Nh.workspace.onDidDeleteFiles(e=>{for(let r of e.files)this.removeIgnoreFile(r)}),Nh.workspace.onDidRenameFiles(async e=>{for(let r of e.files)if(this.isIgnoreFile(r.newUri)){let n=(await Nh.workspace.fs.readFile(r.newUri)).toString();this.removeIgnoreFile(r.oldUri);let o=Nh.workspace.getWorkspaceFolder(r.newUri);this.trackIgnoreFile(o?.uri,r.newUri,n)}}))}};dk=E([y(0,Ho),y(1,ro),y(2,ie),y(3,Kr),y(4,Tt),y(5,qe),y(6,en)],dk);var bre=q(require("vscode"));var mB=class extends NC{constructor(){super(...arguments);this.onDidChangeDiagnostics=bre.languages.onDidChangeDiagnostics}getDiagnostics(r){return bre.languages.getDiagnostics(r)}};var _y=q(require("vscode")),hB=class{constructor(){}async getDefinitions(e,r){return await _y.commands.executeCommand("vscode.executeDefinitionProvider",e,r)}async getImplementations(e,r){return await _y.commands.executeCommand("vscode.executeImplementationProvider",e,r)}async getReferences(e,r){return await _y.commands.executeCommand("vscode.executeReferenceProvider",e,r)}async getWorkspaceSymbols(e){return await _y.commands.executeCommand("vscode.executeWorkspaceSymbolProvider",e)}async getDocumentSymbols(e){return await _y.commands.executeCommand("vscode.executeDocumentSymbolProvider",e)}getDiagnostics(e){return _y.languages.getDiagnostics(e)}};var $we=q(require("stream/consumers"));var YL=require("stream");var _re=class extends YL.Transform{constructor(r){super();this.abortController=r;this.running=!0}_transform(r,n,o){this.running&&this.push(r),o()}abort(){this.running=!1,this.push(null),this.abortController.abort()}},gB=class t{constructor(e){this.fetchApi=e}static create(){let e=d7({rejectUnauthorized:!1,alpnProtocols:["h2"]});return new t(e)}async close(){await this.fetchApi.reset()}async fetch(e,r,n){r.body.stream=!0;try{return await this.fetchOrThrow(e,r,n)}catch(o){return o.code==="ECONNRESET"||o.code==="ETIMEDOUT"||o.code==="ERR_HTTP2_INVALID_SESSION"||o.message==="ERR_HTTP2_GOAWAY_SESSION"||o.code==="429"?Cc("model_overloaded",o.message):Cc("model_error",o.message)}}async fetchOrThrow(e,r,n){if(n.isCancellationRequested)return Cc("cancelled");let o=new p7,s=new _re(o),a=n.onCancellationRequested(()=>{s.abort()});try{let c={body:r.body,headers:jlt(r.headers),signal:o.signal,cache:"no-cache",method:"POST"},l=await this.fetchApi.fetch(e,c),u=l.body?new YL.Readable().wrap(l.body):new YL.Readable;return u.on("error",d=>{if(!(d instanceof QN||d.name==="AbortError")){if(!(d.message==="ERR_HTTP2_STREAM_ERROR"||d.code==="ERR_HTTP2_STREAM_ERROR"))throw d}}),u.on("close",()=>a.dispose()),eE({status:l.status,statusText:l.statusText,headers:qlt(l.headers),body:u.pipe(s)})}catch(c){throw a.dispose(),c}}};function qlt(t){let e={};for(let[r,n]of t)e[r]=n;return e}function jlt(t){let e=new Z1e;for(let r in t)e.set(r,t[r]);return e}var xre=require("stream");var vB=class extends xre.Transform{constructor(r){super({readableObjectMode:!0,writableObjectMode:!0});this.completionIndex=r}_transform(r,n,o){r.completionIndex===this.completionIndex&&this.push(r),o()}},yB=class t extends xre.Transform{constructor(){super({readableObjectMode:!0,writableObjectMode:!1});this.buf="";this.totalTokens=0;this.aborted=!1}_transform(r,n,o){if(this.aborted){o();return}this.buf+=r.toString("utf8");let s=this.buf.split(`
`),a=null;for(let c=0;c<s.length-1;c++){let l=s[c];if(l.trim()!=="data: [DONE]"&&l.startsWith("data: ")){let u=JSON.parse(l.substring(6));if(u.error){this.push(null),this.aborted=!0,o();return}for(let d of u.choices){let p=d.index;d.text=t.replaceUnicode(d.text);let f=[];if(d.logprobs!==null)for(let m=0;m<d.logprobs.top_logprobs.length;m++){let[h,g]=Object.entries(d.logprobs.top_logprobs[m]).reduce((_,x)=>x[1]>_[1]?x:_,["",-1/0]),v=Hlt(d.logprobs.top_logprobs,h,m),b={token:h,logProb:g,topToken:v};f.push(b)}if(f.forEach(m=>{m.token=t.replaceBytes(t.replaceUnicode(m.token)),m.topToken&&(m.topToken=t.replaceBytes(t.replaceUnicode(m.topToken)))}),f.length===0){let m={completionId:u.id,created:u.created,completionIndex:p,text:d.text};this.push(m)}else if(f.length===1){let m={completionId:u.id,created:u.created,completionIndex:p,text:d.text,...f[0]};this.push(m)}else if(f.map(m=>m.token).join("").startsWith(d.text)){let m="",h=0;for(;!m.startsWith(d.text);){let g={completionId:u.id,created:u.created,completionIndex:p,text:f[h].token,...f[h]};this.push(g),m+=f[h].token,h++}}else a=new Error("Unhandled case "+l)}}}s.length===0?this.buf="":this.buf=s[s.length-1],o(a,null)}static replaceUnicode(r){return r.replace(/\\u([0-9a-fA-F]{4})/g,function(n,o){return String.fromCharCode(parseInt(o,16))})}static replaceBytes(r){if(!r.startsWith("bytes:"))return r;let n=[],o=6,s=new TextEncoder;for(;o<r.length;)if(r.slice(o,o+3)==="\\\\x")n.push(parseInt(r.slice(o+3,o+5),16)),o+=5;else if(r.slice(o,o+2)==="\\x")n.push(parseInt(r.slice(o+2,o+4),16)),o+=4;else{let a=s.encode(r.slice(o,o+1));for(let c of a)n.push(c);o+=1}return new TextDecoder("utf8",{fatal:!1}).decode(new Uint8Array(n))}};function Hlt(t,e,r){if(t)return t[r]?Object.keys(t[r])[0]:e}var Wwe=q(require("assert"));var Glt="https://copilot-proxy.githubusercontent.com/v1/engines/copilot-chat-fine-raw/completions",Sre={name:"fine_tuned",apiKey:"",apiKeyHeaderName:void 0,encoding:"cl100k_base",is_default:!0,params:{max_tokens:1e3,temperature:0,top_p:.5,frequency_penalty:0,presence_penalty:0,stop:[`
name:`],model:void 0,logprobs:1},url:Glt};var pk=class{constructor(e,r,n,o,s){this.instantiationService=r;this.authService=n;this.envService=o;this.tokenizerProvider=s;if(e!==void 0){let a=this.instantiationService.createInstance(e);this.state={fetcher:a}}}dispose(){this.state&&this.state.fetcher.close()}getHeaders(e,r){return{"Content-Type":"application/json","x-policy-id":"nil",Authorization:"Bearer "+r,"X-Request-Id":e,"VScode-SessionId":this.envService.sessionId,"VScode-MachineId":this.envService.machineId,...this.envService.getEditorVersionHeaders()}}initState(){this.state||(this.state={fetcher:gB.create()})}tokenLength(e){return(0,Wwe.default)(Sre.encoding==="cl100k_base","Only cl100k_base is expected"),this.tokenizerProvider.cl100kTokenizer.tokenLength(e)}async fetch(e,r,n,o){if(o.isCancellationRequested)return Cc("cancelled");let s=new Uo(o),a={model:Sre};if(this.initState(),!this.state)return Cc("not-registered");let c={prompt:e,...a.model.params,stop:r},l=a.model.apiKey.length>0?a.model.apiKey:(await this.authService.getCopilotToken()).token,u=await this.state.fetcher.fetch(a.model.url,{headers:this.getHeaders(n,l),body:c},s.token);if(BN(u))return s.dispose(),u.reason==="model_error"&&u.message==="The operation was aborted."?Cc("cancelled"):u;if(u.result.status===200)return u.result.body.on("close",()=>{s.cancel(),s.dispose()}),eE(u.result.body.pipe(new yB).pipe(new vB(0)));{s.dispose();let d=await $we.text(u.result.body);return d.match(/This model's maximum context length is /)?Cc("context-window-exceeded",d):d.match(/Access denied due to invalid subscription key or wrong API endpoint/)?Cc("invalid-api-key",d):d.match(/exceeded call rate limit/)?Cc("exceeded-rate-limit",d):Cc("not-200-status",[u.result.status.toString(),u.result.statusText,d].join(" "))}}};pk=E([y(1,j),y(2,Tt),y(3,gt),y(4,_r)],pk);var fk=class{constructor(e,r,n,o){this._logService=e;this._instantiationService=o;this._fetcher=this._getFetcher(n,r)}_getFetcher(e,r){if(e.getConfig(le.DebugUseElectronFetcher)){let s=aE.create(r);if(s)return this._logService.public.info("Using the Electron fetcher."),s;this._logService.public.info("Can't use the Electron fetcher in this environment.")}return e.getConfig(le.DebugUseNodeFetcher)?(this._logService.public.info("Using the Node fetcher."),new sE(r)):(this._logService.public.info("Using the Helix fetcher."),this._instantiationService.createInstance(ry))}fetch(e,r){return this._fetcher.fetch(e,r)}disconnectAll(){return this._fetcher.disconnectAll()}makeAbortController(){return this._fetcher.makeAbortController()}isAbortError(e){return this._fetcher.isAbortError(e)}isDNSLookupFailedError(e){return this._fetcher.isDNSLookupFailedError(e)}isFetcherError(e){return this._fetcher.isFetcherError(e)}getUserMessageForFetcherError(e){return this._fetcher.getUserMessageForFetcherError(e)}};fk=E([y(0,ie),y(1,gt),y(2,he),y(3,j)],fk);var Ire=q(require("vscode")),bB=class{async loadKerberos(){try{return require(`${Ire.env.appRoot}/node_modules.asar/kerberos`)}catch{}try{return require(`${Ire.env.appRoot}/node_modules/kerberos`)}catch{}}};var Kwe=q(require("os")),Cre=q(require("vscode")),_B=class{async loadCaCerts(){let e=await this.loadBuiltInWinCAModule(),r=new Set,n=new e.Crypt32;try{let o;for(;o=n.next();)r.add(zlt(o))}finally{n.done()}return Array.from(r)}async loadBuiltInWinCAModule(){try{return require(`${Cre.env.appRoot}/node_modules.asar/@vscode/windows-ca-certs`)}catch{}try{return require(`${Cre.env.appRoot}/node_modules/@vscode/windows-ca-certs`)}catch{}}};function zlt(t){let e=["-----BEGIN CERTIFICATE-----"],r=t.toString("base64");for(let n=0;n<r.length;n+=64)e.push(r.substr(n,64));return e.push("-----END CERTIFICATE-----",""),e.join(Kwe.EOL)}var If=require("vscode");var Ywe=require("vscode");var xB=class{constructor(){this._onDidChangeNotebookCellExecutionStateEmitter=new Yt;this.onDidChangeNotebookCellExecutionState=this._onDidChangeNotebookCellExecutionStateEmitter.event;this._disposables=[];this._cellExecution=new WeakMap;this._disposables.push(Ywe.workspace.onDidChangeNotebookDocument(e=>{for(let r of e.cellChanges)r.executionSummary&&(r.executionSummary.success===void 0?this._cellExecution.has(r.cell)||(this._cellExecution.set(r.cell,!0),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:r.cell,state:2})):(this._cellExecution.delete(r.cell),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:r.cell,state:1})))}))}dispose(){this._disposables.forEach(e=>e.dispose())}};var mk=class{constructor(e,r){this._configurationService=e;this._experimentationService=r;this._cellExecution=new Map;this._cellSymbols=new WeakMap;this._executionService=new xB;this._disposables=[];this._isVariableFilteringEnabled=!1;this._isVariableFilteringEnabled=this._experimentationService.getTreatmentVariable("vscode","copilotchat.notebookVariableFiltering")||this._configurationService.getConfig(le.NotebookVariableFilteringEnabled),this._registerExecutionListener()}get isVariableFilteringEnabled(){return this._isVariableFilteringEnabled}_hasJupyterExtension(){return If.extensions.getExtension("ms-toolsai.jupyter")?.isActive}async getVariables(e){if(!this._hasJupyterExtension())try{let r=await If.commands.executeCommand("vscode.executeNotebookVariableProvider",e);if(r&&Array.isArray(r)){let n=r.map(this._convertResult);return this._filterVariables(e,n)}return[]}catch{return[]}try{let r=await If.commands.executeCommand("jupyter.listVariables",e);if(r&&Array.isArray(r)){let n=r.map(this._convertResult);return this._filterVariables(e,n)}return[]}catch{return[]}}_convertResult(e){return"variable"in e?e:{variable:e,hasNamedChildren:!1,indexedChildrenCount:0}}_filterVariables(e,r){if(!this.isVariableFilteringEnabled)return r;let n=new Set;return If.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString())?.getCells().forEach(o=>{let s=this._cellSymbols.get(o);s&&s.forEach(a=>n.add(a.name))}),r.filter(o=>n.has(o.variable.name))}async getPipPackages(e){if(!this._hasJupyterExtension())return[];try{return await If.commands.executeCommand("jupyter.listPipPackages",e)}catch{return[]}}setVariables(e,r){}_registerExecutionListener(){this._disposables.push(this._executionService.onDidChangeNotebookCellExecutionState(e=>{let r=e.cell,o=r.notebook.uri.toString(),s=this._cellExecution.get(o);s||(s=[],this._cellExecution.set(o,s));let a=s.findIndex(c=>c.cell===r);a!==-1&&s.splice(a,1),s.push({cell:r,executionCount:r.executionSummary?.executionOrder})})),this._disposables.push(If.workspace.onDidChangeNotebookDocument(e=>{if(this.isVariableFilteringEnabled){for(let r of e.cellChanges)r.executionSummary&&r.executionSummary.success&&If.commands.executeCommand("vscode.executeDocumentSymbolProvider",r.cell.document.uri).then(o=>{this._cellSymbols.set(r.cell,o||[])}),r.document&&this._cellSymbols.delete(r.cell);for(let r of e.contentChanges)r.removedCells.forEach(n=>{this._cellSymbols.delete(n)})}}))}getCellExecutions(e){return this._cellExecution.get(e.toString())?.map(r=>r.cell)||[]}dispose(){this._disposables.forEach(e=>e.dispose())}};mk=E([y(0,he),y(1,Lt)],mk);var Qwe=ne("IUrlOpener"),SB=class{constructor(){this.openedUrls=[]}open(e){this.openedUrls.push(e)}};var CB=q(require("vscode")),IB=class{async open(e){await CB.commands.executeCommand("vscode.open",CB.Uri.parse(e))}};var Rke=q(require("path"));var Nre={};Pn(Nre,{_dispose:()=>Jwe,_findLastTest:()=>yke,_getCallExpressions:()=>rut,_getClassDeclarations:()=>iut,_getClassReferences:()=>cut,_getCoarseParentScope:()=>fut,_getDocumentableNodeIfOnIdentifier:()=>hke,_getFineScopes:()=>hut,_getFixSelectionOfInterest:()=>mut,_getFunctionBodies:()=>put,_getFunctionDefinitions:()=>nut,_getNodeMatchingSelection:()=>zx,_getNodeToDocument:()=>mke,_getNodeToExplain:()=>gut,_getSemanticChunkNames:()=>dut,_getSemanticChunkTree:()=>uut,_getStructure:()=>Eut,_getSymbols:()=>lut,_getTestableNode:()=>gke,_getTestableNodes:()=>vke,_getTypeDeclarations:()=>sut,_getTypeReferences:()=>aut,getBlockNameTree:()=>Eke});var QL=class{constructor(e,r){this.syntaxTreeRoot=r;this.roots=[];this.formTree(e)}formTree(e){e.sort((s,a)=>s.mainBlock.startIndex-a.mainBlock.startIndex||s.mainBlock.endIndex-a.mainBlock.endIndex);let r=[],n=()=>r[r.length-1],o=(s,a)=>s.mainBlock.startIndex===a.mainBlock.startIndex&&s.mainBlock.endIndex===a.mainBlock.endIndex;for(let s of e){let a={info:s,children:[]},c=n();if(!c){this.roots.push(a),r.push(a);continue}if(!o(c.info,s)){for(;c&&!En.doesContain(c.info.mainBlock,s.mainBlock);)r.pop(),c=n();c?c.children.push(a):this.roots.push(a),r.push(a)}}}};var XL=q(require("path")),$lt=TB(),EB=class{constructor(){this.loadedLanguagesCache=new Map}loadLanguage(e){return this.loadedLanguagesCache.has(e)||this.loadedLanguagesCache.set(e,this._doLoadLanguage(e)),this.loadedLanguagesCache.get(e)}_doLoadLanguage(e){let n=`tree-sitter-${e==="csharp"?"c-sharp":e}.wasm`,o=XL.basename(__dirname)==="dist"?XL.resolve(__dirname,n):XL.resolve(__dirname,"../../../../dist",n);return $lt.Language.load(o)}};var Xwe=TB(),wB=class t{static{this.INSTANCE=new t}static{this.CACHE_SIZE_PER_LANGUAGE=5}constructor(){this.caches=new Map,this.languageLoader=new EB,this._parser=null}get parser(){return this._parser||(this._parser=new Xwe),this._parser}async parse(e,r){await Xwe.init();let n=this.getParseTreeCache(e),o=n.get(r);if(o)return o.createReference();let s=await this.languageLoader.loadLanguage(e);if(this.parser.setLanguage(s),o=n.get(r),o)return o.createReference();let a=this.parser.parse(r);return o=new Tre(a),n.put(r,o),o.createReference()}dispose(){this._parser&&(this.parser.delete(),this._parser=null);for(let e of this.caches.values())e.dispose()}getParseTreeCache(e){let r=this.caches.get(e);return r||(r=new LF(t.CACHE_SIZE_PER_LANGUAGE),this.caches.set(e,r)),r}},Tre=class{constructor(e){this._tree=new wre(e)}dispose(){this._tree.deref()}createReference(){return new Ere(this._tree)}},Ere=class{constructor(e){this._parseTree=e;this._parseTree.ref()}get tree(){return this._parseTree.tree}dispose(){this._parseTree.deref()}},wre=class{constructor(e){this._tree=e;this._refCount=1}get tree(){if(this._refCount===0)throw new Error("Cannot access disposed RefCountedParseTree");return this._tree}ref(){if(this._refCount===0)throw new Error("Cannot ref disposed RefCountedParseTree");this._refCount++}deref(){if(this._refCount===0)throw new Error("Cannot deref disposed RefCountedParseTree");this._refCount--,this._refCount===0&&this._tree.delete()}};function Jwe(){wB.INSTANCE.dispose()}function pi(t,e){return wB.INSTANCE.parse(t,e)}var kre=class{constructor(e){this.language=e;this.map=new Map}getQuery(e){return this.map.has(e)||this.map.set(e,this.language.query(e)),this.map.get(e)}},Rre=class t{constructor(){this.map=new Map}static{this.INSTANCE=new t}getQuery(e,r){return this.map.has(e)||this.map.set(e,new kre(e)),this.map.get(e).getQuery(r)}};function ua(t,e){let r=[];for(let n of t){let s=Rre.INSTANCE.getQuery(e.tree.getLanguage(),n).matches(e);r.push(...s)}return r}function JL(t,e){switch(e){case"python":case"csharp":return t.children.find(r=>r.type.match(/identifier/))?.text;case"go":{let r=t.children.find(o=>o.type.match(/identifier/));return r?r.text:t.children.find(o=>o.type.match(/spec/))?.children.find(o=>o.type.match(/identifier/))?.text}case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":case"cpp":{let r=t.children.find(o=>o.type.match(/declarator/));return r?r.children.find(o=>o.type.match(/identifier/))?.text:t.children.find(o=>o.type.match(/identifier/))?.text}case"java":return t.children.find(n=>n.type==="identifier")?.text;case"ruby":return t.children.find(r=>r.type.match(/constant|identifier/))?.text;default:return t.children.find(r=>r.type.match(/identifier/))?.text}}function ZL(t,e){switch(e){case"typescript":case"tsx":case"javascript":return t.type.match(/definition|declaration|declarator|export_statement/);case"go":return t.type.match(/definition|declaration|declarator|var_spec/);case"cpp":return t.type.match(/definition|declaration|class_specifier/);case"ruby":return t.type.match(/module|class|method|assignment/);default:return t.type.match(/definition|declaration|declarator/)}}function zx(t,e,r,n=ZL){let o=[t.rootNode],s=[];for(;;){let a=o.map(c=>[c,En.intersectionSize(c,e)]).filter(([c,l])=>l>0).sort(([c,l],[u,d])=>d-l);if(a.length===0)return s.length===0?void 0:wL(s,([c,l],[u,d])=>l-d)[0];{let c=a.map(([l,u])=>{let d=En.len(l),p=Math.abs(En.len(e)-u),m=(u-p)/d;return[l,m]});s.push(...c.filter(([l,u])=>n(l,r))),o=[],o.push(...c.flatMap(([l,u])=>l.children))}}}var pr=(()=>{function t(e,...r){return e.length===1?e[0]:e.reduce((n,o,s)=>`${n}${o}${r[s]||""}`,"")}return{typescript:t,javascript:t,python:t,go:t,ruby:t,csharp:t,cpp:t,java:t,rust:t}})();function vu(t,e){return Object.fromEntries(t.map(r=>[r,e]))}var Wlt={javascript:[],typescript:[],tsx:[],python:[],csharp:[],go:[],java:[],ruby:[],cpp:[],rust:[]};function yu(t){for(let e in t){let r=t[e];Wlt[e].push(...r)}return t}var Zwe=yu({...vu(["javascript","typescript","tsx"],[`[
			(call_expression
				function: (identifier) @identifier)
			(call_expression
				function: (member_expression
					(property_identifier) @identifier))
		] @call_expression`]),python:[`[
			(call
				function: (identifier) @identifier)
			(call
				function: (attribute
					attribute: (identifier) @identifier))
		] @call_expression`],csharp:[`[
			(invocation_expression
				function: (identifier) @identifier)
			(invocation_expression
				function: (member_access_expression
					name: (identifier) @identifier))
		] @call_expression`],go:[`[
			(call_expression
				((selector_expression
					(field_identifier) @identifier)))
			(call_expression
				(identifier) @identifier)
		] @call_expression`],java:[`[
			(method_invocation
				name: (identifier) @identifier)
		] @call_expression`],ruby:[`[
			(call (identifier) @identifier
				(#not-match? @identifier "new|send|public_send|method"))
			(call
				receiver: (identifier)
				method: (identifier) @method
				(#match? @method "^(send|public_send|method)")
				arguments: (argument_list
					(simple_symbol) @symbol))
		] @call_expression`],cpp:[`[
			(function_declarator
				(identifier) @identifier)
			(function_declarator
				(field_identifier) @identifier)
			(call_expression (identifier) @identifier)
			(call_expression
				(field_expression
					field: (field_identifier) @identifier))
			(call_expression
				(call_expression
					(primitive_type)
					(argument_list
						(pointer_expression
						(identifier) @identifier))))
		] @call_expression`],rust:[`[
			(call_expression (identifier) @identifier)
			(call_expression (field_expression (identifier) (field_identifier) @identifier))
			(call_expression (scoped_identifier (identifier) (identifier) @identifier (#not-match? @identifier "new")))
		] @call_expression`]}),eke=yu({...vu(["javascript","typescript","tsx"],["(class_declaration) @class_declaration"]),java:["(class_declaration) @class_declaration"],csharp:["(class_declaration) @class_declaration"],python:["(class_definition) @class_declaration"],cpp:["(class_specifier) @class_declaration"],ruby:["(class) @class_declaration"],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @class_declaration`],rust:["(impl_item (type_identifier) @type_identifier) @class_declaration"]}),tke=yu({typescript:[`[
			(interface_declaration)
			(type_alias_declaration)
		] @type_declaration`],csharp:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],cpp:[`[
			(struct_specifier
				(type_identifier) @type_identifier)
			(union_specifier
				(type_identifier) @type_identifier)
			(enum_specifier
				(type_identifier) @type_identifier)
		] @type_declaration`],java:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @type_declaration`],ruby:["((constant) @type_identifier) @type_declaration"],python:[`(class_definition
			(identifier) @type_identifier) @type_declaration`]}),rke=yu({typescript:["(type_identifier) @type_identifier"],go:["(type_identifier) @type_identifier"],ruby:["(constant) @type_identifier"],csharp:[`[
			(base_list
				(identifier) @type_identifier)
			(variable_declaration
				(identifier) @type_identifier)
		]`],cpp:["(type_identifier) @type_identifier"],java:["(type_identifier) @type_identifier"],python:[`[
			(type (identifier) @type_identifier)
			(argument_list
				(identifier) @type_identifier)
		]`]}),nke=yu({...vu(["javascript","typescript","tsx"],[`(new_expression
			constructor: (identifier) @new_expression)`]),python:[`(call
			function: (identifier) @new_expression)`],csharp:[`(object_creation_expression
			(identifier) @new_expression)`],java:[`(object_creation_expression
			(type_identifier) @new_expression)`],cpp:[`[
			(declaration
				(type_identifier) @new_expression)
			(class_specifier
				(type_identifier) @new_expression)
		]`],go:["(composite_literal (type_identifier) @new_expression)"],ruby:[`((call
			receiver: ((constant) @new_expression)
			method: (identifier) @method)
				(#eq? @method "new"))`],rust:[`(call_expression
			(scoped_identifier
				(identifier) @new_expression
				(identifier) @identifier
				(#eq? @identifier "new")))`]}),ike=yu({python:[`[
			(function_definition
				name: (identifier) @identifier
				body: (block
						(expression_statement (string))? @docstring) @body)
			(assignment
				left: (identifier) @identifier
				right: (lambda) @body)
		] @function`,'(ERROR ("def" (identifier) (parameters))) @function'],...vu(["javascript","typescript","tsx"],[`[
			(function_expression
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(method_definition
				name: (property_identifier)? @identifier
				body: (statement_block) @body)
			(arrow_function
				body: (statement_block) @body)
		] @function`]),go:[`[
			(function_declaration
				name: (identifier) @identifier
				body: (block) @body)
			(method_declaration
				name: (field_identifier) @identifier
				body: (block) @body)
		] @function`],ruby:[`[
			(method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
			(singleton_method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
		] @function`],csharp:[`[
			(constructor_declaration
				(identifier) @identifier
				(block) @body)
			(destructor_declaration
				(identifier) @identifier
				(block) @body)
			(operator_declaration
				(block) @body)
			(method_declaration
				(identifier) @identifier
				(block) @body)
			(local_function_statement
				(identifier) @identifier
				(block) @body)
		] @function`],cpp:[`[
			(function_definition
				(_
					(identifier) @identifier)
					(compound_statement) @body)
			(function_definition
				(function_declarator
					(qualified_identifier
						(identifier) @identifier))
					(compound_statement) @body)
		] @function`],java:[`[
			(constructor_declaration
				name: (identifier) @identifier
				body: (constructor_body) @body)
			(method_declaration
				name: (_) @identifier
				body: (block) @body)
			(lambda_expression
				body: (block) @body)
		] @function`],rust:[`[
			(function_item (identifier) @identifier)
			(let_declaration (identifier) @identifier)
		] @function`]}),ZBr=yu({javascript:[pr.javascript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],...vu(["typescript","tsx"],[pr.typescript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`]),java:[pr.java`((block_comment) @block_comment
			(#match? @block_comment "^\\\\/\\\\*\\\\*")) @docComment`],cpp:[pr.cpp`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],csharp:[pr.csharp`(
			((comment) @c
				(#match? @c "^\\\\/\\\\/\\\\/"))+
		) @docComment`],rust:[pr.rust`((line_comment) @comment
			(#match? @comment "^\/\/\/|^\/\/!"))+ @docComment`],go:[pr.go`((comment)+) @docComment`],ruby:[pr.ruby`((comment)+) @docComment`],python:[`(expression_statement
			(string) @docComment)`]}),Pre=yu({javascript:[pr.javascript`[
			(function_declaration
				(identifier) @function.identifier
			) @function

			(generator_function_declaration
				name: (identifier) @generator_function.identifier
			) @generator_function

			(class_declaration
				name: (identifier) @class.identifier ;; note: (type_identifier) in typescript
				body: (class_body
							(method_definition
								name: (property_identifier) @method.identifier
							) @method
						)
			) @class
		]`],...vu(["typescript","tsx"],[pr.typescript`[
				(function_declaration
					(identifier) @function.identifier
				) @function

				(generator_function_declaration
					name: (identifier) @generator_function.identifier
				) @generator_function

				(class_declaration
					name: (type_identifier) @class.identifier
					body: (class_body
								(method_definition
									(accessibility_modifier)? @method.accessibility_modifier
									name: (property_identifier) @method.identifier
									(#not-eq? @method.accessibility_modifier "private")
								) @method
							)
				) @class
			]`]),python:[pr.python`[
				(function_definition
					name: (identifier) @function.identifier
				) @function
			]`],go:[pr.go`[
				(function_declaration
					name: (identifier) @function.identifier
				) @function

				(method_declaration
					name: (field_identifier) @method.identifier
				) @method
			]`],ruby:[pr.ruby`[
				(method
					name: (identifier) @method.identifier
				) @method

				(singleton_method
					name: (_) @singleton_method.identifier
				) @singleton_method
			]`],csharp:[pr.csharp`[
				(constructor_declaration
					(identifier) @constructor.identifier
				) @constructor

				(destructor_declaration
					(identifier) @destructor.identifier
				) @destructor

				(method_declaration
					(identifier) @method.identifier
				) @method

				(local_function_statement
					(identifier) @local_function.identifier
				) @local_function
			]`],cpp:[pr.cpp`[
				(function_definition
					(_
						(identifier) @identifier)
				) @function
			]`],java:[pr.java`(class_declaration
			name: (_) @class.identifier
			body: (_
						[
							(constructor_declaration
								(modifiers)? @constructor.modifiers
								(#not-eq? @constructor.modifiers "private")
								name: (identifier) @constructor.identifier
							) @constructor

							(method_declaration
								(modifiers)? @method.modifiers
								(#not-eq? @method.modifiers "private")
								name: (identifier) @method.identifier
							) @method
						]
					)
		) @class`],rust:[pr.rust`[
				(function_item
					(identifier) @function.identifier
				) @function
			]`]}),oke=yu({javascript:[pr.javascript`[
			(identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`],...vu(["typescript","tsx"],[pr.typescript`[
			(identifier) @symbol
			(type_identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`]),cpp:[pr.cpp`[
			(identifier) @symbol
			(type_identifier) @symbol
		]`],csharp:[pr.csharp`[
			(identifier) @symbol
		]`],go:[pr.go`[
			(identifier) @symbol
		]`],java:[pr.java`[
			(identifier) @symbol
		]`],python:[pr.python`[
			(identifier) @symbol
		]`],ruby:[pr.ruby`[
			(identifier) @symbol
		]`],rust:[pr.rust`[
			(identifier) @symbol
		]`]}),ske=yu({typescript:[pr.typescript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related
				(public_field_definition) @public_field_definition
				(method_definition) @method_definition
				(class_declaration (_ (method_signature) @method_signature))
				(abstract_method_signature) @abstract_method_signature

				;; enum declaration related
				(enum_assignment) @enum_assignment

				;; interface declaration related
				(interface_declaration (_ (method_signature) @method_signature))
				(interface_declaration (_ (property_signature) @property_signature))

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(if_statement
					consequence: [
						(expression_statement)
						(if_statement)
					] @if_statement.exclude_captures)
				(else_clause
					[
						(expression_statement)
						(if_statement) ; for if-else chains
					] @else_clause.exclude_captures)
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]
		`],tsx:[pr.typescript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related
				(public_field_definition) @public_field_definition
				(method_definition) @method_definition
				(class_declaration (_ (method_signature) @method_signature))
				(abstract_method_signature) @abstract_method_signature

				;; enum declaration related
				(enum_assignment) @enum_assignment

				;; interface declaration related
				(interface_declaration (_ (method_signature) @method_signature))
				(interface_declaration (_ (property_signature) @property_signature))

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(if_statement
					consequence: [
						(expression_statement)
						(if_statement)
					] @if_statement.exclude_captures)
				(else_clause
					[
						(expression_statement)
						(if_statement) ; for if-else chains
					] @else_clause.exclude_captures)
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement

				;; jsx
				(jsx_element) @jsx_element
				(jsx_element (_ (jsx_expression) @jsx_expression))
			]
		`],python:[pr.python`
			[
				(comment) @comment

				;; simple statements
				(assert_statement) @assert_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(delete_statement) @delete_statement
				(exec_statement) @exec_statement
				(expression_statement) @expression_statement
				(future_import_statement) @future_import_statement
				(global_statement) @global_statement
				(import_from_statement) @import_from_statement
				(import_statement) @import_statement
				(nonlocal_statement) @nonlocal_statement
				(pass_statement) @pass_statement
				(print_statement) @print_statement
				(raise_statement) @raise_statement
				(return_statement) @return_statement
				(type_alias_statement) @type_alias_statement


				;; compound statements

				(class_definition) @class_definition
				(decorated_definition) @decorated_definition
				(for_statement) @for_statement
				(function_definition) @function_definition
				(if_statement) @if_statement
				(try_statement) @try_statement
				(while_statement) @while_statement
				(with_statement) @with_statement


				;; expressions

				(expression_list) @expression_list
				(expression_statement) @expression_statement
			]
		`],javascript:[pr.javascript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related

				(field_definition) @field_definition
				(method_definition) @method_definition

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]`],go:[pr.go`
		[
			(_statement) @statement
			(function_declaration) @function_declaration
			(import_declaration) @import_declaration
			(method_declaration) @method_declaration
			(package_clause) @package_clause

			(if_statement
				initializer: (_) @for_statement.exclude_captures) @for_statement

			(expression_case) @expression_case ;; e.g., case 0:
		]
		`],ruby:[pr.ruby`
			[
				(comment) @comment

				(assignment) @assignment

				(if) @if

				(call) @call

				(case) @case

				(when) @when

				(while) @while

				(for) @for

				(method) @method

				(class) @class

				(module) @module

				(begin) @begin
			]
		`],csharp:[pr.csharp`
			[
				(comment) @comment

				(class_declaration) @class_declaration
				(constructor_declaration) @constructor_declaration
				(method_declaration) @method_declaration
				(delegate_declaration) @delegate_declaration
				(enum_declaration) @enum_declaration
				(extern_alias_directive) @extern_alias_directive
				(file_scoped_namespace_declaration) @file_scoped_namespace_declaration
				(global_attribute) @global_attribute
				(global_statement) @global_statement
				(interface_declaration) @interface_declaration
				(namespace_declaration) @namespace_declaration
				(record_declaration) @record_declaration
				(struct_declaration) @struct_declaration
				(using_directive) @using_directive

				(local_declaration_statement) @local_declaration_statement
				(expression_statement) @expression_statement
				(for_statement) @for_statement
				(foreach_statement) @foreach_statement
				(continue_statement) @continue_statement
				(break_statement) @break_statement
				(throw_statement) @throw_statement
				(return_statement) @return_statement
				(try_statement) @try_statement
			]
		`],cpp:[pr.cpp`
			[
				(declaration) @declaration

				(expression_statement) @expression_statement

				(comment) @comment

				(preproc_include) @preproc_include

				(namespace_definition) @namespace_definition

				(enum_specifier) @enum_specifier

				(struct_specifier) @struct_specifier

				(template_declaration) @template_declaration

				(function_definition) @function_definition

				(return_statement) @return_statement

				(class_specifier) @class_specifier

				(try_statement) @try_statement

				(throw_statement) @throw_statement

				(for_statement) @for_statement
				(for_statement
					initializer:(_) @for_statement.exclude_captures) @for_statement

				(for_range_loop) @for_range_loop
			]
		`],java:[pr.java`
		[
			(statement) @statement ;; @ulugbekna: this includes (declaration); but somehow it can't capture inner classes

			(line_comment) @line_comment
			(block_comment) @block_comment

			(for_statement
				init: (_) @for_statement.exclude_captures)

			(block) @block.exclude_captures

			(field_declaration) @field_declaration
		]
		`],rust:[]}),ake={...vu(["typescript","tsx"],["program","interface_declaration","class_declaration","function_declaration","function_expression","type_alias_declaration","method_definition"]),javascript:["program","class_declaration","function_declaration","function_expression","method_definition"],java:["program","class_declaration","interface_declaration","method_declaration"],cpp:["translation_unit","class_specifier","function_definition"],csharp:["compilation_unit","class_declaration","interface_declaration","method_declaration"],python:["module","class_definition","function_definition"],go:["source_file","type_declaration","function_declaration","method_declaration"],ruby:["program","method","class","method"],rust:["source_file","function_item","impl_item","let_declaration"]},cke=yu({typescript:[Cf("typescript")],tsx:[Cf("tsx")],javascript:[Cf("javascript")],java:[Cf("java")],cpp:[Cf("cpp")],csharp:[Cf("csharp")],python:[Cf("python")],go:[Cf("go")],ruby:[Cf("ruby")],rust:[Cf("rust")]}),lke={...vu(["typescript","tsx","javascript"],["for_in_statement","for_statement","if_statement","while_statement","do_statement","try_statement","switch_statement"]),java:["for_statement","enhanced_for_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],cpp:["for_statement","for_range_loop","if_statement","while_statement","do_statement","try_statement","switch_statement"],csharp:["for_statement","for_each_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],python:["for_statement","if_statement","while_statement","try_statement"],go:["for_statement","if_statement","type_switch_statement"],ruby:["while","for","if","case"],rust:["for_statement","if_statement","while_statement","loop_statement","match_expression"]},Klt={...vu(["typescript","tsx"],["lexical_declaration","expression_statement","public_field_definition"]),javascript:["call_expression","expression_statement","variable_declaration","public_field_definition"],java:["expression_statement","local_variable_declaration","field_declaration"],cpp:["field_declaration","expression_statement","declaration"],csharp:["field_declaration","expression_statement"],python:["expression_statement"],go:["short_var_declaration","call_expression"],ruby:["call","assignment"],rust:["expression_statement","let_declaration","use_declaration","assignment_expression","macro_definition","extern_crate_declaration"]},Ylt={...vu(["typescript","tsx"],["class_declaration","function_declaration","generator_function_declaration","interface_declaration","internal_module","method_definition","abstract_class_declaration","abstract_method_signature","enum_declaration"]),javascript:["class_declaration","function_declaration","generator_function_declaration","method_definition"],java:["class_declaration","constructor_declaration","enum_declaration","interface_declaration","method_declaration","module_declaration"],cpp:["class_specifier","function_definition","namespace_definition","struct_specifier"],csharp:["class_declaration","constructor_declaration","destructor_declaration","enum_declaration","interface_declaration","method_declaration","namespace_declaration","struct_declaration"],python:["function_definition","class_definition"],go:["function_declaration","method_declaration"],ruby:["class","method","module"],rust:["function_item","impl_item","mod_item","struct_item","trait_item","union_item"]},uke=yu({typescript:[Tf("typescript")],tsx:[Tf("tsx")],javascript:[Tf("javascript")],java:[Tf("java")],cpp:[Tf("cpp")],csharp:[Tf("csharp")],python:[Tf("python")],go:[Tf("go")],rust:[Tf("rust")],ruby:[Tf("ruby")]});function Cf(t){return ake[t].map(e=>`(${e}) @scope`).join(`
`)}function Tf(t){return`[
		${Ylt[t].map(r=>`(${r})`).join(`
`)}
	] @definition`}function eO(t,e){return ake[t].includes(e.type)||lke[t].includes(e.type)}function dke(t,e){return lke[t].includes(e.type)}function Are(t,e){return Klt[t].includes(e.type)}var pke={...vu(["typescript","tsx"],[pr.typescript`[
			(expression_statement
				(call_expression
					function: (identifier) @fn
					(#any-of? @fn "test" "it")
				)
			) @test
		]`]),javascript:[pr.javascript`[
			(call_expression
				function: (identifier) @fn
				(#any-of? @fn "test" "it")
			) @test
		]`],python:[pr.python`[
			(function_definition
				name: (identifier) @fn
				(#match? @fn "^test_")
			) @test
		]`],java:[pr.java`[
			(method_declaration
				name: (identifier) @fn
				(#match? @fn "^test")
			) @test
		]`],go:[pr.go`[
			(function_declaration
				name: (identifier) @fn
				(#match? @fn "^Test")
			) @test
		]`],ruby:[],csharp:[],cpp:[],rust:[]};var Dre=class{constructor(){this._cache=new Bl(5)}setCacheSize(e){this._cache=new Bl(e)}async getStructure(e,r){let n=`${e}:${r}`,o=this._cache.get(n);return o||(o=await this._getStructure(e,r),this._cache.put(n,o)),o}async _getStructure(e,r){let n=ske[e];if(n.length===0)return;let o=await pi(e,r);try{let s=ua(n,o.tree.rootNode).flatMap(u=>u.captures).sort((u,d)=>En.compare(u.node,d.node)),a=[];for(let u of s)u.name.endsWith(".exclude_captures")&&a.push(En.ofSyntaxNode(u.node));let c=new Rp(0,r.length,"root",[]),l=[c];for(let u=0;u<s.length;++u){let p=s[u].node;if(a.some(h=>En.isEqual(h,p)))continue;let f;do f=l.pop();while(f&&!En.doesContain(f,p));if(new Set(["export_statement","ambient_declaration"]).has(f.kind))f.kind=p.type,l.push(f);else{let h=p.type;(e==="typescript"||e==="tsx"||e==="javascript")&&h==="method_definition"&&p.namedChildren.some(S=>S.type==="property_identifier"&&S.text==="constructor")&&(h="constructor");let g=p.startIndex,v=p.previousSibling;if(v!==null){let I=r.substring(v.endIndex,p.startIndex).indexOf(`
`);I===-1?g=v.endIndex:g=v.endIndex+I+1}let b=p.endIndex,_=p.nextSibling;if(e==="typescript"&&_!==null&&(_.type===";"||_.type===",")&&(_=_.nextSibling),_!==null){let I=r.substring(p.endIndex,_.startIndex).indexOf(`
`);I!==-1&&(b=p.endIndex+I+1)}let x=new Rp(g,b,h,[]);f.children.push(x),l.push(f,x)}}return c}catch(s){console.error(s instanceof Error?s:new Error(s))}finally{o.dispose()}}},fke=new Dre;async function mke(t,e,r){let n=await pi(t,e);try{let s=r.startIndex===r.endIndex?void 0:zx(n.tree,r,t);if(s)return{nodeIdentifier:JL(s,t),nodeToDocument:Iv.ofSyntaxNode(s),nodeSelectionBy:"matchingSelection"};let c=n.tree.rootNode.descendantForIndex(r.startIndex,r.endIndex),l=0;for(;!ZL(c,t)&&c.parent!==null;)c=c.parent,++l;return{nodeIdentifier:JL(c,t),nodeToDocument:Iv.ofSyntaxNode(c),nodeSelectionBy:"expanding"}}finally{n.dispose()}}async function hke(t,e,r){let n=await pi(t,e);try{let o=n.tree.rootNode.descendantForIndex(r.startIndex,r.endIndex);if(o.type.match(/identifier/)&&(o.parent===null||ZL(o.parent,t))){let s=o.parent,a=s===null?void 0:{startIndex:s.startIndex,endIndex:s.endIndex};return{identifier:o.text,nodeRange:a}}}finally{n.dispose()}}async function gke(t,e,r){let n=await pi(t,e);try{let o=ua(Pre[t],n.tree.rootNode).flatMap(({captures:c})=>c),s=new Map;for(let c of o){let[l,u]=c.name.split(".");if(u!=="identifier")continue;let d=s.get(l)||[];d.push(c),s.set(l,d)}let a=null;for(let c of o){let[l,u]=c.name.split(".");if(u!==void 0||!En.doesContain(c.node,r)||a!==null&&En.len(a.node)<En.len(c.node))continue;let d=s.get(l);nd(d!==void 0,`must have seen identifier for symbol kind '${l}' (lang: ${t})`);let p=d.find(f=>En.doesContain(c.node,f.node));nd(p!==void 0,`must have seen identifier for symbol '${l}' (lang: ${t})`),a={identifier:{name:p.node.text,range:En.ofSyntaxNode(p.node)},node:Iv.ofSyntaxNode(c.node)}}return a}catch(o){return console.error("getTestableNode: Unexpected error",o),null}finally{n.dispose()}}async function vke(t,e){let r=await pi(t,e);try{let n=ua(Pre[t],r.tree.rootNode).flatMap(({captures:a})=>a).filter(ofe(a=>[a.node.startIndex,a.node.endIndex].toString())),o=new Map;for(let a of n){let[c,l]=a.name.split(".");if(l!=="identifier")continue;let u=o.get(c)||[];u.push(a),o.set(c,u)}let s=[];for(let a of n){if(a.name.includes("."))continue;let c=a.name,l=o.get(c);nd(l!==void 0,`must have seen identifier for symbol kind '${c}' (lang: ${t})`);let u=l.find(d=>En.doesContain(a.node,d.node));nd(u!==void 0,`must have seen identifier for symbol '${c}' (lang: ${t})`),s.push({identifier:{name:u.node.text,range:En.ofSyntaxNode(u.node)},node:Iv.ofSyntaxNode(a.node)})}return s}catch(n){return console.error("getTestableNodes: Unexpected error",n),null}finally{r.dispose()}}async function yke(t,e){let r=await pi(t,e);try{let o=ua(pke[t],r.tree.rootNode).flatMap(a=>a.captures).sort((a,c)=>a.node.endIndex-c.node.endIndex).filter(a=>a.name==="test");if(o.length===0)return null;let s=o[o.length-1].node;return{startIndex:s.startIndex,endIndex:s.endIndex}}finally{r.dispose()}}var Uqr=TB();function Qlt(t,e){let r=cke[t];return ua(r,e)}function xke(t,e){let r=ike[t];return ua(r,e)}function Xlt(t,e){let r=Zwe[t];return r?ua(r,e):[]}function Jlt(t,e){let r=eke[t];return r?ua(r,e):[]}function Zlt(t,e){let r=tke[t];return r?ua(r,e):[]}function eut(t,e){let r=rke[t];return r?ua(r,e):[]}function tut(t,e){let r=nke[t];return r?ua(r,e):[]}function Ske(t,e){let r=uke[t];return ua(r,e)}async function rut(t,e,r){let n=await pi(t,e);try{return Xlt(t,n.tree.rootNode).reduce((a,c)=>{let l=c.captures.find(u=>u.name==="call_expression").node;if(En.doIntersect(r,l)){let u,d;t==="ruby"&&(d=c.captures.find(p=>p.name==="symbol")?.node,u=d?.text?.slice(1)),d??=c.captures.find(p=>p.name==="identifier")?.node,u??=d?.text,a.push({identifier:u??"",text:l.text,startIndex:(d??l).startIndex,endIndex:(d??l).endIndex})}return a},[])}finally{n.dispose()}}async function nut(t,e){let r=await pi(t,e);try{return xke(t,r.tree.rootNode).map(s=>{let a=s.captures.find(l=>l.name==="function").node;return{identifier:s.captures.find(l=>l.name==="identifier")?.node.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function iut(t,e){let r=await pi(t,e);try{return Jlt(t,r.tree.rootNode).map(s=>{let a=s.captures.find(l=>l.name==="class_declaration").node;return{identifier:a?.children.find(l=>l.type==="type_identifier"||l.type==="identifier"||l.type==="constant")?.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function sut(t,e){let r=await pi(t,e);try{return Zlt(t,r.tree.rootNode).map(s=>{let a=s.captures.find(l=>l.name==="type_declaration").node,c=s.captures.find(l=>l.name==="type_identifier")?.node.text;return c||(c=a?.children.find(l=>l.type==="type_identifier")?.text),{identifier:c??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function aut(t,e,r){let n=await pi(t,e);try{return eut(t,n.tree.rootNode).reduce((a,c)=>{let l=c.captures.find(u=>u.name==="type_identifier").node;return En.doIntersect(r,l)&&a.push({identifier:l.text,text:l.text,startIndex:l.startIndex,endIndex:l.endIndex}),a},[])}finally{n.dispose()}}async function cut(t,e,r){let n=await pi(t,e);try{return tut(t,n.tree.rootNode).reduce((a,c)=>{let l=c.captures.find(u=>u.name==="new_expression").node;return En.doIntersect(r,l)&&a.push({identifier:l.text,text:l.text,startIndex:l.startIndex,endIndex:l.endIndex}),a},[])}finally{n.dispose()}}async function lut(t,e,r){let n=await pi(t,e);try{let o=oke[t];return ua(o,n.tree.rootNode).reduce((c,l)=>{let u=l.captures.find(d=>d.name==="symbol").node;return En.doIntersect(r,u)&&c.push({identifier:u.text,text:u.text,startIndex:u.startIndex,endIndex:u.endIndex}),c},[])}finally{n.dispose()}}async function uut(t,e){let r=await pi(t,e);try{let n=Ske(t,r.tree.rootNode);return yut(t,n,r.tree.rootNode)}finally{r.dispose()}}async function dut(t,e){let r=await pi(t,e);try{let n=Ske(t,r.tree.rootNode);return Eke(t,n,r.tree.rootNode)}finally{r.dispose()}}async function put(t,e){let r=await pi(t,e);try{return xke(t,r.tree.rootNode).map(s=>{let a=s.captures.find(c=>c.name==="body").node;return{startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function fut(t,e,r){let n=await pi(t,e);try{let o=Qlt(t,n.tree.rootNode),s;for(let a of o){let c=a.captures[0].node,l=Sv.ofSyntaxNode(c);if(Sv.doesContain(l,r)&&(s=c),gd.isBefore(r.endPosition,l.startPosition))break}if(s)return Sv.ofSyntaxNode(s);throw new Error("No parent node found")}finally{n.dispose()}}async function mut(t,e,r,n){let o=await pi(t,e);try{let s=o.tree.rootNode.descendantForPosition(r.startPosition,r.endPosition),a={startPosition:s.startPosition,endPosition:s.endPosition},c=Cke(t,s,n,r,!0);return Sv.equals(a,c)?Ike(t,s):c}finally{o.dispose()}}function Ike(t,e){let r=e.parent,n={startPosition:e.startPosition,endPosition:e.endPosition};if(eO(t,e)||!r)return n;let{filteredRanges:o,indexOfInterest:s}=Tke(t,r.children,n,!1);if(s-1>=0&&s+1<=o.length-1){let a=o[s-1],c=o[s+1];return{startPosition:a.startPosition,endPosition:c.endPosition}}return Ike(t,r)}function Cke(t,e,r,n,o){let s=e.children;if(e.endPosition.row-e.startPosition.row+1<=r){let c=eO(t,e)?{startPosition:e.startPosition,endPosition:e.endPosition}:_ke(t,s,r,n,o),l=e.parent;return l?Cke(t,l,r,c,!1):c}return _ke(t,s,r,n,o)}function bke(t,e){return e.endPosition.row-t.startPosition.row+1}function _ke(t,e,r,n,o){if(e.length===0)return n;let{filteredRanges:s,indexOfInterest:a}=Tke(t,e,n,o),c=0,l=s.length-1,u=s[c],d=s[l];for(;bke(u,d)>r&&c!==l;)a-c<l-a?(l--,d=s[l]):(c++,u=s[c]);return bke(u,d)<=r?{startPosition:u.startPosition,endPosition:d.endPosition}:n}function Tke(t,e,r,n){let o,s;if(n?(o=e.filter(a=>eO(t,a)||Are(t,a)),s=wEe(o,r,(a,c)=>gd.isBefore(a.startPosition,c.startPosition)),o.splice(s,0,r)):(o=e.filter(a=>Sv.doesContain(a,r)||eO(t,a)||Are(t,a)),s=o.findIndex(a=>Sv.doesContain(a,r))),s===-1)throw new Error("Valid index not found");return{filteredRanges:o,indexOfInterest:s}}async function hut(t,e,r){let n=[],a=(await pi(t,e)).tree.rootNode.descendantForIndex(r.startIndex,r.endIndex);for(;a!==null;)dke(t,a)&&n.push({startIndex:a.startIndex,endIndex:a.endIndex}),a=a.parent;return n}async function gut(t,e,r){let n=await pi(t,e);try{let o=r.startIndex===r.endIndex;if(o)return;let s=o?void 0:zx(n.tree,r,t),a=o?void 0:zx(n.tree,r,t,vut);if(a&&s)return{nodeIdentifier:JL(s,t),nodeToExplain:Iv.ofSyntaxNode(a)}}finally{n.dispose()}}function vut(t,e){return t.type.match(/definition/)}function Eke(t,e,r){let n=new Map;e.forEach(s=>{let c=s.captures.find(d=>d.name==="definition")?.node,l;t==="cpp"&&c?.type==="function_definition"?l=c?.childForFieldName("declarator")?.childForFieldName("declarator"):t==="rust"&&c?.type==="impl_item"?l=c?.childForFieldName("trait"):l=c?.childForFieldName("name");let u=c?.childForFieldName("body");if(c&&u){switch(t){case"typescript":case"javascript":{let{definition:p}=wke(c);c=p;break}}n.get(c.id)||n.set(c.id,{mainBlock:fc.ofSyntaxNode(c),detailBlocks:{body:fc.ofSyntaxNode(u),name:l?.text}})}});let o=Array.from(n.values());return new QL(o,fc.ofSyntaxNode(r))}function yut(t,e,r){let n;switch(t){case"python":n=Sut(e);break;case"ruby":n=xut(e);break;default:{n=but(e,t);break}}return new QL(n,fc.ofSyntaxNode(r))}function but(t,e){let r=new Map;return t.forEach(n=>{let s=n.captures.find(c=>c.name==="definition")?.node,a=s?.childForFieldName("body");if(s&&a){let c;switch(e){case"typescript":case"javascript":{let{definition:u,comments:d}=wke(s);s=u,c=d;break}case"java":case"rust":c=Iut(s);break;default:{c=tO(s);break}}r.get(s.id)||r.set(s.id,{mainBlock:fc.ofSyntaxNode(s),detailBlocks:{comments:c.map(u=>fc.ofSyntaxNode(u)),body:fc.ofSyntaxNode(a)}})}}),Array.from(r.values())}function _ut(t){if(!(t.length<2))for(let e=1;e<t.length;e++){let r=t[e];if(!r.type.includes("parameters"))return r}}function xut(t){let e=new Map;return t.forEach(r=>{let o=r.captures.find(s=>s.name==="definition")?.node;if(o){let s=o.namedChildren,a=_ut(s);if(a){let c=s[s.length-1],l=o.text.substring(a.startIndex-o.startIndex,c.endIndex-o.startIndex),u=tO(o);e.get(o.id)||e.set(o.id,{mainBlock:fc.ofSyntaxNode(o),detailBlocks:{comments:u.map(p=>fc.ofSyntaxNode(p)),body:{range:{startPosition:{row:a.startPosition.row,column:a.startPosition.column},endPosition:{row:c.endPosition.row,column:c.endPosition.column}},startIndex:a.startIndex,text:l,endIndex:c.endIndex}}})}}}),Array.from(e.values())}function Sut(t){let e=new Map;return t.forEach(r=>{let o=r.captures.find(a=>a.name==="definition")?.node,s=o?.childForFieldName("body");if(o&&s){let a=Tut(s),c=Cut(o);e.set(o.id,{mainBlock:fc.ofSyntaxNode(o),detailBlocks:{docstring:a?fc.ofSyntaxNode(a):void 0,decorator:c?fc.ofSyntaxNode(c):void 0,body:fc.ofSyntaxNode(s)}});return}}),Array.from(e.values())}function tO(t,e=["comment"]){let r=[],n=t.previousNamedSibling;for(;n&&e.some(o=>o===n?.type);)r.push(n),n=n.previousNamedSibling;return r.reverse()}function wke(t){let e=t.parent;return e?.type==="export_statement"?{definition:e,comments:tO(e)}:{definition:t,comments:tO(t)}}function Iut(t){return tO(t,["block_comment","line_comment"])}function Cut(t){let e=t.previousNamedSibling;return e?.type==="decorator"?e:void 0}function Tut(t){let e=t.firstChild;if(!e||e.type!=="expression_statement")return;let r=e.firstChild;return r?.type==="string"?r:void 0}function Eut(t,e){return fke.getStructure(t,e)}var wut=Rke.join(__dirname,"worker2.js"),kB=class{constructor(e){this._parser=new Lre(Nre,wut,e)}dispose(){this._parser.dispose()}getTreeSitterAST(e){let r=cl(e.languageId);if(r)return this.getTreeSitterASTForWASMLanguage(r,e.getText())}getTreeSitterASTForWASMLanguage(e,r){let n=this._parser.proxy;return{getFunctionBodies:()=>n._getFunctionBodies(e,r),getCoarseParentScope:o=>n._getCoarseParentScope(e,r,o),getFixSelectionOfInterest:(o,s)=>n._getFixSelectionOfInterest(e,r,o,s),getCallExpressions:o=>n._getCallExpressions(e,r,o),getFunctionDefinitions:()=>n._getFunctionDefinitions(e,r),getClassReferences:o=>n._getClassReferences(e,r,o),getClassDeclarations:()=>n._getClassDeclarations(e,r),getTypeDeclarations:()=>n._getTypeDeclarations(e,r),getTypeReferences:o=>n._getTypeReferences(e,r,o),getSymbols:o=>n._getSymbols(e,r,o),getDocumentableNodeIfOnIdentifier:o=>n._getDocumentableNodeIfOnIdentifier(e,r,o),getTestableNode:o=>n._getTestableNode(e,r,o),getTestableNodes:()=>n._getTestableNodes(e,r),getNodeToExplain:o=>n._getNodeToExplain(e,r,o),getNodeToDocument:o=>n._getNodeToDocument(e,r,o),getFineScopes:o=>n._getFineScopes(e,r,o),getStructure:()=>n._getStructure(e,r),findLastTest:()=>n._findLastTest(e,r)}}getSemanticChunkTree(e,r){return this._parser.proxy._getSemanticChunkTree(e,r)}getSemanticChunkNames(e,r){return this._parser.proxy._getSemanticChunkNames(e,r)}},Lre=class{constructor(e,r,n){this._workerPath=r;this._useWorker=n;this._local=new Proxy(e,{get:(o,s,a)=>{let c=o[s];return typeof c!="function"?c:async(...l)=>{let u=await c.apply(o,kke(l));return kke(u)}}}),this._worker=new qn(()=>new zv(this._workerPath,{name:"Parser worker"}))}get proxy(){return this._useWorker?this._worker.value.proxy:this._local}dispose(){this._worker.hasValue&&this._worker.value.terminate()}};function kke(t){return typeof t>"u"?t:JSON.parse(JSON.stringify(t))}var RB=require("vscode");var AB=ne("IRemoteRepositoriesService"),PB=class{async loadWorkspaceContents(e){return await(await this.getApi()).loadWorkspaceContents?.(e)??!1}getApi(){return this.getRemoteExtension().activate()}getRemoteExtension(){if(this._remoteHub!==void 0)return this._remoteHub;if(this._remoteHub=RB.extensions.getExtension("ms-vscode.remote-repositories")??RB.extensions.getExtension("GitHub.remoteHub")??RB.extensions.getExtension("GitHub.remoteHub-insiders"),this._remoteHub===void 0)throw new Error("No Remote repository extension found.");return this._remoteHub}};function Pke(t){let r=[`(repo:${(Array.isArray(t.repo)?t.repo:[t.repo]).join(" OR repo:")})`];return t.lang&&r.push(`(lang:${t.lang.join(" OR lang:")})`),t.notLang&&r.push(`NOT (lang:${t.notLang.join(" OR lang:")})`),t.path&&r.push(`(path:${t.path.join(" OR path:")})`),t.notPath&&r.push(`NOT (path:${t.notPath.join(" OR path:")})`),r.join(" ")}var DB=class extends Error{constructor(r,n){super(n);this.status=r}},kut=6,Rut=.766,$x=class{constructor(e,r,n,o,s,a){this._domainService=e;this._telemetryService=r;this._authenticationService=n;this._fetcherService=o;this._envService=s;this._logService=a}async search(e,r,n={},o){let s;if(Array.isArray(r.repo)&&!r.repo.length)throw new Error("No repos specified");try{s=await this.postCodeOrDocsSearchRequestWithRetry(e,r,n,o)}catch(c){throw this._telemetryService.sendGHTelemetryException(c,`${this.slug} search failed`),c}let a=s.errors?.map(M0e)??[];if(!Array.isArray(r.repo)){if(a.length)throw a.length>1?new AggregateError(a):a[0];return s.results}return{results:s.results,errors:a}}async postCodeOrDocsSearchRequestWithRetry(e,r,n,o){let s=(await this._authenticationService.getPermissiveGitHubSession({silent:!0}))?.accessToken??(await this._authenticationService.getAnyGitHubSession({silent:!0}))?.accessToken;if(o?.isCancellationRequested)return{results:[]};let a=`${this._domainService.searchSkillURL}/${this.slug}`,c=5,l=0,u=new Set,d;for(;l<c;){if(o?.isCancellationRequested)return{results:[]};try{try{return await this.postCodeOrDocsSearchRequest(a,s,e,r,n,o)}catch(p){if(p instanceof DB)throw p;d=p;break}}catch(p){l++;let f=l*1e3;u.add(`Error fetching ${this.slug} search. ${p.message??p}`),this._logService.public.warn(`[repo:${r.repo}] Error fetching ${this.slug} search. Error: ${p.message??p}. Retrying in ${l} seconds. Query: ${e}`),await new Promise(m=>setTimeout(m,f))}}if(o?.isCancellationRequested)return{results:[]};throw l>=c&&(this._logService.public.warn(`[repo:${r.repo}] Max Retry Error thrown while querying '${e}'`),d=rQ({error:"ERROR_TYPE_MAX_RETRIES_EXCEEDED",message:`${this.slug} search timed out after ${c} retries. ${Array.from(u).join(`
`)}`})),d}async postCodeOrDocsSearchRequest(e,r,n,o,s,a){let c=s.limit??kut,l=s.similarity??Rut,u=s.rawChunks??!1,d={url:e,family:"Code Or Doc Search",name:"Code Or Doc Search",version:"2023-12-12-preview",modelMaxPromptTokens:0,getExtraHeaders(){let h={Accept:"application/json","X-GitHub-Api-Version":"2023-12-12-preview"};return u&&(h["X-Experiment-blackbird_snippet_mode"]="raw"),h}},p=await Hv(this._fetcherService,this._envService,this._telemetryService,this._domainService,d,r??"",await ul(process.env.HMAC_SECRET),void 0,ir(),{query:n,scopingQuery:Pke(o),similarity:l,limit:c},a),f=await p.text();if(p.status===404||p.status===400&&f.includes("unknown integration"))throw this._logService.public.debug(`${this.slug} search endpoint not available for this user.`),rQ({error:"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT",message:`${this.slug}: ${f}`});let m;try{m=JSON.parse(f)}catch{throw new DB(p.status,f)}return m}};E([Vo(e=>e._logService)],$x.prototype,"search",1),$x=E([y(0,en),y(1,ge),y(2,Tt),y(3,Kr),y(4,gt),y(5,ie)],$x);var NB=class extends $x{constructor(){super(...arguments);this.slug="code"}},LB=class extends $x{constructor(){super(...arguments);this.slug="docs"}};var no=q(require("vscode")),hk=require("vscode");var gk=class{constructor(e,r){this._configurationService=e;this._contextService=r;this._disposables=new ht;this._commentController=no.comments.createCommentController("github-copilot-review","GitHub Copilot Review");this._comments=[];this._disposables.add(no.workspace.onDidChangeConfiguration(n=>{n.affectsConfiguration("github.copilot.advanced")&&(no.commands.executeCommand("setContext","github.copilot.advanced.review.contextmenu.enabled",this._configurationService.getConfig(le.ReviewContextMenu)),no.commands.executeCommand("setContext","github.copilot.advanced.review.scmviewlet.enabled",this._configurationService.getConfig(le.ReviewSCMViewlet))),(n.affectsConfiguration("github.copilot.advanced")||n.affectsConfiguration("github.copilot.advanced.review.intent"))&&no.commands.executeCommand("setContext","github.copilot.advanced.review.intent.enabled",this.isIntentEnabled())})),this.updateContextValues()}updateContextValues(){no.commands.executeCommand("setContext","github.copilot.advanced.review.contextmenu.enabled",this._configurationService.getConfig(le.ReviewContextMenu)),no.commands.executeCommand("setContext","github.copilot.advanced.review.scmviewlet.enabled",this._configurationService.getConfig(le.ReviewSCMViewlet)),no.commands.executeCommand("setContext","github.copilot.advanced.review.intent.enabled",this.isIntentEnabled())}isIntentEnabled(){return this._configurationService.getConfig(le.ReviewIntent)}getDiagnosticCollection(){return this._diagnosticCollection||this._disposables.add(this._diagnosticCollection=no.languages.createDiagnosticCollection("github.copilot.review"))}getReviewComments(){return this._comments.map(({comment:e})=>e)}addReviewComments(e){for(let r of e){let n=this._commentController.createCommentThread(r.uri,r.range,this.createUIComments(r));n.contextValue="hasNoSuggestion",n.canReply=!1,this._comments.find(o=>o.comment.uri.toString()===r.uri.toString())||(n.collapsibleState=no.CommentThreadCollapsibleState.Expanded),this._comments.push({comment:r,thread:n}),this.updateThreadLabels(),this._comments.length===1&&(no.commands.executeCommand("github.copilot.interactiveEditor.review.next"),this._monitorActiveThread=setInterval(()=>{let o=this._commentController.activeCommentThread,s=o&&this._comments.find(a=>a.thread.label===o.label)?.thread;s!==this._activeThread&&(this._activeThread=s,s&&no.commands.executeCommand("github.copilot.interactiveEditor.review.current",s))},500))}}updateReviewComment(e){let r=this.findCommentThread(e);r&&(r.comments=this.createUIComments(e))}createUIComments(e){let r="",n=e.suggestion?"edits"in e.suggestion?e.suggestion.edits.length?`

***
${hk.l10n.t("Suggested change:")}${e.suggestion.edits.map(s=>`
\`\`\`diff
${Put(s)}
\`\`\``).join("")}
***`:`

${hk.l10n.t("No change found to suggest.")}`:`

${hk.l10n.t("Looking up change to suggest...")}`:"";return[{body:typeof e.body=="string"?`${e.body}${n}${r}`:new no.MarkdownString(`${e.body.value}${n}${r}`),mode:no.CommentMode.Preview,author:{name:hk.l10n.t("GitHub Copilot"),iconPath:He.joinPath(this._contextService.extensionUri,"assets","Copilot-chat-avatar.png")}}]}collapseReviewComment(e){let r=this._comments.find(s=>s.comment===e);if(!r)return;let n=r.thread;n.dispose();let o=this._commentController.createCommentThread(e.uri,e.range,n.comments);o.contextValue=n.contextValue,o.canReply=!1,o.label=n.label,r.thread=o}removeReviewComments(e){for(let r of e){let n=this._comments.findIndex(o=>o.comment===r);n!==-1&&(this._comments[n].thread.dispose(),this._comments.splice(n,1))}this.updateThreadLabels(),this._comments.length===0&&this._monitorActiveThread&&(clearInterval(this._monitorActiveThread),this._monitorActiveThread=void 0)}updateThreadLabels(){this._comments.forEach((e,r)=>{e.thread.label=hk.l10n.t("Code Review Comment ({0} of {1})",r+1,this._comments.length)})}findReviewComment(e){return this._comments.find(n=>n.thread===e||n.thread.comments[0]===e)?.comment}findCommentThread(e){return this._comments.find(n=>n.comment===e)?.thread}dispose(){this._disposables.dispose()}};gk=E([y(0,he),y(1,Bt)],gk);function Put(t){let e=t.oldText.split(/\r?\n/),r=t.newText.split(/\r?\n/);for(;e.length&&r.length&&e[0]===r[0];)e.shift(),r.shift();for(;e.length&&r.length&&e[e.length-1]===r[r.length-1];)e.pop(),r.pop();return`${e.map(n=>`- ${n}`).join(`
`)}
${r.map(n=>`+ ${n}`).join(`
`)}`}var rO=require("vscode");var Ake=Object.create(null);function T(t,e){if(UA(e)){let r=Ake[e];if(r===void 0)throw new Error(`${t} references an unknown codicon: ${e}`);e=r}return Ake[t]=e,{id:t}}var Dke={add:T("add",6e4),plus:T("plus",6e4),gistNew:T("gist-new",6e4),repoCreate:T("repo-create",6e4),lightbulb:T("lightbulb",60001),lightBulb:T("light-bulb",60001),repo:T("repo",60002),repoDelete:T("repo-delete",60002),gistFork:T("gist-fork",60003),repoForked:T("repo-forked",60003),gitPullRequest:T("git-pull-request",60004),gitPullRequestAbandoned:T("git-pull-request-abandoned",60004),recordKeys:T("record-keys",60005),keyboard:T("keyboard",60005),tag:T("tag",60006),gitPullRequestLabel:T("git-pull-request-label",60006),tagAdd:T("tag-add",60006),tagRemove:T("tag-remove",60006),person:T("person",60007),personFollow:T("person-follow",60007),personOutline:T("person-outline",60007),personFilled:T("person-filled",60007),gitBranch:T("git-branch",60008),gitBranchCreate:T("git-branch-create",60008),gitBranchDelete:T("git-branch-delete",60008),sourceControl:T("source-control",60008),mirror:T("mirror",60009),mirrorPublic:T("mirror-public",60009),star:T("star",60010),starAdd:T("star-add",60010),starDelete:T("star-delete",60010),starEmpty:T("star-empty",60010),comment:T("comment",60011),commentAdd:T("comment-add",60011),alert:T("alert",60012),warning:T("warning",60012),search:T("search",60013),searchSave:T("search-save",60013),logOut:T("log-out",60014),signOut:T("sign-out",60014),logIn:T("log-in",60015),signIn:T("sign-in",60015),eye:T("eye",60016),eyeUnwatch:T("eye-unwatch",60016),eyeWatch:T("eye-watch",60016),circleFilled:T("circle-filled",60017),primitiveDot:T("primitive-dot",60017),closeDirty:T("close-dirty",60017),debugBreakpoint:T("debug-breakpoint",60017),debugBreakpointDisabled:T("debug-breakpoint-disabled",60017),debugHint:T("debug-hint",60017),terminalDecorationSuccess:T("terminal-decoration-success",60017),primitiveSquare:T("primitive-square",60018),edit:T("edit",60019),pencil:T("pencil",60019),info:T("info",60020),issueOpened:T("issue-opened",60020),gistPrivate:T("gist-private",60021),gitForkPrivate:T("git-fork-private",60021),lock:T("lock",60021),mirrorPrivate:T("mirror-private",60021),close:T("close",60022),removeClose:T("remove-close",60022),x:T("x",60022),repoSync:T("repo-sync",60023),sync:T("sync",60023),clone:T("clone",60024),desktopDownload:T("desktop-download",60024),beaker:T("beaker",60025),microscope:T("microscope",60025),vm:T("vm",60026),deviceDesktop:T("device-desktop",60026),file:T("file",60027),fileText:T("file-text",60027),more:T("more",60028),ellipsis:T("ellipsis",60028),kebabHorizontal:T("kebab-horizontal",60028),mailReply:T("mail-reply",60029),reply:T("reply",60029),organization:T("organization",60030),organizationFilled:T("organization-filled",60030),organizationOutline:T("organization-outline",60030),newFile:T("new-file",60031),fileAdd:T("file-add",60031),newFolder:T("new-folder",60032),fileDirectoryCreate:T("file-directory-create",60032),trash:T("trash",60033),trashcan:T("trashcan",60033),history:T("history",60034),clock:T("clock",60034),folder:T("folder",60035),fileDirectory:T("file-directory",60035),symbolFolder:T("symbol-folder",60035),logoGithub:T("logo-github",60036),markGithub:T("mark-github",60036),github:T("github",60036),terminal:T("terminal",60037),console:T("console",60037),repl:T("repl",60037),zap:T("zap",60038),symbolEvent:T("symbol-event",60038),error:T("error",60039),stop:T("stop",60039),variable:T("variable",60040),symbolVariable:T("symbol-variable",60040),array:T("array",60042),symbolArray:T("symbol-array",60042),symbolModule:T("symbol-module",60043),symbolPackage:T("symbol-package",60043),symbolNamespace:T("symbol-namespace",60043),symbolObject:T("symbol-object",60043),symbolMethod:T("symbol-method",60044),symbolFunction:T("symbol-function",60044),symbolConstructor:T("symbol-constructor",60044),symbolBoolean:T("symbol-boolean",60047),symbolNull:T("symbol-null",60047),symbolNumeric:T("symbol-numeric",60048),symbolNumber:T("symbol-number",60048),symbolStructure:T("symbol-structure",60049),symbolStruct:T("symbol-struct",60049),symbolParameter:T("symbol-parameter",60050),symbolTypeParameter:T("symbol-type-parameter",60050),symbolKey:T("symbol-key",60051),symbolText:T("symbol-text",60051),symbolReference:T("symbol-reference",60052),goToFile:T("go-to-file",60052),symbolEnum:T("symbol-enum",60053),symbolValue:T("symbol-value",60053),symbolRuler:T("symbol-ruler",60054),symbolUnit:T("symbol-unit",60054),activateBreakpoints:T("activate-breakpoints",60055),archive:T("archive",60056),arrowBoth:T("arrow-both",60057),arrowDown:T("arrow-down",60058),arrowLeft:T("arrow-left",60059),arrowRight:T("arrow-right",60060),arrowSmallDown:T("arrow-small-down",60061),arrowSmallLeft:T("arrow-small-left",60062),arrowSmallRight:T("arrow-small-right",60063),arrowSmallUp:T("arrow-small-up",60064),arrowUp:T("arrow-up",60065),bell:T("bell",60066),bold:T("bold",60067),book:T("book",60068),bookmark:T("bookmark",60069),debugBreakpointConditionalUnverified:T("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:T("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:T("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:T("debug-breakpoint-data-unverified",60072),debugBreakpointData:T("debug-breakpoint-data",60073),debugBreakpointDataDisabled:T("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:T("debug-breakpoint-log-unverified",60074),debugBreakpointLog:T("debug-breakpoint-log",60075),debugBreakpointLogDisabled:T("debug-breakpoint-log-disabled",60075),briefcase:T("briefcase",60076),broadcast:T("broadcast",60077),browser:T("browser",60078),bug:T("bug",60079),calendar:T("calendar",60080),caseSensitive:T("case-sensitive",60081),check:T("check",60082),checklist:T("checklist",60083),chevronDown:T("chevron-down",60084),chevronLeft:T("chevron-left",60085),chevronRight:T("chevron-right",60086),chevronUp:T("chevron-up",60087),chromeClose:T("chrome-close",60088),chromeMaximize:T("chrome-maximize",60089),chromeMinimize:T("chrome-minimize",60090),chromeRestore:T("chrome-restore",60091),circleOutline:T("circle-outline",60092),circle:T("circle",60092),debugBreakpointUnverified:T("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:T("terminal-decoration-incomplete",60092),circleSlash:T("circle-slash",60093),circuitBoard:T("circuit-board",60094),clearAll:T("clear-all",60095),clippy:T("clippy",60096),closeAll:T("close-all",60097),cloudDownload:T("cloud-download",60098),cloudUpload:T("cloud-upload",60099),code:T("code",60100),collapseAll:T("collapse-all",60101),colorMode:T("color-mode",60102),commentDiscussion:T("comment-discussion",60103),creditCard:T("credit-card",60105),dash:T("dash",60108),dashboard:T("dashboard",60109),database:T("database",60110),debugContinue:T("debug-continue",60111),debugDisconnect:T("debug-disconnect",60112),debugPause:T("debug-pause",60113),debugRestart:T("debug-restart",60114),debugStart:T("debug-start",60115),debugStepInto:T("debug-step-into",60116),debugStepOut:T("debug-step-out",60117),debugStepOver:T("debug-step-over",60118),debugStop:T("debug-stop",60119),debug:T("debug",60120),deviceCameraVideo:T("device-camera-video",60121),deviceCamera:T("device-camera",60122),deviceMobile:T("device-mobile",60123),diffAdded:T("diff-added",60124),diffIgnored:T("diff-ignored",60125),diffModified:T("diff-modified",60126),diffRemoved:T("diff-removed",60127),diffRenamed:T("diff-renamed",60128),diff:T("diff",60129),diffSidebyside:T("diff-sidebyside",60129),discard:T("discard",60130),editorLayout:T("editor-layout",60131),emptyWindow:T("empty-window",60132),exclude:T("exclude",60133),extensions:T("extensions",60134),eyeClosed:T("eye-closed",60135),fileBinary:T("file-binary",60136),fileCode:T("file-code",60137),fileMedia:T("file-media",60138),filePdf:T("file-pdf",60139),fileSubmodule:T("file-submodule",60140),fileSymlinkDirectory:T("file-symlink-directory",60141),fileSymlinkFile:T("file-symlink-file",60142),fileZip:T("file-zip",60143),files:T("files",60144),filter:T("filter",60145),flame:T("flame",60146),foldDown:T("fold-down",60147),foldUp:T("fold-up",60148),fold:T("fold",60149),folderActive:T("folder-active",60150),folderOpened:T("folder-opened",60151),gear:T("gear",60152),gift:T("gift",60153),gistSecret:T("gist-secret",60154),gist:T("gist",60155),gitCommit:T("git-commit",60156),gitCompare:T("git-compare",60157),compareChanges:T("compare-changes",60157),gitMerge:T("git-merge",60158),githubAction:T("github-action",60159),githubAlt:T("github-alt",60160),globe:T("globe",60161),grabber:T("grabber",60162),graph:T("graph",60163),gripper:T("gripper",60164),heart:T("heart",60165),home:T("home",60166),horizontalRule:T("horizontal-rule",60167),hubot:T("hubot",60168),inbox:T("inbox",60169),issueReopened:T("issue-reopened",60171),issues:T("issues",60172),italic:T("italic",60173),jersey:T("jersey",60174),json:T("json",60175),kebabVertical:T("kebab-vertical",60176),key:T("key",60177),law:T("law",60178),lightbulbAutofix:T("lightbulb-autofix",60179),linkExternal:T("link-external",60180),link:T("link",60181),listOrdered:T("list-ordered",60182),listUnordered:T("list-unordered",60183),liveShare:T("live-share",60184),loading:T("loading",60185),location:T("location",60186),mailRead:T("mail-read",60187),mail:T("mail",60188),markdown:T("markdown",60189),megaphone:T("megaphone",60190),mention:T("mention",60191),milestone:T("milestone",60192),gitPullRequestMilestone:T("git-pull-request-milestone",60192),mortarBoard:T("mortar-board",60193),move:T("move",60194),multipleWindows:T("multiple-windows",60195),mute:T("mute",60196),noNewline:T("no-newline",60197),note:T("note",60198),octoface:T("octoface",60199),openPreview:T("open-preview",60200),package:T("package",60201),paintcan:T("paintcan",60202),pin:T("pin",60203),play:T("play",60204),run:T("run",60204),plug:T("plug",60205),preserveCase:T("preserve-case",60206),preview:T("preview",60207),project:T("project",60208),pulse:T("pulse",60209),question:T("question",60210),quote:T("quote",60211),radioTower:T("radio-tower",60212),reactions:T("reactions",60213),references:T("references",60214),refresh:T("refresh",60215),regex:T("regex",60216),remoteExplorer:T("remote-explorer",60217),remote:T("remote",60218),remove:T("remove",60219),replaceAll:T("replace-all",60220),replace:T("replace",60221),repoClone:T("repo-clone",60222),repoForcePush:T("repo-force-push",60223),repoPull:T("repo-pull",60224),repoPush:T("repo-push",60225),report:T("report",60226),requestChanges:T("request-changes",60227),rocket:T("rocket",60228),rootFolderOpened:T("root-folder-opened",60229),rootFolder:T("root-folder",60230),rss:T("rss",60231),ruby:T("ruby",60232),saveAll:T("save-all",60233),saveAs:T("save-as",60234),save:T("save",60235),screenFull:T("screen-full",60236),screenNormal:T("screen-normal",60237),searchStop:T("search-stop",60238),server:T("server",60240),settingsGear:T("settings-gear",60241),settings:T("settings",60242),shield:T("shield",60243),smiley:T("smiley",60244),sortPrecedence:T("sort-precedence",60245),splitHorizontal:T("split-horizontal",60246),splitVertical:T("split-vertical",60247),squirrel:T("squirrel",60248),starFull:T("star-full",60249),starHalf:T("star-half",60250),symbolClass:T("symbol-class",60251),symbolColor:T("symbol-color",60252),symbolConstant:T("symbol-constant",60253),symbolEnumMember:T("symbol-enum-member",60254),symbolField:T("symbol-field",60255),symbolFile:T("symbol-file",60256),symbolInterface:T("symbol-interface",60257),symbolKeyword:T("symbol-keyword",60258),symbolMisc:T("symbol-misc",60259),symbolOperator:T("symbol-operator",60260),symbolProperty:T("symbol-property",60261),wrench:T("wrench",60261),wrenchSubaction:T("wrench-subaction",60261),symbolSnippet:T("symbol-snippet",60262),tasklist:T("tasklist",60263),telescope:T("telescope",60264),textSize:T("text-size",60265),threeBars:T("three-bars",60266),thumbsdown:T("thumbsdown",60267),thumbsup:T("thumbsup",60268),tools:T("tools",60269),triangleDown:T("triangle-down",60270),triangleLeft:T("triangle-left",60271),triangleRight:T("triangle-right",60272),triangleUp:T("triangle-up",60273),twitter:T("twitter",60274),unfold:T("unfold",60275),unlock:T("unlock",60276),unmute:T("unmute",60277),unverified:T("unverified",60278),verified:T("verified",60279),versions:T("versions",60280),vmActive:T("vm-active",60281),vmOutline:T("vm-outline",60282),vmRunning:T("vm-running",60283),watch:T("watch",60284),whitespace:T("whitespace",60285),wholeWord:T("whole-word",60286),window:T("window",60287),wordWrap:T("word-wrap",60288),zoomIn:T("zoom-in",60289),zoomOut:T("zoom-out",60290),listFilter:T("list-filter",60291),listFlat:T("list-flat",60292),listSelection:T("list-selection",60293),selection:T("selection",60293),listTree:T("list-tree",60294),debugBreakpointFunctionUnverified:T("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:T("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:T("debug-breakpoint-function-disabled",60296),debugStackframeActive:T("debug-stackframe-active",60297),circleSmallFilled:T("circle-small-filled",60298),debugStackframeDot:T("debug-stackframe-dot",60298),terminalDecorationMark:T("terminal-decoration-mark",60298),debugStackframe:T("debug-stackframe",60299),debugStackframeFocused:T("debug-stackframe-focused",60299),debugBreakpointUnsupported:T("debug-breakpoint-unsupported",60300),symbolString:T("symbol-string",60301),debugReverseContinue:T("debug-reverse-continue",60302),debugStepBack:T("debug-step-back",60303),debugRestartFrame:T("debug-restart-frame",60304),debugAlt:T("debug-alt",60305),callIncoming:T("call-incoming",60306),callOutgoing:T("call-outgoing",60307),menu:T("menu",60308),expandAll:T("expand-all",60309),feedback:T("feedback",60310),gitPullRequestReviewer:T("git-pull-request-reviewer",60310),groupByRefType:T("group-by-ref-type",60311),ungroupByRefType:T("ungroup-by-ref-type",60312),account:T("account",60313),gitPullRequestAssignee:T("git-pull-request-assignee",60313),bellDot:T("bell-dot",60314),debugConsole:T("debug-console",60315),library:T("library",60316),output:T("output",60317),runAll:T("run-all",60318),syncIgnored:T("sync-ignored",60319),pinned:T("pinned",60320),githubInverted:T("github-inverted",60321),serverProcess:T("server-process",60322),serverEnvironment:T("server-environment",60323),pass:T("pass",60324),issueClosed:T("issue-closed",60324),stopCircle:T("stop-circle",60325),playCircle:T("play-circle",60326),record:T("record",60327),debugAltSmall:T("debug-alt-small",60328),vmConnect:T("vm-connect",60329),cloud:T("cloud",60330),merge:T("merge",60331),export:T("export",60332),graphLeft:T("graph-left",60333),magnet:T("magnet",60334),notebook:T("notebook",60335),redo:T("redo",60336),checkAll:T("check-all",60337),pinnedDirty:T("pinned-dirty",60338),passFilled:T("pass-filled",60339),circleLargeFilled:T("circle-large-filled",60340),circleLarge:T("circle-large",60341),circleLargeOutline:T("circle-large-outline",60341),combine:T("combine",60342),gather:T("gather",60342),table:T("table",60343),variableGroup:T("variable-group",60344),typeHierarchy:T("type-hierarchy",60345),typeHierarchySub:T("type-hierarchy-sub",60346),typeHierarchySuper:T("type-hierarchy-super",60347),gitPullRequestCreate:T("git-pull-request-create",60348),runAbove:T("run-above",60349),runBelow:T("run-below",60350),notebookTemplate:T("notebook-template",60351),debugRerun:T("debug-rerun",60352),workspaceTrusted:T("workspace-trusted",60353),workspaceUntrusted:T("workspace-untrusted",60354),workspaceUnknown:T("workspace-unknown",60355),terminalCmd:T("terminal-cmd",60356),terminalDebian:T("terminal-debian",60357),terminalLinux:T("terminal-linux",60358),terminalPowershell:T("terminal-powershell",60359),terminalTmux:T("terminal-tmux",60360),terminalUbuntu:T("terminal-ubuntu",60361),terminalBash:T("terminal-bash",60362),arrowSwap:T("arrow-swap",60363),copy:T("copy",60364),personAdd:T("person-add",60365),filterFilled:T("filter-filled",60366),wand:T("wand",60367),debugLineByLine:T("debug-line-by-line",60368),inspect:T("inspect",60369),layers:T("layers",60370),layersDot:T("layers-dot",60371),layersActive:T("layers-active",60372),compass:T("compass",60373),compassDot:T("compass-dot",60374),compassActive:T("compass-active",60375),azure:T("azure",60376),issueDraft:T("issue-draft",60377),gitPullRequestClosed:T("git-pull-request-closed",60378),gitPullRequestDraft:T("git-pull-request-draft",60379),debugAll:T("debug-all",60380),debugCoverage:T("debug-coverage",60381),runErrors:T("run-errors",60382),folderLibrary:T("folder-library",60383),debugContinueSmall:T("debug-continue-small",60384),beakerStop:T("beaker-stop",60385),graphLine:T("graph-line",60386),graphScatter:T("graph-scatter",60387),pieChart:T("pie-chart",60388),bracket:T("bracket",60175),bracketDot:T("bracket-dot",60389),bracketError:T("bracket-error",60390),lockSmall:T("lock-small",60391),azureDevops:T("azure-devops",60392),verifiedFilled:T("verified-filled",60393),newline:T("newline",60394),layout:T("layout",60395),layoutActivitybarLeft:T("layout-activitybar-left",60396),layoutActivitybarRight:T("layout-activitybar-right",60397),layoutPanelLeft:T("layout-panel-left",60398),layoutPanelCenter:T("layout-panel-center",60399),layoutPanelJustify:T("layout-panel-justify",60400),layoutPanelRight:T("layout-panel-right",60401),layoutPanel:T("layout-panel",60402),layoutSidebarLeft:T("layout-sidebar-left",60403),layoutSidebarRight:T("layout-sidebar-right",60404),layoutStatusbar:T("layout-statusbar",60405),layoutMenubar:T("layout-menubar",60406),layoutCentered:T("layout-centered",60407),target:T("target",60408),indent:T("indent",60409),recordSmall:T("record-small",60410),errorSmall:T("error-small",60411),terminalDecorationError:T("terminal-decoration-error",60411),arrowCircleDown:T("arrow-circle-down",60412),arrowCircleLeft:T("arrow-circle-left",60413),arrowCircleRight:T("arrow-circle-right",60414),arrowCircleUp:T("arrow-circle-up",60415),layoutSidebarRightOff:T("layout-sidebar-right-off",60416),layoutPanelOff:T("layout-panel-off",60417),layoutSidebarLeftOff:T("layout-sidebar-left-off",60418),blank:T("blank",60419),heartFilled:T("heart-filled",60420),map:T("map",60421),mapHorizontal:T("map-horizontal",60421),foldHorizontal:T("fold-horizontal",60421),mapFilled:T("map-filled",60422),mapHorizontalFilled:T("map-horizontal-filled",60422),foldHorizontalFilled:T("fold-horizontal-filled",60422),circleSmall:T("circle-small",60423),bellSlash:T("bell-slash",60424),bellSlashDot:T("bell-slash-dot",60425),commentUnresolved:T("comment-unresolved",60426),gitPullRequestGoToChanges:T("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:T("git-pull-request-new-changes",60428),searchFuzzy:T("search-fuzzy",60429),commentDraft:T("comment-draft",60430),send:T("send",60431),sparkle:T("sparkle",60432),insert:T("insert",60433),mic:T("mic",60434),thumbsdownFilled:T("thumbsdown-filled",60435),thumbsupFilled:T("thumbsup-filled",60436),coffee:T("coffee",60437),snake:T("snake",60438),game:T("game",60439),vr:T("vr",60440),chip:T("chip",60441),piano:T("piano",60442),music:T("music",60443),micFilled:T("mic-filled",60444),repoFetch:T("repo-fetch",60445),copilot:T("copilot",60446),lightbulbSparkle:T("lightbulb-sparkle",60447),robot:T("robot",60448),sparkleFilled:T("sparkle-filled",60449),diffSingle:T("diff-single",60450),diffMultiple:T("diff-multiple",60451),surroundWith:T("surround-with",60452),share:T("share",60453),gitStash:T("git-stash",60454),gitStashApply:T("git-stash-apply",60455),gitStashPop:T("git-stash-pop",60456),vscode:T("vscode",60457),vscodeInsiders:T("vscode-insiders",60458),codeOss:T("code-oss",60459),runCoverage:T("run-coverage",60460),runAllCoverage:T("run-all-coverage",60461),coverage:T("coverage",60462),githubProject:T("github-project",60463),mapVertical:T("map-vertical",60464),foldVertical:T("fold-vertical",60464),mapVerticalFilled:T("map-vertical-filled",60465),foldVerticalFilled:T("fold-vertical-filled",60465),goToSearch:T("go-to-search",60466),percentage:T("percentage",60467),sortPercentage:T("sort-percentage",60467),attach:T("attach",60468)};var Aut={dialogError:T("dialog-error","error"),dialogWarning:T("dialog-warning","warning"),dialogInfo:T("dialog-info","info"),dialogClose:T("dialog-close","close"),treeItemExpanded:T("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:T("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:T("tree-filter-on-type-off","list-selection"),treeFilterClear:T("tree-filter-clear","close"),treeItemLoading:T("tree-item-loading","loading"),menuSelection:T("menu-selection","check"),menuSubmenu:T("menu-submenu","chevron-right"),menuBarMore:T("menubar-more","more"),scrollbarButtonLeft:T("scrollbar-button-left","triangle-left"),scrollbarButtonRight:T("scrollbar-button-right","triangle-right"),scrollbarButtonUp:T("scrollbar-button-up","triangle-up"),scrollbarButtonDown:T("scrollbar-button-down","triangle-down"),toolBarMore:T("toolbar-more","more"),quickInputBack:T("quick-input-back","arrow-left"),dropDownButton:T("drop-down-button",60084),symbolCustomColor:T("symbol-customcolor",60252),exportIcon:T("export",60332),workspaceUnspecified:T("workspace-unspecified",60355),newLine:T("newline",60394),thumbsDownFilled:T("thumbsdown-filled",60435),thumbsUpFilled:T("thumbsup-filled",60436),gitFetch:T("git-fetch",60445),lightbulbSparkleAutofix:T("lightbulb-sparkle-autofix",60447),debugBreakpointPending:T("debug-breakpoint-pending",60377)},kn={...Dke,...Aut};var vk=class{constructor(e){this.accessor=e}async findEnclosingBlocks(e,r){let n=this.accessor.get(dt).getTreeSitterAST(e);if(n===void 0)return;let o=_o(r,e);return(await n.getFineScopes(o))?.map(a=>{let c=Os(e,a);return{kind:"code",name:e.lineAt(c.start).text.trim(),range:c}})}findEnclosingSymbols(e,r){for(let n of e)if(n.range.contains(r)){let o=this.findEnclosingSymbols(n.children,r);return o?[n,...o]:[n]}}async selectEnclosingScope(e,r){let n=await this.accessor.get(jo).getDocumentSymbols(e.document.uri);if(!n||n.length>0&&!n[0].hasOwnProperty("children"))return;let o=e.selection;if(!o.isEmpty)return;let s=this.findEnclosingSymbols(n,e.selection.active);if(r?.includeBlocks&&s?.push(...await this.findEnclosingBlocks(e.document,e.selection)??[]),s||(s=n),s?.length===1){let a=s[0];e.selection=new rO.Selection(a.range.start,a.range.end)}else if(s&&s.length>1||!s&&n.length>1){let a=s.sort((l,u)=>u.range.start.line-l.range.start.line).map(l=>({label:`$(${l.kind==="code"?"code":Nke.toIcon(l.kind).id}) ${l.name}`,description:`:${l.range.start.line+1}-${l.range.end.line+1}`,symbol:l}));if(!await this.accessor.get(ZU).showQuickPick(a,{placeHolder:r?.reason??rO.l10n.t("Select an enclosing range"),onDidSelectItem(l){let u=l.symbol;u&&(e.selection=new rO.Selection(u.range.start,u.range.end),e.revealRange(u.range))}}))throw e.selection=o,new dn}return e.selection}};vk=E([y(0,Rt)],vk);var Nke;(r=>{let t=new Map;t.set(0,kn.symbolFile),t.set(1,kn.symbolModule),t.set(2,kn.symbolNamespace),t.set(3,kn.symbolPackage),t.set(4,kn.symbolClass),t.set(5,kn.symbolMethod),t.set(6,kn.symbolProperty),t.set(7,kn.symbolField),t.set(8,kn.symbolConstructor),t.set(9,kn.symbolEnum),t.set(10,kn.symbolInterface),t.set(11,kn.symbolFunction),t.set(12,kn.symbolVariable),t.set(13,kn.symbolConstant),t.set(14,kn.symbolString),t.set(15,kn.symbolNumber),t.set(16,kn.symbolBoolean),t.set(17,kn.symbolArray),t.set(18,kn.symbolObject),t.set(19,kn.symbolKey),t.set(20,kn.symbolNull),t.set(21,kn.symbolEnumMember),t.set(22,kn.symbolStruct),t.set(23,kn.symbolEvent),t.set(24,kn.symbolOperator),t.set(25,kn.symbolTypeParameter);function e(n){let o=t.get(n);return o||(console.info("No codicon found for SymbolKind "+n),o=kn.symbolProperty),o}r.toIcon=e})(Nke||={});var Wx=class extends ck{constructor(r,n){super();this._ignoreService=r;this._logService=n}async findFilesWithDefaultExcludes(r,n,o){let s=await this._ignoreService.asMinimatchPattern(),a=await this._findFilesWithDefaultExcludesAndExcludes(r,s,n,o);return!this._ignoreService.isRegexExclusionsEnabled||!a?a:Array.isArray(a)?await oW(this._ignoreService,a):await this._ignoreService.isCopilotIgnored(a)?void 0:a}async findFiles(r,n,o){let s=await this._ignoreService.asMinimatchPattern();n?.exclude?n={...n,exclude:s?L0e(n.exclude,s):n.exclude}:n={...n,exclude:s};let a=await super.findFiles(r,n,o);return this._ignoreService.isRegexExclusionsEnabled?await oW(this._ignoreService,a):a}async findTextInFiles(r,n,o,s){let a={report:async c=>{await this._ignoreService.isCopilotIgnored(c.uri)||o.report(c)}};return super.findTextInFiles(r,n,a,s)}};E([Vo(r=>r._logService)],Wx.prototype,"findFiles",1),Wx=E([y(0,Te),y(1,ie)],Wx);var OB=q(require("vscode")),nO=require("vscode");var Dut="https://aka.ms/vscode-gh-copilot",Lke="survey.usage",Oke="survey.nextSurveyDate",Ore=14*24*60*60*1e3,Nut=7,Lut=90,Out=3*60*1e3,Mut=5*60*1e3,Fut=2,yk=class{constructor(e,r,n,o,s){this.telemetryService=e;this.vscodeExtensionContext=r;this.envService=n;this.experimentationService=o;this.authenticationService=s;this.debounceTimeout=null;this.lastSource=null;this.lastLanguageId=null;this.surveyUri=nr.parse(Dut),this.sessionSeed=Math.random(),setTimeout(async()=>{await this.checkInactiveUserHeuristic()&&this.promptSurvey()},Mut)}async signalUsage(e,r){await this.updateUsageData(),this.lastSource=e,r&&(this.lastLanguageId=r),this.debounceTimeout||(this.debounceTimeout=setTimeout(async()=>{await this.checkEligibility()&&this.promptSurvey(),this.debounceTimeout=null},Out))}async checkInactiveUserHeuristic(){let e=await this.getUsageData(),r=await this.getNextSurveyDate(),n=Date.now(),o=e.activeDays.length,s=e.firstActive>0&&e.firstActive<n-Ore,a=!r||r<n;if(o===0&&s&&a){let u=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.feedback.sessionProbability.inactive")??0;if(this.sessionSeed<u/100){let d=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.feedback.notificationProbability.inactive")??0;return Math.random()<d/100}}return!1}async checkEligibility(){let e=await this.getUsageData(),r=await this.getNextSurveyDate(),n=Date.now(),o=e.activeDays.length,s=e.firstActive<n-Ore,a=!r||r<n;if(o>=Fut&&s&&a){let u=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.feedback.sessionProbability")??0;if(this.sessionSeed<u/100){let d=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.feedback.notificationProbability")??0;return Math.random()<d/100}}return!1}async getUsageData(){let e=this.vscodeExtensionContext.globalState.get(Lke);return e||{firstActive:0,activeDays:[]}}async getNextSurveyDate(){return this.vscodeExtensionContext.globalState.get(Oke)??null}async updateUsageData(){let e=await this.getUsageData(),r=Date.now(),n=new Date().setHours(0,0,0,0);e.firstActive||(e.firstActive=r),e.activeDays.includes(n)||e.activeDays.push(n),e.activeDays=e.activeDays.filter(o=>o>=r-Ore),await this.vscodeExtensionContext.globalState.update(Lke,e)}async updateNextSurveyDate(e){await this.vscodeExtensionContext.globalState.update(Oke,Date.now()+e*24*60*60*1e3)}async promptSurvey(){let e=await this.getUsageData(),r=this.lastSource||"",n=this.lastLanguageId||"",o=Math.floor((Date.now()-e.firstActive)/(1e3*60*60*24));this.telemetryService.sendMSFTTelemetryEvent("survey.show",{source:r,language:n},{activeDays:e.activeDays.length,firstActive:o}),await this.updateNextSurveyDate(Lut);let s=nO.l10n.t("Give Feedback"),a=nO.l10n.t("Later"),c=nO.l10n.t("Skip");OB.window.showInformationMessage(nO.l10n.t("Got a minute? Help us make GitHub Copilot better."),s,a,c).then(async l=>{let u=l===s,d=l===a;if(this.telemetryService.sendMSFTTelemetryEvent("survey.action",{source:r,language:n,selection:u?"accepted":d?"postponed":"skipped"}),u){let p=await this.authenticationService.getCopilotToken(),f={m:this.envService.machineId,s:this.envService.sessionId,k:p.sku??"",d:e.activeDays.length.toString(),f:o.toString(),v:this.envService.getVersion(),l:n,src:r},m=this.surveyUri.with({query:new URLSearchParams(f).toString()});OB.env.openExternal(m)}else d&&await this.updateNextSurveyDate(Nut)})}};yk=E([y(0,ge),y(1,Bt),y(2,gt),y(3,Lt),y(4,Tt)],yk);var Es=q(require("vscode"));var MB=class{constructor(){this._store=new ht;this._tabGroupsUseInfo=new Map;this._tabClock=0;this.onDidChangeActiveTextEditor=Es.window.onDidChangeActiveTextEditor;this.onDidChangeTabs=Es.window.tabGroups.onDidChangeTabs;let e=()=>this._tabGroupsUseInfo.set(Es.window.tabGroups.activeTabGroup,this._tabClock++);e(),this._store.add(Es.window.tabGroups.onDidChangeTabGroups(r=>{r.closed.forEach(n=>this._tabGroupsUseInfo.delete(n)),e()}))}dispose(){this._store.dispose()}get activeTextEditor(){let e=Es.window.activeTextEditor;if(e&&e.document.uri.scheme!=="output")return e;let r=new Nr;Es.window.visibleTextEditors.forEach(o=>r.set(o.document.uri,o));let n=[...this._tabGroupsUseInfo];n.sort((o,s)=>s[1]-o[1]);for(let[o]of n)if(o.activeTab){let s=this._asTabInfo(o.activeTab);if(s.uri&&r.has(s.uri))return r.get(s.uri)}}get visibleTextEditors(){return Es.window.visibleTextEditors}get activeNotebookEditor(){return Es.window.activeNotebookEditor}get tabs(){return Es.window.tabGroups.all.flatMap(e=>e.tabs).map(this._asTabInfo,this)}_asTabInfo(e){let r;return e.input instanceof Es.TabInputText||e.input instanceof Es.TabInputNotebook?r=e.input.uri:(e.input instanceof Es.TabInputTextDiff||e.input instanceof Es.TabInputNotebookDiff)&&(r=e.input.modified),{tab:e,uri:r}}};var FB=class{dispose(){}sendInternalMSFTTelemetryEvent(e,r,n){}sendMSFTTelemetryEvent(e,r,n){}sendMSFTTelemetryErrorEvent(e,r,n){}sendGHTelemetryEvent(e,r,n){}sendGHTelemetryErrorEvent(e,r,n){}sendGHTelemetryException(e,r){}sendTelemetryEvent(e,r,n,o){}sendTelemetryErrorEvent(e,r,n,o){}setSharedProperty(e,r){}postEvent(e,r){}sendRestrictedGHTelemetryEvent(e,r,n){}sendRestrictedGHTelemetryErrorEvent(e,r,n){}};var T6e=q(C6e()),VV=q(require("os")),MR=class{constructor(e,r,n,o){this.namespace=n;this.client=QCt(e,r,o),E6e(e,r,this.client)}separateData(e){if(e.properties!==void 0||e.measurements!==void 0)return e.properties=e.properties||{},e.measurements=e.measurements||{},e;let r={},n={};for(let[o,s]of Object.entries(e))typeof s=="number"?n[o]=s:r[o]=s;return{properties:r,measurements:n}}sendEventData(e,r){let{properties:n,measurements:o}=this.separateData(r||{});this.client.trackEvent({name:this.qualifyEventName(e),properties:n,measurements:o})}sendErrorData(e,r){let{properties:n,measurements:o}=this.separateData(r||{});this.client.trackException({exception:e,properties:n,measurements:o})}flush(){return new Promise(e=>{this.client.flush({callback:()=>{e(void 0)}})})}qualifyEventName(e){return e.includes(this.namespace)?e:`${this.namespace}/${e}`}};function QCt(t,e,r){let n=new T6e.TelemetryClient(r);return n.config.enableAutoCollectRequests=!1,n.config.enableAutoCollectPerformance=!1,n.config.enableAutoCollectExceptions=!1,n.config.enableAutoCollectConsole=!1,n.config.enableAutoCollectDependencies=!1,n.config.noDiagnosticChannel=!0,E6e(t,e,n),n}function E6e(t,e,r){r.commonProperties=XCt(r.commonProperties,e),r.context.tags[r.context.keys.cloudRoleInstance]="REDACTED",r.config.endpointUrl=t.telemetryURL}function XCt(t,e){return t=t||{},t.common_os=VV.platform(),t.common_platformversion=VV.release(),t.common_vscodemachineid=e.machineId,t.common_vscodesessionid=e.sessionId,t.common_uikind="desktop",t.common_remotename="none",t.common_isnewappinstall="",t}var w6e="7d7048df-6dd0-4048-bb23-b716c1461f8f",k6e="3fdd7f28-937a-48c8-9a21-ba337db23bd1";var A4=q(z6e());function yTt(t){return t?A4.TargetPopulation.Insiders:A4.TargetPopulation.Public}function $6e(t,e,r){let n=t.extension.id,o=t.extension.packageJSON.version,s=yTt(r);return(0,A4.getExperimentationService)(n,o,s,e,t.globalState)}var eH=class{constructor(e,r,n){this._tokenStore=e;this._microsoftTelemetrySender=r;this._ghTelemetrySender=n;this._sharedProperties={};this._disposables=[];this._disposables.push(this._microsoftTelemetrySender,this._ghTelemetrySender),this._disposables.push(e.onDidStoreUpdate(()=>{let o=e.copilotToken;o&&this.sendMSFTTelemetryEvent("token",void 0,{chatEnabled:o.isChatEnabled()?1:0,snippyEnabled:o.isPublicSuggestionsEnabled()?1:0,telemetryEnabled:o.isTelemetryEnabled()?1:0})}))}dispose(){this._disposables.forEach(e=>e.dispose())}sendMSFTTelemetryEvent(e,r,n){this.sendTelemetryEvent(e,{github:!1,microsoft:!0},r,n)}sendMSFTTelemetryErrorEvent(e,r,n){this.sendTelemetryErrorEvent(e,{github:!1,microsoft:!0},r,n)}sendGHTelemetryEvent(e,r,n){this.sendTelemetryEvent(e,{github:!0,microsoft:!1},r,n)}sendGHTelemetryErrorEvent(e,r,n){this.sendTelemetryErrorEvent(e,{github:!0,microsoft:!1},r,n)}sendGHTelemetryException(e,r){this._ghTelemetrySender.sendExceptionTelemetry(e,r)}sendRestrictedGHTelemetryEvent(e,r,n){r={...r,...this._sharedProperties},this._ghTelemetrySender.sendRestrictedTelemetryEvent(e,r,n)}sendRestrictedGHTelemetryErrorEvent(e,r,n){r={...r,...this._sharedProperties},this._ghTelemetrySender.sendRestrictedTelemetryErrorEvent(e,r,n)}sendInternalMSFTTelemetryEvent(e,r,n){r={...r,...this._sharedProperties},this._microsoftTelemetrySender.sendInternalTelemetryEvent(e,r,n)}sendTelemetryEvent(e,r,n,o){n={...n,...this._sharedProperties},r.github&&this._ghTelemetrySender.sendTelemetryEvent(e,n,o),r.microsoft&&this._microsoftTelemetrySender.sendTelemetryEvent(e,n,o)}sendTelemetryErrorEvent(e,r,n,o){n={...n,...this._sharedProperties},r.github&&this._ghTelemetrySender.sendTelemetryErrorEvent(e,n,o),r.microsoft&&this._microsoftTelemetrySender.sendTelemetryErrorEvent(e,n,o)}setSharedProperty(e,r){this._sharedProperties[e]=r}postEvent(e,r){for(let[n,o]of Object.entries(this._sharedProperties))r.set(n,o);this._microsoftTelemetrySender.postEvent(e,r)}};var Vce=require("vscode");function W6e(t){return t.replace(/([\s|(]|file:\/\/)(\/[^\s]+)/g,"$1[redacted]").replace(/([\s|(]|file:\/\/)([a-zA-Z]:[(\\|/){1,2}][^\s]+)/gi,"$1[redacted]").replace(/([\s|(]|file:\/\/)(\\[^\s]+)/gi,"$1[redacted]")}var tH=class{constructor(e,r,n,o,s,a){this._createTelemetryLogger=r;this._configService=n;this._telemetryConfig=o;this._envService=s;this._domainService=a;this._disposables=new ht;this._processToken(e.copilotToken),this._nonRestrictedTelemetryLogger=this._createTelemetryLogger(!1),this._disposables.add(e.onDidStoreUpdate(()=>{let c=e.copilotToken;this._processToken(c)})),this._disposables.add(this._domainService.onDidChangeDomains(()=>{this._nonRestrictedTelemetryLogger.dispose(),this._nonRestrictedTelemetryLogger=this._createTelemetryLogger(!1),this._restrictedTelemetryLogger&&(this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=this._createTelemetryLogger(!0))}))}_processToken(e){e||this._restrictedTelemetryLogger&&(this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=void 0),e?.getTokenValue("rt")==="1"?this._restrictedTelemetryLogger=this._createTelemetryLogger(!0):(this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=void 0)}sendTelemetryEvent(e,r,n){this._nonRestrictedTelemetryLogger.logUsage(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendTelemetryErrorEvent(e,r,n){this._nonRestrictedTelemetryLogger.logError(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendRestrictedTelemetryEvent(e,r,n){this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logUsage(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendRestrictedTelemetryErrorEvent(e,r,n){this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logError(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendExceptionTelemetry(e,r){let n=e instanceof Error?e:new Error("Non-error thrown: "+e),o=ci.createAndMarkAsIssued({origin:W6e(r),reason:this._restrictedTelemetryLogger?"Exception logged to restricted telemetry":"Exception, not logged due to opt-out"});if(o.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this.sendTelemetryEvent("exception",o.properties,o.measurements),!this._restrictedTelemetryLogger)return;let s=ci.createAndMarkAsIssued({origin:r});s.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this._restrictedTelemetryLogger.logError(n,s)}markAsIssuedAndMakeReadyForSending(e,r){let n=ci.createAndMarkAsIssued(Jhe(e),r);n.makeReadyForSending(this._configService,this._envService,this._telemetryConfig);let o={};for(let s in n.properties)o[s]=new aI(n.properties[s]);return{properties:o,measurements:n.measurements}}dispose(){this._nonRestrictedTelemetryLogger.dispose(),this._disposables.dispose(),this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose()}};var rH=class extends tH{constructor(e,r,n,o,s,a,c,l){let u=d=>d?Vce.env.createTelemetryLogger(new MR(o,r,s,c),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}):Vce.env.createTelemetryLogger(new MR(o,r,s,a),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0});super(l,u,e,n,r,o)}};var Upe=q(Nqe());var d$=class{constructor(e,r){this._createTelemetryReporter=r;this._disposables=new ht;this._vscodeTeamMember=!1;this._isInternal=!1;this._externalTelemetryReporter=this._createTelemetryReporter(!1),this.processToken(e.copilotToken),this._disposables.add(e.onDidStoreUpdate(()=>this.processToken(e.copilotToken)))}postEvent(e,r){let n={};for(let[o,s]of r)n[o]=s;this._isInternal&&this.sendInternalTelemetryEvent(e,n),this.sendTelemetryEvent(e,n)}sendInternalTelemetryEvent(e,r,n){this._internalTelemetryReporter&&(r={...r,"common.tid":this._tid,"common.userName":this._username??"undefined"},n={...n,"common.isVscodeTeamMember":this._vscodeTeamMember?1:0},this._internalTelemetryReporter.sendRawTelemetryEvent(e,r,n))}sendTelemetryEvent(e,r,n){r={...r,"common.tid":this._tid??"","common.sku":this._sku??"undefined"},this._isInternal&&(n={...n,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryEvent(e,r,n)}sendTelemetryErrorEvent(e,r,n){r={...r,"common.tid":this._tid??"","common.sku":this._sku??"undefined"},this._isInternal&&(n={...n,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryErrorEvent(e,r,n)}dispose(){this._externalTelemetryReporter.dispose(),this._internalTelemetryReporter?.dispose()}processToken(e){if(this._username=e?.username,this._vscodeTeamMember=!!e?.isVscodeTeamMember,this._tid=e?.getTokenValue("tid"),this._sku=e?.sku,this._isInternal=!!e?.isInternal,this._isInternal&&!this._internalTelemetryReporter&&(this._internalTelemetryReporter=this._createTelemetryReporter(!0)),!e||!this._isInternal||!e.isChatEnabled()){this._internalTelemetryReporter?.dispose(),this._internalTelemetryReporter=void 0;return}}};var p$=class extends d${constructor(e,r,n){let o=s=>s?new Upe.default(e):new Upe.default(r);super(n,o)}};var cA=class extends eH{constructor(e,r,n,o,s,a,c,l,u,d){let p=new p$(r,n,c),f=new rH(a,l,u,d,e,o,s,c);super(c,p,f)}};cA=E([y(5,he),y(6,ac),y(7,gt),y(8,cF),y(9,en)],cA);var Oqe=require("path"),Mqe=require("process"),i_=require("vscode"),f$=new Map,qpe=new Map;function Fqe(){let t=i_.window.activeTerminal;return t===void 0?"":f$.get(t)?.join(`
`)||""}function Uqe(){let t=i_.window.activeTerminal;if(t!==void 0)return qpe.get(t)?.at(-1)}function Bqe(){try{return i_.window.activeTerminal?.selection??""}catch{return""}}var Bpe;function qqe(){let t=i_.window.activeTerminal;if(t&&"shellPath"in t.creationOptions){let e=t.creationOptions.shellPath;if(e){let r,n=(0,Oqe.basename)(e);if(n==="bash.exe")r="Git Bash";else{let o=n.replace(/\..+/,"");switch(o){case"pwsh":case"powershell":r="powershell";break;case"":break;default:r=o}}if(r)return Bpe=r,r}}return Bpe||(Mqe.platform==="win32"?"powershell":"bash")}function Lqe(t,e){t.push(e),t.length>40&&t.shift()}function _kt(t){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return t&&(t=t.replace(e,"")),t}function jqe(){return[i_.window.onDidWriteTerminalData(t=>{let e=f$.get(t.terminal);e||(e=[],f$.set(t.terminal,e)),Lqe(e,_kt(t.data))}),i_.window.onDidExecuteTerminalCommand(t=>{let e=qpe.get(t.terminal);e||(e=[],qpe.set(t.terminal,e)),Lqe(e,t)}),i_.window.onDidCloseTerminal(t=>{f$.delete(t)})]}var m$=class extends Oe{constructor(){super();for(let e of jqe())this._register(e)}get terminalBuffer(){return Fqe()}get terminalLastCommand(){return Uqe()}get terminalSelection(){return Bqe()}get terminalShellType(){return qqe()}};var rc=q(require("vscode"));var lA=class extends Oe{constructor(r){super();this.configService=r;this.resultsDocs=new Nr;this.isEnabled=yme(this.configService,le.FixTestFailure);this._register(rc.tests.onDidChangeTestResults(()=>this.setHasFailureContextKey())),this.setHasFailureContextKey()}setHasFailureContextKey(){rc.commands.executeCommand("setContext","github.copilot.chat.fixTestFailures.hasFailure",!!_i.first(this.getAllFailures()))}get lastResultsFrom(){return rc.tests.testResults[0]?.completedAt}getAllFailures(){let r=rc.tests.testResults[0];return r?this.dfsFailures(r.results):_i.empty()}getFailureAtPosition(r,n){let o=rc.tests.testResults[0];if(this.resultsDocsAreForTestRun!==o&&this.makeResultsDocs(o),!o)return;let s=this.resultsDocs.get(r)||[],a=gM(s,c=>!c.range?.start.isAfter(n));if(a){for(let c of a.taskStates)if(c.state===rc.TestResultState.Failed||c.state===rc.TestResultState.Errored)return{snapshot:a,task:c}}}async hasAnyTests(){return!!(await rc.commands.executeCommand("vscode.testing.getControllersWithTests")).length}*dfsFailures(r){for(let n of r){yield*this.dfsFailures(n.children);for(let o of n.taskStates)(o.state===rc.TestResultState.Failed||o.state===rc.TestResultState.Errored)&&(yield{snapshot:n,task:o})}}makeResultsDocs(r){if(this.resultsDocs.clear(),this.resultsDocsAreForTestRun=r,!r)return;let n=[r.results];for(;n.length;)for(let s of n.pop()){if(n.push(s.children),!s.uri)continue;let a=this.resultsDocs.get(s.uri);a?a.push(s):this.resultsDocs.set(s.uri,[s])}let o=new rc.Range(0,0,0,0);for(let s of this.resultsDocs.values())s.sort((a,c)=>(a.range||o).start.compareTo((c.range||o).start)||xkt(a.taskStates,c.taskStates))}};lA=E([y(0,he)],lA);var xkt=(t,e)=>{let r=0,n=0;for(let o of t)r=Math.max(r,o.state);for(let o of e)n=Math.max(n,o.state);return r-n};var cM=q(require("vscode")),h$=class{getAllExtensions(){return cM.extensions.all}async getAllCommands(){return cM.commands.executeCommand("_getAllCommands")}async getAllSettings(){return cM.commands.executeCommand("_getAllSettings")}};var Tm=require("vscode");function Vqe(t){return t.scheme==="vscode-vfs"&&t.authority.startsWith("github")}var uA=class extends zF{constructor(r){super();this._accessor=r;this.onDidOpenTextDocument=Tm.workspace.onDidOpenTextDocument;this.onDidChangeTextDocument=Tm.workspace.onDidChangeTextDocument;this.onDidCloseTextDocument=Tm.workspace.onDidCloseTextDocument;this._logService=this._accessor.get(ie)}get textDocuments(){return Tm.workspace.textDocuments}async openTextDocument(r){return await Tm.workspace.openTextDocument(r)}get notebookDocuments(){return Tm.workspace.notebookDocuments}getWorkspaceFolders(){return Tm.workspace.workspaceFolders?.map(r=>r.uri)??[]}ensureWorkspaceIsFullyLoaded(){return this._fullyLoadedPromise??=(async()=>{let r=this._accessor.get(AB);for(let n of this.getWorkspaceFolders())if(Vqe(n)){this._logService.public.debug(`Preloading virtual workspace contents for ${n}`);try{let o=await r.loadWorkspaceContents(n);this._logService.public.info(`loading virtual workspace contents resulted in ${o} for: ${n}`)}catch(o){this._logService.public.error(`Error loading virtual workspace contents for ${n}: ${o}`)}}})(),this._fullyLoadedPromise}async showWorkspaceFolderPicker(){if(this.getWorkspaceFolders())return Tm.window.showWorkspaceFolderPick()}};uA=E([y(0,Rt)],uA);var Mi=q(require("vscode"));var dA=q(Ue());var g$=class extends dA.PromptElement{render(){return vscpp(vscppf,null,vscpp(dA.SystemMessage,{priority:1e3},vscpp("br",null),"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with \\"GitHub Copilot\\".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),vscpp("br",null),vscpp("br",null),vscpp(Up,{location:this.props.location,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn."),vscpp(It,{priority:800,history:this.props.history}),vscpp(dA.UserMessage,{priority:900},"Write a short one-sentence question that the user can ask that naturally follows from the previous few questions and answers. It should not ask a question which is already answered in the conversation. It should be a question that you are capable of answering. Reply with only the text of the question and nothing else.",vscpp("br",null),vscpp(kt,null)))}};var pA=class{constructor(e,r,n,o,s,a,c,l){this.logService=e;this.endpointProvider=r;this.experimentationService=n;this.configurationService=o;this.chatMLFetcher=s;this.telemetryService=a;this.tabsAndEditorsService=c;this.instantiationService=l}async computeFollowups(e,r){let n=e.getLatestTurn();if(!n)return[];let o={messageId:n.requestId},c=this.configurationService.getExperimentBasedConfig(le.FollowUpsEnabled,this.experimentationService)&&n.status==="success"&&(!n.intentInvocation?.location||n.intentInvocation?.location===2)?await this.followUp(e,2,r,o):[];if(r.isCancellationRequested)return[];let l=c.map(d=>this.conversationToReplyFollowup(d,o)),u=n.intentInvocation;if(u?.generateFollowUps){let d=await u.generateFollowUps(n);l.push(...d)}return r.isCancellationRequested?[]:(this.telemetryService.sendMSFTTelemetryEvent("followUps.suggested",{requestId:n.requestId,messageId:o.messageId},{turn:e.turns.length,suggestionCount:l.length,characterCount:l.reduce((d,p)=>d+p.prompt.length,0)}),l)}async followUp(e,r,n,o){let s=o?{...o}:{};s.requestId=ir(),s.messageSource="chat.followup";let a=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:c}=await yo(this.instantiationService,a,g$,{history:e.turns,endpoint:a,location:r}),l=await this.chatMLFetcher.fetchOne("followUp",c,void 0,n,r,a,void 0,void 0,s);if(l.type==="success"){let u=[];return l.value&&u.push(l.value.trim()),u}else return this.logService.public.error(`Failed to fetch followups because of response type (${l.type}) and reason (${l.reason})`),[]}conversationToReplyFollowup(e,r){let n=r??{};return n.suggestionId=ir(),n.suggestionType="Follow-up from model",U6(this.telemetryService,n.suggestionType,n.messageId,n.suggestionId,this.tabsAndEditorsService.activeTextEditor?.document),{prompt:e}}};pA=E([y(0,ie),y(1,xe),y(2,Lt),y(3,he),y(4,yt),y(5,ge),y(6,Ft),y(7,j)],pA);var fA=q(Ue());var v$=class extends fA.PromptElement{render(){return vscpp(vscppf,null,vscpp(fA.SystemMessage,{priority:1e3},"You are an expert in crafting pithy titles for chatbot conversations. You are presented with a chat conversation, and you reply with a brief title that captures the main topic of discussion in that conversation.",vscpp("br",null),vscpp(ct,null),vscpp(kt,null),"The title should not be wrapped in quotes. It should about 8 words or fewer.",vscpp("br",null),"Here are some examples of good titles:",vscpp("br",null),"- Git rebase question",vscpp("br",null),"- Installing Python packages",vscpp("br",null),"- Location of LinkedList implentation in codebase",vscpp("br",null),"- Adding a tree view to a VS Code extension",vscpp("br",null),"- React useState hook usage"),vscpp(It,{priority:800,history:this.props.history}),vscpp(fA.UserMessage,{priority:900},"Please write a brief title for the chat conversation above. If the conversation covers multiple topics, you can just focus on the last one."))}};var mA=class{constructor(e,r,n,o,s){this.logService=e;this.endpointProvider=r;this.chatMLFetcher=n;this.commandService=o;this.instantiationService=s}async provideChatTitle(e,r){let n=new Sp;if(TD(n,e.history,this.commandService),n.turns.filter(c=>c.status==="success").length===0)return"";let o=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:s}=await yo(this.instantiationService,o,v$,{history:n.turns}),a=await this.chatMLFetcher.fetchOne("title",s,void 0,r,2,o);if(r.isCancellationRequested)return"";if(a.type==="success"){let c=a.value.trim();return c.match(/^".*"$/)&&(c=c.slice(1,-1)),c}else return this.logService.public.error(`Failed to fetch conversation title because of response type (${a.type}) and reason (${a.reason})`),""}};mA=E([y(0,ie),y(1,xe),y(2,yt),y(3,Wl),y(4,j)],mA);var ra=q(require("vscode"));var hA=class{constructor(e,r){this.telemetryService=e;this.authenticationService=r}async provideWelcomeMessage(e){let r=(await this.authenticationService.getCopilotToken()).isInternal,n;if(r){let o="workbench.action.openSettings";n=new ra.MarkdownString(ra.l10n.t({message:`{0} is powered by AI, so mistakes are possible. Review output carefully before use.

As an internal user, additional telemetry is collected. If you work on a project that contains customer content, you must [disable telemetry]({1}).`,args:["Copilot",`command:${o}?${encodeURIComponent('["telemetry.telemetryLevel"]')}`],comment:["{Locked=']({'}"]})),n.isTrusted={enabledCommands:[o]}}else n=new ra.MarkdownString(ra.l10n.t("{0} is powered by AI, so mistakes are possible. Review output carefully before use",["Copilot"]));return{icon:new ra.ThemeIcon("copilot"),title:ra.l10n.t("Ask Copilot"),message:n}}provideSampleQuestions(e,r){let n=ra.window.activeNotebookEditor||ra.window.activeTextEditor?Skt():Hqe([["","help",ra.l10n.t("What can you do?")]]);return this.suggestionsToTelemetry([...n],"welcome"),n}suggestionsToTelemetry(e,r){e.map(n=>{U6(this.telemetryService,`@${n.participant} /${n.command} ${n.prompt}`,r,"",ra.window.activeTextEditor?.document)})}};hA=E([y(0,ge),y(1,Tt)],hA);function Skt(){let t=CI("workspace");return Hqe([[t,"fix",ra.l10n.t("the problems in my code")],[t,"tests",ra.l10n.t("add unit tests for my code")],[t,"explain",ra.l10n.t("how the selected code works")]])}function Hqe(t){return t.map(([e,r,n])=>({prompt:"",participant:e,command:r,label:`/${r} ${n}`}))}var gA=class{constructor(e){this.instantiationService=e}debugGetCurrentChatAgents(){return this._lastChatAgents}register(){let e=this.instantiationService.createInstance(lM);return e.register(),this._lastChatAgents=e,{dispose:()=>{e.dispose(),this._lastChatAgents=void 0}}}};gA=E([y(0,j)],gA);var lM=class{constructor(e,r,n,o,s,a,c,l){this.extensionContext=e;this.octoKitService=r;this.authenticationService=n;this.languageDiagnosticsService=o;this.instantiationService=s;this.userFeedbackService=a;this.configurationService=c;this.conversationStore=l;this._disposables=new ht}dispose(){this._disposables.dispose()}register(){this._disposables.add(this.registerDefaultAgent()),this._disposables.add(this.registerEditorDefaultAgent()),this._disposables.add(this.registerNotebookDefaultAgent()),this._disposables.add(this.registerWorkspaceAgent()),this._disposables.add(this.registerVSCodeAgent()),this._disposables.add(this.registerTerminalAgent()),this._disposables.add(this.registerTerminalPanelAgent())}createAgent(e,r,n){n=n||CI(e);let o=Mi.chat.createChatParticipant(n,this.getChatParticipantHandler(n,e,r));return o.onDidReceiveFeedback(s=>{this.userFeedbackService.handleFeedback(s,n)}),o.onDidPerformAction(s=>{this.userFeedbackService.handleUserAction(s,n)}),o.supportIssueReporting=this.configurationService.getConfig(le.DebugReportFeedback),o.followupProvider={provideFollowups:async(s,a,c)=>{let l=s.metadata?.responseId&&this.conversationStore.getConversation(s.metadata.responseId);return l?await this.instantiationService.createInstance(pA).computeFollowups(l,c):[]}},o}registerWorkspaceAgent(){let e=this.createAgent(rge,"workspace");return e.iconPath=new Mi.ThemeIcon("code"),e.isSecondary=!0,e}registerVSCodeAgent(){let e=this.createAgent(nge,"vscode"),r=Mi.env.appName.includes("Insiders")||Mi.env.appName.includes("OSS");return e.iconPath=He.joinPath(this.extensionContext.extensionUri,"assets",r?"vscode-chat-avatar-insiders.svg":"vscode-chat-avatar-stable.svg"),e.supportsSlowReferences=!0,e}registerTerminalAgent(){let e=this.createAgent(II,"terminal");return e.iconPath=new Mi.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e.followupProvider=void 0,e}registerTerminalPanelAgent(){let e=this.createAgent(II,"terminal","github.copilot.terminalPanel");return e.iconPath=new Mi.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e}async initDefaultAgentRequestorProps(e){let r=async()=>{let n=await this.octoKitService.getCurrentAuthedUser();return n?(e.requester={name:n.login,icon:He.parse(n?.avatar_url??`https://avatars.githubusercontent.com/${n.login}`)},!0):!1};if(!await r()){let n=this.authenticationService.onDidAuthenticationChange(async()=>{await r()&&n.dispose()})}}registerDefaultAgent(){let e=this.createAgent(ege,"unknown");e.iconPath=new Mi.ThemeIcon("copilot"),e.supportsSlowReferences=!0,this.initDefaultAgentRequestorProps(e),e.helpTextPrefix=Mi.l10n.t("You can ask me general programming questions, or chat with the following participants which have specialized expertise and can perform actions:");let r=Mi.l10n.t({message:`To have a great conversation, ask me questions as if I was a real programmer:

* **Show me the code** you want to talk about by having the files open and selecting the most important lines.
* **Make refinements** by asking me follow-up questions, adding clarifications, providing errors, etc.
* **Review my suggested code** and tell me about issues or improvements, so I can iterate on it.

You can also ask me questions about your editor selection by [starting an inline chat session](command:inlineChat.start).

Learn more about [GitHub Copilot](https://docs.github.com/copilot/using-github-copilot/getting-started-with-github-copilot?tool=vscode&utm_source=editor&utm_medium=chat-panel&utm_campaign=2024q3-em-MSFT-getstarted) in [Visual Studio Code](https://code.visualstudio.com/docs/copilot/overview).`,comment:"{Locked='](command:inlineChat.start)'}"}),n=new Mi.MarkdownString(r);return n.isTrusted={enabledCommands:["inlineChat.start"]},e.helpTextPostfix=n,e.helpTextVariablesPrefix=Mi.l10n.t("You can also help me understand your question by using the following variables to give me extra context:"),e.welcomeMessageProvider=this.instantiationService.createInstance(hA),e.titleProvider=this.instantiationService.createInstance(mA),e}registerEditorDefaultAgent(){let e=this.createAgent(tge,"editor");return e.iconPath=new Mi.ThemeIcon("copilot"),e.welcomeMessageProvider={provideWelcomeMessage:()=>{},provideSampleQuestions:(r,n)=>{if(Mi.window.activeTextEditor){let{document:o,selection:s}=Mi.window.activeTextEditor,a=CQ(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}registerNotebookDefaultAgent(){let e=this.createAgent("notebook","editor");return e.iconPath=new Mi.ThemeIcon("copilot"),e.welcomeMessageProvider={provideSampleQuestions:(r,n)=>{if(Mi.window.activeTextEditor){let{document:o,selection:s}=Mi.window.activeTextEditor,a=CQ(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}getChatParticipantHandler(e,r,n){return async(o,s,a,c)=>{let l=wI[n],u=o.command&&l?l[o.command]:n;return await this.instantiationService.createInstance(sT,s.history,o,a,c,{agentName:r,agentId:e,intentId:u}).getResult()}}};lM=E([y(0,Bt),y(1,KF),y(2,Tt),y(3,Vi),y(4,j),y(5,MT),y(6,he),y(7,Qp)],lM);var Ll=q(require("vscode"));var y$=class{async add(e,r){let n=Ll.workspace.getConfiguration("launch",e),o=n.get("configurations");r.configurations.length&&await n.update("configurations",[...r.configurations,...o||[]],Ll.ConfigurationTarget.WorkspaceFolder);let s=n.get("inputs");r.inputs?.length&&await n.update("inputs",[...r.inputs,...s||[]],Ll.ConfigurationTarget.WorkspaceFolder)}async show(e,r){let n=He.joinPath(e,".vscode","launch.json"),o;try{o=await Ll.workspace.openTextDocument(n)}catch{return}let s;if(r)try{let a=o.getText(),c=[],l=!1;Qye(a,{onObjectBegin(u){c.push(u)},onObjectEnd(u,d){let p=c.pop();if(l){l=!1;let f=new pc(a),m=f.offsetToPosition(p),h=f.offsetToPosition(u+d);s=new Ll.Range(m.lineNumber-1,m.column-1,h.lineNumber-1,h.column-1)}},onLiteralValue(u,d,p,f,m,h){if(u===r){let g=h();g[g.length-1]==="name"&&(l=!0)}}})}catch{}await Ll.window.showTextDocument(o,{selection:s})}async launch(e){let r="configurations"in e&&e.configurations.length?e.configurations[0]:e;r&&await Ll.debug.startDebugging(void 0,r)}async resolveConfigurationInputs(e,r,n){n||(n={isGenerating:()=>{},didGenerate:()=>{},prompt:async(a,c)=>await Ll.window.showInputBox({prompt:a,value:c,ignoreFocusOut:!0})});let o=new Map;for(let a of e.inputs||[]){let c=await n.prompt(a.description,r?.get(a.id));if(c===void 0)return;o.set("${input:"+a.id+"}",c)}return{config:rme(e.configurations[0],a=>{if(typeof a=="string"){for(let[c,l]of o)a=a.replaceAll(c,l);return a}}),inputs:o}}};var Ikt=[{max_token_sequence_length:1,last_tokens_to_consider:10},{max_token_sequence_length:10,last_tokens_to_consider:30},{max_token_sequence_length:20,last_tokens_to_consider:45},{max_token_sequence_length:30,last_tokens_to_consider:60}];function zqe(t,e="client"){if(e==="proxy")return!1;let r=t.slice();return r.reverse(),Gqe(r)||Gqe(r.filter(n=>n.trim().length>0))}function Gqe(t){let e=Ckt(t);for(let r of Ikt){if(t.length<r.last_tokens_to_consider)continue;if(r.last_tokens_to_consider-1-e[r.last_tokens_to_consider-1]<=r.max_token_sequence_length)return!0}return!1}function Ckt(t){let e=Array(t.length).fill(0);e[0]=-1;let r=-1;for(let n=1;n<t.length;n++){for(;r>=0&&t[r+1]!==t[n];)r=e[r];t[r+1]===t[n]&&r++,e[n]=r}return e}function $qe(t){if(t!==void 0&&t!==0&&t.hostname==="github.com")return t.owner+"/"+t.repo}async function Wqe(t,e,r,n,o,s,a,c,l,u,d,p){let f=Ekt(c);if(d?.isCancellationRequested)return{type:"canceled",reason:"before fetch request"};t.internal.debug(`url ${a.url}`),t.internal.debug(`modelMaxPromptTokens ${a.modelMaxPromptTokens}`),t.internal.debug(`modelMaxResponseTokens ${f.max_tokens??2048}`),t.internal.debug(`chat model ${c.model}`);let m=c.secretKey??(await s.getCopilotToken()).token;if(!m)return t.public.error(`Failed to send request to ${a.url} due to missing key`),lh(e,`Failed to send request to ${a.url} due to missing key`),{type:"failed",modelRequestId:void 0,failKind:"tokenExpiredOrInvalid",reason:"key is missing"};let h=await kkt(t,e,r,n,o,a,c.ourRequestId,f,m,c.location,d,p);if(d?.isCancellationRequested){let b=await h.body();try{b.destroy()}catch(_){t.public.error(_,"Error destroying stream"),e.sendGHTelemetryException(_,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(h.status!==200){let b=Tkt(a,c.location,c.ourRequestId);return t.public.info("Request ID for failed request: "+c.ourRequestId),wkt(t,e,s,b,h,c.ourRequestId)}let g=c.postOptions?.n??1;return{type:"success",chatCompletions:await a.processResponseFromChatEndpoint(e,t,h,g,u,l,d),getProcessingTime:()=>Mve(h)}}function Tkt(t,e,r){return ci.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:st.toString(e),headerRequestId:r})}function Ekt(t){let e={messages:t.messages,model:t.model};t.postOptions&&Object.assign(e,t.postOptions);let r=$qe(t.repoInfo);return r!==void 0&&(e.nwo=r),t.intent&&(e.intent=t.intent,t.intent_threshold&&(e.intent_threshold=t.intent_threshold)),e}async function wkt(t,e,r,n,o,s){let a=UI(o,void 0);s=a.headerRequestId||s,a.headerRequestId=s,n.properties.error=`Response status was ${o.status}`,n.properties.status=String(o.status),e.sendGHTelemetryEvent("request.shownWarning",n.properties,n.measurements);let c=await o.text();if(o.status===401&&c.includes("authorize_url"))try{let l=JSON.parse(c);return{type:"failed",modelRequestId:a,failKind:"unauthorized",reason:o.statusText||o.statusText,data:l}}catch{}if(o.status===401||o.status===403)return r.resetCopilotToken(o.status),{type:"failed",modelRequestId:a,failKind:"tokenExpiredOrInvalid",reason:`token expired or invalid: ${o.status}`};if(o.status===499)return t.public.info("Cancelled by server"),{type:"failed",modelRequestId:a,failKind:"serverCanceled",reason:"canceled by server"};if(o.status===466)return t.public.info(c),{type:"failed",modelRequestId:a,failKind:"clientNotSupported",reason:`client not supported: ${c}`};if(o.status===400&&c.includes("off_topic"))return{type:"failed",modelRequestId:a,failKind:"offTopic",reason:"filtered as off_topic by intent classifier: message was not programming related"};if(o.status===424)return{type:"failed",modelRequestId:a,failKind:"failedDependency",reason:c};if(o.status===429){if(c.includes("extension_blocked"))try{let l=JSON.parse(c);if(l.error&&(l=l.error),l.code==="extension_blocked"&&l.type==="rate_limit_error")return{type:"failed",modelRequestId:a,failKind:"extensionBlocked",reason:l.reason??l.code,data:{...l.message,retryAfter:o.headers.get("retry-after")}}}catch{}return{type:"failed",modelRequestId:a,failKind:"rateLimited",reason:c,data:{retryAfter:o.headers.get("retry-after")}}}return o.status>=500&&o.status<600?(t.public.error(`Server error: ${o.status} ${c}`),{type:"failed",modelRequestId:a,failKind:"serverError",reason:`Server error, please report the following request id: ${s}`}):o.status===422?{type:"failed",modelRequestId:a,failKind:"contentFilter",reason:"Filtered by Responsible AI Service"}:(t.public.error(`Request Failed: ${o.status} ${c}`),lh(e,"Unhandled status from server: "+o.status,c),{type:"failed",modelRequestId:a,failKind:"unknown",reason:`Request Failed: ${o.status} ${c}`})}async function kkt(t,e,r,n,o,s,a,c,l,u,d,p){let f=ci.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:st.toString(u),...p},{maxTokenWindow:s.modelMaxPromptTokens});for(let[g,v]of Object.entries(c))g!=="messages"&&(f.properties[`request.option.${g}`]=JSON.stringify(v)??"undefined");f.properties.headerRequestId=a,e.sendGHTelemetryEvent("request.sent",f.properties,f.measurements);let m=Date.now(),h=Rkt(u);return Hv(r,n,e,o,s,l,await ul(process.env.HMAC_SECRET),h,a,c,d).then(g=>{let v=UI(g,void 0);f.extendWithRequestId(v);let b=Date.now()-m;return f.measurements.totalTimeMs=b,t.internal.debug(`request.response: [${s.url}], took ${b} ms`),t.internal.debug(`messages: ${JSON.stringify(c.messages)}`),e.sendGHTelemetryEvent("request.response",f.properties,f.measurements),g}).catch(g=>{if(r.isAbortError(g))throw g;let v=f.extendedBy({error:"Network exception"});e.sendGHTelemetryEvent("request.shownWarning",v.properties,v.measurements),f.properties.code=String(g.code??""),f.properties.errno=String(g.errno??""),f.properties.message=String(g.message??""),f.properties.type=String(g.type??"");let b=Date.now()-m;throw f.measurements.totalTimeMs=b,t.internal.debug(`request.response: [${s.url}] took ${b} ms`),e.sendGHTelemetryEvent("request.error",f.properties,f.measurements),g}).finally(()=>{IX(e,c.messages,f)})}function Rkt(t){switch(t){case 2:return"conversation-panel";case 1:return"conversation-inline"}}var jpe=class{constructor(e){this.options=e;this._onDidMakeChatMLRequest=new Yt;this.onDidMakeChatMLRequest=this._onDidMakeChatMLRequest.event}preparePostOptions(e){return{temperature:this.options.temperature,top_p:this.options.topP,...e,stream:!0}}async fetchOne(e,r,n,o,s,a,c,l,u,d){let p=await this.fetchMany(e,r,n,o,s,a,c,{...l,n:1},u,d);return p.type==="success"?{...p,value:p.value[0]}:p}},vA=class extends jpe{constructor(r,n,o,s,a,c,l,u,d){super(d);this._fetcherService=r;this._telemetryService=n;this._tokenizerProvider=o;this._requestLogger=s;this._logService=a;this._envService=c;this._domainService=l;this._authenticationService=u}async fetchMany(r,n,o,s,a,c,l,u,d){d||(d={}),d.messageSource||(d.messageSource=r);let p=d.requestId??d.messageId??ir(),f=4096;u={max_tokens:f,...u};let m=this.preparePostOptions(u),h=c.model,g={messages:n,model:h,repoInfo:void 0,ourRequestId:p,location:a,postOptions:m,secretKey:u.secretKey},v=ci.createAndMarkAsIssued({...d,uiKind:st.toString(a)}),b=this._requestLogger.logChatRequest(r,c,g),_=-1;try{let x,S=new i6(o),I=Pkt(g);if(!I.isValid)x={type:"failed",modelRequestId:void 0,failKind:"validationFailed",reason:`Prompt failed validation with the reason: ${I.reason}. Please file an issue.`};else{x=await Wqe(this._logService,this._telemetryService,this._fetcherService,this._envService,this._domainService,this._authenticationService,c,g,v,S.callback,s,d),_=iT(this._tokenizerProvider.acquireTokenizer(c),n.map(H=>({role:H.role,content:H.content,..."name"in H&&H.name?{name:H.name}:void 0})));let M=l?.extensionId??jm;this._onDidMakeChatMLRequest.fire({messages:n,model:c.model,source:{extensionId:M},tokenCount:_})}let w=Date.now()-v.issuedTime;b?.markTimeToFirstToken(w);let k;switch(x.type){case"success":{let M=await this.processSuccessfulResponse(x,g.ourRequestId,f,_,w,v,c);return b?.resolve(M,S.deltas),M}case"canceled":return this._telemetryService.sendMSFTTelemetryEvent("response.cancelled",{source:d.messageSource??"unknown",requestId:g.ourRequestId,model:c.model},{totalTokenMax:c.modelMaxPromptTokens??-1,promptTokenCount:_,tokenCountMax:f,timeToFirstToken:w,timeToCancelled:v?Date.now()-v.issuedTime:-1}),b?.resolveWithCancelation(),this.processCanceledResponse(x,g.ourRequestId);case"failed":return k=this.processFailedResponse(x,g.ourRequestId),this._sendResponseErrorTelemetry(k,d,g,c,_,f,w),b?.resolve(k),k}}catch(x){let S=Date.now()-v.issuedTime,I=this.processError(x,g.ourRequestId);return this._sendResponseErrorTelemetry(I,d,g,c,_,f,S),b?.resolve(I),I}}_sendResponseErrorTelemetry(r,n,o,s,a,c,l){this._telemetryService.sendMSFTTelemetryEvent("response.error",{type:r.type,reason:new aI(r.reason),source:n?.messageSource??"unknown",requestId:o.ourRequestId,model:s.model},{totalTokenMax:s.modelMaxPromptTokens??-1,promptTokenCount:a,tokenCountMax:c,timeToFirstToken:l})}async processSuccessfulResponse(r,n,o,s,a,c,l){let u=[];for await(let m of r.chatCompletions)this._telemetryService.sendMSFTTelemetryEvent("response.success",{reason:m.finishReason,filterReason:m.filterReason,source:c?.properties.messageSource??"unknown",model:l?.model,requestId:n},{totalTokenMax:l?.modelMaxPromptTokens??-1,tokenCountMax:o,promptTokenCount:s,tokenCount:m.numTokens,timeToFirstToken:a,timeToComplete:c?Date.now()-c.issuedTime:-1}),this.isRepetitive(m,c?.properties)||u.push(m);let d=new Set(["stop","client-trimmed","function_call","tool_calls"]),p=u.filter(m=>d.has(m.finishReason));if(p.length>=1)return{type:"success",value:p.map(m=>m.message.content),requestId:n,serverRequestId:p[0].requestId.headerRequestId};let f=u.at(0);switch(f?.finishReason){case"content_filter":return{type:"filtered",category:f.filterReason??"snippy",reason:"Response got filtered.",requestId:n,serverRequestId:f.requestId.headerRequestId};case"length":return{type:"length",reason:"Response too long.",requestId:n,serverRequestId:f.requestId.headerRequestId,truncatedValue:f.message.content}}return{type:"unknown",reason:"Response contained no choices.",requestId:n,serverRequestId:f?.requestId.headerRequestId}}isRepetitive(r,n){let o=zqe(r.tokens);if(o){let s=ci.createAndMarkAsIssued();s.extendWithRequestId(r.requestId);let a=s.extendedBy(n);this._telemetryService.sendRestrictedGHTelemetryEvent("conversation.repetition.detected",a.properties,a.measurements)}return o}processCanceledResponse(r,n){return{type:"canceled",reason:r.reason,requestId:n,serverRequestId:void 0}}processFailedResponse(r,n){let o=r.modelRequestId?.headerRequestId,s=r.reason;if(r.failKind==="rateLimited")return{type:"rateLimited",reason:s,requestId:n,serverRequestId:o,retryAfter:r.data?.retryAfter};if(r.failKind==="offTopic")return{type:"offTopic",reason:s,requestId:n,serverRequestId:o};if(r.failKind==="tokenExpiredOrInvalid"||r.failKind==="clientNotSupported"||s.includes("Bad request: "))return{type:"badRequest",reason:s,requestId:n,serverRequestId:o};if(r.failKind==="serverError")return{type:"failed",reason:s,requestId:n,serverRequestId:o};if(r.failKind==="contentFilter")return{type:"filtered",reason:s,category:"prompt",requestId:n,serverRequestId:o};if(r.failKind==="unauthorized")return{type:"agent_unauthorized",reason:s,authorizationUrl:r.data.authorize_url,requestId:n,serverRequestId:o};if(r.failKind==="failedDependency")return{type:"agent_failed_dependency",reason:s,requestId:n,serverRequestId:o};if(r.failKind==="extensionBlocked"){let a=typeof r.data?.retryAfter=="number"?r.data.retryAfter:300;return{type:"extensionBlocked",reason:s,requestId:n,retryAfter:a,learnMoreLink:r.data?.learnMoreLink??"",serverRequestId:o}}return{type:"failed",reason:s,requestId:n,serverRequestId:o}}processError(r,n){let o=this._fetcherService;return o.isAbortError(r)?{type:"canceled",reason:"network request aborted",requestId:n,serverRequestId:void 0}:ed(r)?{type:"canceled",reason:"Got a cancellation error",requestId:n,serverRequestId:void 0}:(this._logService.public.error(r,"Error on conversation request"),this._telemetryService.sendGHTelemetryException(r,"Error on conversation request"),o.isDNSLookupFailedError(r)?{type:"failed",reason:"It appears you're not connected to the internet, please check your network connection and try again.",requestId:n,serverRequestId:void 0}:o.isFetcherError(r)?{type:"failed",reason:o.getUserMessageForFetcherError(r),requestId:n,serverRequestId:void 0}:{type:"failed",reason:"Error on conversation request. Check the log for more details.",requestId:n,serverRequestId:void 0})}};vA=E([y(0,Kr),y(1,ge),y(2,_r),y(3,il),y(4,ie),y(5,gt),y(6,en),y(7,Tt),y(8,dc)],vA);function Pkt(t){if(t.messages.length===0)return{isValid:!1,reason:"No messages provided"};if(t?.postOptions?.max_tokens&&t?.postOptions?.max_tokens<1)return{isValid:!1,reason:"Invalid response token parameter"};let e=/^[a-zA-Z0-9_-]+$/;return t.messages.some(r=>r.role==="function"&&r.name&&!r.name.match(e))||t.postOptions?.functions?.some(r=>!r.name.match(e))||t.postOptions?.function_call?.name&&!t.postOptions.function_call.name.match(e)?{isValid:!1,reason:"Function names must match ^[a-zA-Z0-9_-]+$"}:{isValid:!0,reason:""}}var b$=class{constructor(e,r){this._modelInfo=e;this._domainService=r;this.name=this._modelInfo.name;this.version=this._modelInfo.version;this.model=this._modelInfo.id;this.family=this._modelInfo.capabilities.family;this.maxBatchSize=this._modelInfo.capabilities.limits?.max_inputs??256,this.modelMaxPromptTokens=8192}get url(){return this._domainService.capiEmbeddingsURL}};var Em=class{constructor(e,r,n,o,s,a,c,l){this._fetcher=e;this._domainService=r;this._configService=n;this._expService=o;this._envService=s;this._authService=a;this._telemetryService=c;this._logService=l;this._familyMap=new Map;this._lastFetchTime=0;this._taskSingler=new I0;this._onDidModelRefresh=new Yt;this.onDidModelsRefresh=this._onDidModelRefresh.event}static{this.ALL_MODEL_KEY="allModels"}async getAllChatModels(){await this._taskSingler.getOrCreate(Em.ALL_MODEL_KEY,this._fetchModels.bind(this));let e=[];for(let[,r]of this._familyMap)for(let n of r)T2(n)&&e.push(n);return e}async _hydrateResolvedModel(e){if(e=e?await this._findExpOverride(e):void 0,!e)throw this._lastFetchError;return T2(e)&&e.capabilities.limits?.max_prompt_tokens&&(e.capabilities.limits.max_prompt_tokens=qbe(this._authService,this._configService,this._expService,e)),e}async getChatModelFromFamily(e){await this._taskSingler.getOrCreate(Em.ALL_MODEL_KEY,this._fetchModels.bind(this));let r;if(e==="gpt-4"?r=this._familyMap.get("gpt-4o")?.[0]:e==="gpt-4o-mini"?r=this._familyMap.get("gpt-4o-mini")?.[0]??this._familyMap.get("gpt-4o")?.[0]:e==="gpt-3.5-turbo"?r=this._familyMap.get("gpt-3.5-turbo")?.[0]:r=this._familyMap.get(e)?.[0],r=await this._hydrateResolvedModel(r),!T2(r))throw new Error(`Unable to resolve chat model with family selection: ${e}`);return r}async getChatModelFromApiModel(e){await this._taskSingler.getOrCreate(Em.ALL_MODEL_KEY,this._fetchModels.bind(this));let r;for(let n of this._familyMap.values())if(r=n.find(o=>o.id===e.id&&o.name===e.name&&o.version===e.version&&o.capabilities.family===e.family),r)break;if(r){if(r=await this._hydrateResolvedModel(r),!T2(r))throw new Error(`Unable to resolve chat model: ${e.id},${e.name},${e.version},${e.family}`);return r}}async getEmbeddingsModel(e){await this._taskSingler.getOrCreate(Em.ALL_MODEL_KEY,this._fetchModels.bind(this));let r=this._familyMap.get(e)?.[0];if(r=await this._hydrateResolvedModel(r),!oge(r))throw new Error(`Unable to resolve embeddings model with family selection: ${e}`);return r}_shouldRefreshModels(){if(this._familyMap.size===0)return!0;let e=10*60*1e3,r=Date.now();return this._lastFetchTime?r-this._lastFetchTime>e:!0}async _fetchModels(e){if(!e&&!this._shouldRefreshModels())return;let r=Date.now(),n=(await this._authService.getCopilotToken()).token,o=ir();try{let s=await lQ(this._fetcher,this._envService,this._telemetryService,this._domainService,this._domainService.capiModelsURL,n,await ul(process.env.HMAC_SECRET),"model-access",o);if(this._lastFetchTime=Date.now(),this._logService.public.info(`Fetched model metadata in ${Date.now()-r}ms ${o}`),s.status<200||s.status>=300){if(s.status===429&&this._familyMap.size>0){this._logService.public.warn(`Rate limited while fetching models ${o}`);return}throw new Error(`Failed to fetch models (${o}): ${await s.text()||s.statusText||`HTTP ${s.status}`}`)}this._familyMap.clear();let a=(await s.json()).data;for(let c of a){let l=c.capabilities.family;this._familyMap.has(l)||this._familyMap.set(l,[]),this._familyMap.get(l)?.push(c)}this._lastFetchError=void 0,this._onDidModelRefresh.fire()}catch(s){this._logService.public.error(s,`Failed to fetch models (${o})`),this._lastFetchError=s,this._lastFetchTime=0}}async _fetchModel(e){let r=(await this._authService.getCopilotToken()).token;try{let o=await(await lQ(this._fetcher,this._envService,this._telemetryService,this._domainService,`${this._domainService.capiModelsURL}/${e}`,r,await ul(process.env.HMAC_SECRET),"model-access",ir())).json();return this._familyMap.has(o.capabilities.family)?this._familyMap.get(o.capabilities.family)?.push(o):this._familyMap.set(o.capabilities.family,[o]),this._onDidModelRefresh.fire(),o}catch{return}}async _findExpOverride(e){let r={},n=this._expService.getTreatmentVariable("vscode","copilotchat.modelOverrides");try{r=JSON.parse(n||"{}")}catch{}if(r[e.id]){for(let[,s]of this._familyMap){let a=s.find(c=>c.id===r[e.id]);if(a)return a}e=await this._taskSingler.getOrCreate(r[e.id],()=>this._fetchModel(r[e.id]))??e}return e}};Em=E([y(0,Kr),y(1,en),y(2,he),y(3,Lt),y(4,gt),y(5,Tt),y(6,ge),y(7,ie)],Em);var yA=class{constructor(e,r,n,o,s,a,c,l){this._authService=e;this._domainService=r;this._expService=o;this._envService=s;this._logService=c;this._configService=l;this._chatEndpoints=new Map;this._embeddingEndpoints=new Map;e.onDidAuthenticationChange(()=>{let u=l.getConfig(le.DebugOverrideChatEngine),d=l.getConfig(le.DebugOverrideEmbeddingsModel),p=e.copilotToken?.isInternal??!1;p&&u&&(this._overridenChatModel=u),p&&d&&(this._overridenEmbeddingsModel=d)}),this._modelFetcher=new Em(n,r,this._configService,o,s,e,a,c),this._modelFetcher.onDidModelsRefresh(()=>{this._chatEndpoints.clear(),this._embeddingEndpoints.clear()})}shouldDisableSnippy(){let e=this._authService.copilotToken?.isInternal??!1,r=!this._envService.isProduction();return e&&r}getOrCreateChatEndpointInstance(e){let r=e.id,n=this._chatEndpoints.get(r);if(!n){let o=this.shouldDisableSnippy();n=new LT(this._domainService,e,o),this._chatEndpoints.set(r,n)}return n}async getOrCreateEmbeddingEndpointInstance(e){let r=e.id,n=this._embeddingEndpoints.get(r);return n||(n=new b$(e,this._domainService),this._embeddingEndpoints.set(r,n)),n}async getEndpointFamilyForLocation(e){return e===2?"gpt-4":this._configService.getExperimentBasedConfig(le.InlineChatEndpoint,this._expService)??"gpt-4"}async getChatEndpoint(e){if(this._logService.public.trace("Resolving chat model"),this._overridenChatModel)return this._logService.public.trace("Using overriden chat model"),this.getOrCreateChatEndpointInstance({id:this._overridenChatModel,name:"Custom Overriden Chat Model",version:"1.0.0",capabilities:{family:"custom",type:"chat"}});let r;if(typeof e=="string"){let n=await this._modelFetcher.getChatModelFromFamily(e);r=this.getOrCreateChatEndpointInstance(n)}else if(e.userSelectedModel&&!e.location2){let n=await this._modelFetcher.getChatModelFromApiModel(e.userSelectedModel);r=n?this.getOrCreateChatEndpointInstance(n):await this.getChatEndpoint("gpt-4")}else{let n=await this.getEndpointFamilyForLocation(e.location2?1:2);r=await this.getChatEndpoint(n)}return this._logService.public.trace("Resolved chat model"),r}async getEmbeddingsEndpoint(e){if(this._logService.public.trace("Resolving embedding model"),this._overridenEmbeddingsModel)return this._logService.public.trace("Using overriden embeddings model"),this.getOrCreateEmbeddingEndpointInstance({id:this._overridenEmbeddingsModel,name:"Custom Overriden Embeddings Model",version:"1.0.0",capabilities:{family:"custom",type:"embeddings"}});let r=await this._modelFetcher.getEmbeddingsModel(e==="ada"?"text-embedding-ada-002":"text-embedding-3-small"),n=await this.getOrCreateEmbeddingEndpointInstance(r);return this._logService.public.trace("Resolved embedding model"),n}async getAllChatEndpoints(){let e=await this._modelFetcher.getAllChatModels(),r=[];for(let n of e){let o=this.getOrCreateChatEndpointInstance(n);r.push(o)}return r}};yA=E([y(0,Tt),y(1,en),y(2,Kr),y(3,Lt),y(4,gt),y(5,ge),y(6,ie),y(7,he)],yA);var Kqe=q(require("path")),Yqe=q(require("vscode"));var o_=q(Ue());var _$=class extends o_.PromptElement{render(){return vscpp(vscppf,null,vscpp(o_.SystemMessage,null,vscpp(Vpe,null),vscpp(Tw,null)),vscpp(o_.UserMessage,null,vscpp(Hpe,{templates:this.props.templates,features:this.props.features,filenames:this.props.filenames})))}},Vpe=class extends o_.PromptElement{render(){return vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),"You are helping a software developer to configure a Dev Container by picking a configuration template and features.")}},Hpe=class extends o_.PromptElement{render(){return vscpp(vscppf,null,"This is a partial list of workspace files:",vscpp("br",null),this.props.filenames.map(e=>`- ${e}
`).join(""),vscpp("br",null),"Based on the workspace files, please suggest the best template from the list of templates below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick the best template and reply with the best template's id.",vscpp("br",null),"This is the list of available templates:",vscpp("br",null),this.props.templates.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null),"Also based on the workspace files, please suggest all relevant features from the list of features below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick all relevant features and reply with the relevant features' ids.",vscpp("br",null),"This is the list of available features:",vscpp("br",null),this.props.features.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null))}};var Akt=["alpine","debian","docker-existing-docker-compose","docker-existing-dockerfile","docker-in-docker","docker-outside-of-docker","docker-outside-of-docker-compose","ubuntu","universal"].map(t=>`ghcr.io/devcontainers/templates/${t}`),Dkt=["common-utils","git"].map(t=>`ghcr.io/devcontainers/features/${t}`),bA=class{constructor(e){this.accessor=e;this.telemetryService=e.get(ge)}async generate(e,r,n){if(!r.length)return{type:"success",template:void 0,features:[]};let o=Date.now(),s=await this.accessor.get(xe).getChatEndpoint("gpt-3.5-turbo"),a=Math.floor(s.modelMaxPromptTokens*4/3),c=this.processFilenames(r,a),l=e.templates.filter(g=>!Akt.includes(g.id)),u=(e.features||[]).filter(g=>!Dkt.includes(g.id)),p=await Me.create(this.accessor.get(j),s,_$,{filenames:c,templates:l,features:u}).render(),f=Date.now(),m=await this.accessor.get(yt).fetchOne("devContainerConfigGenerator",p.messages,void 0,n,3,s),h=m.type==="success"?this.processGeneratedConfig(m.value,l,u):void 0;return this.telemetryService.sendMSFTTelemetryEvent("devcontainer.generateConfig",{model:s.model,requestId:m.requestId,responseType:m.type,templateId:h?.template,featureIds:h?.features.join(",")},{originalFilenameCount:r.length,originalFilenameLength:r.join("").length,processedFilenameCount:c.length,processedFilenameLength:c.join("").length,timeToRequest:f-o,timeToComplete:Date.now()-o}),{type:"success",template:h?.template,features:h?.features||[]}}processFilenames(e,r){let n=[...e],o=Math.floor(r*.9),s=n.join(`
`).length;if(s>o)for(;s>o&&n.length>0;){let a=n.pop();s-=a.length}return n}processGeneratedConfig(e,r,n){let o=r.find(s=>new RegExp(`\\b${g_(s.id)}\\b`).test(e))?.id;return o==="ghcr.io/devcontainers/templates/javascript-node"&&(o="ghcr.io/devcontainers/templates/typescript-node"),{template:o,features:n.filter(s=>new RegExp(`\\b${g_(s.id)}\\b`).test(e)).map(s=>s.id)}}};bA=E([y(0,Rt)],bA);var _A=class{constructor(e){this.accessor=e}async generateConfiguration(e,r){if(r.isCancellationRequested)return{type:"cancelled"};let n=this.accessor.get(Hp),o=(await Promise.all(["*","*/*","*/*/*"].map(a=>n.findFilesWithDefaultExcludes(new Yqe.RelativePattern(e.rootUri,a),1e3,r)))).flat().map(a=>Kqe.posix.relative(e.rootUri.path,a.path));return new bA(this.accessor).generate(e.index,o,r)}};_A=E([y(0,Rt)],_A);var uM=q(require("path")),nc=require("vscode");var wm=q(Ue());var x$=class extends wm.PromptElement{render(){return vscpp(vscppf,null,vscpp(wm.SystemMessage,{priority:1e3},vscpp(Gpe,null),vscpp(ct,null),vscpp(kt,null)),this.props.recentCommitMessages.user.length>0&&vscpp(wm.UserMessage,{priority:700,name:"user-commits"},"# RECENT USER COMMITS (For reference only, do not copy!):",vscpp("br",null),this.props.recentCommitMessages.user.map(e=>`- ${e}
`).join("")),this.props.recentCommitMessages.repository.length>0&&vscpp(wm.UserMessage,{priority:600,name:"recent-commits"},"# RECENT REPOSITORY COMMITS (For reference only, do not copy!):",vscpp("br",null),this.props.recentCommitMessages.repository.map(e=>`- ${e}
`).join("")),vscpp(wm.UserMessage,{priority:800,name:"changes"},"# CODE CHANGES:",vscpp("br",null),this.props.diff.map(e=>vscpp(vscppf,null,vscpp(wn,{code:e}),vscpp("br",null)))),vscpp(wm.UserMessage,{priority:900,name:"reminder"},"Now generate a commit messages that describe the CODE CHANGES.",vscpp("br",null),"DO NOT COPY commits from RECENT COMMITS, but it as reference for the commit style.",vscpp("br",null),"ONLY return a single markdown code block, NO OTHER PROSE!",vscpp("br",null),vscpp(wn,{languageId:"text",code:"commit message goes here"})))}},Gpe=class extends wm.PromptElement{render(){return vscpp(vscppf,null,"You are an AI programming assistant, helping a software developer to come with the best git commit message for their code changes.",vscpp("br",null),"You excel in interpreting the purpose behind code changes to craft succinct, clear commit messages that adhere to the repository's guidelines.",vscpp("br",null),vscpp("br",null),"# First, think step-by-step:",vscpp("br",null),"1. Analyze the CODE CHANGES thoroughly to understand what's been modified.",vscpp("br",null),"2. Identify the purpose of the changes to answer the *why* for the commit messages, also considering the optionally provided RECENT USER COMMITS.",vscpp("br",null),"3. Review the provided RECENT REPOSITORY COMMITS to identify established commit message conventions. Focus on the format and style, ignoring commit-specific details like refs, tags, and authors.",vscpp("br",null),"4. Generate a thoughtful and succinct commit message for the given CODE CHANGES. It MUST follow the the established writing conventions. 5. Remove any meta information like issue references, tags, or author names from the commit message. The developer will add them.",vscpp("br",null),"6. Now only show your message, wrapped with a single markdown ```text codeblock! Do not provide any explanations or details",vscpp("br",null))}};var xA=class{constructor(e){this.accessor=e;this.telemetryService=e.get(ge),this.options=e.get(dc)}async generateGitCommitMessage(e,r,n,o){let s=Date.now(),a=await this.accessor.get(xe).getChatEndpoint("gpt-3.5-turbo"),c=Math.floor(a.modelMaxPromptTokens*4/3),l=this.processDiff(e,c),d=await Me.create(this.accessor.get(j),a,x$,{diff:l,recentCommitMessages:r}).render(void 0,void 0),p=Math.min(this.options.temperature*(1+n),2),f=Date.now(),m=await this.accessor.get(yt).fetchOne("gitCommitMessageGenerator",d.messages,void 0,o,3,a,void 0,{temperature:p});if(this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessage",{model:a.model,requestId:m.requestId,responseType:m.type},{attemptCount:n+1,originalDiffFileCount:e.length,originalDiffLength:e.join("").length,processedDiffFileCount:l.length,processedDiffLength:l.join("").length,timeToRequest:f-s,timeToComplete:Date.now()-s}),m.type!=="success")return;let[h,g]=this.processGeneratedCommitMessage(m.value);return h!=="oneTextCodeBlock"&&this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessageIncorrectResponseFormat",{requestId:m.requestId,responseFormat:h}),g}processDiff(e,r){let n=[...e],o=r-Math.floor(r*.2),s=n.join(`

`).length;if(s>o)for(n.sort((a,c)=>a.length-c.length);s>o&&n.length>0;){let a=n.pop();s-=a.length}return n}processGeneratedCommitMessage(e){let n=/^```text\s*([\s\S]+?)\s*```$/m.exec(e);return n===null?["noTextCodeBlock",e]:n.length!==2?["multipleTextCodeBlocks",e]:["oneTextCodeBlock",n[1]]}};xA=E([y(0,Rt)],xA);var SA=class{constructor(e){this.accessor=e;this._commitMessages=new Map;this._disposables=new ht;this._repositoryDisposables=new H1;this._logService=this.accessor.get(ie);let r=()=>{this._disposables.add(this._gitExtensionApi.onDidOpenRepository(this._onDidOpenRepository,this)),this._disposables.add(this._gitExtensionApi.onDidCloseRepository(this._onDidCloseRepository,this));for(let o of this._gitExtensionApi.repositories)this._onDidOpenRepository(o)},n=this.accessor.get(ro);this._gitExtensionApi=n.getExtensionApi(),this._gitExtensionApi?r():this._disposables.add(n.onDidChange(o=>{o.enabled&&(this._gitExtensionApi=n.getExtensionApi(),r())}))}async generateCommitMessage(e,r=Wt.None){if(!r.isCancellationRequested)return nc.window.withProgress({location:nc.ProgressLocation.SourceControl},async()=>{let n=await this._getChanges(e);if(this._logService.public.debug(`[GitCommitMessageService] Changes (before context exclusion): ${n.length} file(s)`),n.length===0){nc.window.showInformationMessage(nc.l10n.t("Cannot generate a commit message because there are no changes."));return}let o=await this._applyContentExclusion(n);if(this._logService.public.debug(`[GitCommitMessageService] Changes (after context exclusion): ${o.length} file(s)`),o.length===0){nc.window.showInformationMessage(nc.l10n.t("Cannot generate a commit message because the changes were excluded from the context due to content exclusion rules."));return}let s=this._getAttemptCount(e,o),a=await this._getRecentCommitMessages(e),l=await new xA(this.accessor).generateGitCommitMessage(o,a,s,r);if(l&&e.state.HEAD&&e.state.HEAD.commit){let u=this._commitMessages.get(e.rootUri.toString())??new Map;u.set(e.state.HEAD.commit,{attemptCount:s,changes:o,message:l}),this._commitMessages.set(e.rootUri.toString(),u)}return l})}getRepository(e){return this._gitExtensionApi?this._gitExtensionApi.repositories.length===1?this._gitExtensionApi.repositories[0]:(e=e??nc.window.activeTextEditor?.document.uri,e?this._gitExtensionApi.getRepository(e):null):null}async _applyContentExclusion(e){let r=[],n=this.accessor.get(Te);for(let o of e){if(o.originalUri===void 0&&o.modifiedUri===void 0){this._logService.public.debug("[GitCommitMessageService] Ignoring change due to missing originalUri and modifiedUri.");continue}if(o.originalUri&&await n.isCopilotIgnored(o.originalUri)){this._logService.public.debug(`[GitCommitMessageService] Ignoring change due to content exclusion rule based on originalUri: ${o.originalUri.toString()}`);continue}if(o.modifiedUri&&o.modifiedUri!==o.originalUri&&await n.isCopilotIgnored(o.modifiedUri)){this._logService.public.debug(`[GitCommitMessageService] Ignoring change due to content exclusion rule based on modifiedUri: ${o.modifiedUri.toString()}`);continue}r.push(o.diff)}return r}_getAttemptCount(e,r){let o=this._commitMessages.get(e.rootUri.toString())?.get(e.state.HEAD?.commit??"");if(!o||o.changes.length!==r.length)return 0;for(let s=0;s<r.length;s++)if(o.changes[s]!==r[s])return 0;return o.attemptCount+1}async _getChanges(e){let r=await e.diff(!0);if(r!=="")return this._parseGitDiff(e,r);let n=await e.diff(),o=this._parseGitDiff(e,n);return o.push(...await this._getUntrackedChanges(e)),o}async _getRecentCommitMessages(e){let r=[],n=[];try{let o=await e.log({maxEntries:5});r.push(...o.map(c=>c.message.split(`
`)[0]));let s=await e.getConfig("user.name")??await e.getGlobalConfig("user.name"),a=await e.log({maxEntries:5,author:s});n.push(...a.map(c=>c.message.split(`
`)[0]))}catch{}return{repository:r,user:n}}async _getUntrackedChanges(e){let r=[];for(let n of e.state.workingTreeChanges.filter(o=>o.status===7))r.push({modifiedUri:n.uri,diff:await this._getUntrackedChangePatch(e,n.uri)});for(let n of e.state.untrackedChanges??[])r.push({modifiedUri:n.uri,diff:await this._getUntrackedChangePatch(e,n.uri)});return r}async _getUntrackedChangePatch(e,r){this._logService.public.info(`[GitCommitMessageService] Generating patch file for untracked file: ${r.toString()}`);let n=[];try{let o=await nc.workspace.fs.readFile(r),s=uM.relative(e.rootUri.fsPath,r.fsPath);n.push(`diff --git a/${s} b/${s}`),n.push("--- /dev/null",`+++ b/${s}`),n.push(`@@ -0,0 +1,${o.length} @@`),n.push(...o.toString().split(`
`).map(a=>`+${a}`))}catch(o){this._logService.public.error(o,`Failed to generate patch file for untracked file: ${r.toString()}`)}return n.join(`
`)}_parseGitDiff(e,r){let n=[],o=l=>{let u=/^---\s(.*)\n\+\+\+\s(.*)$/m.exec(l);if(!u||u.length!==3)return{originalUri:void 0,modifiedUri:void 0};let d=u[1]==="/dev/null"?void 0:nc.Uri.file(uM.join(e.rootUri.fsPath,u[1].substring(2))),p=u[2]==="/dev/null"?void 0:nc.Uri.file(uM.join(e.rootUri.fsPath,u[2].substring(2)));return{originalUri:d,modifiedUri:p}},s=0,a,c=/^diff --git a\/(.+?) b\/(.+?)$/gm;do{if(a=c.exec(r),a===null)break;if(s<a.index){let l=r.substring(s,a.index),{originalUri:u,modifiedUri:d}=o(l);n.push({diff:l,originalUri:u,modifiedUri:d})}s=a.index}while(!0);if(s<r.length){let l=r.substring(s),{originalUri:u,modifiedUri:d}=o(l);n.push({diff:l,originalUri:u,modifiedUri:d})}return n}_onDidOpenRepository(e){typeof e.onDidCommit!==void 0&&this._repositoryDisposables.set(e,e.onDidCommit(()=>this._onDidCommit(e),this))}_onDidCloseRepository(e){this._repositoryDisposables.deleteAndDispose(e),this._commitMessages.delete(e.rootUri.toString())}async _onDidCommit(e){let r=e.state.HEAD;if(!r?.commit)return;let n=this._commitMessages.get(e.rootUri.toString());if(!n)return;let o=await e.getCommit(r.commit),s=o.parents.length>0?o.parents[0]:"",a=n.get(s);if(!a)return;let c=lD(o.message,a.message);this.accessor.get(ge).sendMSFTTelemetryEvent("git.generateCommitMessageSurvival",void 0,{attemptCount:a.attemptCount,survivalRateFourGram:c}),n.delete(s),this._commitMessages.set(e.rootUri.toString(),n)}dispose(){this._repositoryDisposables.dispose(),this._disposables.dispose()}};SA=E([y(0,Rt)],SA);var Qqe=require("vscode");var IA=class{constructor(e,r){this._chatVariableService=e,this._fsService=r}async resolveVariablesInPrompt(e,r){let n=[];for(let o of r){let s=o.value;if(s instanceof Qqe.Uri){let c=(await this._fsService.readFile(s)).toString().replace(/\r/g,"");s=Si("",c)}let a=this._chatVariableService.getVariable(o.name);n.push({kind:a?.kind??"variable",userMessages:[Nkt(o.name)+s]}),o.range&&(e=e.slice(0,o.range[0])+`[#${o.name}](#${o.name}-context)`+e.slice(o.range[1]))}return{parts:n,message:e}}};IA=E([y(0,S0),y(1,mr)],IA);function Nkt(t){return`# ${t.toUpperCase()} CONTEXT
`}var cp=require("vscode");var CA=class extends GF{constructor(r,n,o){super();this._logService=r;this._authenticationService=n;this._configurationService=o;this._didRegisterLinkProvider=!1;this._entries=[];this._onDidChangeRequests=new Yt;this.onDidChangeRequests=this._onDidChangeRequests.event;this._isFirst=!0;this._register(cp.workspace.registerTextDocumentContentProvider(dd.chatRequestScheme,{onDidChange:Ol.map(this.onDidChangeRequests,()=>cp.Uri.parse(dd.buildUri({kind:"latest"}))),provideTextDocumentContent:s=>{let a=dd.parseUri(s.toString());if(!a)return`Invalid URI: ${s}`;let c=a.kind==="latest"?this._entries[this._entries.length-1]:this._entries.find(l=>l.id===a.id);return c?c.kind===0?c.html:this._renderEntryToMarkdown(c.id,c.entry):"Request not found"}}))}get promptRendererTracing(){return this._configurationService.getConfig(le.ShowRequestLog)}getRequests(){return[...this._entries]}addPromptTrace(r,n,o,s){let a=ir().substring(0,8);this._addEntryIfInternal({kind:0,id:a,name:r,tokens:o.tokenCount,maxTokens:n.modelMaxPromptTokens,html:s}).catch(c=>this._logService.internal.error(c))}addEntry(r){let n=ir().substring(0,8);this._addEntryIfInternal({kind:1,id:n,entry:r}).then(o=>{if(o){this._ensureLinkProvider();let s=r.type==="MarkdownContentRequest"?"markdown":`${r.type==="ChatMLCancelation"?"cancelled":r.result.type} | ${r.chatEndpoint.model} | ${r.endTime.getTime()-r.startTime.getTime()}ms | [${r.debugName}]`;this._logService.internal.info(`${dd.buildUri({kind:"request",id:n})} | ${s}`)}}).catch(o=>this._logService.internal.error(o))}async _addEntryIfInternal(r){return(await this._authenticationService.getCopilotToken())?.isInternal?(this._isFirst&&(this._isFirst=!1,this._logService.internal.info(`Latest entry: ${dd.buildUri({kind:"latest"})}`)),this._entries.push(r),this._entries.length>100&&this._entries.shift(),this._onDidChangeRequests.fire(),!0):!1}_ensureLinkProvider(){if(this._didRegisterLinkProvider)return;this._didRegisterLinkProvider=!0;let r=new class{provideDocumentLinks(n,o){return dd.findAllUris(n.getText()).map(s=>new cp.DocumentLink(new cp.Range(n.positionAt(s.range.start),n.positionAt(s.range.endExclusive)),cp.Uri.parse(s.uri)))}};this._register(cp.languages.registerDocumentLinkProvider({scheme:"output"},r))}_renderMarkdownStyles(){return`
<style>
[id^="system"], [id^="user"], [id^="assistant"] {
		margin: 4px 0 4px 0;
}

.markdown-body > pre {
		padding: 4px 16px;
}
</style>
`}_renderEntryToMarkdown(r,n){if(n.type==="MarkdownContentRequest")return n.markdownContent;let o=[];o.push(`# ${n.debugName} - ${r}`),o.push(""),o.push("## Metadata"),o.push("~~~"),o.push(`url              : ${n.chatEndpoint.url}`),o.push(`model            : ${n.chatParams.model}`),o.push(`maxPromptTokens  : ${n.chatEndpoint.modelMaxPromptTokens}`),o.push(`maxResponseTokens: ${n.chatParams.postOptions?.max_tokens}`),o.push(`location         : ${n.chatParams.location}`),o.push(`postOptions      : ${JSON.stringify(n.chatParams.postOptions)}`),o.push(`intent           : ${n.chatParams.intent}`),o.push(`startTime        : ${n.startTime.toJSON()}`),o.push(`endTime          : ${n.endTime.toJSON()}`),o.push(`duration         : ${n.endTime.getTime()-n.startTime.getTime()}ms`),o.push(`ourRequestId     : ${n.chatParams.ourRequestId}`),n.type==="ChatMLSuccess"?(o.push(`requestId        : ${n.result.requestId}`),o.push(`serverRequestId  : ${n.result.serverRequestId}`),o.push(`timeToFirstToken : ${n.timeToFirstToken}ms`)):n.type==="ChatMLFailure"&&(o.push(`requestId        : ${n.result.requestId}`),o.push(`serverRequestId  : ${n.result.serverRequestId}`)),o.push("~~~"),o.push("## Request Messages");for(let s of n.chatParams.messages)o.push(this._renderMessageToMarkdown(s));if(o.push(""),n.type==="ChatMLSuccess")if(o.push(""),o.push("## Response"),n.deltas?.length)o.push(this._renderDeltasToMarkdown("assistant",n.deltas));else{let s=n.result.value,a="";Array.isArray(s)&&(s.length===1?a=s[0]:a=`${s.map(c=>`<<${c}>>`).join(", ")}`),o.push(this._renderStringMessageToMarkdown("assistant",a))}else n.type==="ChatMLFailure"?(o.push(""),o.push(`## FAILED: ${n.result.reason}`)):n.type==="ChatMLCancelation"&&(o.push(""),o.push("## CANCELED"));return o.push(this._renderMarkdownStyles()),o.join(`
`)}_renderMessageToMarkdown(r){let o=`### ${r.role.charAt(0).toUpperCase()+r.role.slice(1)}
\`\`\`\`md
`;return r.role==="assistant"?r.tool_calls&&(o+=r.tool_calls.map(s=>"\u{1F6E0}\uFE0F "+JSON.stringify(s)).join(`
`)):r.role==="tool"&&(o+=`\u{1F6E0}\uFE0F ${r.tool_call_id}
`),o+=r.content,o+="\n````\n",o}_renderStringMessageToMarkdown(r,n){return`### ${r.charAt(0).toUpperCase()+r.slice(1)}
\`\`\`\`md
${n}
\`\`\`\`
`}_renderDeltasToMarkdown(r,n){let o=r.charAt(0).toUpperCase()+r.slice(1),s=n.map(a=>{let c="";return a.text&&(c+=a.text),a.copilotFunctionCalls&&(c+=a.copilotFunctionCalls.map(l=>"\u{1F6E0}\uFE0F "+JSON.stringify(l)).join(`
`)),c}).join("");return`### ${o}
\`\`\`\`md
${s}
\`\`\`\`
`}};CA=E([y(0,ie),y(1,Tt),y(2,he)],CA);var TA=q(Ct()),km=q(Ue());var Lkt=5,EA=class{constructor(e){this.instantiationService=e;this.requests=new Map}create(e,r){let n=this.instantiationService.createInstance(dM,r);return this.requests.set(e,n),this.requests.size>Lkt&&this.requests.delete(_i.first(this.requests.keys())),n}get(e){let r=this.requests.get(e);if(!r)throw new Error(TA.t("No request found, or it has expired. Please re-submit your query."));return r}};EA=E([y(0,j)],EA);var dM=class{constructor(e,r,n,o,s,a){this.opts=e;this.fileSystemService=r;this.endpointProvider=n;this.instantiationService=o;this.chatMLFetcher=s;this.workspaceService=a;this.fileDescriptions=this.getFileDescriptions();this.fileContents=new Map;this.applied=!1;this.fileDescriptions=this.getFileDescriptions()}get(e){e=e.replaceAll("\\","/").replace(/^\//,"");let r=this.getInner(e),n=this.opts.files.indexOf(e);return n!==-1&&n<this.opts.files.length-1&&r.then(()=>this.getInner(this.opts.files[n+1])),r}async apply(e,r){if(this.applied)throw new Error(TA.t("Edits have already been applied"));try{this.applied=!0;for(let n of this.opts.files){if(r.isCancellationRequested)return;e?.report({message:TA.t("Generating {0}",n)});let o=await this.getInner(n);await this.fileSystemService.writeFile(He.joinPath(this.opts.baseURI,n),new TextEncoder().encode(o))}e?.report({message:TA.t("Edits applied successfully")})}catch(n){throw this.applied=!1,n}}async getInner(e){let r=this.fileContents.get(e);if(r)return r;let n=this.generateContent(e);return this.fileContents.set(e,n),n}async generateContent(e){let r=await this.fileDescriptions,n;try{n=await this.workspaceService.openTextDocument(He.joinPath(this.opts.baseURI,e))}catch{}let o=n?.getText(),s=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),c=await Me.create(this.instantiationService,s,$pe,{file:e,document:n,allInstructions:r?.response,fileTree:this.opts.fileTree,query:this.opts.query,instructionsForThisFile:r?.perFile.find(u=>u.file===e)?.description}).render(),l=await this.chatMLFetcher.fetchOne("workspaceMutationFileGenerator",c.messages,void 0,Wt.None,3,s,void 0,void 0);if(l.type!=="success")throw this.fileContents.delete(e),new Error(TA.t("Encountered an error while generating the file: ({0}) {1}",l.type,l.reason));if(o&&n){let u=a0().process(l.value,o,n.uri);return Gve(o,u.edits)}return l.value}async getFileDescriptions(){let e=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),n=await Me.create(this.instantiationService,e,zpe,{fileTreeStr:this.opts.fileTree,query:this.opts.query}).render(),o=await this.chatMLFetcher.fetchOne("workspaceMutationSummarizer",n.messages,void 0,Wt.None,3,e,void 0,void 0);if(o.type!=="success")return;let s=[];for(let[,a,c]of o.value.matchAll(/^`?(.*?)`?:\s*(.+)$/gm))s.push({file:a,description:c});return{perFile:s,response:o.value}}};dM=E([y(1,mr),y(2,xe),y(3,j),y(4,yt),y(5,qe)],dM);var zpe=class extends km.PromptElement{render(){return vscpp(vscppf,null,vscpp(km.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You will be given a user query and a tree of files they wish to edit or create in order to accomplish a task. Think step by step and respond with a text description that lists and summarizes what needs to be done in each file to accomplish the user's task.",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Valid question",vscpp("br",null),"User: I want to: add the sequelize ORM to my project and add a user model",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"```markdown ",vscpp("br",null),"my-express-app",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u2514\u2500\u2500 models",vscpp("br",null),"\u2502       \u2514\u2500\u2500 user.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"```",vscpp("br",null),"## Valid response",vscpp("br",null),"`src/models/user.ts`: This file defines and exports the User model for use in the application.",vscpp("br",null),"`src/routes/index.ts`: This file exports a function `setRoutes` which sets up the routes for the application. It uses the `IndexController` to handle the root route.",vscpp("br",null),"`package.json`: We need to edit the package.json to ensure Sequelize is defined as a dependency",vscpp("br",null),"`README.md`: We should add documentation to the readme file to make consumers aware of the new setup steps.",vscpp("br",null)),vscpp(km.UserMessage,{priority:900},"I want to: ",this.props.query,vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"```markdown' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"```",vscpp("br",null)))}},$pe=class extends km.PromptElement{render(){let{file:e,query:r,fileTree:n,allInstructions:o,instructionsForThisFile:s,document:a}=this.props;return vscpp(vscppf,null,vscpp(km.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(hr,null),vscpp(ct,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"The user will describe the task they're trying to accomplish, and ask you to generate or edit a file in persuit of that task.",vscpp("br",null),a?vscpp(_d,null):vscpp(vscppf,null,"Print the entire contents of the file you propose.",vscpp("br",null),"If asked to generate a test file, create a file with a self-contained 'hello world' test case without dependency on any other files or imports aside from the testing framwork.",vscpp("br",null)),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include any other explanation.",vscpp("br",null),vscpp("br",null),a?vscpp(Kp,{changes:[{fileName:"package.json",find:['"dependencies": {','  "typescript": "^4.5.4",'],replace:['"dependencies": {','  "mocha": "latest"','  "typescript": "^4.5.4",']}]}):vscpp(vscppf,null,"# Example",vscpp("br",null),"## Question:",vscpp("br",null),"I want to: set up mocha in my workspace",vscpp("br",null),"Please print the contents of the file `src/index.test.ts`",vscpp("br",null),"## Response:",`
const assert = require('assert');
test('hello world!', () => {
	assert.strictEqual(1 + 1, 2);
});
`)),vscpp(km.UserMessage,{priority:900},"I want to: ",r,vscpp("br",null),"Please print the contents of the file `",e,"`",vscpp("br",null),s?vscpp(vscppf,null,"Description of this file: ",s):vscpp(vscppf,null,"Here are the files in my workspace, including this one: ",o,"`"),vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"```filetree",vscpp("br",null),n,vscpp("br",null),"```",vscpp("br",null),vscpp("br",null),a&&vscpp(pM,{flexGrow:1,document:a})))}},pM=class extends km.PromptElement{constructor(r,n){super(r);this.parserService=n}async render(r,n){let{document:o}=this.props,s=await U_(this.parserService,o,void 0,new Be(0,0,0,0),n.tokenBudget*(2/3));return vscpp(nt,{uri:o.uri,languageId:o.languageId,code:s.text})}};pM=E([y(1,dt)],pM);var Wpe=q(require("vscode")),S$=class{get tools(){return Wpe.lm.tools}invokeTool(e,r,n){return Wpe.lm.invokeTool(e,r,n)}getTool(e){return this.tools.find(r=>r.id===e)}getToolByName(e){throw new Error("This method for tests only")}};function Jqe(t,e){let r=e.extensionMode===wA.ExtensionMode.Test;t.define(he,new XU),t.define(Qp,new e8),t.define(ac,new WM),t.define(ST,new JU),t.define(ZU,new eB),t.define(DC,new iB),t.define(gt,new oB),t.define(mr,new aB),t.define(W0e,new k6),t.define(hL,new bB),t.define(UC,new ye(mk)),t.define(AB,new PB),t.define(Ft,new MB),t.define(ui,new m$),t.define(_c,new ye(lA)),t.define(_r,new OF),t.define(Qwe,r?new SB:new IB),t.define(Bt,e),t.define(f7,new _B),t.define(Bm,new h$),t.define(dc,{_serviceBrand:void 0,maxResponseTokens:void 0,temperature:.1,topP:1,rejectionMessage:wA.l10n.t("Sorry, but I can only assist with programming related questions.")}),t.define(o6,new S$),t.define(ie,new ye(oI,[[new q6(e)]])),t.define(il,new ye(CA)),t.define(K7,new ye(DE,[process.platform])),t.define(OE,new ye(LE)),t.define(Kr,new ye(fk)),t.define(en,new ye(rk)),t.define(cF,new ye(sI,[void 0,void 0]));let n=e.extension.packageJSON.internalAIKey??"",o=e.extension.packageJSON.ariaKey??"";r?(Xqe(t,e,n,o),t.define(w_,YEe(t.get(j)))):(Xqe(t,e,n,o),t.define(w_,new ye(ET))),t.define(Tt,new ye(Jw)),t.define(EC,new ye(N6)),t.define(xe,new ye(yA)),t.define(dt,new ye(kB,[!0])),t.define(hc,new ye(KI)),t.define(E8,new ye(CT)),t.define(Te,new ye(dk)),t.define(oa,new ye(tk)),t.define(aC,new ye(sC)),t.define(vc,new ye(mC)),t.define(Wl,new ye(YI)),t.define(S0,new ye(TT)),t.define(x6,new ye(NB)),t.define(dC,new ye(LB)),t.define(Hp,new ye(Wx)),t.define(Vw,new ye(jw)),t.define(VU,new ye(Hw)),t.define(rw,new ye(EA)),t.define(ev,new ye(vk)),t.define(ro,new ye(ik)),t.define(e5,new ye(SA)),t.define(Ho,new ye(mu)),t.define(Vl,new ye(sk)),t.define(KF,new ye(ok)),t.define(XF,new ye(_A)),t.define(qo,new ye(gk)),t.define(Vi,new ye(mB)),t.define(jo,new ye(hB)),t.define(dl,new ye(Zw)),t.define(QF,new ye(gA)),t.define(nT,new ye(rT)),t.define(Uv,new ye(h6)),t.define(yt,new ye(vA)),t.define(L8,new ye(QE)),t.define(qe,new ye(uA)),t.define(wc,new ye(sB)),t.define(md,new ye(EI,[!0])),t.define(lX,new ye(IT,[!0])),t.define(a8,new ye(lT,[!0])),t.define(Kv,new ye(Wv)),t.define(hU,new ye(fw)),t.define(DD,new ye(mT)),t.define(IU,new ye(xw)),t.define(N8,new ye(IA)),t.define($F,new ye(yI)),t.define(P8,new ye(R8)),t.define(MT,new ye(OT)),t.define(a6,new ye(XI)),t.define(Q7,new ye(HE)),t.define(jE,new ye(y$)),t.define(nU,new ye(KE)),t.define(rU,new ye(WE)),t.define(tI,new ye(ak)),t.define(p0,new ye(yk)),t.define(QC,new ye(YC)),t.define(JT,new ye(pk,[void 0]))}function Okt(t,e){if(wA.ExtensionMode.Production===e.extensionMode){let r=t.get(ge),n=$6e(e,r,t.get(gt).isPreRelease());t.define(Lt,n)}else t.define(Lt,new $M)}function Xqe(t,e,r,n){wA.ExtensionMode.Production===e.extensionMode?t.define(ge,new ye(cA,[e.extension.packageJSON.name,r,n,w6e,k6e])):t.define(ge,new FB),Okt(t,e)}async function Mkt(t,e){if(t.extensionMode===kA.ExtensionMode.Test&&!e)return t;kA.l10n.bundle&&Zqe.config({contents:kA.l10n.bundle});let r=tje(t);r.get(gt).isProduction()||Fkt(),await r.get(Lt).initializePromise,await r.get(Lt).initialFetch;let n=r.get(j).createInstance(rv,oEe);return t.subscriptions.push(n),await n.waitForActivationBlockers(),kA.ExtensionMode.Test===t.extensionMode?r:{getAPI(o){if(o>WA.version)throw new Error("Invalid Copilot Chat extension API version. Please upgrade Copilot Chat.");return new WA(r)}}}function Fkt(){try{require("source-map-support").install(),require("dotenv").config({path:[eje.resolve(__dirname,"../.env")]})}catch(t){console.error(t)}}function tje(t){let e=new HM;return t.subscriptions.push(e),Jqe(e,t),e.get(Te).init(),e.get(IU),e.get(tI),e.seal(),e}0&&(module.exports={activate,createExtensionContext});
//!!! DO NOT modify, this file was COPIED from 'microsoft/vscode'
/*! Bundled license information:

@vscode/prompt-tsx/dist/base/util/vs/nls.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/platform.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/process.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/path.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/uri.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/arrays.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@microsoft/applicationinsights-web-snippet/dist/esm/applicationinsights-web-snippet.js:
  (*!
   * Application Insights JavaScript SDK - Web Snippet, 1.0.1
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

mime-db/index.js:
  (*!
   * mime-db
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015-2022 Douglas Christopher Wilson
   * MIT Licensed
   *)

mime-types/index.js:
  (*!
   * mime-types
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)
*/
